{"version":3,"sources":["../src/table-series-number/event-manager.ts"],"names":[],"mappings":"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","file":"event-manager.js","sourcesContent":["import type { TableSeriesNumber } from './table-series-number';\nimport { vglobal, type FederatedPointerEvent, type Group, type IGroup, type IText } from '@visactor/vrender-core';\nimport { SeriesNumberCellStateValue, SeriesNumberEvent } from './type';\n\nexport class TableSeriesNumberEventManager {\n  private _tableSeriesNumber: TableSeriesNumber;\n  isPointerDownStartSelect: boolean = false;\n  constructor(tableSeriesNumber: TableSeriesNumber) {\n    this._tableSeriesNumber = tableSeriesNumber;\n  }\n\n  bindEvents() {\n    //ff\n    const { hover = true, select = true } = this._tableSeriesNumber.attribute;\n\n    if (hover) {\n      this._tableSeriesNumber._rowSeriesNumberGroup.addEventListener(\n        'pointermove',\n        this._onPointermove as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._rowSeriesNumberGroup.addEventListener(\n        'pointerleave',\n        this._onPointerleave as EventListenerOrEventListenerObject\n      );\n\n      this._tableSeriesNumber._colSeriesNumberGroup.addEventListener(\n        'pointermove',\n        this._onPointermove as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._colSeriesNumberGroup.addEventListener(\n        'pointerleave',\n        this._onPointerleave as EventListenerOrEventListenerObject\n      );\n\n      this._tableSeriesNumber._cornerGroup.addEventListener(\n        'pointermove',\n        this._onPointermove as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._cornerGroup.addEventListener(\n        'pointerleave',\n        this._onPointerleave as EventListenerOrEventListenerObject\n      );\n\n      this._tableSeriesNumber._frozenTopRowSeriesNumberGroup.addEventListener(\n        'pointermove',\n        this._onPointermove as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._frozenTopRowSeriesNumberGroup.addEventListener(\n        'pointerleave',\n        this._onPointerleave as EventListenerOrEventListenerObject\n      );\n\n      this._tableSeriesNumber._frozenLeftColSeriesNumberGroup.addEventListener(\n        'pointermove',\n        this._onPointermove as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._frozenLeftColSeriesNumberGroup.addEventListener(\n        'pointerleave',\n        this._onPointerleave as EventListenerOrEventListenerObject\n      );\n    }\n\n    if (select) {\n      this._tableSeriesNumber._rowSeriesNumberGroup.addEventListener(\n        'pointerdown',\n        this._onPointerdown as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._colSeriesNumberGroup.addEventListener(\n        'pointerdown',\n        this._onPointerdown as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._cornerGroup.addEventListener(\n        'pointerdown',\n        this._onPointerdown as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._frozenTopRowSeriesNumberGroup.addEventListener(\n        'pointerdown',\n        this._onPointerdown as EventListenerOrEventListenerObject\n      );\n      this._tableSeriesNumber._frozenLeftColSeriesNumberGroup.addEventListener(\n        'pointerdown',\n        this._onPointerdown as EventListenerOrEventListenerObject\n      );\n\n      vglobal.addEventListener('pointerup', this._onPointerup as EventListenerOrEventListenerObject);\n    }\n    this._tableSeriesNumber._rowSeriesNumberGroup.addEventListener(\n      'rightdown',\n      this._onRightDown as EventListenerOrEventListenerObject\n    );\n    this._tableSeriesNumber._colSeriesNumberGroup.addEventListener(\n      'rightdown',\n      this._onRightDown as EventListenerOrEventListenerObject\n    );\n    this._tableSeriesNumber._cornerGroup.addEventListener(\n      'rightdown',\n      this._onRightDown as EventListenerOrEventListenerObject\n    );\n    this._tableSeriesNumber._frozenTopRowSeriesNumberGroup.addEventListener(\n      'rightdown',\n      this._onRightDown as EventListenerOrEventListenerObject\n    );\n    this._tableSeriesNumber._frozenLeftColSeriesNumberGroup.addEventListener(\n      'rightdown',\n      this._onRightDown as EventListenerOrEventListenerObject\n    );\n  }\n  private _onRightDown = (e: FederatedPointerEvent) => {\n    const target = e.target as unknown as IGroup;\n    this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellRightClick, {\n      seriesNumberCell: target,\n      event: e\n    });\n  };\n  private _onPointermove = (e: FederatedPointerEvent) => {\n    //ff\n    const target = e.target as unknown as IGroup;\n    if (this.isPointerDownStartSelect) {\n      if (!this._tableSeriesNumber.interactionState.selectIndexs.has(target.name)) {\n        this._tableSeriesNumber.interactionState.selectIndexs.add(target.name);\n        this._tableSeriesNumber.renderSelectedIndexsState();\n        this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellClick, {\n          seriesNumberCell: target,\n          event: e,\n          isDragSelect: true\n        });\n      } else {\n        if (\n          this._tableSeriesNumber.interactionState._lastClickItem &&\n          this._tableSeriesNumber.interactionState._lastClickItem.id === target.id\n        ) {\n          return;\n        }\n        this._tableSeriesNumber.renderSelectedIndexsState();\n        this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellClick, {\n          seriesNumberCell: target,\n          event: e,\n          isDragSelect: true\n        });\n      }\n      this._tableSeriesNumber.interactionState._lastClickItem = target;\n      return;\n    }\n\n    if (target.name.startsWith('col')) {\n      //判断鼠标是否位于列间隔线附近，如果是则设置cursor为col-resize\n      const colIndex = Number(target.name.split('-')[1]);\n      const canvasPointXY = target.stage.window.pointTransform(e.canvasX, e.canvasY);\n      const XYtoTarget = { x: 0, y: 0 };\n\n      target.globalTransMatrix.transformPoint(canvasPointXY, XYtoTarget);\n      //假如校验后，是整列被选中状态。鼠标样式变为抓手样式\n      if (\n        XYtoTarget.x <= 4 ||\n        (XYtoTarget.x <= target.getAttributes().width && XYtoTarget.x >= target.getAttributes().width - 4)\n      ) {\n        target.setAttribute('cursor', 'col-resize');\n      } else if (\n        colIndex !== undefined &&\n        colIndex !== null &&\n        this._tableSeriesNumber.attribute.checkMoveColumnOrder?.(colIndex)\n      ) {\n        target.setAttribute('cursor', 'grab');\n      } else {\n        target.setAttribute('cursor', 'default');\n      }\n    } else if (target.name.startsWith('row')) {\n      //判断鼠标是否位于行间隔线附近，如果是则设置cursor为row-resize\n      const rowIndex = Number(target.name.split('-')[1]);\n      const canvasPointXY = target.stage.window.pointTransform(e.canvasX, e.canvasY);\n      const XYtoTarget = { x: 0, y: 0 };\n\n      target.globalTransMatrix.transformPoint(canvasPointXY, XYtoTarget);\n      if (\n        XYtoTarget.y <= 4 ||\n        (XYtoTarget.y <= target.getAttributes().height && XYtoTarget.y >= target.getAttributes().height - 4)\n      ) {\n        target.setAttribute('cursor', 'row-resize');\n      } else if (\n        rowIndex !== undefined &&\n        rowIndex !== null &&\n        this._tableSeriesNumber.attribute.checkMoveRowOrder?.(rowIndex)\n      ) {\n        target.setAttribute('cursor', 'grab');\n      } else {\n        target.setAttribute('cursor', 'default');\n      }\n    }\n    // // 如果上个激活元素存在，则判断当前元素是否和上个激活元素相同，相同则不做处理，不相同则触发 unhover\n    if (this._tableSeriesNumber.interactionState._lastHoverItem) {\n      if (this._tableSeriesNumber.interactionState._lastHoverItem.id === target.id) {\n        return;\n      }\n      this._unHoverHandler(this._tableSeriesNumber.interactionState._lastHoverItem, e);\n    }\n    if ((this._tableSeriesNumber.getAttributes() as any).hover) {\n      this._hoverHandler(target, e);\n    }\n  };\n  private _onPointerleave = (e: FederatedPointerEvent) => {\n    //ff\n    if (this._tableSeriesNumber.interactionState._lastHoverItem) {\n      this._unHoverHandler(this._tableSeriesNumber.interactionState._lastHoverItem, e);\n      this._tableSeriesNumber.interactionState._lastHoverItem = null;\n    }\n  };\n  private _onPointerdown = (e: FederatedPointerEvent) => {\n    //验证是否右键点击\n    if (e.button === 2) {\n      return;\n    }\n    const target = e.target as unknown as IGroup;\n\n    if (target.name.startsWith('col')) {\n      //判断鼠标是否位于列间隔线附近，如果是则触发resizeColWidthStart事件\n      const colIndex = Number(target.name.split('-')[1]);\n      const canvasPointXY = target.stage.window.pointTransform(e.canvasX, e.canvasY);\n      const XYtoTarget = { x: 0, y: 0 };\n\n      target.globalTransMatrix.transformPoint(canvasPointXY, XYtoTarget);\n      if (\n        XYtoTarget.x <= 4 ||\n        (XYtoTarget.x <= target.getAttributes().width && XYtoTarget.x >= target.getAttributes().width - 4)\n      ) {\n        let resizeTargetColIndex = colIndex;\n        if (XYtoTarget.x <= 4) {\n          resizeTargetColIndex = colIndex - 1;\n        }\n        this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.resizeColWidthStart, {\n          colIndex: resizeTargetColIndex,\n          event: e\n        });\n        return;\n      } else if (\n        colIndex !== undefined &&\n        colIndex !== null &&\n        this._tableSeriesNumber.attribute.checkMoveColumnOrder?.(colIndex)\n      ) {\n        this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.dragColumnOrderStart, {\n          colIndex: colIndex,\n          event: e\n        });\n        return;\n      }\n    } else if (target.name.startsWith('row')) {\n      //判断鼠标是否位于行间隔线附近，如果是则触发resizeRowHeightStart事件\n      const rowIndex = Number(target.name.split('-')[1]);\n      const canvasPointXY = target.stage.window.pointTransform(e.canvasX, e.canvasY);\n      const XYtoTarget = { x: 0, y: 0 };\n\n      target.globalTransMatrix.transformPoint(canvasPointXY, XYtoTarget);\n      if (\n        XYtoTarget.y <= 4 ||\n        (XYtoTarget.y <= target.getAttributes().height && XYtoTarget.y >= target.getAttributes().height - 4)\n      ) {\n        let resizeTargetRowIndex = rowIndex;\n        if (XYtoTarget.y <= 4) {\n          resizeTargetRowIndex = rowIndex - 1;\n        }\n        this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.resizeRowHeightStart, {\n          rowIndex: resizeTargetRowIndex,\n          event: e\n        });\n        return;\n      } else if (\n        rowIndex !== undefined &&\n        rowIndex !== null &&\n        this._tableSeriesNumber.attribute.checkMoveRowOrder?.(rowIndex)\n      ) {\n        this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.dragRowOrderStart, {\n          rowIndex: rowIndex,\n          event: e\n        });\n        return;\n      }\n    }\n    this.isPointerDownStartSelect = true;\n    if (this._tableSeriesNumber.interactionState.selectIndexs?.size) {\n      if (this._tableSeriesNumber.interactionState.selectIndexs.has(target.name)) {\n        if (e.nativeEvent.ctrlKey || e.nativeEvent.metaKey) {\n          this._tableSeriesNumber.removeOneGroupSelected(target);\n          this._unClickHandler(target.name, e);\n        } else {\n          this._tableSeriesNumber.removeAllSelectedIndexs();\n          for (const name of this._tableSeriesNumber.interactionState.selectIndexs) {\n            this._unClickHandler(name, e);\n          }\n        }\n      } else {\n        if (e.nativeEvent.ctrlKey || e.nativeEvent.metaKey) {\n          // nothing\n        } else {\n          this._tableSeriesNumber.removeAllSelectedIndexs();\n          for (const name of this._tableSeriesNumber.interactionState.selectIndexs) {\n            if (\n              (target.name.startsWith('row') && name.startsWith('row')) ||\n              (target.name.startsWith('col') && name.startsWith('col'))\n            ) {\n              this._unClickHandler(name, e);\n            }\n          }\n        }\n      }\n    }\n    this._clickHandler(target, e);\n  };\n  private _onPointerup = (e: FederatedPointerEvent) => {\n    //ff\n    const target = e.target as unknown as IGroup;\n    if (this.isPointerDownStartSelect) {\n      this.isPointerDownStartSelect = false;\n      this._tableSeriesNumber.interactionState._lastClickItem = null;\n      this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellClickUp, {\n        seriesNumberCell: target,\n        event: e\n      });\n    }\n  };\n\n  private _hoverHandler(seriesNumberCell: IGroup, e: FederatedPointerEvent) {\n    this._tableSeriesNumber.interactionState._lastHoverItem = seriesNumberCell;\n    //需兼顾select状态\n    if (seriesNumberCell.hasState(SeriesNumberCellStateValue.select)) {\n      seriesNumberCell.useStates([SeriesNumberCellStateValue.select, SeriesNumberCellStateValue.hover]);\n    } else {\n      seriesNumberCell.useStates([SeriesNumberCellStateValue.hover]);\n    }\n\n    this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellHover, {\n      seriesNumberCell,\n      event: e\n    });\n  }\n\n  private _unHoverHandler(seriesNumberCell: IGroup, e: FederatedPointerEvent) {\n    seriesNumberCell.removeState(SeriesNumberCellStateValue.hover);\n    this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellUnHover, {\n      seriesNumberCell,\n      event: e\n    });\n  }\n\n  private _clickHandler(seriesNumberCell: IGroup, e: FederatedPointerEvent) {\n    // this._tableSeriesNumber.interactionState.selectIndexs.add(seriesNumberCell.name);\n    // seriesNumberCell.useStates([SeriesNumberCellStateValue.select]);\n    this._tableSeriesNumber.addOneGroupSelected(seriesNumberCell);\n    this._tableSeriesNumber.interactionState._lastClickItem = seriesNumberCell;\n    this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellClick, {\n      seriesNumberCell,\n      event: e\n    });\n  }\n  private _unClickHandler(seriesNumberIndex: string, e: FederatedPointerEvent) {\n    const isRow = seriesNumberIndex.startsWith('row');\n    // const isCol = seriesNumberIndex.startsWith('col');\n\n    // this._tableSeriesNumber.interactionState.selectIndexs.delete(seriesNumberIndex);\n    // this._tableSeriesNumber.removeOneGroupSelected(seriesNumberIndex);\n    const seriesNumberCell = isRow\n      ? this._tableSeriesNumber.getRowSeriesNumberCellGroup(Number(seriesNumberIndex.split('-')[1]))\n      : this._tableSeriesNumber.getColSeriesNumberCellGroup(Number(seriesNumberIndex.split('-')[1]));\n    seriesNumberCell?.removeState(SeriesNumberCellStateValue.select);\n    this._tableSeriesNumber.dispatchTableSeriesNumberEvent(SeriesNumberEvent.seriesNumberCellCancelClick, {\n      index: seriesNumberIndex,\n      event: e\n    });\n  }\n}\n"]}