{"version":3,"sources":["../src/component/data-zoom/data-filter-event.ts"],"names":[],"mappings":"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","file":"data-filter-event.js","sourcesContent":["import { clamp, abs, merge, mixin, isValid, isBoolean } from '@visactor/vutils';\nimport type { IRoamDragSpec, IRoamScrollSpec, IRoamZoomSpec } from './interface';\nimport type { BaseEventParams, IEvent } from '../../event/interface';\nimport type { IDataZoomSpec } from './data-zoom/interface';\nimport type { IRegion } from '../../region';\nimport { Direction, type ILayoutRect } from '../../typings';\nimport { Zoomable, type IZoomable } from '../../interaction/zoom';\nimport type { IDelayType } from '@visactor/vrender-components';\nimport type { IComponentOption } from '../interface';\nimport { getDirectionByOrient, getOrient } from '../axis/cartesian/util';\n\nexport class DataFilterEvent {\n  protected _type: 'dataZoom' | 'scrollBar';\n  protected _spec: IDataZoomSpec;\n  protected _option: IComponentOption;\n  protected _handleChange: (start: number, end: number, updateComponent?: boolean) => void;\n\n  protected getLayoutRect: () => ILayoutRect;\n  protected getState: () => { start: number; end: number };\n  protected getRegions: () => IRegion[];\n  protected getOption: () => IComponentOption;\n  protected getEvent: () => IEvent;\n  protected _isHorizontal: boolean;\n  protected _regions: IRegion[];\n\n  protected _activeRoam: boolean = true;\n  protected _zoomAttr: IRoamZoomSpec = {\n    enable: true,\n    rate: 1,\n    focus: true\n  };\n  protected _dragAttr: IRoamDragSpec = {\n    enable: true,\n    rate: 1,\n    reverse: true\n  };\n  protected _scrollAttr: IRoamScrollSpec = {\n    enable: true,\n    rate: 1,\n    reverse: true\n  };\n\n  enableInteraction() {\n    this._activeRoam = true;\n  }\n  disableInteraction() {\n    this._activeRoam = false;\n  }\n  zoomIn(location?: { x: number; y: number }) {\n    this.handleChartZoom({\n      zoomDelta: 1.2, // 经验值\n      zoomX: location?.x,\n      zoomY: location?.y\n    });\n  }\n\n  zoomOut(location?: { x: number; y: number }) {\n    this.handleChartZoom({\n      zoomDelta: 0.8, // 经验值\n      zoomX: location?.x,\n      zoomY: location?.y\n    });\n  }\n\n  constructor(\n    type: 'dataZoom' | 'scrollBar',\n    spec: IDataZoomSpec,\n    handleChange: (start: number, end: number, updateComponent?: boolean) => void,\n    getLayoutRect: () => ILayoutRect,\n    getState: () => { start: number; end: number },\n    getRegions: () => IRegion[],\n    getOption: () => IComponentOption,\n    getEvent: () => IEvent\n  ) {\n    this._type = type;\n    this._spec = spec;\n    this._handleChange = handleChange;\n    this.getLayoutRect = getLayoutRect;\n    this.getState = getState;\n    this.getRegions = getRegions;\n    this._regions = getRegions();\n    this.getOption = getOption;\n    this._option = getOption();\n    this.getEvent = getEvent;\n\n    this._isHorizontal = getDirectionByOrient(getOrient(spec as any)) === Direction.horizontal;\n  }\n\n  setEventAttrFromSpec() {\n    if (this._spec.roamZoom === true || this._spec.roamZoom) {\n      this._zoomAttr = merge({}, this._zoomAttr, this._spec.roamZoom);\n    } else {\n      this._zoomAttr.enable = false;\n    }\n\n    if (this._spec.roamDrag === true || this._spec.roamDrag) {\n      this._dragAttr = merge({}, this._dragAttr, this._spec.roamDrag);\n    } else {\n      this._dragAttr.enable = false;\n    }\n\n    if (this._spec.roamScroll === true || this._spec.roamScroll) {\n      this._scrollAttr = merge({}, this._scrollAttr, this._spec.roamScroll);\n    } else {\n      this._scrollAttr.enable = false;\n    }\n\n    if (isBoolean((this._spec as any).roam)) {\n      this._zoomAttr.enable = this._type === 'scrollBar' ? false : (this._spec as any).roam;\n      this._dragAttr.enable = (this._spec as any).roam;\n      this._scrollAttr.enable = (this._spec as any).roam;\n    }\n\n    if (this._zoomAttr.enable || this._dragAttr.enable || this._scrollAttr.enable) {\n      (this as unknown as IZoomable).initZoomable(this.getEvent(), this._option.mode);\n    }\n  }\n\n  initZoomEvent = () => {\n    const delayType: IDelayType = this._spec?.delayType ?? 'throttle';\n    const delayTime = isValid(this._spec?.delayType) ? (this._spec?.delayTime ?? 30) : 0;\n    const realTime = this._spec?.realTime ?? true;\n    const option = { delayType, delayTime, realTime, allowComponentZoom: true };\n    if (this._zoomAttr.enable) {\n      (this as unknown as IZoomable).initZoomEventOfRegions(this.getRegions(), null, this.handleChartZoom, option);\n    }\n    if (this._scrollAttr.enable) {\n      (this as unknown as IZoomable).initScrollEventOfRegions(this.getRegions(), null, this.handleChartScroll, option);\n    }\n    if (this._dragAttr.enable) {\n      (this as unknown as IZoomable).initDragEventOfRegions(this.getRegions(), null, this.handleChartDrag, option);\n    }\n  };\n\n  /// add event listener\n  handleChartZoom = (params: { zoomDelta: number; zoomX?: number; zoomY?: number }, e?: BaseEventParams['event']) => {\n    if (!this._activeRoam || (this._zoomAttr.filter && !this._zoomAttr.filter(params, e))) {\n      return;\n    }\n\n    const { zoomDelta, zoomX, zoomY } = params;\n    const { x, y } = this.getRegions()[0].getLayoutStartPoint();\n    const { width, height } = this.getRegions()[0].getLayoutRect();\n\n    const delta = Math.abs(this.getState().start - this.getState().end);\n    const zoomRate = (this._spec.roamZoom as IRoamZoomSpec)?.rate ?? 1;\n    // zoomDelta > 1表示放大, zoomDelta < 1表示缩小\n    if (delta >= 1 && zoomDelta < 1) {\n      return;\n    }\n    if (delta <= 0.01 && zoomDelta > 1) {\n      return;\n    }\n    const focusLoc = this._isHorizontal ? zoomX : zoomY;\n    const totalValue = delta * (zoomDelta - 1) * zoomRate;\n    let startValue = totalValue / 2;\n    let endValue = totalValue / 2;\n    if (focusLoc) {\n      const startLoc = this._isHorizontal ? x : y;\n      const endLoc = this._isHorizontal ? width : height;\n      startValue = (Math.abs(startLoc - focusLoc) / Math.abs(endLoc - startLoc)) * totalValue;\n      endValue = (Math.abs(endLoc - focusLoc) / Math.abs(endLoc - startLoc)) * totalValue;\n    }\n    const start = clamp(this.getState().start + startValue, 0, 1);\n    const end = clamp(this.getState().end - endValue, 0, 1);\n\n    this._handleChange(Math.min(start, end), Math.max(start, end), true);\n  };\n\n  handleChartScroll = (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => {\n    if (!this._activeRoam || (this._scrollAttr.filter && !this._scrollAttr.filter(params, e))) {\n      return false;\n    }\n    const { scrollX, scrollY } = params;\n    let value = this._isHorizontal ? scrollX : scrollY;\n    // 判断这次是否应该要滚动，最少\n    const active = this._isHorizontal ? abs(scrollX / scrollY) >= 0.5 : abs(scrollY / scrollX) >= 0.5;\n    if (!this._scrollAttr.reverse) {\n      value = -value;\n    }\n\n    if (active) {\n      this.handleChartMove(value, this._scrollAttr.rate ?? 1);\n    }\n\n    // 判断是否滚动到最顶部或最底部\n    // 如果滚动到最顶部或最底部，则不应该stopBubble\n    const hasChange = this.getState().start !== 0 && this.getState().end !== 1;\n\n    return active && hasChange;\n  };\n\n  handleChartDrag = (delta: [number, number], e: BaseEventParams['event']) => {\n    if (!this._activeRoam || (this._dragAttr.filter && !this._dragAttr.filter(delta, e))) {\n      return;\n    }\n    const [dx, dy] = delta;\n    let value = this._isHorizontal ? dx : dy;\n    if (this._dragAttr.reverse) {\n      value = -value;\n    }\n    this.handleChartMove(value, this._dragAttr.rate ?? 1);\n  };\n\n  handleChartMove = (value: number, rate: number) => {\n    const totalValue = this._isHorizontal ? this.getLayoutRect().width : this.getLayoutRect().height;\n    if (Math.abs(value) >= 1e-6) {\n      if (value > 0 && this.getState().end < 1) {\n        const moveDelta = Math.min(1 - this.getState().end, value / totalValue) * rate;\n        this._handleChange(this.getState().start + moveDelta, this.getState().end + moveDelta, true);\n      } else if (value < 0 && this.getState().start > 0) {\n        const moveDelta = Math.max(-this.getState().start, value / totalValue) * rate;\n        this._handleChange(this.getState().start + moveDelta, this.getState().end + moveDelta, true);\n      }\n    }\n    return false;\n  };\n}\n\nmixin(DataFilterEvent, Zoomable);\n"]}