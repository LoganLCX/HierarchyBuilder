!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VChart={})}(this,(function(t){"use strict";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e,i){return e=c(e),p(t,d()?Reflect.construct(e,i||[],c(t).constructor):e.apply(t,i))}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x(n.key),n)}}function o(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=S(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function l(t,e,i){return(e=x(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},u.apply(null,arguments)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}function f(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",r=i.toStringTag||"@@toStringTag";function a(i,n,r,a){var l=n&&n.prototype instanceof s?n:s,u=Object.create(l.prototype);return v(u,"_invoke",function(i,n,r){var a,s,l,u=0,c=r||[],h=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,i){return a=e,s=0,l=t,d.n=i,o}};function p(i,n){for(s=i,l=n,e=0;!h&&u&&!r&&e<c.length;e++){var r,a=c[e],p=d.p,f=a[2];i>3?(r=f===n)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=p&&((r=i<2&&p<a[1])?(s=0,d.v=n,d.n=a[1]):p<f&&(r=i<3||a[0]>n||n>f)&&(a[4]=i,a[5]=n,d.n=f,s=0))}if(r||i>1)return o;throw h=!0,n}return function(r,c,f){if(u>1)throw TypeError("Generator is already running");for(h&&1===c&&p(c,f),s=c,l=f;(e=s<2?t:l)||!h;){a||(s?s<3?(s>1&&(d.n=-1),p(s,l)):d.n=l:d.v=l);try{if(u=2,a){if(s||(r="next"),e=a[r]){if(!(e=e.call(a,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);a=t}else if((e=(h=d.n<0)?l:i.call(n,d))!==o)break}catch(e){a=t,s=1,l=e}finally{u=1}}return{value:e,done:h}}}(i,r,a),!0),u}var o={};function s(){}function l(){}function u(){}e=Object.getPrototypeOf;var c=[][n]?e(e([][n]())):(v(e={},n,(function(){return this})),e),h=u.prototype=s.prototype=Object.create(c);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,v(t,r,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=u,v(h,"constructor",u),v(u,"constructor",l),l.displayName="GeneratorFunction",v(u,r,"GeneratorFunction"),v(h),v(h,r,"Generator"),v(h,n,(function(){return this})),v(h,"toString",(function(){return"[object Generator]"})),(f=function(){return{w:a,m:d}})()}function v(t,e,i,n){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}v=function(t,e,i,n){if(e)r?r(t,e,{value:i,enumerable:!n,configurable:!n,writable:!n}):t[e]=i;else{function a(e,i){v(t,e,(function(t){return this._invoke(e,i,t)}))}a("next",0),a("throw",1),a("return",2)}},v(t,e,i,n)}function g(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],i=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}throw new TypeError(typeof t+" is not iterable")}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,a,o,s=[],l=!0,u=!1;try{if(a=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=a.call(i)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(t,e)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e,i,n){var r=u(c(1&n?t.prototype:t),e,i);return 2&n&&"function"==typeof r?function(t){return r.apply(i,t)}:r}function b(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function S(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var A=function(t,e){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},A(t,e)};function C(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var M=function(){return M=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},M.apply(this,arguments)};function w(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}function T(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))}function D(t,e){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function E(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function B(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,a=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function P(t,e,i){if(i||2===arguments.length)for(var n,r=0,a=e.length;r<a;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}var R,L,I=function(t){return t};function F(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}t.RenderModeEnum=void 0,(R=t.RenderModeEnum||(t.RenderModeEnum={}))["desktop-browser"]="desktop-browser",R["mobile-browser"]="mobile-browser",R.node="node",R.worker="worker",R.miniApp="miniApp",R.wx="wx",R.tt="tt",R.harmony="harmony",R["desktop-miniApp"]="desktop-miniApp",R.lynx="lynx",function(t){t.cartesianAxis="cartesianAxis",t.cartesianBandAxis="cartesianAxis-band",t.cartesianLinearAxis="cartesianAxis-linear",t.cartesianTimeAxis="cartesianAxis-time",t.cartesianLogAxis="cartesianAxis-log",t.cartesianSymlogAxis="cartesianAxis-symlog",t.polarAxis="polarAxis",t.polarBandAxis="polarAxis-band",t.polarLinearAxis="polarAxis-linear",t.crosshair="crosshair",t.cartesianCrosshair="cartesianCrosshair",t.polarCrosshair="polarCrosshair",t.dataZoom="dataZoom",t.geoCoordinate="geoCoordinate",t.indicator="indicator",t.discreteLegend="discreteLegend",t.continuousLegend="continuousLegend",t.colorLegend="colorLegend",t.sizeLegend="sizeLegend",t.markLine="markLine",t.markArea="markArea",t.markPoint="markPoint",t.polarMarkLine="polarMarkLine",t.polarMarkArea="polarMarkArea",t.polarMarkPoint="polarMarkPoint",t.geoMarkPoint="geoMarkPoint",t.tooltip="tooltip",t.title="title",t.player="player",t.scrollBar="scrollBar",t.label="label",t.totalLabel="totalLabel",t.brush="brush",t.poptip="poptip",t.customMark="customMark"}(L||(L={}));var O={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(t,e,n,a,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new r(n,a||t,o),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),s.prototype.eventNames=function(){var t,n,r=[];if(0===this._eventsCount)return r;for(n in t=this._events)e.call(t,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,a=n.length,o=new Array(a);r<a;r++)o[r]=n[r].fn;return o},s.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,r,a,o){var s=i?i+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,a),!0;case 6:return c.fn.call(c.context,e,n,r,a,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,i){return a(this,t,e,i,!1)},s.prototype.once=function(t,e,i){return a(this,t,e,i,!0)},s.prototype.removeListener=function(t,e,n,r){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||r&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&o(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=i,s.EventEmitter=s,t.exports=s}(O);var z=F(O.exports),H=function(t,e){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")},N=function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"boolean"==typeof t:!0===t||!1===t||H(t,"Boolean")},U=function(t){return"function"==typeof t},j=function(t){return null==t},V=function(t){return null===t},W=function(t){return null!=t},G=function(t){var e=k(t);return null!==t&&"object"===e||"function"===e},Y=function(t){return"object"==k(t)&&null!==t},X=function(t){if(!Y(t)||!H(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},K=function(t){return void 0===t},q=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=k(t);return e?"string"===i:"string"===i||H(t,"String")},Z=function(t){return Array.isArray?Array.isArray(t):H(t,"Array")},J=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)},Q=function(t){return H(t,"Date")},$=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=k(t);return e?"number"===i:"number"===i||H(t,"Number")},et=function(t){return"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t))},it=function(t){return $(t)&&Number.isFinite(t)},nt=function(t){return new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t)},rt=function(t){return H(t,"RegExp")},at=function(t){return new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t)},ot=function(t){return{}.toString.call(t).replace(/^\[object /,"").replace(/]$/,"")},st=Object.prototype,lt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||st)},ut=Object.prototype.hasOwnProperty;function ct(t){if(j(t))return!0;if(J(t))return!t.length;var e=ot(t);if("Map"===e||"Set"===e)return!t.size;if(lt(t))return!Object.keys(t).length;for(var i in t)if(ut.call(t,i))return!1;return!0}var ht=function(t,e,i){for(var n=q(e)?e.split("."):e,r=0;r<n.length;r++)t=t?t[n[r]]:void 0;return void 0===t?i:t},dt=Object.prototype.hasOwnProperty,pt=function(t,e){return null!=t&&dt.call(t,e)};function ft(t,e,i){var n;if(!W(t)||"object"!=k(t)||e&&e(t))return t;var r=Z(t),a=t.length;n=r?new Array(a):"object"==k(t)?{}:N(t)||$(t)||q(t)?t:Q(t)?new Date(+t):void 0;var o=r?void 0:Object.keys(Object(t)),s=-1;if(n)for(;++s<(o||t).length;){var l=o?o[s]:s,u=t[l];i&&i.includes(l.toString())?n[l]=u:n[l]=ft(u,e,i)}return n}function vt(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){if(t===e)return;if(W(e)&&"object"==k(e)){var r=Object(e),a=[];for(var o in r)a.push(o);for(var s=a.length,l=-1;s--;){var u=a[++l];!W(r[u])||"object"!=k(r[u])||n&&Z(t[u])?yt(t,u,r[u]):gt(t,e,u,i,n)}}}}function gt(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t[i],o=e[i],s=e[i],l=!0;if(Z(o)){if(n)s=[];else if(Z(a))s=a;else if(J(a)){s=new Array(a.length);for(var u=-1,c=a.length;++u<c;)s[u]=a[u]}}else X(o)?(s=null!=a?a:{},"function"!=typeof a&&"object"==k(a)||(s={})):l=!1;l&&vt(s,o,n,r),yt(t,i,s)}function yt(t,e,i){(void 0!==i&&!function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i)||void 0===i&&!(e in t))&&(t[e]=i)}function mt(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)vt(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0);return t}var _t=Object.prototype.hasOwnProperty;function bt(t,e){if(!t||!X(t))return t;var i={};return Object.keys(t).forEach((function(n){var r=t[n],a=!1;e.forEach((function(t){(q(t)&&t===n||t instanceof RegExp&&n.match(t))&&(a=!0)})),a||(i[n]=r)})),i}function xt(t){return Object.prototype.toString.call(t)}function kt(t){return Object.keys(t)}function St(t,e,i){if(t===e)return!0;if(k(t)!=k(e))return!1;if(null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(xt(t)!==xt(e))return!1;if(U(t))return!!(null==i?void 0:i.skipFunction);if("object"!=k(t))return!1;if(Z(t)){if(t.length!==e.length)return!1;for(var n=t.length-1;n>=0;n--)if(!St(t[n],e[n],i))return!1;return!0}if(!X(t))return!1;var r=kt(t),a=kt(e);if(r.length!==a.length)return!1;r.sort(),a.sort();for(var o=r.length-1;o>=0;o--)if(r[o]!=a[o])return!1;for(var s=r.length-1;s>=0;s--){var l=r[s];if(!St(t[l],e[l],i))return!1}return!0}function At(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function Ct(t){return Z(t)?t.length:G(t)?Object.keys(t).length:0}function Mt(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}function wt(t,e,i){for(var n=Mt(e),r=0;r<n.length;r++){var a=n[r];(i?null!=e[a]:null==t[a])&&(t[a]=e[a])}return t}function Tt(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var a=n[r];"constructor"!==a&&(i?null!=e[a]:null==t[a])&&(t[a]=e[a])}else wt(t,e,i)}function Dt(t){return W(t)?Z(t)?t:[t]:[]}function Et(t){if(J(t))return t[t.length-1]}var Bt=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var a=t[r];(null!==(i=null==e?void 0:e(a,n))&&void 0!==i?i:a-n)>0&&(n=a)}return n}},Pt=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var a=t[r];(null!==(i=null==e?void 0:e(a,n))&&void 0!==i?i:a-n)<0&&(n=a)}return n}};function Rt(t,e){if(!Z(t)||!Z(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function Lt(t){return t&&Z(t)?Array.from(new Set(Dt(t))):t}function It(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random,r=t.length;r;)e=Math.floor(n()*r),i=t[--r],t[r]=t[e],t[e]=i;return t}function Ft(t){if(!Z(t))return[t];var e,i=[],n=s(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;i.push.apply(i,b(Ft(r)))}}catch(t){n.e(t)}finally{n.f()}return i}function Ot(t,e,i){W(e)||(e=t,t=0),W(i)||(i=1);for(var n=-1,r=0|Math.max(0,Math.ceil((e-t)/i)),a=new Array(r);++n<r;)a[n]=t+n*i;return a}function zt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ht(t){return Number(t)}function Nt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ht,n=t.length;if(n){if(e<=0||n<2)return i(t[0],0,t);if(e>=1)return i(t[n-1],n-1,t);var r=(n-1)*e,a=Math.floor(r),o=i(t[a],a,t);return o+(i(t[a+1],a+1,t)-o)*(r-a)}}var Ut,jt="undefined"!=typeof console;function Vt(t,e,i){var n=[e].concat([].slice.call(i));jt&&console[t].apply(console,n)}t.LoggerLevel=void 0,(Ut=t.LoggerLevel||(t.LoggerLevel={}))[Ut.None=0]="None",Ut[Ut.Error=1]="Error",Ut[Ut.Warn=2]="Warn",Ut[Ut.Info=3]="Info",Ut[Ut.Debug=4]="Debug";var Wt=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.LoggerLevel.None,n=arguments.length>1?arguments[1]:void 0;r(this,e),this._onErrorHandler=[],this._level=i,this._method=n}return o(e,[{key:"addErrorHandler",value:function(t){this._onErrorHandler.find((function(e){return e===t}))||this._onErrorHandler.push(t)}},{key:"removeErrorHandler",value:function(t){var e=this._onErrorHandler.findIndex((function(e){return e===t}));e<0||this._onErrorHandler.splice(e,1)}},{key:"callErrorHandler",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._onErrorHandler.forEach((function(t){return t.apply(void 0,e)}))}},{key:"canLogInfo",value:function(){return this._level>=t.LoggerLevel.Info}},{key:"canLogDebug",value:function(){return this._level>=t.LoggerLevel.Debug}},{key:"canLogError",value:function(){return this._level>=t.LoggerLevel.Error}},{key:"canLogWarn",value:function(){return this._level>=t.LoggerLevel.Warn}},{key:"level",value:function(t){return arguments.length?(this._level=+t,this):this._level}},{key:"error",value:function(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return this._level>=t.LoggerLevel.Error&&(this._onErrorHandler.length?this.callErrorHandler.apply(this,n):Vt(null!==(e=this._method)&&void 0!==e?e:"error","ERROR",n)),this}},{key:"warn",value:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this._level>=t.LoggerLevel.Warn&&Vt(this._method||"warn","WARN",i),this}},{key:"info",value:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this._level>=t.LoggerLevel.Info&&Vt(this._method||"log","INFO",i),this}},{key:"debug",value:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this._level>=t.LoggerLevel.Debug&&Vt(this._method||"log","DEBUG",i),this}}],[{key:"getInstance",value:function(t,i){return e._instance&&$(t)?e._instance.level(t):e._instance||(e._instance=new e(t,i)),e._instance}},{key:"setInstance",value:function(t){return e._instance=t}},{key:"setInstanceLevel",value:function(t){e._instance?e._instance.level(t):e._instance=new e(t)}},{key:"clearInstance",value:function(){e._instance=null}}])}();function Gt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;for(j(n)&&(n=t.length);i<n;){var r=i+n>>>1;zt(t[r],e)>0?n=r:i=r+1}return i}function Yt(t,e,i,n){var r,a,o=null!==(r=null==n?void 0:n.maxIterations)&&void 0!==r?r:100,s=null!==(a=null==n?void 0:n.tolerance)&&void 0!==a?a:1e-10,l=t(e),u=t(i),c=i-e;if(l*u>0)return Wt.getInstance().error("Initial bisect points must have opposite signs"),NaN;if(0===l)return e;if(0===u)return i;for(var h=0;h<o;++h){var d=e+(c/=2),p=t(d);if(p*l>=0&&(e=d),Math.abs(c)<s||0===p)return d}return e+c}Wt._instance=null;var Xt=function(t,e){return Kt(0,t.length,(function(i){return e(t[i])}))},Kt=function(t,e,i){for(var n=t,r=e;n<r;){var a=Math.floor((n+r)/2);i(a)>=0?r=a:n=a+1}return n};function qt(t,e){var i,n=0,r=0,a=0;if(void 0===e){var o,l=s(t);try{for(l.s();!(o=l.n()).done;){var u=o.value;null!=u&&(u=+u)>=u&&(a+=(i=u-r)*(u-(r+=i/++n)))}}catch(t){l.e(t)}finally{l.f()}}else{var c,h=-1,d=s(t);try{for(d.s();!(c=d.n()).done;){var p=c.value;null!=(p=e(p,++h,t))&&(p=+p)>=p&&(a+=(i=p-r)*(p-(r+=i/++n)))}}catch(t){d.e(t)}finally{d.f()}}return n>1?a/(n-1):0}var Zt=function(t,e){var i=t;return!0!==e&&(i=t.sort(zt)),Nt(i,.5)},Jt=Math.sqrt(50),Qt=Math.sqrt(10),$t=Math.sqrt(2);var te=1e-10,ee=1e-10;function ie(t,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:te,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:ee)*Math.max(t,e);return Math.abs(t-e)<=Math.max(i,n)}function ne(t,e,i,n){return t>e&&!ie(t,e,i,n)}function re(t,e,i,n){return t<e&&!ie(t,e,i,n)}var ae=function(t){return U(t)?t:function(){return t}},oe=function(t){var e=null,i=null;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e&&r.every((function(t,i){return t===e[i]}))||(e=r,i=t.apply(void 0,r)),i}},se=function(t){for(var e="",i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)-1;i>=0;)e="".concat(e).concat(t),i-=1;return e},le=function(t,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"right",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",r=t+"",a=e-r.length;return a<=0?r:"left"===i?se(n,a)+r:"center"===i?se(n,Math.floor(a/2))+r+se(n,Math.ceil(a/2)):r+se(n,a)},ue=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right",n=arguments.length>3?arguments[3]:void 0,r=j(n)?"…":n,a=t+"",o=a.length,s=Math.max(0,e-r.length);return o<=e?a:"left"===i?r+a.slice(o-s):"center"===i?a.slice(0,Math.ceil(s/2))+r+a.slice(o-Math.floor(s/2)):a.slice(0,s)+r},ce=function(t,e){var i,n,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(e=e||r.length,t)for(i=0;i<t;i++)a[i]=r[0|Math.random()*e];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",i=0;i<36;i++)a[i]||(n=0|16*Math.random(),a[i]=r[19===i?3&n|8:n]);return a.join("")},he=function(t,e,i){return t<e?e:t>i?i:t},de=function(t,e,i){var n=m(t,2),r=n[0],a=n[1];a<r&&(r=t[1],a=t[0]);var o=a-r;return o>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-o),r+o]};function pe(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}var fe=!1;try{fe="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){fe=!1}function ve(t,e,i){var n,r,a,o,s,l,u=0,c=!1,h=!1,d=!0,p=!e&&0!==e&&fe;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var i=n,a=r;return n=r=void 0,u=e,o=t.apply(a,i)}function v(t,e){return p?(cancelAnimationFrame(s),requestAnimationFrame(t)):setTimeout(t,e)}function g(t){var i=t-l;return void 0===l||i>=e||i<0||h&&t-u>=a}function y(){var t=Date.now();if(g(t))return m(t);s=v(y,function(t){var i=t-u,n=e-(t-l);return h?Math.min(n,a-i):n}(t))}function m(t){return s=void 0,d&&n?f(t):(n=r=void 0,o)}function _(){for(var t=Date.now(),i=g(t),a=arguments.length,d=new Array(a),p=0;p<a;p++)d[p]=arguments[p];if(n=d,r=this,l=t,i){if(void 0===s)return function(t){return u=t,s=v(y,e),c?f(t):o}(l);if(h)return s=v(y,e),f(l)}return void 0===s&&(s=v(y,e)),o}return e=+e||0,G(i)&&(c=!!i.leading,(h="maxWait"in i)&&(a=Math.max(it(i.maxWait)?i.maxWait:0,e)),d="trailing"in i?!!i.trailing:d),_.cancel=function(){void 0!==s&&function(t){if(p)return cancelAnimationFrame(t);clearTimeout(t)}(s),u=0,n=l=r=s=void 0},_.flush=function(){return void 0===s?o:m(Date.now())},_.pending=function(){return void 0!==s},_}function ge(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return G(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),ve(t,e,{leading:n,trailing:r,maxWait:e})}function ye(t,e){return function(i){return t*(1-i)+e*i}}function me(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}function _e(t,e){var i=t.valueOf(),n=e.valueOf(),r=new Date;return function(t){return r.setTime(i*(1-t)+n*t),r}}fe=!1;var be=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xe=new RegExp(be.source,"g");var ke=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Se(t){if(t instanceof Date)return t;if(q(t)){var e=ke.exec(t);if(!e)return new Date(NaN);if(!e[8])return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0);var i=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(i-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,i,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}return j(t)?new Date(NaN):new Date(Math.round(t))}function Ae(t){if(it(t))return t;var e=+t;return it(e)?e:0}var Ce=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},Me=function(t){return t.charAt(0).toUpperCase()+t.substring(1)};function we(t){return parseFloat("0."+Math.sin(t).toString().substring(6))}var Te=4294967296;function De(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(){return(t=(1664525*t+1013904223)%Te)/Te}}var Ee=function(){var t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return function(){return e[t=(t+1)%e.length]}},Be=function(t){return function(e){return ht(e,t)}},Pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(U(t))return t;var i=[t];return(e&&e.get||Be)(i)},Re=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Z(t)){var i=t.map((function(t){return Pe(t,e)}));return function(t){return i.map((function(e){return e(t)}))}}return Pe(t,e)},Le=function(t){return t?"string"==typeof t||"number"==typeof t?function(){return t}:U(t)?t:function(e){return e[t.field]}:null},Ie=function(t,e){return j(t)?e:q(t)?e*parseFloat(t)/100:t},Fe=function(t){return 0},Oe=function(t,e){var i,n,r=U(e)?e:function(t){return t};if(t&&t.length){for(var a=t.length,o=0;o<a;o+=1){var s=r(t[o]);j(s)||!$(s=+s)||Number.isNaN(s)||(j(i)?(i=s,n=s):(i=Math.min(i,s),n=Math.max(n,s)))}return[i,n]}return[i,n]};function ze(t){if(t<=0||t>=1)return 0;var e,i,n=-.00778489400243029,r=-.322396458041136,a=-2.40075827716184,o=-2.54973253934373,s=4.37466414146497,l=2.93816398269878,u=.00778469570904146,c=.32246712907004,h=2.445134137143,d=3.75440866190742;return t<.02425?(((((n*(e=Math.sqrt(-2*Math.log(t)))+r)*e+a)*e+o)*e+s)*e+l)/((((u*e+c)*e+h)*e+d)*e+1):t<=.97575?(((((-39.6968302866538*(i=(e=t-.5)*e)+220.946098424521)*i-275.928510446969)*i+138.357751867269)*i-30.6647980661472)*i+2.50662827745924)*e/(((((-54.4760987982241*i+161.585836858041)*i-155.698979859887)*i+66.8013118877197)*i-13.2806815528857)*i+1):-(((((n*(e=Math.sqrt(-2*Math.log(1-t)))+r)*e+a)*e+o)*e+s)*e+l)/((((u*e+c)*e+h)*e+d)*e+1)}function He(t,e,i,n){for(var r=1/0,a=-1/0,o=0,s=0,l=0;l<t.length;l++){var u=t[l],c=e(u),h=i(u);!j(c)&&(c=+c)>=c&&!j(h)&&(h=+h)>=h&&(c<r&&(r=c),c>a&&(a=c),o++,s+=c)}if(0===o)return{min:r,max:a,n:o,X:0,SSE:0,Sxx:0};for(var d=s/o,p=0,f=0,v=0;v<t.length;v++){var g=t[v],y=e(g),m=i(g);if(!j(y)&&(y=+y)>=y&&!j(m)&&(m=+m)>=m){var _=m-n(y);p+=_*_;var b=y-d;f+=b*b}}return{min:r,max:a,n:o,X:d,SSE:p,Sxx:f}}function Ne(t,e){var i=e.n,n=e.X,r=e.Sxx,a=e.SSE,o=i>2?a/(i-2):0;return{seMean:r>0?Math.sqrt(o*(1/i+(t-n)*(t-n)/r)):Math.sqrt(o/i),sePred:Math.sqrt(o*(1+1/i+(r>0?(t-n)*(t-n)/r:0)))}}function Ue(t,e,i,n){var r=n-t*t;if(Math.abs(r)<Number.EPSILON)return{a:e,b:0};var a=(i-t*e)/r;return{a:e-a*t,b:a}}function je(t,e,i,n){for(var r=0;r<t.length;r++){var a=t[r],o=e(a),s=i(a);!j(o)&&(o=+o)>=o&&!j(s)&&(s=+s)>=s&&n(o,s,r)}}function Ve(t,e,i,n,r){for(var a=0,o=0,s=0;s<t.length;s++){var l=t[s],u=i(l);if(!j(u)&&(u=+u)>=u){var c=u-r(e(l));a+=c*c;var h=u-n;o+=h*h}}return 0===o?0:1-a/o}function We(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},n=0,r=0,a=0,o=0,s=0;je(t,e,i,(function(t,e){n++,r+=(t-r)/n,a+=(e-a)/n,o+=(t*e-o)/n,s+=(t*t-s)/n}));var l=Ue(r,a,o,s),u=l.a,c=l.b,h=function(t){return u+c*t},d=He(t,e,i,h);return{coef:{a:u,b:c},predict:h,rSquared:Ve(t,e,i,a,h),evaluateGrid:function(t){var e=[];if(0===d.n||t<=0)return e;if(d.min===d.max){for(var i=0;i<t;i++)e.push({x:d.min,y:h(d.min)});return e}for(var n=(d.max-d.min)/(t-1),r=0;r<t;r++){var a=r===t-1?d.max:d.min+n*r;e.push({x:a,y:h(a)})}return e},confidenceInterval:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05,i=[];if(0===d.n||t<=0)return i;var n=ze(1-e/2);if(d.min===d.max){for(var r=h(d.min),a=Ne(d.min,d),o=0;o<t;o++)i.push({x:d.min,mean:r,lower:r-n*a.seMean,upper:r+n*a.seMean,predLower:r-n*a.sePred,predUpper:r+n*a.sePred});return i}for(var s=(d.max-d.min)/(t-1),l=0;l<t;l++){var u=l===t-1?d.max:d.min+s*l,c=h(u),p=Ne(u,d);i.push({x:u,mean:c,lower:c-n*p.seMean,upper:c+n*p.seMean,predLower:c-n*p.sePred,predUpper:c+n*p.sePred})}return i}}}function Ge(t){var e=Math.abs(t);if(e>=1)return 0;var i=1-e*e*e;return i*i*i}var Ye=function(t){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*t*t)};function Xe(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t<=0||0===e?0:e*Math.pow(t,-1/(i+4))}function Ke(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t<=0||0===e?0:Math.pow(4/(i+2),1/(i+4))*e*Math.pow(t,-1/(i+4))}var qe=o((function t(){r(this,t)})),Ze=function(){return o((function t(){r(this,t),this.items={},this.itemList=[]}),[{key:"type",get:function(){return"xhHashTable"}},{key:"set",value:function(t,e){var i=new qe;i.key=t,i.value=e;var n=this.itemList.length;return this.has(t)&&(n=this.items[t].index),i.index=n,this.itemList[n]=i,this.items[t]=i,i}},{key:"clear",value:function(){this.items={},this.itemList=[]}},{key:"del",value:function(t){if(this.has(t)){var e=this.items[t].index;e>-1&&this.itemList.splice(e,1),delete this.items[t],this.resetIndex()}}},{key:"delFrom",value:function(t){for(var e=t+1;e<this.count();e++){var i=this.itemList[e].key;delete this.items[i]}this.itemList.splice(t+1,this.count()-t),this.resetIndex()}},{key:"resetIndex",value:function(){var t=this;this.foreachHashv((function(e,i){var n=t.itemList.indexOf(i);t.items[e].index=n}))}},{key:"has",value:function(t){return t in this.items}},{key:"get",value:function(t){return this.has(t)?this.items[t].value:null}},{key:"count",value:function(){return this.itemList.length}},{key:"all",value:function(){return this.itemList.map((function(t){return t.value}))}},{key:"first",value:function(){return this.itemList[0].value}},{key:"last",value:function(){return this.itemList[this.itemList.length-1].value}},{key:"getByIndex",value:function(t){return this.itemList[t].value}},{key:"getKeyByIndex",value:function(t){return this.itemList[t].key}},{key:"foreach",value:function(t){for(var e in this.items)if(!1===t(e,this.items[e].value))return!1;return!0}},{key:"foreachHashv",value:function(t){for(var e in this.items)if(!1===t(e,this.items[e]))return!1;return!0}},{key:"hasValue",value:function(t){for(var e in this.items)if(this.items[e].value===t)return!0;return!1}},{key:"indexOf",value:function(t){return this.has(t)?this.items[t].index:-1}},{key:"insertAt",value:function(t,e,i){var n=new qe;n.index=t,n.key=i,n.value=e,this.itemList.splice(t,0,n),this.items[i]=n,this.resetIndex()}},{key:"sort",value:function(t){return this.itemList.sort((function(e,i){return t(e.value,i.value)}))}},{key:"toArray",value:function(){return this.itemList.slice(0,this.itemList.length).map((function(t){return t.value}))}},{key:"push",value:function(t){var e=this;t.foreach((function(t,i){e.set(t,i)}))}},{key:"mapKey",value:function(){var t=[];for(var e in this.items)t.push(e);return t}},{key:"toImmutableMap",value:function(){}}])}(),Je=1e-12,Qe=Math.PI,$e=Qe/2,ti=2*Qe,ei=2*Math.PI,ii=Math.abs,ni=Math.atan2,ri=Math.cos,ai=Math.max,oi=Math.min,si=Math.sin,li=Math.sqrt,ui=Math.pow;function ci(t){return t>1?0:t<-1?Qe:Math.acos(t)}function hi(t){return t>=1?$e:t<=-1?-$e:Math.asin(t)}function di(t,e,i,n,r){var a=i,o=n;return"number"==typeof t&&"number"==typeof i&&(a=(1-r)*t+r*i),"number"==typeof e&&"number"==typeof n&&(o=(1-r)*e+r*n),{x:a,y:o}}function pi(t,e,i){var n=i.x-e.x,r=i.y-e.y,a=t.x-e.x,o=t.y-e.y;return Math.abs(n*o-a*r)/Math.sqrt(n*n+r*r)}function fi(t,e){return t[0]*e[1]-t[1]*e[0]}function vi(t,e){return t.x*e.y-t.y*e.x}function gi(t,e){for(var i=0,n=0;n<t.length;++n)i+=t[n]*e[n];return i}function yi(t,e){return ii(t[0]-e[0])+ii(t[1]-e[1])<1e-12}function mi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Math.round(t*e)/e}function _i(t){var e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function bi(t,e){return mi(t+e,Math.pow(10,Math.max(_i(t),_i(e))))}function xi(t,e){return mi(t-e,Math.pow(10,Math.max(_i(t),_i(e))))}var ki=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;r(this,t),this.x=0,this.y=0,this.x=e,this.y=i,this.x1=n,this.y1=a}return o(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"add",value:function(t){return $(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}},{key:"sub",value:function(t){return $(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}},{key:"multi",value:function(t){throw new Error("暂不支持")}},{key:"div",value:function(t){throw new Error("暂不支持")}}])}(),Si=function(){return o((function t(){r(this,t)}),null,[{key:"distancePP",value:function(t,e){return li(ui(t.x-e.x,2)+ui(t.y-e.y,2))}},{key:"distanceNN",value:function(t,e,i,n){return li(ui(t-i,2)+ui(e-n,2))}},{key:"distancePN",value:function(t,e,i){return li(ui(e-t.x,2)+ui(i-t.y,2))}},{key:"pointAtPP",value:function(t,e,i){return new ki((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}])}(),Ai=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;r(this,t),this.r=0,this.theta=0,this.r=e,this.theta=i,this.r1=n,this.theta1=a}return o(t,[{key:"clone",value:function(){return new t(this.r,this.theta)}},{key:"copyFrom",value:function(t){return this.r=t.r,this.theta=t.theta,this.r1=t.r1,this.theta1=t.theta1,this.defined=t.defined,this.context=t.context,this}},{key:"set",value:function(t,e){return this.r=t,this.theta=e,this}}])}();function Ci(t){return t*(Math.PI/180)}function Mi(t){return 180*t/Math.PI}var wi,Ti=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<-ti;)t+=ti;else if(t>0)for(;t>ti;)t-=ti;return t},Di=Ti,Ei=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>360||t<-360?t%360:t},Bi=Ei;function Pi(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function Ri(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI,r=t.x,a=t.y,o=r-e.x,s=a-e.y,l=Math.sqrt(o*o+s*s);if(0===l)return{radius:0,angle:0};o/=l,s/=l;var u=Math.atan2(s,o);if(u<i)for(;u<=i;)u+=2*Math.PI;if(u>n)for(;u>=n;)u-=2*Math.PI;return{radius:l,angle:u}}function Li(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function Ii(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function Fi(t,e){var i=Math.abs(e-t);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];for(var n=Ii(Math.min(t,e)),r=n+i,a=[n,r],o=Math.floor(n/Math.PI)*Math.PI/2;o<r;)o>n&&a.push(o),o+=Math.PI/2;return a}function Oi(t,e,i,n){var r=e.x,a=e.y,o=Fi(i,n),s=t.width,l=t.height,u=[];return o.forEach((function(t){var e=Math.sin(t),i=Math.cos(t);1===e?u.push(l-a):-1===e?u.push(a):1===i?u.push(s-r):-1===i?u.push(r):(e>0?u.push(Math.abs((l-a)/e)):u.push(Math.abs(a/e)),i>0?u.push(Math.abs((s-r)/i)):u.push(Math.abs(r/i)))})),Math.min.apply(null,u)}function zi(t){return(t=Ii(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}function Hi(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function Ni(t,e,i,n){var r,a,o,s,l=t[0],u=e[0],c=i[0],h=n[0];return u<l&&(l=(r=[u,l])[0],u=r[1]),h<c&&(h=(a=[c,h])[0],c=a[1]),!(u<c||h<l||(l=t[1],u=e[1],c=i[1],h=n[1],u<l&&(o=[u,l],l=o[0],u=o[1]),h<c&&(s=[c,h],h=s[0],c=s[1]),u<c||h<l))}function Ui(t,e,i,n){if(!Ni(t,e,i,n))return!1;var r=[0,0],a=[0,0],o=[0,0];if(Hi(r,e,t),Hi(a,n,i),yi(r,a))return!0;Hi(o,i,t);var s=fi(o,a)/fi(r,a);return s>=0&&s<=1&&[t[0]+r[0]*s,t[1]+r[1]*s]}function ji(t,e,i){if(null===t)return e;if(null===e)return t;var n=en(t,e,i),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return r>=u||a<=l||o>=h||s<=c?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,l),y1:Math.max(o,c),x2:Math.min(a,u),y2:Math.min(s,h)}}t.InnerBBox=void 0,(wi=t.InnerBBox||(t.InnerBBox={}))[wi.NONE=0]="NONE",wi[wi.BBOX1=1]="BBOX1",wi[wi.BBOX2=2]="BBOX2";var Vi,Wi,Gi,Yi,Xi,Ki,qi,Zi,Ji,Qi,$i,tn,en=function(t,e,i){var n,r,a,o,s=t.x1,l=t.x2,u=t.y1,c=t.y2,h=e.x1,d=e.x2,p=e.y1,f=e.y2;return i&&(s>l&&(s=(n=[l,s])[0],l=n[1]),u>c&&(u=(r=[c,u])[0],c=r[1]),h>d&&(h=(a=[d,h])[0],d=a[1]),p>f&&(p=(o=[f,p])[0],f=o[1])),{x11:s,x12:l,y11:u,y12:c,x21:h,x22:d,y21:p,y22:f}};function nn(e,i,n){if(!e||!i)return t.InnerBBox.NONE;var r=en(e,i,n),a=r.x11,o=r.x12,s=r.y11,l=r.y12,u=r.x21,c=r.x22,h=r.y21,d=r.y22;return a>u&&o<c&&s>h&&l<d?t.InnerBBox.BBOX1:u>a&&c<o&&h>s&&d<l?t.InnerBBox.BBOX2:t.InnerBBox.NONE}function rn(t,e,i){if(t&&e){if(!i)return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1);var n=en(t,e,!0),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return!(r>u||a<l||o>h||s<c)}return!0}function an(t,e,i){var n,r;if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;var a=e.x1,o=e.x2,s=e.y1,l=e.y2;return a>o&&(a=(n=[o,a])[0],o=n[1]),s>l&&(s=(r=[l,s])[0],l=r[1]),t.x>=a&&t.x<=o&&t.y>=s&&t.y<=l}function on(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function sn(t,e){var i=t.x,n=t.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};return{x:(i-r.x)*Math.cos(e)-(n-r.y)*Math.sin(e)+r.x,y:(i-r.x)*Math.sin(e)+(n-r.y)*Math.cos(e)+r.y}}function ln(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function un(t,e){var i=e?Ci(t.angle):t.angle,n=ln(t);return[sn({x:t.x1,y:t.y1},i,n),sn({x:t.x2,y:t.y1},i,n),sn({x:t.x2,y:t.y2},i,n),sn({x:t.x1,y:t.y2},i,n)]}function cn(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=un(t,i),r=un(e,i),a=function(t,e){return[e.x-t.x,e.y-t.y]},o=a(ln(t),ln(e)),s=a(n[0],n[1]),l=a(n[1],n[2]),u=a(r[0],r[1]),c=a(r[1],r[2]),h=i?Ci(t.angle):t.angle,d=i?Ci(90-t.angle):t.angle+$e,p=i?Ci(e.angle):e.angle,f=i?Ci(90-e.angle):e.angle+$e;d>ei&&(d-=ei),f>ei&&(f-=ei);var v=function(t,e,i,n){var r=[Math.cos(e),Math.sin(e)];return t+(on(r,i)+on(r,n))/2>on(r,o)};return v((t.x2-t.x1)/2,h,u,c)&&v((t.y2-t.y1)/2,d,u,c)&&v((e.x2-e.x1)/2,p,s,l)&&v((e.y2-e.y1)/2,f,s,l)}function hn(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t.x1,o=t.x2,s=t.y1,l=t.y2,u=e.x1,c=e.x2,h=e.y1,d=e.y2;r&&(a>o&&(i=a,a=o,o=i),s>l&&(i=s,s=l,l=i),u>c&&(i=u,u=c,c=i),h>d&&(i=h,h=d,d=i));if(a>=c||o<=u||s>=d||l<=h)return[t,e];var p=(o-a+2*n)*(l-s+2*n),f=(c-u+2*n)*(d-h+2*n),v=Math.min(a,u),g=Math.min(s,h),y=Math.max(o,c),m=Math.max(l,d);return p+f>(y-v)*(m-g)?[{x1:v,x2:y,y1:g,y2:m}]:[t,e]}var dn={x:0,y:0},pn={x:0,y:0};function fn(t,e,i,n){return pi(t,e,i)<=n/2&&mn(t,e,i)}var vn={x:0,y:0},gn={x:0,y:0},yn={x:0,y:0};function mn(t,e,i){return vn.x=e.x-t.x,vn.y=e.y-t.y,gn.x=i.x-t.x,gn.y=i.y-t.y,yn.x=e.y-i.y,yn.y=i.x-e.x,vi(vn,yn)*vi(gn,yn)<0}var _n=function(){function t(e){r(this,t),this.canvas=e,e&&(this.ctx=e.getContext("2d"))}return o(t,[{key:"setCanvas",value:function(t){this.canvas=t,t&&(this.ctx=t.getContext("2d"))}},{key:"measureText",value:function(t){return this.canvas?this.measureTextByCanvas(t):(console.warn("[warn] no canvas, measureText might be not accurate"),this.estimate(t))}},{key:"measureTextByCanvas",value:function(t){return this.ctx?(this.ctx.font=(i=(e=t).fontStyle,n=e.fontVariant,r=e.fontWeight,(i?i+" ":"")+(n?n+" ":"")+(r?r+" ":"")+(e.fontSize||12)+"px "+(e.fontFamily||"sans-serif")),{width:this.ctx.measureText(t.text).width,height:t.fontSize}):(console.error("[error!!!]measureTextByCanvas can not be called without canvas"),{width:-1,height:t.fontSize});var e,i,n,r}},{key:"estimate",value:function(t){for(var e=t.text,i=t.fontSize,n=0,r=0,a=0;a<e.length;a++)e.charCodeAt(a)<128?n++:r++;return{width:~~(.8*n*i+r*i),height:i}}}],[{key:"getDefaultUtils",value:function(e){return t.instance||(t.instance=new t(e)),t.instance}}])}(),bn=1e-8;function xn(t,e,i,n,r){for(var a=0,o=r[r.length-1];a<r.length;a++){var s=r[a];if(Ni([t,e],[i,n],[s.x,s.y],[o.x,o.y]))return!0;o=s}return!1}function kn(t,e,i){var n=0,r=t[0];if(!r)return!1;for(var a=1;a<t.length;a++){var o=t[a];n+=Sn(r.x,r.y,o.x,o.y,e,i),r=o}var s=t[0];return An(r.x,s.x)&&An(r.y,s.y)||(n+=Sn(r.x,r.y,s.x,s.y,e,i)),0!==n}function Sn(t,e,i,n,r,a){if(a>e&&a>n||a<e&&a<n)return 0;if(n===e)return 0;var o=(a-e)/(n-e),s=n<e?1:-1;1!==o&&0!==o||(s=n<e?.5:-.5);var l=o*(i-t)+t;return l===r?1/0:l>r?s:0}function An(t,e){return Math.abs(t-e)<bn}function Cn(t,e){for(var i=0;i<e.length;i++){if(kn(t,e[i].x,e[i].y))return!0;if(i>0&&xn(e[i-1].x,e[i-1].y,e[i].x,e[i].y,t))return!0}return!1}var Mn=function(t){if("string"!=typeof t)throw new TypeError("Expected a `string`, got `".concat(k(t),"`"));return t.replace(wn(),"")},wn=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onlyFirst,e=void 0!==t&&t,i=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(i,e?void 0:"g")},Tn=function(t){var e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,n=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(n=(e&=1023)<<10|(i&=1023),n+=65536),12288===n||65281<=n&&n<=65376||65504<=n&&n<=65510?"F":8361===n||65377<=n&&n<=65470||65474<=n&&n<=65479||65482<=n&&n<=65487||65490<=n&&n<=65495||65498<=n&&n<=65500||65512<=n&&n<=65518?"H":4352<=n&&n<=4447||4515<=n&&n<=4519||4602<=n&&n<=4607||9001<=n&&n<=9002||11904<=n&&n<=11929||11931<=n&&n<=12019||12032<=n&&n<=12245||12272<=n&&n<=12283||12289<=n&&n<=12350||12353<=n&&n<=12438||12441<=n&&n<=12543||12549<=n&&n<=12589||12593<=n&&n<=12686||12688<=n&&n<=12730||12736<=n&&n<=12771||12784<=n&&n<=12830||12832<=n&&n<=12871||12880<=n&&n<=13054||13056<=n&&n<=19903||19968<=n&&n<=42124||42128<=n&&n<=42182||43360<=n&&n<=43388||44032<=n&&n<=55203||55216<=n&&n<=55238||55243<=n&&n<=55291||63744<=n&&n<=64255||65040<=n&&n<=65049||65072<=n&&n<=65106||65108<=n&&n<=65126||65128<=n&&n<=65131||110592<=n&&n<=110593||127488<=n&&n<=127490||127504<=n&&n<=127546||127552<=n&&n<=127560||127568<=n&&n<=127569||131072<=n&&n<=194367||177984<=n&&n<=196605||196608<=n&&n<=262141?"W":32<=n&&n<=126||162<=n&&n<=163||165<=n&&n<=166||172===n||175===n||10214<=n&&n<=10221||10629<=n&&n<=10630?"Na":161===n||164===n||167<=n&&n<=168||170===n||173<=n&&n<=174||176<=n&&n<=180||182<=n&&n<=186||188<=n&&n<=191||198===n||208===n||215<=n&&n<=216||222<=n&&n<=225||230===n||232<=n&&n<=234||236<=n&&n<=237||240===n||242<=n&&n<=243||247<=n&&n<=250||252===n||254===n||257===n||273===n||275===n||283===n||294<=n&&n<=295||299===n||305<=n&&n<=307||312===n||319<=n&&n<=322||324===n||328<=n&&n<=331||333===n||338<=n&&n<=339||358<=n&&n<=359||363===n||462===n||464===n||466===n||468===n||470===n||472===n||474===n||476===n||593===n||609===n||708===n||711===n||713<=n&&n<=715||717===n||720===n||728<=n&&n<=731||733===n||735===n||768<=n&&n<=879||913<=n&&n<=929||931<=n&&n<=937||945<=n&&n<=961||963<=n&&n<=969||1025===n||1040<=n&&n<=1103||1105===n||8208===n||8211<=n&&n<=8214||8216<=n&&n<=8217||8220<=n&&n<=8221||8224<=n&&n<=8226||8228<=n&&n<=8231||8240===n||8242<=n&&n<=8243||8245===n||8251===n||8254===n||8308===n||8319===n||8321<=n&&n<=8324||8364===n||8451===n||8453===n||8457===n||8467===n||8470===n||8481<=n&&n<=8482||8486===n||8491===n||8531<=n&&n<=8532||8539<=n&&n<=8542||8544<=n&&n<=8555||8560<=n&&n<=8569||8585===n||8592<=n&&n<=8601||8632<=n&&n<=8633||8658===n||8660===n||8679===n||8704===n||8706<=n&&n<=8707||8711<=n&&n<=8712||8715===n||8719===n||8721===n||8725===n||8730===n||8733<=n&&n<=8736||8739===n||8741===n||8743<=n&&n<=8748||8750===n||8756<=n&&n<=8759||8764<=n&&n<=8765||8776===n||8780===n||8786===n||8800<=n&&n<=8801||8804<=n&&n<=8807||8810<=n&&n<=8811||8814<=n&&n<=8815||8834<=n&&n<=8835||8838<=n&&n<=8839||8853===n||8857===n||8869===n||8895===n||8978===n||9312<=n&&n<=9449||9451<=n&&n<=9547||9552<=n&&n<=9587||9600<=n&&n<=9615||9618<=n&&n<=9621||9632<=n&&n<=9633||9635<=n&&n<=9641||9650<=n&&n<=9651||9654<=n&&n<=9655||9660<=n&&n<=9661||9664<=n&&n<=9665||9670<=n&&n<=9672||9675===n||9678<=n&&n<=9681||9698<=n&&n<=9701||9711===n||9733<=n&&n<=9734||9737===n||9742<=n&&n<=9743||9748<=n&&n<=9749||9756===n||9758===n||9792===n||9794===n||9824<=n&&n<=9825||9827<=n&&n<=9829||9831<=n&&n<=9834||9836<=n&&n<=9837||9839===n||9886<=n&&n<=9887||9918<=n&&n<=9919||9924<=n&&n<=9933||9935<=n&&n<=9953||9955===n||9960<=n&&n<=9983||10045===n||10071===n||10102<=n&&n<=10111||11093<=n&&n<=11097||12872<=n&&n<=12879||57344<=n&&n<=63743||65024<=n&&n<=65039||65533===n||127232<=n&&n<=127242||127248<=n&&n<=127277||127280<=n&&n<=127337||127344<=n&&n<=127386||917760<=n&&n<=917999||983040<=n&&n<=1048573||1048576<=n&&n<=1114109?"A":"N"},Dn=function(){return/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC08\uDC26](?:\u200D\u2B1B)?|[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g};function En(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;i||(i=1);var n=t.fontStyle,r=void 0===n?e.fontStyle:n,a=t.fontVariant,o=void 0===a?e.fontVariant:a,s=t.fontWeight,l=void 0===s?e.fontWeight:s,u=t.fontSize,c=void 0===u?e.fontSize:u,h=t.fontFamily;return(r?r+" ":"")+(o?o+" ":"")+(l?l+" ":"")+c*i+"px "+((void 0===h?e.fontFamily:h)||"sans-serif")}var Bn=function(){function t(e,i){r(this,t),this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=e,this._userSpec=null!=i?i:{},this.textSpec=this._initSpec(),W(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=W(e.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}return o(t,[{key:"initContext",value:function(){if(this._notSupportCanvas)return!1;if(j(this._canvas)&&(W(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),j(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&W(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),j(this._context)&&W(this._canvas)){var t=this._canvas.getContext("2d");W(t)&&(t.save(),t.font=En(this.textSpec),this._contextSaved=!0,this._context=t)}return!j(this._context)||(this._notSupportCanvas=!0,!1)}},{key:"_initSpec",value:function(){var t,e,i,n=this._option.defaultFontParams,r=void 0===n?{}:n,a=this._userSpec,o=a.fontStyle,s=void 0===o?r.fontStyle:o,l=a.fontVariant,u=void 0===l?r.fontVariant:l,c=a.fontWeight,h=void 0===c?null!==(t=r.fontWeight)&&void 0!==t?t:"normal":c,d=a.fontSize,p=void 0===d?null!==(e=r.fontSize)&&void 0!==e?e:12:d,f=a.fontFamily,v=void 0===f?null!==(i=r.fontFamily)&&void 0!==i?i:"sans-serif":f,g=a.align,y=a.textAlign,m=void 0===y?null!=g?g:"center":y,_=a.baseline,b=a.textBaseline,x=void 0===b?null!=_?_:"middle":b,k=a.ellipsis,S=a.limit,A=this._userSpec.lineHeight,C=void 0===A?p:A;if(q(C)&&"%"===C[C.length-1]){var M=Number.parseFloat(C.substring(0,C.length-1))/100;C=p*M}return{fontStyle:s,fontVariant:u,fontFamily:v,fontSize:p,fontWeight:h,textAlign:m,textBaseline:x,ellipsis:k,limit:S,lineHeight:C}}},{key:"measure",value:function(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}},{key:"fullMeasure",value:function(t){if(j(t))return{width:0,height:0};if(j(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);var e,i=this.textSpec,n=i.fontFamily,r=i.fontSize,a=i.fontWeight,o=i.textAlign,s=i.textBaseline,l=i.ellipsis,u=i.limit,c=i.lineHeight;try{var h=this._option.getTextBounds({text:t,fontFamily:n,fontSize:r,fontWeight:a,textAlign:o,textBaseline:s,ellipsis:!!l,maxLineWidth:u||1/0,lineHeight:c});e={width:h.width(),height:h.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}},{key:"measureWithNaiveCanvas",value:function(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}},{key:"_measureWithNaiveCanvas",value:function(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);var i=this._context.measureText(t),n=this.textSpec,r=n.fontSize,a=n.lineHeight;return{width:i.width,height:null!==(e=a)&&void 0!==e?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}},{key:"quickMeasure",value:function(t){return this._measureReduce(t,this._quickMeasure.bind(this))}},{key:"_quickMeasure",value:function(e){for(var i={width:0,height:0},n=0;n<e.length;n++){var r=e[n],a=this._measureSpecialChar(r);j(a)&&t.NUMBERS_CHAR_SET.includes(r)&&(a=this._measureNumberChar()),j(a)&&["F","W"].includes(Tn(r))&&(a=this._measureFullSizeChar()),j(a)&&(a=this._measureLetterChar()),i.width+=a.width,i.height=Math.max(i.height,a.height),!j(a.fontBoundingBoxAscent)&&(i.fontBoundingBoxAscent=a.fontBoundingBoxAscent),!j(a.fontBoundingBoxDescent)&&(i.fontBoundingBoxDescent=a.fontBoundingBoxDescent)}return i}},{key:"quickMeasureWithoutCanvas",value:function(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}},{key:"_quickMeasureWithoutCanvas",value:function(t){for(var e,i={width:0,height:0},n=this.textSpec,r=n.fontSize,a=n.lineHeight,o=0;o<t.length;o++){var s=t[o],l=["F","W"].includes(Tn(s))?1:.53;i.width+=l*r}return i.height=null!==(e=a)&&void 0!==e?e:r,i}},{key:"_measureReduce",value:function(t,e){var i,n=this.textSpec,r=n.fontSize,a=n.lineHeight,o={width:0,height:0};if(j(t))return o;if(Z(t)){var s=t.filter(W).map((function(t){return t.toString()}));return 0===s.length?o:1===s.length?e(s[0]):{width:s.reduce((function(t,i){return Math.max(t,e(i).width)}),0),height:s.length*((null!==(i=a)&&void 0!==i?i:r)+1)+1}}return e(t.toString())}},{key:"_measureNumberChar",value:function(){if(j(this._numberCharSize)){var e=this._standardMethod(t.NUMBERS_CHAR_SET);this._numberCharSize={width:e.width/t.NUMBERS_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._numberCharSize}},{key:"_measureFullSizeChar",value:function(){return j(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(t.FULL_SIZE_CHAR)),this._fullCharSize}},{key:"_measureLetterChar",value:function(){if(j(this._letterCharSize)){var e=this._standardMethod(t.ALPHABET_CHAR_SET);this._letterCharSize={width:e.width/t.ALPHABET_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._letterCharSize}},{key:"_measureSpecialChar",value:function(t){return W(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}},{key:"release",value:function(){W(this._canvas)&&(this._canvas=null),W(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}])}();Bn.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",Bn.NUMBERS_CHAR_SET="0123456789",Bn.FULL_SIZE_CHAR="字";var Pn=function(t,e){var i=t.x1,n=t.x2,r=t.y1,a=t.y2,o=Math.abs(n-i),s=Math.abs(a-r),l=(i+n)/2,u=(r+a)/2,c=0,h=0;switch(e){case"top":case"inside-top":h=-.5;break;case"bottom":case"inside-bottom":h=.5;break;case"left":case"inside-left":c=-.5;break;case"right":case"inside-right":c=.5;break;case"top-right":c=.5,h=-.5;break;case"top-left":c=-.5,h=-.5;break;case"bottom-right":c=.5,h=.5;break;case"bottom-left":c=-.5,h=.5}return{x:l+=c*o,y:u+=h*s}},Rn=function(t,e){return Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)},Ln=function(t,e){function i(t,e,i){var n=t.getRotatedCorners().map((function(t){return t.x*e+t.y*i}));return{min:Math.min.apply(Math,b(n)),max:Math.max.apply(Math,b(n))}}for(var n=0,r=0,a=[{x:Math.cos(t.angle),y:Math.sin(t.angle)},{x:-Math.sin(t.angle),y:Math.cos(t.angle)},{x:Math.cos(e.angle),y:Math.sin(t.angle)},{x:-Math.sin(e.angle),y:Math.cos(t.angle)}];r<a.length;r++){var o,s=a[r],l=i(t,s.x,s.y),u=i(e,s.x,s.y);o=l.max<u.min?u.min-l.max:u.max<l.min?l.min-u.max:0,n=Math.max(n,o)}return n};function In(t,e,i){var n=e.x1,r=e.y1,a=e.x2,o=e.y2;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f),e):(t.clear(),t.add(i.a*n+i.c*r+i.e,i.b*n+i.d*r+i.f),t.add(i.a*a+i.c*r+i.e,i.b*a+i.d*r+i.f),t.add(i.a*a+i.c*o+i.e,i.b*a+i.d*o+i.f),t.add(i.a*n+i.c*o+i.e,i.b*n+i.d*o+i.f),e)}var Fn=function(){function t(e){r(this,t),e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}return o(t,[{key:"clone",value:function(){return new t(this)}},{key:"clear",value:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}},{key:"empty",value:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}},{key:"equals",value:function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.x1=t,this.y1=e,this.x2=i,this.y2=n,this}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),n<e?(this.y2=e,this.y1=n):(this.y1=e,this.y2=n),this}},{key:"add",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}},{key:"expand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Z(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}},{key:"round",value:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}},{key:"translate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}},{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.rotatedPoints(t,e,i);return this.clear().add(n[0],n[1]).add(n[2],n[3]).add(n[4],n[5]).add(n[6],n[7])}},{key:"scale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.scalePoints(t,e,i,n);return this.clear().add(r[0],r[1]).add(r[2],r[3])}},{key:"union",value:function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}},{key:"intersect",value:function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}},{key:"encloses",value:function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}},{key:"alignsWith",value:function(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}},{key:"intersects",value:function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}},{key:"contains",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}},{key:"containsPoint",value:function(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}},{key:"width",value:function(){return this.empty()?0:this.x2-this.x1}},{key:"height",value:function(){return this.empty()?0:this.y2-this.y1}},{key:"scaleX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x1*=t,this.x2*=t,this}},{key:"scaleY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.y1*=t,this.y2*=t,this}},{key:"transformWithMatrix",value:function(t){return In(this,this,t),this}},{key:"copy",value:function(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}},{key:"rotatedPoints",value:function(t,e,i){var n=this.x1,r=this.y1,a=this.x2,o=this.y2,s=Math.cos(t),l=Math.sin(t),u=e-e*s+i*l,c=i-e*l-i*s;return[s*n-l*r+u,l*n+s*r+c,s*n-l*o+u,l*n+s*o+c,s*a-l*r+u,l*a+s*r+c,s*a-l*o+u,l*a+s*o+c]}},{key:"scalePoints",value:function(t,e,i,n){return[t*this.x1+(1-t)*i,e*this.y1+(1-e)*n,t*this.x2+(1-t)*i,e*this.y2+(1-e)*n]}}])}(),On=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(Fn),zn=function(t){function e(t){var i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(this,e),i=n(this,e,[t]),t&&(i.angle=null!==(a=t.angle)&&void 0!==a?a:o),i}return h(e,t),o(e,[{key:"intersects",value:function(t){return cn(this,t)}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return _(e,"setValue",this,3)([t,i,n,r]),this.angle=a,this}},{key:"clone",value:function(){return new e(this)}},{key:"getRotatedCorners",value:function(){var t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[sn({x:this.x1,y:this.y1},this.angle,t),sn({x:this.x2,y:this.y1},this.angle,t),sn({x:this.x1,y:this.y2},this.angle,t),sn({x:this.x2,y:this.y2},this.angle,t)]}}])}(Fn),Hn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r(this,t),this.a=e,this.b=i,this.c=n,this.d=a,this.e=o,this.f=s}return o(t,[{key:"equalToMatrix",value:function(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}},{key:"equalTo",value:function(t,e,i,n,r,a){return!(this.e!==r||this.f!==a||this.a!==t||this.d!==n||this.b!==e||this.c!==i)}},{key:"setValue",value:function(t,e,i,n,r,a){return this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=a,this}},{key:"reset",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}},{key:"getInverse",value:function(){var e=this.a,i=this.b,n=this.c,r=this.d,a=this.e,o=this.f,s=new t,l=e*r-i*n;return s.a=r/l,s.b=-i/l,s.c=-n/l,s.d=e/l,s.e=(n*o-r*a)/l,s.f=-(e*o-i*a)/l,s}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a*e+this.c*i,r=this.b*e+this.d*i,a=this.a*-i+this.c*e,o=this.b*-i+this.d*e;return this.a=n,this.b=r,this.c=a,this.d=o,this}},{key:"rotateByCenter",value:function(t,e,i){var n=Math.cos(t),r=Math.sin(t),a=(1-n)*e+r*i,o=(1-n)*i-r*e,s=n*this.a-r*this.b,l=r*this.a+n*this.b,u=n*this.c-r*this.d,c=r*this.c+n*this.d,h=n*this.e-r*this.f+a,d=r*this.e+n*this.f+o;return this.a=s,this.b=l,this.c=u,this.d=c,this.e=h,this.f=d,this}},{key:"scale",value:function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}},{key:"setScale",value:function(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}},{key:"transform",value:function(t,e,i,n,r,a){return this.multiply(t,e,i,n,r,a),this}},{key:"translate",value:function(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}},{key:"transpose",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.e,a=this.f;return this.a=e,this.b=t,this.c=n,this.d=i,this.e=a,this.f=r,this}},{key:"multiply",value:function(t,e,i,n,r,a){var o=this.a,s=this.b,l=this.c,u=this.d,c=o*t+l*e,h=s*t+u*e,d=o*i+l*n,p=s*i+u*n,f=o*r+l*a+this.e,v=s*r+u*a+this.f;return this.a=c,this.b=h,this.c=d,this.d=p,this.e=f,this.f=v,this}},{key:"interpolate",value:function(e,i){var n=new t;return n.a=this.a+(e.a-this.a)*i,n.b=this.b+(e.b-this.b)*i,n.c=this.c+(e.c-this.c)*i,n.d=this.d+(e.d-this.d)*i,n.e=this.e+(e.e-this.e)*i,n.f=this.f+(e.f-this.f)*i,n}},{key:"transformPoint",value:function(t,e){var i=this.a,n=this.b,r=this.c,a=this.d,o=this.e,s=this.f,l=i*a-n*r,u=a/l,c=-n/l,h=-r/l,d=i/l,p=(r*s-a*o)/l,f=-(i*s-n*o)/l,v=t.x,g=t.y;e.x=v*u+g*h+p,e.y=v*c+g*d+f}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.a===t&&0===this.b&&0===this.c&&this.d===t}},{key:"clone",value:function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"toTransformAttrs",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=t*n-e*i,a={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){var o=Math.sqrt(t*t+e*e);a.rotateDeg=e>0?Math.acos(t/o):-Math.acos(t/o),a.scaleX=o,a.scaleY=r/o,a.skewX=(t*i+e*n)/r,a.skewY=0}else if(0!==i||0!==n){var s=Math.sqrt(i*i+n*n);a.rotateDeg=Math.PI/2-(n>0?Math.acos(-i/s):-Math.acos(i/s)),a.scaleX=r/s,a.scaleY=s,a.skewX=0,a.skewY=(t*i+e*n)/r}return a.rotateDeg=Mi(a.rotateDeg),a}}])}();function Nn(t,e,i,n,r,a,o,s){var l,u,c=e.a,h=e.b,d=e.c,p=e.d,f=e.e,v=e.f,g=ri(o),y=si(o);s?(l=s[0],u=s[1]):(l=i,u=n);var m=l-i,_=u-n,b=c*g+d*y,x=h*g+p*y,k=d*g-c*y,S=p*g-h*y;t.a=r*b,t.b=r*x,t.c=a*k,t.d=a*S,t.e=f+c*l+d*u-b*m-k*_,t.f=v+h*l+p*u-x*m-S*_}var Un=function(){return o((function t(){r(this,t),this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}),[{key:"clearCache",value:function(t,e){var i=e.CLEAN_THRESHOLD,n=void 0===i?this.CLEAN_THRESHOLD:i,r=e.L_TIME,a=void 0===r?this.L_TIME:r,o=e.R_COUNT,s=void 0===o?this.R_COUNT:o;if(t.size<n)return 0;var l=0,u=function(e){l++,t.delete(e)},c=Date.now();return t.forEach((function(t,e){if(t.timestamp.length<s)return u(e);for(var i=0;c-t.timestamp[t.timestamp.length-1-i]<a&&!(++i>=s););if(i<s)return u(e);for(;c-t.timestamp[0]>a;)t.timestamp.shift()})),l}},{key:"addLimitedTimestamp",value:function(t,e,i){var n=i.R_TIMESTAMP_MAX_SIZE,r=void 0===n?this.R_TIMESTAMP_MAX_SIZE:n;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}},{key:"clearTimeStamp",value:function(t,e){var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();t.forEach((function(t){for(;r-t.timestamp[0]>n;)t.timestamp.shift()}))}},{key:"clearItemTimestamp",value:function(t,e){for(var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();r-t.timestamp[0]>n;)t.timestamp.shift()}}])}();function jn(t,e,i){e/=100,i/=100;var n=(1-Math.abs(2*i-1))*e,r=n*(1-Math.abs(t/60%2-1)),a=i-n/2,o=0,s=0,l=0;return 0<=t&&t<60?(o=n,s=r,l=0):60<=t&&t<120?(o=r,s=n,l=0):120<=t&&t<180?(o=0,s=n,l=r):180<=t&&t<240?(o=0,s=r,l=n):240<=t&&t<300?(o=r,s=0,l=n):300<=t&&t<360&&(o=n,s=0,l=r),{r:o=Math.round(255*(o+a)),g:s=Math.round(255*(s+a)),b:l=Math.round(255*(l+a))}}function Vn(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,e,i),r=Math.max(t,e,i),a=r-n,o=0,s=0;return o=0===a?0:r===t?(e-i)/a%6:r===e?(i-t)/a+2:(t-e)/a+4,(o=Math.round(60*o))<0&&(o+=360),s=(r+n)/2,{h:o,s:+(100*(0===a?0:a/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}var Wn=/^#([0-9a-f]{3,8})$/,Gn={transparent:4294967040},Yn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Kn(t){return $(t)?new $n(t>>16,t>>8&255,255&t,1):Z(t)?new $n(t[0],t[1],t[2]):new $n(255,255,255)}function qn(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Zn(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var Jn=function(t,e){var i=Wn.exec(t);if(e||i){var n=parseInt(i[1],16),r=i[1].length;return 3===r?new $n((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):6===r?Kn(n):8===r?new $n(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):null}},Qn=function(){function t(e){r(this,t);var i=t.parseColorString(e);i?this.color=i:(console.warn("Warn: 传入".concat(e,"无法解析为Color")),this.color=new $n(255,255,255))}return o(t,[{key:"toRGBA",value:function(){return this.color.formatRgb()}},{key:"toString",value:function(){return this.color.formatRgb()}},{key:"toHex",value:function(){return this.color.formatHex()}},{key:"toHsl",value:function(){return this.color.formatHsl()}},{key:"brighter",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}},{key:"add",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r+=Math.min(255,i+t.color.r),this.color.g+=Math.min(255,n+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}},{key:"sub",value:function(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}},{key:"multiply",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}},{key:"getHSVBrightness",value:function(){return Math.max(this.color.r,this.color.g,this.color.b)/255}},{key:"getHSLBrightness",value:function(){return.5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}},{key:"setHsl",value:function(t,e,i){var n=this.color.opacity,r=Vn(this.color.r,this.color.g,this.color.b),a=jn(j(t)?r.h:he(t,0,360),j(e)?r.s:e>=0&&e<=1?100*e:e,j(i)?r.l:i<=1&&i>=0?100*i:i);return this.color=new $n(a.r,a.g,a.b,n),this}},{key:"setRGB",value:function(t,e,i){return!j(t)&&(this.color.r=t),!j(e)&&(this.color.g=e),!j(i)&&(this.color.b=i),this}},{key:"setHex",value:function(t){var e="".concat(t).trim().toLowerCase(),i=Jn(e,!0);return null!=i?i:this}},{key:"setColorName",value:function(t){var e=Yn[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}},{key:"setScalar",value:function(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}},{key:"setOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.color.opacity=t,this}},{key:"getLuminance",value:function(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}},{key:"getLuminance2",value:function(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}},{key:"getLuminance3",value:function(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}},{key:"getLuminanceWCAG",value:function(){var t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}},{key:"clone",value:function(){return new t(this.color.toString())}},{key:"copyGammaToLinear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}},{key:"copyLinearToGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}},{key:"convertGammaToLinear",value:function(t){return this.copyGammaToLinear(this,t),this}},{key:"convertLinearToGamma",value:function(t){return this.copyLinearToGamma(this,t),this}},{key:"copySRGBToLinear",value:function(t){return this.color.r=qn(t.color.r),this.color.g=qn(t.color.g),this.color.b=qn(t.color.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.color.r=Zn(t.color.r),this.color.g=Zn(t.color.g),this.color.b=Zn(t.color.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}}],[{key:"Brighter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).brighter(i).toRGBA()}},{key:"SetOpacity",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).setOpacity(i).toRGBA()}},{key:"getColorBrightness",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hsl",n=e instanceof t?e:new t(e);switch(i){case"hsv":default:return n.getHSVBrightness();case"hsl":return n.getHSLBrightness();case"lum":return n.getLuminance();case"lum2":return n.getLuminance2();case"lum3":return n.getLuminance3();case"wcag":return n.getLuminanceWCAG()}}},{key:"parseColorString",value:function(t){if(W(Gn[t]))return function(t){return $(t)?new $n(t>>>24,t>>>16&255,t>>>8&255,255&t):Z(t)?new $n(t[0],t[1],t[2],t[3]):new $n(255,255,255,1)}(Gn[t]);if(W(Yn[t]))return Kn(Yn[t]);var e="".concat(t).trim().toLowerCase(),i=Jn(e);if(void 0!==i)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){var n=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new $n(parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseFloat(n[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){var r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),a=jn(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new $n(a.r,a.g,a.b,parseFloat(r[3]))}}}])}(),$n=function(){return o((function t(e,i,n,a){r(this,t),this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),this.b=isNaN(+n)?255:Math.max(0,Math.min(255,+n)),W(a)?this.opacity=isNaN(+a)?1:Math.max(0,Math.min(1,+a)):this.opacity=1}),[{key:"formatHex",value:function(){return"#".concat(Xn(this.r)+Xn(this.g)+Xn(this.b)+(1===this.opacity?"":Xn(255*this.opacity)))}},{key:"formatRgb",value:function(){var t=this.opacity;return"".concat(1===t?"rgb(":"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b).concat(1===t?")":",".concat(t,")"))}},{key:"formatHsl",value:function(){var t=this.opacity,e=Vn(this.r,this.g,this.b),i=e.h,n=e.s,r=e.l;return"".concat(1===t?"hsl(":"hsla(").concat(i,",").concat(n,"%,").concat(r,"%").concat(1===t?")":",".concat(t,")"))}},{key:"toString",value:function(){return this.formatHex()}}])}();function tr(t){for(var e="",i="",n="",r="#"===t[0]?1:0,a=r;a<t.length;a++)"#"!==t[a]&&(a<r+2?e+=t[a]:a<r+4?i+=t[a]:a<r+6&&(n+=t[a]));return[parseInt(e,16),parseInt(i,16),parseInt(n,16)]}function er(t,e,i){return Number((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)}function ir(t,e){var i=t.r,n=e.r,r=t.g,a=e.g,o=t.b,s=e.b,l=t.opacity,u=e.opacity;return function(t){var e=Math.round(i*(1-t)+n*t),c=Math.round(r*(1-t)+a*t),h=Math.round(o*(1-t)+s*t);return new $n(e,c,h,l*(1-t)+u*t)}}var nr=Object.freeze({__proto__:null,Color:Qn,DEFAULT_COLORS:Yn,RGB:$n,hexToRgb:tr,hslToRgb:jn,interpolateRgb:ir,rgbToHex:er,rgbToHsl:Vn});function rr(t){if(it(t))return[t,t,t,t];if(Z(t)){var e=t.length;if(1===e){var i=t[0];return[i,i,i,i]}if(2===e){var n=m(t,2),r=n[0],a=n[1];return[r,a,r,a]}if(3===e){var o=m(t,3),s=o[0],l=o[1];return[s,l,o[2],l]}if(4===e)return t}if(G(t)){var u=t.top,c=void 0===u?0:u,h=t.right,d=void 0===h?0:h,p=t.bottom,f=void 0===p?0:p,v=t.left;return[c,d,f,void 0===v?0:v]}return[0,0,0,0]}function ar(t){return t?"getUTCFullYear":"getFullYear"}function or(t){return t?"getUTCMonth":"getMonth"}function sr(t){return t?"getUTCDate":"getDate"}function lr(t){return t?"getUTCHours":"getHours"}function ur(t){return t?"getUTCMinutes":"getMinutes"}function cr(t){return t?"getUTCSeconds":"getSeconds"}function hr(t){return t?"getUTCMilliseconds":"getMilliseconds"}var dr=36e5,pr=24*dr,fr=function(t){return t.setMonth(0,1),t.setHours(0,0,0,0),t},vr=function(t,e){return t.setFullYear(t.getFullYear()+e),t},gr=function(t,e){return e.getFullYear()-t.getFullYear()},yr=function(t){return t.getFullYear()},mr=function(t){return t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0),t},_r=function(t,e){return t.setUTCFullYear(t.getUTCFullYear()+e),t},br=function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},xr=function(t){return t.getUTCFullYear()},kr=function(t){return t.setDate(1),t.setHours(0,0,0,0),t},Sr=function(t,e){return t.setMonth(t.getMonth()+e),t},Ar=function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},Cr=function(t){return t.getMonth()},Mr=function(t){return t.setUTCDate(1),t.setUTCHours(0,0,0,0),t},wr=function(t,e){return t.setUTCMonth(t.getUTCMonth()+e),t},Tr=function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},Dr=function(t){return t.getUTCMonth()},Er=function(t){return t.setHours(0,0,0,0),t},Br=function(t,e){return t.setDate(t.getDate()+e),t},Pr=function(t,e){return(+e-+t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/pr},Rr=function(t){return t.getDate()-1},Lr=function(t){return t.setUTCHours(0,0,0,0),t},Ir=function(t,e){return t.setUTCDate(t.getUTCDate()+e),t},Fr=function(t,e){return(+e-+t)/pr},Or=function(t){return t.getUTCDate()-1},zr=function(t){return t.setTime(+t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes()),t},Hr=function(t,e){return t.setHours(t.getHours()+e),t},Nr=function(t,e){return(+e-+t)/dr},Ur=function(t){return t.getHours()},jr=function(t){return t.setTime(+t-t.getUTCMilliseconds()-1e3*t.getUTCSeconds()-6e4*t.getUTCMinutes()),t},Vr=function(t,e){return t.setUTCHours(t.getUTCHours()+e),t},Wr=function(t){return t.getUTCHours()},Gr=function(t){return t.setTime(+t-t.getMilliseconds()-1e3*t.getSeconds()),t},Yr=function(t,e){return t.setMinutes(t.getMinutes()+e),t},Xr=function(t,e){return(+e-+t)/6e4},Kr=function(t){return t.getMinutes()},qr=function(t){return t.setTime(+t-t.getUTCMilliseconds()-1e3*t.getUTCSeconds()),t},Zr=function(t,e){return t.setUTCMinutes(t.getUTCMinutes()+e),t},Jr=function(t){return t.getUTCMinutes()},Qr=function(t){return t.setTime(+t-t.getMilliseconds()),t},$r=function(t,e){return t.setSeconds(t.getSeconds()+e),t},ta=function(t,e){return(+e-+t)/1e3},ea=function(t){return t.getSeconds()},ia=function(t){return t.setTime(+t-t.getUTCMilliseconds()),t},na=function(t,e){return t.setUTCSeconds(t.getUTCSeconds()+e),t},ra=function(t){return t.getUTCSeconds()},aa=function(t){return t},oa=function(t,e){return t.setTime(+t+e),t},sa=function(t,e){return+e-+t},la=function(t,e){return function(i){var n=new Date(+i-1);return e(n,1),t(n),n}},ua=function(t,e){return function(i,n){var r=new Date,a=new Date;return r.setTime(+i),a.setTime(+n),t(r),t(a),Math.floor(e(r,a))}};function ca(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t)return{width:i,height:n};try{e=null===window||void 0===window?void 0:window.getComputedStyle}catch(t){e=function(){return{}}}var r=e(t);if(/^(\d*\.?\d+)(px)$/.exec(r.width)){var a=parseFloat(r.width)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)||t.clientWidth-1,o=parseFloat(r.height)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)||t.clientHeight-1;return{width:a<=0?i:a,height:o<=0?n:o}}return{width:i,height:n}}function ha(t){var e=t.getBoundingClientRect();return{x:e.x,y:e.y}}var da=function(t){return t.getBoundingClientRect().width/t.offsetWidth},pa=function(t){return t.getBoundingClientRect().height/t.offsetHeight};var fa=function(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(";").forEach((function(e){if(e){var i=e.split(":");if(2===i.length){var n=i[0].trim(),r=i[1].trim();n&&r&&(t[n]=r)}}})),t},va=function(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()};function ga(t){return t.replace(/-([a-z])/g,(function(t,e){return e.toUpperCase()}))}function ya(t){try{return t instanceof Element}catch(i){var e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every((function(t){return e.includes(t)}))}}var ma=6371008.8,_a={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*ma,kilometers:6371.0088,kilometres:6371.0088,meters:ma,metres:ma,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:ma/1852,radians:1,yards:6967335.223679999};function ba(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function xa(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}var ka=1e-10;function Sa(t,e){var i=function(t){for(var e=[],i=0;i<t.length;++i)for(var n=i+1;n<t.length;++n)for(var r=wa(t[i],t[n]),a=0;a<r.length;++a){var o=r[a];o.parentIndex=[i,n],e.push(o)}return e}(t),n=i.filter((function(e){return Aa(e,t)})),r=0,a=0,o=[];if(n.length>1){for(var s=Ta(n),l=0;l<n.length;++l){var u=n[l];u.angle=Math.atan2(u.x-s.x,u.y-s.y)}n.sort((function(t,e){return e.angle-t.angle}));for(var c=n[n.length-1],h=0;h<n.length;++h){var d=n[h];a+=(c.x+d.x)*(d.y-c.y);for(var p={x:(d.x+c.x)/2,y:(d.y+c.y)/2},f=null,v=0;v<d.parentIndex.length;++v)if(c.parentIndex.indexOf(d.parentIndex[v])>-1){var g=t[d.parentIndex[v]],y=Math.atan2(d.x-g.x,d.y-g.y),m=Math.atan2(c.x-g.x,c.y-g.y),_=m-y;_<0&&(_+=2*Math.PI);var b=m-_/2,x=Si.distancePP(p,{x:g.x+g.radius*Math.sin(b),y:g.y+g.radius*Math.cos(b)});x>2*g.radius&&(x=2*g.radius),(null===f||f.width>x)&&(f={circle:g,width:x,p1:d,p2:c})}null!==f&&(o.push(f),r+=Ca(f.circle.radius,f.width),c=d)}}else{for(var k=t[0],S=1;S<t.length;++S)t[S].radius<k.radius&&(k=t[S]);for(var A=!1,C=0;C<t.length;++C)if(Si.distancePP(t[C],k)>Math.abs(k.radius-t[C].radius)){A=!0;break}A?r=a=0:(r=k.radius*k.radius*Math.PI,o.push({circle:k,p1:{x:k.x,y:k.y+k.radius},p2:{x:k.x-ka,y:k.y+k.radius},width:2*k.radius}))}return a/=2,e&&(e.area=r+a,e.arcArea=r,e.polygonArea=a,e.arcs=o,e.innerPoints=n,e.intersectionPoints=i),r+a}function Aa(t,e){for(var i=0;i<e.length;++i)if(Si.distancePP(t,e[i])>e[i].radius+ka)return!1;return!0}function Ca(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function Ma(t,e,i){if(i>=t+e)return 0;if(i<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);var n=e-(i*i-t*t+e*e)/(2*i);return Ca(t,t-(i*i-e*e+t*t)/(2*i))+Ca(e,n)}function wa(t,e){var i=Si.distancePP(t,e),n=t.radius,r=e.radius;if(i>=n+r||i<=Math.abs(n-r))return[];var a=(n*n-r*r+i*i)/(2*i),o=Math.sqrt(n*n-a*a),s=t.x+a*(e.x-t.x)/i,l=t.y+a*(e.y-t.y)/i,u=-(e.y-t.y)*(o/i),c=-(e.x-t.x)*(o/i);return[{x:s+u,y:l-c},{x:s-u,y:l+c}]}function Ta(t){for(var e={x:0,y:0},i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}var Da,Ea=function(){function t(){var e=this;r(this,t),this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=function(t){return e.locale_shortWeekdays[t.getDay()]},this.formatWeekday=function(t){return e.locale_weekdays[t.getDay()]},this.formatShortMonth=function(t){return e.locale_shortMonths[t.getMonth()]},this.formatMonth=function(t){return e.locale_months[t.getMonth()]},this.formatDayOfMonth=function(t,i){return e.pad(t.getDate(),i,2)},this.formatHour24=function(t,i){return e.pad(t.getHours(),i,2)},this.formatHour12=function(t,i){return e.pad(t.getHours()%12||12,i,2)},this.formatMilliseconds=function(t,i){return e.pad(t.getMilliseconds(),i,3)},this.formatMonthNumber=function(t,i){return e.pad(t.getMonth()+1,i,2)},this.formatMinutes=function(t,i){return e.pad(t.getMinutes(),i,2)},this.formatPeriod=function(t){return e.locale_periods[+(t.getHours()>=12)]},this.formatSeconds=function(t,i){return e.pad(t.getSeconds(),i,2)},this.formatFullYear=function(t,i){return e.pad(t.getFullYear()%1e4,i,4)},this.formatUTCShortWeekday=function(t){return e.locale_shortWeekdays[t.getUTCDay()]},this.formatUTCWeekday=function(t){return e.locale_weekdays[t.getUTCDay()]},this.formatUTCShortMonth=function(t){return e.locale_shortMonths[t.getUTCMonth()]},this.formatUTCMonth=function(t){return e.locale_months[t.getUTCMonth()]},this.formatUTCDayOfMonth=function(t,i){return e.pad(t.getUTCDate(),i,2)},this.formatUTCHour24=function(t,i){return e.pad(t.getUTCHours(),i,2)},this.formatUTCHour12=function(t,i){return e.pad(t.getUTCHours()%12||12,i,2)},this.formatUTCMilliseconds=function(t,i){return e.pad(t.getUTCMilliseconds(),i,3)},this.formatUTCMonthNumber=function(t,i){return e.pad(t.getUTCMonth()+1,i,2)},this.formatUTCMinutes=function(t,i){return e.pad(t.getUTCMinutes(),i,2)},this.formatUTCPeriod=function(t){return e.locale_periods[+(t.getUTCHours()>=12)]},this.formatUTCSeconds=function(t,i){return e.pad(t.getUTCSeconds(),i,2)},this.formatUTCFullYear=function(t,i){return e.pad(t.getUTCFullYear()%1e4,i,4)},this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=function(t,i,n){var r=e.shortWeekdayRe.exec(i.slice(n));return r?(t.w=e.shortWeekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseWeekday=function(t,i,n){var r=e.weekdayRe.exec(i.slice(n));return r?(t.w=e.weekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseShortMonth=function(t,i,n){var r=e.shortMonthRe.exec(i.slice(n));return r?(t.m=e.shortMonthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseMonth=function(t,i,n){var r=e.monthRe.exec(i.slice(n));return r?(t.m=e.monthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseDayOfMonth=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1},this.parseHour24=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1},this.parseMilliseconds=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1},this.parseMonthNumber=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.m=r-1,n+r[0].length):-1},this.parseMinutes=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1},this.parsePeriod=function(t,i,n){var r=e.periodRe.exec(i.slice(n));return r?(t.p=e.periodLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseSeconds=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1},this.parseFullYear=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=function(t,i){return e.newFormat(t,e.formats)(new Date(e.getFullTimeStamp(i)))},this.timeUTCFormat=function(t,i){return e.newFormat(t,e.utcFormats)(new Date(e.getFullTimeStamp(i)))},this.timeParse=function(t,i){return e.newParse(t,!1)(i+"")},this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}return o(t,[{key:"requote",value:function(t){return t.replace(this.requoteRe,"\\$&")}},{key:"localDate",value:function(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}},{key:"utcDate",value:function(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}},{key:"newDate",value:function(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}},{key:"formatRe",value:function(t){return new RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")}},{key:"formatLookup",value:function(t){return new Map(t.map((function(t,e){return[t.toLowerCase(),e]})))}},{key:"pad",value:function(t,e,i){var n=t<0?"-":"",r=(n?-t:t)+"",a=r.length;return n+(a<i?new Array(i-a+1).join(e)+r:r)}},{key:"parseSpecifier",value:function(t,e,i,n){for(var r,a,o=0,s=e.length,l=i.length;o<s;){if(n>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=this.parses[r in this.pads?e.charAt(o++):r])||(n=a(t,i,n))<0)return-1}else if(r!==i.charCodeAt(n++))return-1}return n}},{key:"newParse",value:function(t,e){var i=this;return function(n){var r=i.newDate(1900,void 0,1);return i.parseSpecifier(r,t,n+="",0)!==n.length?null:"Q"in r?new Date(r.Q):"s"in r?new Date(1e3*r.s+("L"in r?r.L:0)):(e&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,i.utcDate(r)):i.localDate(r))}}},{key:"newFormat",value:function(t,e){var i=this;return function(n){var r,a,o=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),(a=i.pads[r=t.charAt(++s)])?r=t.charAt(++s):a="e"===r?" ":"0",r=(0,e[r])(n,a),o.push(r),l=s+1);return o.push(t.slice(l,s)),o.join("")}}},{key:"getFullTimeStamp",value:function(t){var e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}();function Ba(t,e){var i=e?t.toExponential(e-1):t.toExponential(),n=i.indexOf("e");if(n<0)return null;var r=i.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+i.slice(n+1)]}function Pa(t,e){var i=Ba(t,e);if(!i)return t+"";var n=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}var Ra=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}),[{key:"toString",value:function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}])}(),La=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ia(t){var e;if(e=La.exec(t))return new Ra({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});Wt.getInstance().error("invalid format: "+t)}var Fa=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],Oa=function(){function t(){var e,i,n=this;r(this,t),this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=void 0===this.locale.grouping||void 0===this.locale.thousands?function(t){return t}:(e=b(this.locale.grouping).map(Number),i="".concat(this.locale.thousands),function(t,n){for(var r=t.length,a=[],o=0,s=e[0],l=0;r>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(i)}),this.currencyPrefix=void 0===this.locale.currency?"":this.locale.currency[0]+"",this.currencySuffix=void 0===this.locale.currency?"":this.locale.currency[1]+"",this.decimal=void 0===this.locale.decimal?".":this.locale.decimal+"",this.numerals=void 0===this.locale.numerals?function(t){return t}:Na(b(this.locale.numerals).map(String)),this.percent=void 0===this.locale.percent?"%":this.locale.percent+"",this.minus=void 0===this.locale.minus?"−":this.locale.minus+"",this.nan=void 0===this.locale.nan?"NaN":this.locale.nan+"",this.formatter=function(t){return n.newFormat(t)},this.format=function(t,e){return n.formatter(t)(e)},this.formatPrefix=function(t,e){return n._formatPrefix(t,e)}}return o(t,[{key:"newFormat",value:function(t){var e=Ia(t),i=e.fill,n=e.align,r=e.sign,a=e.symbol,o=e.zero,s=e.width,l=e.comma,u=e.precision,c=e.trim,h=e.type;"n"===h?(l=!0,h="g"):za[h]||(void 0===u&&(u=12),c=!0,h="g"),(o||"0"===i&&"="===n)&&(o=!0,i="0",n="=");var d="$"===a?this.currencyPrefix:"#"===a&&/[boxX]/.test(h)?"0"+h.toLowerCase():"",p="$"===a?this.currencySuffix:/[%p]/.test(h)?this.percent:"",f=za[h],v=/[defgprstz%]/.test(h);u=void 0===u?6:/[gprs]/.test(h)?Math.max(1,Math.min(21,u)):Math.max(0,Math.min(20,u));var g=this.nan,y=this.minus,m=this.decimal,_=this.group,b=this.numerals;function x(t){var e,a,x,k=d,S=p,A=t;if("c"===h)S=f(A)+S,A="";else{var C=(A=+A)<0||1/A<0;if(A=isNaN(A)?g:f(Math.abs(A),u),c&&(A=function(t){var e,i=t.length,n=-1;t:for(var r=1;r<i;++r)switch(t[r]){case".":n=e=r;break;case"0":0===n&&(n=r),e=r;break;default:if(!+t[r])break t;n>0&&(n=0)}return n>0?t.slice(0,n)+t.slice(e+1):t}(A)),C&&0==+A&&"+"!==r&&(C=!1),k=(C?"("===r?r:y:"-"===r||"("===r?"":r)+k,S=("s"===h?Fa[8+Da/3]:"")+S+(C&&"("===r?")":""),v)for(e=-1,a=A.length;++e<a;)if(48>(x=A.charCodeAt(e))||x>57){S=(46===x?m+A.slice(e+1):A.slice(e))+S,A=A.slice(0,e);break}}l&&!o&&(A=_(A,1/0));var M=k.length+A.length+S.length,w=M<s?new Array(s-M+1).join(i):"";switch(l&&o&&(A=_(w+A,w.length?s-S.length:1/0),w=""),n){case"<":A=k+A+S+w;break;case"=":A=k+w+A+S;break;case"^":A=w.slice(0,M=w.length>>1)+k+A+S+w.slice(M);break;default:A=w+k+A+S}return b(A)}return x.toString=function(){return t+""},x}},{key:"_formatPrefix",value:function(t,e){var i=Ia(t);i.type="f";var n=this.newFormat(i.toString()),r=3*Math.max(-8,Math.min(8,Math.floor(Ha(e)/3))),a=Math.pow(10,-r),o=Fa[8+r/3];return function(t){return n(a*t)+o}}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}(),za={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},f:function(t,e){return t.toFixed(e)},e:function(t,e){return t.toExponential(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Pa(100*t,e)},r:Pa,s:function(t,e){var i=Ba(t,e);if(!i)return t+"";var n=i[0],r=i[1],a=r-(Da=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Ba(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)},t:function(t,e){return Number.isInteger(t)?t.toFixed(2):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)+""},z:function(t,e){return t%1==0?t+"":t.toFixed(e)}};function Ha(t){var e=Ba(Math.abs(t));return e?e[1]:NaN}function Na(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}function Ua(t){for(var e=new Array(t),i=0;i<t;++i)e[i]=0;return e}function ja(t,e){return Ua(t).map((function(){return Ua(e)}))}function Va(t){return Math.sqrt(gi(t,t))}function Wa(t,e,i){for(var n=0;n<e.length;++n)t[n]=e[n]*i}function Ga(t,e,i,n,r){for(var a=0;a<t.length;++a)t[a]=e*i[a]+n*r[a]}function Ya(t,e,i){var n,r=(i=i||{}).maxIterations||200*e.length,a=i.nonZeroDelta||1.05,o=i.zeroDelta||.001,s=i.minErrorDelta||1e-6,l=i.minErrorDelta||1e-5,u=void 0!==i.rho?i.rho:1,c=void 0!==i.chi?i.chi:2,h=void 0!==i.psi?i.psi:-.5,d=void 0!==i.sigma?i.sigma:.5,p=e.length,f=new Array(p+1);f[0]=e,f[0].fx=t(e),f[0].id=0;for(var v=0;v<p;++v){var g=e.slice();g[v]=g[v]?g[v]*a:o,f[v+1]=g,f[v+1].fx=t(g),f[v+1].id=v+1}function y(t){for(var e=0;e<t.length;e++)f[p][e]=t[e];f[p].fx=t.fx}for(var m=function(t,e){return t.fx-e.fx},_=e.slice(),b=e.slice(),x=e.slice(),k=e.slice(),S=0;S<r;++S){if(f.sort(m),i.history){var A=f.map((function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e}));A.sort((function(t,e){return t.id-e.id})),i.history.push({x:f[0].slice(),fx:f[0].fx,simplex:A})}n=0;for(var C=0;C<p;++C)n=Math.max(n,Math.abs(f[0][C]-f[1][C]));if(Math.abs(f[0].fx-f[p].fx)<s&&n<l)break;for(var M=0;M<p;++M){_[M]=0;for(var w=0;w<p;++w)_[M]+=f[w][M];_[M]/=p}var T=f[p];if(Ga(b,1+u,_,-u,T),b.fx=t(b),b.fx<f[0].fx)Ga(k,1+c,_,-c,T),k.fx=t(k),k.fx<b.fx?y(k):y(b);else if(b.fx>=f[p-1].fx){var D=!1;if(b.fx>T.fx?(Ga(x,1+h,_,-h,T),x.fx=t(x),x.fx<T.fx?y(x):D=!0):(Ga(x,1-h*u,_,h*u,T),x.fx=t(x),x.fx<b.fx?y(x):D=!0),D){if(d>=1)break;for(var E=1;E<f.length;++E)Ga(f[E],1-d,f[0],d,f[E]),f[E].fx=t(f[E])}}else y(b)}return f.sort(m),{fx:f[0].fx,x:f[0]}}function Xa(t,e,i,n,r,a,o){var s=i.fx,l=gi(i.fxprime,e),u=s,c=s,h=l,d=0;function p(c,d,p){for(var f=0;f<16;++f)if(r=(c+d)/2,Ga(n.x,1,i.x,r,e),u=n.fx=t(n.x,n.fxprime),h=gi(n.fxprime,e),u>s+a*r*l||u>=p)d=r;else{if(Math.abs(h)<=-o*l)return r;h*(d-c)>=0&&(d=c),c=r,p=u}return 0}r=r||1,a=a||1e-6,o=o||.1;for(var f=0;f<10;++f){if(Ga(n.x,1,i.x,r,e),u=n.fx=t(n.x,n.fxprime),h=gi(n.fxprime,e),u>s+a*r*l||f&&u>=c)return p(d,r,c);if(Math.abs(h)<=-o*l)return r;if(h>=0)return p(r,d,u);c=u,d=r,r*=2}return r}function Ka(t,e,i){var n,r={x:e.slice(),fx:0,fxprime:e.slice()},a={x:e.slice(),fx:0,fxprime:e.slice()},o=e.slice(),s=1,l=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);var u=r.fxprime.slice();Wa(u,r.fxprime,-1);for(var c=0;c<l;++c){if(s=Xa(t,u,r,a,s),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),s){Ga(o,1,a.fxprime,-1,r.fxprime);var h=gi(r.fxprime,r.fxprime);Ga(u,Math.max(0,gi(o,a.fxprime)/h),u,-1,a.fxprime),n=r,r=a,a=n}else Wa(u,r.fxprime,-1);if(Va(r.fxprime)<=1e-5)break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),r}var qa=function(t,e){var i=e.callback;return i&&(t=t.filter(i)),t};function Za(){return new Ja}function Ja(){this.reset()}Ja.prototype={constructor:Ja,reset:function(){this.s=this.t=0},add:function(t){$a(Qa,t,this.t),$a(this,Qa.s,this.s),this.s?this.t+=Qa.t:this.s=Qa.t},valueOf:function(){return this.s}};var Qa=new Ja;function $a(t,e,i){var n=t.s=e+i,r=n-e,a=n-r;t.t=e-a+(i-r)}var to=1e-6,eo=Math.PI,io=eo/2,no=eo/4,ro=2*eo,ao=180/eo,oo=eo/180,so=Math.abs,lo=Math.atan,uo=Math.atan2,co=Math.cos,ho=Math.exp,po=Math.log,fo=Math.pow,vo=Math.sin,go=Math.sign||function(t){return t>0?1:t<0?-1:0},yo=Math.sqrt,mo=Math.tan;function _o(t){return t>1?0:t<-1?eo:Math.acos(t)}function bo(t){return t>1?io:t<-1?-io:Math.asin(t)}function xo(){}function ko(t,e){t&&Ao.hasOwnProperty(t.type)&&Ao[t.type](t,e)}var So={Feature:function(t,e){ko(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)ko(i[n].geometry,e)}},Ao={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Co(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Co(i[n],e,0)},Polygon:function(t,e){Mo(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Mo(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)ko(i[n],e)}};function Co(t,e,i){var n,r=-1,a=t.length-i;for(e.lineStart();++r<a;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function Mo(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)Co(t[i],e,1);e.polygonEnd()}function wo(t,e){t&&So.hasOwnProperty(t.type)?So[t.type](t,e):ko(t,e)}function To(t){return[uo(t[1],t[0]),bo(t[2])]}function Do(t){var e=t[0],i=t[1],n=co(i);return[n*co(e),n*vo(e),vo(i)]}function Eo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Bo(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Po(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ro(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Lo(t){var e=yo(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Io(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function Fo(t,e){return[so(t)>eo?t+Math.round(-t/ro)*ro:t,e]}function Oo(t,e,i){return(t%=ro)?e||i?Io(Ho(t),No(e,i)):Ho(t):e||i?No(e,i):Fo}function zo(t){return function(e,i){return[(e+=t)>eo?e-ro:e<-eo?e+ro:e,i]}}function Ho(t){var e=zo(t);return e.invert=zo(-t),e}function No(t,e){var i=co(t),n=vo(t),r=co(e),a=vo(e);function o(t,e){var o=co(e),s=co(t)*o,l=vo(t)*o,u=vo(e),c=u*i+s*n;return[uo(l*r-c*a,s*i-u*n),bo(c*r+l*a)]}return o.invert=function(t,e){var o=co(e),s=co(t)*o,l=vo(t)*o,u=vo(e),c=u*r-l*a;return[uo(l*r+u*a,s*i+c*n),bo(c*i-s*n)]},o}function Uo(t,e){(e=Do(e))[0]-=t,Lo(e);var i=_o(-e[1]);return((-e[2]<0?-i:i)+ro-to)%ro}function jo(){var t,e=[];return{point:function(e,i,n){t.push([e,i,n])},lineStart:function(){e.push(t=[])},lineEnd:xo,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function Vo(t,e){return so(t[0]-e[0])<to&&so(t[1]-e[1])<to}function Wo(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function Go(t,e,i,n,r){var a,o,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],o=t[e];if(Vo(n,o)){if(!n[2]&&!o[2]){for(r.lineStart(),a=0;a<e;++a)r.point((n=t[a])[0],n[1]);return void r.lineEnd()}o[0]+=2*to}s.push(i=new Wo(n,t,null,!0)),l.push(i.o=new Wo(n,null,i,!1)),s.push(i=new Wo(o,t,null,!1)),l.push(i.o=new Wo(o,null,i,!0))}})),s.length){for(l.sort(e),Yo(s),Yo(l),a=0,o=l.length;a<o;++a)l[a].e=i=!i;for(var u,c,h=s[0];;){for(var d=h,p=!0;d.v;)if((d=d.n)===h)return;u=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(a=0,o=u.length;a<o;++a)r.point((c=u[a])[0],c[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(p)for(u=d.p.z,a=u.length-1;a>=0;--a)r.point((c=u[a])[0],c[1]);else n(d.x,d.p.x,-1,r);d=d.p}u=(d=d.o).z,p=!p}while(!d.v);r.lineEnd()}}}function Yo(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}Fo.invert=Fo;var Xo,Ko,qo=Za();function Zo(t){return so(t[0])<=eo?t[0]:go(t[0])*((so(t[0])+eo)%ro-eo)}function Jo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Qo(t){for(var e,i,n,r=t.length,a=-1,o=0;++a<r;)o+=t[a].length;for(i=new Array(o);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--o]=n[e];return i}function $o(t,e,i,n){return function(r){var a,o,s,l=e(r),u=jo(),c=e(u),h=!1,d={point:p,lineStart:v,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=m,d.lineEnd=_,o=[],a=[]},polygonEnd:function(){d.point=p,d.lineStart=v,d.lineEnd=g,o=Qo(o);var t=function(t,e){var i=Zo(e),n=e[1],r=vo(n),a=[vo(i),-co(i),0],o=0,s=0;qo.reset(),1===r?n=io+to:-1===r&&(n=-io-to);for(var l=0,u=t.length;l<u;++l)if(h=(c=t[l]).length)for(var c,h,d=c[h-1],p=Zo(d),f=d[1]/2+no,v=vo(f),g=co(f),y=0;y<h;++y,p=_,v=x,g=k,d=m){var m=c[y],_=Zo(m),b=m[1]/2+no,x=vo(b),k=co(b),S=_-p,A=S>=0?1:-1,C=A*S,M=C>eo,w=v*x;if(qo.add(uo(w*A*vo(C),g*k+w*co(C))),o+=M?S+A*ro:S,M^p>=i^_>=i){var T=Bo(Do(d),Do(m));Lo(T);var D=Bo(a,T);Lo(D);var E=(M^S>=0?-1:1)*bo(D[2]);(n>E||n===E&&(T[0]||T[1]))&&(s+=M^S>=0?1:-1)}}return(o<-to||o<to&&qo<-to)^1&s}(a,n);o.length?(h||(r.polygonStart(),h=!0),Go(o,es,t,i,r)):t&&(h||(r.polygonStart(),h=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=a=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(e,i){t(e,i)&&r.point(e,i)}function f(t,e){l.point(t,e)}function v(){d.point=f,l.lineStart()}function g(){d.point=p,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function m(){c.lineStart(),s=[]}function _(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,i,n,l=c.clean(),d=u.result(),p=d.length;if(s.pop(),a.push(s),s=null,p)if(1&l){if((e=(i=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),t=0;t<e;++t)r.point((n=i[t])[0],n[1]);r.lineEnd()}}else p>1&&2&l&&d.push(d.pop().concat(d.shift())),o.push(d.filter(ts))}return d}}function ts(t){return t.length>1}function es(t,e){return((t=t.x)[0]<0?t[1]-io-to:io-t[1])-((e=e.x)[0]<0?e[1]-io-to:io-e[1])}1===(Xo=Jo).length&&(Ko=Xo,Xo=function(t,e){return Jo(Ko(t),e)});var is=$o((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?eo:-eo,l=so(a-i);so(l-eo)<to?(t.point(i,n=(n+o)/2>0?io:-io),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(a,n),e=0):r!==s&&l>=eo&&(so(i-r)<to&&(i-=r*to),so(a-s)<to&&(a-=s*to),n=function(t,e,i,n){var r,a,o=vo(t-i);return so(o)>to?lo((vo(e)*(a=co(n))*vo(i)-vo(n)*(r=co(e))*vo(t))/(r*a*o)):(e+n)/2}(i,n,a,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),e=0),t.point(i=a,n=o),r=s},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*io,n.point(-eo,r),n.point(0,r),n.point(eo,r),n.point(eo,0),n.point(eo,-r),n.point(0,-r),n.point(-eo,-r),n.point(-eo,0),n.point(-eo,r);else if(so(t[0]-e[0])>to){var a=t[0]<e[0]?eo:-eo;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(e[0],e[1])}),[-eo,-io]);function ns(t){var e=co(t),i=6*oo,n=e>0,r=so(e)>to;function a(t,i){return co(t)*co(i)>e}function o(t,i,n){var r=[1,0,0],a=Bo(Do(t),Do(i)),o=Eo(a,a),s=a[0],l=o-s*s;if(!l)return!n&&t;var u=e*o/l,c=-e*s/l,h=Bo(r,a),d=Ro(r,u);Po(d,Ro(a,c));var p=h,f=Eo(d,p),v=Eo(p,p),g=f*f-v*(Eo(d,d)-1);if(!(g<0)){var y=yo(g),m=Ro(p,(-f-y)/v);if(Po(m,d),m=To(m),!n)return m;var _,b=t[0],x=i[0],k=t[1],S=i[1];x<b&&(_=b,b=x,x=_);var A=x-b,C=so(A-eo)<to;if(!C&&S<k&&(_=k,k=S,S=_),C||A<to?C?k+S>0^m[1]<(so(m[0]-b)<to?k:S):k<=m[1]&&m[1]<=S:A>eo^(b<=m[0]&&m[0]<=x)){var M=Ro(p,(-f+y)/v);return Po(M,d),[m,To(M)]}}}function s(e,i){var r=n?t:eo-t,a=0;return e<-r?a|=1:e>r&&(a|=2),i<-r?a|=4:i>r&&(a|=8),a}return $o(a,(function(t){var e,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var p,f=[h,d],v=a(h,d),g=n?v?0:s(h,d):v?s(h+(h<0?eo:-eo),d):0;if(!e&&(u=l=v)&&t.lineStart(),v!==l&&(!(p=o(e,f))||Vo(e,p)||Vo(f,p))&&(f[2]=1),v!==l)c=0,v?(t.lineStart(),p=o(f,e),t.point(p[0],p[1])):(p=o(e,f),t.point(p[0],p[1],2),t.lineEnd()),e=p;else if(r&&e&&n^v){var y;g&i||!(y=o(f,e,!0))||(c=0,n?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!v||e&&Vo(e,f)||t.point(f[0],f[1]),e=f,l=v,i=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,n,r,a){!function(t,e,i,n,r,a){if(i){var o=co(e),s=vo(e),l=n*i;null==r?(r=e+n*ro,a=e-l/2):(r=Uo(o,r),a=Uo(o,a),(n>0?r<a:r>a)&&(r+=n*ro));for(var u,c=r;n>0?c>a:c<a;c-=l)u=To([o,-s*co(c),-s*vo(c)]),t.point(u[0],u[1])}}(a,t,i,r,e,n)}),n?[0,-t]:[-eo,t-eo])}var rs=1e9,as=-rs;function os(t,e,i,n){function r(r,a){return t<=r&&r<=i&&e<=a&&a<=n}function a(r,a,s,u){var c=0,h=0;if(null==r||(c=o(r,s))!==(h=o(a,s))||l(r,a)<0^s>0)do{u.point(0===c||3===c?t:i,c>1?n:e)}while((c=(c+s+4)%4)!==h);else u.point(a[0],a[1])}function o(n,r){return so(n[0]-t)<to?r>0?0:3:so(n[0]-i)<to?r>0?2:1:so(n[1]-e)<to?r>0?1:0:r>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var i=o(t,1),n=o(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(o){var l,u,c,h,d,p,f,v,g,y,m,_=o,b=jo(),x={point:k,lineStart:function(){x.point=S,u&&u.push(c=[]);y=!0,g=!1,f=v=NaN},lineEnd:function(){l&&(S(h,d),p&&g&&b.rejoin(),l.push(b.result()));x.point=k,g&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=u.length;i<r;++i)for(var a,o,s=u[i],l=1,c=s.length,h=s[0],d=h[0],p=h[1];l<c;++l)a=d,o=p,d=(h=s[l])[0],p=h[1],o<=n?p>n&&(d-a)*(n-o)>(p-o)*(t-a)&&++e:p<=n&&(d-a)*(n-o)<(p-o)*(t-a)&&--e;return e}(),i=m&&e,r=(l=Qo(l)).length;(i||r)&&(o.polygonStart(),i&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),r&&Go(l,s,e,a,o),o.polygonEnd());_=o,l=u=c=null}};function k(t,e){r(t,e)&&_.point(t,e)}function S(a,o){var s=r(a,o);if(u&&c.push([a,o]),y)h=a,d=o,p=s,y=!1,s&&(_.lineStart(),_.point(a,o));else if(s&&g)_.point(a,o);else{var l=[f=Math.max(as,Math.min(rs,f)),v=Math.max(as,Math.min(rs,v))],b=[a=Math.max(as,Math.min(rs,a)),o=Math.max(as,Math.min(rs,o))];!function(t,e,i,n,r,a){var o,s=t[0],l=t[1],u=0,c=1,h=e[0]-s,d=e[1]-l;if(o=i-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>u&&(u=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<c&&(c=o)}if(o=n-l,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<c&&(c=o)}else if(d>0){if(o>c)return;o>u&&(u=o)}if(o=a-l,d||!(o<0)){if(o/=d,d<0){if(o>c)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<c&&(c=o)}return u>0&&(t[0]=s+u*h,t[1]=l+u*d),c<1&&(e[0]=s+c*h,e[1]=l+c*d),!0}}}}}(l,b,t,e,i,n)?s&&(_.lineStart(),_.point(a,o),m=!1):(g||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),s||_.lineEnd(),m=!1)}f=a,v=o,g=s}return x}}function ss(t){return t}var ls,us,cs,hs,ds=Za(),ps=Za(),fs={point:xo,lineStart:xo,lineEnd:xo,polygonStart:function(){fs.lineStart=vs,fs.lineEnd=ms},polygonEnd:function(){fs.lineStart=fs.lineEnd=fs.point=xo,ds.add(so(ps)),ps.reset()},result:function(){var t=ds/2;return ds.reset(),t}};function vs(){fs.point=gs}function gs(t,e){fs.point=ys,ls=cs=t,us=hs=e}function ys(t,e){ps.add(hs*t-cs*e),cs=t,hs=e}function ms(){ys(ls,us)}var _s=fs,bs=1/0,xs=bs,ks=-bs,Ss=ks;var As,Cs,Ms,ws,Ts={point:function(t,e){t<bs&&(bs=t);t>ks&&(ks=t);e<xs&&(xs=e);e>Ss&&(Ss=e)},lineStart:xo,lineEnd:xo,polygonStart:xo,polygonEnd:xo,result:function(){var t=[[bs,xs],[ks,Ss]];return ks=Ss=-(xs=bs=1/0),t}},Ds=0,Es=0,Bs=0,Ps=0,Rs=0,Ls=0,Is=0,Fs=0,Os=0,zs={point:Hs,lineStart:Ns,lineEnd:Vs,polygonStart:function(){zs.lineStart=Ws,zs.lineEnd=Gs},polygonEnd:function(){zs.point=Hs,zs.lineStart=Ns,zs.lineEnd=Vs},result:function(){var t=Os?[Is/Os,Fs/Os]:Ls?[Ps/Ls,Rs/Ls]:Bs?[Ds/Bs,Es/Bs]:[NaN,NaN];return Ds=Es=Bs=Ps=Rs=Ls=Is=Fs=Os=0,t}};function Hs(t,e){Ds+=t,Es+=e,++Bs}function Ns(){zs.point=Us}function Us(t,e){zs.point=js,Hs(Ms=t,ws=e)}function js(t,e){var i=t-Ms,n=e-ws,r=yo(i*i+n*n);Ps+=r*(Ms+t)/2,Rs+=r*(ws+e)/2,Ls+=r,Hs(Ms=t,ws=e)}function Vs(){zs.point=Hs}function Ws(){zs.point=Ys}function Gs(){Xs(As,Cs)}function Ys(t,e){zs.point=Xs,Hs(As=Ms=t,Cs=ws=e)}function Xs(t,e){var i=t-Ms,n=e-ws,r=yo(i*i+n*n);Ps+=r*(Ms+t)/2,Rs+=r*(ws+e)/2,Ls+=r,Is+=(r=ws*t-Ms*e)*(Ms+t),Fs+=r*(ws+e),Os+=3*r,Hs(Ms=t,ws=e)}var Ks=zs;function qs(t){this._context=t}qs.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,ro)}},result:xo};var Zs,Js,Qs,$s,tl,el=Za(),il={point:xo,lineStart:function(){il.point=nl},lineEnd:function(){Zs&&rl(Js,Qs),il.point=xo},polygonStart:function(){Zs=!0},polygonEnd:function(){Zs=null},result:function(){var t=+el;return el.reset(),t}};function nl(t,e){il.point=rl,Js=$s=t,Qs=tl=e}function rl(t,e){$s-=t,tl-=e,el.add(yo($s*$s+tl*tl)),$s=t,tl=e}var al=il;function ol(){this._string=[]}function sl(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function ll(t,e){var i,n,r=4.5;function a(t){return t&&("function"==typeof r&&n.pointRadius(+r.apply(this,arguments)),wo(t,i(n))),n.result()}return a.area=function(t){return wo(t,i(_s)),_s.result()},a.measure=function(t){return wo(t,i(al)),al.result()},a.bounds=function(t){return wo(t,i(Ts)),Ts.result()},a.centroid=function(t){return wo(t,i(Ks)),Ks.result()},a.projection=function(e){return arguments.length?(i=null==e?(t=null,ss):(t=e).stream,a):t},a.context=function(t){return arguments.length?(n=null==t?(e=null,new ol):new qs(e=t),"function"!=typeof r&&n.pointRadius(r),a):e},a.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(n.pointRadius(+t),+t),a):r},a.projection(t).context(e)}function ul(t){return function(e){var i=new cl;for(var n in t)i[n]=t[n];return i.stream=e,i}}function cl(){}function hl(t,e,i){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=n&&t.clipExtent(null),wo(i,t.stream(Ts)),e(Ts.result()),null!=n&&t.clipExtent(n),t}function dl(t,e,i){return hl(t,(function(i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),o=+e[0][0]+(n-a*(i[1][0]+i[0][0]))/2,s=+e[0][1]+(r-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([o,s])}),i)}function pl(t,e,i){return dl(t,[[0,0],e],i)}function fl(t,e,i){return hl(t,(function(i){var n=+e,r=n/(i[1][0]-i[0][0]),a=(n-r*(i[1][0]+i[0][0]))/2,o=-r*i[0][1];t.scale(150*r).translate([a,o])}),i)}function vl(t,e,i){return hl(t,(function(i){var n=+e,r=n/(i[1][1]-i[0][1]),a=-r*i[0][0],o=(n-r*(i[1][1]+i[0][1]))/2;t.scale(150*r).translate([a,o])}),i)}ol.prototype={_radius:4.5,_circle:sl(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=sl(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},cl.prototype={constructor:cl,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gl=16,yl=co(30*oo);function ml(t,e){return+e?function(t,e){function i(n,r,a,o,s,l,u,c,h,d,p,f,v,g){var y=u-n,m=c-r,_=y*y+m*m;if(_>4*e&&v--){var b=o+d,x=s+p,k=l+f,S=yo(b*b+x*x+k*k),A=bo(k/=S),C=so(so(k)-1)<to||so(a-h)<to?(a+h)/2:uo(x,b),M=t(C,A),w=M[0],T=M[1],D=w-n,E=T-r,B=m*D-y*E;(B*B/_>e||so((y*D+m*E)/_-.5)>.3||o*d+s*p+l*f<yl)&&(i(n,r,a,o,s,l,w,T,C,b/=S,x/=S,k,v,g),g.point(w,T),i(w,T,C,b,x,k,u,c,h,d,p,f,v,g))}}return function(e){var n,r,a,o,s,l,u,c,h,d,p,f,v={point:g,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),v.lineStart=b},polygonEnd:function(){e.polygonEnd(),v.lineStart=y}};function g(i,n){i=t(i,n),e.point(i[0],i[1])}function y(){c=NaN,v.point=m,e.lineStart()}function m(n,r){var a=Do([n,r]),o=t(n,r);i(c,h,u,d,p,f,c=o[0],h=o[1],u=n,d=a[0],p=a[1],f=a[2],gl,e),e.point(c,h)}function _(){v.point=g,e.lineEnd()}function b(){y(),v.point=x,v.lineEnd=k}function x(t,e){m(n=t,e),r=c,a=h,o=d,s=p,l=f,v.point=m}function k(){i(c,h,u,d,p,f,r,a,n,o,s,l,gl,e),v.lineEnd=_,_()}return v}}(t,e):function(t){return ul({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var _l=ul({point:function(t,e){this.stream.point(t*oo,e*oo)}});function bl(t,e,i,n,r){function a(a,o){return[e+t*(a*=n),i-t*(o*=r)]}return a.invert=function(a,o){return[(a-e)/t*n,(i-o)/t*r]},a}function xl(t,e,i,n,r,a){var o=co(a),s=vo(a),l=o*t,u=s*t,c=o/t,h=s/t,d=(s*i-o*e)/t,p=(s*e+o*i)/t;function f(t,a){return[l*(t*=n)-u*(a*=r)+e,i-u*t-l*a]}return f.invert=function(t,e){return[n*(c*t-h*e+d),r*(p-h*t-c*e)]},f}function kl(t){return Sl((function(){return t}))()}function Sl(t){var e,i,n,r,a,o,s,l,u,c,h=150,d=480,p=250,f=0,v=0,g=0,y=0,m=0,_=0,b=1,x=1,k=null,S=is,A=null,C=ss,M=.5;function w(t){return l(t[0]*oo,t[1]*oo)}function T(t){return(t=l.invert(t[0],t[1]))&&[t[0]*ao,t[1]*ao]}function D(){var t=xl(h,0,0,b,x,_).apply(null,e(f,v)),n=(_?xl:bl)(h,d-t[0],p-t[1],b,x,_);return i=Oo(g,y,m),s=Io(e,n),l=Io(i,s),o=ml(s,M),E()}function E(){return u=c=null,w}return w.stream=function(t){return u&&c===t?u:u=_l(function(t){return ul({point:function(e,i){var n=t(e,i);return this.stream.point(n[0],n[1])}})}(i)(S(o(C(c=t)))))},w.preclip=function(t){return arguments.length?(S=t,k=void 0,E()):S},w.postclip=function(t){return arguments.length?(C=t,A=n=r=a=null,E()):C},w.clipAngle=function(t){return arguments.length?(S=+t?ns(k=t*oo):(k=null,is),E()):k*ao},w.clipExtent=function(t){return arguments.length?(C=null==t?(A=n=r=a=null,ss):os(A=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),E()):null==A?null:[[A,n],[r,a]]},w.scale=function(t){return arguments.length?(h=+t,D()):h},w.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],D()):[d,p]},w.center=function(t){return arguments.length?(f=t[0]%360*oo,v=t[1]%360*oo,D()):[f*ao,v*ao]},w.rotate=function(t){return arguments.length?(g=t[0]%360*oo,y=t[1]%360*oo,m=t.length>2?t[2]%360*oo:0,D()):[g*ao,y*ao,m*ao]},w.angle=function(t){return arguments.length?(_=t%360*oo,D()):_*ao},w.reflectX=function(t){return arguments.length?(b=t?-1:1,D()):b<0},w.reflectY=function(t){return arguments.length?(x=t?-1:1,D()):x<0},w.precision=function(t){return arguments.length?(o=ml(s,M=t*t),E()):yo(M)},w.fitExtent=function(t,e){return dl(w,t,e)},w.fitSize=function(t,e){return pl(w,t,e)},w.fitWidth=function(t,e){return fl(w,t,e)},w.fitHeight=function(t,e){return vl(w,t,e)},function(){return e=t.apply(this,arguments),w.invert=e.invert&&T,D()}}function Al(t){var e=0,i=eo/3,n=Sl(t),r=n(e,i);return r.parallels=function(t){return arguments.length?n(e=t[0]*oo,i=t[1]*oo):[e*ao,i*ao]},r}function Cl(t,e){var i=vo(t),n=(i+vo(e))/2;if(so(n)<to)return function(t){var e=co(t);function i(t,i){return[t*e,vo(i)/e]}return i.invert=function(t,i){return[t/e,bo(i*e)]},i}(t);var r=1+i*(2*n-i),a=yo(r)/n;function o(t,e){var i=yo(r-2*n*vo(e))/n;return[i*vo(t*=n),a-i*co(t)]}return o.invert=function(t,e){var i=a-e,o=uo(t,so(i))*go(i);return i*n<0&&(o-=eo*go(t)*go(i)),[o/n,bo((r-(t*t+i*i)*n*n)/(2*n))]},o}function Ml(){return Al(Cl).scale(155.424).center([0,33.6442])}function wl(){return Ml().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Tl(t){return function(e,i){var n=co(e),r=co(i),a=t(n*r);return[a*r*vo(e),a*vo(i)]}}function Dl(t){return function(e,i){var n=yo(e*e+i*i),r=t(n),a=vo(r),o=co(r);return[uo(e*a,n*o),bo(n&&i*a/n)]}}var El=Tl((function(t){return yo(2/(1+t))}));El.invert=Dl((function(t){return 2*bo(t/2)}));var Bl=Tl((function(t){return(t=_o(t))&&t/vo(t)}));function Pl(t,e){return[t,po(mo((io+e)/2))]}function Rl(t){var e,i,n,r=kl(t),a=r.center,o=r.scale,s=r.translate,l=r.clipExtent,u=null;function c(){var a=eo*o(),s=r(function(t){function e(e){return(e=t(e[0]*oo,e[1]*oo))[0]*=ao,e[1]*=ao,e}return t=Oo(t[0]*oo,t[1]*oo,t.length>2?t[2]*oo:0),e.invert=function(e){return(e=t.invert(e[0]*oo,e[1]*oo))[0]*=ao,e[1]*=ao,e},e}(r.rotate()).invert([0,0]));return l(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===Pl?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,i),n]]:[[u,Math.max(s[1]-a,e)],[i,Math.min(s[1]+a,n)]])}return r.scale=function(t){return arguments.length?(o(t),c()):o()},r.translate=function(t){return arguments.length?(s(t),c()):s()},r.center=function(t){return arguments.length?(a(t),c()):a()},r.clipExtent=function(t){return arguments.length?(null==t?u=e=i=n=null:(u=+t[0][0],e=+t[0][1],i=+t[1][0],n=+t[1][1]),c()):null==u?null:[[u,e],[i,n]]},c()}function Ll(t){return mo((io+t)/2)}function Il(t,e){var i=co(t),n=t===e?vo(t):po(i/co(e))/po(Ll(e)/Ll(t)),r=i*fo(Ll(t),n)/n;if(!n)return Pl;function a(t,e){r>0?e<-io+to&&(e=-io+to):e>io-to&&(e=io-to);var i=r/fo(Ll(e),n);return[i*vo(n*t),r-i*co(n*t)]}return a.invert=function(t,e){var i=r-e,a=go(n)*yo(t*t+i*i),o=uo(t,so(i))*go(i);return i*n<0&&(o-=eo*go(t)*go(i)),[o/n,2*lo(fo(r/a,1/n))-io]},a}function Fl(t,e){return[t,e]}function Ol(t,e){var i=co(t),n=t===e?vo(t):(i-co(e))/(e-t),r=i/n+t;if(so(n)<to)return Fl;function a(t,e){var i=r-e,a=n*t;return[i*vo(a),r-i*co(a)]}return a.invert=function(t,e){var i=r-e,a=uo(t,so(i))*go(i);return i*n<0&&(a-=eo*go(t)*go(i)),[a/n,r-go(n)*yo(t*t+i*i)]},a}Bl.invert=Dl((function(t){return t})),Pl.invert=function(t,e){return[t,2*lo(ho(e))-io]},Fl.invert=Fl;var zl=1.340264,Hl=-.081106,Nl=893e-6,Ul=.003796,jl=yo(3)/2;function Vl(t,e){var i=bo(jl*vo(e)),n=i*i,r=n*n*n;return[t*co(i)/(jl*(zl+3*Hl*n+r*(7*Nl+9*Ul*n))),i*(zl+Hl*n+r*(Nl+Ul*n))]}function Wl(t,e){var i=co(e),n=co(t)*i;return[i*vo(t)/n,vo(e)/n]}function Gl(t,e){var i=e*e,n=i*i;return[t*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791)),e*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))]}function Yl(t,e){return[co(e)*vo(t),vo(e)]}function Xl(t,e){var i=co(e),n=1+co(t)*i;return[i*vo(t)/n,vo(e)/n]}function Kl(t,e){return[po(mo((io+e)/2)),-t]}function ql(t){return t}function Zl(t,e){var i=e.id,n=e.bbox,r=null==e.properties?{}:e.properties,a=function(t,e){var i=function(t){if(null==t)return ql;var e,i,n=t.scale[0],r=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,s){s||(e=i=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*n+a,c[1]=(i+=t[1])*r+o;l<u;)c[l]=t[l],++l;return c}}(t.transform),n=t.arcs;function r(t,e){e.length&&e.pop();for(var r=n[t<0?~t:t],a=0,o=r.length;a<o;++a)e.push(i(r[a],a));t<0&&function(t,e){for(var i,n=t.length,r=n-e;r<--n;)i=t[r],t[r++]=t[n],t[n]=i}(e,o)}function a(t){return i(t)}function o(t){for(var e=[],i=0,n=t.length;i<n;++i)r(t[i],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}function u(t){var e,i=t.type;switch(i){case"GeometryCollection":return{type:i,geometries:t.geometries.map(u)};case"Point":e=a(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(a);break;case"LineString":e=o(t.arcs);break;case"MultiLineString":e=t.arcs.map(o);break;case"Polygon":e=l(t.arcs);break;case"MultiPolygon":e=t.arcs.map(l);break;default:return null}return{type:i,coordinates:e}}return u(e)}(t,e);return null==i&&null==n?{type:"Feature",properties:r,geometry:a}:null==n?{type:"Feature",id:i,properties:r,geometry:a}:{type:"Feature",id:i,bbox:n,properties:r,geometry:a}}Vl.invert=function(t,e){for(var i,n=e,r=n*n,a=r*r*r,o=0;o<12&&(a=(r=(n-=i=(n*(zl+Hl*r+a*(Nl+Ul*r))-e)/(zl+3*Hl*r+a*(7*Nl+9*Ul*r)))*n)*r*r,!(so(i)<1e-12));++o);return[jl*t*(zl+3*Hl*r+a*(7*Nl+9*Ul*r))/co(n),bo(vo(n)/jl)]},Wl.invert=Dl(lo),Gl.invert=function(t,e){var i,n=e,r=25;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(so(i)>to&&--r>0);return[t/(.8707+(a=n*n)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),n]},Yl.invert=Dl(bo),Xl.invert=Dl((function(t){return 2*lo(t)})),Kl.invert=function(t,e){return[-e,2*lo(ho(t))-io]};var Jl={exports:{}},Ql=function(t,e){this.p1=t,this.p2=e};Ql.prototype.rise=function(){return this.p2[1]-this.p1[1]},Ql.prototype.run=function(){return this.p2[0]-this.p1[0]},Ql.prototype.slope=function(){return this.rise()/this.run()},Ql.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},Ql.prototype.isVertical=function(){return!isFinite(this.slope())},Ql.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},Ql.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},Ql.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},Ql.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},Ql.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)};var $l=Ql,tu=function(t,e){for(var i=0,n=0,r=1;r<=t.length-2;r++){var a=new $l(t[0],t[t.length-1]).perpendicularDistance(t[r]);a>i&&(n=r,i=a)}if(i>e)var o=tu(t.slice(0,n),e),s=tu(t.slice(n,t.length),e),l=o.concat(s);else l=t.length>1?[t[0],t[t.length-1]]:[t[0]];return l},eu=tu;!function(t){var e=eu;function i(e,i){var n=e.geometry,r=n.type;if("LineString"===r)n.coordinates=t.exports.simplify(n.coordinates,i);else if("Polygon"===r||"MultiLineString"===r)for(var a=0;a<n.coordinates.length;a++)n.coordinates[a]=t.exports.simplify(n.coordinates[a],i);else if("MultiPolygon"===r)for(var o=0;o<n.coordinates.length;o++)for(var s=0;s<n.coordinates[o].length;s++)n.coordinates[o][s]=t.exports.simplify(n.coordinates[o][s],i);return e}t.exports=function(t,e,n){return n||(t=JSON.parse(JSON.stringify(t))),t.features?function(t,e){for(var n=0;n<t.features.length;n++)t.features[n]=i(t.features[n],e);return t}(t,e):t.type&&"Feature"===t.type?i(t,e):new Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,i){return e(t,i)}}(Jl);var iu=F(Jl.exports),nu=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return ou.apply(void 0,[ft(t)].concat(i))};function ru(t,e,i){var n=e[i];if(void 0===n)t[i]=null;else if(G(n))for(var r in G(t[i])||(t[i]={}),n)ru(t[i],n,r);else t[i]=n}function au(t,e){if(G(e)&&t!==e)for(var i in e)ru(t,e,i)}function ou(t){t||(t={});for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)au(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1]);return t}var su,lu={tolerance:.01},uu=function(t,e){var i=nu(lu,e).tolerance;return iu(t,i)};!function(t){t.DSV="dsv",t.TREE="tree",t.GEO="geo",t.BYTE="bytejson",t.HEX="hex",t.GRAPH="graph",t.TABLE="table",t.GEO_GRATICULE="geo-graticule"}(su||(su={}));var cu=function(t,e){for(var i=e.fields,n=e.key,r=e.value,a=e.retains,o=[],s=function(e){i.forEach((function(s){var l={};if(l[n]=s,l[r]=t[e][s],a)a.forEach((function(i){l[i]=t[e][i]}));else for(var u in t[e])-1===i.indexOf(u)&&(l[u]=t[e][u]);o.push(l)}))},l=0;l<t.length;l++)s(l);return o},hu=function(t,e){var i,n;if(!(null==e?void 0:e.fields))return t;if(0===t.length)return t;var r=e.fields,a=t[0],o={},s=[],l=function(e){if(Object.prototype.hasOwnProperty.call(r,e)){var l,u=r[e];if(u.sort&&(it(u.sortIndex)||(u.sortIndex=0),W(u.sortReverse)||(u.sortReverse="desc"===u.sort)),!u.type){var c=a;e in a||(c=null!==(i=t.find((function(t){return e in t})))&&void 0!==i?i:a),u.type="number"==typeof c[e]?"linear":"ordinal"}if("number"==typeof u.sortIndex&&(l={key:e,type:u.type,index:u.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===u.sortReverse},s.push(l)),(null===(n=u.domain)||void 0===n?void 0:n.length)>0)if("ordinal"===u.type){u._domainCache={},o[e]=u;var h={};u.domain.forEach((function(t,e){h[t]=e,u._domainCache[t]=e})),l&&(l.sortIndex=h,l.sortIndexCount=u.domain.length)}else u.domain.length>=2&&(o[e]=u)}};for(var u in r)l(u);return Object.keys(o).length>0&&(t=t.filter((function(t){for(var e in o){var i=o[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0}))),s.sort((function(t,e){return t.index-e.index})),t.sort((function(t,e){return function(t,e,i){for(var n=0;n<i.length;n++){var r=i[n],a=0;if("ordinal"===r.type?(void 0===r.sortIndex[e[r.key]]&&(r.sortIndex[e[r.key]]=r.sortIndexCount++),void 0===r.sortIndex[t[r.key]]&&(r.sortIndex[t[r.key]]=r.sortIndexCount++),a=r.sortIndex[t[r.key]]-r.sortIndex[e[r.key]]):"linear"===r.type&&(a=t[r.key]-e[r.key]),r.sortReverse&&(a=-a),0!==a)return a}return 0}(t,e,s)})),t};var du=function(t,e){var i,n,r,a,o,s,u,c,h=null==e?void 0:e.field;if(!h)return[];var d,p=t.length,f=1/0,v=-1/0;if(null==e?void 0:e.extent)f=e.extent[0],v=e.extent[1];else for(var g=0;g<p;g++){var y=t[g][h];if(!j(y)){var m=+y;Number.isFinite(m)&&(m<f&&(f=m),m>v&&(v=m))}}if(!Number.isFinite(f)||!Number.isFinite(v)||0===p)return[];if(e&&e.thresholds&&e.thresholds.length)(d=e.thresholds.slice()).sort((function(t,e){return t-e}));else if(e&&"number"==typeof e.step&&e.step>0){var _=e.step,b=f;for(e.extent||(b=Math.floor(f/_)*_),d=[b];b<v;)b+=_,d.push(b)}else{var x=(null==e?void 0:e.bins)&&e.bins>0?Math.floor(e.bins):10,k=(v-f)/x;d=new Array(x+1);for(var S=0;S<=x;S++)d[S]=S===x?v:f+k*S}var A=Math.max(0,d.length-1);if(0===A)return[];for(var C=null!==(n=null===(i=e.outputNames)||void 0===i?void 0:i.x0)&&void 0!==n?n:"x0",M=null!==(a=null===(r=e.outputNames)||void 0===r?void 0:r.x1)&&void 0!==a?a:"x1",w=null!==(s=null===(o=e.outputNames)||void 0===o?void 0:o.count)&&void 0!==s?s:"count",T=null!==(c=null===(u=e.outputNames)||void 0===u?void 0:u.values)&&void 0!==c?c:"values",D=new Array(A),E=0;E<A;E++)D[E]=l(l(l({},C,d[E]),M,d[E+1]),w,0),(null==e?void 0:e.includeValues)&&(D[E][T]=[]);for(var B=0;B<p;B++){var P=t[B][h];if(null!=P){var R=+P;if(Number.isFinite(R))for(var L=0;L<A;L++){var I=D[L][C],F=D[L][M];if(R>=I&&R<F||L===A-1&&R<=F){D[L][w]++,e&&e.includeValues&&D[L][T].push(t[B]);break}}}}return D},pu=function(t,e){var i,n,r,a,o,l,u,c,h,d,p,f,v,g,y,_,b=null==e?void 0:e.field;if(!b)return[];for(var x=null==e?void 0:e.groupField,k=null!==(i=null==e?void 0:e.whiskers)&&void 0!==i?i:1.5,S=!!(null==e?void 0:e.includeValues),A=null!==(n=null==e?void 0:e.outputNames)&&void 0!==n?n:{},C=null!==(r=A.key)&&void 0!==r?r:Z(x)?null:null!==(a=x)&&void 0!==a?a:"key",M=null!==(o=A.count)&&void 0!==o?o:"count",w=null!==(l=A.mean)&&void 0!==l?l:"mean",T=null!==(u=A.q1)&&void 0!==u?u:"q1",D=null!==(c=A.median)&&void 0!==c?c:"median",E=null!==(h=A.q3)&&void 0!==h?h:"q3",B=null!==(d=A.iqr)&&void 0!==d?d:"iqr",P=null!==(p=A.min)&&void 0!==p?p:"min",R=null!==(f=A.max)&&void 0!==f?f:"max",L=null!==(v=A.lowerWhisker)&&void 0!==v?v:"lowerWhisker",I=null!==(g=A.upperWhisker)&&void 0!==g?g:"upperWhisker",F=null!==(y=A.outliers)&&void 0!==y?y:"outliers",O=null!==(_=A.values)&&void 0!==_?_:"values",z=new Map,H=new Map,N=new Map,U=t.length,V=function(){var e=t[W],i=e[b];if(j(i))return 0;var n,r=+i;if(!Number.isFinite(r))return 0;n=Z(x)?x.map((function(t){return String(e[t])})).join("||"):x?String(e[x]):"___all",z.has(n)||(z.set(n,[]),S&&H.set(n,[]),Z(x)?N.set(n,Object.fromEntries(x.map((function(t){return[t,e[t]]})))):N.set(n,x?e[x]:null));var a=z.get(n);if(a&&a.push(r),S){var o=H.get(n);o&&o.push(e)}},W=0;W<U;W++)V();Z(k)&&(k=[he(Math.min.apply(null,k),0,1),he(Math.max.apply(null,k),0,1)]);var G,Y=[],X=s(z);try{for(X.s();!(G=X.n()).done;){var K=m(G.value,2),q=K[0],J=K[1];if(J&&0!==J.length){for(var Q=J.slice().sort((function(t,e){return t-e})),$=Q.length,tt=Q[0],et=Q[Q.length-1],it=0,nt=0;nt<Q.length;nt++)it+=Q[nt];for(var rt=it/$,at=Nt(Q,.25),ot=Nt(Q,.5),st=Nt(Q,.75),lt=st-at,ut=Z(k)?Nt(Q,k[0]):at-k*lt,ct=Z(k)?Nt(Q,k[1]):st+k*lt,ht=tt,dt=0;dt<Q.length;dt++)if(Q[dt]>=ut){ht=Q[dt];break}for(var pt=et,ft=Q.length-1;ft>=0;ft--)if(Q[ft]<=ct){pt=Q[ft];break}for(var vt=[],gt=0;gt<Q.length;gt++)(Q[gt]<ht||Q[gt]>pt)&&vt.push(Q[gt]);var yt={},mt=N.get(q);if(null!==C)yt[C]=mt;else if(Z(x)){var _t,bt=mt||{},xt=s(x);try{for(xt.s();!(_t=xt.n()).done;){var kt=_t.value;yt[kt]=bt[kt]}}catch(t){xt.e(t)}finally{xt.f()}}yt[M]=$,yt[w]=rt,yt[T]=at,yt[D]=ot,yt[E]=st,yt[B]=lt,yt[P]=tt,yt[R]=et,yt[L]=ht,yt[I]=pt,yt[F]=vt,S&&(yt[O]=H.get(q)||[]),Y.push(yt)}}}catch(t){X.e(t)}finally{X.f()}return Y},fu={},vu={};function gu(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function yu(t){var e=Object.create(null),i=[];return t.forEach((function(t){for(var n in t)n in e||i.push(e[n]=n)})),i}function mu(t,e){var i=t+"",n=i.length;return n<e?new Array(e-n+1).join(0)+i:i}function _u(t){var e,i=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+mu(-e,6):e>9999?"+"+mu(e,6):mu(e,4))+"-"+mu(t.getUTCMonth()+1,2)+"-"+mu(t.getUTCDate(),2)+(a?"T"+mu(i,2)+":"+mu(n,2)+":"+mu(r,2)+"."+mu(a,3)+"Z":r?"T"+mu(i,2)+":"+mu(n,2)+":"+mu(r,2)+"Z":n||i?"T"+mu(i,2)+":"+mu(n,2)+"Z":"")}function bu(t){var e=new RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function n(t,e){var n,r=[],a=t.length,o=0,s=0,l=a<=0,u=!1;function c(){if(l)return vu;if(u)return u=!1,fu;var e,n,r=o;if(34===t.charCodeAt(r)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?l=!0:10===(n=t.charCodeAt(o++))?u=!0:13===n&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(r+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(n=t.charCodeAt(e=o++)))u=!0;else if(13===n)u=!0,10===t.charCodeAt(o)&&++o;else if(n!==i)continue;return t.slice(r,e)}return l=!0,t.slice(r,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(n=c())!==vu;){for(var h=[];n!==fu&&n!==vu;)h.push(n),n=c();e&&null==(h=e(h,s++))||r.push(h)}return r}function r(e,i){return e.map((function(e){return i.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?_u(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,r,a=n(t,(function(t,n){if(i)return i(t,n-1);r=t,i=e?function(t,e){var i=gu(t);return function(n,r){return e(i(n),r,t)}}(t,e):gu(t)}));return a.columns=r||[],a},parseRows:n,format:function(e,i){return null==i&&(i=yu(e)),[i.map(o).join(t)].concat(r(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=yu(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}var xu=bu(",").parse,ku=bu("\t").parse,Su={delimiter:","},Au=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=su.DSV;var i=nu(Su,e).delimiter;if(!q(i))throw new TypeError("Invalid delimiter: must be a string!");return bu(i).parse(t)},Cu=function(t){return(arguments.length>2?arguments[2]:void 0).type=su.DSV,xu(t)},Mu=function(t){return(arguments.length>2?arguments[2]:void 0).type=su.DSV,ku(t)};function wu(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return Tu(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}})),e.features=t.features.map((function(t){return Tu(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Eu(t);default:throw new Error("unknown GeoJSON type")}}function Tu(t){var e={type:"Feature"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}})),e.properties=Du(t.properties),e.geometry=Eu(t.geometry),e}function Du(t){var e={};return t?(Object.keys(t).forEach((function(i){var n=t[i];"object"===k(n)?null===n?e[i]=null:Array.isArray(n)?e[i]=n.map((function(t){return t})):e[i]=Du(n):e[i]=n})),e):e}function Eu(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Eu(t)})),e):(e.coordinates=Bu(t.coordinates),e)}function Bu(t){var e=t;return"object"!==k(e[0])?e.slice():e.map((function(t){return Bu(t)}))}function Pu(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ru(t){for(var e,i,n=Pu(t),r=0,a=1;a<n.length;)e=i||n[0],r+=((i=n[a])[0]-e[0])*(i[1]+e[1]),a++;return r>0}function Lu(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function Iu(t,e){var i,n,r,a,o,s,l,u,c,h,d=0,p="FeatureCollection"===t.type,f="Feature"===t.type,v=p?t.features.length:1;for(i=0;i<v;i++){for(s=p?t.features[i].geometry:f?t.geometry:t,u=p?t.features[i].properties:f?t.properties:{},c=p?t.features[i].bbox:f?t.bbox:void 0,h=p?t.features[i].id:f?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<o;r++)if(null!==(a=l?s.geometries[r]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,d,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===e(a.geometries[n],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function Fu(t,e){if(!(i=e=e||{})||i.constructor!==Object)throw new Error("options is invalid");var i,n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=wu(t));var a=[];switch(t.type){case"GeometryCollection":return Iu(t,(function(t){Ou(t,n)})),t;case"FeatureCollection":return Lu(t,(function(t){Lu(Ou(t,n),(function(t){a.push(t)}))})),xa(a)}return Ou(t,n)}function Ou(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return Iu(t,(function(t){Ou(t,e)})),t;case"LineString":return zu(Pu(t),e),t;case"Polygon":return Hu(Pu(t),e),t;case"MultiLineString":return Pu(t).forEach((function(t){zu(t,e)})),t;case"MultiPolygon":return Pu(t).forEach((function(t){Hu(t,e)})),t;case"Point":case"MultiPoint":return t}}function zu(t,e){Ru(t)===e&&t.reverse()}function Hu(t,e){Ru(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)Ru(t[i])===e&&t[i].reverse()}function Nu(t){if(!t)throw new Error("geojson is required");var e=[];return function(t,e){Iu(t,(function(t,i,n,r,a){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(ba(t,n,{bbox:r,id:a}),i,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(ba({type:o,coordinates:u},n),i,l))return!1}}))}(t,(function(t){e.push(t)})),xa(e)}var Uu=ll(),ju={centroid:!1,name:!1,bbox:!1,rewind:!1},Vu=function(t){if(t.geometry.type.startsWith("Multi")){var e=Nu(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},Wu=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=su.GEO;var i=nu(ju,e),n=i.centroid,r=i.name,a=i.bbox,o=i.rewind;if(Array.isArray(t))return function(t){var e=[];return t.forEach((function(t){"FeatureCollection"===t.type?t.features.forEach((function(t){e.push(Vu(t))})):e.push(Vu(t))})),e}(t);var s=t.features;return o&&(s=Fu(t,{reverse:!G(o)||o.reverse}).features),s.forEach((function(t){if(n){var e=Uu.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(r&&(t.name=t.properties.name),a){var i=Uu.bounds(t);t.bbox=i}})),t.features=s,t},Gu={},Yu=function(t,e,i){i.type=su.GEO;var n=nu(ju,Gu,e),r=n.object;if(!q(r))throw new TypeError("Invalid object: must be a string!");var a,o,s=(a=t,"string"==typeof(o=t.objects[r])&&(o=a.objects[o]),"GeometryCollection"===o.type?{type:"FeatureCollection",features:o.geometries.map((function(t){return Zl(a,t)}))}:Zl(a,o));return Wu(s,n,i)},Xu=function(t,e,i){var n=!N(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!Z(t))throw new TypeError("Invalid data: must be DataView array!");return Z(i.rawData)&&i.rawData.forEach((function(t){t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))})),n&&t.forEach((function(t){t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)})),t},Ku={svg:"group",rect:"rect",line:"rule",polygon:"polygon",path:"path",polyline:"line",g:"group",circle:"arc",ellipse:"arc"},qu=Object.keys(Ku),Zu=["g","svg","text","tspan","switch"],Ju=["font-size","font-family","font-weight","font-style","text-align","text-anchor"],Qu=["visibility","x","y","width","height","d","points","stroke","stroke-width","fill","fill-opacity","stroke-opacity"].concat(Ju,["cx","cy","r"],["cx","cy","rx","ry"],["x1","x2","y1","y2"]),$u=["visible","fill","stroke","stroke-width","fill-opacity","stroke-opacity"].concat(Ju),tc=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var ec=0;function ic(t){var e,i=t.parent,n=t.attributes,r=function(t){return t?$u.reduce((function(e,i){var n=ga(i);return W(t[n])&&(e[n]=t[n]),e}),{}):{}};return i?(i._inheritStyle||(i._inheritStyle=r(i.attributes)),e=mt({},i._inheritStyle,r(n))):e=r(n),e}function nc(t){for(var e,i,n,r={},a=null!==(e=t.attributes)&&void 0!==e?e:{},o=null!==(i=t.style)&&void 0!==i?i:{},s=0;s<Qu.length;s++){var l=Qu[s],u=W(o[l])&&""!==o[l]?o[l]:null===(n=a[l])||void 0===n?void 0:n.value;W(u)&&(r[ga(l)]=isNaN(+u)?u:parseFloat(u))}return"none"===o.display&&(r.visible=!1),["fontSize","strokeWidth","width","height"].forEach((function(t){var e=r[t];q(r[t])&&(r[t]=parseFloat(e))})),r}function rc(t,e){var i,n,r,a,o,s=null===(i=t.tagName)||void 0===i?void 0:i.toLowerCase();if(3===t.nodeType||"text"===s||"tspan"===s)return function(t,e){var i,n,r,a,o,s;if(!e)return null;var l=null===(i=t.tagName)||void 0===i?void 0:i.toLowerCase();if(!l&&"group"!==e.graphicType)return null;var u,c="text"===l||"tspan"===l,h=c?"group":"text",d=c||null===(n=t.textContent)||void 0===n?void 0:n.replace(/\n/g," ").replace(/\s+/g," ");return" "===d?null:(u=c?{tagName:l,graphicType:h,attributes:nc(t),parent:e,name:t.getAttribute("name"),id:null!==(r=t.getAttribute("id"))&&void 0!==r?r:"".concat(l,"-").concat(ec++),transform:ac(t),value:d}:{tagName:l,graphicType:"text",attributes:nc(t),parent:e,name:null==e?void 0:e.name,id:null!==(o=null===(a=t.getAttribute)||void 0===a?void 0:a.call(t,"id"))&&void 0!==o?o:"".concat(l,"-").concat(ec++),value:d},u._inheritStyle=ic(u),W(u.name)||(u._nameFromParent=null!==(s=e.name)&&void 0!==s?s:e._nameFromParent),c?e._textGroupStyle?u._textGroupStyle=mt({},e._textGroupStyle,nc(t)):u._textGroupStyle=nc(t):u.attributes=u._inheritStyle,u)}(t,e);if(!qu.includes(s))return null;var l={tagName:s,graphicType:Ku[s],attributes:nc(t),parent:e,name:null!==(n=t.getAttribute("name"))&&void 0!==n?n:null===(r=null==e?void 0:e.attributes)||void 0===r?void 0:r.name,id:null!==(a=t.getAttribute("id"))&&void 0!==a?a:"".concat(s,"-").concat(ec++),transform:ac(t)};return l._inheritStyle=ic(l),e&&!W(l.name)&&(l._nameFromParent=null!==(o=e.name)&&void 0!==o?o:e._nameFromParent),l}function ac(t){var e,i,n=null===(e=t.transform)||void 0===e?void 0:e.baseVal;if(!n)return null;var r=null===(i=n.consolidate())||void 0===i?void 0:i.matrix;if(!r)return null;var a=r.a,o=r.b,s=r.c,l=r.d,u=r.e,c=r.f;return new Hn(a,o,s,l,u,c)}function oc(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t){var r;"svg"!==t.nodeName&&(r=rc(t,e)),r&&n.push(r);for(var a=Zu.includes(null===(i=t.tagName)||void 0===i?void 0:i.toLocaleLowerCase())?t.firstChild:null;a;)oc(a,null!=r?r:e,n),a=a.nextSibling}}var sc=0;function lc(){return sc>1e8&&(sc=0),(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dataset")+"_"+sc++}var uc=function(){return o((function t(e){var i,n;r(this,t),this.options=e,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new z,n=(null==e?void 0:e.name)?e.name:lc("dataset"),this.name=n,this._logger=null!==(i=null==e?void 0:e.logger)&&void 0!==i?i:Wt.getInstance()}),[{key:"setLogger",value:function(t){this._logger=t}},{key:"getDataView",value:function(t){return this.dataViewMap[t]}},{key:"setDataView",value:function(t,e){var i;this.dataViewMap[t]&&(null===(i=this._logger)||void 0===i||i.error("Error: dataView ".concat(t," 之前已存在，请重新命名"))),this.dataViewMap[t]=e}},{key:"removeDataView",value:function(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}},{key:"registerParser",value:function(t,e){var i;this.parserMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.parserMap[t]=e}},{key:"removeParser",value:function(t){this.parserMap[t]=null,delete this.parserMap[t]}},{key:"getParser",value:function(t){return this.parserMap[t]||this.parserMap.default}},{key:"registerTransform",value:function(t,e){var i;this.transformMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.transformMap[t]=e}},{key:"removeTransform",value:function(t){this.transformMap[t]=null,delete this.transformMap[t]}},{key:"getTransform",value:function(t){return this.transformMap[t]}},{key:"multipleDataViewAddListener",value:function(t,e,i){this._callMap||(this._callMap=new Map);var n=this._callMap.get(i);n||(n=function(){t.some((function(t){return t.isRunning}))||i()}),t.forEach((function(t){t.target.addListener(e,n)})),this._callMap.set(i,n)}},{key:"allDataViewAddListener",value:function(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}},{key:"multipleDataViewRemoveListener",value:function(t,e,i){if(this._callMap){var n=this._callMap.get(i);n&&t.forEach((function(t){t.target.removeListener(e,n)})),this._callMap.delete(i)}}},{key:"multipleDataViewUpdateInParse",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.parseNewData(t.data,t.options)}))}},{key:"multipleDataViewUpdateInRawData",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.updateRawData(t.data,t.options)}))}},{key:"destroy",value:function(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}])}(),cc=function(){function t(e,i){var n,a=this;r(this,t),this.dataSet=e,this.options=i,this.isDataView=!0,this.target=new z,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=a.latestData;return a.isRunning=!0,a.resetTransformData(),a.transformsArr.forEach((function(e){a.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1})})),a.isRunning=!1,!1===t.emitMessage||t.skipEqual&&St(e,a.latestData)||a.target.emit("change",{latestData:a.latestData}),a},this.markRunning=function(){a.isRunning=!0,a.target.emit("markRunning",[])},n=(null==i?void 0:i.name)?i.name:lc("dataview"),this.name=n,(null==i?void 0:i.history)&&(this.history=i.history,this.historyData=[]),this.dataSet.setDataView(n,this),this.setFields(null==i?void 0:i.fields)}return o(t,[{key:"parse",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isRunning=!0,n&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);var r=this.cloneParseData(t,e);if(null==e?void 0:e.type){var a=(null!==(i=this.dataSet.getParser(e.type))&&void 0!==i?i:this.dataSet.getParser("bytejson"))(r,e.options,this);this.rawData=r,this.parserData=a,this.history&&this.historyData.push(r,a),this.latestData=a}else this.parserData=r,this.rawData=r,this.history&&this.historyData.push(r),this.latestData=r;return this.isRunning=!1,n&&this.target.emit("afterParse",[]),this}},{key:"transform",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isRunning=!0,t&&t.type){var i=!0;if("fields"===t.type){this._fields=t.options.fields;var n=this.transformsArr.findIndex((function(e){return e.type===t.type}));n>=0&&(i=!1,this.transformsArr[n].options.fields=this._fields)}i&&this.transformsArr.push(t),e&&this.executeTransform(t)}return this.sortTransform(),this.isRunning=!1,this}},{key:"sortTransform",value:function(){this.transformsArr.length>=2&&this.transformsArr.sort((function(t,e){var i,n;return(null!==(i=t.level)&&void 0!==i?i:0)-(null!==(n=e.level)&&void 0!==n?n:0)}))}},{key:"executeTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.pushHistory,n=e.emitMessage,r=e.skipEqual,a=this.dataSet.getTransform(t.type),o=this.latestData,s=a(o,t.options);this.history&&!1!==i&&this.historyData.push(s),this.latestData=s,!1===n||r&&St(o,this.latestData)||this.target.emit("change",{latestData:this.latestData})}},{key:"resetTransformData",value:function(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}},{key:"cloneParseData",value:function(e,i){var n=!1;return e instanceof t||!0!==(null==i?void 0:i.clone)||(n=!0),n?ft(e):e}},{key:"parseNewData",value:function(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}},{key:"updateRawData",value:function(t,e){var i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}},{key:"getFields",value:function(){var t;return this._fields?this._fields:"dataview"===(null===(t=this.parseOption)||void 0===t?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}},{key:"setFields",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._fields=t&&e?mt({},this._fields,t):t;var i=this.transformsArr.find((function(t){return"fields"===t.type}));!j(this._fields)&&j(i)?(this.dataSet.registerTransform("fields",hu),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}},{key:"destroy",value:function(){this.dataSet.removeDataView(this.name),this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}])}();ll();var hc={},dc={albers:wl,albersusa:function(){var t,e,i,n,r,a,o=wl(),s=Ml().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Ml().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function c(t){var e=t[0],o=t[1];return a=null,i.point(e,o),a||(n.point(e,o),a)||(r.point(e,o),a)}function h(){return t=e=null,c}return c.invert=function(t){var e=o.scale(),i=o.translate(),n=(t[0]-i[0])/e,r=(t[1]-i[1])/e;return(r>=.12&&r<.234&&n>=-.425&&n<-.214?s:r>=.166&&r<.234&&n>=-.214&&n<-.115?l:o).invert(t)},c.stream=function(i){return t&&e===i?t:(n=[o.stream(e=i),s.stream(i),l.stream(i)],r=n.length,t={point:function(t,e){for(var i=-1;++i<r;)n[i].point(t,e)},sphere:function(){for(var t=-1;++t<r;)n[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)n[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)n[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)n[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)n[t].polygonEnd()}});var n,r},c.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),l.precision(t),h()):o.precision()},c.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),l.scale(t),c.translate(o.translate())):o.scale()},c.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],c=+t[1];return i=o.translate(t).clipExtent([[a-.455*e,c-.238*e],[a+.455*e,c+.238*e]]).stream(u),n=s.translate([a-.307*e,c+.201*e]).clipExtent([[a-.425*e+to,c+.12*e+to],[a-.214*e-to,c+.234*e-to]]).stream(u),r=l.translate([a-.205*e,c+.212*e]).clipExtent([[a-.214*e+to,c+.166*e+to],[a-.115*e-to,c+.234*e-to]]).stream(u),h()},c.fitExtent=function(t,e){return dl(c,t,e)},c.fitSize=function(t,e){return pl(c,t,e)},c.fitWidth=function(t,e){return fl(c,t,e)},c.fitHeight=function(t,e){return vl(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return kl(El).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return kl(Bl).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return Al(Il).scale(109.5).parallels([30,30])},conicequalarea:Ml,conicequidistant:function(){return Al(Ol).scale(131.154).center([0,13.9389])},equalearth:function(){return kl(Vl).scale(177.158)},equirectangular:function(){return kl(Fl).scale(152.63)},gnomonic:function(){return kl(Wl).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,n,r,a,o,s=1,l=0,u=0,c=1,h=1,d=0,p=null,f=1,v=1,g=ul({point:function(t,e){var i=_([t,e]);this.stream.point(i[0],i[1])}}),y=ss;function m(){return f=s*c,v=s*h,a=o=null,_}function _(i){var n=i[0]*f,r=i[1]*v;if(d){var a=r*t-n*e;n=n*t+r*e,r=a}return[n+l,r+u]}return _.invert=function(i){var n=i[0]-l,r=i[1]-u;if(d){var a=r*t+n*e;n=n*t-r*e,r=a}return[n/f,r/v]},_.stream=function(t){return a&&o===t?a:a=g(y(o=t))},_.postclip=function(t){return arguments.length?(y=t,p=i=n=r=null,m()):y},_.clipExtent=function(t){return arguments.length?(y=null==t?(p=i=n=r=null,ss):os(p=+t[0][0],i=+t[0][1],n=+t[1][0],r=+t[1][1]),m()):null==p?null:[[p,i],[n,r]]},_.scale=function(t){return arguments.length?(s=+t,m()):s},_.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],m()):[l,u]},_.angle=function(i){return arguments.length?(e=vo(d=i%360*oo),t=co(d),m()):d*ao},_.reflectX=function(t){return arguments.length?(c=t?-1:1,m()):c<0},_.reflectY=function(t){return arguments.length?(h=t?-1:1,m()):h<0},_.fitExtent=function(t,e){return dl(_,t,e)},_.fitSize=function(t,e){return pl(_,t,e)},_.fitWidth=function(t,e){return fl(_,t,e)},_.fitHeight=function(t,e){return vl(_,t,e)},_},mercator:function(){return Rl(Pl).scale(961/ro)},naturalearth1:function(){return kl(Gl).scale(175.295)},orthographic:function(){return kl(Yl).scale(249.5).clipAngle(90+to)},stereographic:function(){return kl(Xl).scale(250).clipAngle(142)},transversemercator:function(){var t=Rl(Kl),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}},pc=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function fc(t,e){return function i(){var n=e();return n.type=t,n.path=ll().projection(n),n.copy=n.copy||function(){var t=i();return pc.forEach((function(e){n[e]&&t[e](n[e]())})),t.path.pointRadius(n.path.pointRadius()),t},n}}var vc=function(){function t(){r(this,t)}return o(t,null,[{key:"GenAutoIncrementId",value:function(){return t.auto_increment_id++}}])}();vc.auto_increment_id=0;var gc=o((function t(e){r(this,t),this.id=vc.GenAutoIncrementId(),this.registry=e})),yc="named",mc="inject",_c="multi_inject",bc="inversify:tagged",xc="inversify:paramtypes",kc=function(){return o((function t(e,i){r(this,t),this.key=e,this.value=i}),[{key:"toString",value:function(){return this.key===yc?"named: ".concat(String(this.value).toString()," "):"tagged: { key:".concat(this.key.toString(),", value: ").concat(String(this.value)," }")}}])}(),Sc=function(t){var e;return function(t){var e="function"==typeof Symbol&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=Object.getPrototypeOf(Function),n=("object"==("undefined"==typeof process?"undefined":k(process))&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),r=new WeakMap;function a(t,e,i){var a=r.get(t);if(u(a)){if(!i)return;a=new n,r.set(t,a)}var o=a.get(e);if(u(o)){if(!i)return;o=new n,a.set(e,o)}return o}function o(t,e,i){if(s(t,e,i))return!0;var n=v(e);return!c(n)&&o(t,n,i)}function s(t,e,i){var n=a(e,i,!1);return!u(n)&&!!n.has(t)}function l(t,e,i){if(s(t,e,i))return function(t,e,i){var n=a(e,i,!1);if(!u(n))return n.get(t)}(t,e,i);var n=v(e);return c(n)?void 0:l(t,n,i)}function u(t){return void 0===t}function c(t){return null===t}function h(t){return"object"==k(t)?null!==t:"function"==typeof t}function d(t,i){switch(function(t){if(null===t)return 1;switch(k(t)){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===i?"string":5===i?"number":"default",r=function(t,e){var i=t[e];if(null!=i){if(!f(i))throw new TypeError;return i}}(t,e);if(void 0!==r){var a=r.call(t,n);if(h(a))throw new TypeError;return a}return function(t,e){if("string"===e){var i=t.toString;if(f(i)){var n=i.call(t);if(!h(n))return n}var r=t.valueOf;if(f(r)){var a=r.call(t);if(!h(a))return a}}else{var o=t.valueOf;if(f(o)){var s=o.call(t);if(!h(s))return s}var l=t.toString;if(f(l)){var u=l.call(t);if(!h(u))return u}}throw new TypeError}(t,"default"===n?"number":n)}function p(t){var e=d(t,3);return"symbol"==k(e)?e:function(t){return""+t}(e)}function f(t){return"function"==typeof t}function v(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===i)return e;if(e!==i)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var a=r.constructor;return"function"!=typeof a||a===t?e:a}t("defineMetadata",(function(t,e,i,n){if(!h(i))throw new TypeError;return r=t,o=e,void a(i,n,!0).set(r,o);var r,o})),t("hasMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),o(t,e,i)})),t("hasOwnMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),s(t,e,i)})),t("getMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),l(t,e,i)}))}((e=t,function(t,i){"function"!=typeof e[t]&&Object.defineProperty(e,t,{configurable:!0,writable:!0,value:i})})),t}({});function Ac(t,e,i,n){!function(t,e,i,n){var r,a=[n],o={};Sc.hasOwnMetadata(t,e)&&(o=Sc.getMetadata(t,e));var s=o[i];void 0===s&&(s=[]),(r=s).push.apply(r,a),o[i]=s,Sc.defineMetadata(t,o,e)}(bc,t,i.toString(),n)}function Cc(t){return function(e,i,n){Ac(e,0,n,t)}}function Mc(t){return function(e){return function(i,n,r){return Cc(new kc(t,e))(i,n,r)}}}var wc=Mc(mc),Tc=Mc(_c);function Dc(){return function(t){return Sc.defineMetadata(xc,null,t),t}}function Ec(t){return Cc(new kc(yc,t))}var Bc,Pc="Singleton",Rc="Transient",Lc="ConstantValue",Ic="DynamicValue",Fc="Factory",Oc="Function",zc="Instance",Hc="Invalid",Nc=function(){function t(e,i){r(this,t),this.id=vc.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=e,this.scope=i,this.type=Hc,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}return o(t,[{key:"clone",value:function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===Pc&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.provider=this.provider,e.constraint=this.constraint,e.cache=this.cache,e}}])}(),Uc=function(){return o((function t(){r(this,t)}),[{key:"getConstructorMetadata",value:function(t){return{compilerGeneratedMetadata:Sc.getMetadata(xc,t),userGeneratedMetadata:Sc.getMetadata(bc,t)||{}}}},{key:"getPropertiesMetadata",value:function(t){throw new Error("暂未实现")}}])}(),jc=(Bc=yc,function(t){var e=function(e){if(null==e)return!1;if(e.key===Bc&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;for(var i=e.constructorArgsMetadata,n=0;n<i.length;n++)if(i[n].key===Bc&&i[n].value===t)return!0;return!1};return e.metaData=new kc(Bc,t),e}),Vc=function(){return o((function t(e){r(this,t),this._binding=e}),[{key:"inRequestScope",value:function(){throw new Error("暂未实现")}},{key:"inSingletonScope",value:function(){return this._binding.scope=Pc,this}},{key:"inTransientScope",value:function(){return this._binding.scope=Rc,this}},{key:"whenTargetNamed",value:function(t){return this._binding.constraint=jc(t),this}}])}(),Wc=function(){return o((function t(e){r(this,t),this._binding=e}),[{key:"to",value:function(t){return this._binding.type=zc,this._binding.implementationType=t,new Vc(this._binding)}},{key:"toSelf",value:function(){var t=this._binding.serviceIdentifier;return this.to(t)}},{key:"toDynamicValue",value:function(t){return this._binding.type=Ic,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Vc(this._binding)}},{key:"toConstantValue",value:function(t){return this._binding.type=Lc,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Pc,new Vc(this._binding)}},{key:"toFactory",value:function(t){return this._binding.type=Fc,this._binding.factory=t,this._binding.scope=Pc,new Vc(this._binding)}},{key:"toService",value:function(t){this.toDynamicValue((function(e){return e.container.get(t)}))}}])}(),Gc=function(){return o((function t(e){r(this,t);var i=e||{};i.defaultScope=i.defaultScope||Rc,this.options=i,this.id=vc.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new Uc}),[{key:"load",value:function(t){var e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}},{key:"get",value:function(t){var e=this._getNotAllArgs(t,!1);return this._get(e)}},{key:"getAll",value:function(t){var e=this._getAllArgs(t);return this._get(e)}},{key:"getTagged",value:function(t,e,i){var n=this._getNotAllArgs(t,!1,e,i);return this._get(n)}},{key:"getNamed",value:function(t,e){return this.getTagged(t,yc,e)}},{key:"isBound",value:function(t){return this._bindingDictionary.has(t)}},{key:"bind",value:function(t){var e=this.options.defaultScope,i=new Nc(t,e),n=this._bindingDictionary.get(t)||[];return n.push(i),this._bindingDictionary.set(t,n),new Wc(i)}},{key:"unbind",value:function(t){this._bindingDictionary.delete(t)}},{key:"rebind",value:function(t){return this.unbind(t),this.bind(t)}},{key:"_getContainerModuleHelpersFactory",value:function(){var t=this,e=function(t,e){t._binding.moduleId=e},i=function(i){return function(n){var r=t.rebind(n);return e(r,i),r}};return function(n){return{bindFunction:(r=n,function(i){var n=t.bind(i);return e(n,r),n}),isboundFunction:function(e){return t.isBound(e)},rebindFunction:i(n),unbindFunction:function(e){return t.unbind(e)},unbindAsyncFunction:function(t){return null}};var r}}},{key:"_getNotAllArgs",value:function(t,e,i,n){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:n}}},{key:"_getAllArgs",value:function(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}},{key:"_get",value:function(t){var e=this,i=[];return this._bindingDictionary.get(t.serviceIdentifier).filter((function(e){return e.constraint(t)})).forEach((function(t){i.push(e._resolveFromBinding(t))})),t.isMultiInject||1!==i.length?i:i[0]}},{key:"_getChildRequest",value:function(t){for(var e=this,i=t.implementationType,n=this._metadataReader.getConstructorMetadata(i).userGeneratedMetadata,r=Object.keys(n),a=[],o=function(){var t=n[s],i={};t.forEach((function(t){i[t.key]=t.value}));var r={inject:i[mc],multiInject:i[_c]},o=r.inject||r.multiInject,l={serviceIdentifier:o,constructorArgsMetadata:t},u=(e._bindingDictionary.get(o)||[]).filter((function(t){return t.constraint(l)}));if(u.length){var c={injectIdentifier:o,metadata:t,bindings:u};a.push(c)}},s=0;s<r.length;s++)o();return a}},{key:"_resolveFromBinding",value:function(t){var e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}},{key:"_getResolvedFromBinding",value:function(t){var e;switch(t.type){case Lc:case Oc:e=t.cache;break;case zc:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}},{key:"_resolveInstance",value:function(t,e){if(t.activated)return t.cache;var i=this._getChildRequest(t);return this._createInstance(e,i)}},{key:"_createInstance",value:function(t,e){return e.length?function(t,e,i){if(d())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(t.bind.apply(t,n));return i&&y(r,i.prototype),r}(t,b(this._resolveRequests(e))):new t}},{key:"_resolveRequests",value:function(t){var e=this;return t.map((function(t){return t.bindings.length>1?t.bindings.map((function(t){return e._resolveFromBinding(t)})):e._resolveFromBinding(t.bindings[0])}))}},{key:"_saveToScope",value:function(t,e){t.scope===Pc&&(t.cache=e,t.activated=!0)}}])}(),Yc=Symbol("ContributionProvider"),Xc=function(){return o((function t(e,i){r(this,t),this.serviceIdentifier=e,this.container=i,qc.setStore(this.serviceIdentifier,this)}),[{key:"getContributions",value:function(){var t;return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&(t=this.caches).push.apply(t,b(this.container.getAll(this.serviceIdentifier)))),this.caches}},{key:"refresh",value:function(){var t;this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&(t=this.caches).push.apply(t,b(this.container.getAll(this.serviceIdentifier))))}}])}();function Kc(t,e){t(Yc).toDynamicValue((function(t){var i=t.container;return new Xc(e,i)})).inSingletonScope().whenTargetNamed(e)}var qc=function(){return o((function t(){r(this,t)}),null,[{key:"getStore",value:function(t){return this.store.get(t)}},{key:"setStore",value:function(t,e){this.store.set(t,e)}},{key:"refreshAllContributions",value:function(){this.store.forEach((function(t){t.refresh()}))}}])}();qc.store=new Map;var Zc,Jc,Qc,$c,th=function(){return o((function t(e,i){r(this,t),this._args=e,this.name=i,this.taps=[]}),[{key:"tap",value:function(t,e){this._tap("sync",t,e)}},{key:"unTap",value:function(t,e){var i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter((function(t){return!(t.name===i&&(!e||t.fn===e))})))}},{key:"_parseOptions",value:function(t,e,i){var n;if("string"==typeof e)n={name:e.trim()};else if("object"!=k(e)||null===e)throw new Error("Invalid tap options");if("string"!=typeof n.name||""===n.name)throw new Error("Missing name for tap");return n=Object.assign({type:t,fn:i},n)}},{key:"_tap",value:function(t,e,i){this._insert(this._parseOptions(t,e,i))}},{key:"_insert",value:function(t){var e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var i=0;"number"==typeof t.stage&&(i=t.stage);for(var n=this.taps.length;n>0;){n--;var r=this.taps[n];this.taps[n+1]=r;var a=r.stage||0;if(e){if(e.has(r.name)){e.delete(r.name);continue}if(e.size>0)continue}if(!(a>i)){n++;break}}this.taps[n]=t}}])}(),eh=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.taps.map((function(t){return t.fn})).forEach((function(t){return t.apply(void 0,e)}))}}])}(th),ih=Symbol.for("EnvContribution"),nh=Symbol.for("VGlobal"),rh=new Gc,ah=Symbol.for("RenderService"),oh=new(function(){return o((function t(){r(this,t)}),[{key:"renderService",get:function(){return this._renderService||(this._renderService=rh.get(ah)),this._renderService}}])}()),sh=0,lh=function(){return o((function t(){var e=this;r(this,t),this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=function(t){e._rafHandle=null;var i=e.nextAnimationFrameCbs;e.nextAnimationFrameCbs=new Map,i.forEach((function(e){return e(t)}))},this.tryRunAnimationFrameNextFrame=function(){null===e._rafHandle&&0!==e.nextAnimationFrameCbs.size&&(e._rafHandle=oh.global.getRequestAnimationFrame()(e.runAnimationFrame))}}),[{key:"addAnimationFrameCb",value:function(t){return this.nextAnimationFrameCbs.set(++sh,t),this.tryRunAnimationFrameNextFrame(),sh}},{key:"removeAnimationFrameCb",value:function(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}])}(),uh=function(){return o((function t(){r(this,t),this._listenerMap=new Map,this._eventListenerTransformer=function(t){return t}}),[{key:"setEventListenerTransformer",value:function(t){this._eventListenerTransformer=t||function(t){return t}}},{key:"addEventListener",value:function(t,e,i){var n=this;if(e){var r=function(t){var i=n._eventListenerTransformer(t);"function"==typeof e?e(i):e.handleEvent&&e.handleEvent(i)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}}},{key:"removeEventListener",value:function(t,e,i){var n;if(e){var r=null===(n=this._listenerMap.get(t))||void 0===n?void 0:n.get(e);r&&(this._nativeRemoveEventListener(t,r,i),this._listenerMap.get(t).delete(e),0===this._listenerMap.get(t).size&&this._listenerMap.delete(t))}}},{key:"dispatchEvent",value:function(t){return this._nativeDispatchEvent(t)}},{key:"clearAllEventListeners",value:function(){var t=this;this._listenerMap.forEach((function(e,i){e.forEach((function(e,n){t._nativeRemoveEventListener(i,e,void 0)}))})),this._listenerMap.clear()}},{key:"_nativeAddEventListener",value:function(t,e,i){throw new Error("_nativeAddEventListener must be implemented by derived classes")}},{key:"_nativeRemoveEventListener",value:function(t,e,i){throw new Error("_nativeRemoveEventListener must be implemented by derived classes")}},{key:"_nativeDispatchEvent",value:function(t){throw new Error("_nativeDispatchEvent must be implemented by derived classes")}}])}(),ch=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hh=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},dh=function(t,e){return function(i,n){e(i,n,t)}},ph=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},fh=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).contributions=t,i._isImageAnonymous=!0,i._performanceRAFList=[],i.eventListenerTransformer=function(t){return t},i.id=vc.GenAutoIncrementId(),i.hooks={onSetEnv:new eh(["lastEnv","env","global"])},i.measureTextMethod="native",i.optimizeVisible=!1,i}return h(e,t),o(e,[{key:"env",get:function(){return this._env}},{key:"isImageAnonymous",get:function(){return this._isImageAnonymous},set:function(t){this._isImageAnonymous=t}},{key:"devicePixelRatio",get:function(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}},{key:"supportEvent",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}},{key:"supportsTouchEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}},{key:"supportsPointerEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}},{key:"supportsMouseEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}},{key:"applyStyles",get:function(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles},set:function(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}},{key:"_nativeAddEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}},{key:"_nativeRemoveEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}},{key:"_nativeDispatchEvent",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}},{key:"bindContribution",value:function(t){var e=this,i=[];if(this.contributions.getContributions().forEach((function(n){var r=n.configure(e,t);r&&r.then&&i.push(r)})),i.length)return Promise.all(i)}},{key:"getDynamicCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}},{key:"getStaticCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}},{key:"setEnv",value:function(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}},{key:"deactiveCurrentEnv",value:function(){this.envContribution&&this.envContribution.release()}},{key:"activeEnv",value:function(t,e){var i=this,n=this._env;this._env=t;var r=this.bindContribution(e);if(r&&r.then)return r.then((function(){i.envParams=e,i.hooks.onSetEnv.call(n,t,i)}));this.envParams=e,this.hooks.onSetEnv.call(n,t,this)}},{key:"setActiveEnvContribution",value:function(t){this.envContribution=t}},{key:"createCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}},{key:"createOffscreenCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}},{key:"releaseCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}},{key:"getRequestAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}},{key:"getSpecifiedRequestAnimationFrame",value:function(t){this._env||this.setEnv("browser"),this._performanceRAFList[t]||(this._performanceRAFList[t]=new lh);var e=this._performanceRAFList[t];return function(t){return e.addAnimationFrameCb(t)}}},{key:"getSpecifiedCancelAnimationFrame",value:function(t){if(this._env||this.setEnv("browser"),!this._performanceRAFList[t])return function(){return!1};var e=this._performanceRAFList[t];return function(t){return e.removeAnimationFrameCb(t)}}},{key:"getCancelAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}},{key:"getElementById",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}},{key:"getRootElement",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}},{key:"getDocument",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}},{key:"mapToCanvasPoint",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}},{key:"loadImage",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}},{key:"loadSvg",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}},{key:"loadJson",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}},{key:"loadArrayBuffer",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}},{key:"loadBlob",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}},{key:"loadFont",value:function(t,e,i){return ph(this,void 0,void 0,f().m((function n(){return f().w((function(n){for(;;)if(0===n.n)return n.a(2,(this._env||this.setEnv("browser"),this.envContribution.loadFont(t,e,i)))}),n,this)})))}},{key:"isChrome",value:function(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}},{key:"isSafari",value:function(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}},{key:"getNativeAABBBounds",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}},{key:"removeDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}},{key:"createDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}},{key:"updateDom",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}},{key:"getElementTop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}},{key:"getElementLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}},{key:"getElementTopLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}},{key:"isMacOS",value:function(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}},{key:"copyToClipBoard",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(t)}}])}(uh);fh=ch([Dc(),dh(0,wc(Yc)),dh(0,Ec(ih)),hh("design:paramtypes",[Object])],fh),function(t){t[t.estimate=0]="estimate",t[t.actualBounding=1]="actualBounding",t[t.fontBounding=2]="fontBounding"}(Zc||(Zc={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSE=2]="PAUSE"}(Jc||(Jc={})),function(t){t.wait="wait",t.from="from",t.to="to",t.customAnimate="customAnimate"}(Qc||(Qc={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSED=2]="PAUSED",t[t.END=3]="END"}($c||($c={}));var vh,gh,yh,mh,_h,bh,xh,kh,Sh,Ah,Ch,Mh,wh=ti-1e-8,Th=function(){return o((function t(e){r(this,t),this.init(e)}),[{key:"init",value:function(t){this.bounds=t}},{key:"arc",value:function(t,e,i,n,r,a){if(Math.abs(r-n)>wh)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);var o,s,l,u,c=1/0,h=-1/0,d=1/0,p=-1/0;function f(t){l=i*Math.cos(t),u=i*Math.sin(t),l<c&&(c=l),l>h&&(h=l),u<d&&(d=u),u>p&&(p=u)}if(f(n),f(r),r!==n)if((n%=ti)<0&&(n+=ti),(r%=ti)<0&&(r+=ti),r<n&&(a=!a,o=n,n=r,r=o),a)for(r-=ti,o=n-n%$e,s=0;s<4&&o>r;++s,o-=$e)f(o);else for(o=n-n%$e+$e,s=0;s<4&&o<r;++s,o+=$e)f(o);this.bounds.add(t+c,e+d),this.bounds.add(t+h,e+p)}},{key:"arcTo",value:function(t,e,i,n,r){this.bounds.add(t,e)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.bounds.add(t,e),this.bounds.add(i,n),this.bounds.add(r,a)}},{key:"closePath",value:function(){}},{key:"ellipse",value:function(){throw new Error("不支持ellipse")}},{key:"lineTo",value:function(t,e){this.bounds.add(t,e)}},{key:"moveTo",value:function(t,e){this.bounds.add(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(i,n)}},{key:"rect",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(t+i,e+n)}},{key:"clear",value:function(){this.bounds.clear()}},{key:"release",value:function(){}}])}(),Dh=function(){return o((function t(){r(this,t),this._curves=[],this.bounds=new On}),[{key:"curves",get:function(){return this._curves}},{key:"getCurveLengths",value:function(){return this._curves.map((function(t){return t.getLength()}))}},{key:"getPointAt",value:function(t){return{x:0,y:0}}},{key:"getLength",value:function(){return 0}},{key:"getBounds",value:function(){return this.bounds}}])}(),Eh=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,Bh={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},Ph={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function Rh(t){var e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=l*a,c=-s*o,h=s*a,d=l*o,p=Math.cos(n),f=Math.sin(n),v=Math.cos(r),g=Math.sin(r),y=.5*(r-n),m=Math.sin(.5*y),_=8/3*m*m/Math.sin(y),b=e+p-_*f,x=i+f+_*p,k=e+v,S=i+g,A=k+_*g,C=S-_*v;return[u*b+c*x,h*b+d*x,u*A+c*C,h*A+d*C,u*k+c*S,h*k+d*S]}function Lh(t,e,i,n){for(var r=function(t,e,i,n,r,a,o,s,l){var u=Ci(o),c=Math.sin(u),h=Math.cos(u),d=h*(s-t)*.5+c*(l-e)*.5,p=h*(l-e)*.5-c*(s-t)*.5,f=d*d/((i=Math.abs(i))*i)+p*p/((n=Math.abs(n))*n);f>1&&(i*=f=Math.sqrt(f),n*=f);var v=h/i,g=c/i,y=-c/n,m=h/n,_=v*s+g*l,b=y*s+m*l,x=v*t+g*e,k=y*t+m*e,S=1/((x-_)*(x-_)+(k-b)*(k-b))-.25;S<0&&(S=0);var A=Math.sqrt(S);a===r&&(A=-A);var C=.5*(_+x)-A*(k-b),M=.5*(b+k)+A*(x-_),w=Math.atan2(b-M,_-C),T=Math.atan2(k-M,x-C)-w;T<0&&1===a?T+=ti:T>0&&0===a&&(T-=ti);for(var D=Math.ceil(Math.abs(T/($e+.001))),E=[],B=0;B<D;++B){var P=w+B*T/D,R=w+(B+1)*T/D;E[B]=[C,M,P,R,i,n,c,h]}return E}(n[5],n[6],n[0],n[1],n[3],n[4],n[2],e,i),a=0;a<r.length;++a){var o=Rh(r[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}!function(t){t[t.NONE=0]="NONE",t[t.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",t[t.UPDATE_SHAPE=2]="UPDATE_SHAPE",t[t.CLEAR_SHAPE=253]="CLEAR_SHAPE",t[t.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",t[t.INIT=179]="INIT",t[t.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",t[t.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",t[t.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",t[t.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",t[t.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",t[t.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",t[t.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",t[t.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"}(xh||(xh={})),function(t){t[t.GLOBAL=1]="GLOBAL",t[t.LOCAL=16]="LOCAL",t[t.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",t[t.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"}(kh||(kh={})),function(t){t[t.INIT=0]="INIT",t[t.DEFAULT=1]="DEFAULT",t[t.STATE=2]="STATE",t[t.ANIMATE_BIND=10]="ANIMATE_BIND",t[t.ANIMATE_PLAY=11]="ANIMATE_PLAY",t[t.ANIMATE_START=12]="ANIMATE_START",t[t.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",t[t.ANIMATE_END=14]="ANIMATE_END",t[t.TRANSLATE=20]="TRANSLATE",t[t.TRANSLATE_TO=21]="TRANSLATE_TO",t[t.SCALE=22]="SCALE",t[t.SCALE_TO=23]="SCALE_TO",t[t.ROTATE=24]="ROTATE",t[t.ROTATE_TO=25]="ROTATE_TO"}(Sh||(Sh={})),function(t){t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN"}(Ah||(Ah={})),function(t){t[t.CubicBezierCurve=0]="CubicBezierCurve",t[t.QuadraticBezierCurve=1]="QuadraticBezierCurve",t[t.ArcCurve=2]="ArcCurve",t[t.LineCurve=3]="LineCurve",t[t.EllipseCurve=4]="EllipseCurve",t[t.MoveCurve=5]="MoveCurve"}(Ch||(Ch={})),function(t){t[t.beforeFillStroke=0]="beforeFillStroke",t[t.afterFillStroke=1]="afterFillStroke"}(Mh||(Mh={}));var Ih=[function(t,e,i,n,r,a,o){return e.arc(t[1]*r+i,t[2]*a+n,t[3]*(r+a)/2,t[4],t[5],t[6],o)},function(t,e,i,n,r,a,o){return e.arcTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,t[5]*(r+a)/2,o)},function(t,e,i,n,r,a,o){return e.bezierCurveTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,t[5]*r+i,t[6]*a+n,o)},function(t,e,i,n){return e.closePath()},function(t,e,i,n,r,a){return e.ellipse(t[1]*r+i,t[2]*a+n,t[3]*r,t[4]*a,t[5],t[6],t[7],t[8])},function(t,e,i,n,r,a,o){return e.lineTo(t[1]*r+i,t[2]*a+n,o)},function(t,e,i,n,r,a,o){return e.moveTo(t[1]*r+i,t[2]*a+n,o)},function(t,e,i,n,r,a,o){return e.quadraticCurveTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,o)},function(t,e,i,n,r,a,o){return e.rect(t[1]*r+i,t[2]*a+n,t[3]*r,t[4]*a,o)}];function Fh(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=0;s<t.length;s++){var l=t[s];Ih[l[0]](l,e,i,n,r,a,o)}}var Oh=function(){return o((function t(){r(this,t)}),[{key:"getLength",value:function(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}])}();function zh(t,e){for(var i=0,n=t.length,r=0;r<n;r++){var a=t[r],o=e[r],s=t[(r+1)%n],l=e[(r+1)%n];i+=Si.distanceNN(a,o,s,l)}return i/2}function Hh(t,e,i,n,r){var a=1-r;return a*a*a*t+3*e*r*a*a+3*i*r*r*a+n*r*r*r}function Nh(t,e,i,n,r){var a=Hh(t.x,e.x,i.x,n.x,r),o=Hh(t.y,e.y,i.y,n.y,r);return new ki(a,o)}function Uh(t,e,i,n){var r=1-n;return r*r*t+2*r*n*e+n*n*i}function jh(t,e,i,n){var r=Uh(t.x,e.x,i.x,n),a=Uh(t.y,e.y,i.y,n);return new ki(r,a)}function Vh(t,e){var i=t.p0,n=t.p1,r=t.p2,a=t.p3,o=Nh(i,n,r,a,e),s=Si.pointAtPP(i,n,e),l=Si.pointAtPP(n,r,e),u=Si.pointAtPP(r,a,e),c=Si.pointAtPP(s,l,e),h=Si.pointAtPP(l,u,e);return[new Wh(i,s,c,o),new Wh(o,h,u,a)]}var Wh=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e)).type=Ch.CubicBezierCurve,s.p0=t,s.p1=i,s.p2=a,s.p3=o,s}return h(e,t),o(e,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return Nh(this.p0,this.p1,this.p2,this.p3,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,n=this.p3,zh([t.x,e.x,i.x,n.x],[t.y,e.y,i.y,n.y])):60;var t,e,i,n}},{key:"calcProjLength",value:function(t){return t===Ah.ROW?ii(this.p0.x-this.p3.x):t===Ah.COLUMN?ii(this.p0.y-this.p3.y):0}},{key:"getAngleAt",value:function(t){var e=ai(t-.01,0),i=oi(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return ni(r.y-n.y,r.x-n.x)}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.bezierCurveTo(this.p1.x*n+e,this.p1.y*r+i,this.p2.x*n+e,this.p2.y*r+i,this.p3.x*n+e,this.p3.y*r+i);else if(a>0){var o=m(Vh(this,a),1)[0];t.bezierCurveTo(o.p1.x*n+e,o.p1.y*r+i,o.p2.x*n+e,o.p2.y*r+i,o.p3.x*n+e,o.p3.y*r+i)}}},{key:"includeX",value:function(t){var e=oi(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=ai(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}},{key:"getYAt",value:function(t){var e=oi(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/(ai(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}])}(Oh);function Gh(t,e){var i=t.p0,n=t.p1,r=Si.pointAtPP(i,n,e);return[new Yh(i,r),new Yh(r,n)]}var Yh=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e)).type=Ch.LineCurve,a.p0=t,a.p1=i,a}return h(e,t),o(e,[{key:"getPointAt",value:function(t){if(!1!==this.defined)return Si.pointAtPP(this.p0,this.p1,t);throw new Error("defined为false的点不能getPointAt")}},{key:"getAngleAt",value:function(t){return null==this.angle&&(this.angle=ni(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}},{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}},{key:"calcLength",value:function(){return this._validPoint()?Si.distancePP(this.p0,this.p1):60}},{key:"calcProjLength",value:function(t){return t===Ah.ROW?ii(this.p0.x-this.p1.x):t===Ah.COLUMN?ii(this.p0.y-this.p1.y):0}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.lineTo(this.p1.x*n+e,this.p1.y*r+i);else if(a>0){var o=this.getPointAt(a);t.lineTo(o.x*n+e,o.y*r+i)}}},{key:"includeX",value:function(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}},{key:"getYAt",value:function(t){if(this.includeX(t)){var e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);var n=(t-e.x)/(i.x-e.x);return e.y+n*(i.y-e.y)}return 1/0}}])}(Oh),Xh=function(){return o((function t(e,i){r(this,t),this.init(e,i)}),[{key:"endX",get:function(){return this._lastX}},{key:"endY",get:function(){return this._lastY}},{key:"init",value:function(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a,o,s){var l=new Wh(new ki(this._lastX,this._lastY),new ki(t,e),new ki(i,n),new ki(r,a));l.originP1=this._lastOriginP,l.originP2=s,l.defined=o,this.curves.push(l),this._lastX=r,this._lastY=a,this._lastOriginP=s}},{key:"closePath",value:function(){if(!(this.curves.length<2)){var t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}}},{key:"ellipse",value:function(){throw new Error("SegContext不支持调用ellipse")}},{key:"lineTo",value:function(t,e,i,n){var r=this.addLinearCurve(t,e,i,this._lastOriginP,n);this.curves.push(r),this._lastX=t,this._lastY=e,this._lastOriginP=n}},{key:"moveTo",value:function(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}},{key:"quadraticCurveTo",value:function(t,e,i,n){throw new Error("SegContext不支持调用quadraticCurveTo")}},{key:"clear",value:function(){this.curves=[],this.length=NaN}},{key:"tryUpdateLength",value:function(t){return this.getLength(t)}},{key:"addLinearCurve",value:function(t,e,i,n,r){var a=new Yh(new ki(this._lastX,this._lastY),new ki(t,e));return a.originP1=n,a.originP2=r,a.defined=i,a}},{key:"getPointAt",value:function(t){throw new Error("暂未实现")}},{key:"getCurveLengths",value:function(){return[]}},{key:"getLength",value:function(t){var e,i;if(t===Ah.COLUMN){if(!this.curves.length)return 0;var n=this.curves[0],r=this.curves[this.curves.length-1],a=null!==(e=r.p3)&&void 0!==e?e:r.p1;return ii(n.p0.y-a.y)}if(t===Ah.ROW){if(!this.curves.length)return 0;var o=this.curves[0],s=this.curves[this.curves.length-1],l=null!==(i=s.p3)&&void 0!==i?i:s.p1;return ii(o.p0.x-l.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((function(t,e){return t+e.getLength()}),0)),this.length}}])}(),Kh=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"bezierCurveTo",value:function(t,i,n,r,a,o,s,l){return _(e,"bezierCurveTo",this,3)([i,t,r,n,o,a,s,l])}},{key:"lineTo",value:function(t,i,n,r){return _(e,"lineTo",this,3)([i,t,n,r])}},{key:"moveTo",value:function(t,i,n){return _(e,"moveTo",this,3)([i,t,n])}},{key:"clear",value:function(){return _(e,"clear",this,3)([])}}])}(Xh);function qh(t,e){for(var i=!1,n=0,r=e.length;n<=r;n++)n>=r===i&&((i=!i)?t.lineStart():t.lineEnd()),i&&t.point(e[n])}function Zh(t,e,i){var n=null!=e?e:ii(i[i.length-1].x-i[0].x)>ii(i[i.length-1].y-i[0].y)?Ah.ROW:Ah.COLUMN;return"monotoneY"===t?new Kh(t,n):new Xh(t,n)}var Jh=function(){return o((function t(e,i){r(this,t),this.context=e,i&&(this.startPoint=i)}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function Qh(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=Zh("linear",i,t);return function(t,e){qh(t,e)}(new Jh(r,n),t),r}function $h(t,e,i,n,r){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,n,t.lastPoint1)}var td=function(){return o((function t(e,i){r(this,t),this.context=e,this.startPoint=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){2===this._point&&$h(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:$h(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function ed(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return Qh(t,e);var r=Zh("basis",i,t);return function(t,e){qh(t,e)}(new td(r,n),t),r}function id(t){return t<0?-1:1}function nd(t,e,i){var n=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(n||Number(r<0&&-0)),o=(i-t._y1)/(r||Number(n<0&&-0)),s=(a*r+o*n)/(n+r);return(id(a)+id(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function rd(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function ad(t,e,i,n,r){var a=t._x0,o=t._y0,s=t._x1,l=t._y1,u=(s-a)/3;t.context.bezierCurveTo(a+u,o+u*e,s-u,l-u*i,s,l,n,t.lastPoint1)}var od=function(){return o((function t(e,i){r(this,t),this.context=e,this.startPoint=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:ad(this,this._t0,rd(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=NaN,i=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,n,t);break;case 1:this._point=2;break;case 2:this._point=3,ad(this,rd(this,e=nd(this,i,n)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2);break;default:ad(this,this._t0,e=nd(this,i,n),!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=n,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),sd=function(t){function e(t,i){return r(this,e),n(this,e,[t,i])}return h(e,t),o(e,[{key:"point",value:function(t){return _(e,"point",this,3)([{y:t.x,x:t.y,defined:t.defined}])}}])}(od);function ld(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return Qh(t,e);var r=Zh("monotoneX",i,t);return function(t,e){qh(t,e)}(new od(r,n),t),r}function ud(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return Qh(t,e);var r=Zh("monotoneY",i,t);return function(t,e){qh(t,e)}(new sd(r,n),t),r}var cd=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this._t=i,this.startPoint=n}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{var n=this._x*(1-this._t)+e*this._t;.5===this._t?this.context.lineTo(n,this._y,!1!==this._lastDefined,this.lastPoint):this.context.lineTo(n,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(n,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),hd=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"lineEnd",value:function(){this.context.closePath()}}])}(cd);function dd(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var a=new Xh("step",null!=n?n:ii(t[t.length-1].x-t[0].x)>ii(t[t.length-1].y-t[0].y)?Ah.ROW:Ah.COLUMN);return pd(new cd(a,e,r),t),a}function pd(t,e){return qh(t,e)}var fd=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"lineEnd",value:function(){this.context.closePath()}}])}(Jh);function vd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=Zh("linear",i,t);return function(t,e){qh(t,e)}(new fd(r,n),t),r}function gd(t,e,i,n,r){var a=t._x1,o=t._y1,s=t._x2,l=t._y2;if(t._l01_a>Je){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);a=(a*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,o=(o*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>Je){var h=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,d=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*h+t._x1*t._l23_2a-e*t._l12_2a)/d,l=(l*h+t._y1*t._l23_2a-i*t._l12_2a)/d}t.context.bezierCurveTo(a,o,s,l,t._x2,t._y2,n,t.lastPoint1)}var yd=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this.startPoint=n,this._alpha=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;if(this._point){var n=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:gd(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function md(t,e){return function(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.direction,o=r.startPoint;if(i.length<2-Number(!!o))return null;if(i.length<3-Number(!!o))return Qh(i,r);var s=Zh(t,a,i);return qh(new e(s,n,o),i),s}}var _d=md("catmullRom",yd),bd=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this.startPoint=n,this._alpha=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}},{key:"lineEnd",value:function(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}},{key:"point",value:function(t){var e=t.x,i=t.y;if(this._point){var n=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:gd(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),xd=md("catmullRomClosed",bd);function kd(t,e){var i=t.p0,n=t.p1,r=t.p2,a=jh(i,n,r,e),o=Si.pointAtPP(i,n,e),s=Si.pointAtPP(n,r,e);return[new Sd(i,o,a),new Sd(a,s,r)]}var Sd=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e)).type=Ch.QuadraticBezierCurve,o.p0=t,o.p1=i,o.p2=a,o}return h(e,t),o(e,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return jh(this.p0,this.p1,this.p2,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,zh([t.x,e.x,i.x],[t.y,e.y,i.y])):60;var t,e,i}},{key:"calcProjLength",value:function(t){return t===Ah.ROW?ii(this.p0.x-this.p2.x):t===Ah.COLUMN?ii(this.p0.y-this.p2.y):0}},{key:"getAngleAt",value:function(t){var e=ai(t-.01,0),i=oi(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return ni(r.y-n.y,r.x-n.x)}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.quadraticCurveTo(this.p1.x*n+e,this.p1.y*r+i,this.p2.x*n+e,this.p2.y*r+i);else if(a>0){var o=m(kd(this,a),1)[0];t.quadraticCurveTo(o.p1.x*n+e,o.p1.y*r+i,o.p2.x*n+e,o.p2.y*r+i)}}},{key:"getYAt",value:function(t){throw new Error("QuadraticBezierCurve暂不支持getYAt")}},{key:"includeX",value:function(t){throw new Error("QuadraticBezierCurve暂不支持includeX")}}])}(Oh),Ad=function(){return o((function t(e){r(this,t),this.path=e,this._lastX=this._lastY=this._startX=this._startY=0}),[{key:"moveTo",value:function(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}},{key:"lineTo",value:function(t,e){var i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}},{key:"addLinearCurve",value:function(t,e){return new Yh(new ki(this._lastX,this._lastY),new ki(t,e))}},{key:"quadraticCurveTo",value:function(t,e,i,n){var r=new Sd(new ki(this._lastX,this._lastY),new ki(t,e),new ki(i,n));this.path.addCurve(r),this._lastX=i,this._lastY=n}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){var o=new Wh(new ki(this._lastX,this._lastY),new ki(t,e),new ki(i,n),new ki(r,a));this.path.addCurve(o),this._lastX=r,this._lastY=a}},{key:"arcTo",value:function(t,e,i,n,r){throw new Error("CurveContext不支持调用arcTo")}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){throw new Error("CurveContext不支持调用ellipse")}},{key:"rect",value:function(t,e,i,n){throw new Error("CurveContext不支持调用rect")}},{key:"arc",value:function(t,e,i,n,r,a){throw new Error("CurveContext不支持调用arc")}},{key:"closePath",value:function(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}])}();function Cd(t,e,i){var n,r;switch(e){case"linear":default:return Qh(t,i);case"basis":return ed(t,i);case"monotoneX":return ld(t,i);case"monotoneY":return ud(t,i);case"step":return dd(t,.5,i);case"stepClosed":return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var a=new Xh("step",null!=n?n:ii(t[t.length-1].x-t[0].x)>ii(t[t.length-1].y-t[0].y)?Ah.ROW:Ah.COLUMN);return pd(new hd(a,e,r),t),a}(t,.5,i);case"stepBefore":return dd(t,0,i);case"stepAfter":return dd(t,1,i);case"catmullRom":return _d(t,null!==(n=null==i?void 0:i.curveTension)&&void 0!==n?n:.5,i);case"catmullRomClosed":return xd(t,null!==(r=null==i?void 0:i.curveTension)&&void 0!==r?r:.5,i);case"linearClosed":return vd(t,i)}}var Md=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).commandList=[],t&&(i._ctx=t),i._boundsContext=new Th(i.bounds),i}return h(e,t),o(e,[{key:"curves",get:function(){return this.tryBuildCurves()}},{key:"setCtx",value:function(t){this._ctx=t}},{key:"moveTo",value:function(t,e){return this.commandList.push([Ph.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this.commandList.push([Ph.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}},{key:"quadraticCurveTo",value:function(t,e,i,n){return this.commandList.push([Ph.Q,t,e,i,n]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,n),this}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){return this.commandList.push([Ph.C,t,e,i,n,r,a]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,n,r,a),this}},{key:"arcTo",value:function(t,e,i,n,r){return this.commandList.push([Ph.AT,t,e,i,n,r]),this._ctx&&this._ctx.arcTo(t,e,i,n,r),this}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){return this.commandList.push([Ph.E,t,e,i,n,r,a,o,s]),this._ctx&&this._ctx.ellipse(t,e,i,n,r,a,o,s),this}},{key:"rect",value:function(t,e,i,n){return this.commandList.push([Ph.R,t,e,i,n]),this._ctx&&this._ctx.rect(t,e,i,n),this}},{key:"arc",value:function(t,e,i,n,r,a){return this.commandList.push([Ph.A,t,e,i,n,r,a]),this._ctx&&this._ctx.arc(t,e,i,n,r,a),this}},{key:"closePath",value:function(){return this.commandList.push([Ph.Z]),this._ctx&&this._ctx.closePath(),this}},{key:"addCurve",value:function(t){this._curves.push(t)}},{key:"clear",value:function(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}},{key:"beginPath",value:function(){this.clear()}},{key:"tryBuildCurves",value:function(){if(!this._curves||!this._curves.length){var t=new Ad(this);Fh(this.commandList,t,0,0,1,1)}return this._curves}},{key:"toString",value:function(){if(!this.toStringCbList){var t=[];t[Ph.M]=function(t){return"M".concat(t[1]," ").concat(t[2])},t[Ph.L]=function(t){return"L".concat(t[1]," ").concat(t[2])},t[Ph.Q]=function(t){return"Q".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4])},t[Ph.C]=function(t){return"C".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4]," ").concat(t[5]," ").concat(t[6])},t[Ph.A]=function(t){var e=[],i=t[1],n=t[2],r=t[3];!function(t,e,i,n,r,a,o){var s,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=2*Math.PI,c=(e%u+u)%u,h=(i%u+u)%u;l?(h>=c&&(h-=u),s=h-c):(h<=c&&(h+=u),s=h-c);for(var d=Math.ceil(Math.abs(s)/(.5*Math.PI)),p=s/d,f=0;f<d;f++){var v=c+p*f,g=c+p*(f+1),y=4/3*Math.tan(Math.abs(p)/4),m=Math.cos(v),_=Math.sin(v),b=Math.cos(g),x=Math.sin(g),k=m*a+n,S=_*o+r,A=b*a+n,C=x*o+r,M=l?-1:1,w=a*y*M,T=o*y*M;t.push(k-w*_,S+T*m,A+w*x,C-T*b,A,C)}}(e,t[4],t[5],i,n,r,r,t[6]);for(var a="",o=0;o<e.length;o+=6)a+="C".concat(e[o]," ").concat(e[o+1]," ").concat(e[o+2]," ").concat(e[o+3]," ").concat(e[o+4]," ").concat(e[o+5]);return a},t[Ph.R]=function(t){return"M".concat(t[1]," ").concat(t[2]," h").concat(t[3]," v").concat(t[4]," H").concat(t[1],"Z")},t[Ph.Z]=function(t){return"Z"},this.toStringCbList=t}var e=this.toStringCbList,i="";return this.commandList.forEach((function(t){i+=e[t[0]](t)})),i}},{key:"fromString",value:function(t,e,i,n,r){this.clear();var a=function(t){if(!t)return[];var e,i,n=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===n)return[];for(var r=[],a=0,o=n.length;a<o;a++)if(vh=n[a],gh=vh.slice(1),e=[yh=vh[0]],null!==(i=gh.match(Eh))){for(var s=0,l=i.length;s<l;s++)mh=i[s],_h=parseFloat(mh),Number.isNaN(_h)||e.push(_h);if(bh=Bh[yh],e.length-1>bh)for(var u=void 0,c=yh,h=1,d=e.length;h<d;h+=bh){u=[c];for(var p=h,f=h+bh;p<f;p++)u.push(e[p]);r.push(u),"m"===c?c="l":"M"===c&&(c="L")}else r.push(e)}else r.push(e);return r}(t);return this._runCommandStrList(a,e,i,n,r),this._updateBounds(),this}},{key:"fromLine",value:function(t){var e=t.attribute,i=e.points,n=e.curveType,r=e.clipRangeByDimension;if(i){var a=Cd(i,n);"x"===r?this.direction=Ah.ROW:"y"===r?this.direction=Ah.COLUMN:"auto"===r&&(this.direction=a.direction),this._curves=a.curves}}},{key:"fromCustomPath2D",value:function(t,e,i,n,r){return this.clear(),this._runCommandList(t.commandList,e,i,n,r),this._updateBounds(),this}},{key:"transform",value:function(t,e,i,n){var r=this,a=this.commandList;if(!this.transformCbList){var o=[];o[Ph.M]=this.moveToTransform,o[Ph.L]=this.lineToTransform,o[Ph.Q]=this.quadraticCurveToTransform,o[Ph.C]=this.bezierCurveToTransform,o[Ph.AT]=this.arcToTransform,o[Ph.E]=this.ellipseTransform,o[Ph.R]=this.rectTransform,o[Ph.A]=this.arcTransform,o[Ph.Z]=this.closePathTransform,this.transformCbList=o}a.forEach((function(a){r.transformCbList[a[0]](a,t,e,i,n)})),this._updateBounds()}},{key:"moveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"lineToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"quadraticCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i}},{key:"bezierCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*n+e,t[6]=t[6]*r+i}},{key:"arcToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*(n+r)/2}},{key:"ellipseTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"rectTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"arcTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*(n+r)/2}},{key:"closePathTransform",value:function(){}},{key:"_runCommandStrList",value:function(t){for(var e,i,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=null,h=0,d=0,p=0,f=0,v=0,g=t.length;v<g;++v){switch(e=t[v],1===l&&1===u||(e=Td(e,l,u)),e[0]){case"l":h+=e[1],d+=e[2],this.lineTo(h+o,d+s);break;case"L":h=e[1],d=e[2],this.lineTo(h+o,d+s);break;case"h":h+=e[1],this.lineTo(h+o,d+s);break;case"H":h=e[1],this.lineTo(h+o,d+s);break;case"v":d+=e[1],this.lineTo(h+o,d+s);break;case"V":d=e[1],this.lineTo(h+o,d+s);break;case"m":h+=e[1],d+=e[2],this.moveTo(h+o,d+s);break;case"M":h=e[1],d=e[2],this.moveTo(h+o,d+s);break;case"c":i=h+e[5],n=d+e[6],p=h+e[3],f=d+e[4],this.bezierCurveTo(h+e[1]+o,d+e[2]+s,p+o,f+s,i+o,n+s),h=i,d=n;break;case"C":h=e[5],d=e[6],p=e[3],f=e[4],this.bezierCurveTo(e[1]+o,e[2]+s,p+o,f+s,h+o,d+s);break;case"s":i=h+e[3],n=d+e[4],null===c[0].match(/[CcSs]/)?(p=h,f=d):(p=2*h-p,f=2*d-f),r=h+e[1],a=d+e[2],this.bezierCurveTo(p+o,f+s,r+o,a+s,i+o,n+s),p=r,f=a,h=i,d=n;break;case"S":i=e[3],n=e[4],null===c[0].match(/[CcSs]/)?(p=h,f=d):(p=2*h-p,f=2*d-f),r=e[1],a=e[2],this.bezierCurveTo(p+o,f+s,r+o,a+s,i+o,n+s),p=r,f=a,h=i,d=n;break;case"q":i=h+e[3],n=d+e[4],p=h+e[1],f=d+e[2],this.quadraticCurveTo(p+o,f+s,i+o,n+s),h=i,d=n;break;case"Q":i=e[3],n=e[4],this.quadraticCurveTo(e[1]+o,e[2]+s,i+o,n+s),h=i,d=n,p=e[1],f=e[2];break;case"t":i=h+e[1],n=d+e[2],null===c[0].match(/[QqTt]/)?(p=h,f=d):"t"===c[0]?(p=2*h-r,f=2*d-a):"q"===c[0]&&(p=2*h-p,f=2*d-f),r=p,a=f,this.quadraticCurveTo(p+o,f+s,i+o,n+s),d=n,p=(h=i)+e[1],f=d+e[2];break;case"T":i=e[1],n=e[2],p=2*h-p,f=2*d-f,this.quadraticCurveTo(p+o,f+s,i+o,n+s),h=i,d=n;break;case"a":Lh(this,h+o,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+h+o,e[7]+d+s]),h+=e[6],d+=e[7];break;case"A":Lh(this,h+o,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+o,e[7]+s]),h=e[6],d=e[7];break;case"z":case"Z":this.closePath()}c=e}}},{key:"_runCommandList",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(0!==e||0!==i||1!==n||1!==r)for(var a=0,o=t.length;a<o;++a){var s=t[a].slice();switch(s[0]){case Ph.L:this.lineToTransform(s,e,i,n,r);break;case Ph.M:this.moveToTransform(s,e,i,n,r);break;case Ph.C:this.bezierCurveToTransform(s,e,i,n,r);break;case Ph.Q:this.quadraticCurveToTransform(s,e,i,n,r);break;case Ph.A:this.arcToTransform(s,e,i,n,r);break;case Ph.E:this.ellipseTransform(s,e,i,n,r);break;case Ph.R:this.rectTransform(s,e,i,n,r);break;case Ph.AT:this.arcToTransform(s,e,i,n,r);break;case Ph.Z:this.closePath()}}else this.commandList=t.map((function(t){return t.slice()}))}},{key:"_updateBounds",value:function(){this.bounds.clear(),Fh(this.commandList,this._boundsContext)}},{key:"release",value:function(){this.commandList=[],this._boundsContext=null,this._ctx=null}},{key:"getLength",value:function(){if(this.direction===Ah.COLUMN){if(!this._curves.length)return 0;var t=this._curves[0],e=this._curves[this._curves.length-1];return ii(t.p0.y-e.p1.y)}if(this.direction===Ah.ROW){if(!this._curves.length)return 0;var i=this._curves[0],n=this._curves[this._curves.length-1];return ii(i.p0.x-n.p1.x)}return this._curves.reduce((function(t,e){return t+e.getLength()}),0)}},{key:"getYAt",value:function(t){if(!this.curves)return 1/0;for(var e=0;e<this.curves.length;e++){var i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}},{key:"getAttrAt",value:function(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};for(var e,i=0,n=0;n<this._curves.length;n++){var r=(e=this._curves[n]).getLength(this.direction);if(i+r>=t)break;i+=r}var a=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(a),angle:e.getAngleAt(a)}}},{key:"drawWithClipRange",value:function(t,e,i,n,r){this.tryBuildCurves();for(var a=this.getLength()*r,o=0,s=0;s<this._curves.length;s++){var l=this._curves[s],u=l.getLength(this.direction);if(!(o+u<=a)){var c=1-(o+u-a)/u;l.draw(t,i,n,e,e,c);break}l.draw(t,i,n,e,e,1),o+=u}}}])}(Dh),wd=["l",0,0,0,0,0,0,0];function Td(t,e,i){var n=wd[0]=t[0];if("a"===n||"A"===n)wd[1]=e*t[1],wd[2]=i*t[2],wd[3]=t[3],wd[4]=t[4],wd[5]=t[5],wd[6]=e*t[6],wd[7]=i*t[7];else if("h"===n||"H"===n)wd[1]=e*t[1];else if("v"===n||"V"===n)wd[1]=i*t[1];else for(var r=1,a=t.length;r<a;++r)wd[r]=(r%2==1?e:i)*t[r];return wd}var Dd={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new Hn},Ed={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},Bd={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},Pd=Object.assign({outerBorder:Object.assign(Object.assign({},Bd),{distance:0}),innerBorder:Object.assign(Object.assign({},Bd),{distance:0})},Bd),Rd={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,'-apple-system',segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:Zc.fontBounding,keepCenterInLine:!1},Ld=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},Ed),Pd),{alignSelf:"auto"}),{pickStrokeBuffer:0}),Id={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},Fd=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},{_debug_bounds:!1}),Ld),Dd),Od=Object.assign(Object.assign({},Fd),{startAngle:0,endAngle:ei,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),zd=Object.assign(Object.assign(Object.assign({},Fd),Id),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),Hd=Object.assign(Object.assign({},Fd),{radius:1,startAngle:0,endAngle:ei}),Nd=Object.assign(Object.assign({},Fd),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),Ud=Object.assign(Object.assign({},Fd),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),jd=Object.assign(Object.assign(Object.assign({},Fd),Id),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),Vd=Object.assign(Object.assign({},Fd),{path:new Md,fillStrokeOrder:1,clipRange:1,customPath:function(){Wt.getInstance().warn("空函数")}}),Wd=Object.assign(Object.assign({},Fd),{points:[],cornerRadius:0,closePath:!0}),Gd=Object.assign(Object.assign({},Fd),{width:100,height:100,spikes:5,thickness:.5}),Yd=Object.assign(Object.assign({},Fd),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round",drawStrokeWhenZeroWH:!1});Object.assign(Object.assign({},Fd),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round",drawStrokeWhenZeroWH:!1});var Xd=Object.assign(Object.assign({},Fd),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),Kd=Object.assign(Object.assign(Object.assign({},Fd),Rd),{strokeBoundsBuffer:0,keepDirIn3d:!0}),qd=Object.assign(Object.assign(Object.assign({},Fd),Rd),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),Zd=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},Fd),{fill:!0,cornerRadius:0,cornerType:"round"}),Jd=Object.assign(Object.assign({},Zd),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),Qd=function(){var t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function i(t){var i=new Error(e+": "+t);throw i.source=e,i}function n(){return r("linear",t.linearGradient,a)||r("radial",t.radialGradient,s)||r("conic",t.conicGradient,o)}function r(e,n,r){return function(n,a){var o,s=y(n);if(s){y(t.startCall)||i("Missing (");var l=((o=r())&&(y(t.comma)||i("Missing comma before color stops")),{type:e,orientation:o,colorStops:d(p)});return y(t.endCall)||i("Missing )"),l}}(n)}function a(){return g("directional",t.sideOrCorner,1)||g("angular",t.angleValue,1)}function o(){return g("angular",t.fromAngleValue,1)}function s(){var i,n,r=l();return r&&((i=[]).push(r),n=e,y(t.comma)&&((r=l())?i.push(r):e=n)),i}function l(){var t,e=function(){var t=g("shape",/^(circle)/i,0);return t&&(t.style=v()||u()),t}()||((t=g("shape",/^(ellipse)/i,0))&&(t.style=f()||u()),t);if(e)e.at=c();else{var i=u();if(i){e=i;var n=c();n&&(e.at=n)}else{var r=h();r&&(e={type:"default-radial",at:r})}}return e}function u(){return g("extent-keyword",t.extentKeywords,1)}function c(){if(g("position",/^at/,0)){var t=h();return t||i("Missing positioning value"),t}}function h(){var t={x:f(),y:f()};if(t.x||t.y)return{type:"position",value:t}}function d(e){var n=e(),r=[];if(n)for(r.push(n);y(t.comma);)(n=e())?r.push(n):i("One extra comma");return r}function p(){var e=g("hex",t.hexColor,1)||g("rgba",t.rgbaColor,1)||g("rgb",t.rgbColor,1)||g("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=f(),e}function f(){return g("%",t.percentageValue,1)||g("position-keyword",t.positionKeywords,1)||v()}function v(){return g("px",t.pixelValue,1)||g("em",t.emValue,1)}function g(t,e,i){var n=y(e);if(n)return{type:t,value:n[i]}}function y(t){var i=/^[\n\r\t\s]+/.exec(e);i&&m(i[0].length);var n=t.exec(e);return n&&m(n[0].length),n}function m(t){e=e.substr(t)}return function(t){return e=t.toString(),r=d(n),e.length>0&&i("Invalid input not EOF"),r;var r}}(),$d=function(){function t(){r(this,t)}return o(t,null,[{key:"IsGradient",value:function(t){return!("string"==typeof t&&!t.includes("gradient"))}},{key:"IsGradientStr",value:function(t){return"string"==typeof t&&t.includes("gradient")}},{key:"Parse",value:function(e){if(t.IsGradientStr(e))try{var i=Qd(e)[0];if(i){if("linear"===i.type)return t.ParseLinear(i);if("radial"===i.type)return t.ParseRadial(i);if("conic"===i.type)return t.ParseConic(i)}}catch(t){return e}return e}},{key:"processColorStops",value:function(t){if(!t||0===t.length)return[];if(t.some((function(t){return t.length}))){var e=t.map((function(t){return{color:t.value,offset:t.length?parseFloat(t.length.value)/100:-1}}));e[0].offset<0&&(e[0].offset=0),e[e.length-1].offset<0&&(e[e.length-1].offset=1);for(var i=1;i<e.length-1;i++)if(e[i].offset<0){for(var n=i-1,r=i+1;r<e.length&&e[r].offset<0;)r++;for(var a=e[n].offset,o=e[r].offset,s=r-n,l=1;l<s;l++)e[n+l].offset=a+(o-a)*l/s;i=r-1}return e}return t.map((function(e,i){var n=t.length>1?i/(t.length-1):0;return{color:e.value,offset:n}}))}},{key:"ParseConic",value:function(e){var i=e.orientation,n=e.colorStops,r=void 0===n?[]:n,a=Qe/2,o=parseFloat(i.value)/180*Qe-a;return{gradient:"conical",x:.5,y:.5,startAngle:o,endAngle:o+ei,stops:t.processColorStops(r)}}},{key:"ParseRadial",value:function(e){var i=e.colorStops,n=void 0===i?[]:i;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:t.processColorStops(n)}}},{key:"ParseLinear",value:function(e){for(var i=e.orientation,n=e.colorStops,r=void 0===n?[]:n,a=Qe/2,o="angular"===i.type?parseFloat(i.value)/180*Qe:0;o<0;)o+=ei;for(;o>=ei;)o-=ei;var s=0,l=0,u=0,c=0;return o<a?(s=0,l=1,u=Math.sin(o),c=l-Math.cos(o)):o<Qe?(s=0,l=0,u=Math.cos(o-a),c=Math.sin(o-a)):o<Qe+a?(l=0,u=(s=1)-Math.sin(o-Qe),c=Math.cos(o-Qe)):(u=(s=1)-Math.cos(o-a-Qe),c-=Math.sin(o-a-Qe)),{gradient:"linear",x0:s,y0:l,x1:u,y1:c,stops:t.processColorStops(r)}}}])}();function tp(t,e,i){var n=e,r=t.currentMatrix,a=r.a,o=r.b,s=r.c,l=r.d,u=Math.sign(a)*Math.sqrt(a*a+o*o),c=Math.sign(l)*Math.sqrt(s*s+l*l);return u+c===0?0:n=n/Math.abs(u+c)*2*i}function ep(t,e,i){var n,r,a,o,s,l,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!e||!0===e)return"black";if(Z(e))for(var h=0;h<e.length&&!(l=e[h]);h++);else l=e;if("string"==typeof(l=$d.Parse(l)))return l;if(i.AABBBounds&&(!i.attribute||0!==i.attribute.scaleX||0!==i.attribute.scaleY)){var d=i.AABBBounds,p=d.x2-d.x1,f=d.y2-d.y1,v=d.x1-u,g=d.y1-c;if(i.attribute){var y=i.attribute,m=y.scaleX,_=void 0===m?1:m,b=y.scaleY,x=void 0===b?1:b,k=y.angle;p/=_,f/=x,v/=_,g/=x,((void 0===k?0:k)||1!==_||1!==x)&&(v=null!==(n=i.x1WithoutTransform)&&void 0!==n?n:0,g=null!==(r=i.y1WithoutTransform)&&void 0!==r?r:0,p=null!==(a=i.widthWithoutTransform)&&void 0!==a?a:p,f=null!==(o=i.heightWithoutTransform)&&void 0!==o?o:f)}"linear"===l.gradient?s=function(t,e,i,n,r,a){var o,s,l,u,c=t.createLinearGradient(i+(null!==(o=e.x0)&&void 0!==o?o:0)*r,n+(null!==(s=e.y0)&&void 0!==s?s:0)*a,i+(null!==(l=e.x1)&&void 0!==l?l:1)*r,n+(null!==(u=e.y1)&&void 0!==u?u:0)*a);return e.stops.forEach((function(t){c.addColorStop(t.offset,t.color)})),c}(t,l,v,g,p,f):"conical"===l.gradient?s=function(t,e,i,n,r,a){var o,s,l=t.createConicGradient(i+(null!==(o=e.x)&&void 0!==o?o:0)*r,n+(null!==(s=e.y)&&void 0!==s?s:0)*a,e.startAngle,e.endAngle);return e.stops.forEach((function(t){l.addColorStop(t.offset,t.color)})),l.GetPattern?l.GetPattern(r+i,a+n,void 0):l}(t,l,v,g,p,f):"radial"===l.gradient&&(s=function(t,e,i,n,r,a){var o,s,l,u,c,h,d=t.createRadialGradient(i+(null!==(o=e.x0)&&void 0!==o?o:.5)*r,n+(null!==(s=e.y0)&&void 0!==s?s:.5)*a,Math.max(r,a)*(null!==(l=e.r0)&&void 0!==l?l:0),i+(null!==(u=e.x1)&&void 0!==u?u:.5)*r,n+(null!==(c=e.y1)&&void 0!==c?c:.5)*a,Math.max(r,a)*(null!==(h=e.r1)&&void 0!==h?h:.5));return e.stops.forEach((function(t){d.addColorStop(t.offset,t.color)})),d}(t,l,v,g,p,f))}return s||"orange"}var ip={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},np=!0,rp=!1,ap=/\w|\(|\)|-/,op=/[.?!,;:/，。？！、；：]/,sp=/\S/,lp=function(t,e){var i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function up(t,e,i,n,r){if(t.length<=1)return 0;if(!e||e<=0)return 0;for(var a=oh.graphicUtil.textMeasure,o=n,s=t.slice(0,o),l=Math.floor(a.measureText(s,i).width),u=t.slice(0,o+1),c=Math.floor(a.measureText(u,i).width);l>e||c<=e;){if(l>e?o--:o++,o>t.length){o=t.length;break}if(o<0){o=0;break}s=t.slice(0,o),l=Math.floor(a.measureText(s,i).width),u=t.slice(0,o+1),c=Math.floor(a.measureText(u,i).width)}return r&&(o=cp(t,o)),o}function cp(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;ap.test(t[n-1])&&ap.test(t[n])||op.test(t[n]);)if(--n<=0)return i?hp(t,e):e;return n}function hp(t,e){for(var i=e;ap.test(t[i+1])&&ap.test(t[i])||op.test(t[i]);)if(++i>=t.length)return i;return i+1}function dp(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"actual";if(""===t)return{ascent:0,height:0,descent:0,width:0};var r=oh.graphicUtil.textMeasure.measureText(t,e),a={ascent:0,height:0,descent:0,width:0},o="actual"===n?r.actualBoundingBoxAscent:r.fontBoundingBoxAscent,s="actual"===n?r.actualBoundingBoxDescent:r.fontBoundingBoxDescent;"number"!=typeof o||"number"!=typeof s?(a.width=Math.floor(r.width),a.height=e.fontSize||0,a.ascent=a.height,a.descent=0):(a.width=Math.floor(r.width),a.height=Math.floor(o+s),a.ascent=Math.floor(o),a.descent=a.height-a.ascent);var l=null!==(i=e.space)&&void 0!==i?i:0;return a.width+=l,a}var pp=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fp=function(){return o((function t(){r(this,t),this.id="ATextMeasure"}),[{key:"configure",value:function(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}},{key:"_measureTextWithoutAlignBaseline",value:function(t,e,i){this.context.setTextStyleWithoutAlignBaseline(e);var n=this.context.measureText(t);return i?this.compatibleMetrics(n,e):n}},{key:"_measureTextWithAlignBaseline",value:function(t,e,i){this.context.setTextStyle(e);var n=this.context.measureText(t);return i?this.compatibleMetrics(n,e):n}},{key:"compatibleMetrics",value:function(t,e){if(null==t.actualBoundingBoxAscent||null==t.actualBoundingBoxDescent||null==t.fontBoundingBoxAscent||null==t.fontBoundingBoxDescent){t={width:t.width};var i=this.measureTextBoundADscentEstimate(e),n=i.ascent,r=i.descent;t.actualBoundingBoxAscent=n,t.actualBoundingBoxDescent=r,t.fontBoundingBoxAscent=n,t.fontBoundingBoxDescent=r}if(null==t.actualBoundingBoxLeft||null==t.actualBoundingBoxRight){t={width:t.width,actualBoundingBoxAscent:t.actualBoundingBoxAscent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent};var a=this.measureTextBoundLeftRightEstimate(e),o=a.left,s=a.right;t.actualBoundingBoxLeft=o,t.actualBoundingBoxRight=s}return t}},{key:"estimate",value:function(t,e){for(var i=e.fontSize,n=void 0===i?Kd.fontSize:i,r=0,a=0,o=0;o<t.length;o++)t.charCodeAt(o)<128?r++:a++;return{width:~~(.8*r*n+a*n),height:n}}},{key:"measureTextWidth",value:function(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}},{key:"measureTextBoundsWidth",value:function(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}},{key:"measureTextBoundsLeftRight",value:function(t,e,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}},{key:"measureTextPixelHeight",value:function(t,e,i){var n;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0),Math.abs(i.actualBoundingBoxAscent-i.actualBoundingBoxDescent)):null!==(n=e.fontSize)&&void 0!==n?n:Rd.fontSize}},{key:"measureTextPixelADscent",value:function(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}},{key:"measureTextBoundHieght",value:function(t,e,i){var n;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0),Math.abs(i.fontBoundingBoxAscent-i.fontBoundingBoxDescent)):null!==(n=e.fontSize)&&void 0!==n?n:Rd.fontSize}},{key:"measureTextBoundADscent",value:function(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}},{key:"measureTextBoundADscentEstimate",value:function(t){var e,i=null!==(e=t.fontSize)&&void 0!==e?e:Rd.fontSize;return{ascent:.79*i,descent:.21*i}}},{key:"measureTextBoundLeftRightEstimate",value:function(t){var e,i=null!==(e=t.fontSize)&&void 0!==e?e:Rd.fontSize,n=t.textAlign;return"center"===n?{left:i/2,right:i/2}:"right"===n||"end"===n?{left:i,right:0}:{left:0,right:i}}},{key:"measureTextPixelADscentAndWidth",value:function(t,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(t,e).width});var n=this._measureTextWithoutAlignBaseline(t,e,!0);if(i===Zc.actualBounding)return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width};if(i===Zc.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:n.width});if(i===Zc.fontBounding){var r=n.fontBoundingBoxAscent,a=n.fontBoundingBoxDescent;if(n.actualBoundingBoxDescent&&a<n.actualBoundingBoxDescent){var o=n.actualBoundingBoxDescent-a;a+=o,r-=o}else if(n.actualBoundingBoxAscent&&r<n.actualBoundingBoxAscent){var s=n.actualBoundingBoxAscent-r;r+=s,a-=s}return{ascent:r,descent:a,width:n.width}}return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width}}},{key:"measureText",value:function(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}},{key:"clipTextVertical",value:function(t,e,i,n){var r=this;if(0===t.length)return{verticalList:t,width:0};var a=e.fontSize,o=void 0===a?12:a;t.forEach((function(t){t.width=0===t.direction?o:r.measureTextWidth(t.text,e)}));for(var s=[],l=0,u=0;u<t.length&&l+t[u].width<i;u++)l+=t[u].width,s.push(t[u]);if(t[u]&&t[u].text.length>1){var c=this._clipText(t[u].text,e,i-l,0,t[u].text.length-1,"end",!1);if(n&&c.str!==t[u].text){for(var h="",d=0,p=0;p<u;p++){var f=t[p];h+=f.text,d+=f.text.length}var v=cp(h+=t[u].text,d+c.str.length);(v-=d)!==c.str.length-1&&(c.str=c.str.substring(0,v),c.width=this.measureTextWidth(c.str,e))}s.push(Object.assign(Object.assign({},t[u]),{text:c.str,width:c.width})),l+=c.width}return{verticalList:s,width:l}}},{key:"clipText",value:function(t,e,i,n,r){if(0===t.length)return{str:"",width:0};var a=this.measureTextWidth(t,e);if(a<=i)return{str:t,width:a};if((a=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};var o=this._clipText(t,e,i,0,t.length-1,"end",!1);if(n&&o.str!==t){var s=cp(t,o.str.length,r);s!==o.str.length&&(s>o.str.length&&(o.wordBreaked=s,s=o.str.length),o.str=t.substring(0,s),o.width=this.measureTextWidth(o.str,e))}return o}},{key:"_clipText",value:function(t,e,i,n,r,a,o){var s;if("start"===a)s=this._clipTextStart(t,e,i,n,r),o&&(s.result=o+s.str);else if("middle"===a){var l=this._clipTextMiddle(t,e,i,"","",0,0,1);s={str:"none",width:l.width,result:l.left+o+l.right}}else s=this._clipTextEnd(t,e,i,n,r),o&&(s.result=s.str+o);return s}},{key:"_clipTextEnd",value:function(t,e,i,n,r){if(n===r){Wt.getInstance().warn("【_clipTextEnd】不应该走到这里".concat(t,", ").concat(n,", ").concat(r));var a=t.substring(0,r+1);return{str:a,width:this.measureTextWidth(a,e)}}var o,s=Math.floor((n+r)/2),l=t.substring(0,s+1),u=this.measureTextWidth(l,e);if(u>i){if(l.length<=1)return{str:"",width:0};var c=t.substring(0,s);return(o=this.measureTextWidth(c,e))<=i?{str:c,width:o}:this._clipTextEnd(t,e,i,n,s)}if(u<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};var h=t.substring(0,s+2);return(o=this.measureTextWidth(h,e))>=i?{str:l,width:u}:this._clipTextEnd(t,e,i,s,r)}return{str:l,width:u}}},{key:"_clipTextStart",value:function(t,e,i,n,r){var a,o=Math.ceil((n+r)/2),s=t.substring(o-1,t.length),l=this.measureTextWidth(s,e);if(l>i){if(s.length<=1)return{str:"",width:0};var u=t.substring(o,t.length);return(a=this.measureTextWidth(u,e))<=i?{str:u,width:a}:this._clipTextStart(t,e,i,o,t.length)}if(l<i){if(o<=0)return{str:t,width:this.measureTextWidth(t,e)};var c=t.substring(o-2,t.length);return(a=this.measureTextWidth(c,e))>=i?{str:s,width:l}:this._clipTextStart(t,e,i,n,o)}return{str:s,width:l}}},{key:"_clipTextMiddle",value:function(t,e,i,n,r,a,o,s){var l=t.substring(0,s),u=this.measureTextWidth(l,e);if(u+o>i)return{left:n,right:r,width:a+o};var c=t.substring(t.length-s,t.length),h=this.measureTextWidth(c,e);return u+h>i?{left:l,right:r,width:u+o}:this._clipTextMiddle(t,e,i,l,c,u,h,s+1)}},{key:"clipTextWithSuffixVertical",value:function(t,e,i,n,r,a){if(""===n)return this.clipTextVertical(t,e,i,r);if(0===t.length)return{verticalList:t,width:0};var o=this.clipTextVertical(t,e,i,r);if(o.verticalList.length===t.length&&o.verticalList[o.verticalList.length-1].width===t[t.length-1].width)return o;var s,l=this.measureTextWidth(n,e);if(l>i)return o;if(i-=l,"start"===a){var u=this.revertVerticalList(t);s=this.clipTextVertical(u,e,i,r);var c=this.revertVerticalList(s.verticalList);c.unshift({text:n,direction:1,width:l}),s.verticalList=c}else if("middle"===a){var h=this.clipTextVertical(t,e,i/2,r),d=this.revertVerticalList(t),p=this.clipTextVertical(d,e,i/2,r);h.verticalList.push({text:n,direction:1,width:l}),this.revertVerticalList(p.verticalList).forEach((function(t){return h.verticalList.push(t)})),s={verticalList:h.verticalList,width:h.width+p.width}}else(s=this.clipTextVertical(t,e,i,r)).verticalList.push({text:n,direction:1,width:l});return s.width+=l,s}},{key:"revertVerticalList",value:function(t){return t.reverse().map((function(t){var e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})}))}},{key:"clipTextWithSuffix",value:function(t,e,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(""===n)return this.clipText(t,e,i,r);if(0===t.length)return{str:"",width:0};var s=this.measureTextWidth(t,e);if(!o&&s<=i)return{str:t,width:s};var l=this.measureTextWidth(n,e);if(l>i)return{str:"",width:0};if(o&&s+l<=i)return{str:t+n,width:s+l};i-=l;var u=this._clipText(t,e,i,0,t.length-1,a,n);if(r&&u.str!==t){var c=cp(t,u.str.length);c!==u.str.length&&(u.result=t.substring(0,c),u.width=this.measureTextWidth(u.str,e))}else o&&u.str===t&&(u.result=t+n);return u.str=u.result,u.width+=l,u}}])}();fp=pp([Dc()],fp);var vp=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gp=Symbol.for("TextMeasureContribution"),yp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).id="DefaultTextMeasureContribution",t}return h(e,t),o(e)}(fp);yp=vp([Dc()],yp);var mp=Symbol.for("CanvasFactory"),_p=Symbol.for("Context2dFactory");function bp(t){return rh.getNamed(mp,oh.global.env)(t)}var xp=1e-4,kp=Math.sqrt(3),Sp=1/3;function Ap(t){return t>-Op&&t<Op}function Cp(t){return t>Op||t<-Op}var Mp=[0,0],wp=[0,0],Tp=[0,0];function Dp(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function Ep(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i}function Bp(t,e,i,n,r){var a=1-r;return a*a*(a*t+3*r*e)+r*r*(r*n+3*a*i)}function Pp(t){return(t%=ei)<0&&(t+=ei),t}function Rp(t,e,i,n,r,a,o,s,l){if(0===o)return!1;var u=o;return!(l>e+u&&l>n+u&&l>a+u||l<e-u&&l<n-u&&l<a-u||s>t+u&&s>i+u&&s>r+u||s<t-u&&s<i-u&&s<r-u)&&function(t,e,i,n,r,a,o,s,l){var u=0,c=.005,h=1/0;Mp[0]=o,Mp[1]=s;for(var d=0;d<1;d+=.05){wp[0]=Ep(t,i,r,d),wp[1]=Ep(e,n,a,d);var p=Dp(Mp,wp);p<h&&(u=d,h=p)}h=1/0;for(var f=0;f<32&&!(c<xp);f++){var v=u-c,g=u+c;wp[0]=Ep(t,i,r,v),wp[1]=Ep(e,n,a,v);var y=Dp(wp,Mp);if(v>=0&&y<h)u=v,h=y;else{Tp[0]=Ep(t,i,r,g),Tp[1]=Ep(e,n,a,g);var m=Dp(Tp,Mp);g<=1&&m<h?(u=g,h=m):c*=.5}}return l&&(l[0]=Ep(t,i,r,u),l[1]=Ep(e,n,a,u)),Math.sqrt(h)}(t,e,i,n,r,a,s,l,null)<=u/2}function Lp(t,e,i,n,r,a,o,s,l,u,c){if(0===l)return!1;var h=l;return!(c>e+h&&c>n+h&&c>a+h&&c>s+h||c<e-h&&c<n-h&&c<a-h&&c<s-h||u>t+h&&u>i+h&&u>r+h&&u>o+h||u<t-h&&u<i-h&&u<r-h&&u<o-h)&&function(t,e,i,n,r,a,o,s,l,u,c){var h,d,p,f,v=0,g=.005,y=1/0;Mp[0]=l,Mp[1]=u;for(var m=0;m<1;m+=.05)wp[0]=Bp(t,i,r,o,m),wp[1]=Bp(e,n,a,s,m),(p=Dp(Mp,wp))<y&&(v=m,y=p);y=1/0;for(var _=0;_<32&&!(g<xp);_++)h=v-g,d=v+g,wp[0]=Bp(t,i,r,o,h),wp[1]=Bp(e,n,a,s,h),p=Dp(wp,Mp),h>=0&&p<y?(v=h,y=p):(Tp[0]=Bp(t,i,r,o,d),Tp[1]=Bp(e,n,a,s,d),f=Dp(Tp,Mp),d<=1&&f<y?(v=d,y=f):g*=.5);return c&&(c[0]=Bp(t,i,r,o,v),c[1]=Bp(e,n,a,s,v)),Math.sqrt(y)}(t,e,i,n,r,a,o,s,u,c,null)<=h/2}function Ip(t,e,i,n,r,a,o,s,l){if(0===o)return!1;var u=o;s-=t,l-=e;var c=Math.sqrt(s*s+l*l);if(c-u>i||c+u<i)return!1;if(Math.abs(n-r)%ei<1e-4)return!0;if(a){var h=n;n=Pp(r),r=Pp(h)}else n=Pp(n),r=Pp(r);n>r&&(r+=ei);var d=Math.atan2(l,s);return d<0&&(d+=ei),d>=n&&d<=r||d+ei>=n&&d+ei<=r}function Fp(t,e,i,n,r,a,o){if(0===r)return!1;var s,l=r,u=r/2;if(o>e+u&&o>n+u||o<e-u&&o<n-u||a>t+u&&a>i+u||a<t-u&&a<i-u)return!1;if(t===i)return Math.abs(a-t)<=l/2;var c=(s=(e-n)/(t-i))*a-o+(t*n-i*e)/(t-i);return c*c/(s*s+1)<=l/2*l/2}var Op=1e-4;function zp(t,e,i,n,r){var a=6*i-12*e+6*t,o=9*e+3*n-3*t-9*i,s=3*e-3*t,l=0;if(Ap(o)){if(Cp(a)){var u=-s/a;u>=0&&u<=1&&(r[l++]=u)}}else{var c=a*a-4*o*s;if(Ap(c))r[0]=-a/(2*o);else if(c>0){var h=Math.sqrt(c),d=(-a+h)/(2*o),p=(-a-h)/(2*o);d>=0&&d<=1&&(r[l++]=d),p>=0&&p<=1&&(r[l++]=p)}}return l}var Hp=[-1,-1,-1],Np=[-1,-1];function Up(t,e,i,n,r,a,o,s,l,u){if(u>e&&u>n&&u>a&&u>s||u<e&&u<n&&u<a&&u<s)return 0;var c=function(t,e,i,n,r,a){var o=n+3*(e-i)-t,s=3*(i-2*e+t),l=3*(e-t),u=t-r,c=s*s-3*o*l,h=s*l-9*o*u,d=l*l-3*s*u,p=0;if(Ap(c)&&Ap(h))if(Ap(s))a[0]=0;else{var f=-l/s;f>=0&&f<=1&&(a[p++]=f)}else{var v=h*h-4*c*d;if(Ap(v)){var g=h/c,y=-s/o+g,m=-g/2;y>=0&&y<=1&&(a[p++]=y),m>=0&&m<=1&&(a[p++]=m)}else if(v>0){var _=Math.sqrt(v),b=c*s+1.5*o*(-h+_),x=c*s+1.5*o*(-h-_),k=(-s-((b=b<0?-Math.pow(-b,Sp):Math.pow(b,Sp))+(x=x<0?-Math.pow(-x,Sp):Math.pow(x,Sp))))/(3*o);k>=0&&k<=1&&(a[p++]=k)}else{var S=(2*c*s-3*o*h)/(2*Math.sqrt(c*c*c)),A=Math.acos(S)/3,C=Math.sqrt(c),M=Math.cos(A),w=(-s-2*C*M)/(3*o),T=(-s+C*(M+kp*Math.sin(A)))/(3*o),D=(-s+C*(M-kp*Math.sin(A)))/(3*o);w>=0&&w<=1&&(a[p++]=w),T>=0&&T<=1&&(a[p++]=T),D>=0&&D<=1&&(a[p++]=D)}}return p}(e,n,a,s,u,Hp);if(0===c)return 0;for(var h,d=0,p=-1,f=0,v=0,g=0;g<c;g++){var y=Hp[g],m=0===y||1===y?.5:1;Bp(t,i,r,o,y)<l||(p<0&&(p=zp(e,n,a,s,Np),Np[1]<Np[0]&&p>1&&(h=void 0,h=Np[0],Np[0]=Np[1],Np[1]=h),f=Bp(e,n,a,s,Np[0]),p>1&&(v=Bp(e,n,a,s,Np[1]))),2===p?y<Np[0]?d+=f<e?m:-m:y<Np[1]?d+=v<f?m:-m:d+=s<v?m:-m:y<Np[0]?d+=f<e?m:-m:d+=s<f?m:-m)}return d}function jp(t,e,i,n,r,a,o,s){if(s>e&&s>n&&s>a||s<e&&s<n&&s<a)return 0;var l=function(t,e,i,n,r){var a=t-2*e+i,o=2*(e-t),s=t-n,l=0;if(Ap(a)){if(Cp(o)){var u=-s/o;u>=0&&u<=1&&(r[l++]=u)}}else{var c=o*o-4*a*s;if(Ap(c)){var h=-o/(2*a);h>=0&&h<=1&&(r[l++]=h)}else if(c>0){var d=Math.sqrt(c),p=(-o+d)/(2*a),f=(-o-d)/(2*a);p>=0&&p<=1&&(r[l++]=p),f>=0&&f<=1&&(r[l++]=f)}}return l}(e,n,a,s,Hp);if(0===l)return 0;var u,c,h,d=0===(h=(u=e)+a-2*(c=n))?.5:(u-c)/h;if(d>=0&&d<=1){for(var p=0,f=Ep(e,n,a,d),v=0;v<l;v++){var g=0===Hp[v]||1===Hp[v]?.5:1;Ep(t,i,r,Hp[v])<o||(Hp[v]<d?p+=f<e?g:-g:p+=a<f?g:-g)}return p}var y=0===Hp[0]||1===Hp[0]?.5:1;return Ep(t,i,r,Hp[0])<o?0:a<e?y:-y}function Vp(t,e,i,n,r,a,o,s){if((s-=e)>i||s<-i)return 0;var l=Math.sqrt(i*i-s*s);Hp[0]=-l,Hp[1]=l;var u=Math.abs(n-r);if(u<1e-4)return 0;if(u>=ei-1e-4){n=0,r=ei;var c=a?1:-1;return o>=Hp[0]+t&&o<=Hp[1]+t?c:0}if(n>r){var h=n;n=r,r=h}n<0&&(n+=ei,r+=ei);for(var d=0,p=0;p<2;p++){var f=Hp[p];if(f+t>o){var v=Math.atan2(s,f),g=a?1:-1;v<0&&(v=ei+v),(v>=n&&v<=r||v+ei>=n&&v+ei<=r)&&(v>Qe/2&&v<1.5*Qe&&(g=-g),d+=g)}}return d}function Wp(t){return Math.round(t/Qe*1e8)/1e8%2*Qe}function Gp(t,e){var i=Wp(t[0]);i<0&&(i+=ei);var n=i-t[0],r=t[1];r+=n,!e&&r-i>=ei?r=i+ei:e&&i-r>=ei?r=i-ei:!e&&i>r?r=i+(ei-Wp(i-r)):e&&i<r&&(r=i-(ei-Wp(r-i))),t[0]=i,t[1]=r}var Yp=[0,0];function Xp(t,e,i,n,r){for(var a,o,s=t,l=t.length,u=0,c=0,h=0,d=0,p=0,f=0;f<l;f++){var v=s[f],g=0===f;v[0]===Ph.M&&f>1&&(i||(u+=Sn(c,h,d,p,n,r))),g&&(d=c=v[1],p=h=v[2]);var y=v[0],m=v[1],_=v[2],b=v[3],x=v[4],k=v[5],S=v[6],A=x,C=k;Yp[0]=A,Yp[1]=C,Gp(Yp,Boolean(v[6]));var M=A=Yp[0],w=(C=Yp[1])-A,T=!!(1-(v[6]?0:1)),D=(n-m)*b/b+m;switch(y){case Ph.M:c=d=m,h=p=_;break;case Ph.L:if(i){if(Fp(c,h,m,_,e,n,r))return!0}else u+=Sn(c,h,m,_,n,r)||0;c=m,h=_;break;case Ph.C:if(i){if(Lp(c,h,m,_,b,x,k,S,e,n,r))return!0}else u+=Up(c,h,m,_,b,x,k,S,n,r)||0;c=k,h=S;break;case Ph.Q:if(i){if(Rp(c,h,m,_,b,x,e,n,r))return!0}else u+=jp(c,h,m,_,b,x,n,r)||0;c=b,h=x;break;case Ph.A:if(a=Math.cos(M)*b+m,o=Math.sin(M)*b+_,g?(d=a,p=o):u+=Sn(c,h,a,o,n,r),i){if(Ip(m,_,b,M,M+w,T,e,D,r))return!0}else u+=Vp(m,_,b,M,M+w,T,D,r);c=Math.cos(M+w)*b+m,h=Math.sin(M+w)*b+_;break;case Ph.R:if(a=(d=c=m)+b,o=(p=h=_)+x,i){if(Fp(d,p,a,p,e,n,r)||Fp(a,p,a,o,e,n,r)||Fp(a,o,d,o,e,n,r)||Fp(d,o,d,p,e,n,r))return!0}else u+=Sn(a,p,a,o,n,r),u+=Sn(d,o,d,p,n,r);break;case Ph.Z:if(i){if(Fp(c,h,d,p,e,n,r))return!0}else u+=Sn(c,h,d,p,n,r);c=d,h=p}}return i||function(t,e){return Math.abs(t-e)<Op}(h,p)||(u+=Sn(c,h,d,p,n,r)||0),0!==u}var Kp=function(){return o((function t(){r(this,t),this.pools=[],this.allocatedCanvas=[]}),[{key:"shareCanvas",value:function(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}},{key:"getCommonCanvas",value:function(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}},{key:"allocate",value:function(t){if(!this.pools.length){var e=bp(Object.assign({nativeCanvas:oh.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}var i=this.pools.pop();return i.resize(t.width,t.height),i.dpr=t.dpr,i}},{key:"allocateByObj",value:function(t){if(!this.pools.length){var e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=bp(Object.assign({nativeCanvas:oh.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}var n=this.pools.pop();return n.width=t.width,n.height=t.height,n}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),qp=new Kp,Zp=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Jp=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qp=Symbol.for("VWindow"),$p=Symbol.for("WindowHandlerContribution"),tf=function(t){function e(){var t;return r(this,e),(t=n(this,e)).hooks={onChange:new eh(["x","y","width","height"])},t.active=function(){var e=t.global;e.env&&!t.actived&&(rh.getNamed($p,e.env).configure(i(t),e),t.actived=!0)},t._uid=vc.GenAutoIncrementId(),t.global=oh.global,t.postInit(),t}return h(e,t),o(e,[{key:"width",get:function(){if(this._handler){var t=this._handler.getWH();return this._width=t.width}return this._width}},{key:"height",get:function(){if(this._handler){var t=this._handler.getWH();return this._height=t.height}return this._height}},{key:"dpr",get:function(){return this._handler.getDpr()}},{key:"_nativeAddEventListener",value:function(t,e,i){return this._handler.addEventListener(t,e,i)}},{key:"_nativeRemoveEventListener",value:function(t,e,i){return this._handler.removeEventListener(t,e,i)}},{key:"_nativeDispatchEvent",value:function(t){return this._handler.dispatchEvent(t)}},{key:"postInit",value:function(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}},{key:"style",get:function(){var t;return null!==(t=this._handler.getStyle())&&void 0!==t?t:{}},set:function(t){this._handler.setStyle(t)}},{key:"create",value:function(t){var e,i;this._handler.createWindow(t);var n=this._handler.getWH();this._width=n.width,this._height=n.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!==(e=t.width)&&void 0!==e?e:this._width,y2:null!==(i=t.height)&&void 0!==i?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}},{key:"setWindowHandler",value:function(t){this._handler=t}},{key:"setDpr",value:function(t){return this._handler.setDpr(t)}},{key:"resize",value:function(t,e){return this._handler.resizeWindow(t,e)}},{key:"configure",value:function(){throw new Error("暂不支持")}},{key:"release",value:function(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}},{key:"getContext",value:function(){return this._handler.getContext()}},{key:"getNativeHandler",value:function(){return this._handler.getNativeHandler()}},{key:"getImageBuffer",value:function(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}},{key:"getBoundingClientRect",value:function(){return this._handler.getBoundingClientRect()}},{key:"getContainer",value:function(){return this._handler.container}},{key:"clearViewBox",value:function(t){this._handler.clearViewBox(t)}},{key:"setViewBox",value:function(t){this._handler.setViewBox(t)}},{key:"setViewBoxTransform",value:function(t,e,i,n,r,a){this._handler.setViewBoxTransform(t,e,i,n,r,a)}},{key:"getViewBox",value:function(){return this._handler.getViewBox()}},{key:"getViewBoxTransform",value:function(){return this._handler.getViewBoxTransform()}},{key:"pointTransform",value:function(t,e){var i=this._handler.getViewBox(),n={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},n),n.x-=i.x1,n.y-=i.y1,n}},{key:"hasSubView",value:function(){var t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&ie(this.width,t.width())&&ie(this.height,t.height()))}},{key:"isVisible",value:function(t){return this._handler.isVisible(t)}},{key:"onVisibleChange",value:function(t){return this._handler.onVisibleChange(t)}},{key:"getTopLeft",value:function(t){return this._handler.getTopLeft(t)}}])}(uh);tf=Zp([Dc(),Jp("design:paramtypes",[])],tf);var ef,nf=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rf=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},af=function(t,e){return function(i,n){e(i,n,t)}},of=function(){return o((function t(e){var i=this;r(this,t),this.contributions=e,this.configured=!1,this.global=oh.global,this._textMeasureMap=new Map,this.global.hooks.onSetEnv.tap("graphic-util",(function(t,e,n){i.configured=!1,i.configure(n,e)}))}),[{key:"canvas",get:function(){return this.tryInitCanvas(),this._canvas}},{key:"context",get:function(){return this.tryInitCanvas(),this._context}},{key:"textMeasure",get:function(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}},{key:"getTextMeasureInstance",value:function(t){return t&&this._textMeasureMap.get(t)||this.textMeasure}},{key:"configure",value:function(t,e){var i=this;this.configured||(this.contributions.getContributions().forEach((function(t){t.configure(i,e)})),this.configured=!0)}},{key:"tryInitCanvas",value:function(){if(!this._canvas){var t=qp.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}},{key:"bindTextMeasure",value:function(t){this._textMeasure&&"DefaultTextMeasureContribution"!==t.id||(this._textMeasure=t),this._textMeasureMap.has(t.id)||this._textMeasureMap.set(t.id,t)}},{key:"measureText",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"native";this.configure(this.global,this.global.env);var r=this.global.measureTextMethod;this.global.measureTextMethod=n;var a={width:this._textMeasure.measureTextWidth(t,e),height:null!==(i=e.fontSize)&&void 0!==i?i:Rd.fontSize};return this.global.measureTextMethod=r,a}},{key:"createTextMeasureInstance",value:function(t,e,i){var n=this;return this.configure(this.global,this.global.env),new Bn(Object.assign({defaultFontParams:{fontFamily:Rd.fontFamily,fontSize:Rd.fontSize},getCanvasForMeasure:i||function(){return n.canvas},getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+Bn.ALPHABET_CHAR_SET+Bn.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}},{key:"drawGraphicToCanvas",value:function(t,e,i){if(!e.defaultLayer)return null;var n=rh.get(Qp),r=t.AABBBounds,a=r.width(),o=r.height(),s=-r.x1,l=-r.y1;n.create({viewBox:{x1:s,y1:l,x2:r.x2,y2:r.y2},width:a,height:o,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});var u=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(n,[t],{transMatrix:n.getViewBoxTransform(),viewBox:n.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=u;var c=n.getNativeHandler();return c.nativeCanvas?c.nativeCanvas:null}}])}();of=nf([Dc(),af(0,wc(Yc)),af(0,Ec(gp)),rf("design:paramtypes",[Object])],of),function(t){t[t.transform=0]="transform",t[t.matrix=1]="matrix"}(ef||(ef={}));var sf=new Hn,lf=function(){return o((function t(){r(this,t),this.matrix=new Hn}),[{key:"init",value:function(t){return this.mode=ef.transform,this.originTransform=t,this.matrix.reset(),this}},{key:"fromMatrix",value:function(t,e){return this.mode=ef.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}},{key:"scaleMatrix",value:function(t,e,i){var n=this.outSourceMatrix;if(sf.setValue(n.a,n.b,n.c,n.d,n.e,n.f),this.outTargetMatrix.reset(),i){var r=i.x,a=i.y;this.outTargetMatrix.translate(r,a),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-a)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(sf.a,sf.b,sf.c,sf.d,sf.e,sf.f),this}},{key:"rotateMatrix",value:function(t,e){var i=this.outSourceMatrix;if(sf.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){var n=e.x,r=e.y;this.outTargetMatrix.translate(n,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-n,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(sf.a,sf.b,sf.c,sf.d,sf.e,sf.f),this}},{key:"scale",value:function(t,e,i){return this.mode===ef.matrix?this.scaleMatrix(t,e,i):this}},{key:"rotate",value:function(t,e){return this.mode===ef.matrix?this.rotateMatrix(t,e):this}},{key:"translateMatrix",value:function(t,e){var i=this.outSourceMatrix;return sf.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(sf.a,sf.b,sf.c,sf.d,sf.e,sf.f),this}},{key:"translate",value:function(t,e){return this.mode===ef.matrix?this.translateMatrix(t,e):this}},{key:"simplify",value:function(t){return this.mode===ef.matrix?this.simplifyMatrix(t):this}},{key:"simplifyMatrix",value:function(t){return this}}])}();lf=nf([Dc(),rf("design:paramtypes",[])],lf);var uf={arc:Od,area:zd,circle:Hd,line:jd,path:Vd,symbol:Xd,text:Kd,rect:Yd,polygon:Wd,star:Gd,richtext:qd,richtextIcon:Jd,image:Zd,group:Nd,glyph:Ud},cf=Object.keys(uf);function hf(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}var df={arc:Object.assign({},uf.arc),area:Object.assign({},uf.area),circle:Object.assign({},uf.circle),line:Object.assign({},uf.line),path:Object.assign({},uf.path),symbol:Object.assign({},uf.symbol),text:Object.assign({},uf.text),rect:Object.assign({},uf.rect),polygon:Object.assign({},uf.polygon),star:Object.assign({},uf.star),richtext:Object.assign({},uf.richtext),richtextIcon:Object.assign({},uf.richtextIcon),image:Object.assign({},uf.image),group:Object.assign({},uf.group),glyph:Object.assign({},uf.glyph)},pf=function(){return o((function t(){r(this,t),this.initTheme(),this.dirty=!1}),[{key:"initTheme",value:function(){var t=this;this._defaultTheme={},cf.forEach((function(e){t._defaultTheme[e]=Object.create(df[e])})),this.combinedTheme=this._defaultTheme}},{key:"getTheme",value:function(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;var e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}},{key:"getParentWithTheme",value:function(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}},{key:"applyTheme",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.dirty){var n=this.getParentWithTheme(t);if(n){var r=n.theme;(r.dirty||i)&&r.applyTheme(n,e,!0)}this.userTheme?this.doCombine(n&&n.theme.combinedTheme):(n?this.combinedTheme=n.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Wt.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}},{key:"doCombine",value:function(t){var e=this,i=this.userTheme,n=this.combinedTheme;cf.forEach((function(r){var a=Object.create(df[r]);t&&t[r]&&hf(a,t[r]),n[r]&&hf(a,n[r]),i[r]&&hf(a,i[r]),e.combinedTheme[r]=a})),i.common&&cf.forEach((function(t){hf(e.combinedTheme[t],i.common)})),this.dirty=!1}},{key:"setTheme",value:function(t,e){var i=this.userTheme;i?Object.keys(t).forEach((function(e){i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])})):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}},{key:"resetTheme",value:function(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}},{key:"dirtyChildren",value:function(t){var e=this;t.forEachChildren((function(t){t.isContainer&&(t.theme&&(t.theme.dirty=!0),e.dirtyChildren(t))}))}}])}(),ff=new pf;function vf(t,e){return t.glyphHost?vf(t.glyphHost):e?(t.isContainer,e):function(t){var e;if(e=t.isContainer?t:t.parent,e){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):ff.getTheme()}return null}(t)||t.attachedThemeGraphic&&vf(t.attachedThemeGraphic)||ff.getTheme()}var gf=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},yf=function(t){function e(){var t;return r(this,e),(t=n(this,e))._uid=vc.GenAutoIncrementId(),t._firstChild=null,t._lastChild=null,t.parent=null,t._count=1,t}return h(e,t),o(e,[{key:"previousSibling",get:function(){return this._prev}},{key:"nextSibling",get:function(){return this._next}},{key:"children",get:function(){return this.getChildren()}},{key:"firstChild",get:function(){return this._firstChild}},{key:"lastChild",get:function(){return this._lastChild}},{key:"count",get:function(){return this._count}},{key:"childrenCount",get:function(){return this._idMap?this._idMap.size:0}},{key:"forEachChildren",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])for(var e=this._lastChild,i=0;e;){if(t(e,i++))return;e=e._prev}else for(var n=this._firstChild,r=0;n;){if(t(n,r++))return;n=n._next}}},{key:"forEachChildrenAsync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return gf(this,void 0,void 0,f().m((function i(){var n,r,a,o,s,l;return f().w((function(i){for(;;)switch(i.n){case 0:if(!e){i.n=7;break}n=this._lastChild,r=0;case 1:if(!n){i.n=6;break}if(a=t(n,r++),!a.then){i.n=3;break}return i.n=2,a;case 2:a=i.v;case 3:if(!a){i.n=4;break}return i.a(2);case 4:n=n._prev;case 5:i.n=1;break;case 6:i.n=13;break;case 7:o=this._firstChild,s=0;case 8:if(!o){i.n=13;break}if(l=t(o,s++),!l.then){i.n=10;break}return i.n=9,l;case 9:l=i.v;case 10:if(!l){i.n=11;break}return i.a(2);case 11:o=o._next;case 12:i.n=8;break;case 13:return i.a(2)}}),i,this)})))}},{key:"forEach",value:function(t){return this.forEachChildren(t)}},{key:"appendChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}},{key:"appendChildArrHighPerformance",value:function(t){return console.error("暂不支持该函数"),t}},{key:"insertBefore",value:function(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertAfter",value:function(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertInto",value:function(t,e){if(!this._ignoreWarn&&this._nodeList&&Wt.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{for(var i=this._firstChild,n=0;n<e;n++){if(!i)return null;n>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}},{key:"insertIntoKeepIdx",value:function(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){var i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}var n;this._nodeList[e]=t;for(var r=e-1;r>=0&&!(n=this._nodeList[r]);r--);if(n)return n._next?this.insertBefore(t,n._next):this.appendChild(t);this._ignoreWarn=!0;var a=this.insertInto(t,0);return this._ignoreWarn=!1,a}},{key:"removeChild",value:function(t){if(!this._idMap)return null;if(!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){var e=this._nodeList.findIndex((function(e){return e===t}));e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}},{key:"delete",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"removeAllChild",value:function(t){if(this._idMap){this._nodeList&&(this._nodeList.length=0);for(var e=this._firstChild;e;){var i=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=i}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}}},{key:"replaceChild",value:function(t,e){throw new Error("暂不支持")}},{key:"find",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;return this.forEachChildren((function(i,r){return!(i===e||!t(i,r)||(n=i,0))})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.find(t,!0);if(i)return n=i,!0}return!1})),n}},{key:"findAll",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return this.forEachChildren((function(i,r){i!==e&&t(i,r)&&n.push(i)})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.findAll(t,!0);i.length&&(n=n.concat(i))}})),n}},{key:"getElementById",value:function(t){return this.find((function(e){return e.id===t}),!0)}},{key:"findChildById",value:function(t){return this.getElementById(t)}},{key:"findChildByUid",value:function(t){return this._idMap&&this._idMap.get(t)||null}},{key:"getElementsByName",value:function(t){return this.findAll((function(e){return e.name===t}),!0)}},{key:"findChildrenByName",value:function(t){return this.getElementsByName(t)}},{key:"getElementsByType",value:function(t){return this.findAll((function(e){return e.type===t}),!0)}},{key:"getChildByName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.find((function(e){return e.name===t}),e)}},{key:"getChildAt",value:function(t){var e=this._firstChild;if(!e)return null;for(var i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}},{key:"at",value:function(t){return this.getChildAt(t)}},{key:"containNode",value:function(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;for(var e=this._firstChild;e;){if(e.containNode(t))return!0;e=e._next}return!1}},{key:"getRootNode",value:function(){for(var t=this.parent;null==t?void 0:t.parent;)t=t.parent;return t||this}},{key:"hasChildNodes",value:function(){return null!==this._firstChild}},{key:"addChild",value:function(t){return this.appendChild(t)}},{key:"add",value:function(t){return this.appendChild(t)}},{key:"getChildren",value:function(){for(var t=[],e=this._firstChild;e;)t.push(e),e=e._next;return t}},{key:"isChildOf",value:function(t){return!!this.parent&&this.parent._uid===t._uid}},{key:"isParentOf",value:function(t){return t.isChildOf(this)}},{key:"isDescendantsOf",value:function(t){var e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}},{key:"isAncestorsOf",value:function(t){return t.isDescendantsOf(this)}},{key:"getAncestor",value:function(t){throw new Error("暂不支持")}},{key:"setAllDescendantsProps",value:function(t,e){for(var i=this._firstChild;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}},{key:"setCount",value:function(t){this._count+=t;var e=this.parent;if(e)do{e._count+=t,e=e.parent}while(null!==e)}},{key:"clone",value:function(){throw new Error("暂不支持")}},{key:"cloneTo",value:function(t){throw new Error("暂不支持")}},{key:"getParent",value:function(){return this.parent}},{key:"del",value:function(t){return this.removeChild(t)}},{key:"addEventListener",value:function(t,i,n){var r=N(n,!0)&&n||G(n)&&n.capture,a=G(n)&&n.once,o=U(i)?void 0:i;return t=r?"".concat(t,"capture"):t,i=U(i)?i:i.handleEvent,a?_(e,"once",this,3)([t,i,o]):_(e,"on",this,3)([t,i,o]),this}},{key:"on",value:function(t,e,i){return this.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,i,n){var r=N(n,!0)&&n||G(n)&&n.capture,a=U(i)?void 0:i;t=r?"".concat(t,"capture"):t,i=U(i)?i:i.handleEvent;var o=G(n)&&n.once;return _(e,"off",this,3)([t,i,a,o]),this}},{key:"off",value:function(t,e,i){return this.removeEventListener(t,e,i)}},{key:"once",value:function(t,e,i){return G(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}},{key:"removeAllEventListeners",value:function(){return _(e,"removeAllListeners",this,3)([]),this}},{key:"removeAllListeners",value:function(){return this.removeAllEventListeners()}},{key:"dispatchEvent",value:function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return _(e,"emit",this,3)([t.type,t].concat(n)),!t.defaultPrevented}},{key:"emit",value:function(t,e){return this.dispatchEvent(t,e)}},{key:"release",value:function(){this.removeAllListeners()}}])}(z),mf=function(){return o((function t(e){r(this,t),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=t.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewX",get:function(){return this.viewport.x}},{key:"viewY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}},{key:"composedDetailPath",value:function(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}},{key:"_composedDetailPath",value:function(t){if(t&&t.graphic){var e=t.graphic;if(e.stage){var i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}},{key:"preventDefault",value:function(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&U(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&U(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error("Method not implemented.")}}])}(),_f=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).client={x:0,y:0},t.movement={x:0,y:0},t.offset={x:0,y:0},t.global={x:0,y:0},t.screen={x:0,y:0},t}return h(e,t),o(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f){throw new Error("Method not implemented.")}}])}(mf),bf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).width=0,t.height=0,t.isPrimary=!1,t}return h(e,t),o(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){var t,i,n,r=new e(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyPointerData(this,r),null===(i=this.manager)||void 0===i||i.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();var a=this.composedDetailPath();return r.detailPath=a&&a.slice(),r.type=this.type,r}}])}(_f),xf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).DOM_DELTA_PIXEL=0,t.DOM_DELTA_LINE=1,t.DOM_DELTA_PAGE=2,t}return h(e,t),o(e,[{key:"clone",value:function(){var t,i,n,r=new e(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyWheelData(this,r),null===(i=this.manager)||void 0===i||i.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();var a=this.composedDetailPath();return r.detailPath=a&&a.slice(),r.type=this.type,r}}])}(_f);xf.DOM_DELTA_PIXEL=0,xf.DOM_DELTA_LINE=1,xf.DOM_DELTA_PAGE=2;var kf=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e)).type=t,a.detail=i,a}return h(e,t),o(e)}(mf),Sf="object"==("undefined"==typeof performance?"undefined":k(performance))&&performance.now?performance:Date;function Af(t){return"mouse"===t||"pen"===t}var Cf,Mf=function(){return o((function t(e,i){var n=this;r(this,t),this.dispatch=new z,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=function(t,e){if(t instanceof bf){var i=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)n.dispatchEvent(i,"touchstart");else if(Af(i.pointerType)){var r=2===i.button;n.dispatchEvent(i,r?"rightdown":"mousedown")}n.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),n.freeEvent(i)}else Wt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerMove=function(t,e){var i,r;if(t instanceof bf){var a=n.createPointerEvent(t,t.type,e),o=Af(a.pointerType),s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.overTargets);if(s.overTargets&&l&&l!==n.rootTarget&&l!==a.target){var u="mousemove"===t.type?"mouseout":"pointerout",c=n.createPointerEvent(t,u,l||void 0);if(n.dispatchEvent(c,"pointerout"),o&&n.dispatchEvent(c,"mouseout"),!a.composedPath().includes(l)){var h=n.createPointerEvent(t,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,n.notifyTarget(h),o&&n.notifyTarget(h,"mouseleave"),h.target=h.target.parent;n.freeEvent(h)}n.freeEvent(c)}if(l!==a.target){var d="mousemove"===t.type?"mouseover":"pointerover",p=n.clonePointerEvent(a,d);n.dispatchEvent(p,"pointerover"),o&&n.dispatchEvent(p,"mouseover");for(var f=null==l?void 0:l.parent;f&&f!==n.rootTarget.parent&&f!==a.target;)f=f.parent;if(!f||f===n.rootTarget.parent){var v=n.clonePointerEvent(a,"pointerenter");v.eventPhase=v.AT_TARGET;for(var g=v.target,y=new Set,m=l;m&&m!==n.rootTarget;)y.add(m),m=m.parent;for(;g&&g!==l&&g!==n.rootTarget.parent;)y.has(g)||(v.currentTarget=g,n.notifyTarget(v),o&&n.notifyTarget(v,"mouseenter")),g=g.parent;n.freeEvent(v)}n.freeEvent(p)}n.dispatchEvent(a,"pointermove"),"touch"===a.pointerType&&n.dispatchEvent(a,"touchmove"),o&&(n.dispatchEvent(a,"mousemove"),n.cursorTarget=a.target,n.cursor=(null===(r=null===(i=a.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor()),s.overTargets=a.composedPath(),n.freeEvent(a)}else Wt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOver=function(t,e){var i,r;if(t instanceof bf){var a=n.trackingData(t.pointerId),o=n.createPointerEvent(t,t.type,e),s=Af(o.pointerType);n.dispatchEvent(o,"pointerover"),s&&n.dispatchEvent(o,"mouseover"),"mouse"===o.pointerType&&(n.cursorTarget=o.target,n.cursor=(null===(r=null===(i=o.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor());var l=n.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==n.rootTarget.parent;)l.currentTarget=l.target,n.notifyTarget(l),s&&n.notifyTarget(l,"mouseenter"),l.target=l.target.parent;a.overTargets=o.composedPath(),n.freeEvent(o),n.freeEvent(l)}else Wt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOut=function(t,e){if(t instanceof bf){var i=n.trackingData(t.pointerId);if(i.overTargets){var r=Af(t.pointerType),a=n.findMountedTarget(i.overTargets),o=n.createPointerEvent(t,"pointerout",a||void 0);n.dispatchEvent(o),r&&n.dispatchEvent(o,"mouseout");var s=n.createPointerEvent(t,"pointerleave",a||void 0);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==n.rootTarget.parent;)s.currentTarget=s.target,n.notifyTarget(s),r&&n.notifyTarget(s,"mouseleave"),s.target=s.target.parent;i.overTargets=[],n.freeEvent(o),n.freeEvent(s)}n.cursorTarget=null,n.cursor=""}else Wt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUp=function(t,e){var i;if(t instanceof bf){var r=Sf.now(),a=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(a,"pointerup"),"touch"===a.pointerType)n.dispatchEvent(a,"touchend");else if(Af(a.pointerType)){var o=2===a.button;n.dispatchEvent(a,o?"rightup":"mouseup")}var s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.pressTargetsByButton[t.button]),u=l;if(l&&!a.composedPath().includes(l)){for(var c=l;c&&!a.composedPath().includes(c);){if(a.currentTarget=c,n.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType)n.notifyTarget(a,"touchendoutside");else if(Af(a.pointerType)){var h=2===a.button;n.notifyTarget(a,h?"rightupoutside":"mouseupoutside")}c=c.parent}delete s.pressTargetsByButton[t.button],u=c}if(u){var d=n.clonePointerEvent(a,"click");d.target=u,d.path=[],d.detailPath=[],s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:d.target,timeStamp:r});var p=s.clicksByButton[t.button];p.target===d.target&&r-p.timeStamp<(null!==(i=n._config.clickInterval)&&void 0!==i?i:200)?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=r,d.detail=p.clickCount,Af(d.pointerType)?(n.dispatchEvent(d,"click"),2===p.clickCount&&n.dispatchEvent(d,"dblclick")):"touch"===d.pointerType&&n._config.supportsTouchEvents&&(n.dispatchEvent(d,"tap"),2===p.clickCount&&n.dispatchEvent(d,"dbltap")),n.dispatchEvent(d,"pointertap"),n.freeEvent(d)}n.freeEvent(a)}else Wt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUpOutside=function(t,e){if(t instanceof bf){var i=n.trackingData(t.pointerId),r=n.findMountedTarget(i.pressTargetsByButton[t.button]),a=n.createPointerEvent(t,t.type,e);if(r){for(var o=r;o;)a.currentTarget=o,n.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType?n.notifyTarget(a,"touchendoutside"):Af(a.pointerType)&&n.notifyTarget(a,2===a.button?"rightupoutside":"mouseupoutside"),o=o.parent;delete i.pressTargetsByButton[t.button]}n.freeEvent(a)}else Wt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onWheel=function(t,e){if(t instanceof xf){var i=n.createWheelEvent(t,e);n.dispatchEvent(i),n.freeEvent(i)}else Wt.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event")},this.rootTarget=e,this.mappingTable={},this._config=Object.assign({clickInterval:200},i),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}),[{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"dispatchEvent",value:function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}},{key:"mapEvent",value:function(t){var e,i,n,r,a,o,s;if(this.rootTarget){var u,c=this.mappingTable[t.type],h="".concat(t.canvasX,"-").concat(t.canvasY);if((null===(e=this._prePointTargetCache)||void 0===e?void 0:e[h])&&(null===(n=null===(i=this._prePointTargetCache)||void 0===i?void 0:i[h])||void 0===n?void 0:n.stage)&&(null===(a=null===(r=this._prePointTargetCache)||void 0===r?void 0:r[h])||void 0===a?void 0:a.stage.renderCount)===(null===(o=this._prePointTargetCache)||void 0===o?void 0:o.stageRenderCount)?u=this._prePointTargetCache[h]:(u=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache=l(l({},h,u),"stageRenderCount",null!==(s=null==u?void 0:u.stage.renderCount)&&void 0!==s?s:-1))),c)for(var d=0,p=c.length;d<p;d++)c[d].fn(t,u);else Wt.getInstance().warn("[EventManager]: Event mapping not defined for ".concat(t.type))}}},{key:"propagate",value:function(t,e){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var n=0,r=i.length-1;n<r;n++)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(var a=i.length-2;a>=0;a--)if(t.currentTarget=i[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){for(var e=[t],i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}},{key:"notifyTarget",value:function(t,e){if(!this.pauseNotify){e=null!=e?e:t.type;var i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[0],i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}},{key:"createPointerEvent",value:function(t,e,i){var n,r,a=this.allocateEvent(bf);return this.copyPointerData(t,a),this.copyMouseData(t,a),this.copyData(t,a),a.nativeEvent=t.nativeEvent,a.originalEvent=t,a.target=i||this.pickTarget(null!==(n=a.viewX)&&void 0!==n?n:a.global.x,null!==(r=a.viewY)&&void 0!==r?r:a.global.y,a),"string"==typeof e&&(a.type=e),a}},{key:"createWheelEvent",value:function(t,e){var i,n,r=this.allocateEvent(xf);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=e||this.pickTarget(null!==(i=r.viewX)&&void 0!==i?i:r.global.x,null!==(n=r.viewY)&&void 0!==n?n:r.global.y,r),r}},{key:"clonePointerEvent",value:function(t,e){var i=this.allocateEvent(bf);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();var n=t.composedDetailPath();return i.detailPath=n&&n.slice(),i.type=null!=e?e:i.type,i}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyPointerData",value:function(t,e){t instanceof bf&&e instanceof bf&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}},{key:"copyMouseData",value:function(t,e){t instanceof _f&&e instanceof _f&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach((function(i){e[i].x=t[i].x,e[i].y=t[i].y})))}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=Sf.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"allocateEvent",value:function(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);var i=(null===(e=this.eventPool.get(t))||void 0===e?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}},{key:"freeEvent",value:function(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");var i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null===(e=this.eventPool.get(i))||void 0===e||e.push(t)}},{key:"notifyListeners",value:function(t,e){var i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeEventListener(e,i[n].fn,{once:!0}),i[n].fn.call(i[n].context,t);this.emitDelegation(t,e)}},{key:"emitDelegation",value:function(t,e){var i=t.currentTarget._events["*"];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,t,e)}},{key:"pickTarget",value:function(t,e,i){var n,r=this.rootTarget.pick(t,e);return n=r&&r.graphic?r.graphic:r&&r.group?r.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=r.params),n}},{key:"release",value:function(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}])}(),wf={dispatchEvent:function(t){var e;if(!(t instanceof mf))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null===(e=null==t?void 0:t.manager)||void 0===e||e.dispatchEvent(t),!t.defaultPrevented},emit:function(t,e){return this.dispatchEvent(new kf(t,e))}},Tf={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Df=function(){return o((function t(e){var i=this;r(this,t),this.resolution=1,this.onPointerDown=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=i.normalizeToPointerData(t);i.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=0,r=e.length;n<r;n++){var a=e[n],o=i.bootstrapEvent(i.rootPointerEvent,a);i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerMove=function(t){if(!(i.supportsTouchEvents&&"touch"===t.pointerType||i.isEventOutsideOfTargetElement(t))){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var a=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerUp=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.isEventOutsideOfTargetViewPort(t)?"outside":"",n=i.normalizeToPointerData(t),r=0,a=n.length;r<a;r++){var o=i.bootstrapEvent(i.rootPointerEvent,n[r]);o.type+=e,i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerOverOut=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var a=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onWheel=function(t){var e=i.normalizeWheelEvent(t);i.manager.mapEvent(e)};var n=e.targetElement,a=e.resolution,o=e.rootNode,s=e.global,l=e.autoPreventDefault,u=void 0!==l&&l,c=e.clickInterval,h=e.supportsTouchEvents,d=void 0===h?s.supportsTouchEvents:h,p=e.supportsPointerEvents,f=void 0===p?s.supportsPointerEvents:p;this.manager=new Mf(o,{clickInterval:c,supportsTouchEvents:d}),this.globalObj=s,this.supportsPointerEvents=f,this.supportsTouchEvents=d,this.supportsMouseEvents=s.supportsMouseEvents,this.applyStyles=s.applyStyles,this.autoPreventDefault=u,this.eventsAdded=!1,this.rootPointerEvent=new bf,this.rootWheelEvent=new xf,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=a,this.setTargetElement(n)}),[{key:"release",value:function(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}},{key:"setCursor",value:function(t,e){if(e||this.manager.rootTarget.window._handler.canvas.controled){t||(t="default");var i=this.applyStyles,n=this.domElement;if(this.currentCursor!==t){this.currentCursor=t;var r=this.cursorStyles[t];r?"string"==typeof r&&i?n.style.cursor=r:"function"==typeof r?r(t):"object"==k(r)&&i&&Object.assign(n.style,r):i&&q(t)&&!pt(this.cursorStyles,t)&&(n.style.cursor=t)}}}},{key:"setTargetElement",value:function(t){this.removeEvents(),this.domElement=t,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){if(this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}}},{key:"mapToViewportPoint",value:function(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}},{key:"mapToCanvasPoint",value:function(t){var e,i,n=null===(e=this.globalObj)||void 0===e?void 0:e.mapToCanvasPoint(t,this.domElement);if(n)return n;var r=0,a=0;if(t.changedTouches){var o=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};r=o.clientX||0,a=o.clientY||0}else r=t.clientX||0,a=t.clientY||0;var s=this.domElement.getBoundingClientRect();return{x:r-s.left,y:a-s.top}}},{key:"normalizeToPointerData",value:function(t){var e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(var i=0,n=t.changedTouches.length;i<n;i++){var r=t.changedTouches[i];K(r.button)&&(r.button=0),K(r.buttons)&&(r.buttons=1),K(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),K(r.width)&&(r.width=r.radiusX||1),K(r.height)&&(r.height=r.radiusY||1),K(r.tiltX)&&(r.tiltX=0),K(r.tiltY)&&(r.tiltY=0),K(r.pointerType)&&(r.pointerType="touch"),K(r.pointerId)&&(r.pointerId=r.identifier||0),K(r.pressure)&&(r.pressure=r.force||.5),K(r.twist)&&(r.twist=0),K(r.tangentialPressure)&&(r.tangentialPressure=0),K(r.layerX)&&(r.layerX=r.offsetX=r.clientX),K(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!this.globalObj.supportsMouseEvents||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof PointerEvent)){var a=t;K(a.isPrimary)&&(a.isPrimary=!0),K(a.width)&&(a.width=1),K(a.height)&&(a.height=1),K(a.tiltX)&&(a.tiltX=0),K(a.tiltY)&&(a.tiltY=0),K(a.pointerType)&&(a.pointerType="mouse"),K(a.pointerId)&&(a.pointerId=1),K(a.pressure)&&(a.pressure=.5),K(a.twist)&&(a.twist=0),K(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,e.push(a)}else e.push(t);return e}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var i=this.mapToCanvasPoint(t),n=i.x,r=i.y;e.canvas.x=n,e.canvas.y=r,e.global.x=n,e.global.y=r,e.offset.x=n,e.offset.y=r;var a=this.mapToViewportPoint(e),o=a.x,s=a.y;return e.viewport.x=o,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}},{key:"bootstrapEvent",value:function(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.mapToCanvasPoint(e),n=i.x,r=i.y;t.canvas.x=n,t.canvas.y=r,t.global.x=n,t.global.y=r,t.offset.x=n,t.offset.y=r;var a=this.mapToViewportPoint(t),o=a.x,s=a.y;return t.viewport.x=o,t.viewport.y=s,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Tf[t.type]||t.type),t}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=Sf.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}},{key:"isEventOutsideOfTargetViewPort",value:function(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){var e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),n=i.width(),r=i.height();return!(e.x<n&&e.y<r&&e.x>0&&e.y>0)}return!1}},{key:"isEventOutsideOfTargetElement",value:function(t){var e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}},{key:"pauseTriggerEvent",value:function(){this.manager.pauseNotify=!0}},{key:"resumeTriggerEvent",value:function(){this.manager.pauseNotify=!1}}])}(),Ef=function(){function t(){r(this,t)}return o(t,null,[{key:"GetImage",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?oh.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):t.loadImage(e,i)}},{key:"GetSvg",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?oh.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):(r={type:"image",loadState:"init"},t.cache.set(e,r),r.dataPromise=oh.global.loadSvg(e),r.dataPromise?(r.waitingMark=[i],r.dataPromise.then((function(t){var i;r.loadState=(null==t?void 0:t.data)?"success":"fail",r.data=null==t?void 0:t.data,null===(i=r.waitingMark)||void 0===i||i.map((function(i,n){(null==t?void 0:t.data)?(r.loadState="success",r.data=t.data,i.imageLoadSuccess(e,t.data)):(r.loadState="fail",i.imageLoadFail(e))})),r.waitingMark&&(r.waitingMark=[])}))):(r.loadState="fail",i.imageLoadFail(e)))}},{key:"GetFile",value:function(e,i){var n=t.cache.get(e);return n?"fail"===n.loadState?Promise.reject():"init"===n.loadState||"loading"===n.loadState?n.dataPromise.then((function(t){return t.data})):Promise.resolve(n.data):(n={type:i,loadState:"init"},t.cache.set(e,n),"arrayBuffer"===i?n.dataPromise=oh.global.loadArrayBuffer(e):"blob"===i?n.dataPromise=oh.global.loadBlob(e):"json"===i&&(n.dataPromise=oh.global.loadJson(e)),n.dataPromise.then((function(t){return t.data})))}},{key:"loading",value:function(){var e=this;setTimeout((function(){if(!t.isLoading&&t.toLoadAueue.length){t.isLoading=!0;var i=t.toLoadAueue.splice(0,10),n=[];i.forEach((function(e){var i=e.url,r=e.marks,a={type:"image",loadState:"init"};if(t.cache.set(i,a),a.dataPromise=oh.global.loadImage(i),a.dataPromise){a.waitingMark=r;var o=a.dataPromise.then((function(t){var e;a.loadState=(null==t?void 0:t.data)?"success":"fail",a.data=null==t?void 0:t.data,null===(e=a.waitingMark)||void 0===e||e.map((function(e,n){(null==t?void 0:t.data)?(a.loadState="success",a.data=t.data,e.imageLoadSuccess(i,t.data)):(a.loadState="fail",e.imageLoadFail(i))})),a.waitingMark&&(a.waitingMark=[])}));n.push(o)}else a.loadState="fail",r.forEach((function(t){return t.imageLoadFail(i)}))})),Promise.all(n).then((function(){t.isLoading=!1,e.onLoadSuccessCb.forEach((function(t){return t()})),t.loading()})).catch((function(i){console.error(i),t.isLoading=!1,e.onLoadSuccessCb.forEach((function(t){return t()})),t.loading()}))}}),0)}},{key:"loadImage",value:function(e,i){var n=Bf(e,t.toLoadAueue);if(-1!==n)return t.toLoadAueue[n].marks.push(i),void t.loading();t.toLoadAueue.push({url:e,marks:[i]}),t.loading()}},{key:"improveImageLoading",value:function(e){var i=Bf(e,t.toLoadAueue);if(-1!==i){var n=t.toLoadAueue.splice(i,1);t.toLoadAueue.unshift(n[0])}}},{key:"onLoadSuccess",value:function(t){this.onLoadSuccessCb.push(t)}}])}();function Bf(t,e){for(var i=0;i<e.length;i++)if(e[i].url===t)return i;return-1}Ef.cache=new Map,Ef.isLoading=!1,Ef.toLoadAueue=[],Ef.onLoadSuccessCb=[],function(t){t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=4]="Bottom",t[t.Left=8]="Left",t[t.ALL=15]="ALL"}(Cf||(Cf={}));var Pf=[!1,!1,!1,!1],Rf=[0,0,0,0],Lf=function(t){return t?Z(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(Rf[0]=t[0],Rf[2]=t[0],Rf[1]=t[1],Rf[3]=t[1],Rf):t:t:0},If=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],Ff=[1,2,3,0,1,2,3,0];function Of(t,e,i,n){for(;t>=ei;)t-=ei;for(;t<0;)t+=ei;for(;t>e;)e+=ei;If[0].x=i,If[1].y=i,If[2].x=-i,If[3].y=-i;var r=Math.ceil(t/$e)%4,a=Math.ceil(e/$e)%4;if(n.add(ri(t)*i,si(t)*i),n.add(ri(e)*i,si(e)*i),r!==a||e-t>Qe)for(var o=!1,s=0;s<Ff.length;s++)if(o||r!==Ff[s]){if(o&&a===Ff[s])break;if(o){var l=If[Ff[s]];n.add(l.x,l.y)}}else{o=!0;var u=If[r];n.add(u.x,u.y)}}function zf(t,e,i){var n=di(t.x,t.y,e.x,e.y,i),r=n.x,a=n.y,o=di(t.x1,t.y1,e.x1,e.y1,i),s=o.x,l=o.y,u=new ki(r,a,s,l);return u.defined=e.defined,u}function Hf(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var n=[];if(t.length>e.length){n=e.map((function(t){var e=new ki(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var r=0;r<e.length;r++)n[r]=zf(t[r],e[r],i)}else{n=e.map((function(t){var e=new ki(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var a=0;a<t.length;a++)n[a]=zf(t[a],e[a],i)}return n}function Nf(t,e){if(Z(t)){for(var i,n=0;n<t.length&&void 0===i;n++)i=t[n][e];return i}return t[e]}var Uf=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.TimeOut;r(this,t),this.durations=[],this.timeout=e,this.lastDate=0,this.durationsListThreshold=30}),[{key:"call",value:function(t){var e=this;return this.lastDate=Date.now(),setTimeout((function(){e.appendDuration(Date.now()-e.lastDate),t(0)}),this.timeout,!0)}},{key:"clear",value:function(t){clearTimeout(t)}},{key:"appendDuration",value:function(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((function(t,e){return t+e}),0)/this.durations.length,1e3/60),1e3/30)}}])}();Uf.TimeOut=1e3/60;var jf=new Uf,Vf=function(t,e){var i=function(t,e){return q(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t}(t,e);return isNaN(i)?i:Math.max(e,i)},Wf=function(){return o((function t(){r(this,t)}),[{key:"bounds",value:function(t,e){if($(t)){var i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}},{key:"parseSize",value:function(t){return $(t)?t:Math.min(t[0],t[1])}}])}();function Gf(t,e,i,n,r){return r?t.arc(i,n,e,0,ti,!1,r):t.arc(i,n,e,0,ti),!1}var Yf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="circle",t.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return Gf(t,this.parseSize(e)/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return Gf(t,this.parseSize(e)/2+r,i,n,a)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i," a ").concat(r,",").concat(r," 0 1,0 ").concat(2*r,",0 a ").concat(r,",").concat(r," 0 1,0 -").concat(2*r,",0")}}])}(Wf),Xf=new Yf;var Kf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="cross",t.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(-3*e+i,-e+n,r),t.lineTo(-e+i,-e+n,r),t.lineTo(-e+i,-3*e+n,r),t.lineTo(e+i,-3*e+n,r),t.lineTo(e+i,-e+n,r),t.lineTo(3*e+i,-e+n,r),t.lineTo(3*e+i,e+n,r),t.lineTo(e+i,e+n,r),t.lineTo(e+i,3*e+n,r),t.lineTo(-e+i,3*e+n,r),t.lineTo(-e+i,e+n,r),t.lineTo(-3*e+i,e+n,r),t.closePath(),!0}(t,this.parseSize(e)/6,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return function(t,e,i,n,r,a){return t.moveTo(-3*e+i-r,-e+n-r,a),t.lineTo(-e+i-r,-e+n-r,a),t.lineTo(-e+i-r,-3*e+n-r,a),t.lineTo(e+i+r,-3*e+n-r,a),t.lineTo(e+i+r,-e+n-r,a),t.lineTo(3*e+i+r,-e+n-r,a),t.lineTo(3*e+i+r,e+n+r,a),t.lineTo(e+i+r,e+n+r,a),t.lineTo(e+i+r,3*e+n+r,a),t.lineTo(-e+i-r,3*e+n+r,a),t.lineTo(-e+i-r,e+n+r,a),t.lineTo(-3*e+i-r,e+n+r,a),t.closePath(),!0}(t,this.parseSize(e)/6,i,n,r,a)}}])}(Wf),qf=new Kf;function Zf(t,e,i,n,r){return t.moveTo(i,n-e,r),t.lineTo(e+i,n,r),t.lineTo(i,n+e,r),t.lineTo(i-e,n,r),t.closePath(),!0}var Jf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="diamond",t.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return Zf(t,this.parseSize(e)/2,i,n,r)}},{key:"drawFitDir",value:function(t,e,i,n,r){return Zf(t,this.parseSize(e)/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return Zf(t,this.parseSize(e)/2+r,i,n,a)}}])}(Wf),Qf=new Jf;function $f(t,e,i,n){var r=2*e;return t.rect(i-e,n-e,r,r),!1}var tv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="square",t.pathStr="M-0.5,-0.5h1v1h-1Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return $f(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return $f(t,this.parseSize(e)/2+r,i,n)}}])}(Wf),ev=new tv;function iv(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i+e+2*r,e+n+r),t.lineTo(i-e-2*r,e+n+r),t.lineTo(i,n-e-2*r),t.closePath(),!0}var nv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleUp",t.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return iv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return iv(t,this.parseSize(e)/2,i,n,r)}}])}(Wf),rv=new nv,av=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangle",t}return h(e,t),o(e)}(nv),ov=new av,sv=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),lv=Math.sin(ti/10)*sv,uv=-Math.cos(ti/10)*sv;function cv(t,e,i,n){var r=lv*e,a=uv*e;t.moveTo(i,-e+n),t.lineTo(r+i,a+n);for(var o=1;o<5;++o){var s=ti*o/5,l=Math.cos(s),u=Math.sin(s);t.lineTo(u*e+i,-l*e+n),t.lineTo(l*r-u*a+i,u*r+l*a+n)}return t.closePath(),!0}var hv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="star",t.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return cv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return cv(t,this.parseSize(e)/2+r,i,n)}}])}(Wf),dv=new hv,pv=li(3);function fv(t,e,i,n){var r=e,a=r/pv,o=a/5,s=e;return t.moveTo(0+i,-r+n),t.lineTo(a/2+i,n),t.lineTo(o/2+i,n),t.lineTo(o/2+i,s+n),t.lineTo(-o/2+i,s+n),t.lineTo(-o/2+i,n),t.lineTo(-a/2+i,n),t.closePath(),!0}var vv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow",t.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return fv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return fv(t,this.parseSize(e)/2+r,i,n)}}])}(Wf),gv=new vv;function yv(t,e,i,n){var r=2*e;return t.moveTo(i,-e+n),t.lineTo(r/3/2+i,e+n),t.lineTo(-r/3/2+i,e+n),t.closePath(),!0}var mv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="wedge",t.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return yv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return yv(t,this.parseSize(e)/2+r,i,n)}}])}(Wf),_v=new mv;function bv(t,e,i,n){return t.moveTo(-e+i,n),t.lineTo(i,e+n),!1}var xv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="stroke",t.pathStr="",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return bv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return bv(t,this.parseSize(e)/2+r,i,n)}}])}(Wf),kv=new xv,Sv=-.5,Av=li(3)/2,Cv=1/li(12);function Mv(t,e,i,n){var r=e/2,a=e*Cv,o=r,s=e*Cv+e,l=-o,u=s;return t.moveTo(r+i,a+n),t.lineTo(o+i,s+n),t.lineTo(l+i,u+n),t.lineTo(Sv*r-Av*a+i,Av*r+Sv*a+n),t.lineTo(Sv*o-Av*s+i,Av*o+Sv*s+n),t.lineTo(Sv*l-Av*u+i,Av*l+Sv*u+n),t.lineTo(Sv*r+Av*a+i,Sv*a-Av*r+n),t.lineTo(Sv*o+Av*s+i,Sv*s-Av*o+n),t.lineTo(Sv*l+Av*u+i,Sv*u-Av*l+n),t.closePath(),!1}var wv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="wye",t.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Mv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Mv(t,this.parseSize(e)/2+r,i,n)}}])}(Wf),Tv=new wv;function Dv(t,e,i,n,r){return t.moveTo(-e+i-2*r,n),t.lineTo(e+i+r,e+n+2*r),t.lineTo(e+i+r,n-e-2*r),t.closePath(),!0}var Ev=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleLeft",t.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Dv(t,this.parseSize(e)/2,i,n,0)}},{key:"drawOffset",value:function(t,e,i,n,r){return Dv(t,this.parseSize(e)/2,i,n,r)}}])}(Wf),Bv=new Ev;function Pv(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i-e-r,e+n+2*r),t.lineTo(e+i+2*r,n),t.lineTo(i-e-r,n-e-2*r),t.closePath(),!0}var Rv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleRight",t.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Pv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Pv(t,this.parseSize(e)/2,i,n,r)}}])}(Wf),Lv=new Rv;function Iv(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i-e-2*r,n-e-r),t.lineTo(i+e+2*r,n-e-r),t.lineTo(i,n+e+2*r),t.closePath(),!0}var Fv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleDown",t.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Iv(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Iv(t,this.parseSize(e)/2,i,n,r)}}])}(Wf),Ov=new Fv,zv=li(3);function Hv(t,e,i,n){var r=e*zv;return t.moveTo(i,n+-r/3*2),t.lineTo(e+i,n+r),t.lineTo(i-e,n+r),t.closePath(),!0}var Nv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="thinTriangle",t.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Hv(t,this.parseSize(e)/2/zv,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Hv(t,this.parseSize(e)/2/zv+r,i,n)}}])}(Wf),Uv=new Nv;function jv(t,e,i,n){var r=2*e;return t.moveTo(e+i,n-r),t.lineTo(i-e,n),t.lineTo(e+i,r+n),!0}var Vv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Left",t.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return jv(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return jv(t,this.parseSize(e)/4+r,i,n)}}])}(Wf),Wv=new Vv;function Gv(t,e,i,n){var r=2*e;return t.moveTo(i-e,n-r),t.lineTo(i+e,n),t.lineTo(i-e,r+n),!0}var Yv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Right",t.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Gv(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Gv(t,this.parseSize(e)/4+r,i,n)}}])}(Wf),Xv=new Yv;function Kv(t,e,i,n){var r=2*e;return t.moveTo(i-r,n+e),t.lineTo(i,n-e),t.lineTo(i+r,n+e),!0}var qv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Up",t.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Kv(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Kv(t,this.parseSize(e)/4+r,i,n)}}])}(Wf),Zv=new qv;function Jv(t,e,i,n){var r=2*e;return t.moveTo(i-r,n-e),t.lineTo(i,n+e),t.lineTo(i+r,n-e),!0}var Qv=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Down",t.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Jv(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Jv(t,this.parseSize(e)/4+r,i,n)}}])}(Wf),$v=new Qv;function tg(t,e,i,n,r){return t.moveTo(i,n-e),t.lineTo(i,n+e),!0}var eg=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="lineV",t.pathStr="M0,-0.5L0,0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return tg(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return tg(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e,", ").concat(i-r," L ").concat(e,",").concat(i+r)}}])}(Wf),ig=new eg;function ng(t,e,i,n,r){return t.moveTo(i-e,n),t.lineTo(i+e,n),!0}var rg=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="lineH",t.pathStr="M-0.5,0L0.5,0",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return ng(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return ng(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i," L ").concat(e+r,",").concat(i)}}])}(Wf),ag=new rg;function og(t,e,i,n,r){return t.moveTo(i-e,n-e),t.lineTo(i+e,n+e),t.moveTo(i+e,n-e),t.lineTo(i-e,n+e),!0}var sg=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="close",t.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return og(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return og(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i-r," L ").concat(e+r,",").concat(i+r," M ").concat(e+r,", ").concat(i-r," L ").concat(e-r,",").concat(i+r)}}])}(Wf),lg=new sg;function ug(t,e,i,n){return t.rect(i-e[0]/2,n-e[1]/2,e[0],e[1]),!1}function cg(t,e,i,n){var r=e,a=e/2;return t.rect(i-r/2,n-a/2,r,a),!1}var hg=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="rect",t.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return $(e)?cg(t,e,i,n):ug(t,e,i,n)}},{key:"drawWithClipRange",value:function(t,e,i,n,r,a,o){$(e)&&(e=[e,e/2]);var s=2*(e[0]+e[1])*r,l=[{x:i+e[0]/2,y:n-e[1]/2},{x:i+e[0]/2,y:n+e[1]/2},{x:i-e[0]/2,y:n+e[1]/2},{x:i-e[0]/2,y:n-e[1]/2}],u=0,c=l[3];t.moveTo(c.x,c.y);for(var h=0;h<l.length;h++){var d=l[h],p=Math.sqrt((d.x-c.x)*(d.x-c.x)+(d.y-c.y)*(d.y-c.y));if(u+p>s){var f=(d.x-c.x)*(s-u)/p,v=(d.y-c.y)*(s-u)/p;t.lineTo(c.x+f,c.y+v);break}t.lineTo(d.x,d.y),c=d,u+=p}return!1}},{key:"drawOffset",value:function(t,e,i,n,r){return $(e)?cg(t,e+2*r,i,n):ug(t,[e[0]+2*r,e[1]+2*r],i,n)}}])}(Wf),dg=new hg,pg=new On,fg=function(){return o((function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t),this.pathStr="",this.type=e,Z(i)?this.svgCache=i:this.path=i,this.isSvg=n}),[{key:"drawOffset",value:function(t,e,i,n,r,a,o){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(r){t.beginPath(),Fh(r.path.commandList,t,i,n,e,e),o&&o(r.path,r.attribute)})),!1):(Fh(this.path.commandList,t,i,n,e+r,e+r),!1)}},{key:"draw",value:function(t,e,i,n,r,a){return e=this.parseSize(e),this.drawOffset(t,e,i,n,0,r,a)}},{key:"parseSize",value:function(t){return $(t)?t:Math.min(t[0],t[1])}},{key:"drawWithClipRange",value:function(t,e,i,n,r,a,o){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(a){a.path.drawWithClipRange(t,e,i,n,r),o&&o(a.path,a.attribute)})),!1):(this.path.drawWithClipRange(t,e,i,n,r),!1)}},{key:"bounds",value:function(t,e){if(t=this.parseSize(t),this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach((function(i){var n=i.path;pg.x1=n.bounds.x1*t,pg.y1=n.bounds.y1*t,pg.x2=n.bounds.x2*t,pg.y2=n.bounds.y2*t,e.union(pg)}))}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}])}(),vg={};[Xf,qf,Qf,ev,Uv,ov,dv,gv,_v,kv,Tv,Bv,Lv,rv,Ov,Wv,Xv,Zv,$v,dg,ig,ag,lg].forEach((function(t){vg[t.type]=t}));var gg={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"};var yg=function(){return o((function t(e){r(this,t),this.tagname=e,this.child=[],this[":@"]={}}),[{key:"add",value:function(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push(l({},t,e))}},{key:"addChild",value:function(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push(l(l({},t.tagname,t.child),":@",t[":@"])):this.child.push(l({},t.tagname,t.child))}}])}();function mg(t,e,i,n){var r=t.indexOf(e,i);if(-1===r)throw new Error(n);return r+e.length-1}function _g(t,e,i){var n=function(t,e){for(var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:">",r="",a=e;a<t.length;a++){var o=t[a];if(i)o===i&&(i="");else if('"'===o||"'"===o)i=o;else if(o===n[0]){if(!n[1])return{data:r,index:a};if(t[a+1]===n[1])return{data:r,index:a}}else"\t"===o&&(o=" ");r+=o}}(t,e+1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:">");if(n){var r=n.data,a=n.index,o=r.search(/\s/),s=r,l=!0;-1!==o&&(s=r.substr(0,o).replace(/\s\s*$/,""),r=r.substr(o+1));var u=s;if(i){var c=s.indexOf(":");-1!==c&&(l=(s=s.substr(c+1))!==n.data.substr(c+1))}return{tagName:s,tagExp:r,closeIndex:a,attrExpPresent:l,rawTagName:u}}}var bg=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm"),xg=function(){return o((function t(e){r(this,t),this.currentNode=null,this.options=e,this.tagsNodeStack=[],this.docTypeEntities={}}),[{key:"addChild",value:function(t,e,i){var n=e.tagname;"string"==typeof n?(e.tagname=n,t.addChild(e)):t.addChild(e)}},{key:"buildAttributesMap",value:function(t,e,i){var n={};if(t){for(var r=function(t,e){for(var i=[],n=e.exec(t);n;){var r=[];r.startIndex=e.lastIndex-n[0].length;for(var a=n.length,o=0;o<a;o++)r.push(n[o]);i.push(r),n=e.exec(t)}return i}(t,bg),a=r.length,o=0;o<a;o++){var s=r[o][1],l=r[o][4];s&&(n[s]=void 0===l||(isNaN(l)?l:Number(l)))}return n}}},{key:"parseXml",value:function(t){t=t.replace(/\r\n?/g,"\n");for(var e=new yg("!xml"),i=e,n="",r="",a=0;a<t.length;a++)if("<"===t[a])if("/"===t[a+1]){var o=mg(t,">",a,"Closing Tag is not closed."),s=r.lastIndexOf(".");r=r.substring(0,s),(i=this.tagsNodeStack.pop())&&i.child&&n&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=n),n="",a=o}else if("?"===t[a+1])a=_g(t,a,!1,"?>").closeIndex+1;else if("!--"===t.substr(a+1,3))a=mg(t,"--\x3e",a+4,"Comment is not closed.");else{var l=_g(t,a,!1),u=l.tagName,c=l.tagExp,h=l.attrExpPresent,d=l.closeIndex;if(u!==e.tagname&&(r+=r?"."+u:u),c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===u[u.length-1]?(u=u.substr(0,u.length-1),r=r.substr(0,r.length-1),c=u):c=c.substr(0,c.length-1);var p=new yg(u);u!==c&&h&&(p[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,p,r),r=r.substr(0,r.lastIndexOf("."))}else{var f=new yg(u);this.tagsNodeStack.push(i),u!==c&&h&&(f[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,f,r),i=f}n="",a=d}else n+=t[a];return e.child}}])}();function kg(t,e){return Sg(t)}function Sg(t,e){for(var i,n={},r=0;r<t.length;r++){var a=t[r],o=Ag(a);if(void 0!==o&&a[o]){var s=Sg(a[o]);i=s,Object.keys(i).length,a[":@"]&&Cg(s,a[":@"]),void 0!==n[o]&&n.hasOwnProperty(o)?(Array.isArray(n[o])||(n[o]=[n[o]]),n[o].push(s)):n[o]=s}}return n}function Ag(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];if(":@"!==n)return n}}function Cg(t,e,i){if(e)for(var n=Object.keys(e),r=n.length,a=0;a<r;a++){var o=n[a];t[o]=e[o]}}var Mg=function(){return o((function t(e){r(this,t),this.options=Object.assign({},t.defaultOptions,e)}),[{key:"valid",value:function(t){return t.startsWith("<")}},{key:"parse",value:function(t){return!!this.valid&&kg(new xg(this.options).parseXml(t),this.options)}}])}();Mg.defaultOptions={};var wg=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};function Tg(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.expand(e+(n/2+(i?function(t,e){return t?e:0}(i,e):0))),t}var Dg,Eg=0;function Bg(){return Eg++}!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Dg||(Dg={}));var Pg=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach((function(t){return Pg.set(t,!0)}));var Rg=new Map;function Lg(t){if(Pg.has(t))return!0;if(Rg.has(t))return!1;var e=!1;return t.codePointAt(0)<256&&(e=!0),e}[""].forEach((function(t){return Rg.set(t,!0)}));var Ig=Bg(),Fg=Bg(),Og=Bg(),zg=Bg(),Hg=Bg(),Ng=Bg(),Ug=Bg(),jg=Bg(),Vg=Bg(),Wg=Bg(),Gg=Bg(),Yg=Bg(),Xg=Bg(),Kg=Bg();Bg();var qg=Bg(),Zg=Bg(),Jg=Symbol.for("GraphicService"),Qg=Symbol.for("GraphicCreator"),$g={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},ty=Object.keys($g),ey={duration:200,easing:"cubicOut"};function iy(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ny(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*v+s*g+h*y+e[12],t[13]=r*v+l*g+d*y+e[13],t[14]=a*v+u*g+p*y+e[14],t[15]=o*v+c*g+f*y+e[15]),t}function ry(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function ay(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],v=e[12],g=e[13],y=e[14],m=e[15],_=i[0],b=i[1],x=i[2],k=i[3];return t[0]=_*n+b*s+x*h+k*v,t[1]=_*r+b*l+x*d+k*g,t[2]=_*a+b*u+x*p+k*y,t[3]=_*o+b*c+x*f+k*m,_=i[4],b=i[5],x=i[6],k=i[7],t[4]=_*n+b*s+x*h+k*v,t[5]=_*r+b*l+x*d+k*g,t[6]=_*a+b*u+x*p+k*y,t[7]=_*o+b*c+x*f+k*m,_=i[8],b=i[9],x=i[10],k=i[11],t[8]=_*n+b*s+x*h+k*v,t[9]=_*r+b*l+x*d+k*g,t[10]=_*a+b*u+x*p+k*y,t[11]=_*o+b*c+x*f+k*m,_=i[12],b=i[13],x=i[14],k=i[15],t[12]=_*n+b*s+x*h+k*v,t[13]=_*r+b*l+x*d+k*g,t[14]=_*a+b*u+x*p+k*y,t[15]=_*o+b*c+x*f+k*m,t}function oy(t,e,i){var n=e[0],r=e[1],a=e[2],o=i[3]*n+i[7]*r+i[11]*a+i[15];return o=o||1,t[0]=(i[0]*n+i[4]*r+i[8]*a+i[12])/o,t[1]=(i[1]*n+i[5]*r+i[9]*a+i[13])/o,t[2]=(i[2]*n+i[6]*r+i[10]*a+i[14])/o,t}var sy=function(){return o((function t(){r(this,t),this.pools=[]}),[{key:"allocate",value:function(t,e,i,n,r,a){if(!this.pools.length)return new Hn(t,e,i,n,r,a);var o=this.pools.pop();return o.a=t,o.b=e,o.c=i,o.d=n,o.e=r,o.f=a,o}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new Hn(t.a,t.b,t.c,t.d,t.e,t.f);var e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),ly=function(){function t(){r(this,t),this.pools=[]}return o(t,[{key:"allocate",value:function(){if(!this.pools.length)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e=this.pools.pop();return t.identity(e),e}},{key:"allocateByObj",value:function(t){var e;e=this.pools.length?this.pools.pop():[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];for(var i=0;i<e.length;i++)e[i]=t[i];return e}},{key:"free",value:function(t){t&&this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}],[{key:"identity",value:function(t){return iy(t)}}])}(),uy=new sy,cy=new ly,hy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},dy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},py=new Hn(1,0,0,1,0,0),fy={x:0,y:0},vy=function(){return o((function t(e,i){r(this,t),this.matrix=new Hn(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new Hn(1,0,0,1,0,0),this.path=new Md,this._clearMatrix=new Hn(1,0,0,1,0,0)}),[{key:"nativeContext",get:function(){return this.path}},{key:"getCanvas",value:function(){throw new Error("不支持getCanvas")}},{key:"getContext",value:function(){throw new Error("不支持getContext")}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return uy.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.restore()}},{key:"reset",value:function(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Hn(1,0,0,1,0,0),this.stack.length=0}},{key:"restore",value:function(){this.stack.length>0&&(uy.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(uy.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*a),o&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,a),o&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.path.clear()}},{key:"clip",value:function(t,e){}},{key:"arc",value:function(t,e,i,n,r,a){this.path.arc(t,e,i,n,r,a)}},{key:"arcTo",value:function(t,e,i,n,r){this.path.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.path.bezierCurveTo(t,e,i,n,r,a)}},{key:"closePath",value:function(){this.path.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){}},{key:"lineTo",value:function(t,e){this.path.lineTo(t,e)}},{key:"moveTo",value:function(t,e){this.path.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.path.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"createImageData",value:function(t,e){return null}},{key:"createLinearGradient",value:function(t,e,i,n){throw new Error("不支持createLinearGradient")}},{key:"createPattern",value:function(t,e){throw new Error("不支持createPattern")}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){throw new Error("不支持createRadialGradient")}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"fill",value:function(t,e){}},{key:"fillRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){}},{key:"fillText",value:function(t,e,i){}},{key:"getImageData",value:function(t,e,i,n){return null}},{key:"getLineDash",value:function(){return[]}},{key:"isPointInPath",value:function(t,e){return this.matrix.transformPoint({x:t,y:e},fy),function(t,e,i){return Xp(t,0,!1,e,i)}(this.path.commandList,fy.x,fy.y)}},{key:"isPointInStroke",value:function(t,e){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},fy);var i=tp(this,this.lineWidth,this.dpr);return function(t,e,i,n){return Xp(t,e,!0,i,n)}(this.path.commandList,i,fy.x,fy.y)}},{key:"measureText",value:function(t){throw new Error("不支持measureText")}},{key:"putImageData",value:function(t,e,i){throw new Error("不支持measureText")}},{key:"setLineDash",value:function(t){}},{key:"stroke",value:function(t){}},{key:"strokeRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i){}},{key:"drawImage",value:function(){}},{key:"setCommonStyle",value:function(t,e,i,n,r){}},{key:"_setCommonStyle",value:function(t,e,i,n){}},{key:"setStrokeStyle",value:function(t,e,i,n,r){}},{key:"_setStrokeStyle",value:function(t,e,i,n){}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(py,t,e)}},{key:"setClearMatrix",value:function(t,e,i,n,r,a){this._clearMatrix.setValue(t,e,i,n,r,a)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return uy.free(t)})),this.stack.length=0}}])}();vy=hy([Dc(),dy("design:paramtypes",[Object,Number])],vy);var gy,yy=500,my=500,_y=1,by=function(){return o((function t(e){var i;r(this,t);var n=e.nativeCanvas,a=e.width,o=void 0===a?yy:a,s=e.height,l=void 0===s?my:s,u=e.dpr,c=void 0===u?_y:u,h=e.x,d=e.y,p=e.id,f=e.canvasControled,v=void 0===f||f;this._x=null!=h?h:0,this._y=null!=d?d:0,this._pixelWidth=o*c,this._pixelHeight=l*c,this._visiable=!1!==e.visiable,this.controled=v,this._displayWidth=o,this._displayHeight=l,this._dpr=c,this._nativeCanvas=n,this._id=null!==(i=n.id)&&void 0!==i?i:p,p&&(n.id=p),this.init(e)}),[{key:"displayWidth",get:function(){return this._pixelWidth/this._dpr}},{key:"displayHeight",get:function(){return this._pixelHeight/this._dpr}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"nativeCanvas",get:function(){return this._nativeCanvas},set:function(t){this._nativeCanvas=t}},{key:"width",get:function(){return this._pixelWidth},set:function(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}},{key:"height",get:function(){return this._pixelHeight},set:function(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}},{key:"getContext",value:function(t){return this._context}},{key:"visiable",get:function(){return this._visiable},set:function(t){this._visiable=t,t?this.show():this.hide()}},{key:"dpr",get:function(){return this._dpr},set:function(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}},{key:"getNativeCanvas",value:function(){return this._nativeCanvas}},{key:"hide",value:function(){}},{key:"show",value:function(){}},{key:"applyPosition",value:function(){}},{key:"resetStyle",value:function(t){}},{key:"resize",value:function(t,e){}},{key:"toDataURL",value:function(t,e){return""}},{key:"readPixels",value:function(t,e,i,n){return this._context.getImageData(t,e,i,n)}},{key:"convertToBlob",value:function(t){throw new Error("暂未实现")}},{key:"transferToImageBitmap",value:function(){throw new Error("暂未实现")}},{key:"release",value:function(){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}])}();by.env="browser",function(t){t[t.Color255=0]="Color255",t[t.Color1=1]="Color1"}(gy||(gy={}));var xy=function(){function t(){r(this,t)}return o(t,null,[{key:"Get",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gy.Color1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0,1];if(i===gy.Color1){var r=t.store1[e];if(r)return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n;var a=Qn.parseColorString(e);if(a){var o=[a.r/255,a.g/255,a.b/255,a.opacity];t.store1[e]=o,t.store255[e]=[a.r,a.g,a.b,a.opacity],n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3]}return n}var s=t.store255[e];if(s)return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n;var l=Qn.parseColorString(e);return l&&(t.store1[e]=[l.r/255,l.g/255,l.b/255,l.opacity],t.store255[e]=[l.r,l.g,l.b,l.opacity],n[0]=l.r,n[1]=l.g,n[2]=l.b,n[3]=l.opacity),n}},{key:"Set",value:function(e,i,n){if(i===gy.Color1){if(t.store1[e])return;t.store1[e]=n,t.store255[e]=[Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]),Math.floor(255*n[3])]}else{if(t.store255[e])return;t.store255[e]=n,t.store1[e]=[n[0]/255,n[1]/255,n[2]/255,n[3]]}}}])}();function ky(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(t)&&$(t[0])?e?"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),",").concat(t[3].toFixed(2),")"):"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),")"):t}function Sy(t,e,i,n,r){return Array.isArray(t)&&!$(t[0])||Array.isArray(e)&&!$(e[0])?new Array(4).fill(0).map((function(r,a){var o,s;return Ay(Z(t)?null!==(o=t[a])&&void 0!==o?o:t[0]:t,Z(e)?null!==(s=e[a])&&void 0!==s?s:e[0]:e,i,n)})):Ay(t,e,i,n,r)}function Ay(t,e,i,n,r){if(!t||!e)return t&&ky(t)||e&&ky(e)||!1;var a,o,s=!1,l=!1;if(Array.isArray(t)?a=t:"string"==typeof t?a=xy.Get(t,gy.Color255):s=!0,Array.isArray(e)?o=e:"string"==typeof e?o=xy.Get(e,gy.Color255):l=!0,s!==l){var u=s?t:e,c=s?e:t,h=Object.assign(Object.assign({},u),{stops:u.stops.map((function(t){return Object.assign(Object.assign({},t),{color:ky(c)})}))});return s?Sy(u,h,i,n,r):Sy(h,u,i,n,r)}if(s){if(t.gradient===e.gradient){var d=t,p=e,f=d.stops,v=p.stops;if(f.length!==v.length)return!1;if("linear"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"linear",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Ty(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i);if("radial"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"radial",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,r0:t.r0+(e.r0-t.r0)*i,r1:t.r1+(e.r1-t.r1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Ty(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i);if("conical"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"conical",startAngle:t.startAngle+(e.startAngle-t.startAngle)*i,endAngle:t.endAngle+(e.endAngle-t.endAngle)*i,x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Ty(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i)}return!1}return r&&r(a,o),ky(function(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i,t[2]+(e[2]-t[2])*i,t[3]+(e[3]-t[3])*i]}(a,o,i),n)}function Cy(t,e,i){return"rgba(".concat(t[0]+(e[0]-t[0])*i,",").concat(t[1]+(e[1]-t[1])*i,",").concat(t[2]+(e[2]-t[2])*i,",").concat(t[3]+(e[3]-t[3])*i,")")}xy.store255={},xy.store1={};var My=[0,0,0,0],wy=[0,0,0,0];function Ty(t,e,i){return xy.Get(t,gy.Color255,My),xy.Get(e,gy.Color255,wy),"rgba(".concat(Math.round(My[0]+(wy[0]-My[0])*i),",").concat(Math.round(My[1]+(wy[1]-My[1])*i),",").concat(Math.round(My[2]+(wy[2]-My[2])*i),",").concat(My[3]+(wy[3]-My[3])*i,")")}var Dy=function(){function t(){r(this,t)}return o(t,null,[{key:"GetCanvas",value:function(){try{return t.canvas||(t.canvas=oh.global.createCanvas({})),t.canvas}catch(t){return null}}},{key:"GetCtx",value:function(){if(!t.ctx){var e=t.GetCanvas();t.ctx=e.getContext("2d")}return t.ctx}}])}(),Ey=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;r(this,e),(t=n(this,e)).cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},t.dataMap=new Map;var o=Dy.GetCanvas(),s=Dy.GetCtx();if(o.width=a,o.height=1,!s)return p(t);if(s.translate(0,0),!s)throw new Error("获取ctx发生错误");var l=s.createLinearGradient(0,0,a,0);return i.forEach((function(t){l.addColorStop(t[0],t[1])})),s.fillStyle=l,s.fillRect(0,0,a,1),t.rgbaSet=s.getImageData(0,0,a,1).data,t}return h(e,t),o(e,[{key:"getColor",value:function(t){var e=this.rgbaSet.slice(4*t,4*t+4);return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3]/255,")")}},{key:"GetOrCreate",value:function(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,s="".concat(t).concat(i).concat(n).concat(r);a.forEach((function(t){return s+=t.join()})),s+=o;var l=this.dataMap.get(s);return l||(l={data:new e(a,o),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(s,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}])}(Un),By=function(){function t(){r(this,t)}return o(t,null,[{key:"GetSize",value:function(e){for(var i=0;i<t.ImageSize.length;i++)if(t.ImageSize[i]>=e)return t.ImageSize[i];return e}},{key:"Get",value:function(e,i,n,r,a,o,s){var l=t.GenKey(e,i,n,r,a),u=t.cache[l];if(!u||0===u.length)return null;for(var c=0;c<u.length;c++)if(u[c].width>=o&&u[c].height>=s)return u[c].pattern;return null}},{key:"Set",value:function(e,i,n,r,a,o,s,l){var u=t.GenKey(e,i,n,r,a);t.cache[u]?t.cache[u].push({width:s,height:l,pattern:o}):t.cache[u]=[{width:s,height:l,pattern:o}]}},{key:"GenKey",value:function(t,e,i,n,r){return"".concat(e,",").concat(i,",").concat(n,",").concat(r,",").concat(t.join())}}])}();By.cache={},By.ImageSize=[20,40,80,160,320,640,1280,2560];var Py=new On,Ry=new Hn;new On;var Ly,Iy=["lineWidth","scaleX","scaleY","angle","anchor","visible"],Fy=["x","y"],Oy=["scaleX","scaleY"],zy=["angle"],Hy=new ki,Ny={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1},Uy=function(t){function e(){var t,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e))._AABBBounds=new On,t._updateTag=xh.INIT,t.attribute=a,t.valid=t.isValid(),t.updateAABBBoundsStamp=0,a.background?t.loadImage(null!==(i=a.background.background)&&void 0!==i?i:a.background,!0):a.shadowGraphic&&t.setShadowGraphic(a.shadowGraphic),t}return h(e,t),o(e,[{key:"AABBBounds",get:function(){return this.tryUpdateAABBBounds()}},{key:"OBBBounds",get:function(){return this.tryUpdateOBBBounds()}},{key:"globalAABBBounds",get:function(){return this.tryUpdateGlobalAABBBounds()}},{key:"transMatrix",get:function(){return this.tryUpdateLocalTransMatrix(!0)}},{key:"globalTransMatrix",get:function(){return this.tryUpdateGlobalTransMatrix(!0)}},{key:"getGraphicService",value:function(){var t,e;return null!==(e=null===(t=this.stage)||void 0===t?void 0:t.graphicService)&&void 0!==e?e:oh.graphicService}},{key:"getAttributes",value:function(){return this.attribute}},{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"getOffsetXY",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attribute,a=r.dx,o=void 0===a?t.dx:a,s=r.dy,l=void 0===s?t.dy:s;if(n&&this.parent){var u=this.parent.attribute;Hy.x=o+(null!==(e=u.scrollX)&&void 0!==e?e:0),Hy.y=l+(null!==(i=u.scrollY)&&void 0!==i?i:0)}else Hy.x=o,Hy.y=l;return Hy}},{key:"onAnimateBind",value:function(t){this._emitCustomEvent("animate-bind",t)}},{key:"tryUpdateAABBBounds",value:function(){var t="imprecise"===this.attribute.boundsMode;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),"empty"===this.attribute.boundsMode&&e.clear(),e}},{key:"tryUpdateOBBBounds",value:function(){return this._OBBBounds||(this._OBBBounds=new zn),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}},{key:"combindShadowAABBBounds",value:function(t){if(this.shadowRoot){var e=this.shadowRoot.AABBBounds.clone();t.union(e)}}},{key:"doUpdateOBBBounds",value:function(){return this._OBBBounds}},{key:"getClipPath",value:function(){var t=this.attribute.clipConfig;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);var e=t.shape,i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),(i=this.parsePath(e))&&this.clipPathMap.set(e,i)),i}},{key:"parsePath",value:function(t){if(!t)return null;var i,n=vg[t];if(n)return n;if(n=e.userSymbolMap[t])return n;if(!0===((i=t=gg[t]||t).startsWith("<svg")||i.startsWith("<?xml"))){var r=(new Mg).parse(t).svg;if(!r)return null;var a=Z(r.path)?r.path:[r.path];Py.clear();var o=[];a.forEach((function(t){var e=(new Md).fromString(t.d),i={};ty.forEach((function(e){t[e]&&(i[$g[e]]=t[e])})),o.push({path:e,attribute:i}),Py.union(e.bounds)}));var s=Py.width(),l=Py.height(),u=1/ai(s,l);o.forEach((function(t){return t.path.transform(0,0,u,u)}));var c=new fg(t,o,!0);return e.userSymbolMap[t]=c,c}var h=(new Md).fromString(t),d=h.bounds.width(),p=h.bounds.height(),f=1/ai(d,p);h.transform(0,0,f,f);var v=new fg(t,h);return e.userSymbolMap[t]=v,v}},{key:"doUpdateAABBBounds",value:function(t){this.updateAABBBoundsStamp++;var e=this.getGraphicTheme();this._AABBBounds.clear();var i=this.attribute,n=this.updateAABBBounds(i,e,this._AABBBounds,t),r=i.boundsPadding,a=void 0===r?e.boundsPadding:r,o=Lf(a);return o&&n.expand(o),this.clearUpdateBoundTag(),n}},{key:"updatePathProxyAABBBounds",value:function(t){var e="function"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;var i=new Th(t);return Fh(e.commandList,i,0,0),!0}},{key:"tryUpdateGlobalAABBBounds",value:function(){var t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}},{key:"tryUpdateGlobalTransMatrix",value:function(){if(this._globalTransMatrix){if(this.parent){var t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!0}},{key:"tryUpdateLocalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._transMatrix||(this._transMatrix=new Hn),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}},{key:"shouldUpdateAABBBounds",value:function(){return this.shadowRoot?(!!(this._updateTag&xh.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&xh.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}},{key:"shouldSelfChangeUpdateAABBBounds",value:function(){return this.shadowRoot?!!(this._updateTag&xh.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&xh.UPDATE_BOUNDS)}},{key:"shouldUpdateLocalMatrix",value:function(){return!!(this._updateTag&xh.UPDATE_LOCAL_MATRIX)}},{key:"isValid",value:function(){var t,e,i=this.attribute;return Number.isFinite((null!==(t=i.x)&&void 0!==t?t:0)+(null!==(e=i.y)&&void 0!==e?e:0))}},{key:"_validNumber",value:function(t){return null==t||Number.isFinite(t)}},{key:"shouldUpdateShape",value:function(){return!!(this._updateTag&xh.UPDATE_SHAPE)}},{key:"clearUpdateShapeTag",value:function(){this._updateTag&=xh.CLEAR_SHAPE}},{key:"containsPoint",value:function(t,e,i,n){if(!n)return!1;if(i===kh.GLOBAL){var r=new ki(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),t=r.x,e=r.y}return n.containsPoint(this,{x:t,y:e})}},{key:"setWidthHeightWithoutTransform",value:function(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}},{key:"setAttributesAndPreventAnimate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.setAttributes(t,e,i),this.animates&&this.animates.forEach((function(e){(e.priority!==1/0||n)&&Object.keys(t).forEach((function(t){e.preventAttr(t)}))}))}},{key:"setAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;t&&((t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i))}},{key:"_setAttributes",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=Object.keys(t),r=0;r<n.length;r++){var a=n[r];this.attribute[a]=t[a]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}},{key:"setAttribute",value:function(t,e,i,n){var r,a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(l({},t,e),this.attribute,t,n);a?this._setAttributes(a,i,n):j(null===(r=this.normalAttrs)||void 0===r?void 0:r[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}},{key:"needUpdateTags",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Iy,i=0;i<e.length;i++){var n=e[i];if(-1!==t.indexOf(n))return!0}return!1}},{key:"needUpdateTag",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Iy,i=0;i<e.length;i++)if(t===e[i])return!0;return!1}},{key:"initAttributes",value:function(t){var e={type:Sh.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=xh.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}},{key:"translate",value:function(t,e){var i,n;if(0===t&&0===e)return this;var r={type:Sh.TRANSLATE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,Fy,r);a&&(t=a.x,e=a.y,delete a.x,delete a.y,this._setAttributes(a));var o=this.attribute,s=o.postMatrix;return s?oh.transformUtil.fromMatrix(s,s).translate(t,e):(o.x=(null!==(i=o.x)&&void 0!==i?i:Dd.x)+t,o.y=(null!==(n=o.y)&&void 0!==n?n:Dd.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}},{key:"translateTo",value:function(t,e){var i=this.attribute;if(i.x===t&&i.y===e)return this;var n={type:Sh.TRANSLATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,Fy,n);return r?(this._setAttributes(r,!1,n),this):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"scale",value:function(t,e,i){var n,r;if(1===t&&1===e)return this;var a={type:Sh.SCALE},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,Oy,a);o&&(t=o.scaleX,e=o.scaleY,delete o.scaleX,delete o.scaleY,this._setAttributes(o));var s=this.attribute;if(i){var l=this.attribute.postMatrix;l||(l=new Hn,s.postMatrix=l),oh.transformUtil.fromMatrix(l,l).scale(t,e,i)}else s.scaleX=(null!==(n=s.scaleX)&&void 0!==n?n:Dd.scaleX)*t,s.scaleY=(null!==(r=s.scaleY)&&void 0!==r?r:Dd.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(a),this}},{key:"scaleTo",value:function(t,e){var i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;var n={type:Sh.SCALE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,Oy,n);return r?(this._setAttributes(r,!1,n),this):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"rotate",value:function(t,e){var i;if(0===t)return this;var n={type:Sh.ROTATE},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,zy,n);r&&(delete r.angle,this._setAttributes(r,!1,n));var a=this.attribute;if(e){var o=this.attribute.postMatrix;o||(o=new Hn,a.postMatrix=o),oh.transformUtil.fromMatrix(o,o).rotate(t,e)}else a.angle=(null!==(i=a.angle)&&void 0!==i?i:Dd.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}},{key:"rotateTo",value:function(t){var e=this.attribute;if(e.angle===t)return this;var i={type:Sh.ROTATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,zy,i);return n?(this._setAttributes(n,!1,i),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i),this)}},{key:"skewTo",value:function(t,e){return this}},{key:"onAttributeUpdate",value:function(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}},{key:"update",value:function(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}},{key:"hasState",value:function(t){return!(!this.currentStates||!this.currentStates.length)&&(!!j(t)||this.currentStates.includes(t))}},{key:"getState",value:function(t){var e;return null===(e=this.states)||void 0===e?void 0:e[t]}},{key:"applyStateAttrs",value:function(t,e,i,n){var r,a,o=this;if(i){var s,l=Object.keys(t),u=this.getNoWorkAnimateAttr(),c={};l.forEach((function(e){u[e]?(s||(s={}),s[e]=t[e]):c[e]=n&&void 0===t[e]?o.getDefaultAttribute(e):t[e]}));var h=null!==(a=null!==(r=this.context&&this.context.stateAnimateConfig)&&void 0!==r?r:this.stateAnimateConfig)&&void 0!==a?a:ey;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:c,duration:h.duration,easing:h.easing}}]),s&&this.setAttributesAndPreventAnimate(s,!1,{type:Sh.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t)}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:Sh.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:Sh.STATE})}},{key:"updateNormalAttrs",value:function(t){var e=this,i={};this.normalAttrs?(Object.keys(t).forEach((function(t){t in e.normalAttrs?(i[t]=e.normalAttrs[t],delete e.normalAttrs[t]):i[t]=e.getNormalAttribute(t)})),Object.keys(this.normalAttrs).forEach((function(i){t[i]=e.normalAttrs[i]}))):Object.keys(t).forEach((function(t){i[t]=e.getNormalAttribute(t)})),this.normalAttrs=i}},{key:"stopStateAnimates",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end";this.animates&&this.animates.forEach((function(i){i.stateNames&&(i.stop(e),t.animates.delete(i.id))}))}},{key:"getNormalAttribute",value:function(t){var e,i,n=this.attribute[t];return this.animates&&this.animates.size?null===(e=this.finalAttribute)||void 0===e?void 0:e[t]:null!=n?n:null===(i=this.finalAttribute)||void 0===i?void 0:i[t]}},{key:"clearStates",value:function(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"removeState",value:function(t,e){if(this.currentStates){var i=Z(t)?function(e){return!t.includes(e)}:function(e){return e!==t},n=this.currentStates.filter(i);n.length!==this.currentStates.length&&this.useStates(n,e)}}},{key:"toggleState",value:function(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){var i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}},{key:"addState",value:function(t,e,i){var n;if(!this.currentStates||!this.currentStates.includes(t)||!e&&1!==this.currentStates.length){var r=e&&(null===(n=this.currentStates)||void 0===n?void 0:n.length)?this.currentStates.concat([t]):[t];this.useStates(r,i)}}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){var r={};t.forEach((function(e){var i,a=n.stateProxy?n.stateProxy(e,t):null===(i=n.states)||void 0===i?void 0:i[e];a&&Object.assign(r,a)})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=xh.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"addUpdateShapeTag",value:function(){this._updateTag|=xh.UPDATE_SHAPE}},{key:"addUpdateShapeAndBoundsTag",value:function(){this._updateTag|=xh.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"updateShapeAndBoundsTagSetted",value:function(){return(this._updateTag&xh.UPDATE_SHAPE_AND_BOUNDS)===xh.UPDATE_SHAPE_AND_BOUNDS}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=xh.CLEAR_BOUNDS}},{key:"addUpdatePositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=xh.UPDATE_GLOBAL_LOCAL_MATRIX}},{key:"addUpdateGlobalPositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=xh.UPDATE_GLOBAL_MATRIX}},{key:"clearUpdateLocalPositionTag",value:function(){this._updateTag&=xh.CLEAR_LOCAL_MATRIX}},{key:"clearUpdateGlobalPositionTag",value:function(){this._updateTag&=xh.CLEAR_GLOBAL_MATRIX}},{key:"addUpdateLayoutTag",value:function(){this._updateTag|=xh.UPDATE_LAYOUT}},{key:"clearUpdateLayoutTag",value:function(){this._updateTag&=xh.CLEAR_LAYOUT}},{key:"needUpdateLayout",value:function(){return!!(this._updateTag&xh.UPDATE_LAYOUT)}},{key:"getAnchor",value:function(t,e,i){var n=this,r=[0,0],a=function(){if(e.b)return e.b;var t=n.clone();return t.attribute.angle=0,t.attribute.scaleCenter=null,i&&(t.attribute.scaleX=1,t.attribute.scaleY=1),e.b=t.AABBBounds,e.b};if("string"==typeof t[0]){var o=parseFloat(t[0])/100,s=a();r[0]=s.x1+(s.x2-s.x1)*o}else r[0]=t[0];if("string"==typeof t[1]){var l=parseFloat(t[1])/100,u=a();r[1]=u.y1+(u.y2-u.y1)*l}else r[1]=t[1];return r}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,e=t.x,i=void 0===e?Dd.x:e,n=t.y,r=void 0===n?Dd.y:n,a=t.scaleX,o=void 0===a?Dd.scaleX:a,s=t.scaleY,l=void 0===s?Dd.scaleY:s,u=t.angle,c=void 0===u?Dd.angle:u,h=t.scaleCenter,d=t.anchor,p=t.postMatrix,f=[0,0],v={};if(d&&c&&(f=this.getAnchor(d,v)),!h||1===o&&1===l)Nn(this._transMatrix,this._transMatrix.reset(),i,r,o,l,c,d&&f);else{var g=this._transMatrix;g.reset(),g.translate(f[0],f[1]),g.rotate(c),g.translate(-f[0],-f[1]),g.translate(i,r),f=this.getAnchor(h,v,!0),oh.transformUtil.fromMatrix(g,g).scale(o,l,{x:f[0],y:f[1]})}var y=this.getOffsetXY(Dd);if(this._transMatrix.e+=y.x,this._transMatrix.f+=y.y,p){var m=Ry.setValue(p.a,p.b,p.c,p.d,p.e,p.f),_=this._transMatrix;m.multiply(_.a,_.b,_.c,_.d,_.e,_.f),_.setValue(m.a,m.b,m.c,m.d,m.e,m.f)}}},{key:"doUpdateGlobalMatrix",value:function(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);var t=this.parent.attribute,e=t.scrollX,i=void 0===e?0:e,n=t.scrollY,r=void 0===n?0:n;this._globalTransMatrix.translate(i,r)}}},{key:"setStage",value:function(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){var i=t.getTimeline();this.animates.forEach((function(t){t.timeline.isGlobal&&(t.setTimeline(i),i.addAnimate(t))}))}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}},{key:"setStageToShadowRoot",value:function(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}},{key:"onAddStep",value:function(t){}},{key:"onStop",value:function(t){t&&this.setAttributes(t,!1,{type:Sh.ANIMATE_END})}},{key:"getDefaultAttribute",value:function(t){return this.getGraphicTheme()[t]}},{key:"getComputedAttribute",value:function(t){var e;return null!==(e=this.attribute[t])&&void 0!==e?e:this.getDefaultAttribute(t)}},{key:"onSetStage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._onSetStage=t,e&&this.stage&&t(this,this.stage)}},{key:"attachShadow",value:function(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:oh.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}},{key:"detachShadow",value:function(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}},{key:"toJson",value:function(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map((function(t){return t.toJson()}))}}},{key:"createPathProxy",value:function(t){return q(t,!0)?this.pathProxy=(new Md).fromString(t):this.pathProxy=new Md,this.pathProxy}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(!t||e&&function(t){return!(!t.fill&&!t.stroke)}(t))){var i=t;this.resources||(this.resources=new Map);var n={data:"init",state:null};this.resources.set(i,n),"string"==typeof t?(n.state="loading",t.startsWith("<svg")?(Ef.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(nt(t)||t.includes("/")||at(t))&&(Ef.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):G(t)?(n.state="success",n.data=t,this.backgroundImg=this.backgroundImg||e):n.state="fail"}}},{key:"setShadowGraphic",value:function(t){t?this.attachShadow().add(t):this.detachShadow()}},{key:"imageLoadSuccess",value:function(t,e,i){if(this.resources){var n=this.resources.get(t);n&&(n.state="success",n.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}}},{key:"imageLoadFail",value:function(t,e){if(this.resources){var i=this.resources.get(t);i&&(i.state="fail",e&&e())}}},{key:"_stopAnimates",value:function(t){t&&t.forEach((function(t){t.stop()}))}},{key:"stopAnimates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren((function(e){e.stopAnimates(t)}))}},{key:"release",value:function(){this.releaseStatus="released",this.stopAnimates(),oh.graphicService.onRelease(this)}},{key:"_emitCustomEvent",value:function(t,e){var i,n;if(this._events&&t in this._events){var r=new kf(t,e);r.bubbles=!1,r.manager=null===(n=null===(i=this.stage)||void 0===i?void 0:i.eventSystem)||void 0===n?void 0:n.manager,this.dispatchEvent(r)}}},{key:"toCustomPath",value:function(){var t,e,i,n=null===(i=null===(e=(null===(t=this.stage)||void 0===t?void 0:t.renderService)||oh.renderService)||void 0===e?void 0:e.drawContribution)||void 0===i?void 0:i.getRenderContribution(this);if(n){var r=new vy(null,1);return n.drawShape(this,r,0,0,{},{}),r.path}return null}}],[{key:"mixin",value:function(t){for(var i=Object.keys(t),n=0;n<i.length;++n){var r=i[n];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}}])}(yf);Uy.userSymbolMap={},Uy.mixin(wf),function(t){t[t.LESS_GROUP=0]="LESS_GROUP",t[t.MORE_GROUP=1]="MORE_GROUP"}(Ly||(Ly={}));var jy=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="group",i.parent=null,i.isContainer=!0,i.numberType=Ng,i._childUpdateTag=xh.UPDATE_BOUNDS,i}return h(e,t),o(e,[{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"setTheme",value:function(t){return this.theme||(this.theme=new pf),this.theme.setTheme(t,this)}},{key:"createTheme",value:function(){this.theme||(this.theme=new pf)}},{key:"visibleAll",value:function(t){this.setAttribute("visible",t),this.forEachChildren((function(e){e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)}))}},{key:"hideAll",value:function(){this.visibleAll(!1)}},{key:"showAll",value:function(){this.visibleAll(!0)}},{key:"containsPoint",value:function(t,e,i){if(i===kh.GLOBAL){var n=new ki(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(n,n),this.AABBBounds.contains(n.x,n.y)}return this.AABBBounds.contains(t,e)}},{key:"shouldUpdateAABBBounds",value:function(){return!!_(e,"shouldUpdateAABBBounds",this,3)([])||!!(this._childUpdateTag&xh.UPDATE_BOUNDS)}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),"empty"===this.attribute.boundsMode&&e.clear(),e}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,i=t.x,n=void 0===i?Dd.x:i,r=t.y,a=void 0===r?Dd.y:r,o=t.dx,s=void 0===o?Dd.dx:o,l=t.dy,u=void 0===l?Dd.dy:l,c=t.scaleX,h=void 0===c?Dd.scaleX:c,d=t.scaleY,p=void 0===d?Dd.scaleY:d,f=t.angle,v=void 0===f?Dd.angle:f,g=t.postMatrix;if(0!==n||0!==a||0!==s||0!==u||1!==h||1!==p||0!==v||g)return _(e,"doUpdateLocalMatrix",this,3)([]);this._transMatrix.reset()}},{key:"getGraphicTheme",value:function(){return vf(this).group}},{key:"updateAABBBounds",value:function(t,e,i){var n=i;i=i.clone();var r=t.width,a=t.height,o=t.path,s=t.clip,l=void 0===s?e.clip:s;if(o&&o.length?o.forEach((function(t){i.union(t.AABBBounds)})):null!=r&&null!=a&&i.set(0,0,Math.max(0,r),Math.max(0,a)),!l){this.forEachChildren((function(t){i.union(t.AABBBounds)}));var u=t.scrollX,c=void 0===u?0:u,h=t.scrollY,d=void 0===h?0:h;i.translate(c,d)}return oh.graphicService.updateTempAABBBounds(i),oh.graphicService.transformAABBBounds(t,i,e,!1,this),n.copy(i),n}},{key:"doUpdateAABBBounds",value:function(){this.updateAABBBoundsStamp++;var t=_(e,"doUpdateAABBBounds",this,3)([]);return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=xh.CLEAR_BOUNDS,this._childUpdateTag&=xh.CLEAR_BOUNDS}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=xh.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}},{key:"addChildUpdateBoundTag",value:function(){this._childUpdateTag&xh.UPDATE_BOUNDS||(this._childUpdateTag|=xh.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}},{key:"getTheme",value:function(){return this.theme.getTheme(this)}},{key:"incrementalAppendChild",value:function(t){var i=_(e,"appendChild",this,3)([t]);return this.stage&&i&&(i.stage=this.stage,i.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),i}},{key:"incrementalClearChild",value:function(){_(e,"removeAllChild",this,3)([]),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}},{key:"_updateChildToStage",value:function(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}},{key:"appendChild",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=_(e,"appendChild",this,3)([t]);return i&&this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"insertBefore",value:function(t,i){return this._updateChildToStage(_(e,"insertBefore",this,3)([t,i]))}},{key:"insertAfter",value:function(t,i){return this._updateChildToStage(_(e,"insertAfter",this,3)([t,i]))}},{key:"insertInto",value:function(t,i){return this._updateChildToStage(_(e,"insertInto",this,3)([t,i]))}},{key:"removeChild",value:function(t){var i=_(e,"removeChild",this,3)([t]);return this.getGraphicService().onRemove(t),t.stage=null,this.addUpdateBoundTag(),i}},{key:"removeAllChild",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.forEachChildren((function(e){t.getGraphicService().onRemove(e),i&&e.isContainer&&e.removeAllChild(i)})),_(e,"removeAllChild",this,3)([]),this.addUpdateBoundTag()}},{key:"setStage",value:function(t,e){var i=this;this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren((function(e){e.setStage(t,i.layer)})))}},{key:"addUpdatePositionTag",value:function(){_(e,"addUpdatePositionTag",this,3)([]),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"addUpdateGlobalPositionTag",value:function(){_(e,"addUpdateGlobalPositionTag",this,3)([]),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){var e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!!(this._updateTag&xh.UPDATE_GLOBAL_MATRIX)}},{key:"_getChildByName",value:function(t,e){return this.find((function(e){return e.name===t}),e)}},{key:"createOrUpdateChild",value:function(t,e,i){var n=this._getChildByName(t);return n?n.setAttributes(e):((n=oh.graphicService.creator[i](e)).name=t,this.add(n)),n}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}},{key:"release",value:function(t){t&&this.forEachChildren((function(e){e.release(t)})),_(e,"release",this,3)([])}}])}(Uy);function Vy(t){return new jy(t)}jy.NOWORK_ANIMATE_ATTR=Ny;var Wy,Gy=function(t){function e(t,a,o,s){var l,u;return r(this,e),(l=n(this,e,[{}])).stage=t,l.global=a,l.window=o,l.main=s.main,l.layerHandler=s.layerHandler,l.layerHandler.init(i(l),o,{main:s.main,canvasId:s.canvasId,width:l.viewWidth,height:l.viewHeight,zIndex:null!==(u=s.zIndex)&&void 0!==u?u:0}),l.layer=i(l),l.subLayers=new Map,l.theme=new pf,l.background="rgba(0, 0, 0, 0)",l.afterDrawCbs=[],l}return h(e,t),o(e,[{key:"offscreen",get:function(){return this.layerHandler.offscreen}},{key:"layerMode",get:function(){return this.layerHandler.type}},{key:"width",get:function(){return this.stage?this.stage.width:0}},{key:"height",get:function(){return this.stage?this.stage.height:0}},{key:"viewWidth",get:function(){return this.stage?this.stage.viewWidth:0}},{key:"viewHeight",get:function(){return this.stage?this.stage.viewHeight:0}},{key:"dirtyBound",get:function(){throw new Error("暂不支持")}},{key:"dpr",get:function(){return this._dpr}},{key:"combineSubLayer",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=Array.from(this.subLayers.values()).sort((function(t,e){return t.zIndex-e.zIndex}));this.layerHandler.merge(i.map((function(t){return t.layer.subLayers.size&&t.layer.combineSubLayer(e),t.layer.getNativeHandler()}))),e&&i.forEach((function(t){t.group&&(t.group.incremental=0)})),i.forEach((function(e){oh.layerService.releaseLayer(t.stage,e.layer)})),this.subLayers.clear()}},{key:"getNativeHandler",value:function(){return this.layerHandler}},{key:"setStage",value:function(t,i){_(e,"setStage",this,3)([t,this])}},{key:"pick",value:function(t,e){throw new Error("暂不支持")}},{key:"tryRenderSecondaryLayer",value:function(t,e){var i=this;this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach((function(n){n.layer.renderCount=i.renderCount,n.layer.render(t,e)}))}},{key:"render",value:function(t,e){var i,n=this;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!==(i=t.background)&&void 0!==i?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach((function(t){return t(n)})),this.tryRenderSecondaryLayer(t,e)}},{key:"resize",value:function(t,e){this.layerHandler.resize(t,e)}},{key:"resizeView",value:function(t,e){this.layerHandler.resizeView(t,e)}},{key:"setDpr",value:function(t){this.layerHandler.setDpr(t)}},{key:"afterDraw",value:function(t){this.afterDrawCbs.push(t)}},{key:"startAnimate",value:function(t){throw new Error("暂不支持")}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"prepare",value:function(t,e){}},{key:"release",value:function(){var t=this;_(e,"release",this,3)([]),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach((function(e){oh.layerService.releaseLayer(t.stage,e.layer)}))}},{key:"drawTo",value:function(t,e){var i,n=this;this.layerHandler.drawTo(t,[this],Object.assign({background:null!==(i=e.background)&&void 0!==i?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach((function(t){return t(n)}))}}])}(jy),Yy=Symbol.for("TransformUtil"),Xy=Symbol.for("GraphicUtil"),Ky=Symbol.for("LayerService"),qy=Symbol.for("StaticLayerHandlerContribution"),Zy=Symbol.for("DynamicLayerHandlerContribution"),Jy=Symbol.for("VirtualLayerHandlerContribution"),Qy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$y=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},tm=Wy=function(){return o((function t(){r(this,t),this.layerMap=new Map,this.global=oh.global}),[{key:"tryInit",value:function(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}},{key:"getStageLayer",value:function(t){return this.layerMap.get(t)}},{key:"getRecommendedLayerType",value:function(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}},{key:"getLayerHandler",value:function(t){return"static"===t?rh.get(qy):"dynamic"===t?rh.get(Zy):rh.get(Jy)}},{key:"createLayer",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{main:!1};this.tryInit();var n=this.getRecommendedLayerType(i.layerMode);n=i.main||i.canvasId?"static":n;var r=this.getLayerHandler(n),a=new Gy(t,this.global,t.window,Object.assign(Object.assign({main:!1},i),{layerMode:n,canvasId:null!==(e=i.canvasId)&&void 0!==e?e:Wy.GenerateLayerId(),layerHandler:r})),o=this.layerMap.get(t)||[];return o.push(a),this.layerMap.set(t,o),this.staticLayerCountInEnv--,a}},{key:"prepareStageLayer",value:function(t){var e;t.forEachChildren((function(t){var i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]}))}},{key:"releaseLayer",value:function(t,e){e.release();var i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter((function(t){return t!==e})))}},{key:"layerCount",value:function(t){return(this.layerMap.get(t)||[]).length}},{key:"restLayerCount",value:function(t){return"browser"===this.global.env?10:0}},{key:"releaseStage",value:function(t){this.layerMap.delete(t)}}],[{key:"GenerateLayerId",value:function(){return"".concat(Wy.idprefix,"_").concat(Wy.prefix_count++)}}])}();tm.idprefix="visactor_layer",tm.prefix_count=0,tm=Wy=Qy([Dc(),$y("design:paramtypes",[])],tm);var em=new gc((function(t){t(nh).to(fh).inSingletonScope(),t(Qp).to(tf),t(Xy).to(of).inSingletonScope(),t(Yy).to(lf).inSingletonScope(),t(Ky).to(tm).inSingletonScope()}));function im(t,e){return!(!t&&!e)}function nm(t,e){return(Z(t)?t.some((function(t){return t||void 0===t})):!!t)&&e>0}function rm(t,e,i){return i&&t*e>0}function am(t,e,i,n,r){return r&&t*e>0&&0!==i&&0!==n}function om(t,e){return t*e>0}function sm(t,e,i,n,r){return r?t*e>0:t*e>0&&0!==i&&0!==n}function lm(t,e,i,n,r,a,o){var s=t-i,l=e-n,u=(o?a:-a)/Math.sqrt(s*s+l*l),c=u*l,h=-u*s,d=t+c,p=e+h,f=i+c,v=n+h,g=(d+f)/2,y=(p+v)/2,m=f-d,_=v-p,b=m*m+_*_,x=r-a,k=d*v-f*p,S=(_<0?-1:1)*Math.sqrt(Math.max(0,x*x*b-k*k)),A=(k*_-m*S)/b,C=(-k*m-_*S)/b,M=(k*_+m*S)/b,w=(-k*m+_*S)/b,T=A-g,D=C-y,E=M-g,B=w-y;return T*T+D*D>E*E+B*B&&(A=M,C=w),{cx:A,cy:C,x01:-c,y01:-h,x11:A*(r/x-1),y11:C*(r/x-1)}}function um(t,e,i,n,r){var a,o,s,l,u=ii(i-e),c=t.getParsedCornerRadius(),h=Z(c),d=t.getParsePadAngle(e,i),p=d.outerDeltaAngle,f=d.innerDeltaAngle,v=d.outerStartAngle,g=d.outerEndAngle,y=d.innerEndAngle,m=d.innerStartAngle,_=h?c[0]:c,b=h?c[1]:c,x=h?c[2]:c,k=h?c[3]:c,S=Math.max(b,_),A=Math.max(x,k),C=S,M=A,w=r*ri(v),T=r*si(v),D=n*ri(y),E=n*si(y);if((A>Je||S>Je)&&(a=r*ri(g),o=r*si(g),s=n*ri(m),l=n*si(m),u<Qe)){var B=function(t,e,i,n,r,a,o,s){var l=i-t,u=n-e,c=o-r,h=s-a,d=h*l-c*u;return d*d<Je?[]:[t+(d=(c*(e-a)-h*(t-r))/d)*l,e+d*u]}(w,T,s,l,a,o,D,E);if(B){var P=w-B[0],R=T-B[1],L=a-B[0],I=o-B[1],F=1/si(ci((P*L+R*I)/(li(P*P+R*R)*li(L*L+I*I)))/2),O=li(B[0]*B[0]+B[1]*B[1]);M=oi(A,(n-O)/(F-1)),C=oi(S,(r-O)/(F+1))}}return{outerDeltaAngle:p,xors:w,yors:T,xirs:s,yirs:l,xore:a,yore:o,xire:D,yire:E,limitedOcr:C,limitedIcr:M,outerCornerRadiusStart:_,outerCornerRadiusEnd:b,maxOuterCornerRadius:S,maxInnerCornerRadius:A,outerStartAngle:v,outerEndAngle:g,innerDeltaAngle:f,innerEndAngle:y,innerStartAngle:m,innerCornerRadiusStart:k,innerCornerRadiusEnd:x}}function cm(t,e,i,n,r,a,o){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=ii(u-l),h=u>l,d=!1;if(r<a){var p=r;r=a,a=p}if(r<=Je)e.moveTo(i,n);else if(c>=ei-Je)e.moveTo(i+r*ri(l),n+r*si(l)),e.arc(i,n,r,l,u,!h),a>Je&&(e.moveTo(i+a*ri(u),n+a*si(u)),e.arc(i,n,a,u,l,h));else{var f=um(t,l,u,a,r),v=f.outerDeltaAngle,g=f.xors,y=f.yors,m=f.xirs,_=f.yirs,b=f.limitedOcr,x=f.outerCornerRadiusStart,k=f.outerCornerRadiusEnd,S=f.maxOuterCornerRadius,A=f.xore,C=f.yore,M=f.xire,w=f.yire,T=f.outerStartAngle,D=f.outerEndAngle,E=f.limitedIcr,B=f.innerDeltaAngle,P=f.innerEndAngle,R=f.innerStartAngle,L=f.innerCornerRadiusStart,I=f.innerCornerRadiusEnd,F=f.maxInnerCornerRadius;if(v<.001)o&&(o[3]||o[1])&&e.moveTo(i+g,n+y),d=!0;else if(b>Je){var O=oi(x,b),z=oi(k,b),H=lm(m,_,g,y,r,O,Number(h)),N=lm(A,C,M,w,r,z,Number(h));b<S&&O===z?!o||o[0]?(e.moveTo(i+H.cx+H.x01,n+H.cy+H.y01),e.arc(i+H.cx,n+H.cy,b,ni(H.y01,H.x01),ni(N.y01,N.x01),!h)):e.moveTo(i+H.cx+b*ri(ni(N.y01,N.x01)),n+H.cy+b*si(ni(N.y01,N.x01))):!o||o[0]?(e.moveTo(i+H.cx+H.x01,n+H.cy+H.y01),O>0&&e.arc(i+H.cx,n+H.cy,O,ni(H.y01,H.x01),ni(H.y11,H.x11),!h),e.arc(i,n,r,ni(H.cy+H.y11,H.cx+H.x11),ni(N.cy+N.y11,N.cx+N.x11),!h),z>0&&e.arc(i+N.cx,n+N.cy,z,ni(N.y11,N.x11),ni(N.y01,N.x01),!h)):z>0?e.moveTo(i+N.cx+z*ri(ni(N.y01,N.x01)),n+N.cy+z*si(ni(N.y01,N.x01))):e.moveTo(i+A,n+r*si(D))}else!o||o[0]?(e.moveTo(i+g,n+y),e.arc(i,n,r,T,D,!h)):e.moveTo(i+r*ri(D),n+r*si(D));if(!(a>Je)||B<.001)!o||o[1]?e.lineTo(i+M,n+w):e.moveTo(i+M,n+w),d=!0;else if(E>Je){var U=oi(L,E),j=oi(I,E),V=lm(M,w,A,C,a,-j,Number(h)),W=lm(g,y,m,_,a,-U,Number(h));if(!o||o[1]?e.lineTo(i+V.cx+V.x01,n+V.cy+V.y01):e.moveTo(i+V.cx+V.x01,n+V.cy+V.y01),E<F&&U===j){var G=ni(W.y01,W.x01);!o||o[2]?e.arc(i+V.cx,n+V.cy,E,ni(V.y01,V.x01),G,!h):e.moveTo(i+V.cx+ri(G),n+V.cy+si(G))}else!o||o[2]?(j>0&&e.arc(i+V.cx,n+V.cy,j,ni(V.y01,V.x01),ni(V.y11,V.x11),!h),e.arc(i,n,a,ni(V.cy+V.y11,V.cx+V.x11),ni(W.cy+W.y11,W.cx+W.x11),h),U>0&&e.arc(i+W.cx,n+W.cy,U,ni(W.y11,W.x11),ni(W.y01,W.x01),!h)):U>0?e.moveTo(i+W.cx+U*ri(ni(W.y01,W.x01)),n+W.cy+U*si(ni(W.y01,W.x01))):e.moveTo(i+m,n+_)}else!o||o[1]?e.lineTo(i+M,n+w):e.moveTo(i+M,n+w),!o||o[2]?e.arc(i,n,a,P,R,h):e.moveTo(i+a*ri(R),n+a*si(R))}return o?o[3]&&e.lineTo(i+r*ri(l),n+r*si(l)):e.closePath(),d}var hm=Symbol.for("ArcRenderContribution"),dm=Symbol.for("AreaRenderContribution"),pm=Symbol.for("CircleRenderContribution"),fm=Symbol.for("GroupRenderContribution"),vm=Symbol.for("ImageRenderContribution"),gm=Symbol.for("PathRenderContribution"),ym=Symbol.for("PolygonRenderContribution"),mm=Symbol.for("RectRenderContribution"),_m=Symbol.for("SymbolRenderContribution"),bm=Symbol.for("TextRenderContribution"),xm=Symbol.for("InteractiveSubRenderContribution");function km(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function Sm(t,e,i){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}var Am=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Cm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Mm=function(t,e){return function(i,n){e(i,n,t)}};function wm(t,e,i){var n,r=e.attribute,a=r.x,o=void 0===a?i.x:a,s=r.y,l=void 0===s?i.y:s,u=r.z,c=void 0===u?i.z:u,h=r.dx,d=void 0===h?i.dx:h,p=r.dy,f=void 0===p?i.dy:p,v=r.dz,g=void 0===v?i.dz:v,y=r.scaleX,m=void 0===y?i.scaleX:y,_=r.scaleY,b=void 0===_?i.scaleY:_,x=r.scaleZ,k=void 0===x?i.scaleZ:x,S=r.alpha,A=void 0===S?i.alpha:S,C=r.beta,M=void 0===C?i.beta:C,w=r.angle,T=void 0===w?i.angle:w,D=r.anchor3d,E=void 0===D?e.attribute.anchor:D,B=r.anchor,P=[0,0,0];if(E){if("string"==typeof E[0]){var R=parseFloat(E[0])/100,L=e.AABBBounds;P[0]=L.x1+(L.x2-L.x1)*R}else P[0]=E[0];if("string"==typeof E[1]){var I=parseFloat(E[1])/100,F=e.AABBBounds;P[1]=F.x1+(F.x2-F.x1)*I}else P[1]=E[1];P[2]=null!==(n=E[2])&&void 0!==n?n:0}if(iy(t),ny(t,t,[o+d,l+f,c+g]),ny(t,t,[P[0],P[1],P[2]]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+u*n,t[5]=o*r+c*n,t[6]=s*r+h*n,t[7]=l*r+d*n,t[8]=u*r-a*n,t[9]=c*r-o*n,t[10]=h*r-s*n,t[11]=d*r-l*n}(t,t,M),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-u*n,t[1]=o*r-c*n,t[2]=s*r-h*n,t[3]=l*r-d*n,t[8]=a*n+u*r,t[9]=o*n+c*r,t[10]=s*n+h*r,t[11]=l*n+d*r}(t,t,A),ny(t,t,[-P[0],-P[1],P[2]]),function(t,e,i){var n=i[0],r=i[1],a=i[2];t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,[m,b,k]),T){var O=cy.allocate(),z=[0,0];if(B){if("string"==typeof E[0]){var H=parseFloat(E[0])/100,N=e.AABBBounds;z[0]=N.x1+(N.x2-N.x1)*H}else z[0]=E[0];if("string"==typeof E[1]){var U=parseFloat(E[1])/100,j=e.AABBBounds;z[1]=j.x1+(j.x2-j.x1)*U}else z[1]=E[1]}ny(O,O,[z[0],z[1],0]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+u*n,t[1]=o*r+c*n,t[2]=s*r+h*n,t[3]=l*r+d*n,t[4]=u*r-a*n,t[5]=c*r-o*n,t[6]=h*r-s*n,t[7]=d*r-l*n}(O,O,T),ny(O,O,[-z[0],-z[1],0]),ay(t,t,O)}}var Tm=function(){return o((function t(e){r(this,t),this.creator=e,this.hooks={onAttributeUpdate:new eh(["graphic"]),onSetStage:new eh(["graphic","stage"]),onRemove:new eh(["graphic"]),onRelease:new eh(["graphic"]),onAddIncremental:new eh(["graphic","group","stage"]),onClearIncremental:new eh(["graphic","group","stage"]),beforeUpdateAABBBounds:new eh(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new eh(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new eh(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new On,this.tempAABBBounds2=new On}),[{key:"onAttributeUpdate",value:function(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}},{key:"onSetStage",value:function(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}},{key:"onRemove",value:function(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}},{key:"onRelease",value:function(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}},{key:"onAddIncremental",value:function(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}},{key:"onClearIncremental",value:function(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}},{key:"beforeUpdateAABBBounds",value:function(t,e,i,n){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,n)}},{key:"afterUpdateAABBBounds",value:function(t,e,i,n,r){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,n,r)}},{key:"clearAABBBounds",value:function(t,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(t,e,i)}},{key:"updatePathProxyAABBBounds",value:function(t,e){var i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;var n=new Th(t);return Fh(i.commandList,n,0,0),!0}},{key:"updateHTMLTextAABBBounds",value:function(t,e,i,n){var r=t.textAlign,a=t.textBaseline;if(null!=t.forceBoundsHeight){var o=$(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),s=Sm(a,o,o);i.set(i.x1,s,i.x2,s+o)}if(null!=t.forceBoundsWidth){var l=$(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),u=km(r,l);i.set(u,i.y1,u+l,i.y2)}}},{key:"combindShadowAABBBounds",value:function(t,e){if(e&&e.shadowRoot){var i=e.shadowRoot.AABBBounds;t.union(i)}}},{key:"transformAABBBounds",value:function(t,e,i,n,r){if(!e.empty()){var a=t.scaleX,o=void 0===a?i.scaleX:a,s=t.scaleY,l=void 0===s?i.scaleY:s,u=t.stroke,c=void 0===u?i.stroke:u,h=t.shadowBlur,d=void 0===h?i.shadowBlur:h,p=t.lineWidth,f=void 0===p?i.lineWidth:p,v=t.pickStrokeBuffer,g=void 0===v?i.pickStrokeBuffer:v,y=t.strokeBoundsBuffer,m=void 0===y?i.strokeBoundsBuffer:y,_=this.tempAABBBounds1,b=this.tempAABBBounds2;if(c&&f)Tg(_,(f+g)/Math.abs(o+l),n,m),e.union(_),_.setValue(b.x1,b.y1,b.x2,b.y2);if(d){var x=t.shadowOffsetX,k=void 0===x?i.shadowOffsetX:x,S=t.shadowOffsetY,A=void 0===S?i.shadowOffsetY:S;Tg(_,d/Math.abs(o+l)*2,!1,m+1),_.translate(k,A),e.union(_)}}if(this.combindShadowAABBBounds(e,r),!e.empty()){var C=!0,M=r.transMatrix;r&&r.isContainer&&(C=!(1===M.a&&0===M.b&&0===M.c&&1===M.d&&0===M.e&&0===M.f)),C&&In(e,e,M)}}},{key:"validCheck",value:function(t,e,i,n){if(!n)return!0;if(null!=t.forceBoundsHeight||null!=t.forceBoundsWidth)return!0;if(n.shadowRoot||n.isContainer)return!0;var r=t.visible,a=void 0===r?e.visible:r;return!(!n.valid||!a)||(i.empty()||(n.parent&&i.transformWithMatrix(n.parent.globalTransMatrix),this.clearAABBBounds(n,n.stage,i),i.clear()),!1)}},{key:"updateTempAABBBounds",value:function(t){var e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(t.x1,t.y1,t.x2,t.y2),i.setValue(t.x1,t.y1,t.x2,t.y2),{tb1:e,tb2:i}}}])}();Tm=Am([Dc(),Mm(0,wc(Qg)),Cm("design:paramtypes",[Object])],Tm);var Dm=function(t,e,i){var n=t.outerBorder,r=t.shadowBlur,a=void 0===r?e.shadowBlur:r;if(n){var o=e.outerBorder,s=n.distance,l=void 0===s?o.distance:s,u=n.lineWidth,c=void 0===u?o.lineWidth:u;i.expand(l+(a+c)/2)}return i},Em=["radius","startAngle","endAngle"].concat(b(Iy)),Bm=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{radius:1};return r(this,e),(t=n(this,e,[i])).type="circle",t.numberType=zg,t}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.radius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)}},{key:"getGraphicTheme",value:function(){return vf(this).circle}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));var r=oh.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;return Dm(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,oh.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"updateCircleAABBBoundsImprecise",value:function(t,e,i){var n=t.radius,r=void 0===n?e.radius:n;return i.set(-r,-r,r,r),i}},{key:"updateCircleAABBBoundsAccurate",value:function(t,e,i){var n=t.startAngle,r=void 0===n?e.startAngle:n,a=t.endAngle,o=void 0===a?e.endAngle:a,s=t.radius,l=void 0===s?e.radius:s;return o-r>ei-Je?i.set(-l,-l,l,l):Of(r,o,l,i),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Em])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Em])}},{key:"toCustomPath",value:function(){var t,i,n,r=_(e,"toCustomPath",this,3)([]);if(r)return r;var a=this.attribute,o=null!==(t=a.radius)&&void 0!==t?t:this.getDefaultAttribute("radius"),s=null!==(i=a.startAngle)&&void 0!==i?i:this.getDefaultAttribute("startAngle"),l=null!==(n=a.endAngle)&&void 0!==n?n:this.getDefaultAttribute("endAngle");return(r=new Md).arc(0,0,o,s,l),r}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function Pm(t){return new Bm(t)}Bm.NOWORK_ANIMATE_ATTR=Ny;var Rm=function(){return o((function t(e,i,n){r(this,t),this.fontFamily=e,this.textOptions=i,this.textMeasure=n}),[{key:"LayoutBBox",value:function(t,e,i,n){if(t.xOffset="left"===e||"start"===e?0:"center"===e?t.width/-2:"right"===e||"end"===e?-t.width:0,"top"===i)t.yOffset=0;else if("middle"===i)t.yOffset=t.height/-2;else if("alphabetic"===i){var r=.79;if(1===n.length){var a=n[0];r=a.ascent/(a.ascent+a.descent)}t.yOffset=t.height*-r}else t.yOffset=-t.height;return t}},{key:"GetLayoutByLines",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=null!=o?o:{},l=s.lineWidth,u=s.suffixPosition,c=void 0===u?"end":u,h=s.measureMode,d=void 0===h?Zc.actualBounding:h,p=s.keepCenterInLine,f=void 0!==p&&p;t=t.map((function(t){return t.toString()}));var v=[],g=[0,0];if("number"==typeof l&&l!==1/0){for(var y,m=0,_=t.length;m<_;m++){var b=this.textMeasure.measureTextPixelADscentAndWidth(t[m],this.textOptions,d),x=t[m].toString();if(b.width>l){var k=this.textMeasure.clipTextWithSuffix(t[m],this.textOptions,l,r,a,c);x=k.str,y=k.width}else y=b.width;v.push({str:x,width:y,ascent:b.ascent,descent:b.descent,keepCenterInLine:f})}g[0]=l}else{for(var S,A,C=0,M=0,w=t.length;M<w;M++){A=t[M];var T=this.textMeasure.measureTextPixelADscentAndWidth(t[M],this.textOptions,d);S=T.width,C=Math.max(C,S),v.push({str:A,width:S,ascent:T.ascent,descent:T.descent,keepCenterInLine:f})}g[0]=C}g[1]=v.length*n,g[0]=v.reduce((function(t,e){return Math.max(t,e.width)}),0);var D={xOffset:0,yOffset:0,width:g[0],height:g[1]};return this.LayoutBBox(D,e,i,v),this.layoutWithBBox(D,v,e,i,n)}},{key:"layoutWithBBox",value:function(t,e,i,n,r){var a=[0,0],o=e.length*r;"top"===n||("middle"===n?a[1]=(t.height-o)/2:"bottom"===n&&(a[1]=t.height-o));for(var s=0;s<e.length;s++)this.lineOffset(t,e[s],i,n,r,a);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:r,textAlign:i,textBaseline:n}}},{key:"lineOffset",value:function(t,e,i,n,r,a){if("left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=r/2+(e.ascent-e.descent)/2+a[1],!e.keepCenterInLine){var o=e.ascent+e.descent+0;if(o<r-0&&("bottom"===n?e.topOffset+=(r-o)/2:"top"===n&&(e.topOffset-=(r-o)/2)),"alphabetic"===n){var s=r/(e.ascent+e.descent);e.topOffset=r/2+(e.ascent-e.descent)/2*s+a[1]}}return a[1]+=r,e}}])}(),Lm=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp"].concat(b(Iy)),Im=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:"",fontSize:16};return r(this,e),(t=n(this,e,[i])).type="text",t.numberType=Zg,t.cache={},t}return h(e,t),o(e,[{key:"font",get:function(){var t=this.getGraphicTheme();return this._font||(this._font=En(this.attribute,t)),this._font}},{key:"clipedText",get:function(){var t,e=this.attribute,i=this.getGraphicTheme(),n=this.getMaxWidth(i);return Number.isFinite(n)?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!==(t=e.text)&&void 0!==t?t:i.text).toString()}},{key:"clipedWidth",get:function(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}},{key:"cliped",get:function(){var t,e,i=this.getGraphicTheme(),n=this.attribute,r=this.getMaxWidth(i);if(!Number.isFinite(r))return!1;var a=this.attribute.text;if(this.tryUpdateAABBBounds(),null===(e=null===(t=this.cache)||void 0===t?void 0:t.layoutData)||void 0===e?void 0:e.lines){var o="";return this.cache.layoutData.lines.forEach((function(t){o+=t.str})),(Array.isArray(a)?a.join(""):a).toString()!==o}return"vertical"===n.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map((function(t){return t.text})).join("")!==n.text.toString():null!=this.clipedText&&this.clipedText!==n.text.toString()}},{key:"multilineLayout",get:function(){return this.tryUpdateAABBBounds(),this.cache.layoutData}},{key:"isMultiLine",get:function(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}},{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.text;return Z(t)?!t.every((function(t){return null==t||""===t})):null!=t&&""!==t}},{key:"getGraphicTheme",value:function(){return vf(this).text}},{key:"doUpdateOBBBounds",value:function(){var t=this.getGraphicTheme();this._OBBBounds.clear();var i=this.attribute,n=i.angle,r=void 0===n?t.angle:n;if(!r){var a=this.AABBBounds;return this._OBBBounds.setValue(a.x1,a.y1,a.x2,a.y2),this._OBBBounds}this.obbText||(this.obbText=new e({})),this.obbText.setAttributes(Object.assign(Object.assign({},i),{angle:0}));var o=this.obbText.AABBBounds,s=i.x,l=i.y,u={x:(o.x1+o.x2)/2,y:(o.y1+o.y2)/2},c=sn(u,r,{x:s,y:l});return this._OBBBounds.copy(o),this._OBBBounds.translate(c.x-u.x,c.y-u.y),this._OBBBounds.angle=r,this._OBBBounds}},{key:"updateAABBBounds",value:function(t,e,i){var n=this.attribute.text,r=void 0===n?e.text:n;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);var a=oh.graphicService.updateTempAABBBounds(i).tb1,o=t.scaleX,s=void 0===o?e.scaleX:o,l=t.scaleY,u=void 0===l?e.scaleY:l,c=t.shadowBlur,h=void 0===c?e.shadowBlur:c,d=t.strokeBoundsBuffer,p=void 0===d?e.strokeBoundsBuffer:d;h&&(Tg(a,h/Math.abs(s+u),!0,p),i.union(a));return oh.graphicService.combindShadowAABBBounds(i,this),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||oh.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,In(i,i,this.transMatrix),i}},{key:"updateSingallineAABBBounds",value:function(t){this.updateMultilineAABBBounds([t]);var e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){var i=e.lines[0];this.cache.clipedText=i.str,this.cache.clipedWidth=i.width}return this._AABBBounds}},{key:"updateMultilineAABBBounds",value:function(t){var e=this.getGraphicTheme(),i=this.attribute,n=i.direction,r=void 0===n?e.direction:n,a=i.underlineOffset,o=void 0===a?e.underlineOffset:a,s="horizontal"===r?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===r&&o&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+o),s}},{key:"guessLineHeightBuf",value:function(t){return t?.1*t:0}},{key:"updateHorizontalMultilineAABBBounds",value:function(t){var e,i,n=this.getGraphicTheme(),r=this.attribute,a=r.fontFamily,o=void 0===a?n.fontFamily:a,s=r.textAlign,l=void 0===s?n.textAlign:s,u=r.textBaseline,c=void 0===u?n.textBaseline:u,h=r.fontSize,d=void 0===h?n.fontSize:h,p=r.fontWeight,f=void 0===p?n.fontWeight:p,v=r.ellipsis,g=void 0===v?n.ellipsis:v,y=r.maxLineWidth,m=r.stroke,_=void 0===m?n.stroke:m,b=r.wrap,x=void 0===b?n.wrap:b,k=r.measureMode,S=void 0===k?n.measureMode:k,A=r.lineWidth,C=void 0===A?n.lineWidth:A,M=r.whiteSpace,w=void 0===M?n.whiteSpace:M,T=r.suffixPosition,D=void 0===T?n.suffixPosition:T,E=r.ignoreBuf,B=void 0===E?n.ignoreBuf:E,P=r.keepCenterInLine,R=void 0===P?n.keepCenterInLine:P,L=B?0:this.guessLineHeightBuf(d),I=this.getLineHeight(r,n,L);if("normal"===w||x)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null===(e=this.cache)||void 0===e?void 0:e.layoutData)){var F=this.cache.layoutData.bbox;return this._AABBBounds.set(F.xOffset,F.yOffset,F.xOffset+F.width,F.yOffset+F.height),_&&this._AABBBounds.expand(C/2),this._AABBBounds}var O=oh.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null===(i=this.stage)||void 0===i?void 0:i.textMeasureId)),z=new Rm(o,{fontSize:d,fontWeight:f,fontFamily:o,lineHeight:I},O).GetLayoutByLines(t,l,c,I,!0===g?n.ellipsis:g||void 0,!1,{lineWidth:y,suffixPosition:D,measureMode:S,keepCenterInLine:R}),H=z.bbox;return this.cache.layoutData=z,this.clearUpdateShapeTag(),this._AABBBounds.set(H.xOffset,H.yOffset,H.xOffset+H.width,H.yOffset+H.height),_&&this._AABBBounds.expand(C/2),this._AABBBounds}},{key:"updateWrapAABBBounds",value:function(t){var e,i,n,r,a=this.getGraphicTheme(),o=this.attribute,s=o.fontFamily,l=void 0===s?a.fontFamily:s,u=o.textAlign,c=void 0===u?a.textAlign:u,h=o.textBaseline,d=void 0===h?a.textBaseline:h,p=o.fontSize,f=void 0===p?a.fontSize:p,v=o.ellipsis,g=void 0===v?a.ellipsis:v,y=o.maxLineWidth,m=o.stroke,_=void 0===m?a.stroke:m,b=o.lineWidth,x=void 0===b?a.lineWidth:b,k=o.wordBreak,S=void 0===k?a.wordBreak:k,A=o.fontWeight,C=void 0===A?a.fontWeight:A,M=o.ignoreBuf,w=void 0===M?a.ignoreBuf:M,T=o.measureMode,D=void 0===T?a.measureMode:T,E=o.suffixPosition,B=void 0===E?a.suffixPosition:E,P=o.heightLimit,R=void 0===P?0:P,L=o.lineClamp,I=o.keepCenterInLine,F=void 0===I?a.keepCenterInLine:I,O=w?0:this.guessLineHeightBuf(f),z=this.getLineHeight(this.attribute,a,O);if(!this.shouldUpdateShape()&&(null===(e=this.cache)||void 0===e?void 0:e.layoutData)){var H=this.cache.layoutData.bbox;return this._AABBBounds.set(H.xOffset,H.yOffset,H.xOffset+H.width,H.yOffset+H.height),_&&this._AABBBounds.expand(x/2),this._AABBBounds}var N=oh.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null===(i=this.stage)||void 0===i?void 0:i.textMeasureId)),U={fontSize:f,fontWeight:C,fontFamily:l,lineHeight:z},j=new Rm(l,U,N),V=Z(t)?t.map((function(t){return t.toString()})):[t.toString()],W=[],G=[0,0],Y=1/0;if(R>0&&(Y=Math.max(Math.floor(R/z),1)),L&&(Y=Math.min(Y,L)),"number"==typeof y&&y!==1/0){if(y>0)for(var X=0;X<V.length;X++){var K=V[X],q=!0;if(X===Y-1){var J=N.clipTextWithSuffix(K,U,y,g,!1,B,X!==V.length-1),Q=N.measureTextPixelADscentAndWidth(J.str,U,D);W.push({str:J.str,width:J.width,ascent:Q.ascent,descent:Q.descent,keepCenterInLine:F});break}var $=N.clipText(K,U,y,"break-all"!==S,"keep-all"===S);if(""!==K&&""===$.str||$.wordBreaked){if(g){var tt=N.clipTextWithSuffix(K,U,y,g,!1,B);$.str=null!==(n=tt.str)&&void 0!==n?n:"",$.width=null!==(r=tt.width)&&void 0!==r?r:0}else $.str="",$.width=0;q=!1}var et=N.measureTextPixelADscentAndWidth($.str,U,D);W.push({str:$.str,width:$.width,ascent:et.ascent,descent:et.descent,keepCenterInLine:F});var it=$.str.length;if(!$.wordBreaked||""!==K&&""===$.str||(q=!0,it=$.wordBreaked),$.str.length===K.length);else if(q){var nt=K.substring(it);"keep-all"===S&&(nt=nt.replace(/^\s+/g,"")),V.splice(X+1,0,nt)}}var rt=0;W.forEach((function(t){rt=Math.max(rt,t.width)})),G[0]=rt}else{for(var at,ot,st=0,lt=0,ut=V.length;lt<ut;lt++){if(lt===Y-1){var ct=N.clipTextWithSuffix(V[lt],U,y,g,!1,B),ht=N.measureTextPixelADscentAndWidth(ct.str,U,D);W.push({str:ct.str,width:ct.width,ascent:ht.ascent,descent:ht.descent,keepCenterInLine:F}),st=Math.max(st,ct.width);break}ot=V[lt],at=N.measureTextWidth(ot,U),st=Math.max(st,at);var dt=N.measureTextPixelADscentAndWidth(ot,U,D);W.push({str:ot,width:at,ascent:dt.ascent,descent:dt.descent,keepCenterInLine:F})}G[0]=st}G[1]=W.length*z;var pt={xOffset:0,yOffset:0,width:G[0],height:G[1]};j.LayoutBBox(pt,c,d,W);var ft=j.layoutWithBBox(pt,W,c,d,z);return this.cache.layoutData=ft,this.clearUpdateShapeTag(),this._AABBBounds.set(pt.xOffset,pt.yOffset,pt.xOffset+pt.width,pt.yOffset+pt.height),_&&this._AABBBounds.expand(x/2),this._AABBBounds}},{key:"updateVerticalMultilineAABBBounds",value:function(t){var i,n,r,a,o=this.getGraphicTheme(),s=oh.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null===(i=this.stage)||void 0===i?void 0:i.textMeasureId)),l=this.attribute,u=l.maxLineWidth,c=void 0===u?o.maxLineWidth:u,h=l.ellipsis,d=void 0===h?o.ellipsis:h,p=l.fontFamily,f=void 0===p?o.fontFamily:p,v=l.fontSize,g=void 0===v?o.fontSize:v,y=l.fontWeight,m=void 0===y?o.fontWeight:y,_=l.stroke,b=void 0===_?o.stroke:_,x=l.lineWidth,k=void 0===x?o.lineWidth:x,S=l.verticalMode,A=void 0===S?o.verticalMode:S,C=l.suffixPosition,M=void 0===C?o.suffixPosition:C,w=this.getLineHeight(l,o,0),T=l.textAlign,D=void 0===T?o.textAlign:T,E=l.textBaseline,B=void 0===E?o.textBaseline:E;if(!A){var P=D;D=null!==(n=e.baselineMapAlign[B])&&void 0!==n?n:"left",B=null!==(r=e.alignMapBaseline[P])&&void 0!==r?r:"top"}if(a=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);a=ai(e,a)}));var R=km(D,a),L=this.cache.verticalList.length*w,I=Sm(B,L,g);return this._AABBBounds.set(I,R,I+L,R+a),b&&this._AABBBounds.expand(k/2),this._AABBBounds}var F=t.map((function(t){return function(t){for(var e=[],i=0,n="",r=0;r<t.length;r++)Lg(t[r])?i?n+=t[r]:(i=1,n=t[r]):(i&&(e.push({text:n,direction:Dg.VERTICAL}),n="",i=0),e.push({text:t[r],direction:Dg.HORIZONTAL}));return n&&e.push({text:n,direction:Dg.VERTICAL}),e}(t.toString())}));F.forEach((function(t,e){if(Number.isFinite(c))if(d){var i=!0===d?o.ellipsis:d,n=s.clipTextWithSuffixVertical(t,{fontSize:g,fontWeight:m,fontFamily:f},c,i,!1,M);F[e]=n.verticalList,a=n.width}else{var r=s.clipTextVertical(t,{fontSize:g,fontWeight:m,fontFamily:f},c,!1);F[e]=r.verticalList,a=r.width}else a=0,t.forEach((function(t){var e=t.direction===Dg.HORIZONTAL?g:s.measureTextWidth(t.text,{fontSize:g,fontWeight:m,fontFamily:f});a+=e,t.width=e}))})),this.cache.verticalList=F,this.clearUpdateShapeTag(),this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);a=ai(e,a)}));var O=km(D,a),z=this.cache.verticalList.length*w,H=Sm(B,z,g);return this._AABBBounds.set(H,O,H+z,O+a),b&&this._AABBBounds.expand(k/2),this._AABBBounds}},{key:"getMaxWidth",value:function(t){var e,i,n=this.attribute;return null!==(i=null!==(e=n.maxLineWidth)&&void 0!==e?e:n.maxWidth)&&void 0!==i?i:t.maxWidth}},{key:"getLineHeight",value:function(t,e,i){var n;return null!==(n=Vf(t.lineHeight,t.fontSize||e.fontSize))&&void 0!==n?n:(t.fontSize||e.fontSize)+i}},{key:"needUpdateTags",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lm;return _(e,"needUpdateTags",this,3)([t,i])}},{key:"needUpdateTag",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lm;return _(e,"needUpdateTag",this,3)([t,i])}},{key:"_interpolate",value:function(t,e,i,n,r){"text"===t&&(r.text=n)}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}},{key:"getBaselineMapAlign",value:function(){return e.baselineMapAlign}},{key:"getAlignMapBaseline",value:function(){return e.alignMapBaseline}}])}(Uy);function Fm(t){return new Im(t)}Im.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},Ny),Im.baselineMapAlign={top:"left",bottom:"right",middle:"center"},Im.alignMapBaseline={left:"top",right:"bottom",center:"middle"};var Om=["symbolType","size"].concat(b(Iy)),zm=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{symbolType:"circle"};return r(this,e),(t=n(this,e,[i])).type="symbol",t.numberType=qg,t}return h(e,t),o(e,[{key:"getParsedPath",value:function(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}},{key:"getParsedPath2D",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=null;try{n=new Path2D}catch(t){return null}var r=this.getParsedPath();if(!r)return null;r.draw(n,i,t,e)}},{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.size;return Z(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}},{key:"doUpdateParsedPath",value:function(){var t=this.attribute.symbolType,i=void 0===t?"circle":t;return _(e,"parsePath",this,3)([i])}},{key:"getGraphicTheme",value:function(){return vf(this).symbol}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));var r=oh.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;(function(t,e,i){var n=t.outerBorder,r=t.shadowBlur,a=void 0===r?e.shadowBlur:r,o=t.strokeBoundsBuffer,s=void 0===o?e.strokeBoundsBuffer:o;if(n){var l=e.outerBorder,u=n.distance,c=void 0===u?l.distance:u,h=n.lineWidth;Tg(i,c+(a+(void 0===h?l.lineWidth:h))/2,!0,s)}})(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return oh.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"updateSymbolAABBBoundsImprecise",value:function(t,e,i){var n=t.size,r=void 0===n?e.size:n;if(Z(r))i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2);else{var a=r/2;i.set(-a,-a,a,a)}return i}},{key:"updateSymbolAABBBoundsAccurate",value:function(t,e,i){var n=t.size,r=void 0===n?e.size:n,a=this.getParsedPath();return a?(a.bounds(r,i),i):i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Om])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Om])}},{key:"toCustomPath",value:function(){var t=this.getParsedPath();if(!t)return null;var e=this.attribute.size,i=Z(e)?e:[e,e];return t.path?(new Md).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new Md).fromString(t.pathStr,0,0,i[0],i[1])}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function Hm(t){return new zm(t)}zm.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},Ny);var Nm=["segments","points","curveType","curveTension"].concat(b(Iy)),Um=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e,[i])).type="line",t.numberType=jg,t}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!(!e||e.length<=1)}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=Hf(i,n,e))}},{key:"getGraphicTheme",value:function(){return vf(this).line}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),oh.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return oh.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updateLineAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,a=void 0===r?e.points:r,o=t.connectedType,s=i;return a.forEach((function(t){!1===t.defined&&"connect"!==o||s.add(t.x,t.y)})),s}},{key:"updateLineAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,a=void 0===r?e.segments:r,o=t.connectedType,s=i;return a.forEach((function(t){t.points.forEach((function(t){!1===t.defined&&"connect"!==o||s.add(t.x,t.y)}))})),s}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Nm])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Nm])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;var i=this.attribute;t=new Md;var n=i.segments,r=function(e){if(e&&e.length){var i=!0;e.forEach((function(e){!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),i=!1)}))}};return n&&n.length?n.forEach((function(t){r(t.points)})):i.points&&r(i.points),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function jm(t){return new Um(t)}Um.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},Ny);var Vm=function(t){if(!t)return{x:0,y:0,width:0,height:0};var e=j(t.width)?t.x1-t.x:t.width,i=j(t.height)?t.y1-t.y:t.height,n=0,r=0;return e<0?(n=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(r=i,i=-i):Number.isNaN(i)&&(i=0),{x:n,y:r,width:e,height:i}},Wm=["width","x1","y1","height","cornerRadius"].concat(b(Iy)),Gm=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="rect",i.numberType=Yg,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){return!0}},{key:"getGraphicTheme",value:function(){return vf(this).rect}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=t.width,r=t.height,a=t.x1,o=t.y1,s=t.x,l=t.y;n=null!=n?n:a-s,r=null!=r?r:o-l,(isFinite(n)||isFinite(r)||isFinite(s)||isFinite(l))&&i.set(0,0,n||0,r||0)}var u=oh.graphicService.updateTempAABBBounds(i),c=u.tb1,h=u.tb2;return Dm(t,e,c),i.union(c),c.setValue(h.x1,h.y1,h.x2,h.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,oh.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Wm])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Wm])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;var i=this.attribute,n=Vm(i),r=n.x,a=n.y,o=n.width,s=n.height;return(t=new Md).moveTo(r,a),t.rect(r,a,o,s),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function Ym(t){return new Gm(t)}Gm.NOWORK_ANIMATE_ATTR=Ny;var Xm=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],Km=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="rect3d",i.numberType=Xg,i}return h(e,t),o(e,[{key:"findFace",value:function(){var t={polygons:[],vertices:[],edges:[]},e=this.getGraphicTheme(),i=this.attribute,n=i.x1,r=i.y1,a=i.x,o=i.y,s=i.length,l=void 0===s?oi(e.width,e.height):s,u=this.attribute,c=u.width,h=u.height;c=null!=c?c:n-a,h=null!=h?h:r-o;for(var d=0;d<Xm.length;d++){var p=Xm[d];t.vertices.push([p[0]*c,p[1]*h,p[2]*l])}return t.polygons.push({polygon:[0,1,5,4],normal:[0,-1,0]}),t.polygons.push({polygon:[2,3,7,6],normal:[0,1,0]}),t.polygons.push({polygon:[4,7,3,0],normal:[-1,0,0]}),t.polygons.push({polygon:[1,2,6,5],normal:[1,0,0]}),t.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),t.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),t.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],t}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Gm);function qm(t){return new Km(t)}Km.NOWORK_ANIMATE_ATTR=Ny;var Zm=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t])).type="glyph",a.numberType=Hg,a.subGraphic=[],a._onInit&&a._onInit(i(a)),a.valid=a.isValid(),a}return h(e,t),o(e,[{key:"setSubGraphic",value:function(t){var e=this;this.detachSubGraphic(),this.subGraphic=t,t.forEach((function(t){t.glyphHost=e,Object.setPrototypeOf(t.attribute,e.attribute)})),this.valid=this.isValid(),this.addUpdateBoundTag()}},{key:"detachSubGraphic",value:function(){this.subGraphic.forEach((function(t){t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})}))}},{key:"getSubGraphic",value:function(){return this.subGraphic}},{key:"onInit",value:function(t){this._onInit=t}},{key:"onUpdate",value:function(t){this._onUpdate=t}},{key:"isValid",value:function(){return!0}},{key:"setAttribute",value:function(t,i,n,r){_(e,"setAttribute",this,3)([t,i,n,r]),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"setAttributes",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;_(e,"setAttributes",this,3)([t,i,n]),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"translate",value:function(t,i){return _(e,"translate",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"translateTo",value:function(t,i){return _(e,"translateTo",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scale",value:function(t,i,n){return _(e,"scale",this,3)([t,i,n]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scaleTo",value:function(t,i){return _(e,"scaleTo",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotate",value:function(t){return _(e,"rotate",this,3)([t]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotateTo",value:function(t){return _(e,"rotate",this,3)([t]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"getGraphicTheme",value:function(){return vf(this).glyph}},{key:"updateAABBBounds",value:function(t,e,i){return this.getSubGraphic().forEach((function(t){i.union(t.AABBBounds)})),i}},{key:"doUpdateAABBBounds",value:function(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();var t=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),t}},{key:"needUpdateTags",value:function(t){return!1}},{key:"needUpdateTag",value:function(t){return!1}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){this.stopStateAnimates();var r={},a=this.subGraphic.map((function(){return{}}));t.forEach((function(e){var i,o=n.glyphStateProxy?n.glyphStateProxy(e,t):n.glyphStates[e];o&&(Object.assign(r,o.attributes),(null===(i=o.subAttributes)||void 0===i?void 0:i.length)&&a.forEach((function(t,e){Object.assign(t,o.subAttributes[e])})))})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"clearStates",value:function(t){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"clone",value:function(){var t=new e(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map((function(t){return t.clone()}))),t}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function Jm(t){return new Zm(t)}Zm.NOWORK_ANIMATE_ATTR=Ny;var Qm=function(){return o((function t(e,i,n,a,o,s,l,u,c,h,d,p,f,v){r(this,t),this.left=e,this.top=i,this.width=n,this.height=a,this.actualHeight=0,this.bottom=i+a,this.right=e+n,this.ellipsis=o,this.wordBreak=s,this.verticalDirection=l,this.lines=[],this.globalAlign=u,this.globalBaseline=c,this.layoutDirection=h,this.directionKey=ip[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=p,this.singleLine=f,v?(v.clear(),this.icons=v):this.icons=new Map}),[{key:"draw",value:function(t,e){var i=this.getActualSize(),n=i.width,r=i.height,a=this.isWidthMax?Math.min(this.width,n):this.width||n||0,o=this.isHeightMax?Math.min(this.height,r):this.height||r||0;o=Math.min(o,r);var s=0;switch(this.globalBaseline){case"top":s=0;break;case"middle":s=-o/2;break;case"bottom":s=-o}var l=0;"right"===this.globalAlign||"end"===this.globalAlign?l=-a:"center"===this.globalAlign&&(l=-a/2);var u=this[this.directionKey.height];this.singleLine&&(u=this.lines[0].height+1);var c=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=u&&0!==u)for(var h=0;h<this.lines.length;h++){var d=this.lines[h],p=d.top,f=d.height;if(p+f<this[this.directionKey.top]||p+f>this[this.directionKey.top]+u)return c;var v=!1;this.ellipsis&&this.lines[h+1]&&this.lines[h+1].top+this.lines[h+1].height>this[this.directionKey.top]+u&&(v=!0,c=!0),this.lines[h].draw(t,v,this.lines[h][this.directionKey.left]+l,this.lines[h][this.directionKey.top]+s,this.ellipsis,e)}else{var g=Math.floor((u-this.actualHeight)/2);"vertical"===this.layoutDirection?l+=g:s+=g;for(var y=0;y<this.lines.length;y++)this.lines[y].draw(t,!1,this.lines[y][this.directionKey.left]+l,this.lines[y][this.directionKey.top]+s,this.ellipsis,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(var m=0;m<this.lines.length;m++){var _=this.lines[m];_.top;var b=_.height,x=u-this.lines[m].top-this.lines[m].height;if(0===u)this.lines[m].draw(t,!1,l,x+s,this.ellipsis,e);else{if(x+b>this[this.directionKey.top]+u||x<this[this.directionKey.top])return c;var k=!1;this.ellipsis&&this.lines[m+1]&&x-this.lines[m+1].height<this[this.directionKey.top]&&(k=!0,c=!0),this.lines[m].draw(t,k,l,x+s,this.ellipsis,e)}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(var S=0;S<this.lines.length;S++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(l-=this.lines[S].height+this.lines[S].top);var A=this.lines[S],C=A.top,M=A.height;if(0===u)this.lines[S].draw(t,!1,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,this.ellipsis,e);else{if(C+M<this[this.directionKey.top]||C+M>this[this.directionKey.top]+u)return c;var w=!1;this.ellipsis&&this.lines[S+1]&&this.lines[S+1].top+this.lines[S+1].height>this[this.directionKey.top]+u&&(w=!0,c=!0),this.lines[S].draw(t,w,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,this.ellipsis,e)}}}return c}},{key:"getActualSize",value:function(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}},{key:"getRawActualSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.actualWidth>t&&(t=n.actualWidth),e+=n.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}},{key:"getActualSizeWidthEllipsis",value:function(){var t=0,e=0,i=this.getRawActualSize();i.width;i.height;this.width,this.height;var n=this[this.directionKey.height];if(this.singleLine&&(n=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=n&&0!==n)for(var r=0;r<this.lines.length;r++){var a=this.lines[r],o=a.top,s=a.height;if(o+s<this[this.directionKey.top]||o+s>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[r+1]&&this.lines[r+1].top+this.lines[r+1].height>this[this.directionKey.top]+n){var l=!0===this.ellipsis?"...":this.ellipsis||"",u=this.lines[r].getWidthWithEllips(l);u>t&&(t=u),e+=this.lines[r].height}else this.lines[r].actualWidth>t&&(t=this.lines[r].actualWidth),e+=this.lines[r].height}else{Math.floor((n-this.actualHeight)/2);for(var c=0;c<this.lines.length;c++)this.lines[c].actualWidth>t&&(t=this.lines[c].actualWidth),e+=this.lines[c].height}else if("bottom"===this.verticalDirection)for(var h=0;h<this.lines.length;h++){var d=this.lines[h];d.top;var p=d.height,f=n-this.lines[h].top-this.lines[h].height;if(0===n)this.lines[h].actualWidth>t&&(t=this.lines[h].actualWidth),e+=this.lines[h].height;else if(f+p>this[this.directionKey.top]+n||f<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[h+1]&&f-this.lines[h+1].height<this[this.directionKey.top]){var v=!0===this.ellipsis?"...":this.ellipsis||"",g=this.lines[h].getWidthWithEllips(v);g>t&&(t=g),e+=this.lines[h].height}else this.lines[h].actualWidth>t&&(t=this.lines[h].actualWidth),e+=this.lines[h].height}else for(var y=0;y<this.lines.length;y++){var m=this.lines[y],_=m.top,b=m.height;if(0===n)this.lines[y].actualWidth>t&&(t=this.lines[y].actualWidth),e+=this.lines[y].height;else if(_+b<this[this.directionKey.top]||_+b>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[y+1]&&this.lines[y+1].top+this.lines[y+1].height>this[this.directionKey.top]+n){var x=!0===this.ellipsis?"...":this.ellipsis||"",k=this.lines[y].getWidthWithEllips(x);k>t&&(t=k),e+=this.lines[y].height}else this.lines[y].actualWidth>t&&(t=this.lines[y].actualWidth),e+=this.lines[y].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}])}();function $m(t,e,i,n){var r=Math.round(t),a=Math.round(i),o=Math.round(e),s=Math.round(n);return{left:t>r?r:r-.5,top:i>a?a:a-.5,right:o>e?o:o+.5,bottom:s>n?s:s+.5}}var t_=function(){return o((function t(e,i,n,a){var o,s;r(this,t),this.fontSize=n.fontSize||16,this.textBaseline=n.textBaseline||"alphabetic",this.ascentDescentMode=a;var l=Vf(n.lineHeight,this.fontSize);this.lineHeight="number"==typeof l?l>this.fontSize?l:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;var u=dp(e,n,this.ascentDescentMode),c=u.ascent,h=u.height,d=u.descent,p=u.width,f=0,v=0,g=0;this.height>h&&(f=(this.height-h)/2,v=Math.ceil(f),g=Math.floor(f)),"top"===this.textBaseline?(this.ascent=f,this.descent=h-f):"bottom"===this.textBaseline?(this.ascent=h-f,this.descent=f):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=c+v,this.descent=d+g),this.length=e.length,this.width=p||0,this.text=e||"",this.newLine=i||!1,this.character=n,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=n.space,this.dx=null!==(o=n.dx)&&void 0!==o?o:0,this.dy=null!==(s=n.dy)&&void 0!==s?s:0,"vertical"===n.direction&&(this.direction=n.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}),[{key:"updateWidth",value:function(){var t=dp(this.text,this.character,this.ascentDescentMode).width;this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}},{key:"drawBackground",value:function(t,e,i,n,r,a,o){if(""!==this.text&&"\n"!==this.text&&this.character.background&&(!this.character.backgroundOpacity||this.character.backgroundOpacity>0)){var s=this.text,l=this.left+n;this.top;var u=this.direction;if(this.verticalEllipsis)s=this.ellipsisStr,u="vertical",this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)s+=this.ellipsisStr,"right"!==a&&"end"!==a||(l-=this.ellipsisWidth);else if("replace"===this.ellipsis){var c=up(s,("vertical"===u?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,s.length-1);if(s=s.slice(0,c),s+=this.ellipsisStr,"right"===a||"end"===a)if("vertical"===u);else{var h=dp(this.text.slice(c),this.character,this.ascentDescentMode).width;l-=this.ellipsisWidth-h}}}var d=$m(l,l+(this.widthOrigin||this.width),e,e+o);return Object.assign(Object.assign({},d),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}}},{key:"draw",value:function(t,e,i,n,r,a,o){var s,l=e+i,u=this.text,c=this.left+n+(null!==(s=this.space)&&void 0!==s?s:0)/2;l+=this.top;var h=this.direction;if(this.verticalEllipsis)u=this.ellipsisStr,h="vertical",l-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)u+=this.ellipsisStr,"right"!==a&&"end"!==a||(c-=this.ellipsisWidth);else if("replace"===this.ellipsis){var d=up(u,("vertical"===h?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,u.length-1);if(u=u.slice(0,d),u+=this.ellipsisStr,"right"===a||"end"===a)if("vertical"===h);else{var p=dp(this.text.slice(d),this.character,this.ascentDescentMode).width;c-=this.ellipsisWidth-p}}}switch(this.character.script){case"super":l-=this.ascent*(1/3);break;case"sub":l+=this.descent/2}"vertical"===h&&(t.save(),t.rotateAbout(Math.PI/2,c,l),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(c,l),c=0,l=0);var f=this.character.lineWidth,v=void 0===f?1:f;if(this.character.stroke&&v&&t.strokeText(u,c+this.dx,l+this.dy),this.character.fill&&t.fillText(u,c+this.dx,l+this.dy),this.character.fill)if(this.character.lineThrough||this.character.underline){if(this.character.underline){var g=1+l,y=$m(c,c+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(y.left,1+l,y.right-y.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){var m=1+l-this.ascent/2,_=$m(c,c+(this.widthOrigin||this.width),m,m+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(_.left,1+l-this.ascent/2,_.right-_.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if("underline"===this.character.textDecoration){var b=1+l,x=$m(c,c+(this.widthOrigin||this.width),b,b+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(x.left,1+l,x.right-x.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if("line-through"===this.character.textDecoration){var k=1+l-this.ascent/2,S=$m(c,c+(this.widthOrigin||this.width),k,k+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(S.left,1+l-this.ascent/2,S.right-S.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}"vertical"===h&&t.restore()}},{key:"getWidthWithEllips",value:function(t){var e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){var n=up(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,n),e+=this.ellipsisStr;var r=dp(this.text.slice(n),this.character,this.ascentDescentMode).width;return i+this.ellipsisWidth-r}return i}}])}();var e_=["width","height","image"].concat(b(Iy)),i_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="image",i.numberType=Ug,i.loadImage(i.attribute.image),i}return h(e,t),o(e,[{key:"getImageElement",value:function(){var t=this.attribute.image;if(!t||!this.resources)return null;var e=this.resources.get(t);return"success"!==e.state?null:e.data}},{key:"width",get:function(){return this.tryUpdateAABBBounds(),this._actualWidth}},{key:"height",get:function(){return this.tryUpdateAABBBounds(),this._actualHeight}},{key:"repeatX",get:function(){var t;return null!==(t=this.attribute.repeatX)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}},{key:"repeatY",get:function(){var t;return null!==(t=this.attribute.repeatY)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}},{key:"image",get:function(){return this.attribute.image},set:function(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}},{key:"imageLoadSuccess",value:function(t,i,n){var r=this;_(e,"imageLoadSuccess",this,3)([t,i,function(){r.successCallback&&r.successCallback()}]),this.addUpdateBoundTag()}},{key:"imageLoadFail",value:function(t,i){var n=this;_(e,"imageLoadFail",this,3)([t,function(){n.failCallback&&n.failCallback()}])}},{key:"setAttributes",value:function(t,i,n){return t.image&&this.loadImage(t.image),_(e,"setAttributes",this,3)([t,i,n])}},{key:"setAttribute",value:function(t,i,n,r){return"image"===t&&this.loadImage(i),_(e,"setAttribute",this,3)([t,i,n,r])}},{key:"getGraphicTheme",value:function(){return vf(this).image}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=t.maxWidth,r=void 0===n?e.maxWidth:n,a=t.maxHeight,o=void 0===a?e.maxHeight:a,s=t.width,l=t.height;if(null==s||null==l){var u=this.getImageElement();if(u){var c=u.width,h=u.height;if(null!=s)l=s*(h/c);else if(null!=l)s=l*(c/h);else{var d=c/h;d>r/o?(s=r,l=r/d):(l=o,s=o*d)}}else s=r,l=o}this._actualWidth=s,this._actualHeight=l,i.set(0,0,s,l)}var p=oh.graphicService.updateTempAABBBounds(i),f=p.tb1,v=p.tb2;return Dm(t,e,f),i.union(f),f.setValue(v.x1,v.y1,v.x2,v.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,oh.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"getDefaultAttribute",value:function(t){return Zd[t]}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,e_])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,e_])}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function n_(t){return new i_(t)}i_.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},Ny);var r_=function(t){function e(t){var i;if(r(this,e),(i=n(this,e,[t]))._x=0,i._y=0,i._hovered=!1,i._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(i._hovered=!0),t.margin){var a=Lf(t.margin);i._marginArray="number"==typeof a?[a,a,a,a]:a}return i.onBeforeAttributeUpdate=function(t,e,n){if(Z(n)&&-1!==n.indexOf("margin")||"margin"===n)if(e.margin){var r=Lf(e.margin);i._marginArray="number"==typeof r?[r,r,r,r]:r}else i._marginArray=[0,0,0,0]},i}return h(e,t),o(e,[{key:"width",get:function(){var t;return(null!==(t=this.attribute.width)&&void 0!==t?t:0)+this._marginArray[1]+this._marginArray[3]}},{key:"height",get:function(){var t;return(null!==(t=this.attribute.height)&&void 0!==t?t:0)+this._marginArray[0]+this._marginArray[2]}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();var t=this.attribute,e=t.width,i=void 0===e?Zd.width:e,n=t.height,r=void 0===n?Zd.height:n,a=this.attribute,o=a.backgroundWidth,s=void 0===o?i:o,l=a.backgroundHeight,u=(s-i)/2,c=((void 0===l?r:l)-r)/2;return this._AABBBounds.expand([0,2*u,2*c,0]),this._AABBBounds}},{key:"setHoverState",value:function(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}])}(i_),a_=function(){return o((function t(e,i,n,a,o,s,l,u){var c=this;r(this,t),this.left=e,this.width=i,this.baseline=n,this.ascent=a,this.descent=o,this.top=n-a,this.paragraphs=s.map((function(t){return t})),this.textAlign=(this.paragraphs[0]instanceof r_?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=l,this.directionKey=ip[this.direction],this.actualWidth=0;var h=0;this.paragraphs.forEach((function(t,e){if(0===e&&t instanceof t_){var i=sp.exec(t.text);0!==(null==i?void 0:i.index)&&(t.text=t.text.slice(null==i?void 0:i.index),t.updateWidth())}c.actualWidth+=t[c.directionKey.width],h=Math.max(t[c.directionKey.height],h)})),this.height=h,this.blankWidth=u?0:this.width-this.actualWidth,this.calcOffset(i,u)}),[{key:"calcOffset",value:function(t,e){var i=this.directionKey,n=this.height,r=this.left,a=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?r=t-this.actualWidth:"center"===this.textAlign?r=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?r=(t-this.actualWidth)/2:a=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map((function(t){t instanceof r_?(t["_"+i.x]=r,r+=t[i.width]+a,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?n-t.height:(n-t.height)/2):(t[i.left]=r,r+=t[i.width]+a)}))}},{key:"draw",value:function(t,e,i,n,r,a){var o=this;if(r&&(e||this.paragraphs.some((function(t){return t.overflow})))){for(var s=!0,l=!1,u=this.paragraphs.length-1;u>=0;u--){var c=this.paragraphs[u];if(c.overflow)s=s&&""===c.text;else if(s){l=!0;break}}var h=0;if(!l)for(var d=this.paragraphs.length-1;d>=0;d--){var p=this.paragraphs[d];if(p.overflow){if(""===p.text)break}else{if(p instanceof r_)break;if("vertical"===this.direction&&"vertical"!==p.direction){p.verticalEllipsis=!0;break}var f=!0===r?"...":r||"";p.ellipsisStr=f;var v=dp(f,p.character,p.ascentDescentMode).width||0;if(v<=this.blankWidth+h){e&&(p.ellipsis="add");break}if(v<=this.blankWidth+h+p.width){p.ellipsis="replace",p.ellipsisWidth=v,p.ellipsisOtherParagraphWidth=this.blankWidth+h;break}p.ellipsis="hide",h+=p.width}}}var g="",y=-1,m=[],_=[m];this.paragraphs.forEach((function(e,r){if(!(e instanceof r_)){var a=e.drawBackground(t,n,o.ascent,i,0===r,o.textAlign,o.height);a&&(g===a.fillStyle&&y===a.globalAlpha||(m=[],_.push(m),g=a.fillStyle,y=a.globalAlpha),m.push(a))}})),_.forEach((function(e){if(0!==e.length){var i=e[0],n=e[e.length-1];t.fillStyle=i.fillStyle,t.globalAlpha=i.globalAlpha,t.fillRect(i.left,i.top,n.right-i.left,n.bottom-i.top)}})),this.paragraphs.forEach((function(e,r){if(e instanceof r_)return e.setAttributes({x:i+e._x,y:n+e._y}),void a(e,t,i+e._x,n+e._y,o.ascent);var s={x1:o.left,y1:o.top,x2:o.left+o.actualWidth,y2:o.top+o.height};(function(t,e){var i=e&&e.stroke||rp;if(i){var n=e.strokeOpacity,r=void 0===n?1:n,a=e.opacity,o=void 0===a?1:a;t.globalAlpha=r*o,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i,lp(t,e)}else t.globalAlpha=0})(t,e.character),function(t,e,i){var n=e&&e.fill||np;if(n){var r=e.fillOpacity,a=void 0===r?1:r,o=e.opacity,s=void 0===o?1:o;t.globalAlpha=a*s,t.fillStyle=i?ep(t,n,{AABBBounds:i}):n,lp(t,e)}else t.globalAlpha=0}(t,e.character,s),e.draw(t,n,o.ascent,i,0===r,o.textAlign,o.height)}))}},{key:"getWidthWithEllips",value:function(t){for(var e=this,i=0,n=this.paragraphs.length-1;n>=0;n--){var r=this.paragraphs[n];if(r instanceof r_)break;var a=dp(t,r.character,r.ascentDescentMode).width||0;if(a<=this.blankWidth+i){r.ellipsis="add",r.ellipsisWidth=a;break}if(a<=this.blankWidth+i+r.width){r.ellipsis="replace",r.ellipsisWidth=a,r.ellipsisOtherParagraphWidth=this.blankWidth+i;break}r.ellipsis="hide",i+=r.width}var o=0;return this.paragraphs.forEach((function(t,i){o+=t instanceof r_?t.width:t.getWidthWithEllips(e.direction)})),o}}])}(),o_=function(){return o((function t(e){r(this,t),this.frame=e,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=e.layoutDirection,this.directionKey=ip[this.direction]}),[{key:"store",value:function(t){if(t instanceof r_){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];var e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}},{key:"send",value:function(){if(0!==this.lineBuffer.length){var t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new a_(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}}},{key:"deal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t instanceof r_?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),(0!==t.text.length||this.newLine)&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}},{key:"cut",value:function(t,e){var i=this[this.directionKey.width]-this.lineWidth||0,n=Math.ceil(i/t[this.directionKey.width]*t.length)||0,r=up(t.text,i,t.character,n,"break-word"===this.frame.wordBreak);if(0!==r){var a=function(t,e){var i=t.text.slice(0,e),n=t.text.slice(e);return[new t_(i,t.newLine,t.character,t.ascentDescentMode),new t_(n,!0,t.character,t.ascentDescentMode)]}(t,r),o=m(a,2),s=o[0],l=o[1];this.store(s),e?this.send():this.deal(l)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}])}(),s_=!1;try{s_=Intl&&"function"==typeof Intl.Segmenter}catch(t){s_=!1}var l_=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity"].concat(b(Iy)),u_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="richtext",i._currentHoverIcon=null,i.numberType=Kg,i.onBeforeAttributeUpdate=function(t,e,n){for(var r in t)if("hoverIconId"===r){if(t[r]===e[r])continue;var a=i._frameCache.icons.get(t[r]);i.updateHoverIconState(a)}},i}return h(e,t),o(e,[{key:"width",get:function(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:qd.width},set:function(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}},{key:"height",get:function(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:qd.height},set:function(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxWidth",get:function(){return this.attribute.maxWidth},set:function(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxHeight",get:function(){return this.attribute.maxHeight},set:function(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}},{key:"ellipsis",get:function(){var t;return null!==(t=this.attribute.ellipsis)&&void 0!==t?t:qd.ellipsis},set:function(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}},{key:"wordBreak",get:function(){var t;return null!==(t=this.attribute.wordBreak)&&void 0!==t?t:qd.wordBreak},set:function(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}},{key:"verticalDirection",get:function(){var t;return null!==(t=this.attribute.verticalDirection)&&void 0!==t?t:qd.verticalDirection},set:function(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}},{key:"textAlign",get:function(){var t;return null!==(t=this.attribute.textAlign)&&void 0!==t?t:qd.textAlign},set:function(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}},{key:"textBaseline",get:function(){var t;return null!==(t=this.attribute.textBaseline)&&void 0!==t?t:qd.textBaseline},set:function(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}},{key:"textConfig",get:function(){var t;return null!==(t=this.attribute.textConfig)&&void 0!==t?t:qd.textConfig},set:function(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}},{key:"getGraphicTheme",value:function(){return vf(this).richtext}},{key:"updateAABBBounds",value:function(t,e,i){var n,r,a,o,s=t.width,l=void 0===s?e.width:s,u=t.height,c=void 0===u?e.height:u,h=t.maxWidth,d=void 0===h?e.maxWidth:h,p=t.maxHeight,f=void 0===p?e.maxHeight:p,v=t.textAlign,g=void 0===v?e.textAlign:v,y=t.textBaseline,m=void 0===y?null!==(r=null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)&&void 0!==r?r:"top":y,_=t.editOptions;if(l>0&&c>0)i.set(0,0,l,c);else{var b=this.getFrameCache().getActualSize(),x=b.width,k=b.height,S=l||x||0,A=c||k||0;A="number"==typeof f&&A>f?f:A||0,S="number"==typeof d&&S>d?d:S||0,i.set(0,0,S,A)}_&&_.keepHeightWhileEmpty&&!i.height()&&!(null===(a=t.textConfig)||void 0===a?void 0:a.length)&&(i.y2=i.y1+(null!==(o=t.fontSize)&&void 0!==o?o:12),i.x2=i.x1+2);var C=0;switch(m){case"top":C=0;break;case"middle":C=-i.height()/2;break;case"bottom":C=-i.height()}var M=0;switch(g){case"left":M=0;break;case"center":M=-i.width()/2;break;case"right":M=-i.width()}return c||("middle"===this.verticalDirection?C-=i.height()/2:"bottom"===this.verticalDirection&&(C-=i.height())),i.translate(M,C),oh.graphicService.updateTempAABBBounds(i),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||oh.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,oh.graphicService.transformAABBBounds(t,i,e,!1,this),0===i.width()&&0===i.height()&&i.clear(),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,l_])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,l_])}},{key:"getFrameCache",value:function(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}},{key:"cliped",get:function(){var t=this.getFrameCache();if(t.actualHeight>t.height)return!0;if(this.attribute.disableAutoWrapLine)for(var e=0;e<t.lines.length;e++)for(var i=t.lines[e],n=0;n<i.paragraphs.length;n++){var r=i.paragraphs[n];if(r.overflow&&""!==r.text)return!0}return!1}},{key:"combinedStyleToCharacter",value:function(t){var e=this.attribute,i=e.fill,n=e.stroke,r=e.fontSize,a=e.fontFamily,o=e.fontStyle,s=e.fontWeight,l=e.lineWidth,u=e.opacity,c=e.fillOpacity,h=e.lineHeight,d=e.strokeOpacity,p=e.upgradeAttrs,f=Object.assign({fill:i,stroke:n,fontSize:r,fontFamily:a,fontStyle:o,fontWeight:s,lineWidth:l,opacity:u,fillOpacity:c,strokeOpacity:d},t);return(null==p?void 0:p.lineHeight)&&(f.lineHeight=h),f}},{key:"doUpdateFrameCache",value:function(t){var i,n=this,r=this.attribute,a=r.maxWidth,o=r.maxHeight,s=r.width,l=r.height,u=r.ellipsis,c=r.wordBreak,h=r.verticalDirection,d=r.textAlign,p=r.textBaseline,f=r.layoutDirection,v=r.singleLine,g=r.disableAutoWrapLine,y=r.editable,m=r.ascentDescentMode,_=r.upgradeAttrs,b=_&&_.multiBreakLine,x=this.attribute.textConfig,k=void 0===x?[]:x;y&&k.length>0&&!e.AllSingleCharacter(k)&&(k=e.TransformTextConfig2SingleCharacter(k),this.attribute.textConfig=k);for(var S=[],A=null!=t?t:k,C=0;C<A.length;C++)if("image"in A[C]){var M=this.combinedStyleToCharacter(A[C]);M.lineWidth=void 0;var w=M.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(M.id);if(w)S.push(w);else{var T=new r_(M);T.successCallback=function(){var t;n.addUpdateBoundTag(),null===(t=n.stage)||void 0===t||t.renderNextFrame()},T.richtextId=M.id,S.push(T)}}else{var D=this.combinedStyleToCharacter(A[C]);if($(D.text)&&(D.text="".concat(D.text)),D.text&&D.text.includes("\n"))for(var E=D.text.split("\n"),B=0;B<E.length;B++)if(0===B)S.push(new t_(E[B],!1,D,m));else if(E[B]||C===A.length-1)S.push(new t_(E[B],!0,D,m));else{var P=this.combinedStyleToCharacter(A[C+1]);S.push(new t_(E[B],!0,P,m))}else D.text&&S.push(new t_(D.text,!1,D,m))}var R="number"==typeof a&&Number.isFinite(a)&&a>0,L="number"==typeof o&&Number.isFinite(o)&&o>0,I="number"==typeof s&&Number.isFinite(s)&&s>0&&(!R||s<=a),F="number"==typeof l&&Number.isFinite(l)&&l>0&&(!L||l<=o),O=new Qm(0,0,(I?s:R?a:0)||0,(F?l:L?o:0)||0,u,c,h,d,p,f||"horizontal",!I&&R,!F&&L,v||!1,null===(i=this._frameCache)||void 0===i?void 0:i.icons),z=new o_(O);if(z.newLine=b,g)for(var H=0,N=!1,U=0;U<S.length;U++){var j=S[U];N?(j.overflow=!0,j.left=1/0,j.top=1/0,!j.newLine&&O.lines[O.lines.length-1].paragraphs.push(j)):z.deal(j,!0),O.lines.length!==H&&(H=O.lines.length,z.lineBuffer.length=0,j.overflow=!0,j.left=1e3,j.top=1e3,O.lines[O.lines.length-1].paragraphs.push(j),N=!0),j.newLine&&(N=!1,z.lineWidth=0),z.send()}else for(var V=0;V<S.length;V++)z.deal(S[V]);if(z.send(),!("horizontal"===O.layoutDirection?I:F)){var W=O.getActualSizeWidthEllipsis(),G="horizontal"===O.layoutDirection?W.width:W.height;("horizontal"===O.layoutDirection?R:L)&&(G=Math.min(G,"horizontal"===O.layoutDirection?a:o)),O.lines.forEach((function(t){t.calcOffset(G,!1)}))}b&&O.lines.forEach((function(t){var e=t.paragraphs;t.paragraphs=t.paragraphs.filter((function(t){return""!==t.text})),0===t.paragraphs.length&&e.length&&(e[0].text="\n",t.paragraphs.push(e[0]))})),this._frameCache=O}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"setStage",value:function(t,i){_(e,"setStage",this,3)([t,i]),this.getFrameCache().icons.forEach((function(e){e.setStage(t,i)}))}},{key:"bindIconEvent",value:function(){var t=this;this.addEventListener("pointermove",(function(e){var i=t.pickIcon(e.global);i&&i===t._currentHoverIcon||(i?t.setAttribute("hoverIconId",i.richtextId):!i&&t._currentHoverIcon&&t.setAttribute("hoverIconId",void 0))})),this.addEventListener("pointerleave",(function(e){t._currentHoverIcon&&t.setAttribute("hoverIconId",void 0)}))}},{key:"updateHoverIconState",value:function(t){var e,i,n,r,a;t?(null===(e=this._currentHoverIcon)||void 0===e||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),null===(i=this.stage)||void 0===i||i.setCursor(t.attribute.cursor),null===(n=this.stage)||void 0===n||n.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null===(r=this.stage)||void 0===r||r.setCursor(),null===(a=this.stage)||void 0===a||a.renderNextFrame())}},{key:"pickIcon",value:function(t){var e,i=this.getFrameCache(),n=this.globalTransMatrix,r=n.e,a=n.f;return i.icons.forEach((function(i,n){var o,s,l=i.AABBBounds.clone();l.translate(i._marginArray[3],i._marginArray[0]),l.containsPoint({x:t.x-r,y:t.y-a})&&(e=i,e.globalX=(null!==(o=e.attribute.x)&&void 0!==o?o:0)+r+i._marginArray[3],e.globalY=(null!==(s=e.attribute.y)&&void 0!==s?s:0)+a+i._marginArray[0])})),e}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}],[{key:"AllSingleCharacter",value:function(t){return t.lines?t.lines.every((function(t){return t.paragraphs.every((function(t){return!(t.text&&q(t.text)&&e.splitText(t.text).length>1)}))})):t.every((function(t){return t.isComposing||!(t.text&&q(t.text)&&e.splitText(t.text).length>1)}))}},{key:"splitText",value:function(t){if(s_){var e,i=[],n=s(new Intl.Segmenter(void 0,{granularity:"grapheme"}).segment(t));try{for(n.s();!(e=n.n()).done;){var r=e.value.segment;i.push(r)}}catch(t){n.e(t)}finally{n.f()}return i}return Array.from(t)}},{key:"TransformTextConfig2SingleCharacter",value:function(t){var i=[];return t.forEach((function(t){var n=e.splitText(t.text.toString());if(q(t.text)&&n.length>1)for(var r=0;r<n.length;r++){var a=n[r];i.push(Object.assign(Object.assign({},t),{text:a}))}else i.push(t)})),i}}])}(Uy);function c_(t){return new u_(t)}u_.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},Ny);var h_=["path","customPath"].concat(b(Iy)),d_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="path",i.numberType=Vg,i}return h(e,t),o(e,[{key:"pathShape",get:function(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}},{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.path;return null!=t&&""!==t}},{key:"getParsedPathShape",value:function(){var t=this.getGraphicTheme();if(!this.valid)return t.path;var e=this.attribute;return e.path instanceof Md?e.path:(j(this.cache)&&this.doUpdatePathShape(),this.cache instanceof Md?this.cache:t.path)}},{key:"getGraphicTheme",value:function(){return vf(this).path}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=this.getParsedPathShape();i.union(n.getBounds())}var r=oh.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;Dm(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return oh.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"doUpdateAABBBounds",value:function(t){return this.doUpdatePathShape(),_(e,"doUpdateAABBBounds",this,3)([t])}},{key:"doUpdatePathShape",value:function(){var t=this.attribute;q(t.path,!0)?this.cache=(new Md).fromString(t.path):t.customPath&&(this.cache=new Md,t.customPath(this.cache,this))}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,h_])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,h_])}},{key:"toCustomPath",value:function(){return(new Md).fromCustomPath2D(this.getParsedPathShape(),0,0)}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function p_(t){return new d_(t)}d_.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},Ny);var f_=["segments","points","curveType","curveTension"].concat(b(Iy)),v_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="area",i.numberType=Og,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!!e&&0!==e.length}},{key:"getGraphicTheme",value:function(){return vf(this).area}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i):this.updateAreaAABBBoundsByPoints(t,e,i)),oh.graphicService.updateTempAABBBounds(i),this.setWidthHeightWithoutTransform(i);var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return oh.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updateAreaAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,a=void 0===r?e.points:r,o=i;return a.forEach((function(t){var e,i;o.add(t.x,t.y),o.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)})),o}},{key:"updateAreaAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,a=void 0===r?e.segments:r,o=i;return a.forEach((function(t){t.points.forEach((function(t){var e,i;o.add(t.x,t.y),o.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)}))})),o}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=Hf(i,n,e))}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,f_])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,f_])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;t=new Md;var i=this.attribute,n=i.segments,r=function(e){if(e&&e.length){var i=!0,n=[];if(e.forEach((function(e){var r,a;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),n.push({x:null!==(r=e.x1)&&void 0!==r?r:e.x,y:null!==(a=e.y1)&&void 0!==a?a:e.y}),i=!1)})),n.length){for(var r=n.length-1;r>=0;r--)t.lineTo(n[r].x,n[r].y);t.closePath()}}};return i.points?r(i.points):n&&n.length&&n.forEach((function(t){r(t.points)})),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function g_(t){return new v_(t)}v_.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},Ny);var y_=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap"].concat(b(Iy)),m_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="arc",i.numberType=Ig,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.outerRadius,r=t.innerRadius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)&&this._validNumber(r)}},{key:"getParsedCornerRadius",value:function(){var t=this.getGraphicTheme(),e=this.attribute,i=e.cornerRadius,n=void 0===i?t.cornerRadius:i,r=e.innerPadding,a=void 0===r?t.innerPadding:r,o=e.outerPadding,s=void 0===o?t.outerPadding:o,l=this.attribute,u=l.outerRadius,c=void 0===u?t.outerRadius:u,h=l.innerRadius,d=void 0===h?t.innerRadius:h;if(c+=s,d-=a,0===n||"0%"===n)return 0;var p=Math.abs(c-d),f=function(t){return Math.min($(t,!0)?t:p*parseFloat(t)/100,p/2)};if(Z(n)){var v=n.map((function(t){return f(t)||0}));return 0===v.length?[v[0],v[0],v[0],v[0]]:2===v.length?[v[0],v[1],v[0],v[1]]:(3===v.length&&v.push(0),v)}return f(n)}},{key:"getParsedAngle",value:function(){var t=this.getGraphicTheme(),e=this.attribute,i=e.startAngle,n=void 0===i?t.startAngle:i,r=e.endAngle,a=void 0===r?t.endAngle:r,o=this.attribute.cap,s=void 0===o?t.cap:o,l=a-n>=0?1:-1,u=a-n;if(a=(n=Di(n))+u,s&&ii(u)<ei-Je){var c=1,h=1;s.length&&(c=Number(s[0]),h=Number(s[1]));var d=this.attribute,p=d.outerRadius,f=void 0===p?t.outerRadius:p,v=d.innerRadius,g=void 0===v?t.innerRadius:v,y=this.attribute,m=y.outerPadding,_=void 0===m?t.outerPadding:m,b=y.innerPadding;f+=_,g-=void 0===b?t.innerPadding:b;var x=Math.abs(f-g)/2,k=x/f;if(x>Je&&f>Je)return{startAngle:n-l*k*c,endAngle:a+l*k*h,sc:l*k*c,ec:l*k*h}}return{startAngle:n,endAngle:a}}},{key:"getParsePadAngle",value:function(t,e){var i=this.getGraphicTheme(),n=this.attribute,r=n.innerPadding,a=void 0===r?i.innerPadding:r,o=n.outerPadding,s=void 0===o?i.outerPadding:o,l=n.padAngle,u=void 0===l?i.padAngle:l,c=this.attribute,h=c.outerRadius,d=void 0===h?i.outerRadius:h,p=c.innerRadius,f=void 0===p?i.innerRadius:p;d+=s,f-=a;var v=this.attribute.padRadius,g=void 0===v?li(d*d+f*f):v,y=ii(e-t),m=t,_=e,b=t,x=e,k=u/2,S=y,A=y;if(k>Je&&g>Je){var C=e>t?1:-1,M=hi(Number(g)/f*si(k)),w=hi(Number(g)/d*si(k));return(S-=2*M)>Je?(b+=M*=C,x-=M):(S=0,b=x=(t+e)/2),(A-=2*w)>Je?(m+=w*=C,_-=w):(A=0,m=_=(t+e)/2),{outerStartAngle:m,outerEndAngle:_,innerStartAngle:b,innerEndAngle:x,innerDeltaAngle:S,outerDeltaAngle:A}}return{outerStartAngle:m,outerEndAngle:_,innerStartAngle:b,innerEndAngle:x,innerDeltaAngle:S,outerDeltaAngle:A}}},{key:"getGraphicTheme",value:function(){return vf(this).arc}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));var r=oh.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;Dm(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.setWidthHeightWithoutTransform(i);var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return oh.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"updateArcAABBBoundsImprecise",value:function(t,e,i){var n=t.outerRadius,r=void 0===n?e.outerRadius:n,a=t.innerRadius,o=void 0===a?e.innerRadius:a,s=t.outerPadding,l=void 0===s?e.outerPadding:s,u=t.innerPadding;return(r+=l)<(o-=void 0===u?e.innerPadding:u)&&(r=o),i.set(-r,-r,r,r),i}},{key:"updateArcAABBBoundsAccurate",value:function(t,e,i){var n=t.outerRadius,r=void 0===n?e.outerRadius:n,a=t.innerRadius,o=void 0===a?e.innerRadius:a,s=t.outerPadding,l=void 0===s?e.outerPadding:s,u=t.innerPadding;if((r+=l)<(o-=void 0===u?e.innerPadding:u)){var c=r;r=o,o=c}var h=t.endAngle,d=void 0===h?e.endAngle:h,p=t.startAngle,f=void 0===p?e.startAngle:p;if(f>d){var v=f;f=d,d=v}return r<=Je?i.set(0,0,0,0):Math.abs(d-f)>ei-Je?i.set(-r,-r,r,r):(Of(f,d,r,i),Of(f,d,o,i)),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,y_])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,y_])}},{key:"toCustomPath",value:function(){var t,i,n,r,a=_(e,"toCustomPath",this,3)([]);if(a)return a;var o=this.attribute,s=this.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=(null!==(t=o.innerRadius)&&void 0!==t?t:0)-(null!==(i=o.innerPadding)&&void 0!==i?i:0),h=(null!==(n=o.outerRadius)&&void 0!==n?n:0)-(null!==(r=o.outerPadding)&&void 0!==r?r:0),d=ii(u-l),p=u>l;if(h<c){var f=h;h=c,c=f}if(a=new Md,h<=Je)a.moveTo(0,0);else if(d>=ei-Je)a.moveTo(0+h*ri(l),0+h*si(l)),a.arc(0,0,h,l,u,!p),c>Je&&(a.moveTo(0+c*ri(u),0+c*si(u)),a.arc(0,0,c,u,l,p));else{var v=h*ri(l),g=h*si(l),y=c*ri(u),m=c*si(u);a.moveTo(0+v,0+g),a.arc(0,0,h,l,u,!p),a.lineTo(0+y,0+m),a.arc(0,0,c,u,l,p),a.closePath()}return a}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function __(t){return new m_(t)}m_.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},Ny);var b_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="arc3d",i.numberType=Fg,i}return h(e,t),o(e,[{key:"updateAABBBounds",value:function(t,e,i){var n=this.stage;if(!n||!n.camera)return i;var r=t.outerRadius,a=void 0===r?e.outerRadius:r,o=t.height,s=a+(void 0===o?0:o);return i.setValue(-s,-s,s,s),oh.graphicService.updateTempAABBBounds(i),oh.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(m_);function x_(t){return new b_(t)}b_.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},Ny);var k_=["points","cornerRadius"].concat(b(Iy)),S_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="polygon",i.numberType=Wg,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.points;return t&&t.length>=2}},{key:"getGraphicTheme",value:function(){return vf(this).polygon}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),oh.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return oh.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updatePolygonAABBBoundsImprecise",value:function(t,e,i){var n=t.points;return(void 0===n?e.points:n).forEach((function(t){i.add(t.x,t.y)})),i}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=Hf(i,n,e))}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,k_])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,k_])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;var i=this.attribute.points;return t=new Md,i.forEach((function(e,i){0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Uy);function A_(t){return new S_(t)}S_.NOWORK_ANIMATE_ATTR=Ny;var C_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="pyramid3d",i.numberType=Gg,i}return h(e,t),o(e,[{key:"updateAABBBounds",value:function(t,e,i){var n=this.stage;return n&&n.camera?(this.findFace().vertices.forEach((function(t){var e=t[0],n=t[1];i.add(e,n)})),oh.graphicService.updateTempAABBBounds(i),oh.graphicService.transformAABBBounds(t,i,e,!1,this),i):i}},{key:"findFace",value:function(){for(var t=this.attribute.points,e=t.map((function(e,i){var n=3===i?t[0]:t[i+1],r=e.x-n.x;return 0===r?0:(e.y-n.y)/r})),i=t.map((function(t){return{p:t,d:0}})),n=!1,r=0,a=0;a<e.length-1;a++){for(var o=a+1;o<e.length;o++){if(e[a]===e[o]){n=!0;var s=Si.distancePP(i[a].p,i[a+1].p);i[a].d=s,i[a+1].d=s,r=ai(r,s);var l=Si.distancePP(i[o].p,i[o+1].p);i[o].d=l,i[o+1].d=l,r=ai(r,l)}if(n)break}if(n)break}for(var u=t.length-1;u>=0;u--){var c=t[u];i.unshift({p:c,d:0})}for(var h=0;h<t.length;h++){var d=(r-i[h+t.length].d)/2;i[h].d+=d,i[h+t.length].d+=d}var p={polygons:[],vertices:[],edges:[]};return i.forEach((function(t){p.vertices.push([t.p.x,t.p.y,t.d])})),p.polygons.push({polygon:[0,4,5,1],normal:[0,-1,0]}),p.polygons.push({polygon:[7,6,2,3],normal:[0,1,0]}),p.polygons.push({polygon:[0,4,7,3],normal:[-1,0,0]}),p.polygons.push({polygon:[1,5,6,2],normal:[1,0,0]}),p.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),p.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),p.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],p}},{key:"_isValid",value:function(){return _(e,"_isValid",this,3)([])&&4===this.attribute.points.length}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(S_);function M_(t){return new C_(t)}C_.NOWORK_ANIMATE_ATTR=Ny;var w_=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[{x:0,y:0}])).type="shadowroot",i.shadowHost=t,i}return h(e,t),o(e,[{key:"clearUpdateBoundTag",value:function(){_(e,"clearUpdateBoundTag",this,3)([]),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}},{key:"addUpdateBoundTag",value:function(){_(e,"addUpdateBoundTag",this,3)([]),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"addUpdateShapeAndBoundsTag",value:function(){_(e,"addUpdateShapeAndBoundsTag",this,3)([]),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){var e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"doUpdateGlobalMatrix",value:function(){if(this.shadowHost){var t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}},{key:"tryUpdateGlobalAABBBounds",value:function(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}])}(jy);function T_(t){return new w_(t)}var D_,E_,B_=new(function(){return o((function t(){r(this,t),this.store=new Map}),[{key:"RegisterGraphicCreator",value:function(t,e){this.store.set(t,e),this[t]=e}},{key:"CreateGraphic",value:function(t,e){var i=this.store.get(t);return i?i(e):null}}])}());function P_(t){return D_||(D_=B_.CreateGraphic("text",{})),D_.initAttributes(t),D_.AABBBounds}var R_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},L_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},I_=function(t,e){return function(i,n){e(i,n,t)}},F_=function(){return o((function t(){r(this,t),this.time=Mh.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f=t.attribute,v=f.background,g=f.backgroundOpacity,y=void 0===g?null!==(p=t.attribute.fillOpacity)&&void 0!==p?p:l.backgroundOpacity:g,m=f.opacity,_=void 0===m?l.opacity:m,b=f.backgroundMode,x=void 0===b?l.backgroundMode:b,k=f.backgroundFit,S=void 0===k?l.backgroundFit:k,A=f.backgroundKeepAspectRatio,C=void 0===A?l.backgroundKeepAspectRatio:A,M=f.backgroundScale,w=void 0===M?l.backgroundScale:M,T=f.backgroundOffsetX,D=void 0===T?l.backgroundOffsetX:T,E=f.backgroundOffsetY,B=void 0===E?l.backgroundOffsetY:E,P=f.backgroundClip,R=void 0===P?l.backgroundClip:P;if(v)if(t.backgroundImg&&t.resources){var L=t.resources.get(v);if("success"!==L.state||!L.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){var I=vf(t.parent).group,F=t.parent.attribute,O=F.scrollX,z=void 0===O?I.scrollX:O,H=F.scrollY,N=void 0===H?I.scrollY:H;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(z,N)}R&&e.clip();var U=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,n,l),e.globalAlpha=y*_,this.doDrawImage(e,L.data,U,{backgroundMode:x,backgroundFit:S,backgroundKeepAspectRatio:C,backgroundScale:w,backgroundOffsetX:D,backgroundOffsetY:B}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.globalAlpha=y*_,e.fillStyle=v,e.fill(),e.highPerformanceRestore()}},{key:"doDrawImage",value:function(t,e,i,n){var r=n.backgroundMode,a=n.backgroundFit,o=n.backgroundKeepAspectRatio,s=n.backgroundScale,l=void 0===s?1:s,u=n.backgroundOffsetX,c=void 0===u?0:u,h=n.backgroundOffsetY,d=void 0===h?0:h,p=i.width(),f=i.height(),v=p,g=f;if("no-repeat"===r)if(a)if(o){var y=Math.max(p/e.width,f/e.height);t.drawImage(e,i.x1+c,i.y1+d,e.width*y*l,e.height*y*l)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{var m=e.width*l,_=e.height*l;t.drawImage(e,i.x1+c,i.y1+d,m,_)}else{if(a&&"repeat"!==r&&(e.width||e.height)){var b=e.width,x=e.height;"repeat-x"===r?(v=b*(f/x),g=f):"repeat-y"===r&&(g=x*(p/b),v=p);var k=t.dpr,S=qp.allocate({width:v,height:g,dpr:k}),A=S.getContext("2d");A&&(A.inuse=!0,A.clearMatrix(),A.setTransformForCurrent(!0),A.clearRect(0,0,v,g),A.drawImage(e,0,0,v,g),e=S.nativeCanvas),qp.free(S)}var C=t.dpr,M=t.createPattern(e,r);M.setTransform&&M.setTransform(new DOMMatrix([1/C,0,0,1/C,0,0])),t.fillStyle=M,t.translate(i.x1,i.y1),t.fillRect(0,0,p,f),t.translate(-i.x1,-i.y1)}}}])}(),O_=new F_,z_=function(){return o((function t(e){r(this,t),this.subRenderContribitions=e,this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach((function(p){p.render(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}}])}();z_=R_([Dc(),I_(0,wc(Yc)),I_(0,Ec(xm)),L_("design:paramtypes",[Object])],z_);var H_=function(){return o((function t(){r(this,t),this.time=Mh.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f;if(t.attribute.clipConfig){var v=t.getClipPath();if(v){var g=!(c||h),y=t.AABBBounds,m=null!==(p=t.attribute.width)&&void 0!==p?p:y.width(),_=null!==(f=t.attribute.height)&&void 0!==f?f:y.height();g&&e.save(),e.beginPath(),!1===v.draw(e,[m,_],i+m/2,n+_/2,0)&&e.closePath(),c&&c(e,t.attribute,l,!0),g&&e.clip()}}}}])}(),N_=new H_,U_=new(function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){t.attribute.clipConfig&&t.getClipPath()&&(c||h||e.restore())}}])}());var j_=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}),[{key:"createCommonPattern",value:function(t,e,i,n,r){var a=(t-2*e)/2,o=n.dpr,s=qp.allocate({width:t,height:t,dpr:o}),l=s.getContext("2d");if(!l)return null;l.inuse=!0,l.clearMatrix(),l.setTransformForCurrent(!0),l.clearRect(0,0,t,t),r(a,l);var u=n.createPattern(s.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/o,0,0,1/o,0,0])),qp.free(s),u}},{key:"createCirclePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,e){e.fillStyle=i,e.arc(t,t,t,0,ei),e.fill()}))}},{key:"createDiamondPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){var r=t/2,a=r;n.fillStyle=i,n.moveTo(r,a-e),n.lineTo(e+r,a),n.lineTo(r,a+e),n.lineTo(r-e,a),n.closePath(),n.fill()}))}},{key:"createRectPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,a=r;n.fillStyle=i,n.fillRect(r,a,2*t,2*t)}))}},{key:"createVerticalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var a=e;r.fillStyle=i,r.fillRect(a,0,2*n,t)}))}},{key:"createHorizontalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var a=e;r.fillStyle=i,r.fillRect(0,a,t,2*n)}))}},{key:"createBiasLRLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(0,0),n.lineTo(t,t);var r=t/2,a=-r;n.moveTo(r,a),n.lineTo(r+t,a+t),n.moveTo(-r,-a),n.lineTo(-r+t,-a+t),n.stroke()}))}},{key:"createBiasRLLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(t,0),n.lineTo(0,t);var r=t/2,a=r;n.moveTo(t+r,a),n.lineTo(r,a+t),n.moveTo(t-r,-a),n.lineTo(-r,-a+t),n.stroke()}))}},{key:"createGridPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,a=r;n.fillStyle=i,n.fillRect(r,a,t,t),n.fillRect(r+t,a+t,t,t)}))}},{key:"initTextureMap",value:function(t,e){this.textureMap=new Map}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this.textureMap||this.initTextureMap(e,t.stage);var p=t.attribute,f=p.texture,v=void 0===f?l.texture:f,g=p.textureColor,y=void 0===g?l.textureColor:g,m=p.textureSize,_=void 0===m?l.textureSize:m,b=p.texturePadding,x=void 0===b?l.texturePadding:b;v&&this.drawTexture(v,t,e,i,n,l,y,_,x)}},{key:"drawTexture",value:function(t,e,i,n,r,a,o,s,l){var u,c=e.attribute,h=c.textureRatio,d=void 0===h?a.textureRatio:h,p=c.textureOptions,f=void 0===p?null:p,v=this.textureMap.get(t);if(!v)switch(t){case"circle":v=this.createCirclePattern(s,l,o,i);break;case"diamond":v=this.createDiamondPattern(s,l,o,i);break;case"rect":v=this.createRectPattern(s,l,o,i);break;case"vertical-line":v=this.createVerticalLinePattern(s,l,o,i);break;case"horizontal-line":v=this.createHorizontalLinePattern(s,l,o,i);break;case"bias-lr":v=this.createBiasLRLinePattern(s,l,o,i);break;case"bias-rl":v=this.createBiasRLLinePattern(s,l,o,i);break;case"grid":v=this.createGridPattern(s,l,o,i)}if(f&&f.dynamicTexture){var g=f.gridConfig,y=void 0===g?{}:g,m=f.useNewCanvas,_=e.AABBBounds;n=_.x1,r=_.y1;var b,x=i;if(m){var k=(b=qp.allocate({width:_.width(),height:_.height(),dpr:i.dpr})).getContext("2d");k.clearRect(0,0,_.width(),_.height()),n=0,r=0,i=k}if(x.save(),e.parent&&!e.transMatrix.onlyTranslate()){var S=e.parent.attribute,A=S.scrollX,C=void 0===A?0:A,M=S.scrollY,w=void 0===M?0:M;x.setTransformFromMatrix(e.parent.globalTransMatrix),x.translate(C,w,!0)}x.setCommonStyle(e,e.attribute,n,r,a),x.clip();var T=_.width(),D=_.height(),E=l,B=s,P=y.columns?y.columns:Math.ceil(T/B),R=y.rows?y.rows:Math.ceil(D/B),L=y.gutterColumn?y.gutterColumn:2*E,I=y.gutterRow?y.gutterRow:2*E;this._tempSymbolGraphic||(this._tempSymbolGraphic=Hm({}));var F=y.columns?T/y.columns:B,O=y.rows?D/y.rows:B;this._tempSymbolGraphic.setAttributes({size:[F-L,O-I],symbolType:t});for(var z=this._tempSymbolGraphic.getParsedPath(),H=0;H<R;H++)for(var N=0;N<P;N++){var U=n+B/2+N*B,j=r+B/2+H*B;null===(u=f.beforeDynamicTexture)||void 0===u||u.call(f,i,H,N,R,P,d,e,_.width(),_.height()),i.beginPath(),!1===z.draw(i,Math.min(F-L,O-I),U,j,0)&&i.closePath(),i.fillStyle=o,f.dynamicTexture(i,H,N,R,P,d,e,_.width(),_.height())}m&&(x.globalAlpha=1,x.drawImage(b.nativeCanvas,0,0,b.nativeCanvas.width,b.nativeCanvas.height,_.x1,_.y1,_.width()*x.dpr,_.height()*x.dpr)),x.restore()}else if(v)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,r,a),i.fillStyle=v,i.fill(),i.highPerformanceRestore();else if("wave"===t){i.save(),i.setCommonStyle(e,e.attribute,n,r,a),i.clip();var V=e.AABBBounds;(function(t,e,i,n,r,a,o){var s=r.fill,l=void 0===s?"orange":s,u=r.percent,c=void 0===u?.6:u,h=r.frequency,d=void 0===h?4:h,p=r.opacity,f=r.phi,v=void 0===f?0:f,g=r.amplitude,y=void 0===g?10:g;y*=function(t){return t<=.5?4*t-1:-4*t+3}(e);var m=n*(1-c),_=i,b=Math.max(Math.round(_/70),2);t.beginPath(),t.moveTo(0+a,n+o),t.lineTo(0+a,m+o);for(var x=_/d*e,k=_/Math.PI/(2*d),S=0;S<_;S+=b){var A=y*Math.sin((S+x+v)/k+v);t.lineTo(S+a,m+A+o)}t.lineTo(_+a,n+o),t.closePath(),t.fillStyle=l,isFinite(p)&&(t.globalAlpha=p),t.fill()})(i,d,V.width(),V.height(),Object.assign(Object.assign({},f||{}),{fill:o}),n+V.x1-n,r+V.y1-r),i.restore()}}}])}(),V_=new j_,W_=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.innerPadding,_=void 0===m?l.innerPadding:m,b=y.outerPadding,x=void 0===b?l.outerPadding:b,k=y.startAngle,S=void 0===k?l.startAngle:k,A=y.endAngle,C=void 0===A?l.endAngle:A,M=y.opacity,w=void 0===M?l.opacity:M,T=y.x,D=void 0===T?l.x:T,E=y.y,B=void 0===E?l.y:E,P=y.scaleX,R=void 0===P?l.scaleX:P,L=y.scaleY,I=void 0===L?l.scaleY:L,F=y.keepStrokeScale,O=void 0===F?l.keepStrokeScale:F,z=t.attribute,H=z.innerRadius,N=void 0===H?l.innerRadius:H,U=z.outerRadius,j=void 0===U?l.outerRadius:U;j+=x,N-=_;var V=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=O?u:tp(e,u,e.dpr),d=u/j,p="outerBorder"===a?1:-1;if(t.setAttributes({outerRadius:j+p*c,innerRadius:N-p*c,startAngle:S-p*d,endAngle:C+p*d}),e.beginPath(),cm(t,e,i,n,j+p*c,N-p*c),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var f=l[a].opacity;l[a].opacity=w,e.setStrokeStyle(t,r,(D-i)/R,(B-n)/I,l[a]),l[a].opacity=f,e.stroke()}};v&&V(p,"outerBorder"),g&&V(f,"innerBorder"),t.setAttributes({outerRadius:j,innerRadius:N,startAngle:S,endAngle:C})}}}])}(),G_=new W_,Y_=V_,X_=O_,K_=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.radius,_=void 0===m?l.radius:m,b=y.startAngle,x=void 0===b?l.startAngle:b,k=y.endAngle,S=void 0===k?l.endAngle:k,A=y.opacity,C=void 0===A?l.opacity:A,M=y.x,w=void 0===M?l.x:M,T=y.y,D=void 0===T?l.y:T,E=y.scaleX,B=void 0===E?l.scaleX:E,P=y.scaleY,R=void 0===P?l.scaleY:P,L=y.keepStrokeScale,I=void 0===L?l.keepStrokeScale:L,F=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=I?u:tp(e,u,e.dpr),d="outerBorder"===a?1:-1;if(e.beginPath(),e.arc(i,n,_+d*c,x,S),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var p=l[a].opacity;l[a].opacity=C,e.setStrokeStyle(t,r,(w-i)/B,(D-n)/R,l[a]),l[a].opacity=p,e.stroke()}};v&&F(p,"outerBorder"),g&&F(f,"innerBorder")}}}])}(),q_=new K_,Z_=V_,J_=O_,Q_=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Mh.beforeFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.background,f=d.backgroundMode,v=void 0===f?l.backgroundMode:f,g=d.backgroundFit,y=void 0===g?l.backgroundFit:g,m=d.backgroundKeepAspectRatio,_=void 0===m?l.backgroundKeepAspectRatio:m,b=d.backgroundScale,x=void 0===b?l.backgroundScale:b,k=d.backgroundOffsetX,S=void 0===k?l.backgroundOffsetX:k,A=d.backgroundOffsetY,C=void 0===A?l.backgroundOffsetY:A;if(p)if(t.backgroundImg&&t.resources){var M=t.resources.get(p);if("success"!==M.state||!M.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);var w=t.AABBBounds;this.doDrawImage(e,M.data,w,{backgroundMode:v,backgroundFit:y,backgroundKeepAspectRatio:_,backgroundScale:x,backgroundOffsetX:S,backgroundOffsetY:C}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=p,e.fill(),e.highPerformanceRestore()}}])}(F_),$_=new Q_,tb=Qe/2;function eb(t,e,i,n,r,a){var o,s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7?arguments[7]:void 0;if(Array.isArray(s)&&(l=s,s=!0),n<0&&(e+=n,n=-n),r<0&&(i+=r,r=-r),$(a,!0))o=[a=ii(a),a,a,a];else if(Array.isArray(a)){var u,c,h=a;switch(h.length){case 0:o=[0,0,0,0];break;case 1:o=[u=ii(h[0]),u,u,u];break;case 2:case 3:o=[u=ii(h[0]),c=ii(h[1]),u,c];break;default:(o=h)[0]=ii(o[0]),o[1]=ii(o[1]),o[2]=ii(o[2]),o[3]=ii(o[3])}}else o=[0,0,0,0];if(n<0||o[0]+o[1]+o[2]+o[3]<1e-12)return t.rect(e,i,n,r);var d=[e,i],p=[e+n,i],f=[e+n,i+r],v=[e,i+r],g=Math.min(n/2,r/2),y=[Math.min(g,o[0]),Math.min(g,o[1]),Math.min(g,o[2]),Math.min(g,o[3])],m=[d[0]+y[0],d[1]],_=[d[0],d[1]+y[0]],b=[p[0]-y[1],p[1]],x=[p[0],p[1]+y[1]],k=[f[0]-y[2],f[1]],S=[f[0],f[1]-y[2]],A=[v[0]+y[3],v[1]],C=[v[0],v[1]-y[3]];if(t.moveTo(m[0],m[1]),s){if(l&&l[0]?l[0](m[0],m[1],b[0],b[1]):t.lineTo(b[0],b[1]),!Rt(b,x)){l&&l[0]&&t.moveTo(b[0],b[1]);var M=b[0],w=b[1]+y[1];t.arc(M,w,y[1],-tb,0,!1)}if(l&&l[1]?l[1](x[0],x[1],S[0],S[1]):t.lineTo(S[0],S[1]),!Rt(k,S)){var T=S[0]-y[2],D=S[1];l&&l[1]&&t.moveTo(S[0],S[1]),t.arc(T,D,y[2],0,tb,!1)}if(l&&l[2]?l[2](k[0],k[1],A[0],A[1]):t.lineTo(A[0],A[1]),!Rt(A,C)){var E=A[0],B=A[1]-y[3];l&&l[2]&&t.moveTo(A[0],A[1]),t.arc(E,B,y[3],tb,Qe,!1)}if(l&&l[3]?l[3](C[0],C[1],_[0],_[1]):t.lineTo(_[0],_[1]),!Rt(m,_)){var P=m[0],R=m[1]+y[0];l&&l[3]&&t.moveTo(_[0],_[1]),t.arc(P,R,y[0],Qe,Qe+tb,!1)}}else l&&l[0]?l[0](m[0],m[1],b[0],b[1]):t.lineTo(b[0],b[1]),l&&l[1]?l[1](b[0],b[1],k[0],k[1]):t.lineTo(k[0],k[1]),l&&l[2]?l[2](k[0],k[1],A[0],A[1]):t.lineTo(A[0],A[1]),l&&l[2]?l[2](A[0],A[1],m[0],m[1]):t.lineTo(m[0],m[1]);return!l&&t.closePath(),t}var ib=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nb=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.cornerRadius,_=void 0===m?l.cornerRadius:m,b=y.cornerType,x=void 0===b?l.cornerType:b,k=y.opacity,S=void 0===k?l.opacity:k,A=y.x,C=void 0===A?l.x:A,M=y.y,w=void 0===M?l.y:M,T=y.scaleX,D=void 0===T?l.scaleX:T,E=y.scaleY,B=void 0===E?l.scaleY:E,P=y.x1,R=y.y1,L=y.keepStrokeScale,I=void 0===L?l.keepStrokeScale:L,F=t.attribute,O=F.width,z=F.height;O=(null!=O?O:P-i)||0,z=(null!=z?z:R-n)||0;var H=function(r,a){var o=!(!r||!r.stroke),s="outerBorder"===a?-1:1,u=r.distance,c=void 0===u?l[a].distance:u,d=I?c:tp(e,c,e.dpr),p=i+s*d,f=n+s*d,v=2*d;if(0===_||Z(_)&&_.every((function(t){return 0===t}))?(e.beginPath(),e.rect(p,f,O-s*v,z-s*v)):(e.beginPath(),eb(e,p,f,O-s*v,z-s*v,_,"bevel"!==x)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var g=l[a].opacity;l[a].opacity=S,e.setStrokeStyle(t,r,(C-i)/D,(w-n)/B,l[a]),l[a].opacity=g,e.stroke()}};v&&H(p,"outerBorder"),g&&H(f,"innerBorder")}}}])}(),rb=function(){return o((function t(){r(this,t),this.time=Mh.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p=t.attribute.stroke,f=void 0===p?l.stroke:p;Array.isArray(f)&&f.some((function(t){return!1===t}))&&(d.doStroke=!1)}}])}();rb=ib([Dc()],rb);var ab=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.x1,f=d.y1,v=d.x,g=void 0===v?l.x:v,y=d.y,m=void 0===y?l.y:y,_=d.stroke,b=void 0===_?l.stroke:_,x=d.cornerRadius,k=void 0===x?l.cornerRadius:x,S=d.cornerType,A=void 0===S?l.cornerType:S,C=t.attribute,M=C.width,w=C.height;if(M=(null!=M?M:p-g)||0,w=(null!=w?w:f-m)||0,Array.isArray(b)&&b.some((function(t){return!1===t}))){if(e.setStrokeStyle(t,t.attribute,i,n,l),!(0===k||Z(k)&&k.every((function(t){return 0===t})))){var T,D=0;return eb(e,i,n,M,w,k,"bevel"!==A,new Array(4).fill(0).map((function(r,a){return function(r,o,s,u){b[a]&&(D===a-1&&b[a]===T||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:b[a]}),i,n,l),e.beginPath(),e.moveTo(r,o),T=b[a]),D=a,e.lineTo(s,u),e.stroke(),3===a&&e.beginPath())}}))),void e.stroke()}if(e.beginPath(),e.moveTo(i,n),b[0]?e.lineTo(i+M,n):e.moveTo(i+M,n),b[1]?e.lineTo(i+M,n+w):e.moveTo(i+M,n+w),b[2]?e.lineTo(i,n+w):e.moveTo(i,n+w),b[3]){var E=b[0]?n-e.lineWidth/2:n;e.lineTo(i,E)}else e.moveTo(i,n);e.stroke()}}}])}();ab=ib([Dc()],ab);var ob=new nb,sb=V_,lb=O_,ub=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Mh.afterFillStroke,t.useStyle=!0,t.order=0,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s,l,u,c,h,d){return _(e,"drawShape",this,3)([t,i,n,r,a,o,s,l,u,c,h,d])}}])}(nb),cb=new ub,hb=O_,db=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.getParsedPath();if(d){var p=t.attribute,f=p.outerBorder,v=p.innerBorder,g=f&&!1!==f.visible,y=v&&!1!==v.visible;if(g||y){var m=t.attribute,_=m.size,b=void 0===_?l.size:_,x=m.opacity,k=void 0===x?l.opacity:x,S=m.x,A=void 0===S?l.x:S,C=m.y,M=void 0===C?l.y:C,w=m.scaleX,T=void 0===w?l.scaleX:w,D=m.scaleY,E=void 0===D?l.scaleY:D,B=m.keepStrokeScale,P=void 0===B?l.keepStrokeScale:B,R=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=P?u:tp(e,u,e.dpr),p="outerBorder"===a?1:-1;if(e.beginPath(),!1===d.drawOffset(e,b,i,n,p*c)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var f=l[a].opacity;l[a].opacity=k,e.setStrokeStyle(t,r,(A-i)/T,(M-n)/E,l[a]),l[a].opacity=f,e.stroke()}};g&&R(f,"outerBorder"),y&&R(v,"innerBorder")}}}}])}(),pb=function(){return o((function t(){r(this,t),this.time=Mh.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p=t.attribute,f=p.clipRange,v=void 0===f?l.clipRange:f,g=p.x,y=void 0===g?l.x:g,m=p.y,_=void 0===m?l.y:m,b=p.z,x=void 0===b?l.z:b,k=p.size,S=void 0===k?l.size:k,A=p.scaleX,C=void 0===A?l.scaleX:A,M=p.scaleY,w=void 0===M?l.scaleY:M,T=t.getParsedPath();T&&v<1&&v>0&&(e.beginPath(),T.drawWithClipRange&&T.drawWithClipRange(e,S,i,n,v,x,(function(r,a){var o,u,c,d;if(t._parsedPath.svgCache){var p=Object.assign({},a);p.fill=null!==(o=a.fill)&&void 0!==o?o:t.attribute.fill,p.opacity=null!==(u=a.opacity)&&void 0!==u?u:t.attribute.opacity,p.fillOpacity=t.attribute.fillOpacity,p.stroke=null!==(c=a.stroke)&&void 0!==c?c:t.attribute.stroke,p.lineWidth=null!==(d=a.lineWidth)&&void 0!==d?d:t.attribute.lineWidth,a=p}a.stroke&&(h?h(e,t.attribute,l):s&&(e.setStrokeStyle(t,a,(y-i)/C,(_-n)/w,l),e.stroke()))})),a&&!T.isSvg&&(h?h(e,t.attribute,l):s&&(e.setStrokeStyle(t,t.attribute,(y-i)/C,(_-n)/w,l),e.stroke())))}}])}(),fb=new db,vb=new pb,gb=V_,yb=O_,mb=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Mh.afterFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f,v,g;this.textureMap||this.initTextureMap(e,t.stage);var y=(d||{}).attribute,m=void 0===y?t.attribute:y,_=m.texture,b=void 0===_?null!==(p=t.attribute.texture)&&void 0!==p?p:Nf(l,"texture"):_,x=m.textureColor,k=void 0===x?null!==(f=t.attribute.textureColor)&&void 0!==f?f:Nf(l,"textureColor"):x,S=m.textureSize,A=void 0===S?null!==(v=t.attribute.textureSize)&&void 0!==v?v:Nf(l,"textureSize"):S,C=m.texturePadding,M=void 0===C?null!==(g=t.attribute.texturePadding)&&void 0!==g?g:Nf(l,"texturePadding"):C;b&&this.drawTexture(b,t,e,i,n,l,k,A,M)}}])}(j_),_b={x:0,y:0,z:0,lastModelMatrix:null},bb=function(){return o((function t(){r(this,t)}),[{key:"init",value:function(t){var e=this;t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(N_),this.builtinContributions.push(U_),this.builtinContributions.forEach((function(t){return e._renderContribitions.push(t)})),this._renderContribitions.length&&(this._renderContribitions.sort((function(t,e){return e.order-t.order})),this._beforeRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Mh.beforeFillStroke})),this._afterRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Mh.afterFillStroke})))}},{key:"reInit",value:function(){this.init(this.graphicRenderContributions)}},{key:"beforeRenderStep",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach((function(p){p.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName)||p.drawShape(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}},{key:"afterRenderStep",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._afterRenderContribitions&&this._afterRenderContribitions.forEach((function(p){p.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName)||p.drawShape(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}},{key:"drawPathProxy",value:function(t,e,i,n,r,a,o,s){if(!t.pathProxy)return!1;var l=vf(t,null==a?void 0:a.theme)[t.type.replace("3d","")],u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,p=void 0===d?l.stroke:d,f=u.opacity,v=void 0===f?l.opacity:f,g=u.fillOpacity,y=void 0===g?l.fillOpacity:g,m=u.lineWidth,_=void 0===m?l.lineWidth:m,b=u.strokeOpacity,x=void 0===b?l.strokeOpacity:b,k=u.visible,S=void 0===k?l.visible:k,A=u.x,C=void 0===A?l.x:A,M=u.y,w=void 0===M?l.y:M,T=rm(v,y,h),D=om(v,x),E=im(h),B=nm(p,_);return!S||(!E&&!B||(!(T||D||o||s)||(e.beginPath(),Fh(("function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy).commandList,e,i,n),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,E,B,T,D,l,r,o,s),B&&(s?s(e,t.attribute,l):D&&(e.setStrokeStyle(t,t.attribute,i-C,n-w,l),e.stroke())),E&&(o?o(e,t.attribute,l):T&&(e.setCommonStyle(t,t.attribute,i-C,n-w,l),e.fill())),this.afterRenderStep(t,e,i,n,E,B,T,D,l,r,o,s),!0)))}},{key:"valid",value:function(t,e,i,n){var r=t.attribute,a=r.fill,o=void 0===a?e.fill:a,s=r.background,l=r.stroke,u=void 0===l?e.stroke:l,c=r.opacity,h=void 0===c?e.opacity:c,d=r.fillOpacity,p=void 0===d?e.fillOpacity:d,f=r.lineWidth,v=void 0===f?e.lineWidth:f,g=r.strokeOpacity,y=void 0===g?e.strokeOpacity:g,m=r.visible,_=void 0===m?e.visible:m,b=rm(h,p,o),x=om(h,y),k=im(o,s),S=nm(u,v);return!(!t.valid||!_)&&!(!k&&!S)&&!!(b||x||i||n||s)&&{fVisible:b,sVisible:x,doFill:k,doStroke:S}}},{key:"transform",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.attribute,a=r.x,o=void 0===a?e.x:a,s=r.y,l=void 0===s?e.y:s,u=r.z,c=void 0===u?e.z:u,h=r.scaleX,d=void 0===h?e.scaleX:h,p=r.scaleY,f=void 0===p?e.scaleY:p,v=r.angle,g=void 0===v?e.angle:v,y=r.postMatrix,m=i.modelMatrix,_=i.camera;_b.x=o,_b.y=l,_b.z=c,_b.lastModelMatrix=m;var b=_&&(n||function(t){var e=t.attribute,i=e.alpha,n=e.beta;return i||n}(t)),x=b?t.transMatrix.onlyTranslate()&&!y:1===d&&1===f&&0===g&&!y;if(b){var k=cy.allocate(),S=cy.allocate();wm(S,t,e),ay(k,m||k,S),_b.x=0,_b.y=0,_b.z=0,i.modelMatrix=k,i.setTransform(1,0,0,1,0,0,!0),cy.free(S)}if(x&&!m){var A=t.getOffsetXY(e);_b.x+=A.x,_b.y+=A.y,_b.z=c,i.setTransformForCurrent()}else if(b)_b.x=0,_b.y=0,_b.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(_&&i.project){var C=t.getOffsetXY(e);_b.x+=C.x,_b.y+=C.y,this.transformWithoutTranslate(i,_b.x,_b.y,_b.z,d,f,g)}else i.transformFromMatrix(t.transMatrix,!0),_b.x=0,_b.y=0,_b.z=0;return _b}},{key:"transformUseContext2d",value:function(t,e,i,n){var r=n.camera;if(this.camera=r,r){var a=t.AABBBounds,o=a.x2-a.x1,s=a.y2-a.y1,l=n.project(0,0,i),u=n.project(o,0,i),c=n.project(o,s,i),h={x:0,y:0},d={x:o,y:0},p={x:o,y:s};n.camera=null;var f=1/(h.x*(p.y-d.y)-d.x*p.y+p.x*d.y+(d.x-p.x)*h.y),v=-(h.y*(c.x-u.x)-d.y*c.x+p.y*u.x+(d.y-p.y)*l.x)*f,g=(d.y*c.y+h.y*(u.y-c.y)-p.y*u.y+(p.y-d.y)*l.y)*f,y=(h.x*(c.x-u.x)-d.x*c.x+p.x*u.x+(d.x-p.x)*l.x)*f,m=-(d.x*c.y+h.x*(u.y-c.y)-p.x*u.y+(p.x-d.x)*l.y)*f,_=(h.x*(p.y*u.x-d.y*c.x)+h.y*(d.x*c.x-p.x*u.x)+(p.x*d.y-d.x*p.y)*l.x)*f,b=(h.x*(p.y*u.y-d.y*c.y)+h.y*(d.x*c.y-p.x*u.y)+(p.x*d.y-d.x*p.y)*l.y)*f;n.setTransform(v,g,y,m,_,b,!0)}}},{key:"restoreTransformUseContext2d",value:function(t,e,i,n){this.camera&&(n.camera=this.camera)}},{key:"transformWithoutTranslate",value:function(t,e,i,n,r,a,o){var s=t.project(e,i,n);t.translate(s.x,s.y,!1),t.scale(r,a,!1),t.rotate(o,!1),t.translate(-s.x,-s.y,!1),t.setTransformForCurrent()}},{key:"_draw",value:function(t,e,i,n,r,a){var o=n.context;if(o&&!1!==t.attribute.renderable){o.highPerformanceSave();var s=this.transform(t,e,o,i),l=s.x,u=s.y,c=s.z,h=s.lastModelMatrix;this.z=c,this.drawPathProxy(t,o,l,u,n,r)||(this.drawShape(t,o,l,u,n,r,null,null,a),this.z=0,o.modelMatrix!==h&&cy.free(o.modelMatrix),o.modelMatrix=h),o.highPerformanceRestore()}}}])}(),xb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},kb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Sb=function(t,e){return function(i,n){e(i,n,t)}},Ab=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Ig,i.builtinContributions=[G_,X_,Y_],i.init(t),i}return h(e,t),o(e,[{key:"drawArcTailCapPath",value:function(t,e,i,n,r,a,o,s){var l=s-o,u=t.getParsedAngle(),c=u.startAngle,h=u.endAngle,d=(h=s)>c,p=!1;if(r<a){var f=r;r=a,a=f}var v=um(t,c,h,a,r);v.outerDeltaAngle;var g=v.xors,y=v.yors,m=v.xirs,_=v.yirs,b=v.limitedOcr,x=v.outerCornerRadiusStart,k=v.outerCornerRadiusEnd,S=v.maxOuterCornerRadius,A=v.xore,C=v.yore,M=v.xire,w=v.yire,T=v.limitedIcr,D=v.innerDeltaAngle,E=v.innerStartAngle,B=v.innerCornerRadiusStart,P=v.innerCornerRadiusEnd,R=v.maxInnerCornerRadius;if(b>Je){var L=oi(x,b),I=oi(k,b),F=lm(m,_,g,y,r,L,Number(d)),O=lm(A,C,M,w,r,I,Number(d));if(b<S&&L===I)e.moveTo(i+F.cx+F.x01,n+F.cy+F.y01),e.arc(i+F.cx,n+F.cy,b,ni(F.y01,F.x01),ni(O.y01,O.x01),!d);else{var z=h-l-.03,H=ni(O.y11,O.x11);e.arc(i,n,r,z,H,!d),I>0&&e.arc(i+O.cx,n+O.cy,I,ni(O.y11,O.x11),ni(O.y01,O.x01),!d)}}else e.moveTo(i+g,n+y);if(!(a>Je)||D<.001)e.lineTo(i+M,n+w),p=!0;else if(T>Je){var N=oi(B,T),U=oi(P,T),j=lm(M,w,A,C,a,-U,Number(d)),V=lm(g,y,m,_,a,-N,Number(d));if(e.lineTo(i+j.cx+j.x01,n+j.cy+j.y01),T<R&&N===U){var W=ni(V.y01,V.x01);e.arc(i+j.cx,n+j.cy,T,ni(j.y01,j.x01),W,!d)}else{U>0&&e.arc(i+j.cx,n+j.cy,U,ni(j.y01,j.x01),ni(j.y11,j.x11),!d);var G=ni(j.cy+j.y11,j.cx+j.x11),Y=h-l-.03;e.arc(i,n,a,G,Y,d)}}else e.lineTo(i+a*ri(E),n+a*si(E));return p}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){l=null!=l?l:vf(t,null==a?void 0:a.theme).arc;var u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,p=void 0===d?l.stroke:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.fillStrokeOrder,_=void 0===m?l.fillStrokeOrder:m,b=this.valid(t,l,o,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke,C=t.attribute,M=C.outerPadding,w=void 0===M?l.outerPadding:M,T=C.innerPadding,D=void 0===T?l.innerPadding:T,E=C.cap,B=void 0===E?l.cap:E,P=C.forceShowCap,R=void 0===P?l.forceShowCap:P,L=t.attribute,I=L.outerRadius,F=void 0===I?l.outerRadius:I,O=L.innerRadius,z=void 0===O?l.innerRadius:O;F+=w,z-=D;var H=0,U=(N(B)&&B||B[0])&&"conical"===h.gradient;if(U){var j=t.getParsedAngle(),V=j.sc,W=j.startAngle,G=j.endAngle;ii(G-W)<ei-Je&&(H=V||0,h.startAngle-=H,h.endAngle-=H)}var Y=!1,X=function(t){var e,i=!0;if(N(t,!0)){for(var n=0;n<4;n++)Pf[n]=t,i&&(i=!(null!==(e=Pf[n])&&void 0!==e&&!e));i=t}else if(Array.isArray(t))for(var r=0;r<4;r++)Pf[r]=!!t[r],i&&(i=!!Pf[r]);else Pf[0]=!1,Pf[1]=!1,Pf[2]=!1,Pf[3]=!1;return{isFullStroke:i,stroke:Pf}}(p),K=X.isFullStroke,q=X.stroke;if((S||K)&&(e.beginPath(),cm(t,e,i,n,F,z),Y=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),_?(this._runStroke(t,e,i,n,l,A,K,k,s),this._runFill(t,e,i,n,l,S,x,v,y,o)):(this._runFill(t,e,i,n,l,S,x,v,y,o),this._runStroke(t,e,i,n,l,A,K,k,s))),!K&&A&&(e.beginPath(),cm(t,e,i,n,F,z,q),Y||this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),s?s(e,t.attribute,l):k&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke())),(N(B)&&B||B[1])&&R){var Z=t.getParsedAngle(),J=Z.startAngle,Q=Z.endAngle;if(ii(Q-J)>=ei-Je){e.beginPath();var $=Math.abs(F-z)/2/F,tt=t.attribute,et=tt.endAngle,it=void 0===et?l.endAngle:et,nt=tt.fill,rt=void 0===nt?l.fill:nt,at=it;this.drawArcTailCapPath(t,e,i,n,F,z,at,at+$),Y||this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s);(function(){if(S){var r=rt;if("conical"===r.gradient){var a=function(t,e,i,n){for(var r=n.stops,a=n.startAngle,o=n.endAngle;i<0;)i+=ei;for(;i>ei;)i-=ei;if(i<a)return r[0].color;if(i>o)return r[0].color;for(var s,l,u=(i-a)/(o-a),c=0;c<r.length;c++)if(r[c].offset>=u){s=r[c-1],l=r[c];break}return u=(u-s.offset)/(l.offset-s.offset),Sy(s.color,l.color,u,!1)}(0,0,it,r);o||rm&&(e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=a,e.fill())}}})(),A&&(s||k&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke()))}}this.afterRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),U&&(h.startAngle+=H,h.endAngle+=H)}}},{key:"_runFill",value:function(t,e,i,n,r,a,o,s,l,u){a&&(u?u(e,t.attribute,r):o&&(e.setCommonStyle(t,t.attribute,s-i,l-n,r),e.fill()))}},{key:"_runStroke",value:function(t,e,i,n,r,a,o,s,l){a&&o&&(l?l(e,t.attribute,r):s&&(e.setStrokeStyle(t,t.attribute,i,n,r),e.stroke()))}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n,r)}}])}(bb);Ab=xb([Dc(),Sb(0,wc(Yc)),Sb(0,Ec(hm)),kb("design:paramtypes",[Object])],Ab);var Cb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Mb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},wb=function(t,e){return function(i,n){e(i,n,t)}},Tb=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=zg,i.builtinContributions=[q_,J_,Z_],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=vf(t,null==a?void 0:a.theme).circle,u=t.attribute,c=u.radius,h=void 0===c?l.radius:c,d=u.startAngle,p=void 0===d?l.startAngle:d,f=u.endAngle,v=void 0===f?l.endAngle:f,g=u.x,y=void 0===g?l.x:g,m=u.y,_=void 0===m?l.y:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=this.valid(t,l,o,s);if(k){var S=k.fVisible,A=k.sVisible,C=k.doFill,M=k.doStroke;e.beginPath(),e.arc(i,n,h,p,v),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,C,M,S,A,l,r,o,s);var w=function(){C&&(o?o(e,t.attribute,l):S&&(e.setCommonStyle(t,t.attribute,y-i,_-n,l),e.fill()))},T=function(){M&&(s?s(e,t.attribute,l):A&&(e.setStrokeStyle(t,t.attribute,y-i,_-n,l),e.stroke()))};x?(T(),w()):(w(),T()),this.afterRenderStep(t,e,i,n,C,M,S,A,l,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).circle;this._draw(t,r,!1,i,n)}}])}(bb);function Db(t,e,i,n){if(e.p1){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u;if(1===i)e.p2&&e.p3?t.bezierCurveTo(o+e.p1.x,l+e.p1.y,o+e.p2.x,l+e.p2.y,o+e.p3.x,l+e.p3.y,c):t.lineTo(o+e.p1.x,l+e.p1.y,c);else if(e.p2&&e.p3){var h=m(Vh(e,i),1)[0];t.bezierCurveTo(o+h.p1.x,l+h.p1.y,o+h.p2.x,l+h.p2.y,o+h.p3.x,l+h.p3.y,c)}else{var d=e.getPointAt(i);t.lineTo(o+d.x,l+d.y,c)}}}function Eb(t,e,i,n,r,a,o){var s,l=e.p0,u=n;if(i&&i.originP1===i.originP2&&(l=i.p0),e.defined)n||(t.lineTo(l.x+r,l.y+a,o),u=!n);else{var c,h=e.originP1,d=e.originP2;if(h&&!1!==h.defined&&!i?c=l:h&&!1!==d.defined&&(c=null!==(s=e.p3)&&void 0!==s?s:e.p1),n){u=!n;var p=c?c.x:e.p0.x,f=c?c.y:e.p0.y;t.moveTo(p+r,f+a,o)}else c&&(u=!n,t.lineTo(c.x+r,c.y+a,o))}return u}function Bb(t,e,i,n,r){var a=r||{},o=a.offsetX,s=void 0===o?0:o,l=a.offsetY,u=void 0===l?0:l,c=a.offsetZ,h=void 0===c?0:c,d=a.mode,p=void 0===d?"none":d,f=a.drawConnect,v=void 0!==f&&f;if((!v||"none"!==p)&&e){var g=!0,y=e.curves;if(i>=1)if(v){var m,_=!0;y.forEach((function(e,i){e.originP1!==e.originP2?(_=Eb(t,e,m,_,s,u,h),m=e):m=e}))}else y.forEach((function(e){e.defined?(g&&t.moveTo(e.p0.x+s,e.p0.y+u,h),Db(t,e,1,r),g=!1):g=!0}));else if(!(i<=0)){var b;"x"===n?b=Ah.ROW:"y"===n?b=Ah.COLUMN:"auto"===n&&(b=e.direction);for(var x=i*e.tryUpdateLength(b),k=0,S=!0,A=null,C=0,M=y.length;C<M;C++){var w=y[C],T=w.getLength(b),D=(x-k)/T;if(k+=T,D<0)break;if(v){if(w.originP1===w.originP2){A=w;continue}S=Eb(t,w,A,S,s,u,h),A=w}else{if(!w.defined){g=!0;continue}g&&t.moveTo(w.p0.x+s,w.p0.y+u,h),Db(t,w,oi(D,1),r),g=!1}}}}}Tb=Cb([Dc(),wb(0,wc(Yc)),wb(0,Ec(pm)),Mb("design:paramtypes",[Object])],Tb);var Pb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Rb=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=jg,t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).line;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f){var v;if(e){t.beginPath(),Bb(t,e,l,u,{offsetX:c,offsetY:h,offsetZ:null!==(v=this.z)&&void 0!==v?v:0}),d.cache&&!Z(d.cache)&&d.cache.curves.every((function(t){return t.defined}))&&d.attribute.curveType&&d.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,o,s);var g=o.x,y=void 0===g?0:g,m=o.x,_=void 0===m?0:m;return!1!==i&&(p?p(t,o,s):r&&(t.setCommonStyle(d,o,y-c,_-h,s),t.fill())),!1!==n&&(f?f(t,o,s):a&&(t.setStrokeStyle(d,o,y-c,_-h,s),t.stroke())),!1}}},{key:"drawLinearLineHighPerformance",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p;e.beginPath();var f=null!==(p=this.z)&&void 0!==p?p:0,v=t.attribute.points,g=v[0];e.moveTo(g.x+o,g.y+s,f);for(var y=1;y<v.length;y++){var m=v[y];e.lineTo(m.x+o,m.y+s,f)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var _=t.attribute,b=_.x,x=void 0===b?0:b,k=_.x,S=void 0===k?0:k;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,x-o,S-s,l),e.fill())),!1!==n&&(d?d(e,t.attribute,l):a&&(e.setStrokeStyle(t,t.attribute,x-o,S-s,l),e.stroke()))}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=this,u=vf(t,null==a?void 0:a.theme).line,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.stroke,f=void 0===p?u.stroke:p,v=c.fillOpacity,g=void 0===v?u.fillOpacity:v,y=c.strokeOpacity,m=void 0===y?u.strokeOpacity:y,_=c.segments,b=c.points,x=c.closePath,k=c.curveTension,S=void 0===k?u.curveTension:k,A=c.connectedType,C=void 0===A?u.connectedType:A;if(this.valid(t,u,o,s)){var M=t.attribute.curveType,w=void 0===M?u.curveType:M;x&&"linear"===w&&(w="linearClosed");var T=t.attribute,D=T.clipRange,E=void 0===D?u.clipRange:D,B=T.clipRangeByDimension,P=void 0===B?u.clipRangeByDimension:B;if(1===E&&!_&&!b.some((function(t){return!1===t.defined}))&&"linear"===w)return this.drawLinearLineHighPerformance(t,e,!!d,!!f,g,m,i,n,u,r,a,o,s);if(t.shouldUpdateShape()){var R=t.attribute,L=R.points,I=R.segments,F=L;if(I&&I.length){var O,z;if(t.cache=I.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(z={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===e?O={x:z.endX,y:z.endY,defined:z.curves[z.curves.length-1].defined}:e>1&&(O.x=z.endX,O.y=z.endY,O.defined=z.curves[z.curves.length-1].defined);var i=Cd(q(t.points,C),w,{startPoint:O,curveTension:S});return z=i,i})).filter((function(t){return!!t})),"linearClosed"===w){for(var H,N=0;N<t.cache.length;N++){for(var U=t.cache[N],j=0;j<U.curves.length;j++)if(U.curves[j].defined){H=U.curves[j].p0;break}if(H)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(H.x,H.y,!0)}}else{if(!L||!L.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=Cd(q(F,C),w,{curveTension:S})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){var V=t.attribute.segments.filter((function(t){return t.points.length}));if(1===V[0].points.length&&V.shift(),1===E){var W=!1;t.cache.forEach((function(r,a){W||(W=l.drawSegmentItem(e,r,!!d,!!f,g,m,V[a],[u,t.attribute],E,P,i,n,t,o,s))}))}else{var G=t.cache.reduce((function(t,e){return t+e.getLength()}),0),Y=E*G,X=0,K=!1;t.cache.forEach((function(r,a){if(!K){var c=r.getLength(),h=(Y-X)/c;X+=c,h>0&&(K=l.drawSegmentItem(e,r,!!d,!!f,g,m,V[a],[u,t.attribute],oi(h,1),P,i,n,t,o,s))}}))}}else this.drawSegmentItem(e,t.cache,!!d,!!f,g,m,t.attribute,u,E,P,i,n,t,o,s)}function q(t,e){return"none"===e?t:t.filter((function(t){return!1!==t.defined}))}}}])}(bb);function Lb(t,e,i,n){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u,h=!0;e.forEach((function(e){e.defined?(h&&t.moveTo(e.p0.x+o,e.p0.y+l,c),Db(t,e,1,n),h=!1):h=!0})),h=!0;for(var d=i.length-1;d>=0;d--){var p=i[d];p.defined?(h&&t.lineTo(p.p0.x+o,p.p0.y+l,c),Db(t,p,1,n),h=!1):h=!0}t.closePath()}Rb=Pb([Dc()],Rb);var Ib=new mb,Fb=O_,Ob=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},zb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Hb=function(t,e){return function(i,n){e(i,n,t)}},Nb=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Og,i.builtinContributions=[Ib,Fb],i.init(t),i}return h(e,t),o(e,[{key:"drawLinearAreaHighPerformance",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f,v,g=t.attribute.points;if(!(g.length<2)){e.beginPath();var y=null!==(p=this.z)&&void 0!==p?p:0,m=g[0];e.moveTo(m.x+o,m.y+s,y);for(var _=1;_<g.length;_++){var b=g[_];e.lineTo(b.x+o,b.y+s,y)}for(var x=g.length-1;x>=0;x--){var k=g[x];e.lineTo((null!==(f=k.x1)&&void 0!==f?f:k.x)+o,(null!==(v=k.y1)&&void 0!==v?v:k.y)+s,y)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,o,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute});var S=t.attribute,A=S.x,C=void 0===A?0:A,M=S.x,w=void 0===M?0:M;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,C-o,w-s,l),e.fill())),this.afterRenderStep(t,e,o,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute}),function(){var i,r;if(n){var a=t.attribute.stroke,u=void 0===a?l&&l.stroke:a;if(Z(u)&&(u[0]||u[2])&&!1===u[1])if(e.beginPath(),u[0]){e.moveTo(m.x+o,m.y+s,y);for(var c=1;c<g.length;c++){var h=g[c];e.lineTo(h.x+o,h.y+s,y)}}else if(u[2]){var p=g[g.length-1];e.moveTo(p.x+o,p.y+s,y);for(var f=g.length-2;f>=0;f--){var v=g[f];e.lineTo((null!==(i=v.x1)&&void 0!==i?i:v.x)+o,(null!==(r=v.y1)&&void 0!==r?r:v.y)+s,y)}}d?d(e,t.attribute,l):(e.setStrokeStyle(t,t.attribute,C-o,w-s,l),e.stroke())}}()}}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h,d,p,f=this,v=vf(t,null==a?void 0:a.theme).area,g=t.attribute,y=g.fill,m=void 0===y?v.fill:y,_=g.stroke;void 0===_&&v.stroke;var b=g.fillOpacity,x=void 0===b?v.fillOpacity:b,k=g.z,S=void 0===k?v.z:k,A=g.strokeOpacity,C=void 0===A?v.strokeOpacity:A,M=g.curveTension,w=void 0===M?v.curveTension:M,T=g.connectedType,D=void 0===T?v.connectedType:T,E=this.valid(t,v,o,s);if(E){var B=E.doFill,P=E.doStroke&&E.sVisible,R=t.attribute,L=R.clipRange,I=void 0===L?v.clipRange:L,F=R.closePath,O=R.points,z=R.segments,H=t.attribute.curveType,N=void 0===H?v.curveType:H;if(F&&"linear"===N&&(N="linearClosed"),1===I&&!z&&!O.some((function(t){return!1===t.defined}))&&"linear"===N)return this.drawLinearAreaHighPerformance(t,e,!!m,P,x,C,i,n,v,r,a,o,s);if(t.shouldUpdateShape()){if(z&&z.length){for(var U,j,V,W=z.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(j={endX:t.points[0].x,endY:t.points[0].y}),null;1===e?U={x:j.endX,y:j.endY}:e>1&&(U.x=j.endX,U.y=j.endY);var i=Cd(ut(t.points,D),N,{startPoint:U,curveTension:w});return j=i,i})).filter((function(t){return!!t})),G=[],Y=z.length-1;Y>=0;Y--){for(var X=z[Y].points,K=[],q=X.length-1;q>=0;q--)K.push({x:null!==(l=X[q].x1)&&void 0!==l?l:X[q].x,y:null!==(u=X[q].y1)&&void 0!==u?u:X[q].y});if(0!==Y){var Z=z[Y-1].points,J=Z[Z.length-1];J&&K.push({x:null!==(c=J.x1)&&void 0!==c?c:J.x,y:null!==(h=J.y1)&&void 0!==h?h:J.y})}K.length>1&&(V=Cd(ut(K,D),"stepBefore"===N?"stepAfter":"stepAfter"===N?"stepBefore":N,{curveTension:w}),G.unshift(V))}t.cacheArea=G.map((function(t,e){return{top:W[e],bottom:t}}))}else{if(!O||!O.length)return t.cacheArea=null,void t.clearUpdateShapeTag();for(var Q=ut(O,D),$=[],tt=Q.length-1;tt>=0;tt--)$.push({x:null!==(d=Q[tt].x1)&&void 0!==d?d:Q[tt].x,y:null!==(p=Q[tt].y1)&&void 0!==p?p:Q[tt].y});var et=Cd(Q,N,{curveTension:w}),it=Cd($,"stepBefore"===N?"stepAfter":"stepAfter"===N?"stepBefore":N,{curveTension:w});t.cacheArea={top:et,bottom:it}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){var nt=t.attribute.segments.filter((function(t){return t.points.length}));if(1===nt[0].points.length&&nt.shift(),1===I){var rt=!1;t.cacheArea.forEach((function(a,l){rt||(rt=f.drawSegmentItem(e,a,B,x,P,C,nt[l],[v,t.attribute],I,i,n,S,t,r,o,s))}))}else{var at=t.cacheArea.reduce((function(t,e){return t+e.top.getLength()}),0),ot=I*at,st=0,lt=!1;t.cacheArea.forEach((function(a,l){if(!lt){var u=a.top.getLength(),c=(ot-st)/u;st+=u,c>0&&(lt=f.drawSegmentItem(e,a,B,x,P,C,nt[l],[v,t.attribute],oi(c,1),i,n,S,t,r,o,s))}}))}}else this.drawSegmentItem(e,t.cacheArea,B,x,P,C,t.attribute,v,I,i,n,S,t,r,o,s)}function ut(t,e){return"connect"!==e?t:t.filter((function(t){return!1!==t.defined}))}}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).area;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v){return this._drawSegmentItem(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v)}},{key:"_drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v){if(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length){t.beginPath();var g,y,m=d.attribute,_=m.points,b=m.segments,x=Ah.ROW;if(b){var k=b[b.length-1];y=b[0].points[0],g=k.points[k.points.length-1]}else y=_[0],g=_[_.length-1];var S=ii(g.x-y.x),A=ii(g.y-y.y);x=null==g.x1?Ah.ROW:null==g.y1?Ah.COLUMN:Number.isFinite(S+A)?S>A?Ah.ROW:Ah.COLUMN:Ah.ROW,function(t,e,i,n){var r,a=e.top,o=e.bottom;if(a.curves.length===o.curves.length)if(i>=1){for(var s=[],l=[],u=!0,c=0,h=a.curves.length;c<h;c++){var d=a.curves[c];u!==d.defined?(u?(Lb(t,s,l,n),s.length=0,l.length=0):(s.push(d),l.push(o.curves[h-c-1])),u=!u):u&&(s.push(d),l.push(o.curves[h-c-1]))}Lb(t,s,l,n)}else if(!(i<=0)){var p=(n||{}).direction,f=a.curves,v=null!==(r=f[f.length-1].p3)&&void 0!==r?r:f[f.length-1].p1,g=ii(v.x-f[0].p0.x),y=ii(v.y-f[0].p0.y);p=null!=p?p:g>y?Ah.ROW:Ah.COLUMN,Number.isFinite(g)||(p=Ah.COLUMN),Number.isFinite(y)||(p=Ah.ROW);for(var m=i*(p===Ah.ROW?g:y),_=0,b=!0,x=[],k=[],S=0,A=a.curves.length;S<A;S++){var C=a.curves[S],M=C.getLength(p),w=(m-_)/M;if(w<0)break;_+=M;var T=null,D=null;b!==C.defined?(b?(Lb(t,x,k,n),x.length=0,k.length=0):(T=C,D=o.curves[A-S-1]),b=!b):b&&(T=C,D=o.curves[A-S-1]),T&&D&&(w<1&&(T=T.p2&&T.p3?Vh(T,w)[0]:Gh(T,w)[0],D=D.p2&&D.p3?Vh(D,1-w)[1]:Gh(D,1-w)[1]),T.defined=b,D.defined=b,x.push(T),k.push(D)),T=null,D=null}Lb(t,x,k,n)}}(t,e,l,{offsetX:u,offsetY:c,offsetZ:h,direction:x}),this.beforeRenderStep(d,t,u,c,!!n,!1,i,!1,s,p,f,null,{attribute:o}),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,o,s);var C=o.x,M=void 0===C?0:C,w=o.x,T=void 0===w?0:w;return!1!==i&&(f?f(t,o,s):n&&(t.setCommonStyle(d,o,M-u,T-c,s),t.fill())),this.afterRenderStep(d,t,u,c,!!n,!1,i,!1,s,p,f,null,{attribute:o}),function(){if(!1!==r)if(v)v(t,o,s);else{var i=o.stroke,n=void 0===i?s&&s[1]&&s[1].stroke:i;Z(n)&&(n[0]||n[2])&&!1===n[1]&&(t.beginPath(),Bb(t,n[0]?e.top:e.bottom,l,x===Ah.ROW?"x":"y",{offsetX:u,offsetY:c,offsetZ:h})),t.setStrokeStyle(d,o,M-u,T-c,s),t.stroke()}}(),!1}}}])}(bb);Nb=Ob([Dc(),Hb(0,wc(Yc)),Hb(0,Ec(dm)),zb("design:paramtypes",[Object])],Nb);var Ub=V_,jb=O_,Vb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Wb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Gb=function(t,e){return function(i,n){e(i,n,t)}},Yb=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Vg,i.builtinContributions=[jb,Ub],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h=null!==(l=this.tempTheme)&&void 0!==l?l:vf(t,null==a?void 0:a.theme).path,d=t.attribute,p=d.x,f=void 0===p?h.x:p,v=d.y,g=void 0===v?h.y:v,y=d.fillStrokeOrder,m=void 0===y?h.fillStrokeOrder:y,_=null!==(u=this.z)&&void 0!==u?u:0,b=this.valid(t,h,o,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke;if(e.beginPath(),t.pathShape)Fh(t.pathShape.commandList,e,i,n,1,1,_);else Fh((null!==(c=t.attribute.path)&&void 0!==c?c:h.path).commandList,e,i,n,1,1,_);e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,i,n,S,A,x,k,h,r,o,s);var C=function(){A&&(s?s(e,t.attribute,h):k&&(e.setStrokeStyle(t,t.attribute,f-i,g-n,h),e.stroke()))},M=function(){S&&(o?o(e,t.attribute,h):x&&(e.setCommonStyle(t,t.attribute,f-i,g-n,h),e.fill()))};m?(C(),M()):(M(),C()),this.afterRenderStep(t,e,i,n,S,A,x,k,h,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).path;this.tempTheme=r,this._draw(t,r,!1,i,n),this.tempTheme=null}}])}(bb);Yb=Vb([Dc(),Gb(0,wc(Yc)),Gb(0,Ec(gm)),Wb("design:paramtypes",[Object])],Yb);var Xb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Kb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},qb=function(t,e){return function(i,n){e(i,n,t)}},Zb=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.type="rect",i.numberType=Yg,i.builtinContributions=[ob,lb,sb],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){l=null!=l?l:vf(t,null==a?void 0:a.theme).rect;var u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.background,p=u.stroke,f=void 0===p?l.stroke:p,v=u.cornerRadius,g=void 0===v?l.cornerRadius:v,y=u.cornerType,m=void 0===y?l.cornerType:y,_=u.opacity,b=void 0===_?l.opacity:_,x=u.fillOpacity,k=void 0===x?l.fillOpacity:x,S=u.lineWidth,A=void 0===S?l.lineWidth:S,C=u.strokeOpacity,M=void 0===C?l.strokeOpacity:C,w=u.visible,T=void 0===w?l.visible:w,D=u.x1,E=u.y1,B=u.x,P=void 0===B?l.x:B,R=u.y,L=void 0===R?l.y:R,I=u.fillStrokeOrder,F=void 0===I?l.fillStrokeOrder:I,O=u.drawStrokeWhenZeroWH,z=void 0===O?l.drawStrokeWhenZeroWH:O,H=t.attribute,N=H.width,U=H.height,j=am(b,k,N=(null!=N?N:D-P)||0,U=(null!=U?U:E-L)||0,h),V=sm(b,M,N,U,z),W=im(h,d),G=nm(f,A);if(t.valid&&T&&(W||G)&&(j||V||o||s||d)){0===g||Z(g)&&g.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,N,U)):(e.beginPath(),eb(e,i,n,N,U,g,"bevel"!==m));var Y={doFill:W,doStroke:G};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,W,G,j,V,l,r,o,s,Y),F?(this._runStroke(t,e,i,n,l,Y,V,P,L,s),this._runFill(t,e,i,n,l,Y,j,P,L,o)):(this._runFill(t,e,i,n,l,Y,j,P,L,o),this._runStroke(t,e,i,n,l,Y,V,P,L,s)),this.afterRenderStep(t,e,i,n,W,G,j,V,l,r,o,s)}}},{key:"_runFill",value:function(t,e,i,n,r,a,o,s,l,u){a.doFill&&(u?u(e,t.attribute,r):o&&(e.setCommonStyle(t,t.attribute,s-i,l-n,r),e.fill()))}},{key:"_runStroke",value:function(t,e,i,n,r,a,o,s,l,u){a.doStroke&&(u?u(e,t.attribute,r):o&&(e.setStrokeStyle(t,t.attribute,s-i,l-n,r),e.stroke()))}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).rect;this._draw(t,r,!1,i,n,r)}}])}(bb);Zb=Xb([Dc(),qb(0,wc(Yc)),qb(0,Ec(mm)),Kb("design:paramtypes",[Object])],Zb);var Jb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Qb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},$b=function(t,e){return function(i,n){e(i,n,t)}},tx=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=qg,i.builtinContributions=[fb,yb,gb,vb],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){var u;l=null!=l?l:vf(t,null==a?void 0:a.theme).symbol;var c=t.attribute,h=c.size,d=void 0===h?l.size:h,p=c.x,f=void 0===p?l.x:p,v=c.y,g=void 0===v?l.y:v,y=c.scaleX,m=void 0===y?l.scaleX:y,_=c.scaleY,b=void 0===_?l.scaleY:_,x=c.fillStrokeOrder,k=void 0===x?l.fillStrokeOrder:x,S=c.clipRange,A=void 0===S?l.clipRange:S,C=this.valid(t,l,o,s);if(C){var M=C.fVisible,w=C.sVisible,T=C.doFill,D=C.doStroke,E=t.getParsedPath();if(E){var B=t.attribute.keepDirIn3d,P=void 0===B?l.keepDirIn3d:B,R=null!==(u=this.z)&&void 0!==u?u:0;e.beginPath();var L=i,I=n,F=R,O=e.camera;if(P&&O&&e.project){var z=e.project(i,n,R);e.camera=null,Z(d)&&(d[0],d[1]),L=z.x,I=z.y,F=void 0}!1===E.draw(e,d,L,I,F,(function(r,a){var u,c,h,d;if(t._parsedPath.svgCache){var p=Object.assign({},a);p.fill=null!==(u=a.fill)&&void 0!==u?u:t.attribute.fill,p.opacity=null!==(c=a.opacity)&&void 0!==c?c:t.attribute.opacity,p.fillOpacity=t.attribute.fillOpacity,p.stroke=null!==(h=a.stroke)&&void 0!==h?h:t.attribute.stroke,p.lineWidth=null!==(d=a.lineWidth)&&void 0!==d?d:t.attribute.lineWidth,a=p}var v=function(){a.fill&&(o?o(e,t.attribute,l):(e.setCommonStyle(t,a,f-i,g-n,l),e.fill()))},y=function(){a.stroke&&(s?s(e,t.attribute,l):w&&A>=1&&(e.setStrokeStyle(t,a,(f-i)/m,(g-n)/b,l),e.stroke()))};k?(y(),v()):(v(),y())}))&&e.closePath(),e.camera=O,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,T,D,M,w,l,r,o,s),k?(this._runStroke(t,e,i,n,l,D,w,f,g,E,A,m,b,s),this._runFill(t,e,i,n,l,T,M,f,g,E,o)):(this._runFill(t,e,i,n,l,T,M,f,g,E,o),this._runStroke(t,e,i,n,l,D,w,f,g,E,A,m,b,s)),this.afterRenderStep(t,e,i,n,T,D,M,w,l,r,o,s)}}}},{key:"_runFill",value:function(t,e,i,n,r,a,o,s,l,u,c){a&&!u.isSvg&&(c?c(e,t.attribute,r):o&&(e.setCommonStyle(t,t.attribute,s-i,l-n,r),e.fill()))}},{key:"_runStroke",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p){a&&!u.isSvg&&(p?p(e,t.attribute,r):o&&c>=1&&(e.setStrokeStyle(t,t.attribute,(s-i)/h,(l-n)/d,r),e.stroke()))}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).symbol;this._draw(t,r,!1,i,n)}}])}(bb);tx=Jb([Dc(),$b(0,wc(Yc)),$b(0,Ec(_m)),Qb("design:paramtypes",[Object])],tx);var ex=function(){return o((function t(){r(this,t),this.pools=[];for(var e=0;e<10;e++)this.pools.push(new On)}),[{key:"allocate",value:function(t,e,i,n){if(!this.pools.length)return(new On).setValue(t,e,i,n);var r=this.pools.pop();return r.x1=t,r.y1=e,r.x2=i,r.y2=n,r}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new On(t);var e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),ix=new ex,nx=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Mh.beforeFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d,p,f,v,g,y,m,_,b,x,k,S=t.attribute,A=S.backgroundMode,C=void 0===A?l.backgroundMode:A,M=S.backgroundFit,w=void 0===M?l.backgroundFit:M,T=S.backgroundKeepAspectRatio,D=void 0===T?l.backgroundKeepAspectRatio:T,E=t.attribute.background;if(E){var B,P=function(){"richtext"===t.type&&(e.restore(),e.save(),k&&e.setTransformFromMatrix(k,!0,1))};"richtext"===t.type&&(k=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());var R=G(E)&&E.background,L=t.transMatrix.onlyTranslate();if(R){var I=t.AABBBounds,F=(null!==(d=E.x)&&void 0!==d?d:I.x1)+(null!==(p=E.dx)&&void 0!==p?p:0),O=(null!==(f=E.y)&&void 0!==f?f:I.y1)+(null!==(v=E.dy)&&void 0!==v?v:0),z=null!==(g=E.width)&&void 0!==g?g:I.width(),H=null!==(y=E.height)&&void 0!==y?y:I.height();if(B=ix.allocate(F,O,F+z,O+H),E=E.background,!L){var N=B.width(),U=B.height();B.set((null!==(m=E.x)&&void 0!==m?m:0)+(null!==(_=E.dx)&&void 0!==_?_:0),(null!==(b=E.y)&&void 0!==b?b:0)+(null!==(x=E.dy)&&void 0!==x?x:0),N,U)}}else B=t.AABBBounds,L||(B=P_(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){var j=t.resources.get(E);if("success"!==j.state||!j.data)return void P();e.highPerformanceSave(),L&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,n,l),this.doDrawImage(e,j.data,B,{backgroundMode:C,backgroundFit:w,backgroundKeepAspectRatio:D}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{var V=t.attribute.backgroundCornerRadius;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=E,V?(eb(e,B.x1,B.y1,B.width(),B.height(),V,!0),e.fill()):e.fillRect(B.x1,B.y1,B.width(),B.height()),e.highPerformanceRestore()}R&&ix.free(B),P()}}}])}(F_),rx=new nx,ax=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ox=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},sx=function(t,e){return function(i,n){e(i,n,t)}},lx=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Zg,i.builtinContributions=[rx],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h=this,d=vf(t,null==a?void 0:a.theme).text,p=t.attribute;p.text;var f=p.underline,v=void 0===f?d.underline:f,g=p.lineThrough,y=void 0===g?d.lineThrough:g,m=p.keepDirIn3d,_=void 0===m?d.keepDirIn3d:m,b=p.direction,x=void 0===b?d.direction:b,k=p.fontSize,S=void 0===k?d.fontSize:k,A=p.verticalMode,C=void 0===A?d.verticalMode:A,M=p.x,w=void 0===M?d.x:M,T=p.y,D=void 0===T?d.y:T,E=null!==(l=Vf(t.attribute.lineHeight,S))&&void 0!==l?l:S,B=this.valid(t,d,o,s);if(B){var P=B.fVisible,R=B.sVisible,L=B.doFill,I=B.doStroke,F=!_,O=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,n,L,I,P,R,d,r,o,s),F&&this.transformUseContext2d(t,d,O,e);var z=function(r,a,l,u){var c=i+a,h=n+l;if(u){e.highPerformanceSave(),c+=S;var p=uy.allocate(1,0,0,1,0,0);p.rotateByCenter(Math.PI/2,c,h),e.transformFromMatrix(p,!0),uy.free(p)}I&&(s?s(e,t.attribute,d):R&&(e.setStrokeStyle(t,t.attribute,w-i,D-n,d),e.strokeText(r,c,h,O))),L&&(o?o(e,t.attribute,d):P&&(e.setCommonStyle(t,t.attribute,w-i,D-n,d),e.fillText(r,c,h,O))),u&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,O),"horizontal"===x){var H=t.multilineLayout;if(!H)return void e.highPerformanceRestore();var N=H.bbox,U=N.xOffset,j=N.yOffset;I&&(s?s(e,t.attribute,d):R&&(e.setStrokeStyle(t,t.attribute,w-i,D-n,d),H.lines.forEach((function(t){e.strokeText(t.str,(t.leftOffset||0)+U+i,(t.topOffset||0)+j+n,O)})))),L&&(o?o(e,t.attribute,d):P&&(e.setCommonStyle(t,t.attribute,w-i,D-n,d),H.lines.forEach((function(r){e.fillText(r.str,(r.leftOffset||0)+U+i,(r.topOffset||0)+j+n,O),h.drawUnderLine(v,y,t,(r.leftOffset||0)+U+i,(r.topOffset||0)+j+n,r.descent,(r.descent-r.ascent)/2,O,d,e,{width:r.width})}))))}else{var V=t.attribute,W=V.textAlign,G=void 0===W?d.textAlign:W,Y=V.textBaseline,X=void 0===Y?d.textBaseline:Y;if(!C){var K=G;G=null!==(u=t.getBaselineMapAlign()[X])&&void 0!==u?u:"left",X=null!==(c=t.getAlignMapBaseline()[K])&&void 0!==c?c:"top"}t.tryUpdateAABBBounds();var q=t.cache.verticalList;e.textAlign="left",e.textBaseline="top";var Z=E*q.length,J=0;q.forEach((function(t){var e=t.reduce((function(t,e){return t+(e.width||0)}),0);J=ai(e,J)}));var Q=0,$=0;"bottom"===X?$=-Z:"middle"===X&&($=-Z/2),"center"===G?Q-=J/2:"right"===G&&(Q-=J),q.forEach((function(t,e){var i=t.reduce((function(t,e){return t+(e.width||0)}),0),n=J-i,r=Q;"center"===G?r+=n/2:"right"===G&&(r+=n),t.forEach((function(t){var i=t.text,n=t.width,a=t.direction;z(i,Z-(e+1)*E+$,r,a),r+=n}))}))}F&&this.restoreTransformUseContext2d(t,d,O,e),this.afterRenderStep(t,e,i,n,L,I,P,R,d,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).text,a=t.attribute.keepDirIn3d,o=!(void 0===a?r.keepDirIn3d:a);this._draw(t,r,o,i,n)}},{key:"drawUnderLine",value:function(t,e,i,n,r,a,o,s,l,u,c){if(!(e+t<=0)){var h=i.attribute,d=h.textAlign,p=void 0===d?l.textAlign:d,f=h.fill,v=void 0===f?l.fill:f,g=h.opacity,y=void 0===g?l.opacity:g,m=h.underlineOffset,_=void 0===m?l.underlineOffset:m,b=h.underlineDash,x=void 0===b?l.underlineDash:b,k=h.fillOpacity,S=void 0===k?l.fillOpacity:k,A=!j(c),C=A?c.width:i.clipedWidth,M=A?0:km(p,C),w={lineWidth:0,stroke:v,opacity:y,strokeOpacity:S};if(t){w.lineWidth=t,u.setStrokeStyle(i,w,n,r,l),x&&u.setLineDash(x),u.beginPath();var T=r+a+_;u.moveTo(n+M,T,s),u.lineTo(n+M+C,T,s),u.stroke()}if(e){w.lineWidth=e,u.setStrokeStyle(i,w,n,r,l),u.beginPath();var D=r+o;u.moveTo(n+M,D,s),u.lineTo(n+M+C,D,s),u.stroke()}}}}])}(bb);function ux(t,e,i,n){if(e&&e.length){t.moveTo(e[0].x+i,e[0].y+n);for(var r=1;r<e.length;r++)t.lineTo(e[r].x+i,e[r].y+n)}}function cx(t,e){return Math.sqrt(t*t+e*e)}function hx(t,e,i,n,r){var a=e/i;return{x:t.x-n*a,y:t.y-r*a}}lx=ax([Dc(),sx(0,wc(Yc)),sx(0,Ec(bm)),ox("design:paramtypes",[Object])],lx);var dx=V_,px=O_,fx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},vx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},gx=function(t,e){return function(i,n){e(i,n,t)}},yx=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Wg,i.builtinContributions=[px,dx],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=vf(t,null==a?void 0:a.theme).polygon,u=t.attribute,c=u.points,h=void 0===c?l.points:c,d=u.cornerRadius,p=void 0===d?l.cornerRadius:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.closePath,_=void 0===m?l.closePath:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=this.valid(t,l,o,s);if(k){var S=k.fVisible,A=k.sVisible,C=k.doFill,M=k.doStroke;e.beginPath(),p<=0||Z(p)&&p.every((function(t){return 0===t}))?ux(e.camera?e:e.nativeContext,h,i,n):function(t,e,i,n,r){var a,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(e.length<3)ux(t,e,i,n);else{var s=0,l=e.length-1;o||(s+=1,l-=1,t.moveTo(e[0].x+i,e[0].y+n));for(var u=s;u<=l;u++){var c=e[0===u?l:(u-1)%e.length],h=e[u%e.length],d=e[(u+1)%e.length],p=h.x-c.x,f=h.y-c.y,v=h.x-d.x,g=h.y-d.y,y=(Math.atan2(f,p)-Math.atan2(g,v))/2,m=Math.abs(Math.tan(y)),_=Array.isArray(r)?null!==(a=r[u%e.length])&&void 0!==a?a:0:r,b=_/m,x=cx(p,f),k=cx(v,g),S=Math.min(x,k);b>S&&(b=S,_=S*m);var A=hx(h,b,x,p,f),C=hx(h,b,k,v,g),M=2*h.x-A.x-C.x,w=2*h.y-A.y-C.y,T=cx(M,w),D=hx(h,cx(b,_),T,M,w),E=Math.atan2(A.y-D.y,A.x-D.x),B=Math.atan2(C.y-D.y,C.x-D.x),P=B-E;P<0&&(E=B,P=-P),P>Math.PI&&(P-=Math.PI),0===u?t.moveTo(A.x+i,A.y+n):t.lineTo(A.x+i,A.y+n),P&&t.arcTo(h.x+i,h.y+n,C.x+i,C.y+n,_),t.lineTo(C.x+i,C.y+n)}o||t.lineTo(e[l+1].x+i,e[l+1].y+n)}}(e.camera?e:e.nativeContext,h,i,n,p,_),_&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,C,M,S,A,l,r,o,s);var w=function(){C&&(o?o(e,t.attribute,l):S&&(e.setCommonStyle(t,t.attribute,v-i,y-n,l),e.fill()))},T=function(){M&&(s?s(e,t.attribute,l):A&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};x?(T(),w()):(w(),T()),this.afterRenderStep(t,e,i,n,C,M,S,A,l,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).polygon;this._draw(t,r,!1,i,n)}}])}(bb);yx=fx([Dc(),gx(0,wc(Yc)),gx(0,Ec(ym)),vx("design:paramtypes",[Object])],yx);var mx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},_x=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bx=function(t,e){return function(i,n){e(i,n,t)}},xx=function(){return o((function t(e){r(this,t),this.groupRenderContribitions=e,this.numberType=Ng}),[{key:"reInit",value:function(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push($_)}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){var u=t.attribute,c=u.clip,h=u.fill,d=u.stroke,p=u.background;if(c||h||d||p){l=null!=l?l:vf(t,null==a?void 0:a.theme).group;var f=t.attribute,v=f.opacity,g=void 0===v?l.opacity:v,y=f.width,m=void 0===y?l.width:y,_=f.height,b=void 0===_?l.height:_,x=f.fillOpacity,k=void 0===x?l.fillOpacity:x,S=f.strokeOpacity,A=void 0===S?l.strokeOpacity:S,C=f.cornerRadius,M=void 0===C?l.cornerRadius:C,w=f.path,T=void 0===w?l.path:w,D=f.lineWidth,E=void 0===D?l.lineWidth:D,B=f.visible,P=void 0===B?l.visible:B,R=f.fillStrokeOrder,L=void 0===R?l.fillStrokeOrder:R,I=f.cornerType,F=void 0===I?l.cornerType:I,O=f.x,z=void 0===O?l.x:O,H=f.y,N=void 0===H?l.y:H,U=am(g,k,m,b,h),j=sm(g,A,m,b),V=im(h,p),W=nm(d,E);if(t.valid&&P){if(!c){if(!V&&!W)return;if(!(U||j||o||s||p))return}if(T&&T.length&&r.drawContribution){var G=e.disableFill,Y=e.disableStroke,X=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,T.forEach((function(t){r.drawContribution.getRenderContribution(t).draw(t,r.renderService,r,a)})),e.disableFill=G,e.disableStroke=Y,e.disableBeginPath=X}else 0===M||Z(M)&&M.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,m,b)):(e.beginPath(),eb(e,i,n,m,b,M,"bevel"!==F));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push($_));var K={doFill:V,doStroke:W};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this._groupRenderContribitions.forEach((function(a){a.time===Mh.beforeFillStroke&&a.drawShape(t,e,i,n,V,W,U,j,l,r,o,s,K)})),c&&e.clip();var q=function(){K.doFill&&(o?o(e,t.attribute,l):U&&(e.setCommonStyle(t,t.attribute,z-i,N-n,l),e.fill()))},J=function(){K.doStroke&&(s?s(e,t.attribute,l):j&&(e.setStrokeStyle(t,t.attribute,z-i,N-n,l),e.stroke()))};L?(J(),q()):(q(),J()),this._groupRenderContribitions.forEach((function(a){a.time===Mh.afterFillStroke&&a.drawShape(t,e,i,n,V,W,U,j,l,r,o,s)}))}}}},{key:"draw",value:function(t,e,i,n){var r,a,o=i.context;if(o){var s=t.attribute,l=s.clip,u=s.baseOpacity,c=void 0===u?1:u,h=s.drawMode,d=o.nativeContext,p=o.canvas.nativeCanvas;if(h>0){var f=t.attribute,v=f.x,g=f.y,y=f.width,m=f.height,_=o.canvas,b=oh.global.createCanvas({width:_.width,height:_.height,dpr:1}),x=b.getContext("2d"),k=o.nativeContext.getTransform();x.setTransform(k.a,k.b,k.c,k.d,k.e,k.f),1===h&&(x.save(),x.clearRect(0,0,_.width,_.height),x.beginPath(),x.rect(v,g,y,m),x.clip(),x.drawImage(_.nativeCanvas,0,0,_.width,_.height,0,0,_.displayWidth,_.displayHeight),x.restore()),o.nativeContext=x,_.nativeCanvas=b}l?o.save():o.highPerformanceSave();var S=o.baseGlobalAlpha;o.baseGlobalAlpha*=c;var A=o.modelMatrix;if(o.camera){var C=vf(t,null==n?void 0:n.theme).group,M=cy.allocate(),w=cy.allocate();wm(w,t,C),ay(M,A||M,w),o.modelMatrix=M,cy.free(w),o.setTransform(1,0,0,1,0,0,!0)}else o.transformFromMatrix(t.transMatrix,!0);o.beginPath(),n.skipDraw?this.drawShape(t,o,0,0,i,n,(function(){return!1}),(function(){return!1})):this.drawShape(t,o,0,0,i,null,null,null);var T,D=t.attribute,E=D.scrollX,B=D.scrollY;if((E||B)&&o.translate(E,B),n&&n.renderInGroup&&(T=n.renderInGroup(null===(r=n.renderInGroupParams)||void 0===r?void 0:r.skipSort,t,i,null===(a=n.renderInGroupParams)||void 0===a?void 0:a.nextM)),o.modelMatrix!==A&&cy.free(o.modelMatrix),o.modelMatrix=A,o.baseGlobalAlpha=S,h>0){var P=t.attribute,R=P.x,L=P.y,I=P.width,F=P.height,O=o.nativeContext,z=o.canvas.nativeCanvas;d.save(),d.setTransform(o.dpr,0,0,o.dpr,0,0,!0),1===h&&O.rect(R,L,I,F),d.drawImage(z,0,0,z.width,z.height,0,0,o.canvas.displayWidth,o.canvas.displayHeight);var H=O.getTransform();d.setTransform(H.a,H.b,H.c,H.d,H.e,H.f),o.nativeContext=d,o.canvas.nativeCanvas=p,d.restore()}T&&T.then?T.then((function(){l?o.restore():o.highPerformanceRestore()})):l?o.restore():o.highPerformanceRestore()}}}])}();xx=mx([Dc(),bx(0,wc(Yc)),bx(0,Ec(fm)),_x("design:paramtypes",[Object])],xx);var kx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Sx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ax=function(t,e){return function(i,n){e(i,n,t)}},Cx=["","repeat-x","repeat-y","repeat"],Mx=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Ug,i.builtinContributions=[cb,hb],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=vf(t).image,u=t.attribute,c=u.repeatX,h=void 0===c?l.repeatX:c,d=u.repeatY,p=void 0===d?l.repeatY:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.cornerRadius,_=void 0===m?l.cornerRadius:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=u.cornerType,S=void 0===k?l.cornerType:k,A=u.image,C=this.valid(t,l,o);if(C){var M=C.fVisible,w=C.sVisible,T=C.doFill,D=C.doStroke;if(A&&t.resources){var E=t.resources.get(A);if("success"===E.state){var B=t.width,P=t.height;e.beginPath();var R=!1;0===_||Z(_)&&_.every((function(t){return 0===t}))?e.rect(i,n,B,P):(eb(e,i,n,B,P,_,"bevel"!==S),R=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var L=function(){if(T)if(o)o(e,t.attribute,l);else if(M){e.setCommonStyle(t,t.attribute,i,n,l);var r=0;if("repeat"===h&&(r|=1),"repeat"===p&&(r|=2),r){var a=e.createPattern(E.data,Cx[r]);e.fillStyle=a,e.translate(i,n,!0),e.fillRect(0,0,B,P),e.translate(-i,-n,!0)}else e.drawImage(E.data,i,n,B,P)}},I=function(){D&&(s?s(e,t.attribute,l):w&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};x?(I(),R&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,n,T,!1,M,!1,l,r,o),L(),R&&e.restore()):(R&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,n,T,!1,M,!1,l,r,o),L(),R&&e.restore(),I()),this.afterRenderStep(t,e,i,n,T,!1,M,!1,l,r,o)}}}}},{key:"draw",value:function(t,e,i){var n=t.attribute.image;if(n&&t.resources){var r=t.resources.get(n);if("loading"===r.state&&q(n))Ef.improveImageLoading(n);else if("success"===r.state)if(e.drawParams.context){var a=vf(t).image;this._draw(t,a,!1,i)}}}}])}(bb);Mx=kx([Dc(),Ax(0,wc(Yc)),Ax(0,Ec(vm)),Sx("design:paramtypes",[Object])],Mx);var Tx=Symbol.for("IncrementalDrawContribution"),Dx=Symbol.for("ArcRender"),Ex=Symbol.for("Arc3dRender"),Bx=Symbol.for("AreaRender"),Px=Symbol.for("CircleRender"),Rx=Symbol.for("GraphicRender"),Lx=Symbol.for("GroupRender"),Ix=Symbol.for("LineRender"),Fx=Symbol.for("PathRender"),Ox=Symbol.for("PolygonRender"),zx=Symbol.for("RectRender"),Hx=Symbol.for("Rect3DRender"),Nx=Symbol.for("SymbolRender"),Ux=Symbol.for("TextRender"),jx=Symbol.for("RichTextRender"),Vx=Symbol.for("Pyramid3dRender"),Wx=Symbol.for("GlyphRender"),Gx=Symbol.for("ImageRender"),Yx=Symbol.for("DrawContribution"),Xx=function(t,e,i,n){var r,a=!1,o=!1;if(e.forEachChildren((function(t){return!(a=t.numberType===Fg)})),e.forEachChildren((function(t){return!(o=!!t.findFace)})),a){var s=e.getChildren(),l=b(s);l.sort((function(t,e){for(var i,n,r,a,o=(null!==(n=null!==(i=t.attribute.startAngle)&&void 0!==i?i:0+t.attribute.endAngle)&&void 0!==n?n:0)/2,s=(null!==(a=null!==(r=e.attribute.startAngle)&&void 0!==r?r:0+e.attribute.endAngle)&&void 0!==a?a:0)/2;o<0;)o+=ei;for(;s<0;)s+=ei;return s-o})),l.forEach((function(t){t._next=null,t._prev=null})),e.removeAllChild(),e.update(),l.forEach((function(t){e.appendChild(t)})),n.hack_pieFace="outside",(r=i(a,o))&&r.graphic||(n.hack_pieFace="inside",r=i(a,o)),r&&r.graphic||(n.hack_pieFace="top",r=i(a,o)),e.removeAllChild(),s.forEach((function(t){t._next=null,t._prev=null})),s.forEach((function(t){e.appendChild(t)}))}else if(o){var u=e.getChildren(),c=u.map((function(e){return{ave_z:e.findFace().vertices.map((function(i){var n;return t.view(i[0],i[1],null!==(n=i[2]+e.attribute.z)&&void 0!==n?n:0)[2]})).reduce((function(t,e){return t+e}),0),g:e}}));c.sort((function(t,e){return e.ave_z-t.ave_z})),e.removeAllChild(),c.forEach((function(t){t.g._next=null,t.g._prev=null})),e.update(),c.forEach((function(t){e.add(t.g)})),r=i(a,o),e.removeAllChild(),u.forEach((function(t){t._next=null,t._prev=null})),e.update(),u.forEach((function(t){e.add(t)}))}else r=i(a,o);return r},Kx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},qx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Zx=Symbol.for("DrawItemInterceptor"),Jx=new On,Qx=new On,$x=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterDrawItem",value:function(t,e,i,n,r){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,n,r),!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.shadowRoot)return!1;var a=i.context;if(a.highPerformanceSave(),a.transformFromMatrix(t.transMatrix,!0),n.dirtyBounds&&n.backupDirtyBounds){Jx.copy(n.dirtyBounds),Qx.copy(n.backupDirtyBounds);var o=t.globalTransMatrix.getInverse();n.dirtyBounds.copy(n.backupDirtyBounds).transformWithMatrix(o),n.backupDirtyBounds.copy(n.dirtyBounds)}return n.renderGroup(t.shadowRoot,i,uy.allocate(1,0,0,1,0,0)),a.highPerformanceRestore(),n.dirtyBounds&&n.backupDirtyBounds&&(n.dirtyBounds.copy(Jx),n.backupDirtyBounds.copy(Qx)),!0}}])}(),tk=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterDrawItem",value:function(t,e,i,n,r){return t.attribute._debug_bounds&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.attribute._debug_bounds)return!1;var a=i.context;a.highPerformanceSave(),t.parent&&a.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&a.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);var o=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(a,t),a.strokeRect(o.x1,o.y1,o.width(),o.height()),a.highPerformanceRestore(),!0}}])}(),ek=function(){return o((function t(){r(this,t),this.order=1,this.interceptors=[new $x,new nk,new ik,new tk]}),[{key:"afterDrawItem",value:function(t,e,i,n,r){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(var a=0;a<this.interceptors.length;a++)if(this.interceptors[a].afterDrawItem&&this.interceptors[a].afterDrawItem(t,e,i,n,r))return!0;return!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(var a=0;a<this.interceptors.length;a++)if(this.interceptors[a].beforeDrawItem&&this.interceptors[a].beforeDrawItem(t,e,i,n,r))return!0;return!1}}])}();ek=Kx([Dc(),qx("design:paramtypes",[])],ek);var ik=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforeDrawItem",value:function(t,e,i,n,r){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,n,r):this.beforeSetInteractive(t,e,i,n,r))}},{key:"beforeSetInteractive",value:function(t,e,i,n,r){var a=t.interactiveGraphic;if(t.attribute.globalZIndex){a||(a=t.clone(),t.interactiveGraphic=a,a.baseGraphic=t),a.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();var o=i.stage.getLayer("_builtin_interactive");return o&&this.getShadowRoot(o).add(a),!0}if(a){i.stage.tryInitInteractiveLayer();var s=i.stage.getLayer("_builtin_interactive");s&&this.getShadowRoot(s).removeChild(a),t.interactiveGraphic=null,a.baseGraphic=null}return!1}},{key:"beforeDrawInteractive",value:function(t,e,i,n,r){for(var a=t.baseGraphic,o=!!a.stage,s=a.parent;o&&s&&s.stage!==s;)o=!!s.stage,s=s.parent;if(!o){var l=i.stage.getLayer("_builtin_interactive");return l&&this.getShadowRoot(l).removeChild(t),!0}if(a){this.processing=!0;var u=i.context;return u.highPerformanceSave(),u.setTransformFromMatrix(a.parent.globalTransMatrix,!0),a.isContainer?n.renderGroup(a,i,a.parent.globalTransMatrix):n.renderItem(a,i),u.highPerformanceRestore(),this.processing=!1,!0}return!1}},{key:"getShadowRoot",value:function(t){var e,i=t.getElementById("_interactive_group");return i||((i=B_.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!==(e=i.shadowRoot)&&void 0!==e?e:i.attachShadow()}}])}(),nk=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforeDrawItem",value:function(t,e,i,n,r){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;var a=e.drawParams,o=a.context,s=a.stage;o.canvas,o.save(),this.initCanvasCtx(o),o.camera=s.camera;var l=o.currentMatrix;l.a/=o.dpr,l.b/=o.dpr,l.c/=o.dpr,l.d/=o.dpr,l.e/=o.dpr,l.f/=o.dpr;var u=cy.allocate();ry(u,l);var c=o.modelMatrix;if(c){if(u){var h=cy.allocate();o.modelMatrix=ay(h,c,u)}}else o.modelMatrix=u;return o.setTransform(1,0,0,1,0,0,!0),t.isContainer?Xx(o,t,(function(e,r){return n.renderGroup(t,i,t.parent.globalTransMatrix,!e&&r)}),i):n.renderItem(t,i),o.camera=null,o.restore(),o.modelMatrix!==c&&cy.free(o.modelMatrix),o.modelMatrix=c,i.in3dInterceptor=!1,!0}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}])}(),rk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ak=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ok=function(t,e){return function(i,n){e(i,n,t)}},sk=function(){return o((function t(e){r(this,t),this.drawContribution=e}),[{key:"prepare",value:function(t){var e=this;t&&this.renderTreeRoots.forEach((function(i){e._prepare(i,t)}))}},{key:"_prepare",value:function(t,e){var i=this;t.forEachChildren((function(t){i._prepare(t,e)})),t.update({bounds:e,trans:!0})}},{key:"prepareRenderList",value:function(){}},{key:"beforeDraw",value:function(t){}},{key:"draw",value:function(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}},{key:"afterDraw",value:function(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}},{key:"reInit",value:function(){this.drawContribution.reInit()}},{key:"render",value:function(t,e){this.renderTreeRoots=t,this.drawParams=e;var i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}}])}();sk=rk([Dc(),ok(0,wc(Yx)),ak("design:paramtypes",[Object])],sk);var lk=new gc((function(t){t(ah).to(sk)})),uk=Symbol.for("PickerService"),ck=Symbol.for("GlobalPickerService"),hk=Symbol.for("PickItemInterceptor"),dk=Symbol.for("PickServiceInterceptor"),pk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fk=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterPickItem",value:function(t,e,i,n,r){if(t.graphic){for(var a=t.graphic;a.parent;)a=a.parent;a.shadowHost&&(t.params={shadowTarget:t.graphic},t.graphic=a.shadowHost)}return t}}])}();fk=pk([Dc()],fk);var vk=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterPickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,n,r):null}},{key:"beforePickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,n,r):null}},{key:"_pickItem",value:function(t,e,i,n,r){var a;if(!t.shadowRoot)return null;var o=(r||{}).parentMatrix;if(!o)return null;var s=e.pickContext;s.highPerformanceSave();var l=null===(a=vf(t))||void 0===a?void 0:a[t.type],u=t.attribute.shadowPickMode,c=void 0===u?null==l?void 0:l.shadowPickMode:u,h=t.shadowRoot,d=uy.allocateByObj(o),p=new ki(d.a*i.x+d.c*i.y+d.e,d.b*i.x+d.d*i.y+d.f),f=e.pickGroup(h,p,d,n);return s.highPerformanceRestore(),!f.graphic&&f.group&&"full"===c&&(f.graphic=f.group),f}}])}();vk=pk([Dc()],vk);var gk=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforePickItem",value:function(t,e,i,n,r){var a=t.baseGraphic;if(a&&a.parent){var o=new ki(i.x,i.y),s=e.pickContext;s.highPerformanceSave();var l=a.parent.globalTransMatrix;l.transformPoint(o,o);var u=a.isContainer?e.pickGroup(a,o.clone(),l,n):e.pickItem(a,o.clone(),l,n);return s.highPerformanceRestore(),u}return null}}])}();gk=pk([Dc()],gk);var yk=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforePickItem",value:function(t,e,i,n,r){if(!t.in3dMode||n.in3dInterceptor)return null;var a=e.pickContext,o=t.stage;if(!a||!o)return null;if(n.in3dInterceptor=!0,a.save(),this.initCanvasCtx(a),a.camera=o.camera,t.isContainer){var s=Xx(a,t,(function(){return e.pickGroup(t,i,r.parentMatrix,n)}),n);return a.camera=null,n.in3dInterceptor=!1,a.restore(),s}return a.restore(),null}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}])}();yk=pk([Dc()],yk);var mk=new gc((function(t,e,i){i(uk)||(t(ck).toSelf(),t(uk).toService(ck)),t(yk).toSelf().inSingletonScope(),t(hk).toService(yk),t(vk).toSelf().inSingletonScope(),t(hk).toService(vk),t(gk).toSelf().inSingletonScope(),t(hk).toService(gk),Kc(t,hk),t(fk).toSelf().inSingletonScope(),t(dk).toService(fk),Kc(t,dk)})),_k=new gc((function(t){t(Jg).to(Tm),t(Qg).toConstantValue(B_)})),bk=Symbol.for("AutoEnablePlugins"),xk=Symbol.for("PluginService"),kk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Sk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ak=function(t,e){return function(i,n){e(i,n,t)}},Ck=function(){return o((function t(e){r(this,t),this.autoEnablePlugins=e,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}),[{key:"active",value:function(t,e){var i=this;this.stage=t,this.actived=!0;var n=e.pluginList;n&&rh.isBound(bk)&&this.autoEnablePlugins.getContributions().forEach((function(t){n.includes(t.name)&&i.register(t)}))}},{key:"findPluginsByName",value:function(t){var e=[];return this.onStartupFinishedPlugin.forEach((function(i){i.name===t&&e.push(i)})),this.onRegisterPlugin.forEach((function(i){i.name===t&&e.push(i)})),e}},{key:"register",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}},{key:"unRegister",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}},{key:"release",value:function(){var t=this;this.onStartupFinishedPlugin.forEach((function(e){e.deactivate(t)})),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach((function(e){e.deactivate(t)})),this.onRegisterPlugin=[]}}])}();Ck=kk([Dc(),Ak(0,wc(Yc)),Ak(0,Ec(bk)),Sk("design:paramtypes",[Object])],Ck);var Mk=new gc((function(t){t(xk).to(Ck),function(t,e){t(Yc).toDynamicValue((function(t){var i=t.container;return new Xc(e,i)})).whenTargetNamed(e)}(t,bk)})),wk=new gc((function(t){Kc(t,ih)})),Tk=new gc((function(t){t(gp).to(yp).inSingletonScope(),Kc(t,gp)})),Dk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ek=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Bk=function(){return o((function t(){r(this,t),this.type="static",this.offscreen=!1,this.global=oh.global}),[{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"init",value:function(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{var n;this.main=!1,i.canvasId&&(n=this.global.getElementById(i.canvasId)),n||(n=this.global.createCanvas({width:e.width,height:e.height})),n.style&&(n.style["pointer-events"]="none");var r=e.getContext().getCanvas().nativeCanvas,a=bp({nativeCanvas:n,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});a.applyPosition(),this.canvas=a,this.context=a.getContext()}}},{key:"resize",value:function(t,e){this.canvas.resize(t,e)}},{key:"resizeView",value:function(t,e){}},{key:"render",value:function(t,e,i){var n;if(!this.main){var r=this.window.getContext().getCanvas().nativeCanvas;!r||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!==(n=e.background)&&void 0!==n?n:"#ffffff"},e),i))}},{key:"merge",value:function(t){var e=this;t.forEach((function(t){var i=t.getContext().canvas.nativeCanvas;e.context.drawImage(i,0,0)}))}},{key:"prepare",value:function(t,e){}},{key:"drawTo",value:function(t,e,i){var n,r=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:r},i),{clear:i.clear?null!==(n=i.background)&&void 0!==n?n:"#fff":void 0}))}},{key:"getContext",value:function(){return this.context}},{key:"release",value:function(){this.canvas.release()}}])}();Bk=Dk([Dc(),Ek("design:paramtypes",[])],Bk);var Pk=new gc((function(t){t(Bk).toSelf(),t(qy).toService(Bk)}));var Rk=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};function Lk(t,e,i){var n={},r=[];return t.forEachChildren((function(t){var i=t.attribute.zIndex,a=void 0===i?e:i;n[a]?n[a].push(t):(n[a]=[t],r.push(a))}),i),r.sort((function(t,e){return i?e-t:t-e})),{childMap:n,zIdxArray:r}}function Ik(t,e,i){var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1;a?o=!0:t.forEachChildren((function(t,i){var r=t.attribute.zIndex,a=void 0===r?e:r;if(0===i)n=a;else if(n!==a)return o=!0,!0;return!1}),r);if(o)for(var s=Lk(t,e,r),l=s.childMap,u=s.zIdxArray,c=!1,h=0;h<u.length&&!c;h++){var d=l[u[h]];a&&d.sort((function(t,e){var i,n;return(r?-1:1)*((null!==(i=e.attribute.z)&&void 0!==i?i:0)-(null!==(n=t.attribute.z)&&void 0!==n?n:0))}));for(var p=0;p<d.length;p++)if(i(d[p],p)){c=!0;break}}else t.forEachChildren(i,r)}function Fk(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Rk(this,void 0,void 0,f().m((function e(){return f().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,t.forEachChildrenAsync(i,n);case 1:return e.a(2)}}),e)})))}function Ok(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!1;t.forEachChildren((function(t,e){var n=t.attribute.zIndex;if(0===e);else if(void 0!==(void 0===n?i:n))return r=!0,!0;return!1}),n);var a=null,o=!1;if(r)for(var s=Lk(t,i,n),l=s.childMap,u=s.zIdxArray,c=!1,h=0;h<u.length&&!c;h++)for(var d=l[u[h]],p=0;p<d.length;p++){if(o){c=!0,a=d[p];break}d[p]._uid!==e||(o=!0)}else t.forEachChildren((function(t){return o?(a=t,!0):(t._uid===e&&(o=!0),!1)}),n);return a}var zk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Hk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Nk=function(t,e){return function(i,n){e(i,n,t)}},Uk=function(){return o((function t(e,i){var n=this;r(this,t),this.contributions=e,this.drawItemInterceptorContributions=i,this._renderInGroup=function(t,e,i,r){var a;t?e.forEachChildren((function(t){i.break||(t.isContainer?n.renderGroup(t,i,r):n.renderItem(t,i))})):Ik(e,Fd.zIndex,(function(t){i.break||(t.isContainer?n.renderGroup(t,i,r):n.renderItem(t,i))}),!1,!!(null===(a=i.context)||void 0===a?void 0:a.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new Fn,this.backupDirtyBounds=new Fn,this.global=oh.global,this.layerService=oh.layerService,Z(this.contributions)||(this.contributions=[this.contributions]),this.init()}),[{key:"reInit",value:function(){this.init(),this.contributions.forEach((function(t){t.reInit()}))}},{key:"init",value:function(){var t=this;this.contributions.forEach((function(e){if(e.style){var i=t.styleRenderMap.get(e.style)||new Map;i.set(e.numberType,e),t.styleRenderMap.set(e.style,i)}else t.defaultRenderMap.set(e.numberType,e)})),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"prepareForDraw",value:function(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}},{key:"draw",value:function(t,e){var i,n=this;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;var r=e.context,a=e.stage,o=e.viewBox,s=e.transMatrix;if(r){var l=this.dirtyBounds.setValue(0,0,o.width(),o.height());if(a.dirtyBounds&&!a.dirtyBounds.empty()){var u=ji(l,a.dirtyBounds,!1);l.x1=Math.floor(u.x1),l.y1=Math.floor(u.y1),l.x2=Math.ceil(u.x2),l.y2=Math.ceil(u.y2)}var c=r.dpr%1;(c||.5!==c)&&(l.x1=Math.floor(l.x1*r.dpr)/r.dpr,l.y1=Math.floor(l.y1*r.dpr)/r.dpr,l.x2=Math.ceil(l.x2*r.dpr)/r.dpr,l.y2=Math.ceil(l.y2*r.dpr)/r.dpr),this.backupDirtyBounds.copy(l),r.reset(!1),r.save(),r.setClearMatrix(s.a,s.b,s.c,s.d,s.e,s.f),r.clearMatrix(!1),r.translate(o.x1,o.y1,!0),r.beginPath(),r.rect(l.x1,l.y1,l.width(),l.height()),r.clip(),a.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,r,e),(null===(i=t.drawParams)||void 0===i?void 0:i.stage)&&t.drawParams.stage.hooks.afterClearScreen.call(t.drawParams),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Fd.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Fd.zIndex)})).forEach((function(t){t.isContainer?n.renderGroup(t,e,uy.allocate(1,0,0,1,0,0)):n.renderItem(t,e)})),r.restore(),r.draw()}}},{key:"doRegister",value:function(){throw new Error("暂不支持")}},{key:"_findNextGraphic",value:function(t){for(var e=t.parent,i=t._uid;e;){var n=Ok(e,i,Fd.zIndex);if(n)return n;i=e._uid,e=e.parent}return null}},{key:"renderGroup",value:function(t,e,i,n){if(!e.break&&!1!==t.attribute.visibleAll){if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(!this.useDirtyBounds||rn(t.AABBBounds,this.dirtyBounds,!1)||"empty"===t.attribute.boundsMode){var r,a=i;if(this.useDirtyBounds){r=ix.allocateByObj(this.dirtyBounds);var o=t.transMatrix;a=uy.allocateByObj(i).multiply(o.a,o.b,o.c,o.d,o.e,o.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(a.getInverse())}e.isGroupScroll=!(!t.attribute.scrollX&&!t.attribute.scrollY),this.renderItem(t,e,{renderInGroupParams:{skipSort:n,nextM:a},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(r),ix.free(r),uy.free(a))}}}},{key:"_increaseRender",value:function(t,e){var i=e.layer,n=e.stage,r=i.subLayers,a=r.get(t._uid);a||(a={layer:this.layerService.createLayer(n),zIndex:r.size,group:t},r.set(t._uid,a));var o=a.layer.getNativeHandler().getContext(),s=a.drawContribution||rh.get(Tx);s.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:a.layer,context:o,startAtId:t._uid,break:!1})),a.drawContribution=s;var l=this._findNextGraphic(t);if(l)if(l.isContainer&&l.incremental)this._increaseRender(l,e);else{var u=r.get(l._uid);u||(u={layer:this.layerService.createLayer(n),zIndex:r.size},r.set(l._uid,u));var c=u.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:u.layer,context:c,startAtId:l._uid,break:!1}))}}},{key:"getRenderContribution",value:function(t){var e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}},{key:"renderItem",value:function(t,e,i){if(this.InterceptorContributions.length)for(var n=0;n<this.InterceptorContributions.length;n++){var r=this.InterceptorContributions[n];if(r.beforeDrawItem&&r.beforeDrawItem(t,this.currentRenderService,e,this,i))return}var a=this.getRenderContribution(t);if(a){var o,s=!1;if(e.isGroupScroll){var l=t.parent.attribute,u=l.scrollX,c=void 0===u?0:u,h=l.scrollY,d=void 0===h?0:h;s=!0,this.scrollMatrix||(this.scrollMatrix=uy.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-c,-d)}if(s&&(o=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),!this.useDirtyBounds||t.isContainer||"empty"===t.attribute.boundsMode||rn(t.AABBBounds,null!=o?o:this.dirtyBounds,!1)){var p=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=p),p?t.isContainer&&a.draw(t,this.currentRenderService,e,i):a.draw(t,this.currentRenderService,e,i),s&&t.parent){var f=t.parent.attribute,v=f.scrollX,g=void 0===v?0:v,y=f.scrollY,m=void 0===y?0:y;this.scrollMatrix&&this.scrollMatrix.translate(g,m)}if(this.InterceptorContributions.length)for(var _=0;_<this.InterceptorContributions.length;_++){var b=this.InterceptorContributions[_];if(b.afterDrawItem&&b.afterDrawItem(t,this.currentRenderService,e,this))return}}else if(s&&t.parent){var x=t.parent.attribute,k=x.scrollX,S=void 0===k?0:k,A=x.scrollY,C=void 0===A?0:A;this.scrollMatrix&&this.scrollMatrix.translate(S,C)}}}},{key:"selectRenderByType",value:function(t){return Wt.getInstance().warn("未知错误，不应该走到这里"),null}},{key:"selectRenderByNumberType",value:function(t,e){var i;if(e.attribute.renderStyle){var n=this.styleRenderMap.get(e.attribute.renderStyle);i=n&&n.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}},{key:"clearScreen",value:function(t,e,i){var n,r,a,o=i.clear,s=i.viewBox,l=s.width(),u=s.height();if(o){e.clearRect(0,0,l,u),(null===(n=t.drawParams)||void 0===n?void 0:n.stage)&&t.drawParams.stage.hooks.afterClearRect.call(t.drawParams);var c=null===(r=t.drawParams)||void 0===r?void 0:r.stage;if(c&&(e.globalAlpha=null!==(a=c.attribute.opacity)&&void 0!==a?a:1),c&&c.backgroundImg&&c.resources){var h=c.resources.get(o);h&&"success"===h.state&&h.data&&e.drawImage(h.data,0,0,l,u)}else e.fillStyle=ep(e,o,{AABBBounds:{x1:0,y1:0,x2:0+l,y2:0+u}},0,0),e.fillRect(0,0,l,u)}}},{key:"afterDraw",value:function(t,e){}}])}();Uk=zk([Dc(),Nk(0,Tc(Rx)),Nk(1,wc(Yc)),Nk(1,Ec(Zx)),Hk("design:paramtypes",[Array,Object])],Uk);var jk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Vk=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=jg,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s,l){if(t.incremental&&a.multiGraphicOptions){var u=a.multiGraphicOptions,c=u.startAtIdx,h=u.length,d=t.attribute.segments,p=void 0===d?[]:d;if(c>p.length)return;var f=vf(t).line,v=t.attribute,g=v.fill,y=void 0===g?f.fill:g,m=v.stroke,b=void 0===m?f.stroke:m,x=v.opacity,k=void 0===x?f.opacity:x,S=v.fillOpacity,A=void 0===S?f.fillOpacity:S,C=v.strokeOpacity,M=void 0===C?f.strokeOpacity:C,w=v.lineWidth,T=void 0===w?f.lineWidth:w,D=v.visible,E=void 0===D?f.visible:D,B=rm(k,A,y),P=om(k,M),R=im(y),L=nm(b,T);if(!t.valid||!E)return;if(!R&&!L)return;if(!(B||P||s||l))return;for(var I=a.context,F=c;F<c+h;F++)this.drawIncreaseSegment(t,I,p[F-1],p[F],t.attribute.segments[F],[f,t.attribute],n,r)}else _(e,"drawShape",this,3)([t,i,n,r,a,o,s,l])}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,a,o,s){n&&(e.beginPath(),function(t,e,i,n){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=e?e.points[e.points.length-1]:i.points[0];t.moveTo(u.x+o,u.y+l),i.points.forEach((function(e){!1!==e.defined?t.lineTo(e.x+o,e.y+l):t.moveTo(e.x+o,e.y+l)}))}(e.nativeContext,i,n,{offsetX:o,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,a),e.setStrokeStyle(t,r,o,s,a),e.stroke())}}])}(Rb);Vk=jk([Dc()],Vk);var Wk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Gk=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=Og,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s){if(t.incremental&&a.multiGraphicOptions){var l=a.multiGraphicOptions,u=l.startAtIdx,c=l.length,h=t.attribute.segments,d=void 0===h?[]:h;if(u>d.length)return;var p=vf(t).area,f=t.attribute,v=f.fill,g=void 0===v?p.fill:v,y=f.fillOpacity,m=void 0===y?p.fillOpacity:y,b=f.opacity,x=void 0===b?p.opacity:b,k=f.visible,S=void 0===k?p.visible:k,A=rm(x,m,g),C=im(g);if(!t.valid||!S)return;if(!C)return;if(!A&&!s)return;for(var M=u;M<u+c;M++)this.drawIncreaseSegment(t,i,d[M-1],d[M],t.attribute.segments[M],[p,t.attribute],n,r)}else _(e,"drawShape",this,3)([t,i,n,r,a,o,s])}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,a,o,s){n&&(e.beginPath(),function(t,e,i,n){for(var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=i.points,c=[],h=0;h<u.length;h++)u[h].defined;c.push(u),c.forEach((function(i,n){var r,a,s,u,c=e&&0===n?e.points[e.points.length-1]:i[0];t.moveTo(c.x+o,c.y+l),i.forEach((function(e){!1!==e.defined?t.lineTo(e.x+o,e.y+l):t.moveTo(e.x+o,e.y+l)}));for(var h=i.length-1;h>=0;h--){var d=i[h];t.lineTo(null!==(r=d.x1)&&void 0!==r?r:d.x,null!==(a=d.y1)&&void 0!==a?a:d.y)}t.lineTo(null!==(s=c.x1)&&void 0!==s?s:c.x,null!==(u=c.y1)&&void 0!==u?u:c.y),t.closePath()}))}(e.camera?e:e.nativeContext,i,n,{offsetX:o,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,a),e.setCommonStyle(t,r,o,s,a),e.fill())}}])}(Nb);Gk=Wk([Dc()],Gk);var Yk,Xk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Kk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},qk=function(t,e){return function(i,n){e(i,n,t)}},Zk=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};!function(t){t[t.NORMAL=0]="NORMAL",t[t.STOP=1]="STOP"}(Yk||(Yk={}));var Jk=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[t,o])).contributions=t,s.lineRender=i,s.areaRender=a,s.drawItemInterceptorContributions=o,s.rendering=!1,s.currFrameStartAt=0,s.currentIdx=0,s.status=Yk.NORMAL,s.checkingForDrawPromise=null,s.hooks={completeDraw:new eh([])},s.defaultRenderMap.set(s.lineRender.numberType,s.lineRender),s.defaultRenderMap.set(s.areaRender.numberType,s.areaRender),s}return h(e,t),o(e,[{key:"draw",value:function(t,e){return Zk(this,void 0,void 0,f().m((function i(){var n,r,a,o=this;return f().w((function(i){for(;;)switch(i.n){case 0:if(!this.checkingForDrawPromise){i.n=1;break}return i.a(2);case 1:return this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e),i.n=2,this.checkingForDrawPromise;case 2:if(n=i.v,this.checkingForDrawPromise=null,!n){i.n=3;break}return i.a(2);case 3:this.currentRenderService=t,r=e.context,a=e.viewBox,r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(a.x1,a.y1,!0),r.save(),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Fd.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Fd.zIndex)})).forEach((function(t){o.renderGroup(t,e)})),this.hooks.completeDraw.tap("top-draw",(function(){r.restore(),r.restore(),r.draw(),r.inuse=!1,o.rendering=!1})));case 4:return i.a(2)}}),i,this)})))}},{key:"_increaseRender",value:function(t,e){return Zk(this,void 0,void 0,f().m((function i(){return f().w((function(i){for(;;)switch(i.n){case 0:return this.rendering=!0,i.n=1,this._renderIncrementalGroup(t,e);case 1:return i.a(2)}}),i,this)})))}},{key:"_renderIncrementalGroup",value:function(t,e){return Zk(this,void 0,void 0,f().m((function i(){var n=this;return f().w((function(i){for(;;)switch(i.n){case 0:return this.count=t.count,i.n=1,new Promise((function(i){n.renderItem(t,e,{drawingCb:function(){return Zk(n,void 0,void 0,f().m((function n(){var r,a=this;return f().w((function(n){for(;;)switch(n.n){case 0:if(2===t.count){n.n=2;break}return n.n=1,Fk(t,Fd.zIndex,(function(i,n){if(a.status===Yk.STOP)return!0;if(i.isContainer)return!1;if(n<a.currentIdx)return!1;var r=a.currFrameStartAt+t.incremental;return n<r&&(a.currentIdx=n+1,a.renderItem(i,e)),n===r-1&&(a.currFrameStartAt=a.currentIdx,a.waitToNextFrame())}));case 1:i(!1),n.n=8;break;case 2:if(!(r=t.getChildAt(0)).incremental||!r.attribute.segments){n.n=6;break}r.incrementalAt||(r.incrementalAt=0);case 3:if(!(r.incrementalAt<r.attribute.segments.length)){n.n=5;break}return e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,n.n=4,this.waitToNextFrame();case 4:n.n=3;break;case 5:n.n=7;break;case 6:this.renderItem(r,e);case 7:i(!1);case 8:return n.a(2)}}),n,this)})))}})}));case 1:this.hooks.completeDraw.call();case 2:return i.a(2)}}),i,this)})))}},{key:"waitToNextFrame",value:function(){return Zk(this,void 0,void 0,f().m((function t(){var e=this;return f().w((function(t){for(;;)if(0===t.n)return t.a(2,new Promise((function(t){e.global.getRequestAnimationFrame()((function(){t(!1)}))})))}),t)})))}},{key:"checkForDraw",value:function(t){return Zk(this,void 0,void 0,f().m((function e(){var i;return f().w((function(e){for(;;)switch(e.n){case 0:if(i=this.rendering,!t.restartIncremental){e.n=2;break}return i=!1,e.n=1,this.forceStop();case 1:this.resetToInit();case 2:return e.a(2,i)}}),e,this)})))}},{key:"forceStop",value:function(){return Zk(this,void 0,void 0,f().m((function t(){var e=this;return f().w((function(t){for(;;)switch(t.n){case 0:if(!this.rendering){t.n=1;break}return this.status=Yk.STOP,t.n=1,new Promise((function(t){e.hooks.completeDraw.tap("stopCb",(function(){e.status=Yk.NORMAL,e.hooks.completeDraw.taps=e.hooks.completeDraw.taps.filter((function(t){return"stopCb"!==t.name})),t(!1)}))}));case 1:return t.a(2)}}),t,this)})))}},{key:"resetToInit",value:function(){this.currFrameStartAt=0,this.currentIdx=0}},{key:"renderGroup",value:function(t,e){return Zk(this,void 0,void 0,f().m((function i(){var n,r=this;return f().w((function(i){for(;;)switch(i.n){case 0:if(e.break||!1===t.attribute.visibleAll){i.n=5;break}if(!t.incremental||e.startAtId!==t._uid){i.n=2;break}return i.n=1,this._increaseRender(t,e);case 1:n=void(e.break=!0),i.n=4;break;case 2:return i.n=3,new Promise((function(i){r.renderItem(t,e,{drawingCb:function(){return Zk(r,void 0,void 0,f().m((function n(){var r=this;return f().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,Fk(t,Fd.zIndex,(function(t){return Zk(r,void 0,void 0,f().m((function i(){return f().w((function(i){for(;;)switch(i.n){case 0:if(e.break){i.n=1;break}if(!t.isContainer){i.n=1;break}return i.n=1,this.renderGroup(t,e);case 1:return i.a(2)}}),i,this)})))}));case 1:i(!1);case 2:return n.a(2)}}),n)})))}})}));case 3:n=void i.v;case 4:return i.a(2,n);case 5:return i.a(2)}}),i,this)})))}}])}(Uk);Jk=Xk([Dc(),qk(0,Tc(Rx)),qk(1,wc(Vk)),qk(2,wc(Gk)),qk(3,wc(Yc)),qk(3,Ec(Zx)),Kk("design:paramtypes",[Array,Object,Object,Object])],Jk);var Qk=new gc((function(t){t(F_).toSelf().inSingletonScope(),t(j_).toSelf().inSingletonScope(),t(Yx).to(Uk),t(Tx).to(Jk),t(Lx).to(xx).inSingletonScope(),t(Rx).toService(Lx),Kc(t,fm),t(z_).toSelf().inSingletonScope(),Kc(t,xm),Kc(t,Rx),t(ek).toSelf().inSingletonScope(),t(Zx).toService(ek),Kc(t,Zx)}));function $k(){$k.__loaded||($k.__loaded=!0,rh.load(em),rh.load(_k),rh.load(lk),rh.load(mk),rh.load(Mk),function(t){t.load(wk),t.load(Tk),t.load(Pk)}(rh),function(t){t.load(Qk)}(rh))}$k.__loaded=!1,$k();var tS=rh.get(nh);oh.global=tS;var eS=rh.get(Xy);oh.graphicUtil=eS;var iS=rh.get(Yy);oh.transformUtil=iS;var nS=rh.get(Jg);oh.graphicService=nS;var rS=rh.get(Ky);oh.layerService=rS;var aS,oS=function(){return o((function t(){var e=this;r(this,t),this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=function(t){t.glyphHost&&(t=t.glyphHost),t.stage===e.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}),[{key:"activate",value:function(t){this.pluginService=t;var e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}},{key:"deactivate",value:function(t){var e=this,i=function(t){return t.filter((function(t){return t.name!==e.key}))},n=this.pluginService.stage;n&&(n.graphicService.hooks.onAttributeUpdate.taps=i(n.graphicService.hooks.onAttributeUpdate.taps),n.graphicService.hooks.onSetStage.taps=i(n.graphicService.hooks.onSetStage.taps),n.graphicService.hooks.onRemove.taps=i(n.graphicService.hooks.onRemove.taps))}}])}(),sS=function(){return o((function t(){var e=this;r(this,t),this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=function(t){t.glyphHost&&(t=t.glyphHost),t.stage===e.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}),[{key:"activate",value:function(t){this.pluginService=t,this.dpr=oh.global.devicePixelRatio,this.refresh()}},{key:"refresh",value:function(){this._refreshByMediaQuery()||this._refreshByRaf()}},{key:"_refreshByRaf",value:function(){var t=this,e=oh.global.getRequestAnimationFrame();this.rafId=e((function(){oh.global.devicePixelRatio!==t.dpr&&(t.dpr=oh.global.devicePixelRatio,t.pluginService.stage.setDpr(t.dpr,!0)),t.refresh()}))}},{key:"_refreshByMediaQuery",value:function(){var t=this;try{var e="(resolution: ".concat(window.devicePixelRatio,"dppx)"),i=function(){window.devicePixelRatio!==t.dpr&&(t.dpr=window.devicePixelRatio,t.pluginService.stage.setDpr(t.dpr,!0))},n=matchMedia(e);n&&n.addEventListener("change",i),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push((function(){n&&n.removeEventListener("change",i)}))}catch(t){return!1}return!0}},{key:"deactivate",value:function(t){var e,i=oh.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),null===(e=this.autoRefreshCbs)||void 0===e||e.forEach((function(t){t()})),this.autoRefreshCbs=void 0}}])}(),lS=function(){return o((function t(){r(this,t),this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid}),[{key:"activate",value:function(t){var e=this;this.pluginService=t;var i=this.pluginService.stage;i&&(i.graphicService.hooks.onAddIncremental.tap(this.key,(function(i,n,r){i.glyphHost&&(i=i.glyphHost),i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=n._uid,e.renderNextFrame(n))})),i.graphicService.hooks.onClearIncremental.tap(this.key,(function(i,n){i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=i._uid,e.nextUserParams.restartIncremental=!0,e.renderNextFrame(i))})))}},{key:"deactivate",value:function(t){var e=this,i=this.pluginService.stage;i&&(i.graphicService.hooks.onAddIncremental.taps=i.graphicService.hooks.onAddIncremental.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.onClearIncremental.taps=i.graphicService.hooks.onClearIncremental.taps.filter((function(t){return t.name!==e.key})))}},{key:"renderNextFrame",value:function(t){var e=this;this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,oh.global.getRequestAnimationFrame()((function(){e._doRenderInThisFrame(),e.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){var t=this,e=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach((function(i){var n=i.layer;if(n&&i.layer.subLayers){var r=i.layer.subLayers.get(i._uid);r&&r.drawContribution&&r.drawContribution.draw(e.renderService,Object.assign({stage:e,layer:n,viewBox:e.window.getViewBox(),transMatrix:e.window.getViewBoxTransform(),clear:"transparent",renderService:e.renderService,updateBounds:!1,startAtId:i._uid,context:r.layer.getNativeHandler().getContext()},t.nextUserParams))}})),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}])}(),uS=new On,cS=function(){return o((function t(){r(this,t),this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(t){t&&t===e.pluginService.stage&&t.dirtyBounds.clear()}));var i=this.pluginService.stage;i&&(i.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(function(t,i,n,r){t.glyphHost&&(t=t.glyphHost),i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||n&&(uS.setValue(r.x1,r.y1,r.x2,r.y2),i.dirty(uS,t.parent&&t.parent.globalTransMatrix)))})),i.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(function(t,i,n,r,a){i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!a||i.dirty(r.globalAABBBounds))})),i.graphicService.hooks.clearAABBBounds.tap(this.key,(function(t,i,n){i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(n)})),i.graphicService.hooks.onRemove.tap(this.key,(function(t){var i=t.stage;i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(t.globalAABBBounds)})))}},{key:"deactivate",value:function(t){var e=this,i=this.pluginService.stage;i&&(i.graphicService.hooks.beforeUpdateAABBBounds.taps=i.graphicService.hooks.beforeUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.afterUpdateAABBBounds.taps=i.graphicService.hooks.afterUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.clearAABBBounds.taps=i.graphicService.hooks.clearAABBBounds.taps.filter((function(t){return t.name!==e.key})),i.hooks.afterRender.taps=i.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.onRemove.taps=i.graphicService.hooks.onRemove.taps.filter((function(t){return t.name!==e.key})))}}])}();function hS(){!function(){if(null==aS)try{var t=document.createElement("canvas"),e=t.getContext("2d");(aS=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(aS=!!document.createElement)}catch(t){aS=!1}}();var t=oh.global&&oh.global.env;return t?"browser"===t:aS}var dS=function(){function t(){r(this,t)}return o(t,null,[{key:"registerPlugin",value:function(e,i){t._pluginClasses[e]=i}},{key:"getPlugin",value:function(e){return t._pluginClasses[e]}}])}();dS._pluginClasses={};var pS="white",fS=function(t){function e(){var t,a,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e,[{}])).tickedBeforeRender=!0,t._onVisibleChange=function(e){if(!(t._skipRender<0))if(e){if(t.dirtyBounds){var i=t.window.getViewBox();t.dirtyBounds.setValue(i.x1,i.y1,i.width(),i.height())}t._skipRender>1&&t.renderNextFrame(),t._skipRender=0}else t._skipRender=1},t.beforeRender=function(e){t._beforeRenderList.forEach((function(t){return t(e)}))},t.afterClearScreen=function(e){t._afterClearScreen&&t._afterClearScreen(e)},t.afterClearRect=function(e){t._afterClearRect&&t._afterClearRect(e)},t.afterRender=function(e){t.renderCount++,t._afterRenderList.forEach((function(t){return t(e)})),t._afterNextRenderCbs&&t._afterNextRenderCbs.forEach((function(t){return t(e)})),t._afterNextRenderCbs=null,t.tickedBeforeRender=!1},t.afterTickCb=function(){t.tickedBeforeRender=!0,"rendering"!==t.state&&t.renderNextFrame()},t.params=s,t.theme=new pf,t.hooks={beforeRender:new eh(["stage"]),afterRender:new eh(["stage"]),afterClearScreen:new eh(["stage"]),afterClearRect:new eh(["stage"])},t.global=oh.global,!t.global.env&&hS()&&t.global.setEnv("browser"),t.window=rh.get(Qp),t.renderService=rh.get(ah),t.pluginService=rh.get(xk),t.layerService=rh.get(Ky),t.graphicService=rh.get(Jg),t.pluginService.active(i(t),s),t._beforeRenderList=[],t._afterRenderList=[],t.window.create({width:s.width,height:s.height,viewBox:s.viewBox,container:s.container,dpr:s.dpr||t.global.devicePixelRatio,canvasControled:!1!==s.canvasControled,title:s.title||"",canvas:s.canvas}),t.state="normal",t.renderCount=0,t.tryInitEventSystem(),t._background=null!==(a=s.background)&&void 0!==a?a:pS,t.appendChild(t.layerService.createLayer(i(t),{main:!0})),t.nextFrameRenderLayerSet=new Set,t.willNextFrameRender=!1,t.stage=i(t),t.renderStyle=s.renderStyle,s.autoRender&&t.enableAutoRender(),s.autoRefresh&&t.enableAutoRefresh(),!1===s.disableDirtyBounds&&t.enableDirtyBounds(),s.enableHtmlAttribute&&t.enableHtmlAttribute(s.enableHtmlAttribute),s.ReactDOM&&t.enableReactAttribute(s.ReactDOM),s.enableLayout&&t.enableLayout(),t.hooks.beforeRender.tap("constructor",t.beforeRender),t.hooks.afterRender.tap("constructor",t.afterRender),s.beforeRender&&t._beforeRenderList.push(s.beforeRender),s.afterRender&&t._afterRenderList.push(s.afterRender),t.hooks.afterClearScreen.tap("constructor",t.afterClearScreen),t.hooks.afterClearRect.tap("constructor",t.afterClearRect),t._afterClearScreen=s.afterClearScreen,t._afterClearRect=s.afterClearRect,t.supportInteractiveLayer=!1!==s.interactiveLayer,s.optimize||(s.optimize={tickRenderMode:"effect"}),t.optmize(s.optimize),s.background&&q(t._background)&&t._background.includes("/")&&t.setAttributes({background:t._background}),t.initAnimate(s),t.rafId=null!==(o=s.rafId)&&void 0!==o?o:Math.floor(6*Math.random()),t}return h(e,t),o(e,[{key:"viewBox",get:function(){return this.window.getViewBox()},set:function(t){this.window.setViewBox(t)}},{key:"x",get:function(){return this.window.getViewBox().x1},set:function(t){var e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}},{key:"y",get:function(){return this.window.getViewBox().y1},set:function(t){var e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}},{key:"width",get:function(){return this.window.width},set:function(t){this.resize(t,this.height)}},{key:"viewWidth",get:function(){return this.window.getViewBox().width()},set:function(t){this.resizeView(t,this.viewHeight)}},{key:"viewHeight",get:function(){return this.window.getViewBox().height()},set:function(t){this.resizeView(this.viewWidth,t)}},{key:"height",get:function(){return this.window.height},set:function(t){this.resize(this.width,t)}},{key:"dpr",get:function(){return this.window.dpr},set:function(t){this.setDpr(t)}},{key:"background",get:function(){var t;return null!==(t=this._background)&&void 0!==t?t:pS},set:function(t){this._background=t}},{key:"defaultLayer",get:function(){return this.at(0)}},{key:"eventSystem",get:function(){return this._eventSystem}},{key:"ticker",get:function(){return this._ticker},set:function(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}},{key:"initAnimate",value:function(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),"performance"===(null===(e=this.params.optimize)||void 0===e?void 0:e.tickRenderMode)&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}},{key:"startAnimate",value:function(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}},{key:"pauseRender",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._skipRender=t}},{key:"resumeRender",value:function(){this._skipRender=0}},{key:"tryInitEventSystem",value:function(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new Df(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}},{key:"preventRender",value:function(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}},{key:"optmize",value:function(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}},{key:"optmizeRender",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}},{key:"getTimeline",value:function(){return this.timeline}},{key:"get3dOptions",value:function(t){var e=t.center,i=void 0===e?{x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0}:e,n=t.light,r=void 0===n?{}:n,a=t.alpha,o=void 0===a?0:a,s=t.beta,l=void 0===s?0:s,u=t.camera,c=t.fieldRatio,h=void 0===c?1:c,d=t.fieldDepth;return Object.assign(Object.assign({},t),{center:i,light:r,alpha:o,beta:l,camera:u,fieldRatio:h,fieldDepth:d})}},{key:"set3dOptions",value:function(t){var e,i,n,r,a,o;this.option3d=t;var s=this.get3dOptions(t),l=s.light,u=s.center,c=s.camera,h=s.alpha,d=s.beta,p=s.fieldRatio,f=s.fieldDepth,v=l.dir,g=void 0===v?[1,1,-1]:v,y=l.color,m=void 0===y?"white":y,_=l.ambient,b=(null!==(e=u.x)&&void 0!==e?e:this.width/2)+(null!==(i=u.dx)&&void 0!==i?i:0),x=(null!==(n=u.y)&&void 0!==n?n:this.height/2)+(null!==(r=u.dy)&&void 0!==r?r:0),k=[b,x,(null!==(a=u.z)&&void 0!==a?a:0)+(null!==(o=u.dz)&&void 0!==o?o:0)],S=0,A=0,C=0;c||(S=Math.sin(h)+b,A=Math.sin(d)+x,C=Math.cos(h)*Math.cos(d)*1);var M=dS.getPlugin("DirectionalLight");M&&(this.light=new M(g,m,_));var w={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:p,fieldDepth:f,viewParams:{pos:[S,A,C],center:k,up:[0,1,0]}};if(this.camera)this.camera.params=w;else{var T=dS.getPlugin("OrthoCamera");T&&(this.camera=new T(w))}t.enableView3dTransform&&this.enableView3dTransform()}},{key:"setBeforeRender",value:function(t){this._beforeRenderList.push(t)}},{key:"removeBeforeRender",value:function(t){this._beforeRenderList=this._beforeRenderList.filter((function(e){return e!==t}))}},{key:"setAfterRender",value:function(t){this._afterRenderList.push(t)}},{key:"removeAfterRender",value:function(t){this._afterRenderList=this._afterRenderList.filter((function(e){return e!==t}))}},{key:"afterNextRender",value:function(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}},{key:"enableView3dTransform",value:function(){if(!this.view3dTranform){this.view3dTranform=!0;var t=dS.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}}},{key:"disableView3dTranform",value:function(){var t=this;this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRender",value:function(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new oS))}},{key:"disableAutoRender",value:function(){var t=this;this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRefresh",value:function(){this.autoRefresh||"node"===this.global.env||(this.autoRefresh=!0,this.pluginService.register(new sS))}},{key:"disableAutoRefresh",value:function(){var t=this;this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableIncrementalAutoRender",value:function(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new lS))}},{key:"disableIncrementalAutoRender",value:function(){var t=this;this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableDirtyBounds",value:function(){if(!this.dirtyBounds){this.dirtyBounds=new Fn;var t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new cS,this.pluginService.register(t))}}},{key:"disableDirtyBounds",value:function(){var t=this;this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableLayout",value:function(){if(!this._enableLayout){this._enableLayout=!0;var t=dS.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}}},{key:"disableLayout",value:function(){var t=this;this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableHtmlAttribute",value:function(t){if(!this.htmlAttribute){var e=dS.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}}},{key:"disableHtmlAttribute",value:function(){var t=this;this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableReactAttribute",value:function(t){if(!this.reactAttribute){var e=dS.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}}},{key:"disableReactAttribute",value:function(){var t=this;this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"getPluginsByName",value:function(t){return this.pluginService.findPluginsByName(t)}},{key:"tryUpdateAABBBounds",value:function(){var t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}},{key:"combineLayer",value:function(t,e){throw new Error("暂不支持")}},{key:"createLayer",value:function(t,e){if("released"!==this.releaseStatus){var i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}}},{key:"sortLayer",value:function(t){var e=this,i=this.children;i.sort(t),this.removeAllChild(),i.forEach((function(t){e.appendChild(t)}))}},{key:"removeLayer",value:function(t){return this.removeChild(this.findChildByUid(t))}},{key:"tryInitInteractiveLayer",value:function(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}},{key:"clearViewBox",value:function(t){this.window.clearViewBox(t)}},{key:"render",value:function(t,e){if("released"!==this.releaseStatus){this.startAnimate();var i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}}},{key:"combineLayersToWindow",value:function(){if("harmony"===this.global.env){var t=this.window.getContext().nativeContext;this.forEachChildren((function(e,i){if(i>0){var n=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(n)}}))}}},{key:"renderNextFrame",value:function(t,e){var i=this;this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach((function(t){i.nextFrameRenderLayerSet.add(t)})),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)((function(){i._doRenderInThisFrame(),i.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){if("released"!==this.releaseStatus){this.startAnimate();var t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}}},{key:"renderLayerList",value:function(t,e){for(var i=this,n=[],r=0;r<t.length;r++){var a=t[r];"virtual"===a.layerMode&&(a=a.getNativeHandler().mainHandler.layer),n.includes(a)||n.push(a)}n.forEach((function(t){t.renderCount>i.renderCount||(t.renderCount=i.renderCount+1,t===i.interactiveLayer&&i.dirtyBounds&&i.dirtyBounds.clear(),t.render({renderService:i.renderService,background:t===i.defaultLayer?i.background:void 0,updateBounds:!(!i.dirtyBounds||i.dirtyBounds.empty()),viewBox:i.window.getViewBox(),transMatrix:i.window.getViewBoxTransform()},Object.assign({renderStyle:i.renderStyle},e)))})),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}},{key:"resizeWindow",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.window.resize(t,e),i&&this.render()}},{key:"resize",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren((function(i){i.resize(t,e)})),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}},{key:"resizeView",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren((function(i){i.resizeView(t,e)})),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}},{key:"setViewBox",value:function(t,e,i,n,r){var a=this,o=!0;"object"==k(t)?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(o=!1)):(this.viewBox.setValue(t,e,t+i,e+n),!1===r&&(o=!1)),this.forEachChildren((function(t){t.resizeView(a.viewBox.width(),a.viewBox.height())})),o&&this.render()}},{key:"setDpr",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.forEachChildren((function(e){e.setDpr(t)})),e&&this.render()}},{key:"setOrigin",value:function(t,e){throw new Error("暂不支持")}},{key:"export",value:function(t){throw new Error("暂不支持")}},{key:"pick",value:function(t,e){if("released"!==this.releaseStatus){var i=this.getPickerService().pick(this.children,new ki(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"release",value:function(){var t,i,n=this;_(e,"release",this,3)([]),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach((function(t){t.release()})),this.interactiveLayer&&(this.interactiveLayer.forEachChildren((function(t){t.setStage&&t.setStage(null,null),n.interactiveLayer.removeChild(t)})),this.interactiveLayer.release()),this.window.release(),null===(t=this._ticker)||void 0===t||t.remTimeline(null==this?void 0:this.timeline),null===(i=this._ticker)||void 0===i||i.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}},{key:"setStage",value:function(t){}},{key:"dirty",value:function(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}},{key:"getLayer",value:function(t){return this.children.filter((function(e){return e.name===t}))[0]}},{key:"renderTo",value:function(t){var e=this;"released"!==this.releaseStatus&&this.forEachChildren((function(i,n){i.drawTo(t,{renderService:e.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:i===e.defaultLayer?e.background:void 0,clear:0===n,updateBounds:!(!e.dirtyBounds||e.dirtyBounds.empty())})}))}},{key:"renderToNewWindow",value:function(){var t=arguments.length>1?arguments[1]:void 0;if("released"!==this.releaseStatus){var e=rh.get(Qp),i=t?-t.x1:0,n=t?-t.y1:0,r=t?t.x2:this.viewWidth,a=t?t.y2:this.viewHeight,o=t?t.width():this.viewWidth,s=t?t.height():this.viewHeight;return e.create({viewBox:{x1:i,y1:n,x2:r,y2:a},width:o,height:s,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(e),e}}},{key:"toCanvas",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;if("released"!==this.releaseStatus){var i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}}},{key:"setCursor",value:function(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}},{key:"getCursor",value:function(){return this._cursor}},{key:"eventPointTransform",value:function(t){var e=this.global.mapToCanvasPoint(t,this.window);return this.stage.window.pointTransform(e.x,e.y)}},{key:"pauseTriggerEvent",value:function(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}},{key:"resumeTriggerEvent",value:function(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}},{key:"getPickerService",value:function(){return this.pickerService||(this.pickerService=rh.get(uk)),this.pickerService}},{key:"reInit",value:function(){this.renderService.reInit(),this.pickerService.reInit()}}])}(jy),vS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gS=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},yS=function(){return o((function t(){r(this,t)}),[{key:"configure",value:function(t){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getNativeAABBBounds",value:function(t){return new On}},{key:"removeDom",value:function(t){return!1}},{key:"createDom",value:function(t){return null}},{key:"updateDom",value:function(t,e){return!1}},{key:"getDynamicCanvasCount",value:function(){return 999}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadBlob",value:function(t){return fetch(t).then((function(t){return t.blob()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"getElementTop",value:function(t,e){return 0}},{key:"getElementLeft",value:function(t,e){return 0}},{key:"getElementTopLeft",value:function(t,e){return{top:0,left:0}}},{key:"loadFont",value:function(t,e,i){return gS(this,void 0,void 0,f().m((function t(){return f().w((function(t){for(;;)if(0===t.n)return t.a(2,{loadState:"fail"})}),t)})))}},{key:"isMacOS",value:function(){return!1}},{key:"copyToClipBoard",value:function(t){return Promise.resolve(null)}}])}();yS=vS([Dc()],yS);var mS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},_S=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bS=function(){return o((function t(){r(this,t),this._uid=vc.GenAutoIncrementId(),this.viewBox=new On,this.modelMatrix=new Hn(1,0,0,1,0,0)}),[{key:"onChange",value:function(t){this._onChangeCb=t}},{key:"configure",value:function(t,e){e.env===this.type&&t.setWindowHandler(this)}},{key:"release",value:function(){this.releaseWindow()}},{key:"isVisible",value:function(t){return!0}},{key:"onVisibleChange",value:function(t){}},{key:"getTopLeft",value:function(t){return{top:0,left:0}}},{key:"setViewBox",value:function(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}},{key:"getViewBox",value:function(){return this.viewBox}},{key:"setViewBoxTransform",value:function(t,e,i,n,r,a){this.modelMatrix.setValue(t,e,i,n,r,a)}},{key:"getViewBoxTransform",value:function(){return this.modelMatrix}}])}();bS=mS([Dc(),_S("design:paramtypes",[])],bS);var xS=function(){return o((function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;r(this,t),this.dir=e,this.color=i,this.colorRgb=xy.Get(i,gy.Color1),this.ambient=n;var a=li(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);this.formatedDir=[e[0]/a,e[1]/a,e[2]/a]}),[{key:"computeColor",value:function(t,e){var i,n=this.formatedDir,r=oi(ai((t[0]*n[0]+t[1]*n[1]+t[2]*n[2])*(1-this.ambient/2),0)+this.ambient,1);i=q(e)?xy.Get(e,gy.Color1):e;var a=this.colorRgb;return"rgb(".concat(a[0]*i[0]*r,", ").concat(a[1]*i[1]*r,", ").concat(a[2]*i[2]*r,")")}}])}(),kS=function(){dS.registerPlugin("DirectionalLight",xS)},SS=function(){return o((function t(e){r(this,t),this.params=e}),[{key:"params",get:function(){return Object.assign({},this._params)},set:function(t){this._params=Object.assign({},t),this._projectionMatrixCached=this.forceGetProjectionMatrix(),this._viewMatrixCached=this.forceGetViewMatrix()}},{key:"getViewMatrix",value:function(){return this._viewMatrixCached||(this._viewMatrixCached=cy.allocate()),this._viewMatrixCached}},{key:"forceGetViewMatrix",value:function(){this._viewMatrixCached||(this._viewMatrixCached=cy.allocate());var t=this.params.viewParams,e=t.pos,i=t.center,n=t.up;return function(t,e,i,n){var r,a,o,s,l,u,c,h,d,p,f=e[0],v=e[1],g=e[2],y=n[0],m=n[1],_=n[2],b=i[0],x=i[1],k=i[2];Math.abs(f-b)<Je&&Math.abs(v-x)<Je&&Math.abs(g-k)<Je?iy(t):(c=f-b,h=v-x,d=g-k,r=m*(d*=p=1/Math.hypot(c,h,d))-_*(h*=p),a=_*(c*=p)-y*d,o=y*h-m*c,(p=Math.hypot(r,a,o))?(r*=p=1/p,a*=p,o*=p):(r=0,a=0,o=0),s=h*o-d*a,l=d*r-c*o,u=c*a-h*r,(p=Math.hypot(s,l,u))?(s*=p=1/p,l*=p,u*=p):(s=0,l=0,u=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=a,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=d,t[11]=0,t[12]=-(r*f+a*v+o*g),t[13]=-(s*f+l*v+u*g),t[14]=-(c*f+h*v+d*g),t[15]=1)}(this._viewMatrixCached,e,i,n),this._vp||(this._vp=cy.allocate()),this._vp=ay(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._viewMatrixCached}},{key:"getProjectionMatrix",value:function(){return this._projectionMatrixCached||(this._projectionMatrixCached=cy.allocate()),this._projectionMatrixCached}},{key:"forceGetProjectionMatrix",value:function(){this._projectionMatrixCached||(this._projectionMatrixCached=cy.allocate());var t=this._params,e=t.left,i=t.top,n=t.right,r=t.bottom;return function(t,e,i,n,r,a,o){var s=1/(e-i),l=1/(n-r),u=1/(a-o);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(o+a)*u,t[15]=1}(this._projectionMatrixCached,e,n,r,i,0,-2e6),this._vp||(this._vp=cy.allocate()),this._vp=ay(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._projectionMatrixCached}},{key:"getField",value:function(){var t=this._params,e=t.fieldRatio,i=void 0===e?.8:e,n=t.fieldDepth,r=t.left,a=t.right;return(null!=n?n:a-r)*i}},{key:"getProjectionScale",value:function(t){var e=this.getField();return e/(e+t)}},{key:"view",value:function(t,e,i){var n=[0,0,0];return oy(n,[t,e,i],this._viewMatrixCached),n}},{key:"vp",value:function(t,e,i){var n=[0,0,0],r=this._params.viewParams.pos;oy(n,[t,e,i],this._viewMatrixCached),t=n[0],e=n[1],i=n[2];var a=this.getProjectionScale(i);return{x:t*a+r[0],y:e*a+r[1]}}}])}(),AS=function(){dS.registerPlugin("OrthoCamera",SS)},CS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},MS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},wS=function(t,e){return function(i,n){e(i,n,t)}},TS=function(){return o((function t(e,i){r(this,t),this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.type="default",this.global=oh.global}),[{key:"reInit",value:function(){this._init()}},{key:"_init",value:function(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order})),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"pick",value:function(t,e,i){var n={graphic:null,group:null};i.pickerService=this;var r=i.bounds.width(),a=i.bounds.height();if(!(new On).setValue(0,0,r,a).containsPoint(e))return n;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);for(var o,s=new Hn(1,0,0,1,0,0),l=t.length-1;l>=0&&!(n=t[l].isContainer?this.pickGroup(t[l],e,s,i):this.pickItem(t[l],e,s,i)).graphic;l--)o||(o=n.group);if(n.graphic||(n.group=o),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(var u=0;u<this.pickerServiceInterceptorContributions.length;u++){var c=this.pickerServiceInterceptorContributions[u];c.afterPickItem&&(n=c.afterPickItem(n,this,e,i,{parentMatrix:s}))}return n}},{key:"containsPoint",value:function(t,e,i){var n;return!!(null===(n=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))||void 0===n?void 0:n.graphic)}},{key:"pickGroup",value:function(t,e,i,n){var r=this,a={group:null,graphic:null};if(!1===t.attribute.visibleAll)return a;var o=n.pickContext,s=o.modelMatrix;if(o.camera){var l=t.transMatrix,u=cy.allocate();if(ry(u,l),s){if(u){var c=cy.allocate();o.modelMatrix=ay(c,s,u),cy.free(u)}}else ry(u,t.globalTransMatrix),o.modelMatrix=u}if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.beforePickItem){var p=d.beforePickItem(t,this,e,n,{parentMatrix:i});if(p)return o.modelMatrix!==s&&cy.free(o.modelMatrix),o.modelMatrix=s,p}}var f=t.transMatrix,v=uy.allocateByObj(i),g=new ki(e.x,e.y);v.transformPoint(g,g);var y=t.AABBBounds.containsPoint(g);if(!y&&!t.stage.camera)return a;var m=this.pickItem(t,g.clone(),i,n);m&&m.graphic&&(a.graphic=m.graphic,a.params=m.params);var _=!1!==t.attribute.pickable&&y;return v.multiply(f.a,f.b,f.c,f.d,f.e,f.f),!1===t.attribute.childrenPickable||m&&m.graphic||Ik(t,Fd.zIndex,(function(o){if(o.isContainer){var s=new ki(e.x,e.y),l=vf(t).group,u=t.attribute,c=u.scrollX,h=void 0===c?l.scrollX:c,d=u.scrollY,p=void 0===d?l.scrollY:d;s.x-=h,s.y-=p,a=r.pickGroup(o,s,v,n)}else{var f=new ki(e.x,e.y);v.transformPoint(f,f);var g=vf(t).group,y=t.attribute,m=y.scrollX,_=void 0===m?g.scrollX:m,b=y.scrollY,x=void 0===b?g.scrollY:b;f.x-=_,f.y-=x;var k=r.pickItem(o,f,i,n);k&&k.graphic&&(a.graphic=k.graphic,a.params=k.params)}return!!a.graphic||!!a.group}),!0,!!o.camera),o.modelMatrix!==s&&cy.free(o.modelMatrix),o.modelMatrix=s,a.graphic||a.group||!_||t.stage.camera||(a.group=t),uy.free(v),a}},{key:"selectPicker",value:function(t){return this.pickerMap.get(t.numberType)||null}}])}();function DS(t,e,i,n,r,a){var o=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-o)*r+o,c=(l-s)*r+s,h=(c-u)*r+u;a[0]=t,a[1]=o,a[2]=u,a[3]=h,a[4]=h,a[5]=c,a[6]=l,a[7]=n}function ES(t,e){var i=t.length,n=e.length;if(i===n)return[t,e];for(var r=[],a=[],o=i<n?t:e,s=Math.min(i,n),l=Math.abs(n-i)/6,u=(s-2)/6,c=Math.ceil(l/u),h=[o[0],o[1]],d=l,p=2;p<s;p+=6){var f=o[p-2],v=o[p-1],g=o[p],y=o[p+1],m=o[p+2],_=o[p+3],b=o[p+4],x=o[p+5];if(d<=0)h.push(g,y,m,_,b,x);else{for(var k=Math.min(d,c)+1,S=1;S<=k;S++){var A=S/k;DS(f,g,m,b,A,r),DS(v,y,_,x,A,a),f=r[3],v=a[3],h.push(r[1],a[1],r[2],a[2],f,v),g=r[5],y=a[5],m=r[6],_=a[6]}d-=k-1}}return o===t?[h,e]:[t,h]}function BS(t,e){for(var i=t||e,n=i.length,r=i[n-2],a=i[n-1],o=[],s=0;s<e.length;s+=2)o[s]=r,o[s+1]=a;return o}function PS(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[n]=t[i-n-2],e[n+1]=t[i-n-1];return e}function RS(t){for(var e=0,i=0,n=0,r=t.length,a=0,o=r-2;a<r;o=a,a+=2){var s=t[o],l=t[o+1],u=t[a],c=t[a+1],h=s*c-u*l;e+=h,i+=(s+u)*h,n+=(l+c)*h}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,n/e/3,e]}function LS(t,e,i,n){for(var r=(t.length-2)/6,a=1/0,o=0,s=t.length,l=s-2,u=0;u<r;u++){for(var c=6*u,h=0,d=0;d<s;d+=2){var p=0===d?c:(c+d-2)%l+2,f=t[p]-i[0],v=t[p+1]-i[1],g=e[d]-n[0]-f,y=e[d+1]-n[1]-v;h+=g*g+y*y}h<a&&(a=h,o=u)}return o}function IS(t){var e=new Md,i=t.toString();if(!i)return[];e.fromString(i);var n=e.tryBuildCurves();if(!n||0===n.length)return[];var r=[],a=null;a=[];for(var o=0,s=0,l=0,u=0,c=!0,h=0;h<n.length;h++){var d=n[h];if(c&&(l=o=d.p0.x,u=s=d.p0.y,a=[o,s],r.push(a),c=!1),d.p1&&d.p2&&d.p3)a.push(d.p1.x,d.p1.y,d.p2.x,d.p2.y,d.p3.x,d.p3.y),l=d.p3.x,u=d.p3.y;else if(d.p1&&d.p2){var p=d.p1.x,f=d.p1.y,v=d.p2.x,g=d.p2.y;a.push(l+2/3*(p-l),u+2/3*(f-u),v+2/3*(p-v),g+2/3*(f-g),v,g),l=v,u=g}else if(d.p1){var y=d.p1.x,m=d.p1.y;Math.abs(l-y)<1e-10&&Math.abs(u-m)<1e-10||a.push(l,u,y,m,y,m),l=y,u=m}if(h===n.length-1&&Math.abs(l-o)<1e-10&&Math.abs(u-s),h<n.length-1){var _=n[h+1];(Math.abs(l-_.p0.x)>1e-10||Math.abs(u-_.p0.y)>1e-10)&&(c=!0)}}var b=r.filter((function(t){return t.length>2}));return 1===b.length?[b[0]]:b}function FS(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],s={x:a,y:o};e.transformPoint({x:a,y:o},s),n[r]=s.x,n[r+1]=s.y}}function OS(t){for(var e=new Md,i=0;i<t.length;i++){var n=t[i];if(n.length>2){e.moveTo(n[0],n[1]);for(var r=2;r<n.length;r+=6)e.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5])}}return e}function zS(t,e,i){var n,r,a=t/e;t>=e?(r=Math.ceil(Math.sqrt(i*a)),0===(n=Math.floor(i/r))&&(n=1,r=i)):(n=Math.ceil(Math.sqrt(i/a)),0===(r=Math.floor(i/n))&&(r=1,n=i));for(var o=[],s=0;s<n;s++)o.push(r);var l=i-n*r;if(l>0)for(var u=0;u<l;u+=r)u+r<l?o.push(r):o.push(l-u);return o}TS=CS([Dc(),wS(0,wc(Yc)),wS(0,Ec(hk)),wS(1,wc(Yc)),wS(1,Ec(dk)),MS("design:paramtypes",[Object,Object])],TS);var HS=function(t,e){var i=t.filter((function(t){return!1!==t.defined&&$(t.x)&&$(t.y)}));if(0===i.length)return[];if(1===i.length)return new Array(e).fill(0).map((function(t){return i[0]}));var n=[];if(e<=i.length){for(var r=i.length/e,a=0,o=0;a<e;)n.push(i[Math.floor(o)]),o+=r,a++;return n}for(var s=e-i.length,l=1/(s/(i.length-1)+1),u=0,c=0,h=t.length;c<h;c++)if(n.push(t[c]),c<h-1)for(var d=l,p=t[c].x,f=t[c].y,v=t[c+1].x,g=t[c+1].y;d<1&&u<s;)n.push({x:p+(v-p)*d,y:f+(g-f)*d}),d+=l,u+=1;return n};function NS(t,e){return t[0]*e[1]-t[1]*e[0]}var US=function(t){return t.map((function(t){return{x:t.x,y:t.y}}))},jS=function(t,e,i){for(var n,r=t.length,a=[],o=0;o<r;o++){var s=t[o],l=o===r-1?t[0]:t[o+1],u=Ui([e.x,e.y],[i.x,i.y],[s.x,s.y],[l.x,l.y]);u&&"boolean"!=typeof u&&a.push({dot:NS([u[0]-e.x,u[1]-e.x],[i.x-e.x,i.y-e.x]),point:{x:u[0],y:u[1]},edgeIndex:o})}if(a.length<2)return[US(t),US(t)];a.sort((function(t,e){return t.dot-e.dot}));var c=a[0],h=a[a.length-1];c.edgeIndex>h.edgeIndex&&(c=(n=[h,c])[0],h=n[1]);for(var d=c.point,p=h.point,f=[{x:d.x,y:d.y}],v=c.edgeIndex+1;v<=h.edgeIndex;v++)f.push({x:t[v].x,y:t[v].y});f.push({x:p.x,y:p.y});for(var g=[{x:p.x,y:p.y}],y=h.edgeIndex+1,m=c.edgeIndex+r;y<=m;y++){var _=t[y%r];g.push({x:_.x,y:_.y})}return g.push({x:d.x,y:d.y}),[f,g]},VS=function(t,e,i){if(1===e)i.push({points:t});else{var n=Math.floor(e/2),r=function(t){var e=new Fn;t.forEach((function(t){e.add(t.x,t.y)}));var i=e.width(),n=e.height();if(i>=n){var r=e.x1+i/2;return jS(t,{x:r,y:e.y1},{x:r,y:e.y2})}var a=e.y1+n/2;return jS(t,{x:e.x1,y:a},{x:e.x2,y:a})}(t);VS(r[0],n,i),VS(r[1],e-n,i)}},WS=!1,GS=new gc((function(t){WS||(WS=!0,t(Ab).toSelf().inSingletonScope(),t(Dx).to(Ab).inSingletonScope(),t(Rx).toService(Dx),t(hm).toService(z_),Kc(t,hm))})),YS=!1,XS=new gc((function(t){YS||(YS=!0,t(Zb).toSelf().inSingletonScope(),t(zx).to(Zb).inSingletonScope(),t(Rx).toService(zx),t(ab).toSelf(),t(rb).toSelf(),t(mm).toService(ab),t(mm).toService(rb),t(mm).toService(z_),Kc(t,mm))})),KS=!1,qS=new gc((function(t){KS||(KS=!0,t(Rb).toSelf().inSingletonScope(),t(Vk).toSelf().inSingletonScope(),t(Ix).to(Rb).inSingletonScope(),t(Rx).toService(Ix))})),ZS=!1,JS=new gc((function(t){ZS||(ZS=!0,t(Nb).toSelf().inSingletonScope(),t(Bx).to(Nb).inSingletonScope(),t(Rx).toService(Bx),t(dm).toService(z_),Kc(t,dm),t(Gk).toSelf().inSingletonScope())})),QS=!1,$S=new gc((function(t){QS||(QS=!0,t(tx).toSelf().inSingletonScope(),t(Nx).to(tx).inSingletonScope(),t(Rx).toService(Nx),t(_m).toService(z_),Kc(t,_m))})),tA=!1,eA=new gc((function(t){tA||(tA=!0,t(Tb).toSelf().inSingletonScope(),t(Px).to(Tb).inSingletonScope(),t(Rx).toService(Px),t(pm).toService(z_),Kc(t,pm))})),iA=!1,nA=new gc((function(t){iA||(iA=!0,t(Ux).to(lx).inSingletonScope(),t(Rx).toService(Ux),t(bm).toService(z_),Kc(t,bm))})),rA=!1,aA=new gc((function(t){rA||(rA=!0,t(Yb).toSelf().inSingletonScope(),t(Fx).to(Yb).inSingletonScope(),t(Rx).toService(Fx),t(gm).toService(z_),Kc(t,gm))})),oA=!1,sA=new gc((function(t){oA||(oA=!0,t(Ox).to(yx).inSingletonScope(),t(Rx).toService(Ox),t(ym).toService(z_),Kc(t,ym))})),lA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},uA=function(){return o((function t(){r(this,t),this.numberType=Hg}),[{key:"reInit",value:function(){}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){r.drawContribution&&t.getSubGraphic().forEach((function(t){var l=r.drawContribution.getRenderContribution(t);l&&l.drawShape&&l.drawShape(t,e,i,n,r,a,o,s)}))}},{key:"draw",value:function(t,e,i,n){var r=i.context;if(r&&(r.highPerformanceSave(),i.drawContribution)){var a=vf(t),o=t.getSubGraphic();o.length&&o.forEach((function(t){i.drawContribution.renderItem(t,i,{theme:a})})),r.highPerformanceRestore()}}}])}();uA=lA([Dc()],uA);var cA=!1,hA=new gc((function(t){cA||(cA=!0,t(Wx).to(uA).inSingletonScope(),t(Rx).toService(Wx))})),dA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},pA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},fA=function(t){function e(){var t;return r(this,e),(t=n(this,e)).numberType=Kg,t.builtinContributions=[rx],t.init(),t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r){var a=vf(t).richtext,o=t.attribute,s=o.strokeOpacity,l=void 0===s?a.strokeOpacity:s,u=o.opacity,c=void 0===u?a.opacity:u,h=o.fillOpacity,d=void 0===h?a.fillOpacity:h,p=o.visible,f=void 0===p?a.visible:p;if(t.valid&&f){var v=rm(c,d,!0),g=rm(c,l,!0);v&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,a),e.translate(i,n),this.beforeRenderStep(t,e,i,n,v,g,v,g,a,r),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,n,v,g,v,g,a,r))}}},{key:"drawIcon",value:function(t,e,i,n,r){var a,o=vf(t).richtextIcon,s=t.attribute,l=s.width,u=void 0===l?o.width:l,c=s.height,h=void 0===c?o.height:c,d=s.opacity,p=void 0===d?o.opacity:d,f=s.image,v=s.backgroundFill,g=void 0===v?o.backgroundFill:v,y=s.backgroundFillOpacity,m=void 0===y?o.backgroundFillOpacity:y,_=s.backgroundStroke,b=void 0===_?o.backgroundStroke:_,x=s.backgroundStrokeOpacity,k=void 0===x?o.backgroundStrokeOpacity:x,S=s.backgroundRadius,A=void 0===S?o.backgroundRadius:S,C=s.margin,M=t.attribute,w=M.backgroundWidth,T=void 0===w?u:w,D=M.backgroundHeight,E=void 0===D?h:D;if(C&&(i+=t._marginArray[3],n+=t._marginArray[0]),t._hovered){var B=(T-u)/2,P=(E-h)/2;0===A?(e.beginPath(),e.rect(i-B,n-P,T,E)):(e.beginPath(),eb(e,i-B,n-P,T,E,A,!0)),g&&(e.globalAlpha=m,e.fillStyle=g,e.fill()),b&&(e.globalAlpha=k,e.strokeStyle=b,e.stroke())}var R=f&&(null===(a=null==t?void 0:t.resources)||void 0===a?void 0:a.get(f));R&&"success"===R.state&&(e.globalAlpha=p,e.drawImage(R.data,i,n,u,h))}},{key:"draw",value:function(t,e,i){var n=vf(t).richtext;this._draw(t,n,!1,i)}}])}(bb);fA=dA([Dc(),pA("design:paramtypes",[])],fA);var vA=!1,gA=new gc((function(t){vA||(vA=!0,t(jx).to(fA).inSingletonScope(),t(Rx).toService(jx))})),yA=!1,mA=new gc((function(t){yA||(yA=!0,t(Gx).to(Mx).inSingletonScope(),t(Rx).toService(Gx),t(vm).toService(z_),Kc(t,vm))})),_A=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"stroke",value:function(t,e,i,n,r){var a=n.vertices;n.edges.forEach((function(n){var o=a[n[0]],s={x:t+o[0],y:e+o[1],z:i+o[2]},l=a[n[1]],u={x:t+l[0],y:e+l[1],z:i+l[2]};r.beginPath(),r.moveTo(s.x,s.y,s.z),r.lineTo(u.x,u.y,u.z),r.stroke()}))}},{key:"fill",value:function(t,e,i,n,r,a,o,s,l,u,c){var h=xy.Get(a,gy.Color255),d=n.vertices,p=d.map((function(t){return o.view(t[0],t[1],t[2])[2]})),f=[];n.polygons.forEach((function(t,e){if(!r||r[e]){f.push({faceIdx:e,polygon:t});var i=t.polygon,n=p[i[0]],a=p[i[1]],o=p[i[2]],s=p[i[3]];t.ave_z=n+a+o+s}})),f.sort((function(t,e){return e.polygon.ave_z-t.polygon.ave_z})),f.forEach((function(n){var r=n.polygon,p=r.polygon,f=r.normal,v=d[p[0]],g=d[p[1]],y=d[p[2]],m=d[p[3]],_={x:t+v[0],y:e+v[1],z:i+v[2]},b={x:t+g[0],y:e+g[1],z:i+g[2]},x={x:t+y[0],y:e+y[1],z:i+y[2]},k={x:t+m[0],y:e+m[1],z:i+m[2]};o.beginPath(),o.moveTo(_.x,_.y,_.z),o.lineTo(b.x,b.y,b.z),o.lineTo(x.x,x.y,x.z),o.lineTo(k.x,k.y,k.z),o.closePath(),c?c(o,l&&l.attribute,u):(o.fillStyle=s?s.computeColor(f,h):a,o.fill())}))}}])}(bb),bA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},xA=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="rect3d",t.numberType=Xg,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c=vf(t,null==a?void 0:a.theme).rect,h=t.attribute,d=h.fill,p=void 0===d?c.fill:d,f=h.stroke,v=void 0===f?c.stroke:f,g=h.x1,y=h.y1,m=h.x,_=h.y,b=h.opacity,x=void 0===b?c.opacity:b,k=h.fillOpacity,S=void 0===k?c.fillOpacity:k,A=h.lineWidth,C=void 0===A?c.lineWidth:A,M=h.strokeOpacity,w=void 0===M?c.strokeOpacity:M,T=h.visible,D=void 0===T?c.visible:T,E=h.drawStrokeWhenZeroWH,B=void 0===E?null!==(l=c.drawStrokeWhenZeroWH)&&void 0!==l&&l:E,P=t.attribute,R=P.width,L=P.height;R=(null!=R?R:g-m)||0,L=(null!=L?L:y-_)||0;var I=null!==(u=this.z)&&void 0!==u?u:0,F=am(x,S,R,L,p),O=sm(x,w,R,L,B),z=im(p),H=nm(v,C);if(t.valid&&D&&(z||H)&&(F||O||o||s)){var N=(r.stage||{}).light,U=t.findFace();if(!1!==p){e.setCommonStyle(t,t.attribute,i,n,c);var j=p;"string"!=typeof j&&(j="black"),this.fill(i,n,I,U,null,j,e,N,null,null,o)}!1!==v&&(e.setStrokeStyle(t,t.attribute,i,n,c),this.stroke(i,n,I,U,e))}}},{key:"draw",value:function(t,e,i){var n=vf(t).rect;this._draw(t,n,!1,i)}}])}(_A);xA=bA([Dc()],xA);var kA=!1,SA=new gc((function(t){kA||(kA=!0,t(Hx).to(xA).inSingletonScope(),t(Rx).toService(Hx))})),AA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};var CA=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=Fg,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=vf(t,null==a?void 0:a.theme).arc,c=t.attribute.fill,h=void 0===c?u.fill:c,d=this.valid(t,u,o,s);if(d){var p=d.fVisible,f=d.sVisible,v=d.doFill,g=d.doStroke,y=null!==(l=this.z)&&void 0!==l?l:0,m=t.attribute,_=m.outerPadding,b=void 0===_?u.outerPadding:_,x=m.innerPadding,k=void 0===x?u.innerPadding:x,S=m.height,A=void 0===S?10:S,C=t.attribute,M=C.outerRadius,w=void 0===M?u.outerRadius:M,T=C.innerRadius,D=void 0===T?u.innerRadius:T;w+=b,D-=k;var E=xy.Get(h,gy.Color255),B=(r.stage||{}).light,P=r.hack_pieFace,R={top:y,bottom:y+A},L={top:[0,1,0],bottom:[0,-1,0],outside:[1,0,-1],inside:[1,0,-1]};"bottom"===P||"top"===P?(e.beginPath(),function(t,e,i,n,r,a,o){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=ii(u-l),h=u>l,d=!1;if(a<o){var p=a;a=o,o=p}if(a<=Je)e.moveTo(i,n,r);else if(c>=ei-Je)e.moveTo(i+a*ri(l),n+a*si(l),r),e.arc(i,n,a,l,u,!h,r),o>Je&&(e.moveTo(i+o*ri(u),n+o*si(u),r),e.arc(i,n,o,u,l,h,r));else{var f=t.getParsePadAngle(l,u),v=f.outerDeltaAngle,g=f.innerDeltaAngle,y=f.outerStartAngle,m=f.outerEndAngle,_=f.innerEndAngle,b=f.innerStartAngle,x=a*ri(y),k=a*si(y),S=o*ri(_),A=o*si(_);v<.001?d=!0:(e.moveTo(i+x,n+k,r),e.arc(i,n,a,y,m,!h,r)),!(o>Je)||g<.001?(e.lineTo(i+S,n+A,r),d=!0):(e.lineTo(i+S,n+A,r),e.arc(i,n,o,_,b,h,r))}e.closePath()}(t,e,i,n,R[P],w,D),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),v&&(o?o(e,t.attribute,u):p&&(e.setCommonStyle(t,t.attribute,i,n,u),e.fillStyle=B?B.computeColor(L[P],E):h,e.fill())),g&&(s?s(e,t.attribute,u):f&&(e.setStrokeStyle(t,t.attribute,i,n,u),e.stroke()))):"outside"!==P&&"inside"!==P||("inside"===P&&(e.save(),e.beginPath(),e.arc(i,n,D,0,ei,!0,R.top),e.clip()),e.beginPath(),function(t,e,i,n,r,a,o,s){var l=t.getParsedAngle(),u=l.startAngle,c=l.endAngle,h=ii(c-u),d=c>u,p=!1;if(o<=Je)e.moveTo(i,n,r);else if(h>=ei-Je)e.moveTo(i+o*ri(u),n+o*si(u),r),e.arc(i,n,o,u,c,!d,r),e.lineTo(i+o*ri(c),n+o*si(c),a),e.arc(i,n,o,c,u,d,a);else{var f=s(u,c),v=f.innerouterDeltaAngle,g=f.innerouterStartAngle,y=f.innerouterEndAngle,m=o*ri(g),_=o*si(g),b=o*ri(y),x=o*si(y);v<.001?p=!0:(e.moveTo(i+m,n+_,r),e.arc(i,n,o,g,y,!d,r),e.lineTo(i+b,n+x,a),e.arc(i,n,o,y,g,d,a))}e.closePath()}(t,e,i,n,R.top,R.bottom,"outside"===P?w:D,(function(e,i){var n=t.getParsePadAngle(e,i),r=n.outerDeltaAngle,a=n.innerDeltaAngle,o=n.outerStartAngle,s=n.outerEndAngle,l=n.innerEndAngle,u=n.innerStartAngle;return"outside"===P?{innerouterDeltaAngle:r,innerouterEndAngle:s,innerouterStartAngle:o}:{innerouterDeltaAngle:a,innerouterEndAngle:l,innerouterStartAngle:u}})),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),v&&(o?o(e,t.attribute,u):p&&(e.setCommonStyle(t,t.attribute,i,n,u),e.fillStyle=B?B.computeColor(L[P],E):h,e.fill())),g&&(s?s(e,t.attribute,u):f&&(e.setStrokeStyle(t,t.attribute,i,n,u),e.stroke())),"inside"===P&&e.restore())}}},{key:"draw",value:function(t,e,i,n){var r=vf(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n)}}])}(bb);CA=AA([Dc()],CA);var MA=!1,wA=new gc((function(t){MA||(MA=!0,t(Ex).to(CA).inSingletonScope(),t(Rx).toService(Ex))})),TA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},DA=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="pyramid3d",t.numberType=Gg,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=vf(t,null==a?void 0:a.theme).polygon,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.stroke,f=void 0===p?u.stroke:p,v=c.face,g=void 0===v?[!0,!0,!0,!0,!0,!0]:v,y=null!==(l=this.z)&&void 0!==l?l:0;if(this.valid(t,u,o,s)){var m=(r.stage||{}).light,_=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,n,u);var b=d;"string"!=typeof b&&(b="black"),this.fill(i,n,y,_,g,b,e,m,t,u,o)}!1!==f&&(e.setStrokeStyle(t,t.attribute,i,n,u),this.stroke(i,n,y,_,e))}}},{key:"draw",value:function(t,e,i){var n=vf(t).polygon;this._draw(t,n,!1,i)}}])}(_A);DA=TA([Dc()],DA);var EA=!1,BA=new gc((function(t){EA||(EA=!0,t(Vx).to(DA).inSingletonScope(),t(Rx).toService(Vx))}));var PA=function(){return o((function t(){var e=this;r(this,t),this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=function(t){try{var i=new t.constructor(t.type,t);e.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(i)}catch(t){return}}}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(i){i&&i===e.pluginService.stage&&e.drawHTML(b(t.stage.getChildren()))}))}},{key:"deactivate",value:function(t){var e=this;t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),this.release()}},{key:"getWrapContainer",value:function(t,e,i){var n;return n=e?"string"==typeof e?oh.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:oh.global.createDom(Object.assign({tagName:"div",parent:n},i)),nativeContainer:n}}},{key:"parseDefaultStyleFromGraphic",value:function(t){return function(t){var e={},i=function(t){return/^\d+(\.\d+)?$/.test("".concat(t))?"".concat(t,"px"):"".concat(t)};return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach((function(i){t[i]&&(e[va(i)]=t[i])})),["fontSize","lineHeight"].forEach((function(n){var r=va(n);j(t[n])||(e[r]=i(t[n]))})),W(t.maxLineWidth)&&(e["max-width"]=i(t.maxLineWidth)),t.underline?e["text-decoration"]="underline":t.lineThrough&&(e["text-decoration"]="line-through"),t.fill&&q(t.fill)&&(e.color=t.fill),e}("text"===t.type&&t.attribute?t.attribute:vf(t).text)}},{key:"getTransformOfText",value:function(t){var e=vf(t).text,i=t.attribute,n=i.textAlign,r=void 0===n?e.textAlign:n,a=i.textBaseline,o=void 0===a?e.textBaseline:a,s=t.globalTransMatrix.toTransformAttrs(),l=s.rotateDeg,u=s.scaleX,c=s.scaleY,h={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},d={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:r,transform:"translate(".concat(h[r],",").concat(h[o],") rotate(").concat(l,"deg) scaleX(").concat(u,") scaleY(").concat(c,")"),transformOrigin:"".concat(d[r]," ").concat(d[o])}}},{key:"updateStyleOfWrapContainer",value:function(t,e,i,n,r){var a=this,o=r.pointerEvents,s=r.penetrateEventList,l=void 0===s?[]:s,u=this.parseDefaultStyleFromGraphic(t);u.display=!1!==t.attribute.visible?"block":"none",u.pointerEvents=!0===o?"all":o||"none","none"!==u.pointerEvents&&(this.removeWrapContainerEventListener(i),l.forEach((function(t){"wheel"===t&&i.addEventListener("wheel",a.onWheel)}))),i.style.position||(i.style.position="absolute",n.style.position="relative");var c=0,h=0,d=t.globalAABBBounds,p=r.anchorType;if(j(p)&&(p="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===p&&(p="top-left"),"position"===p||d.empty()){var f=t.globalTransMatrix;c=f.e,h=f.f}else{var v=Pn(d,p);c=v.x,h=v.y}var g=oh.global.getElementTopLeft(n,!1),y=e.window.getTopLeft(!1),m=e.viewBox,_=c+y.left-g.left+m.x1,b=h+y.top-g.top+m.y1;if(u.left="".concat(_,"px"),u.top="".concat(b,"px"),"text"===t.type&&"position"===p&&(u=Object.assign(Object.assign({},u),this.getTransformOfText(t))),U(r.style)){var x=r.style({top:b,left:_,width:d.width(),height:d.height()},t,i);x&&(u=Object.assign(Object.assign({},u),x))}else G(r.style)?u=Object.assign(Object.assign({},u),r.style):q(r.style)&&r.style&&(u=Object.assign(Object.assign({},u),fa(r.style)));oh.global.updateDom(i,{width:r.width,height:r.height,style:u})}},{key:"clearCacheContainer",value:function(){var t=this;this.htmlMap&&Object.keys(this.htmlMap).forEach((function(e){t.htmlMap[e]&&t.htmlMap[e].renderId!==t.renderId&&t.removeElement(e)})),this.renderId+=1}},{key:"drawHTML",value:function(t){var e=this;"browser"===oh.global.env&&(t.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Fd.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Fd.zIndex)})).forEach((function(t){e.renderGroupHTML(t)})),this.clearCacheContainer())}},{key:"renderGroupHTML",value:function(t){var e=this;this.renderGraphicHTML(t),t.forEachChildren((function(t){t.isContainer?e.renderGroupHTML(t):e.renderGraphicHTML(t)}))}},{key:"removeElement",value:function(t){if(this.htmlMap&&this.htmlMap[t]){var e=this.htmlMap[t].wrapContainer;e&&oh.global.removeDom(e),this.htmlMap[t]=null}}},{key:"removeWrapContainerEventListener",value:function(t){t.removeEventListener("wheel",this.onWheel)}},{key:"renderGraphicHTML",value:function(t){var e,i=t.attribute.html;if(i){var n=t.stage;if(n){var r=i.dom,a=i.container;if(r){var o=j(i.id)?"".concat(null!==(e=t.id)&&void 0!==e?e:t._uid,"_react"):i.id;if(this.htmlMap&&this.htmlMap[o]&&a&&a!==this.htmlMap[o].container&&this.removeElement(o),this.htmlMap&&this.htmlMap[o])"string"==typeof r?this.htmlMap[o].wrapContainer.innerHTML=r:r!==this.htmlMap[o].wrapContainer.firstChild&&(this.htmlMap[o].wrapContainer.removeChild(this.htmlMap[o].wrapContainer.firstChild),this.htmlMap[o].wrapContainer.appendChild(r));else{var s=this.getWrapContainer(n,a),l=s.wrapContainer,u=s.nativeContainer;l&&("string"==typeof r?l.innerHTML=r:l.appendChild(r),this.htmlMap||(this.htmlMap={}),this.htmlMap[o]={wrapContainer:l,nativeContainer:u,container:a,renderId:this.renderId})}if(this.htmlMap&&this.htmlMap[o]){var c=this.htmlMap[o],h=c.wrapContainer,d=c.nativeContainer;this.updateStyleOfWrapContainer(t,n,h,d,i),this.htmlMap[o].renderId=this.renderId}}}}}},{key:"release",value:function(){"browser"===oh.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}},{key:"removeAllDom",value:function(t){var e=this;this.htmlMap&&(Object.keys(this.htmlMap).forEach((function(t){e.removeElement(t)})),this.htmlMap=null)}}])}(),RA=function(){dS.registerPlugin("HtmlAttributePlugin",PA)},LA=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="ReactAttributePlugin",t.activeEvent="onRegister",t._uid=vc.GenAutoIncrementId(),t.key=t.name+t._uid,t.htmlMap={},t}return h(e,t),o(e,[{key:"removeElement",value:function(t){if(this.htmlMap&&this.htmlMap[t]){var e=this.htmlMap[t],i=e.root,n=e.wrapContainer,r=e.unmount;i?oh.global.getRequestAnimationFrame()((function(){i.unmount()})):r&&r(),n&&oh.global.removeDom(n),this.htmlMap[t]=null}}},{key:"renderGraphicHTML",value:function(t){var e,i=t.attribute.react;if(i){var n=t.stage;if(n){var r=n.params.ReactDOM,a=i.element,o=i.container;if(a&&r&&(r.createRoot||r.render)){var s=j(i.id)?"".concat(null!==(e=t.id)&&void 0!==e?e:t._uid,"_react"):i.id;if(this.htmlMap&&this.htmlMap[s]&&o&&o!==this.htmlMap[s].container&&this.removeElement(s),this.htmlMap&&this.htmlMap[s])r.createRoot?this.htmlMap[s].root.render(a):r.render(a,this.htmlMap[s].wrapContainer);else{var l=this.getWrapContainer(n,o),u=l.wrapContainer,c=l.nativeContainer;if(u)if(this.htmlMap||(this.htmlMap={}),r.createRoot){var h=r.createRoot(u);h.render(a),this.htmlMap[s]={root:h,wrapContainer:u,nativeContainer:c,container:o,renderId:this.renderId}}else r.render(a,u),this.htmlMap[s]={wrapContainer:u,nativeContainer:c,container:o,renderId:this.renderId,unmount:function(){r.unmountComponentAtNode(u)}}}if(this.htmlMap&&this.htmlMap[s]){var d=this.htmlMap[s],p=d.wrapContainer,f=d.nativeContainer;this.updateStyleOfWrapContainer(t,n,p,f,i),this.htmlMap[s].renderId=this.renderId}}}}}}])}(PA),IA=function(){dS.registerPlugin("ReactAttributePlugin",LA)},FA=function(){return o((function t(){var e=this;r(this,t),this.name="ViewTransform3dPlugin",this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid,this.onMouseDown=function(t){e.option3d||(e.option3d=e.pluginService.stage.option3d),e.option3d&&(e.mousedown=!0,e.pageX=t.page.x,e.pageY=t.page.y)},this.onMouseUp=function(t){e.option3d||(e.option3d=e.pluginService.stage.option3d),e.option3d&&(e.mousedown=!1)},this.onMouseMove=function(t){var i,n,r=e.pluginService.stage;if(e.option3d||(e.option3d=r.option3d),e.option3d&&e.mousedown)if(e.pageX&&e.pageY){var a=t.page.x-e.pageX,o=t.page.y-e.pageY;e.pageX=t.page.x,e.pageY=t.page.y;var s=a/100,l=o/100;e.option3d.alpha=(null!==(i=e.option3d.alpha)&&void 0!==i?i:0)+s,e.option3d.beta=(null!==(n=e.option3d.beta)&&void 0!==n?n:0)+l,r.set3dOptions(e.option3d),r.renderNextFrame()}else e.pageX=t.page.x,e.pageY=t.page.y}}),[{key:"activate",value:function(t){this.pluginService=t;var e=t.stage;this.option3d=e.option3d,e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousemove",this.onMouseMove)}},{key:"deactivate",value:function(t){var e=t.stage;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("mousemove",this.onMouseMove)}}])}();function OA(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];0!==i&&n[0]===e[e.length-1]||e.push(n[0]),e.push(n[1])}return e}function zA(t,e,i){var n=t.indexOf(e),r=t.indexOf(i);n>=0&&r>=0&&n<r&&(t.splice(n,1),t.splice(r,0,e))}var HA=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return(e=Wt.getInstance()).info.apply(e,P(["[VChart log]: ".concat(t)],B(i),!1))},NA=function(t,e){return U(jA.warnHandler)&&jA.warnHandler.call(null,t,e),e?Wt.getInstance().warn("[VChart warn]: ".concat(t),e):Wt.getInstance().warn("[VChart warn]: ".concat(t))},UA=function(t,e,i){if(!U(jA.errorHandler))throw new Error(t);jA.errorHandler.call(null,t,e)},jA={silent:!1,warnHandler:!1,errorHandler:!1},VA=hS(),WA=VA&&globalThis?globalThis.document:void 0;function GA(t){return("desktop-browser"===t||"mobile-browser"===t)&&VA}function YA(t){return XA(t)||"mobile-browser"===t}function XA(t){return t.includes("miniApp")||"lynx"===t||"wx"===t||"harmony"===t}var KA=0;function qA(){return KA>=9999999&&(KA=0),KA++}function ZA(t){return null!=t&&""!==t&&(!!$(t)||+t==+t)}function JA(t){return!(!t||0===t.length)&&(!j(t[0])&&!j(t[0].dataId)&&Z(t[0].fields))}var QA=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"],$A=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t]))._skipRenderAttributes=QA,(null==i?void 0:i.mode)&&(a.mode=i.mode,a.setMode(i.mode)),(null==i?void 0:i.skipDefault)&&(a.skipDefault=!0),a.setTheme({common:{strokeBoundsBuffer:0}}),a.attribute=t,a.onSetStage((function(){a.render(),a.bindEvents()})),a}return h(e,t),o(e,[{key:"setAttribute",value:function(t,e,i,n){var r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(l({},t,e),this.attribute,t,n);if(r)return this._setAttributes(r,i);X(this.attribute[t])&&X(e)&&!U(this.attribute[t])&&!U(e)?mt(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"setAttributes",value:function(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}},{key:"_setAttributes",value:function(t,e){var i=this,n=Object.keys(t);this._mergeAttributes(t,n),n.every((function(t){return i._skipRenderAttributes.includes(t)}))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"_mergeAttributes",value:function(t,e){j(e)&&(e=Object.keys(t));for(var i=0;i<e.length;i++){var n=e[i];!X(this.attribute[n])||U(this.attribute[n])||U(t[n])?this.attribute[n]=t[n]:mt(this.attribute[n],t[n])}}},{key:"bindEvents",value:function(){}},{key:"_getNodeId",value:function(t){var e;return"".concat(null!==(e=this.id)&&void 0!==e?e:this._uid,"-").concat(this.name,"-").concat(t)}},{key:"_dispatchEvent",value:function(t,e){var i,n=new kf(t,e);n.manager=null===(i=this.stage)||void 0===i?void 0:i.eventSystem.manager,this.dispatchEvent(n)}},{key:"eventPosToStagePos",value:function(t){var e,i,n={x:0,y:0},r=null!==(i=null===(e=this.stage)||void 0===e?void 0:e.eventPointTransform(t))&&void 0!==i?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(r,n),n}}])}(jy),tC=Symbol.for("MathPickerContribution"),eC=Symbol.for("MathArcPicker"),iC=Symbol.for("MathAreaPicker"),nC=Symbol.for("MathCirclePicker"),rC=Symbol.for("MathImagePicker"),aC=Symbol.for("MathLinePicker"),oC=Symbol.for("MathPathPicker"),sC=Symbol.for("MathRectPicker"),lC=Symbol.for("MathSymbolPicker"),uC=Symbol.for("MathTextPicker"),cC=Symbol.for("MathPolygonPicker"),hC=Symbol.for("MathGlyphPicker"),dC=Symbol.for("CanvasArcPicker"),pC=Symbol.for("CanvasArc3dPicker"),fC=Symbol.for("CanvasAreaPicker"),vC=Symbol.for("CanvasCirclePicker"),gC=Symbol.for("CanvasImagePicker"),yC=Symbol.for("CanvasLinePicker"),mC=Symbol.for("CanvasPathPicker"),_C=Symbol.for("CanvasRectPicker"),bC=Symbol.for("CanvasRect3dPicker"),xC=Symbol.for("CanvasSymbolPicker"),kC=Symbol.for("CanvasTextPicker"),SC=Symbol.for("CanvasPolygonPicker"),AC=Symbol.for("CanvasPyramid3dPicker"),CC=Symbol.for("CanvasRichTextPicker"),MC=Symbol.for("CanvasGlyphPicker"),wC=Symbol.for("CanvasGroupPicker"),TC=Symbol.for("CanvasPickerContribution"),DC=function(){return o((function t(e){var i=this;r(this,t),this.onPointerDown=function(t){var e=t.target,n=i.rootNode,r=e===n;if(e&&!r){var a,o=!1;function l(t){if(o||(t.type="dragstart",null==e||e.dispatchEvent(t),o=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;var i=(null==n?void 0:n.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,a!==i&&(a&&(t.type="dragleave",t.target=a,a.dispatchEvent(t)),i&&(t.type="dragenter",t.target=i,i.dispatchEvent(t)),(a=i)&&(t.type="dragover",t.target=a,a.dispatchEvent(t)))}}null==n||n.addEventListener("pointermove",l);var s=function(){o&&(a&&(t.type="drop",t.target=a,a.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),o=!1),null==n||n.removeEventListener("pointermove",l)};e.addEventListener("pointerup",s,{once:!0}),e.addEventListener("pointerupoutside",s,{once:!0})}},this.rootNode=e,this.initEvents()}),[{key:"initEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.addEventListener("pointerdown",this.onPointerDown)}},{key:"removeEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.removeEventListener("pointerdown",this.onPointerDown)}},{key:"release",value:function(){this.removeEvents(),this.rootNode=null}}])}(),EC=function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.abs(i)>Math.abs(n)?i>0?"right":"left":n>0?"down":"up"},BC=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.sqrt(i*i+n*n)},PC=function(t){function e(t){var a,o,s,l,u,c,h,d,p,f,v,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),(a=n(this,e)).cachedEvents=[],a.startPoints=[],a.processEvent={},a.throttleTimer=0,a.emitThrottles=[],a.lastTapTarget=null,a.onStart=function(t){a.startTime=Sf.now();var e=i(a),n=e.cachedEvents,r=e.startPoints;t&&n.push(t.clone()),r.length=n.length;for(var o=0;o<n.length;o++){var s=n[o],l={x:s.x,y:s.y};r[o]=l}if(1!==r.length)a.startDistance=BC(r[0],r[1]),a.center=function(t){var e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};for(var i=0,n=0,r=0;r<e;)i+=t[r].x,n+=t[r].y,r++;return{x:Math.round(i/e),y:Math.round(n/e)}}([r[0],r[1]]);else{var u=n[0];a.pressTimeout=setTimeout((function(){u.direction="none",u.deltaX=0,u.deltaY=0,u.points=r,a.triggerStartEvent("press",u),a.triggerEvent("press",u),a.eventType="press",a.direction="none",a.pressTimeout=null}),a.config.press.time)}},a.onMove=function(t){a.clearPressTimeout();var e=i(a),n=e.startPoints,r=e.cachedEvents;if(n.length){for(var o=t.clone(),s=o.x,l=o.y,u=o.pointerId,c=0,h=r.length;c<h;c++)if(u===r[c].pointerId){r[c]=o;break}var d={x:s,y:l},p=r.map((function(t){return{x:t.x,y:t.y}})),f=Sf.now();if(a.prevMoveTime=a.lastMoveTime,a.prevMovePoint=a.lastMovePoint,a.lastMoveTime=f,a.lastMovePoint=d,1===n.length){var v=n[0],g=s-v.x,y=l-v.y,m=a.direction||EC(v,d);a.direction=m;var _=a.getEventType(d);return o.direction=m,o.deltaX=g,o.deltaY=y,o.points=p,a.triggerStartEvent(_,o),void a.triggerEvent(_,o)}var b=i(a).startDistance,x=BC(p[0],p[1]);o.scale=x/b,o.center=a.center,o.points=p,a.triggerStartEvent("pinch",o),a.triggerEvent("pinch",o)}},a.onEnd=function(t){var e=t.clone(),n=i(a),r=n.cachedEvents,o=n.startPoints,s=r.map((function(t){return{x:t.x,y:t.y}}));if(e.points=s,a.triggerEndEvent(e),1===r.length){var l=Sf.now(),u=a.lastMoveTime;if(l-u<100){var c=u-(a.prevMoveTime||a.startTime);if(c>0){var h=a.prevMovePoint||o[0],d=a.lastMovePoint||o[0],p=BC(h,d),f=p/c;if(f>a.config.swipe.velocity&&p>a.config.swipe.threshold)return e.velocity=f,e.direction=EC(h,d),a.triggerEvent("swipe",e),a.cachedEvents=[],a.startPoints=[],void a.reset()}}l-a.startTime<a.config.press.time&&(l-a.lastTapTime<a.config.tap.interval&&t.target===a.lastTapTarget?a.tapCount++:a.tapCount=1,a.lastTapTime=l,a.lastTapTarget=t.target,1===a.tapCount?a.triggerEvent("tap",e):2===a.tapCount&&(a.triggerEvent("doubletap",e),a.tapCount=0))}for(var v=0,g=r.length;v<g;v++)if(r[v].pointerId===e.pointerId){r.splice(v,1),o.splice(v,1);break}a.reset(),r.length>0&&a.onStart()},a.element=t,a.tapCount=0,a.lastTapTime=0,a.config={press:{time:null!==(s=null===(o=null==g?void 0:g.press)||void 0===o?void 0:o.time)&&void 0!==s?s:251,threshold:null!==(u=null===(l=null==g?void 0:g.press)||void 0===l?void 0:l.threshold)&&void 0!==u?u:9},swipe:{threshold:null!==(h=null===(c=null==g?void 0:g.swipe)||void 0===c?void 0:c.threshold)&&void 0!==h?h:10,velocity:null!==(p=null===(d=null==g?void 0:g.swipe)||void 0===d?void 0:d.velocity)&&void 0!==p?p:.3},tap:{interval:null!==(v=null===(f=null==g?void 0:g.tap)||void 0===f?void 0:f.interval)&&void 0!==v?v:300}},a.initEvents(),a}return h(e,t),o(e,[{key:"initEvents",value:function(){var t=this.element;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}},{key:"removeEvents",value:function(){var t=this.element;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}},{key:"release",value:function(){this.removeEvents(),this.element=null}},{key:"getEventType",value:function(t){var e,i=this.eventType,n=this.startTime,r=this.startPoints;return"press"===i?i:(e=Sf.now()-n>this.config.press.time&&BC(r[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}},{key:"enable",value:function(t){this.processEvent[t]=!0}},{key:"isProcess",value:function(t){return this.processEvent[t]}},{key:"pushEvent",value:function(t,e){for(var i=this.emitThrottles,n={type:t,ev:e},r=0,a=i.length;r<a;r++)if(i[r].type===t)return void i.splice(r,1,n);i.push(n)}},{key:"clearPressTimeout",value:function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}},{key:"reset",value:function(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}},{key:"triggerEvent",value:function(t,e){var i=this;this.pushEvent(t,e);var n=this.throttleTimer,r=this.emitThrottles;n||(this.throttleTimer=oh.global.getRequestAnimationFrame()((function(){oh.global.getCancelAnimationFrame()(i.throttleTimer),i.throttleTimer=null;for(var t=0,e=r.length;t<e;t++){var n=r[t],a=n.type,o=n.ev;i.emitEvent(a,o)}i.emitThrottles.length=0})))}},{key:"triggerStartEvent",value:function(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent("".concat(t,"start"),e))}},{key:"triggerEndEvent",value:function(t){var e=this,i=this.processEvent;Object.keys(i).forEach((function(n){e.triggerEvent("".concat(n,"end"),t),"press"===n&&e.triggerEvent("".concat(n,"up"),t),delete i[n]}))}},{key:"emitEvent",value:function(t,e){if(this.element){var i=this.element._events["*"];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(var n=0,r=i.length;n<r&&!e.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,e,t);this.emit(t,e)}}}])}(z),RC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},LC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},IC=[0,0,0],FC=function(){return o((function t(e,i){r(this,t),this.fillAttributes=Object.assign(Object.assign({},Ed),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},Pd),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},Rd),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;var n=e.nativeCanvas.getContext("2d");if(!n)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=n,this.canvas=e,this.matrix=new Hn(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new Hn(1,0,0,1,0,0),this._clearMatrix=new Hn(1,0,0,1,0,0),this.baseGlobalAlpha=1}),[{key:"fillStyle",get:function(){return this.nativeContext.fillStyle},set:function(t){this.nativeContext.fillStyle=t}},{key:"font",get:function(){var t;return null!==(t=this._font)&&void 0!==t?t:this.nativeContext.font},set:function(t){t!==this._font&&(this._font=t,this.nativeContext.font=t)}},{key:"globalAlpha",get:function(){return this.nativeContext.globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}},{key:"lineCap",get:function(){return this.nativeContext.lineCap},set:function(t){this.nativeContext.lineCap=t}},{key:"lineDashOffset",get:function(){return this.nativeContext.lineDashOffset},set:function(t){this.nativeContext.lineDashOffset=t}},{key:"lineJoin",get:function(){return this.nativeContext.lineJoin},set:function(t){this.nativeContext.lineJoin=t}},{key:"lineWidth",get:function(){return this.nativeContext.lineWidth},set:function(t){this.nativeContext.lineWidth=t}},{key:"miterLimit",get:function(){return this.nativeContext.miterLimit},set:function(t){this.nativeContext.miterLimit=t}},{key:"shadowBlur",get:function(){return this.nativeContext.shadowBlur},set:function(t){this.nativeContext.shadowBlur=t}},{key:"shadowColor",get:function(){return this.nativeContext.shadowColor},set:function(t){this.nativeContext.shadowColor=t}},{key:"shadowOffsetX",get:function(){return this.nativeContext.shadowOffsetX},set:function(t){this.nativeContext.shadowOffsetX=t}},{key:"shadowOffsetY",get:function(){return this.nativeContext.shadowOffsetY},set:function(t){this.nativeContext.shadowOffsetY=t}},{key:"strokeStyle",get:function(){return this.nativeContext.strokeStyle},set:function(t){this.nativeContext.strokeStyle=t}},{key:"textAlign",get:function(){return this.nativeContext.textAlign},set:function(t){this.nativeContext.textAlign=t}},{key:"textBaseline",get:function(){return this.nativeContext.textBaseline},set:function(t){this.nativeContext.textBaseline=t}},{key:"inuse",get:function(){return!!this._inuse},set:function(t){t!==!!this._inuse&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}},{key:"reset",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stack.length&&Wt.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Hn(1,0,0,1,0,0),this.stack.length=0,t&&this.nativeContext.setTransform(1,0,0,1,0,0)}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.nativeContext}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return uy.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}},{key:"restore",value:function(){this.nativeContext.restore(),this.stack.length>0&&(uy.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(uy.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*a),o&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,a),o&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.disableBeginPath||this.nativeContext.beginPath()}},{key:"clip",value:function(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}},{key:"arc",value:function(t,e,i,n,r,a,o){if(o=o||0,this.camera){var s=[];!function(t,e,i,n,r,a,o,s){if(s)for(;i>e;)i-=ei;else for(;i<e;)i+=ei;for(var l=Qe/3*(i>e?1:-1),u=e,c=u;c!==i;){c=l>0?Math.min(c+l,i):Math.max(c+l,i);var h=Math.abs(c-u),d=4*Math.tan(h/4)/3,p=c<u?-1:1,f=Math.cos(u),v=Math.sin(u),g=Math.cos(c),y=Math.sin(c),m=f*a+n,_=v*o+r,b=g*a+n,x=y*o+r,k=a*d*p,S=o*d*p;t.push([m-k*v,_+S*f,b+k*y,x-S*g,b,x]),u=c}}(s,n,r,t,e,i,i,a);for(var l=0;l<s.length;++l){var u=s[l];this.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5],o)}}else this.nativeContext.arc(t,e,Math.max(0,i),n,r,a)}},{key:"arcTo",value:function(t,e,i,n,r){this.nativeContext.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a,o){if(o=o||0,this.camera){var s=o,l=o;this.modelMatrix&&(oy(IC,[t,e,o],this.modelMatrix),t=IC[0],e=IC[1],s=IC[2],oy(IC,[i,n,o],this.modelMatrix),i=IC[0],n=IC[1],l=IC[2],oy(IC,[r,a,o],this.modelMatrix),r=IC[0],a=IC[1],o=IC[2]);var u=this.camera.vp(r,a,o);r=u.x,a=u.y,t=(u=this.camera.vp(t,e,s)).x,e=u.y,i=(u=this.camera.vp(i,n,l)).x,n=u.y}this.nativeContext.bezierCurveTo(t,e,i,n,r,a)}},{key:"closePath",value:function(){this.nativeContext.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){null==s?this.nativeContext.ellipse(t,e,i,n,r,a,o):this.nativeContext.ellipse(t,e,i,n,r,a,o,s)}},{key:"lineTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(oy(IC,[t,e,i],this.modelMatrix),t=IC[0],e=IC[1],i=IC[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.lineTo(t,e)}},{key:"moveTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(oy(IC,[t,e,i],this.modelMatrix),t=IC[0],e=IC[1],i=IC[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n,r){if(r=r||0,this.camera){var a=r;this.modelMatrix&&(oy(IC,[t,e,r],this.modelMatrix),t=IC[0],e=IC[1],a=IC[2],oy(IC,[i,n,r],this.modelMatrix),i=IC[0],n=IC[1],r=IC[2]);var o=this.camera.vp(i,n,r);i=o.x,n=o.y,t=(o=this.camera.vp(t,e,a)).x,e=o.y}this.nativeContext.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n,r){r=r||0,this.camera?(this.moveTo(t,e,r),this.lineTo(t+i,e,r),this.lineTo(t+i,e+n,r),this.lineTo(t,e+n,r),this.closePath()):this.nativeContext.rect(t,e,i,n)}},{key:"createImageData",value:function(){var t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}},{key:"createLinearGradient",value:function(t,e,i,n){return isFinite(t+e+i+n)||(t=0,e=0,i=0,n=0),this.nativeContext.createLinearGradient(t,e,i,n)}},{key:"createPattern",value:function(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){return this.nativeContext.createRadialGradient(t,e,i,n,r,a)}},{key:"createConicGradient",value:function(t,e,i,n){if(this.nativeContext.createConicGradient&&Math.abs(n-i-2*Math.PI)<.001)return this.nativeContext.createConicGradient(i,t,e);var r,a=!1,o=this;return{stops:[],addColorStop:function(t,e){this.stops.push([t,e]),a=!0},GetPattern:function(s,l,u){return a&&(u||(u=n-i),r=function(t,e,i,n,r,a,o,s,l){var u=Math.floor(180*r/Math.PI),c=Dy.GetCanvas(),h=Dy.GetCtx();if(!h)return null;var d=By.GetSize(s),p=By.GetSize(l),f=By.Get(e,i,n,a,o,d,p);if(f)return f;var v=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(n,2),Math.pow(d-i,2)+Math.pow(n,2)),Math.max(Math.pow(d-i,2)+Math.pow(p-n,2),Math.pow(i,2)+Math.pow(p-n,2)))),g=u+1,y=r/Math.max(1,g-1),m=Ey.getInstance().GetOrCreate(i,n,d,p,e,g),_=2*Math.PI*v/360;c.width=d,c.height=p,h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,d,p),h.translate(i,n),h.rotate(a);for(var b=0,x=g-1;b<x&&!(a+b*y>o);b++){var k=m.getColor(b);h.beginPath(),h.rotate(y),h.moveTo(0,0),h.lineTo(v,-2*_),h.lineTo(v,0),h.fillStyle=k,h.closePath(),h.fill()}var S=h.getImageData(0,0,d,p);return c.width=S.width,c.height=S.height,h.putImageData(S,0,0),(f=t.createPattern(c,"no-repeat"))&&By.Set(e,i,n,a,o,f,d,p),f}(o,this.stops,t,e,u,i,n,s,l),a=!1),r}}}},{key:"fill",value:function(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}},{key:"fillRect",value:function(t,e,i,n){this.nativeContext.fillRect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){this.nativeContext.clearRect(t,e,i,n)}},{key:"project",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(oy(IC,[t,e,i],this.modelMatrix),t=IC[0],e=IC[1],i=IC[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}return{x:t,y:e}}},{key:"view",value:function(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&(oy(IC,[t,e,i],this.modelMatrix),t=IC[0],e=IC[1],i=IC[2]),this.camera.view(t,e,i)):[t,e,i]}},{key:"fillText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(oy(IC,[e,i,n],this.modelMatrix),e=IC[0],i=IC[1],n=IC[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.fillText(t,e,i)}},{key:"getImageData",value:function(t,e,i,n){return this.nativeContext.getImageData(t,e,i,n)}},{key:"getLineDash",value:function(){return this.nativeContext.getLineDash()}},{key:"isPointInPath",value:function(t,e){return this.nativeContext.isPointInPath(t,e)}},{key:"isPointInStroke",value:function(t,e){return this.nativeContext.isPointInStroke(t,e)}},{key:"measureText",value:function(t){var e,i,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.global.measureTextMethod;if(!r||"native"===r)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=oh.graphicUtil.createTextMeasureInstance({},{},(function(){return n.canvas.nativeCanvas})));var a=null!==(e=this.fontFamily)&&void 0!==e?e:Rd.fontFamily,o=null!==(i=this.fontSize)&&void 0!==i?i:Rd.fontSize;return this.mathTextMeasure.textSpec.fontFamily===a&&this.mathTextMeasure.textSpec.fontSize===o||(this.mathTextMeasure.textSpec.fontFamily=a,this.mathTextMeasure.textSpec.fontSize=o,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,r)}},{key:"putImageData",value:function(t,e,i){this.nativeContext.putImageData(t,e,i)}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}},{key:"stroke",value:function(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}},{key:"strokeRect",value:function(t,e,i,n){this.nativeContext.strokeRect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(oy(IC,[e,i,n],this.modelMatrix),e=IC[0],i=IC[1],n=IC[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.strokeText(t,e,i)}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"setCommonStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setCommonStyle(t,e,i,n,r[0]);var a=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(a,t)})),this._setCommonStyle(t,e,i,n,a)}return this._setCommonStyle(t,e,i,n,r)}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.fillAttributes);var o=e.fillOpacity,s=void 0===o?r.fillOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;a.globalAlpha=s*u*this.baseGlobalAlpha,s>1e-12&&u>1e-12&&(a.fillStyle=ep(this,h,t,i,n))}},{key:"setShadowBlendStyle",value:function(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);var n=Object.create(i[0]);return i.forEach((function(t,e){0!==e&&Object.assign(n,t)})),this._setShadowBlendStyle(t,e,n)}return this._setShadowBlendStyle(t,e,i)}},{key:"_setShadowBlendStyle",value:function(t,e,i){var n=this.nativeContext;i||(i=this.fillAttributes);var r=e.opacity,a=void 0===r?i.opacity:r,o=e.shadowBlur,s=void 0===o?i.shadowBlur:o,l=e.shadowOffsetX,u=void 0===l?i.shadowOffsetX:l,c=e.shadowOffsetY,h=void 0===c?i.shadowOffsetY:c,d=e.blur,p=void 0===d?i.blur:d,f=e.globalCompositeOperation,v=void 0===f?i.globalCompositeOperation:f;if(!(a<=1e-12)){if(u||h||s){var g=e.shadowColor,y=void 0===g?i.shadowColor:g,m=e.shadowOffsetX,_=void 0===m?i.shadowOffsetX:m,b=e.shadowOffsetY,x=void 0===b?i.shadowOffsetY:b;n.shadowBlur=s*this.dpr,n.shadowColor=y,n.shadowOffsetX=_*this.dpr,n.shadowOffsetY=x*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0);p?(n.filter="blur(".concat(p,"px)"),this._clearFilterStyle=!0):this._clearFilterStyle&&(n.filter="blur(0px)",this._clearFilterStyle=!1),v?(n.globalCompositeOperation=v,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(n.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}},{key:"setStrokeStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setStrokeStyle(t,e,i,n,r[0]);var a=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(a,t)})),this._setStrokeStyle(t,e,i,n,a)}return this._setStrokeStyle(t,e,i,n,r)}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(a.globalAlpha=s*u*this.baseGlobalAlpha,s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineDashOffset,_=void 0===m?r.lineDashOffset:m,b=e.lineCap,x=void 0===b?r.lineCap:b,k=e.miterLimit,S=void 0===k?r.miterLimit:k,A=e.keepStrokeScale,C=void 0===A?r.keepStrokeScale:A;a.lineWidth=C?h:tp(this,h,this.dpr),a.strokeStyle=ep(this,p,t,i,n),a.lineJoin=v,y&&(a.setLineDash(y),a.lineDashOffset=_),a.lineCap=x,a.miterLimit=S}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r=t.scaleIn3d,a=void 0===r?e.scaleIn3d:r;t.font?this.font=t.font:this.font=En(t,e,a&&this.camera&&this.camera.getProjectionScale(i));var o=t.fontFamily,s=void 0===o?e.fontFamily:o,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,a=this.nativeContext;e||(e=this.textAttributes),t.font?this.font=t.font:this.font=En(t,e,this.camera&&this.camera.getProjectionScale(i));var o=t.fontFamily,s=void 0===o?e.fontFamily:o,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,a.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,a.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(this._clearMatrix,t,e)}},{key:"setClearMatrix",value:function(t,e,i,n,r,a){this._clearMatrix.setValue(t,e,i,n,r,a)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return uy.free(t)})),this.stack.length=0}}])}();FC.env="browser",FC=RC([Dc(),LC("design:paramtypes",[Object,Number])],FC);var OC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},zC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},HC=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(t){var e=t.container;if("string"==typeof e){var i=oh.global.getElementById(e);i&&(this._container=i)}else this._container=e;this._context=new FC(this,this._dpr),this.initStyle()}},{key:"initStyle",value:function(){if(this.controled){var t=this.nativeCanvas;t.width=this._pixelWidth,t.height=this._pixelHeight,!t.style||this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}}},{key:"hide",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}},{key:"show",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}},{key:"applyPosition",value:function(){var t=this._nativeCanvas;t.style.position="absolute",t.style.top="".concat(this._y,"px"),t.style.left="".concat(this._x,"px")}},{key:"resetStyle",value:function(t){if(this.controled){var e=t.width,i=void 0===e?this._displayWidth:e,n=t.height,r=void 0===n?this._displayHeight:n,a=t.dpr,o=void 0===a?this._dpr:a,s=t.x,l=void 0===s?this._x:s,u=t.y,c=void 0===u?this._y:u,h=this.nativeCanvas;h.width=i*o,h.height=r*o,!h.style||this.setCanvasStyle(h,l,c,i,r),t.id&&(h.id=t.id),this.visiable||this.hide()}}},{key:"setCanvasStyle",value:function(t,e,i,n,r){this.controled&&(t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"))}},{key:"toDataURL",value:function(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}},{key:"resize",value:function(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width="".concat(t,"px"),this._nativeCanvas.style.height="".concat(e,"px")),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}}])}(by);function NC(t,e){return new gc((function(i){i(mp).toDynamicValue((function(){return function(e){return new t(e)}})).whenTargetNamed(t.env),i(_p).toDynamicValue((function(){return function(t,i){return new e(t,i)}})).whenTargetNamed(e.env)}))}HC.env="browser";var UC=NC(HC=OC([Dc(),zC("design:paramtypes",[Object])],HC),FC),jC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},VC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},WC=function(t,e){return function(i,n){e(i,n,t)}},GC=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[a,o])).contributions=t,s.drawContribution=i,s.pickItemInterceptorContributions=a,s.pickServiceInterceptorContributions=o,s.global.hooks.onSetEnv.tap("canvas-picker-service",(function(t,e,i){s.configure(i,e)})),s.configure(s.global,s.global.env),s.pickerMap=new Map,s.init(),s}return h(e,t),o(e,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),_(e,"_init",this,3)([])}},{key:"configure",value:function(t,e){this.pickCanvas=qp.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(var r=0;r<this.InterceptorContributions.length;r++){var a=this.InterceptorContributions[r];if(a.beforePickItem){var o=a.beforePickItem(t,this,e,n,{parentMatrix:i});if(o)return o}}var s=this.pickerMap.get(t.numberType);if(!s)return null;var l=s.contains(t,e,n),u=l?t:null,c={graphic:u,params:l};if(u)return c;if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.afterPickItem){var p=d.afterPickItem(t,this,e,n,{parentMatrix:i});if(p)return p}}return c}}])}(TS);GC=jC([Dc(),WC(0,wc(Yc)),WC(0,Ec(TC)),WC(1,wc(Yx)),WC(2,wc(Yc)),WC(2,Ec(hk)),WC(3,wc(Yc)),WC(3,Ec(dk)),VC("design:paramtypes",[Object,Object,Object,Object])],GC);var YC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},XC=function(){return o((function t(){r(this,t),this.type="group",this.numberType=Ng}),[{key:"contains",value:function(t,e,i){return!1}}])}();XC=YC([Dc()],XC);var KC=new gc((function(t,e,i,n){KC.__vloaded||(KC.__vloaded=!0,t(wC).to(XC).inSingletonScope(),t(TC).toService(wC),Kc(t,TC))}));KC.__vloaded=!1;var qC=KC,ZC=new gc((function(t,e,i,n){i(GC)||t(GC).toSelf().inSingletonScope(),i(uk)?n(uk).toService(GC):t(uk).toService(GC)}));function JC(t){t.load(qC),t.load(ZC)}var QC,$C=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},tM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},eM=QC=function(t){function e(){var t;return r(this,e),(t=n(this,e)).type="browser",t._canvasIsIntersecting=!0,t.global=oh.global,t.viewBox=new On,t.modelMatrix=new Hn(1,0,0,1,0,0),t}return h(e,t),o(e,[{key:"container",get:function(){return this.canvas.nativeCanvas.parentElement}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return this.canvas.nativeCanvas.getBoundingClientRect()}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}},{key:"postInit",value:function(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}},{key:"isElementVisible",value:function(t){var e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>n)}},{key:"observerCanvas",value:function(){var t=this;this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);var e=new IntersectionObserver((function(e,i){e.forEach((function(e){t._canvasIsIntersecting!==e.isIntersecting?(t._canvasIsIntersecting=e.isIntersecting,t._onVisibleChangeCb&&t._onVisibleChangeCb(e.isIntersecting)):t._canvasIsIntersecting=e.isIntersecting}))}));e&&e.observe(this.canvas.nativeCanvas)}},{key:"createWindowByConfig",value:function(t){var e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw new Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);var n={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:QC.GenerateCanvasId(),canvasControled:!0};this.canvas=new HC(n)}},{key:"createWindowByCanvas",value:function(t){var e,i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw new Error("发生错误，传入的canvas不正确");var n=t.width,r=t.height;if(null==n||null==r||!t.canvasControled){var a=i.getBoundingClientRect();n=a.width,r=a.height}var o=t.dpr;null==o&&(o=null!==(e=i.getContext("2d").pixelRatio)&&void 0!==e?e:i.width/n),this.canvas=new HC({width:n,height:r,dpr:o,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this.canvas.nativeCanvas.dispatchEvent(t)}},{key:"getStyle",value:function(){var t;return null!==(t=this.canvas.nativeCanvas.style)&&void 0!==t?t:{}}},{key:"setStyle",value:function(t){this.canvas.nativeCanvas.style=t}},{key:"getBoundingClientRect",value:function(){var t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}},{key:"isVisible",value:function(t){return this._canvasIsIntersecting}},{key:"onVisibleChange",value:function(t){this._onVisibleChangeCb=t}},{key:"getTopLeft",value:function(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}}],[{key:"GenerateCanvasId",value:function(){return"".concat(QC.idprefix,"_").concat(QC.prefix_count++)}}])}(bS);eM.env="browser",eM.idprefix="visactor_window",eM.prefix_count=0,eM=QC=$C([Dc(),tM("design:paramtypes",[])],eM);var iM=new gc((function(t){t(eM).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(eM)})).whenTargetNamed(eM.env)})),nM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},aM=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},oM=function(){return o((function t(e){r(this,t),this.dom=e}),[{key:"x1",get:function(){return this.dom.getBoundingClientRect().left}},{key:"x2",get:function(){return this.dom.getBoundingClientRect().right}},{key:"y1",get:function(){return this.dom.getBoundingClientRect().top}},{key:"y2",get:function(){return this.dom.getBoundingClientRect().bottom}},{key:"width",get:function(){return this.dom.getBoundingClientRect().width}},{key:"height",get:function(){return this.dom.getBoundingClientRect().height}}])}();function sM(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.createElement("img");if(oh.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){var n=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(n)}return i.src=t,i.complete?Promise.resolve(i):new Promise((function(t,e){i.onload=function(){t(i)},i.onerror=function(){e(new Error("加载失败"))}}))}var lM=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="browser",t.supportEvent=!0;try{t.supportsTouchEvents="ontouchstart"in globalThis,t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsTouchEvents=!1,t.supportsPointerEvents=!1,t.supportsPointerEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"mapToCanvasPoint",value:function(t,e){var i,n,r=0,a=0,o=0,s=0;if(t.changedTouches){var l=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};o=r=l.clientX||0,s=a=l.clientY||0}else r=t.clientX||0,a=t.clientY||0,o=t.offsetX||0,s=t.offsetY||0;if(e){var u,c,h=r,d=a,p=e.getBoundingClientRect(),f=null===(n=e.getNativeHandler)||void 0===n?void 0:n.call(e).nativeCanvas;return f&&(u=p.width/f.offsetWidth,c=p.height/f.offsetHeight),{x:(h-p.left)/(it(u)?u:1),y:(d-p.top)/(it(c)?c:1)}}return{x:o,y:s}}},{key:"getNativeAABBBounds",value:function(t){var e=t;if("string"==typeof t&&((e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild)),e.getBoundingClientRect){var i=e.getBoundingClientRect();return new oM(i)}return new On}},{key:"removeDom",value:function(t){return t.parentElement.removeChild(t),!0}},{key:"updateDom",value:function(t,e){var i=e.width,n=e.height,r=e.style;return r&&(q(r)?t.setAttribute("style",r):Object.keys(r).forEach((function(e){t.style[e]=r[e]}))),null!=i&&(t.style.width="".concat(i,"px")),null!=n&&(t.style.height="".concat(n,"px")),!0}},{key:"createDom",value:function(t){var e=t.tagName,i=void 0===e?"div":e,n=t.parent,r=document.createElement(i);if(this.updateDom(r,t),n){var a=q(n)?this.getElementById(n):n;a&&a.appendChild&&a.appendChild(r)}return r}},{key:"loadImage",value:function(t){return sM(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return sM(t,!0).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"createCanvas",value:function(t){var e,i,n=document.createElement("canvas");t.id&&(n.id=null!==(e=t.id)&&void 0!==e?e:vc.GenAutoIncrementId().toString());var r=null!==(i=t.dpr)&&void 0!==i?i:window.devicePixelRatio;return t.width&&t.height&&(n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px"),n.width=t.width*r,n.height=t.height*r),n}},{key:"createOffscreenCanvas",value:function(t){var e,i=null!==(e=t.dpr)&&void 0!==e?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}},{key:"releaseCanvas",value:function(t){var e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getRequestAnimationFrame",value:function(){return window.requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return window.cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return document.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return document.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return document.dispatchEvent(t)}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"getDocument",value:function(){return document}},{key:"release",value:function(){}},{key:"getElementTop",value:function(t,e){for(var i=t.offsetTop,n=t.offsetParent;null!==n;)i+=n.offsetTop,n=n.offsetParent;return i}},{key:"getElementLeft",value:function(t,e){for(var i=t.offsetLeft,n=t.offsetParent;null!==n;)i+=n.offsetLeft,n=n.offsetParent;return i}},{key:"getElementTopLeft",value:function(t,e){for(var i=t.offsetTop,n=t.offsetLeft,r=t.offsetParent;null!==r;)i+=r.offsetTop,n+=r.offsetLeft,r=r.offsetParent;return{top:i,left:n}}},{key:"loadFont",value:function(t,e,i){return aM(this,void 0,void 0,f().m((function n(){return f().w((function(n){for(;;)if(0===n.n)return n.a(2,new FontFace(t,q(e)?"url(".concat(e,")"):e,i).load().then((function(t){return document.fonts.add(t),{loadState:"success"}})).catch((function(t){return console.error("Failed to load font:",t),{loadState:"fail"}})))}),n)})))}},{key:"isMacOS",value:function(){if(void 0===this._isMacOS)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch(t){this._isMacOS=!1}return this._isMacOS}},{key:"copyToClipBoard",value:function(t){return navigator.clipboard.writeText(t).then((function(){})).catch((function(t){}))}}])}(yS);lM=nM([Dc(),rM("design:paramtypes",[])],lM);var uM=new gc((function(t){uM.isBrowserBound||(uM.isBrowserBound=!0,t(lM).toSelf().inSingletonScope(),t(ih).toService(lM))}));function cM(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];cM.__loaded||(cM.__loaded=!0,t.load(uM),t.load(UC),t.load(iM),e&&JC(t))}uM.isBrowserBound=!1,cM.__loaded=!1;var hM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},dM=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"getImageData",value:function(t,e,i,n){var r=this;return new Promise((function(a,o){var s;try{tt.canvasGetImageData({canvasId:null!==(s=r.canvas.nativeCanvas.id)&&void 0!==s?s:r.canvas.id,x:t,y:e,width:i,height:n,success:function(t){a(t)}})}catch(t){o(t)}}))}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}},{key:"createPattern",value:function(t,e){return null}}])}(FC);dM.env="feishu",dM=hM([Dc()],dM);var pM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},vM=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new dM(this,this._dpr)}},{key:"release",value:function(){}}])}(by);vM.env="feishu";var gM=NC(vM=pM([Dc(),fM("design:paramtypes",[Object])],vM),dM),yM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_M=function(t,e){return function(i,n){e(i,n,t)}},bM=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),xM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="feishu",i.eventManager=new bM,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new vM(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new vM({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(bS);xM.env="feishu",xM=yM([Dc(),_M(0,wc(nh)),mM("design:paramtypes",[Object])],xM);var kM=new gc((function(t){t(xM).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(xM)})).whenTargetNamed(xM.env)})),SM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},AM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},CM=function(t,e){return function(i,n){e(i,n,t)}},MM=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[i,a])).contributions=t,o.pickItemInterceptorContributions=i,o.pickServiceInterceptorContributions=a,o.global.hooks.onSetEnv.tap("math-picker-service",(function(t,e,i){o.configure(i,e)})),o.configure(o.global,o.global.env),o.pickerMap=new Map,o.init(),o}return h(e,t),o(e,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),_(e,"_init",this,3)([])}},{key:"configure",value:function(t,e){this.pickContext=new vy(null,1)}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;var r=this.pickerMap.get(t.numberType);if(!r)return null;var a=r.contains(t,e,n),o=a?t:null;return o?{graphic:o,params:a}:null}}])}(TS);MM=SM([Dc(),CM(0,wc(Yc)),CM(0,Ec(tC)),CM(1,wc(Yc)),CM(1,Ec(hk)),CM(2,wc(Yc)),CM(2,Ec(dk)),AM("design:paramtypes",[Object,Object,Object])],MM);var wM=new gc((function(t){wM.__vloaded||(wM.__vloaded=!0,Kc(t,tC))}));wM.__vloaded=!1;var TM=wM,DM=function(){return o((function t(){r(this,t)}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!this.canvasRenderer)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme();n.highPerformanceSave();var a=t.attribute,o=a.x,s=void 0===o?r.x:o,l=a.y,u=void 0===l?r.y:l;if(t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1,d=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n,r){return!(!h&&!d)||(h=t.isPointInPath(e.x,e.y),d=r||d,h)}),(function(t,i,r,a){if(h||d)return!0;var o=i.lineWidth||r.lineWidth,s=i.pickStrokeBuffer||r.pickStrokeBuffer,l=i.keepStrokeScale||r.keepStrokeScale;return n.lineWidth=l?o+s:tp(n,o+s,n.dpr),h=t.isPointInStroke(e.x,e.y),d=a||d,h})),n.highPerformanceRestore(),h}}])}(),EM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},BM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},PM=function(t,e){return function(i,n){e(i,n,t)}},RM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc",i.numberType=Ig,i}return h(e,t),o(e)}(DM);RM=EM([Dc(),PM(0,wc(Dx)),BM("design:paramtypes",[Object])],RM);var LM=!1,IM=new gc((function(t,e,i,n){LM||(LM=!0,t(eC).to(RM).inSingletonScope(),t(tC).toService(eC))})),FM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},OM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},zM=function(t,e){return function(i,n){e(i,n,t)}},HM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="area",i.numberType=Og,i}return h(e,t),o(e)}(DM);HM=FM([Dc(),zM(0,wc(Bx)),OM("design:paramtypes",[Object])],HM);var NM=!1,UM=new gc((function(t,e,i,n){NM||(NM=!0,t(iC).to(HM).inSingletonScope(),t(tC).toService(iC))})),jM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},VM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},WM=function(t,e){return function(i,n){e(i,n,t)}},GM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="circle",i.numberType=zg,i}return h(e,t),o(e)}(DM);GM=jM([Dc(),WM(0,wc(Px)),VM("design:paramtypes",[Object])],GM);var YM=!1,XM=new gc((function(t,e,i,n){YM||(YM=!0,t(nC).to(GM).inSingletonScope(),t(tC).toService(nC))})),KM=function(){return o((function t(){r(this,t),this.type="glyph",this.numberType=Hg}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!(null!=i?i:{}).pickContext)return!1;var n=null==i?void 0:i.pickerService;if(n){var r=!1;return t.getSubGraphic().forEach((function(t){if(!r){var a=n.pickItem(t,e,null,i);r=!(!a||!a.graphic)}})),r}return!1}}])}(),qM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ZM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},JM=function(t,e){return function(i,n){e(i,n,t)}},QM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(KM);QM=qM([Dc(),JM(0,wc(Wx)),ZM("design:paramtypes",[Object])],QM);var $M=!1,tw=new gc((function(t,e,i,n){$M||($M=!0,t(hC).to(QM).inSingletonScope(),t(QM).toService(hC))})),ew=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},iw=function(){return o((function t(){r(this,t),this.type="image",this.numberType=Ug}),[{key:"contains",value:function(t,e,i){return!!(null!=i?i:{}).pickContext&&!!t.AABBBounds.containsPoint(e)}}])}();iw=ew([Dc()],iw);var nw=!1,rw=new gc((function(t,e,i,n){nw||(nw=!0,t(rC).to(iw).inSingletonScope(),t(iw).toService(rC))})),aw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ow=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},sw=function(t,e){return function(i,n){e(i,n,t)}},lw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="line",i.numberType=jg,i}return h(e,t),o(e)}(DM);lw=aw([Dc(),sw(0,wc(Ix)),ow("design:paramtypes",[Object])],lw);var uw=!1,cw=new gc((function(t,e,i,n){uw||(uw=!0,t(aC).to(lw).inSingletonScope(),t(tC).toService(aC))})),hw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},dw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},pw=function(t,e){return function(i,n){e(i,n,t)}},fw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="polygon",i.numberType=Wg,i}return h(e,t),o(e)}(DM);fw=hw([Dc(),pw(0,wc(Ox)),dw("design:paramtypes",[Object])],fw);var vw=!1,gw=new gc((function(t,e,i,n){vw||(vw=!0,t(cC).to(fw).inSingletonScope(),t(tC).toService(cC))})),yw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_w=function(t,e){return function(i,n){e(i,n,t)}},bw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="path",i.numberType=Vg,i}return h(e,t),o(e)}(DM);bw=yw([Dc(),_w(0,wc(Fx)),mw("design:paramtypes",[Object])],bw);var xw=!1,kw=new gc((function(t,e,i,n){xw||(xw=!0,t(oC).to(bw).inSingletonScope(),t(tC).toService(oC))})),Sw=new On,Aw=function(){return o((function t(){r(this,t),this.type="rect",this.numberType=Yg}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme(),a=t.attribute.cornerRadius,o=void 0===a?r.cornerRadius:a,s=t.attribute,l=s.x,u=void 0===l?r.x:l,c=s.y,h=void 0===c?r.y:c;n.highPerformanceSave();var d=!0;if(t.transMatrix.onlyTranslate()){var p=t.getOffsetXY(r);u+=p.x,h+=p.y,n.setTransformForCurrent()}else u=0,h=0,d=!1,n.transformFromMatrix(t.transMatrix,!0);var f=!0;if(!d||t.shadowRoot||$(o,!0)&&0!==o||Z(o)&&o.some((function(t){return 0!==t})))f=!1,this.canvasRenderer.drawShape(t,n,u,h,{},null,(function(t,i,n){return!!f||(f=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(f)return!0;var a=i.lineWidth||r.lineWidth,o=i.pickStrokeBuffer||r.pickStrokeBuffer,s=i.keepStrokeScale||r.keepStrokeScale;return n.lineWidth=s?a+o:tp(n,a+o,n.dpr),f=t.isPointInStroke(e.x,e.y)}));else{var v=t.attribute,g=v.fill,y=void 0===g?r.fill:g,m=v.stroke,_=void 0===m?r.stroke:m,b=v.lineWidth,x=void 0===b?r.lineWidth:b;if(y)f=!0;else if(_){var k=t.AABBBounds;Sw.setValue(k.x1,k.y1,k.x2,k.y2),Sw.expand(-x/2),f=!Sw.containsPoint(e)}}return n.highPerformanceRestore(),f}}])}(),Cw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Mw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ww=function(t,e){return function(i,n){e(i,n,t)}},Tw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(Aw);Tw=Cw([Dc(),ww(0,wc(zx)),Mw("design:paramtypes",[Object])],Tw);var Dw=!1,Ew=new gc((function(t,e,i,n){Dw||(Dw=!0,t(sC).to(Tw).inSingletonScope(),t(tC).toService(sC))})),Bw=!1,Pw=new gc((function(t,e,i,n){Bw||(Bw=!0,t(rC).to(iw).inSingletonScope(),t(iw).toService(rC))})),Rw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Lw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Iw=function(t,e){return function(i,n){e(i,n,t)}},Fw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="symbol",i.numberType=qg,i}return h(e,t),o(e)}(DM);Fw=Rw([Dc(),Iw(0,wc(Nx)),Lw("design:paramtypes",[Object])],Fw);var Ow=!1,zw=new gc((function(t,e,i,n){Ow||(Ow=!0,t(lC).to(Fw).inSingletonScope(),t(tC).toService(lC))})),Hw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Nw=function(){return o((function t(){r(this,t),this.type="text",this.numberType=Zg}),[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}])}();Nw=Hw([Dc()],Nw);var Uw=!1,jw=new gc((function(t,e,i,n){Uw||(Uw=!0,t(uC).to(Nw).inSingletonScope(),t(tC).toService(uC))})),Vw=new gc((function(t,e,i,n){i(MM)||t(MM).toSelf().inSingletonScope(),i(uk)?n(uk).toService(MM):t(uk).toService(MM)}));function Ww(t){t.load(TM),t.load(Vw),t.load(IM),t.load(UM),t.load(XM),t.load(tw),t.load(rw),t.load(cw),t.load(gw),t.load(kw),t.load(Ew),t.load(Pw),t.load(zw),t.load(jw)}var Gw=function(){return o((function t(e,i,n,a,o,s){r(this,t),this.nativeCanvas=e,this.ctx=i,this._w=a,this._h=o,this.id=s,e.id=s,this.dpr=n}),[{key:"width",get:function(){return this._w*this.dpr},set:function(t){}},{key:"height",get:function(){return this._h*this.dpr},set:function(t){}},{key:"offsetWidth",get:function(){return this._w},set:function(t){}},{key:"offsetHeight",get:function(){return this._h},set:function(t){}},{key:"getContext",value:function(){return this.ctx}},{key:"getBoundingClientRect",value:function(){return{width:this._w,height:this._h}}}])}(),Yw=function(){return o((function t(e,i,n,a,o,s){r(this,t),this.nativeCanvas=e,this.ctx=i,this._w=a,this._h=o,this.id=s,e.id=s,this.dpr=n}),[{key:"width",get:function(){return this._w*this.dpr},set:function(t){this._w=t/this.dpr,this.nativeCanvas.width=t}},{key:"height",get:function(){return this._h*this.dpr},set:function(t){this._h=t/this.dpr,this.nativeCanvas.height=t}},{key:"offsetWidth",get:function(){return this._w},set:function(t){this._w=t,this.nativeCanvas.width=t*this.dpr}},{key:"offsetHeight",get:function(){return this._h},set:function(t){this._h=t,this.nativeCanvas.height=t*this.dpr}},{key:"getContext",value:function(){return this.ctx}},{key:"getBoundingClientRect",value:function(){return{width:this._w,height:this._h}}}])}(),Xw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Kw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var qw=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="feishu",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"configure",value:function(t,e){var i,n,r,a,o,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,a=e.freeCanvasIdx,o=this.freeCanvasList,s=e.pixelRatio,l=null!=s?s:tt.getSystemInfoSync().pixelRatio,n.forEach((function(t,e){var n=tt.createCanvasContext(t),s=new Gw(n.canvas||{},n,l,i.width,i.height,t);n.canvas=s,r.set(t,s),e>=a&&o.push(s)})))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return jf.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){jf.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(yS);qw=Xw([Dc(),Kw("design:paramtypes",[])],qw);var Zw=new gc((function(t){Zw.isFeishuBound||(Zw.isFeishuBound=!0,t(qw).toSelf().inSingletonScope(),t(ih).toService(qw))}));function Jw(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Jw.__loaded||(Jw.__loaded=!0,t.load(Zw),t.load(gM),t.load(kM),e&&Ww(t))}Zw.isFeishuBound=!1,Jw.__loaded=!1;var Qw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$w=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;n&&i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b,k=e.keepStrokeScale,S=void 0===k?r.keepStrokeScale:k,A=e.lineDashOffset,C=void 0===A?r.lineDashOffset:A;a.globalAlpha=s*u*this.baseGlobalAlpha,a.lineWidth=S?h:tp(this,h,this.dpr),a.strokeStyle=ep(this,p,t,i,n),a.lineJoin=v,0===y[0]&&0===y[1]||!y||(a.setLineDash(y),a.lineDashOffset=C),a.lineCap=_,a.miterLimit=x}}},{key:"measureText",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,oh.global.devicePixelRatio),{width:_(e,"measureText",this,3)([t,i]).width,fontBoundingBoxDescent:void 0,fontBoundingBoxAscent:void 0,actualBoundingBoxAscent:void 0,actualBoundingBoxDescent:void 0}}},{key:"createPattern",value:function(t,e){return null}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}}])}(FC);$w.env="lynx",$w=Qw([Dc()],$w);var tT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},eT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},iT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new $w(this,this._dpr)}},{key:"resize",value:function(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}},{key:"release",value:function(){}}])}(by);iT.env="lynx",iT=tT([Dc(),eT("design:paramtypes",[Object])],iT);var nT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},aT=function(t,e){return function(i,n){e(i,n,t)}},oT=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),sT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="lynx",i.eventManager=new oT,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new iT(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new iT({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(bS);sT.env="lynx",sT=nT([Dc(),aT(0,wc(nh)),rT("design:paramtypes",[Object])],sT);var lT=new gc((function(t){t(sT).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(sT)})).whenTargetNamed(sT.env)})),uT=NC(iT,$w),cT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},dT=!1;try{dT=!!lynx.createCanvasNG}catch(t){}var pT=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="lynx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,n,r,a,o){var s=null!=o?o:SystemInfo.pixelRatio;if(e.forEach((function(e,o){var l;a?l=lynx.createOffscreenCanvas():(l=dT?lynx.createCanvasNG(e):lynx.createCanvas(e),dT&&l.attachToCanvasView(e)),l.width=t.width*s,l.height=t.height*s;var u=l.getContext("2d"),c=new Yw(l,u,s,t.width,t.height,e);i.set(e,c),o>n&&r.push(c)})),!r.length&&lynx.createOffscreenCanvas){var l=lynx.createOffscreenCanvas();l.width=t.width*s,l.height=t.height*s;var u=l.getContext("2d"),c=Math.random().toString(),h=new Yw(l,u,s,t.width,t.height,c);i.set(c,h),r.push(h)}}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,!!e.offscreen,e.pixelRatio))}},{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){return function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return Promise.reject();var e=lynx.createImage(t);return new Promise((function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(new Error("加载失败"))}}))}(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return SystemInfo.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return jf.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){jf.clear(t)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(yS);pT=cT([Dc(),hT("design:paramtypes",[])],pT);var fT=new gc((function(t){fT.isLynxBound||(fT.isLynxBound=!0,t(pT).toSelf().inSingletonScope(),t(ih).toService(pT))}));function vT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];vT.__loaded||(vT.__loaded=!0,t.load(fT),t.load(uT),t.load(lT),e&&Ww(t))}fT.isLynxBound=!1,vT.__loaded=!1;var gT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},yT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},mT=function(t){function e(t,i){var a;r(this,e),a=n(this,e,[t,i]);var o=t.nativeCanvas.getContext("2d");if(!o)throw new Error("发生错误，获取2d上下文失败");return a.nativeContext=o,a.canvas=t,a.matrix=new Hn(1,0,0,1,0,0),a.stack=[],a.dpr=null!=i?i:1,a}return h(e,t),o(e,[{key:"release",value:function(){}}])}(FC);mT.env="node",mT=gT([Dc(),yT("design:paramtypes",[Object,Number])],mT);var _T=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},bT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},xT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new mT(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}},{key:"release",value:function(){this._nativeCanvas.release&&U(this._nativeCanvas.release)&&this._nativeCanvas.release()}}])}(by);xT.env="node";var kT=NC(xT=_T([Dc(),bT("design:paramtypes",[Object])],xT),mT),ST=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},AT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},CT=function(t,e){return function(i,n){e(i,n,t)}},MT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="node",i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return""}},{key:"getWH",value:function(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new xT(i)}},{key:"createWindowByCanvas",value:function(t){var e,i=t.canvas,n=null!==(e=t.dpr)&&void 0!==e?e:1,r=t.width,a=t.height;null!=r&&null!=a&&t.canvasControled||(r=i.width/n,a=i.height/n),this.canvas=new xT({width:r,height:a,dpr:n,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"getImageBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png";return this.canvas.nativeCanvas.toBuffer(t)}},{key:"addEventListener",value:function(t,e,i){}},{key:"dispatchEvent",value:function(t){return!0}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getStyle",value:function(){}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){return null}},{key:"clearViewBox",value:function(t){}}])}(bS);MT.env="node",MT=ST([Dc(),CT(0,wc(nh)),AT("design:paramtypes",[Object])],MT);var wT=new gc((function(t){t(MT).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(MT)})).whenTargetNamed(MT.env)})),TT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},DT=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="node",t._lastTime=0,t.supportEvent=!1,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}},{key:"getDynamicCanvasCount",value:function(){return 0}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadImage",value:function(t){var e=this.pkg.loadImage;return e?e(t).then((function(t){return{loadState:t?"success":"fail",data:t}})).catch((function(){return{loadState:"fail",data:null}})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}},{key:"loadSvg",value:function(t){var e=this.pkg.Resvg;if(!e)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));var i=new e(t).render().asPng();return this.loadImage(i)}},{key:"createCanvas",value:function(t){return this.pkg.createCanvas(t.width,t.height)}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){return function(t){return jf.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){jf.clear(t)}}},{key:"addEventListener",value:function(t,e,i){}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"dispatchEvent",value:function(t){}},{key:"release",value:function(){}},{key:"createOffscreenCanvas",value:function(t){}}])}(yS);DT=TT([Dc()],DT);var ET=new gc((function(t){ET.isNodeBound||(ET.isNodeBound=!0,t(DT).toSelf().inSingletonScope(),t(ih).toService(DT))}));function BT(t){BT.__loaded||(BT.__loaded=!0,t.load(ET),t.load(kT),t.load(wT))}ET.isNodeBound=!1,BT.__loaded=!1;var PT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},RT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}},{key:"draw",value:function(){this.nativeContext.draw()}},{key:"strokeText",value:function(t,e,i){}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.fillAttributes);var o=e.fillOpacity,s=void 0===o?r.fillOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;s>1e-12&&u>1e-12&&(a.setGlobalAlpha(s*u),a.setFillStyle(ep(this,h,t,i,n)))}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineDashOffset,_=void 0===m?r.lineDashOffset:m,b=e.lineCap,x=void 0===b?r.lineCap:b,k=e.miterLimit,S=void 0===k?r.miterLimit:k,A=e.keepStrokeScale,C=void 0===A?r.keepStrokeScale:A;a.setGlobalAlpha(s*u),a.setLineWidth(C?h:tp(this,h,this.dpr)),a.setStrokeStyle(ep(this,p,t,i,n)),a.setLineJoin(v),y&&(a.setLineDash(y),a.lineDashOffset=_),a.setLineCap(x),a.setMiterLimit(S)}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){var i,n=this.nativeContext;e||(e=this.textAttributes),t.font?n.font=t.font:n.font=En(t,e),n.setFontSize(null!==(i=t.fontSize)&&void 0!==i?i:e.fontSize)}},{key:"setTextStyle",value:function(t,e){var i,n,r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=En(t,e),r.setTextAlign(null!==(i=t.textAlign)&&void 0!==i?i:e.textAlign),r.setTextBaseline(null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"createPattern",value:function(t,e){return null}},{key:"getImageData",value:function(t,e,i,n){var r=this,a=this.nativeContext,o=a.taro;if(a&&o)return!a.getImageData&&o.canvasGetImageData?new Promise((function(a,s){try{o.canvasGetImageData({canvasId:r.canvas.nativeCanvas.id,sx:t,sy:e,sw:i,sh:n,success:function(t){a(t)}})}catch(t){s(t)}})):void 0}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){return this.nativeContext.createCircularGradient&&this.nativeContext.createCircularGradient(t,e,i,n,r,a)}}])}(FC);RT.env="taro",RT=PT([Dc()],RT);var LT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},IT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},FT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new RT(this,this._dpr)}},{key:"release",value:function(){}}])}(by);FT.env="taro";var OT=NC(FT=LT([Dc(),IT("design:paramtypes",[Object])],FT),RT),zT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},HT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},NT=function(t,e){return function(i,n){e(i,n,t)}},UT=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),jT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="taro",i.eventManager=new UT,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new FT(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new FT({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((function(e,i){t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})})),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((function(e,i){t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})})),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(bS);jT.env="taro",jT=zT([Dc(),NT(0,wc(nh)),HT("design:paramtypes",[Object])],jT);var VT=new gc((function(t){t(jT).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(jT)})).whenTargetNamed(jT.env)})),WT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},GT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var YT=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="taro",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"configure",value:function(t,e){var i,n,r,a,o,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,a=e.freeCanvasIdx,o=this.freeCanvasList,s=e.taro,l=e.pixelRatio,n.forEach((function(t,e){var n=s.createCanvasContext(t),u=new Gw(n.canvas||{},n,l,i.width,i.height,t);return n.canvas=u,r.set(t,u),e>=a&&o.push(u),u})),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){var e=window||globalThis;if(e.DOMParser){var i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],n=(new XMLSerializer).serializeToString(i),r="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n));return Promise.resolve({data:r,loadState:"success"})}if(e.Blob){var a=new e.Blob([t],{type:"image/svg+xml"}),o=e.URL.createObjectURL(a);return Promise.resolve({data:o,loadState:"success"})}return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return this.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(yS);YT=WT([Dc(),GT("design:paramtypes",[])],YT);var XT=new gc((function(t){XT.isTaroBound||(XT.isTaroBound=!0,t(YT).toSelf().inSingletonScope(),t(ih).toService(YT))}));function KT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];KT.__loaded||(KT.__loaded=!0,t.load(XT),t.load(OT),t.load(VT),e&&Ww(t))}XT.isTaroBound=!1,KT.__loaded=!1;var qT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ZT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"draw",value:function(){}},{key:"createPattern",value:function(t,e){return null}}])}(FC);ZT.env="wx",ZT=qT([Dc()],ZT);var JT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},QT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},$T=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new ZT(this,this._dpr)}},{key:"release",value:function(){}}])}(by);$T.env="wx";var tD=NC($T=JT([Dc(),QT("design:paramtypes",[Object])],$T),ZT),eD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},iD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nD=function(t,e){return function(i,n){e(i,n,t)}},rD=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),aD=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="wx",i.eventManager=new rD,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new $T(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new $T({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e,i,n,r,a=t.type;return!!this.eventManager.cache[a]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!==(e=t.changedTouches[0].x)&&void 0!==e?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!==(i=t.changedTouches[0].x)&&void 0!==i?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!==(n=t.changedTouches[0].y)&&void 0!==n?n:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!==(r=t.changedTouches[0].y)&&void 0!==r?r:t.changedTouches[0].pageY),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[a].listener&&this.eventManager.cache[a].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(bS);aD.env="wx",aD=eD([Dc(),nD(0,wc(nh)),iD("design:paramtypes",[Object])],aD);var oD=new gc((function(t){t(aD).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(aD)})).whenTargetNamed(aD.env)})),sD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},lD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},uD=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var cD=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="wx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,a,o){return uD(this,void 0,void 0,f().m((function t(){var s,l,u;return f().w((function(t){for(;;)switch(t.n){case 0:s=wx.getSystemInfoSync().pixelRatio,l=f().m((function t(l){var u;return f().w((function(t){for(;;)switch(t.n){case 0:if(u=e[l],!o&&i.has(u)){t.n=1;break}return t.n=1,new Promise((function(t){var e=wx.createSelectorQuery();a&&(e=e.in(a)),e.select("#".concat(u)).fields({node:!0,size:!0}).exec((function(e){if(e[0]){var a=e[0].node,o=e[0].width,c=e[0].height;a.width=o*s,a.height=c*s,i.set(u,a),l>=n&&r.push(a),t(null)}}))}));case 1:return t.a(2)}}),t)})),u=0;case 1:if(!(u<e.length)){t.n=3;break}return t.d(g(l(u)),2);case 2:u++,t.n=1;break;case 3:return t.a(2)}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component,e.forceUpdate).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return wx.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return jf.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){jf.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(yS);cD=sD([Dc(),lD("design:paramtypes",[])],cD);var hD=new gc((function(t){hD._isWxBound||(hD._isWxBound=!0,t(cD).toSelf().inSingletonScope(),t(ih).toService(cD))}));function dD(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];dD.__loaded||(dD.__loaded=!0,t.load(hD),t.load(tD),t.load(oD),e&&Ww(t))}function pD(t){pD.__loaded||(pD.__loaded=!0,cM(t,!1),Jw(t,!1),vT(t,!1),BT(t),KT(t,!1),dD(t,!1),JC(t),tS.hooks.onSetEnv.tap("loadMathPicker",(function(e,i){"browser"!==i&&Ww(t)})))}function fD(){!function(t){pD(t)}(rh)}hD._isWxBound=!1,dD.__loaded=!1,pD.__loaded=!1;var vD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gD=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(dM);gD.env="tt",gD=vD([Dc()],gD);var yD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_D=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new gD(this,this._dpr)}},{key:"release",value:function(){}}])}(by);_D.env="tt";var bD=NC(_D=yD([Dc(),mD("design:paramtypes",[Object])],_D),gD),xD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},kD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},SD=function(t,e){return function(i,n){e(i,n,t)}},AD=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),CD=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="tt",i.eventManager=new AD,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new _D(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new _D({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(bS);CD.env="tt",CD=xD([Dc(),SD(0,wc(nh)),kD("design:paramtypes",[Object])],CD);var MD=new gc((function(t){t(CD).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(CD)})).whenTargetNamed(CD.env)})),wD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},TD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},DD=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var ED=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="tt",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,a){return DD(this,void 0,void 0,f().m((function t(){var o,s,l;return f().w((function(t){for(;;)switch(t.n){case 0:o=tt.getSystemInfoSync().pixelRatio,s=f().m((function t(s){var l;return f().w((function(t){for(;;)switch(t.n){case 0:return l=e[s],t.n=1,new Promise((function(t){var e=tt.createSelectorQuery();a&&(e=e.in(a)),e.select("#".concat(l)).node().exec((function(e){var a=e[0].node,u=a.width,c=a.height;a.width=u*o,a.height=c*o,i.set(l,a),s>=n&&r.push(a),t(null)}))}));case 1:return t.a(2)}}),t)})),l=0;case 1:if(!(l<e.length)){t.n=3;break}return t.d(g(s(l)),2);case 2:l++,t.n=1;break;case 3:return t.a(2)}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return jf.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){jf.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(yS);ED=wD([Dc(),TD("design:paramtypes",[])],ED);var BD=new gc((function(t){BD.isTTBound||(BD.isTTBound=!0,t(ED).toSelf().inSingletonScope(),t(ih).toService(ED))}));function PD(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];PD.__loaded||(PD.__loaded=!0,t.load(BD),t.load(bD),t.load(MD),e&&Ww(t))}BD.isTTBound=!1,PD.__loaded=!1;var RD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},LD=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;n&&i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b,k=e.keepStrokeScale,S=void 0===k?r.keepStrokeScale:k,A=e.lineDashOffset,C=void 0===A?r.lineDashOffset:A;a.globalAlpha=s*u*this.baseGlobalAlpha,a.lineWidth=S?h:tp(this,h,this.dpr),a.strokeStyle=ep(this,p,t,i,n),a.lineJoin=v,0===y[0]&&0===y[1]||(y&&a.setLineDash(y),a.lineDashOffset=C),a.lineCap=_,a.miterLimit=x}}},{key:"measureText",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,oh.global.devicePixelRatio),_(e,"measureText",this,3)([t,i])}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r,a=t.scaleIn3d,o=void 0===a?e.scaleIn3d:a;r=t.font?t.font:En(t,e,o&&this.camera&&this.camera.getProjectionScale(i)),n.font=(r||"").replace("px","vp");var s=t.fontFamily,l=void 0===s?e.fontFamily:s,u=t.fontSize,c=void 0===u?e.fontSize:u;this.fontFamily=l,this.fontSize=c,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,a=this.nativeContext;e||(e=this.textAttributes);var o;o=t.font?t.font:En(t,e,this.camera&&this.camera.getProjectionScale(i)),a.font=(o||"").replace("px","vp");var s=t.fontFamily,l=void 0===s?e.fontFamily:s,u=t.fontSize,c=void 0===u?e.fontSize:u;this.fontFamily=l,this.fontSize=c,a.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,a.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"createPattern",value:function(t,e){return null}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;e[0].drawImage&&(e[0]=e[0].transferToImageBitmap()),3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"draw",value:function(){}}])}(FC);LD.env="harmony",LD=RD([Dc()],LD);var ID=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},FD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},OD=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new LD(this,this._dpr)}},{key:"resize",value:function(t,e){}},{key:"release",value:function(){}}])}(by);OD.env="harmony",OD=ID([Dc(),FD("design:paramtypes",[Object])],OD);var zD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},HD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ND=function(t,e){return function(i,n){e(i,n,t)}},UD=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),jD=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="harmony",i.eventManager=new UD,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:vc.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new OD(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}this.canvas=new OD({width:i,height:n,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(bS);jD.env="harmony",jD=zD([Dc(),ND(0,wc(nh)),HD("design:paramtypes",[Object])],jD);var VD=new gc((function(t){t(jD).toSelf(),t($p).toDynamicValue((function(t){return t.container.get(jD)})).whenTargetNamed(jD.env)})),WD=NC(OD,LD),GD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},YD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var XD=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="harmony",t.supportEvent=!0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t.rafSTO=new Uf(0),t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getDynamicCanvasCount",value:function(){return 9999}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){return function(t,e,i){var n=new OffscreenCanvas(t,e),r=n.getContext("2d");return new Gw({width:t,height:e,context:r,_c:n,getBoundingClientRect:function(){return{width:t,height:e}},getContext:function(){return r}},r,1,t,e,i)}(t.width,t.height,t.id)}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){var t=this;return function(e){return t.rafSTO.call(e)}}},{key:"getCancelAnimationFrame",value:function(){var t=this;return function(e){t.rafSTO.clear(e)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(yS);XD=GD([Dc(),YD("design:paramtypes",[])],XD);var KD=new gc((function(t){KD.isHarmonyBound||(KD.isHarmonyBound=!0,t(XD).toSelf().inSingletonScope(),t(ih).toService(XD))}));function qD(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];qD.__loaded||(qD.__loaded=!0,t.load(KD),t.load(WD),t.load(VD),e&&Ww(t))}KD.isHarmonyBound=!1,qD.__loaded=!1;var ZD=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},JD=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},QD=function(t,e){return function(i,n){e(i,n,t)}},$D=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc",i.numberType=Ig,i}return h(e,t),o(e)}(DM);$D=ZD([Dc(),QD(0,wc(Dx)),JD("design:paramtypes",[Object])],$D);var tE=!1,eE=new gc((function(t,e,i,n){tE||(tE=!0,t(dC).to($D).inSingletonScope(),t(TC).toService(dC))})),iE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rE=function(t,e){return function(i,n){e(i,n,t)}},aE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(Aw);aE=iE([Dc(),rE(0,wc(zx)),nE("design:paramtypes",[Object])],aE);var oE=!1,sE=new gc((function(t,e,i,n){oE||(oE=!0,t(_C).to(aE).inSingletonScope(),t(TC).toService(_C))})),lE=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;n.highPerformanceSave();var r=t.getGraphicTheme(),a=this.transform(t,r,n),o=a.x,s=a.y,l=a.z,u=a.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,o,s,{},null,(function(t){return!!d||(d=t.isPointInPath(c.x,c.y))}),(function(t,e,i){if(d)return!0;var r=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer,o=e.keepStrokeScale||i.keepStrokeScale;return n.lineWidth=o?r+a:tp(n,r+a,n.dpr),d=t.isPointInStroke(c.x,c.y)})),this.canvasRenderer.z=0,n.modelMatrix!==u&&cy.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}])}(bb),uE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},cE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},hE=function(t,e){return function(i,n){e(i,n,t)}},dE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="line",i.numberType=jg,i}return h(e,t),o(e)}(lE);dE=uE([Dc(),hE(0,wc(Ix)),cE("design:paramtypes",[Object])],dE);var pE=!1,fE=new gc((function(t,e,i,n){pE||(pE=!0,t(yC).to(dE).inSingletonScope(),t(TC).toService(yC))})),vE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},yE=function(t,e){return function(i,n){e(i,n,t)}},mE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="area",i.numberType=Og,i}return h(e,t),o(e)}(DM);mE=vE([Dc(),yE(0,wc(Bx)),gE("design:paramtypes",[Object])],mE);var _E=!1,bE=new gc((function(t,e,i,n){_E||(_E=!0,t(fC).to(mE).inSingletonScope(),t(TC).toService(fC))})),xE=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme();n.highPerformanceSave();var a=this.transform(t,r,n),o=a.x,s=a.y,l=a.z,u=a.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,o,s,i,null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))})),this.canvasRenderer.z=0,n.modelMatrix!==u&&cy.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}])}(bb),kE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},SE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},AE=function(t,e){return function(i,n){e(i,n,t)}},CE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="symbol",i.numberType=qg,i}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getParsedPath();if(!n.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(r.isSvg||"imprecise"===t.attribute.pickMode)return!0}n.highPerformanceSave();var a=t.getGraphicTheme(),o=this.transform(t,a,n),s=o.x,l=o.y,u=o.z,c=o.lastModelMatrix,h=e;if(n.camera){h=e.clone();var d=t.parent.globalTransMatrix;h.x=d.a*e.x+d.c*e.y+d.e,h.y=d.b*e.x+d.d*e.y+d.f}this.canvasRenderer.z=u;var p=!1;return this.canvasRenderer.drawShape(t,n,s,l,{},null,(function(t,e,i){return!!p||(p=t.isPointInPath(h.x,h.y))}),(function(t,e,i){if(p)return!0;var r=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer,o=e.keepStrokeScale||i.keepStrokeScale;return n.lineWidth=o?r+a:tp(n,r+a,n.dpr),p=t.isPointInStroke(h.x,h.y)})),this.canvasRenderer.z=0,n.modelMatrix!==c&&cy.free(n.modelMatrix),n.modelMatrix=c,n.highPerformanceRestore(),p}}])}(xE);CE=kE([Dc(),AE(0,wc(Nx)),SE("design:paramtypes",[Object])],CE);var ME=!1,wE=new gc((function(t,e,i,n){ME||(ME=!0,t(xC).to(CE).inSingletonScope(),t(TC).toService(xC))})),TE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},DE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},EE=function(t,e){return function(i,n){e(i,n,t)}},BE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="circle",i.numberType=zg,i}return h(e,t),o(e)}(DM);BE=TE([Dc(),EE(0,wc(Px)),DE("design:paramtypes",[Object])],BE);var PE=!1,RE=new gc((function(t,e,i,n){PE||(PE=!0,t(vC).to(BE).inSingletonScope(),t(TC).toService(vC))})),LE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},IE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},FE=function(t,e){return function(i,n){e(i,n,t)}},OE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="text",i.numberType=Zg,i}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.AABBBounds;if(!n.camera)return!!r.containsPoint(e);n.highPerformanceSave();var a=t.getGraphicTheme(),o=t.attribute.keepDirIn3d,s=!(void 0===o?a.keepDirIn3d:o),l=this.transform(t,a,n,s),u=l.x,c=l.y,h=l.z,d=l.lastModelMatrix;this.canvasRenderer.z=h;var p=e;if(n.camera){p=e.clone();var f=t.parent.globalTransMatrix;p.x=f.a*e.x+f.c*e.y+f.e,p.y=f.b*e.x+f.d*e.y+f.f}var v=!1;return this.canvasRenderer.drawShape(t,n,u,c,{},null,(function(e,i,n){if(v)return!0;var r=t.attribute,o=r.fontSize,s=void 0===o?a.fontSize:o,l=r.textBaseline,d=void 0===l?a.textBaseline:l,f=r.textAlign,g=void 0===f?a.textAlign:f,y=t.AABBBounds,m=y.height(),_=y.width(),b=Sm(d,m,s),x=km(g,_);return e.rect(x+u,b+c,_,m,h),v=e.isPointInPath(p.x,p.y)}),(function(t,e,i){return v})),this.canvasRenderer.z=0,n.modelMatrix!==d&&cy.free(n.modelMatrix),n.modelMatrix=d,n.highPerformanceRestore(),v}}])}(xE);OE=LE([Dc(),FE(0,wc(Ux)),IE("design:paramtypes",[Object])],OE);var zE=!1,HE=new gc((function(t,e,i,n){zE||(zE=!0,t(kC).to(OE).inSingletonScope(),t(TC).toService(kC))})),NE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},UE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},jE=function(t,e){return function(i,n){e(i,n,t)}},VE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="path",i.numberType=Vg,i}return h(e,t),o(e)}(lE);VE=NE([Dc(),jE(0,wc(Fx)),UE("design:paramtypes",[Object])],VE);var WE=!1,GE=new gc((function(t,e,i,n){WE||(WE=!0,t(mC).to(VE).inSingletonScope(),t(TC).toService(mC))})),YE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},XE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},KE=function(t,e){return function(i,n){e(i,n,t)}},qE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="polygon",i.numberType=Wg,i}return h(e,t),o(e)}(DM);qE=YE([Dc(),KE(0,wc(Ox)),XE("design:paramtypes",[Object])],qE);var ZE=!1,JE=new gc((function(t,e,i,n){ZE||(ZE=!0,t(SC).to(qE).inSingletonScope(),t(TC).toService(SC))})),QE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$E=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},tB=function(t,e){return function(i,n){e(i,n,t)}},eB=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(KM);eB=QE([Dc(),tB(0,wc(Wx)),$E("design:paramtypes",[Object])],eB);var iB=!1,nB=new gc((function(t,e,i,n){iB||(iB=!0,t(MC).to(eB).inSingletonScope(),t(TC).toService(MC))})),rB=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},aB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},oB=function(t,e){return function(i,n){e(i,n,t)}},sB=function(){return o((function t(e){r(this,t),this.canvasRenderer=e,this.type="richtext",this.numberType=Kg}),[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}])}();sB=rB([Dc(),oB(0,wc(jx)),aB("design:paramtypes",[Object])],sB);var lB=!1,uB=new gc((function(t,e,i,n){lB||(lB=!0,t(CC).to(sB).inSingletonScope(),t(TC).toService(CC))})),cB=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},dB=function(t,e){return function(i,n){e(i,n,t)}},pB=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="image",i.numberType=Ug,i}return h(e,t),o(e)}(DM);pB=cB([Dc(),dB(0,wc(Gx)),hB("design:paramtypes",[Object])],pB);var fB=!1,vB=new gc((function(t,e,i,n){fB||(fB=!0,t(gC).to(pB).inSingletonScope(),t(TC).toService(gC))})),gB=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},yB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},mB=function(t,e){return function(i,n){e(i,n,t)}},_B=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="rect3d",i.numberType=Xg,i.themeType="rect",i}return h(e,t),o(e)}(xE);_B=gB([Dc(),mB(0,wc(Hx)),yB("design:paramtypes",[Object])],_B);var bB=!1,xB=new gc((function(t,e,i,n){bB||(bB=!0,t(bC).to(_B).inSingletonScope(),t(TC).toService(bC))})),kB=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},SB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},AB=function(t,e){return function(i,n){e(i,n,t)}},CB=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc3d",i.numberType=Fg,i.themeType="arc",i}return h(e,t),o(e)}(xE);CB=kB([Dc(),AB(0,wc(Ex)),SB("design:paramtypes",[Object])],CB);var MB=!1,wB=new gc((function(t,e,i,n){MB||(MB=!0,t(pC).to(CB).inSingletonScope(),t(TC).toService(pC))})),TB=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},DB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},EB=function(t,e){return function(i,n){e(i,n,t)}},BB=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="pyramid3d",i.numberType=Gg,i.themeType="polygon",i}return h(e,t),o(e)}(xE);BB=TB([Dc(),EB(0,wc(Vx)),DB("design:paramtypes",[Object])],BB);var PB=!1,RB=new gc((function(t,e,i,n){PB||(PB=!0,t(AC).to(BB).inSingletonScope(),t(TC).toService(AC))})),LB=hS();function IB(){IB.__loaded||(IB.__loaded=!0,B_.RegisterGraphicCreator("arc",__),rh.load(GS),rh.load(LB?eE:IM))}IB.__loaded=!1;var FB=IB;function OB(){OB.__loaded||(OB.__loaded=!0,B_.RegisterGraphicCreator("arc3d",x_),kS(),AS(),rh.load(wA),rh.load(wB))}OB.__loaded=!1;var zB=OB;function HB(){HB.__loaded||(HB.__loaded=!0,B_.RegisterGraphicCreator("area",g_),rh.load(JS),rh.load(LB?bE:UM))}HB.__loaded=!1;var NB=HB;function UB(){UB.__loaded||(UB.__loaded=!0,B_.RegisterGraphicCreator("circle",Pm),rh.load(eA),rh.load(LB?RE:XM))}UB.__loaded=!1;var jB=UB;function VB(){VB.__loaded||(VB.__loaded=!0,B_.RegisterGraphicCreator("glyph",Jm),rh.load(hA),rh.load(LB?nB:tw))}VB.__loaded=!1;var WB=VB;function GB(){GB.__loaded||(GB.__loaded=!0,B_.RegisterGraphicCreator("group",Vy))}GB.__loaded=!1;var YB=GB;function XB(){XB.__loaded||(XB.__loaded=!0,B_.RegisterGraphicCreator("image",n_),rh.load(mA),rh.load(LB?vB:rw))}XB.__loaded=!1;var KB=XB;function qB(){qB.__loaded||(qB.__loaded=!0,B_.RegisterGraphicCreator("line",jm),rh.load(qS),rh.load(LB?fE:cw))}qB.__loaded=!1;var ZB=qB;function JB(){JB.__loaded||(JB.__loaded=!0,B_.RegisterGraphicCreator("path",p_),rh.load(aA),rh.load(LB?GE:kw))}JB.__loaded=!1;var QB=JB;function $B(){$B.__loaded||($B.__loaded=!0,B_.RegisterGraphicCreator("polygon",A_),rh.load(sA),rh.load(LB?JE:gw))}$B.__loaded=!1;var tP=$B;function eP(){eP.__loaded||(eP.__loaded=!0,B_.RegisterGraphicCreator("pyramid3d",M_),kS(),AS(),rh.load(BA),rh.load(RB))}eP.__loaded=!1;var iP=eP;function nP(){nP.__loaded||(nP.__loaded=!0,B_.RegisterGraphicCreator("rect",Ym),rh.load(XS),rh.load(LB?sE:Ew))}nP.__loaded=!1;var rP=nP;function aP(){aP.__loaded||(aP.__loaded=!0,B_.RegisterGraphicCreator("rect3d",qm),rh.load(SA),rh.load(xB))}aP.__loaded=!1;var oP=aP;function sP(){sP.__loaded||(sP.__loaded=!0,B_.RegisterGraphicCreator("richtext",c_),rh.load(gA),rh.load(LB?uB:Pw))}sP.__loaded=!1;var lP=sP;function uP(){uP.__loaded||(uP.__loaded=!0,B_.RegisterGraphicCreator("shadowRoot",T_))}uP.__loaded=!1;var cP=uP;function hP(){hP.__loaded||(hP.__loaded=!0,B_.RegisterGraphicCreator("symbol",Hm),rh.load($S),rh.load(LB?wE:zw))}hP.__loaded=!1;var dP=hP;function pP(){pP.__loaded||(pP.__loaded=!0,B_.RegisterGraphicCreator("text",Fm),rh.load(nA),rh.load(LB?HE:jw))}pP.__loaded=!1;var fP=pP;function vP(t){var e=3735928559^(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);return e=(e=3432918353*((e=(2654435769^e)+(e<<6)+(e>>2))^t))<<15|e>>>17,e^=e<<25,e+=e<<9,e^=e>>4,e^=e<<18,((e|=1)>>>0)%2147483647/2147483647}function gP(){YB(),rP()}var yP,mP=-.5*Math.PI,_P=1.5*Math.PI,bP="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol";!function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(yP||(yP={}));var xP=l(l(l(l({},yP.selectedReverse,{}),yP.selected,{}),yP.hover,{}),yP.hoverReverse,{}),kP={container:"",width:30,height:30,style:{}},SP="scrollDrag";function AP(){return"browser"===tS.env?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}var CP={debounce:ve,throttle:ge};gP();var MP=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="scrollbar",a._handleTouchMove=function(t){W(a._prePos)&&t.preventDefault()},a._onRailPointerDown=function(t){var e,i=t.viewX,n=t.viewY,r=a.attribute,o=r.direction,s=r.width,l=r.height,u=r.range,c=a._sliderSize,h=m(a._getScrollRange(),2),d=h[0],p=h[1];if("vertical"===o){var f=n-a._viewPosition.y,v=he(f-c/2,d,p);e=f/l,a._slider.setAttribute("y",v,!0)}else{var g=i-a._viewPosition.x,y=he(g-c/2,d,p);e=g/s,a._slider.setAttribute("x",y,!0)}a.setScrollRange([e-(u[1]-u[0])/2,e+(u[1]-u[0])/2],!1),a.stage&&!a.stage.autoRender&&a.stage.renderNextFrame()},a._onSliderPointerDown=function(t){a._clearDragEvents();var e=a.attribute.stopSliderDownPropagation;(void 0===e||e)&&t.stopPropagation();var i=a.attribute.direction,n=a.stage.eventPointTransform(t),r=n.x,o=n.y;a._prePos="horizontal"===i?r:o,a._dispatchEvent("scrollDown",{pos:a._prePos,event:t});var s=AP(),l="browser"===tS.env?tS:a.stage;l.addEventListener("pointermove",a._onSliderPointerMoveWithDelay,{capture:!0}),s.forEach((function(t){l.addEventListener(t,a._onSliderPointerUp)}))},a._computeScrollValue=function(t){var e,i,n=a.attribute.direction,r=a.stage.eventPointTransform(t),o=r.x,s=r.y,l=a.getSliderRenderBounds(),u=l.width,c=l.height;return"vertical"===n?e=((i=s)-a._prePos)/c:e=((i=o)-a._prePos)/u,[i,e]},a._onSliderPointerMove=function(t){var e=a.attribute.stopSliderMovePropagation;(void 0===e||e)&&t.stopPropagation();var i=a.getScrollRange(),n=m(a._computeScrollValue(t),2),r=n[0],o=n[1];a.setScrollRange([i[0]+o,i[1]+o],!0),a._prePos=r},a._onSliderPointerMoveWithDelay=0===a.attribute.delayTime?a._onSliderPointerMove:CP[a.attribute.delayType](a._onSliderPointerMove,a.attribute.delayTime),a._onSliderPointerUp=function(t){var e=a.attribute,i=e.range,n=e.limitRange,r=void 0===n?[0,1]:n,o=a.getScrollRange(),s=m(a._computeScrollValue(t),2);s[0];var l=s[1],u=[o[0]+l,o[1]+l];a._prePos=null,a._dispatchEvent("scrollUp",{pre:i,value:de(u,r[0],r[1])}),a._clearDragEvents()},a}return h(e,t),o(e,[{key:"setScrollRange",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.attribute,n=i.direction,r=void 0===n?"horizontal":n,a=i.limitRange,o=void 0===a?[0,1]:a,s=i.range,l=i.realTime,u=void 0===l||l,c=de(t,o[0],o[1]);if(e){var h=this._getSliderPos(c);if(this._slider){var d=h[1]-h[0];this._sliderSize=d,"horizontal"===r?this._slider.setAttributes({x:h[0],width:d},!0):this._slider.setAttributes({y:h[0],height:d},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=c,u&&this._dispatchEvent(SP,{pre:s,value:c})}},{key:"getScrollRange",value:function(){return this.attribute.range}},{key:"bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.delayType,i=void 0===e?"throttle":e,n=t.delayTime,r=void 0===n?0:n;this._rail&&this._rail.addEventListener("pointerdown",CP[i](this._onRailPointerDown,r)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),("browser"===tS.env?tS:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}}},{key:"render",value:function(){this._reset();var t=this.attribute,e=t.direction,i=void 0===e?"horizontal":e,n=t.width,r=t.height,a=t.range,o=t.limitRange,s=void 0===o?[0,1]:o,l=t.railStyle,u=t.sliderStyle,c=t.padding,h=void 0===c?2:c,d=this.createOrUpdateChild("scrollbar-container",{},"group"),p=d.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:n,height:r},l),"rect");this._rail=p;var f,v=this.getSliderRenderBounds(),g=this._getSliderPos(de(a,s[0],s[1])),y=g[1]-g[0];this._sliderSize=y,f="horizontal"===i?{x:g[0],y:v.y1,width:y,height:v.height}:{x:v.x1,y:g[0],width:v.width,height:y};var m=d.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},f),{cornerRadius:this._getDefaultSliderCornerRadius()}),u),{boundsPadding:rr(h),pickMode:"imprecise"}),"rect");this._slider=m,this._container=d;var _=this._container.AABBBounds;this._viewPosition={x:_.x1,y:_.y1}}},{key:"getSliderRenderBounds",value:function(){if(this._sliderRenderBounds)return this._sliderRenderBounds;var t=this.attribute,e=t.width,i=t.height,n=t.padding,r=m(rr(void 0===n?2:n),4),a=r[0],o=r[1],s=r[2],l=r[3],u={x1:l,y1:a,x2:e-o,y2:i-s,width:Math.max(0,e-(l+o)),height:Math.max(0,i-(a+s))};return this._sliderRenderBounds=u,u}},{key:"_getDefaultSliderCornerRadius",value:function(){var t=this.attribute,e=t.direction;if(t.round){var i=this.getSliderRenderBounds(),n=i.width,r=i.height;return"horizontal"===e?r:n}return 0}},{key:"_getSliderPos",value:function(t){var e=this.attribute.direction,i=this.getSliderRenderBounds(),n=i.width,r=i.height,a=i.x1,o=i.y1;return"horizontal"===e?[n*t[0]+a,n*t[1]+a]:[r*t[0]+o,r*t[1]+o]}},{key:"_getScrollRange",value:function(){if(this._sliderLimitRange)return this._sliderLimitRange;var t=this.attribute,e=t.limitRange,i=void 0===e?[0,1]:e,n=t.direction,r=m(de(i,0,1),2),a=r[0],o=r[1],s=this.getSliderRenderBounds(),l=s.width,u=s.height,c=s.x1,h=s.y1,d=this._sliderSize;return"horizontal"===n?de([c+a*l,c+o*l],c,l-d):de([h+a*u,h+o*u],h,u-d)}},{key:"_clearDragEvents",value:function(){var t=this,e=AP(),i="browser"===tS.env?tS:this.stage;i.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onSliderPointerUp)}))}},{key:"_reset",value:function(){this._sliderRenderBounds=null,this._sliderLimitRange=null}},{key:"release",value:function(t){_(e,"release",this,3)([t]),("browser"===tS.env?tS:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}])}($A);MP.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};var wP,TP=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},DP=wP=function(){return o((function t(){var e=this;r(this,t),this.name="scrollbar",this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=function(t){var i,n,r=t.target,a=e.getScrollContainer(r);if(a||e.scrollContainer){if(!a&&e.scrollContainer){if(!e.scrollContainer.g.stage||e.scrollContainer.g.stage!==r.stage)return;var o=e.formatScrollContainer(e.scrollContainer.g);if(!o)return void e.clearScrollbar(e.scrollContainer.g,"all");e.scrollContainer.showH&&!o.showH&&e.clearScrollbar(e.scrollContainer.g,"horizontal"),e.scrollContainer.showV&&!o.showV&&e.clearScrollbar(e.scrollContainer.g,"vertical"),e.scrollContainer=o}else a&&e.scrollContainer&&a.g!==e.scrollContainer.g&&e.clearScrollbar(e.scrollContainer.g,"all");if(e.scrollContainer=null!=a?a:e.scrollContainer,a){var s=a.g;if(s){var l=s.attribute,u=l.width,c=l.height,h=l.scrollX,d=void 0===h?0:h,p=l.scrollY,f=void 0===p?0:p,v=d,g=f,y=a.showH,m=a.showV;e.scrollContainerBounds=(new Fn).set(0,0,s.attribute.width,s.attribute.height),y&&y&&(ii(t.deltaX)>ii(t.deltaY)?(y=y&&!0,m=m&&!1):(y=y&&!1,m=m&&!0));var _=e.childrenBounds.width(),b=e.childrenBounds.height();y&&((v=d-(null!==(i=t.deltaX)&&void 0!==i?i:0))>0?v=0:v<u-_&&(v=u-_)),m&&((g=f-(null!==(n=t.deltaY)&&void 0!==n?n:0))>0?g=0:g<c-b&&(g=c-b)),s.setAttributes({scrollX:v,scrollY:g}),e.addOrUpdateScroll(y,m,s.parent,s)}}}},this.handleScrollBarChange=function(t){if(e.scrollContainer&&e.scrollContainerBounds&&e.childrenBounds&&t&&t.target&&t.detail&&t.detail.value){var i=t.target,n=t.detail.value;if("horizontal"===i.attribute.direction){var r=e.childrenBounds.width();e.scrollContainer.g.setAttributes({scrollX:-n[0]*r})}else{var a=e.childrenBounds.height();e.scrollContainer.g.setAttributes({scrollY:-n[0]*a})}}}}),[{key:"activate",value:function(t){this.pluginService=t;var e=this.pluginService.stage;this.childrenBounds=new On,e.addEventListener("wheel",this.scroll),this.params=wP.defaultParams}},{key:"initEventOfScrollbar",value:function(t,e,i){t.addEventListener("pointerover",(function(){e.setAttribute("visibleAll",!0)})),t.addEventListener("pointermove",(function(){e.setAttribute("visibleAll",!0)})),t.addEventListener("pointerout",(function(){e.setAttribute("visibleAll",!1)})),e.addEventListener("pointerover",(function(){e.setAttribute("visibleAll",!0)})),e.addEventListener("pointerout",(function(){e.setAttribute("visibleAll",!0)})),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(SP,this.handleScrollBarChange)}},{key:"addOrUpdateScroll",value:function(t,e,i,n){if(t){var r=this.addOrUpdateHScroll(n,i,!0),a=r.scrollBar;r.isUpdate||this.initEventOfScrollbar(n,a,!0)}else this.clearScrollbar(n,"horizontal");if(e){var o=this.addOrUpdateHScroll(n,i,!1),s=o.scrollBar;o.isUpdate||this.initEventOfScrollbar(n,s,!1)}else this.clearScrollbar(n,"vertical")}},{key:"getDirection",value:function(t){return t?"horizontal":"vertical"}},{key:"addOrUpdateHScroll",value:function(t,e,i){var n,r,a=this.getDirection(i),o="".concat(null!==(n=t.name)&&void 0!==n?n:t._uid,"_").concat(this.getDirection(i),"_").concat(this.name),s=e.children.filter((function(t){return t.name===o})),l=!0,u=s[0],c=this.scrollContainer.g.attribute,h=c.y,d=void 0===h?0:h,p=c.dy,f=void 0===p?0:p,v=c.x,g=void 0===v?0:v,y=c.dx,m=void 0===y?0:y,_=c.height,b=c.width,x=c.zIndex,k={x:0,y:0,direction:a,zIndex:(void 0===x?0:x)+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(k.width=this.scrollContainerBounds.width(),k.height=12):(k.height=this.scrollContainerBounds.height(),k.width=12),u?s.length>1&&s.forEach((function(t,e){var i;e&&(null===(i=t.parent)||void 0===i||i.removeChild(t))})):(l=!1,(u=new MP(k)).name=o,e.add(u),u.isScrollBar=!0);var S=this.childrenBounds,A=t.attribute,C=A.scrollX,M=A.scrollY;if(i){var w=Math.min(this.scrollContainerBounds.width()/S.width(),1),T=Math.max(Math.min(C/this.childrenBounds.width(),0),w-1);k.x=g+m,k.y=d+f+_-(null!==(r=k.height)&&void 0!==r?r:0),k.range=[-T,-T+w]}else{var D=Math.min(this.scrollContainerBounds.height()/S.height(),1),E=Math.max(Math.min(M/this.childrenBounds.height(),0),D-1);k.x=g+m+b-this.scrollContainerBounds.width(),k.y=d+f,k.range=[-E,-E+D]}return u.setAttributes(k),{scrollBar:u,isUpdate:l}}},{key:"clearScrollbar",value:function(t,e){t.parent&&t.parent.children.filter((function(t){return t.isScrollBar&&("all"===e||t.attribute.direction===e)})).forEach((function(t){t.parent.removeChild(t)}))}},{key:"formatScrollContainer",value:function(t){if(!t||"group"!==t.type||!t.attribute)return null;var e=t.attribute,i=e.overflow,n=e.width,r=e.height;if(!i||"hidden"===i)return null;var a=!1,o=!1;"scroll"===i?(a=!0,o=!0):o=!(a="scroll-x"===i);var s=this.childrenBounds;return s.clear(),t.forEachChildren((function(t){s.union(t.AABBBounds)})),t.AABBBounds.empty()||(a&&(a=n<s.width()),o&&(o=r<s.height())),a||o?{g:t,showH:a,showV:o}:null}},{key:"getScrollContainer",value:function(t){for(var e=t;e;){var i=this.formatScrollContainer(e);if(i)return i;e=e.parent}return null}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("wheel",this.scroll)}}])}();DP.defaultParams={timeout:500},DP=wP=TP([Dc()],DP);var EP=new gc((function(t,e,i,n){i(DP)||(t(DP).toSelf(),t(bk).toService(DP))}));function BP(t,e){t.forEachChildren((function(t){var i=e(t);t.isContainer&&!i&&BP(t,e)}))}var PP=function(t){return!j(t)&&!1!==t.visible};function RP(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function LP(t,e,i){return Math.abs(t-e)<i}function IP(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}var FP=["#ffffff","#000000"];function OP(t,e,i,n,r,a){if("string"!=typeof t||"string"!=typeof e)return t;var o=new Qn(t).toHex(),s=new Qn(e).toHex();return zP(o,s,i,n,a)?o:function(t,e,i,n,r,a){var o=[];r&&(r instanceof Array?o.push.apply(o,b(r)):o.push(r)),o.push.apply(o,FP);for(var s=0,l=o;s<l.length;s++){var u=l[s];if(t!==u&&zP(u,e,i,n,a))return u}}(o,s,i,n,r,a)}function zP(t,e,i,n,r){if("lightness"===r){var a=Qn.getColorBrightness(new Qn(e));return Qn.getColorBrightness(new Qn(t))<.5?a>=.5:a<.5}return n?HP(t,e)>n:"largeText"===i?HP(t,e)>3:HP(t,e)>4.5}function HP(t,e){var i=NP(t),n=NP(e);return((i>n?i:n)+.05)/((i>n?n:i)+.05)}function NP(t){var e=tr(t),i=e[0]/255,n=e[1]/255,r=e[2]/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}function UP(t,e,i,n){var r;switch(t){case"base":r=e;break;case"invertBase":r=i;break;case"similarBase":r=n}return r}function jP(t,e){return[t[0]*e,t[1]*e]}function VP(t){var e=m(t,2),i=e[0],n=e[1];return Math.sqrt(i*i+n*n)}function WP(t,e,i){var n=function(t,e){var i=m(t,2),n=i[0],r=i[1],a=m(e,2),o=a[0],s=a[1],l=Math.sqrt((n*n+r*r)*(o*o+s*s)),u=l&&(n*o+r*s)/l;return Math.acos(Math.min(Math.max(u,-1),1))}(t,e),r=fi(t,e)>=0;return i?r?2*Math.PI-n:n:r?n:2*Math.PI-n}var GP=function(t,e,i,n){return new Bn(Object.assign({defaultFontParams:Object.assign({fontFamily:bP,fontSize:14},n),getTextBounds:i?void 0:P_,specialCharSet:"-/: .,@%'\"~"+Bn.ALPHABET_CHAR_SET+Bn.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)};function YP(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return{width:0,height:0};var n=P_({text:t,fontFamily:e.fontFamily||i.fontFamily||bP,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:n.width(),height:n.height()}}function XP(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type";return G(t.text)&&"type"in t.text?null!==(e=t.text.type)&&void 0!==e?e:"text":n in t&&null!==(i=t[n])&&void 0!==i?i:"text"}function KP(t){var e,i;return W(t.maxLineWidth)&&(t.maxWidth=t.maxLineWidth,delete t.maxLineWidth),t.width=null!==(e=t.width)&&void 0!==e?e:0,t.height=null!==(i=t.height)&&void 0!==i?i:0,t.textConfig=t.text.text||t.text,t}function qP(t){var e=XP(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type");return"rich"===e?B_.richtext(KP(t)):("html"===e?t=function(t){var e=t.text,i=t._originText,n=e.text;return t.html=n,t.text=i,t.renderable=!1,t}(t):"react"===e&&(t=function(t){var e=t.text,i=t._originText,n=e.text;return t.react=n,t.text=i,t.renderable=!1,t}(t)),B_.text(t))}function ZP(t,e,i,n,r){"right"===t?"center"===i?e.setAttribute("x",n-r/2):"right"===i||"end"===i?e.setAttribute("x",n):e.setAttribute("x",n-r):"center"===i?e.setAttribute("x",n+r/2):"right"===i||"end"===i?e.setAttribute("x",n+r):e.setAttribute("x",n)}var JP=function(t,e){var i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function QP(t,e){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=t.AABBBounds,s=o.x1,l=o.y1,u=o.x2,c=o.y2,h=0,d=0;return s<i&&(h=i-s),l<n&&(d=n-l),u>r&&(h=r-u),c>a&&(d=a-c),{dx:h,dy:d}}function $P(t,e){var i=QP(t,e),n=i.dx,r=i.dy,a=t.attribute,o=a.dx,s=void 0===o?0:o,l=a.dy,u=void 0===l?0:l;n&&t.setAttribute("dx",n+s),r&&t.setAttribute("dy",r+u)}function tR(){YB(),rP(),dP(),lP(),fP()}var eR=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};tR();var iR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="tag",a._tagStates=[],a._rectStates=[],a._symbolStates=[],a._textStates=[],a}return h(e,t),o(e,[{key:"getBgRect",value:function(){return this._bgRect}},{key:"getTextShape",value:function(){return this._textShape}},{key:"render",value:function(){var t,e,i,n=this;this.cacheStates();var r,a,o,s,l=this.attribute,u=l.text,c=void 0===u?"":u,h=l.textStyle,d=void 0===h?{}:h,p=l.shape,f=void 0===p?{}:p,v=l.panel,g=void 0===v?{}:v,y=l.space,m=void 0===y?4:y,_=l.minWidth,b=l.maxWidth,x=l.padding,k=void 0===x?4:x,S=l.visible,A=l.state,C=l.type,M=l.textAlwaysCenter,w=l.containerTextAlign,T=rr(k),D=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),E=-T[3],B=-T[0],P=T[1]+T[3],R=T[0]+T[2],L=0,I=0,F=f.visible,O=eR(f,["visible"]);if(N(F)){var z=(null==O?void 0:O.size)||10,H=$(z)?z:Math.max(z[0],z[1]);r=D.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:z,strokeBoundsBuffer:0},O),{visible:F,x:H/2,y:H/2}),"symbol"),ct(null==A?void 0:A.shape)||(r.states=A.shape),F&&(I=H+m)}if(P+=I,L+=I,function(t){return"rich"===XP(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type")}({text:c})||"rich"===C){var U=Object.assign(Object.assign(Object.assign({},KP(Object.assign({type:C,text:c},d))),d),{visible:W(c)&&!1!==S,x:L,y:0});j(U.lineHeight)&&(U.lineHeight=d.fontSize),o=(a=D.createOrUpdateChild("tag-text",U,"richtext")).AABBBounds.width(),s=a.AABBBounds.height()}else{var V=Object.assign(Object.assign({text:G(c)&&"type"in c&&"text"===c.type?c.text:c,visible:W(c)&&!1!==S,lineHeight:null==d?void 0:d.fontSize},d),{x:L,y:0});j(V.lineHeight)&&(V.lineHeight=d.fontSize),a=D.createOrUpdateChild("tag-text",V,"text");var Y=YP(V.text,d,null===(e=null===(t=this.stage)||void 0===t?void 0:t.getTheme())||void 0===e?void 0:e.text);o=Y.width,s=Y.height}P+=o;var X=null!==(i=f.size)&&void 0!==i?i:10,K=$(X)?X:Math.max(X[0],X[1]);R+=Math.max(s,f.visible?K:0);var q=d.textAlign,Z=d.textBaseline;(W(_)||W(b))&&(W(_)&&P<_&&(P=_),W(b)&&P>b&&(P=b,a.setAttribute("maxLineWidth",b-T[1]-T[2]))),E=0,B=0;var J=0;"left"===q||"start"===q?J=1:"right"===q||"end"===q?J=-1:"center"===q&&(J=0),J?J<0?(E-=P,r&&r.setAttribute("x",(r.attribute.x||0)-o),D.setAttribute("x",-T[1]-I)):J>0&&D.setAttribute("x",T[3]):(E-=P/2,r&&r.setAttribute("x",(r.attribute.x||0)-o/2),D.setAttribute("x",-I/2));var Q="right"===w||"end"===w,tt="left"===w||"start"===w,et=function(t,e){"richtext"===a.type?a.setAttributes({x:t,textAlign:e,textConfig:Dt(a.attribute.textConfig).map((function(t){return Object.assign(Object.assign({},t),{textAlign:e})}))}):a.setAttributes({x:t,textAlign:e})};if((w?"center"===w:M)&&J){var it=P-T[1]-T[3],nt=o+I,rt=1===J?(it-nt)/2+I+o/2:T[0]+I-(P/2+nt/2-I)+o/2;if(et(rt,"center"),r){var at=rt-o/2-I+K/2;r.setAttributes({x:at})}}if(tt&&1!==J){var ot=P-T[1]-T[3],st=0===J?-ot/2+I/2:-P+T[3]+T[1]+I;if(et(st+I,"left"),r){var lt=st+K/2;r.setAttributes({x:lt})}}if(Q&&-1!==J){var ut=P-T[1]-T[3],ht=0===J?ut/2+I/2:ut;if(et(ht,"right"),r){var dt=ht-o-I+K/2;r.setAttributes({x:dt})}}"middle"===Z?(B-=R/2,r&&r.setAttribute("y",0)):"bottom"===Z?(B-=R,r&&r.setAttribute("y",-s/2),D.setAttribute("y",-T[2])):"top"===Z&&(D.setAttribute("y",T[0]),r&&r.setAttribute("y",s/2)),ct(null==A?void 0:A.text)||(a.states=A.text);var pt=g.visible,ft=eR(g,["visible"]);if(S&&N(pt)){var vt=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},ft),{visible:pt&&!!c,width:P,height:R,x:E,y:B}),"rect");if(ct(null==A?void 0:A.panel)||(vt.states=A.panel),ft.customShape){var gt=ft.customShape;vt.pathProxy=function(t){return gt(n,t,new Md)}}this._bgRect=vt}this._textShape=a,this._symbol=r,this.resetStates()}},{key:"initAttributes",value:function(t,i){t=(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t),_(e,"initAttributes",this,3)([t]),this.render()}},{key:"addState",value:function(t,i,n){_(e,"addState",this,3)([t,i,n]),this._textShape&&this._textShape.addState(t,i,n),this._bgRect&&this._bgRect.addState(t,i,n),this._symbol&&this._symbol.addState(t,i,n)}},{key:"removeState",value:function(t,i){_(e,"removeState",this,3)([t,i]),this._textShape&&this._textShape.removeState(t,i),this._bgRect&&this._bgRect.removeState(t,i),this._symbol&&this._symbol.removeState(t,i)}},{key:"cacheStates",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p;this._tagStates=null!==(e=null===(t=this.currentStates)||void 0===t?void 0:t.slice())&&void 0!==e?e:[],this._rectStates=null!==(r=null===(n=null===(i=this._bgRect)||void 0===i?void 0:i.currentStates)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],this._symbolStates=null!==(s=null===(o=null===(a=this._symbol)||void 0===a?void 0:a.currentStates)||void 0===o?void 0:o.slice())&&void 0!==s?s:[],this._textStates=null!==(c=null===(u=null===(l=this._textShape)||void 0===l?void 0:l.currentStates)||void 0===u?void 0:u.slice())&&void 0!==c?c:[],this.clearStates(),null===(h=this._bgRect)||void 0===h||h.clearStates(),null===(d=this._symbol)||void 0===d||d.clearStates(),null===(p=this._textShape)||void 0===p||p.clearStates()}},{key:"resetStates",value:function(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&(null===(t=this._bgRect)||void 0===t||t.useStates(this._rectStates)),this._symbolStates.length&&(null===(e=this._symbol)||void 0===e||e.useStates(this._symbolStates)),this._textStates.length&&(null===(i=this._textShape)||void 0===i||i.useStates(this._textStates))}}])}($A);iR.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};var nR={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},rR={poptip:mt({},nR)};var aR=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},oR=new On;YB(),fP(),dP(),rP();var sR="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",lR="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",uR="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",cR="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",hR={tl:sR,tr:uR,bl:lR,br:cR,lt:sR,lb:lR,rt:uR,rb:cR},dR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="poptip",a.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"],a}return h(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u=this.attribute,c=u.titleStyle,h=void 0===c?{}:c,d=u.position,p=u.contentStyle,f=void 0===p?{}:p,v=u.panel,g=u.logoSymbol,y=u.poptipAnchor,m=void 0===y?"position":y,_=u.logoText,b=u.logoTextStyle,x=void 0===b?{}:b,k=u.triangleMode,S=void 0===k?"default":k,A=u.space,C=void 0===A?4:A,M=u.minWidth,w=void 0===M?0:M,T=u.maxWidth,D=void 0===T?1/0:T,E=u.padding,B=void 0===E?4:E,P=u.maxWidthPercent,R=u.visible,L=u.state,I=u.dx,F=void 0===I?0:I,O=u.dy,z=void 0===O?0:O,H=u.positionBounds,U=this.attribute,j=U.title,V=void 0===j?"":j,G=U.content,Y=void 0===G?"":G;V=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(V):V,Y=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(Y):Y;var X=rr(B),K=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=K;var q=D-X[1]-X[3],J=W(V)&&!1!==R,Q=Object.assign(Object.assign({text:Z(V)?V:[V],visible:J,wrap:!0},h),{x:X[3],y:X[0],maxLineWidth:q,textAlign:"left",textBaseline:"top"}),$=K.createOrUpdateChild("poptip-title",Q,"text");ct(null==L?void 0:L.title)||($.states=L.title);var tt=$.AABBBounds,et=tt.height(),it=tt.width(),nt=et+C;J||(nt=0);var rt=W(Y)&&!1!==R,at=Object.assign(Object.assign({text:Z(Y)?Y:[Y],visible:rt,wrap:!0},f),{x:X[3],y:X[0]+nt,maxLineWidth:q,textAlign:"left",textBaseline:"top"}),ot=K.createOrUpdateChild("poptip-content",at,"text");ct(null==L?void 0:L.content)||(ot.states=L.content);var st=ot.AABBBounds,lt=st.height(),ut=st.width();rt&&(nt+=lt),this.titleShape=$,this.contentShape=ot;var ht=ai(it+X[1]+X[3],ut+X[1]+X[3]);ht>D?ht=D:ht<w&&(ht=w);var dt=X[0]+X[2]+nt,pt=v.visible,ft=v.square,vt=aR(v,["visible","square"]);if(ft){var gt=ai(ht,dt);ht=gt;var yt=gt-dt;dt=gt,$.setAttributes({dy:yt/2}),ot.setAttributes({dy:yt/2})}var mt=null!==(t=vt.size)&&void 0!==t?t:12,_t=Z(mt)?[mt[0]+(null!==(e=vt.space)&&void 0!==e?e:0),mt[1]+(null!==(i=vt.space)&&void 0!==i?i:0)]:mt+(null!==(n=vt.space)&&void 0!==n?n:0),bt=null!==(r=vt.lineWidth)&&void 0!==r?r:1,xt=this.stage?[null!==(a=this.stage.viewWidth)&&void 0!==a?a:this.stage.width,null!==(o=this.stage.viewHeight)&&void 0!==o?o:this.stage.height]:void 0;if(xt){var kt=this.AABBBounds,St=null!==(s=this.attribute.x)&&void 0!==s?s:kt.x1,At=xt[0]-kt.x1,Ct=Math.max(St,At),Mt=(Z(mt)?mt[0]:12)+3;if((Ct=Math.min(Ct-Mt,Ct*P))<ht){ht=Ct;var wt=X[1]+X[3];$.setAttribute("maxLineWidth",Ct-wt),ot.setAttribute("maxLineWidth",Ct-wt),dt=X[0]+X[2],J&&(dt+=$.AABBBounds.height()+C),dt+=ot.AABBBounds.height()}}for(var Tt,Dt="auto"===d||Z(d),Et=Z(d)?d:this.positionList,Bt=-1/0,Pt=0;Pt<Et.length+1;Pt++){var Rt=Dt?Et[Pt===Et.length?Tt:Pt]:d,Lt="arrow2Left",It=(Z(mt)?mt[0]:mt)/4,Ft=0;"top"===Rt||"bottom"===Rt||"left"===Rt||"right"===Rt?Lt="arrow2Left":"concise"===S&&(Lt=hR[Rt],It=["tl","bl","rt","rb"].includes(Rt)?(Z(mt)?mt[0]:mt)/2:-(Z(mt)?mt[0]:mt)/2,Ft=["tl","tr","lb","rb"].includes(Rt)?-(Z(mt)?mt[1]:mt)/2:(Z(mt)?mt[1]:mt)/2);var Ot=this.getAngleAndOffset(Rt,ht,dt,Z(_t)?_t:[_t,_t-bt],Lt),zt=Ot.angle,Ht=Ot.offset,Nt=void 0,Ut={x:0,y:0};if("bounds"===m&&H&&(Ut=this.calculateAnchorPoint(Rt,H)),N(pt)){var jt=void 0;Nt=K.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:It,y:Ft,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:Lt,angle:zt,dx:Ht[0],dy:Ht[1]-(null!==(l=vt.space)&&void 0!==l?l:0),size:mt,zIndex:9}),"symbol"),ct(null==L?void 0:L.panel)||(Nt.states=L.panel),jt=v.panelSymbolType?K.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:0,y:0,symbolType:"rect",size:[ht,dt],zIndex:-8}),"symbol"):K.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:0,y:0,width:ht,height:dt,zIndex:-8}),"rect"),ct(null==L?void 0:L.panel)||(jt.states=L.panel)}if(K.setAttributes({x:-Ht[0]+F+Ut.x,y:-Ht[1]+z+Ut.y,anchor:[It,Ft]}),g){var Vt=g.size,Wt=void 0===Vt?12:Vt,Gt=Z(Wt)?Wt:[Wt,Wt];"auto"===Gt[1]&&(Gt[1]=dt),"auto"===Gt[0]&&(Gt[0]=dt);var Yt=Gt[0];K.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},g),{x:0,y:dt/2,visible:pt&&(rt||J),zIndex:10,size:Gt}),"symbol"),K.setAttributes({x:-Ht[0]+F+Yt/2,y:-Ht[1]+z}),_&&K.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},x),{x:0,y:dt/2,visible:pt&&(rt||J),text:_,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!xt)break;oR.setValue(0,0,ht,dt).transformWithMatrix(K.globalTransMatrix);var Xt=oR,Kt=(new Fn).setValue(0,0,xt[0],xt[1]);if(Dt){if(nn(Xt,Kt,!1))break;var qt=ji(Xt,Kt,!1),Zt=(qt.x2-qt.x1)*(qt.y2-qt.y1);Zt>Bt&&(Bt=Zt,Tt=Pt)}if(["top","bottom","left","right"].includes(Rt)){var Jt="top"===Rt||"bottom"===Rt,Qt="left"===Rt||"right"===Rt,$t=!1;if(Jt?$t="top"===Rt&&Xt.y1<0||"bottom"===Rt&&Xt.y2>Kt.y2:Qt&&($t="left"===Rt&&Xt.x1<0||"right"===Rt&&Xt.x2>Kt.x2),!$t){var te=0,ee=(Z(mt)?mt[1]:mt)/2;Jt?(Xt.x1<0?te=-Xt.x1:Xt.x2>Kt.x2&&(te=Kt.x2-Xt.x2),K.setAttribute("x",K.attribute.x+te),Nt.setAttribute("dx",oi(ai(Nt.attribute.dx-te,ee),Xt.width()-ee))):Qt&&(Xt.y1<0?te=-Xt.y1:Xt.y2>Kt.y2&&(te=Kt.y2-Xt.y2),K.setAttribute("y",K.attribute.y+te),Nt.setAttribute("dy",oi(ai(Nt.attribute.dy-te,ee),Xt.height()-ee)));break}}if(!Dt)break}}},{key:"calculateAnchorPoint",value:function(t,e){if(!e)return{x:0,y:0};var i=this.attribute,n=i.x,r=i.y,a=e.x1,o=e.y1,s=e.x2,l=e.y2,u=s-a,c=l-o;switch(t){case"top":case"tl":case"tr":return{x:a+u/2-n,y:o-r};case"bottom":case"bl":case"br":return{x:a+u/2-n,y:l-r};case"left":case"lt":case"lb":return{x:a-n,y:o+c/2-r};case"right":case"rt":case"rb":return{x:s-n,y:o+c/2-r};default:return{x:0,y:0}}}},{key:"getAngleAndOffset",value:function(t,e,i,n,r){var a="arrow2Left"===r?n[1]/2:n[1];switch(t){case"tl":return{angle:"arrow2Left"===r?Qe/2*3:0,offset:"arrow2Left"===r?[e/4,i+a]:[0,i+a]};case"top":return{angle:Qe/2*3,offset:[e/2,i+a]};case"tr":return{angle:"arrow2Left"===r?Qe/2*3:0,offset:"arrow2Left"===r?[e/4*3,i+a]:[e,i+a]};case"rt":return{angle:0,offset:"arrow2Left"===r?[-a,i/5]:[-a,0]};case"right":return{angle:0,offset:[-a,i/2]};case"rb":return{angle:0,offset:"arrow2Left"===r?[-a,i/5*4]:[-a,i]};case"bl":return{angle:"arrow2Left"===r?Qe/2:0,offset:"arrow2Left"===r?[e/4,-a]:[0,-a]};case"bottom":return{angle:Qe/2,offset:[e/2,-a]};case"br":return{angle:"arrow2Left"===r?Qe/2:0,offset:"arrow2Left"===r?[e/4*3,-a]:[e,-a]};case"lt":return{angle:"arrow2Left"===r?Qe:0,offset:"arrow2Left"===r?[e+a,i/5]:[e+a,0]};case"left":return{angle:Qe,offset:[e+a,i/2]};case"lb":return{angle:"arrow2Left"===r?Qe:0,offset:"arrow2Left"===r?[e+a,i/5*4]:[e+a,i]}}}}])}($A);dR.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var pR=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};var fR=function(){return o((function t(){r(this,t)}),[{key:"render",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f;if(1===t._showPoptip){var v=t.attribute.poptip||{},g=v.visible,y=v.visibleCb;if(!1===g||y&&!1===y(t))return;var m={};mt(m,dR.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(m):this.poptipComponent=new dR(m);var _=t.attribute.poptip||{};if("text"===t.type&&null==_.title&&null==_.content){var b={};mt(b,rR.poptip,_),(_=b).content=null!==(p=_.content)&&void 0!==p?p:t.attribute.text}var x=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},_),{x:x.e,y:x.f,positionBounds:t.globalAABBBounds})),u.stage.tryInitInteractiveLayer();var k=u.stage.getLayer("_builtin_interactive");k&&k.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),null===(f=this.poptipComponent.parent)||void 0===f||f.removeChild(this.poptipComponent),this.poptipComponent=null))}}])}();fR=pR([Dc()],fR);var vR=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gR=function(){return o((function t(){var e=this;r(this,t),this.activeEvent="onRegister",this._uid=vc.GenAutoIncrementId(),this.poptip=function(t){var i=t.target;e.needHide(i)?e.unpoptip(t):i!==e.activeGraphic&&(e.needShow(i)&&(i.setAttributes({}),i._showPoptip=1),e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2),e.setActiveGraphic(i,!0))},this.unpoptip=function(t){e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2,e.setActiveGraphic(null,!0))}}),[{key:"activate",value:function(t){this.pluginService=t,this.pluginService.stage.addEventListener("pointerover",this.poptip)}},{key:"needHide",value:function(t){return t.isContainer||!t.attribute}},{key:"needShow",value:function(t){return!!t.attribute.poptip}},{key:"setActiveGraphic",value:function(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("pointerover",this.poptip)}}])}(),yR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="poptip",t.key=t.name+t._uid,t}return h(e,t),o(e)}(gR);yR=vR([Dc()],yR);var mR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="poptipForText",t.key=t.name+t._uid,t.pointerlave=function(e){var i=t.pluginService.stage;e.target===i&&t.unpoptip(e)},t}return h(e,t),o(e,[{key:"activate",value:function(t){_(e,"activate",this,3)([t]),this.pluginService.stage.addEventListener("pointerleave",this.pointerlave)}},{key:"needHide",value:function(t){return"text"!==t.type||!t.cliped||t.isContainer||!t.attribute||t.attribute.disableAutoClipedPoptip}},{key:"needShow",value:function(t){return!0}},{key:"deactivate",value:function(t){var i=this.pluginService.stage;_(e,"deactivate",this,3)([t]),i.removeEventListener("pointerleave",this.pointerlave)}}])}(gR);mR=vR([Dc()],mR);var _R=new gc((function(t,e,i,n){i(fR)||(t(fR).toSelf().inSingletonScope(),t(xm).toService(fR)),i(yR)||(t(yR).toSelf(),t(bk).toService(yR)),i(mR)||(t(mR).toSelf(),t(bk).toService(mR))}));var bR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="crosshair",t}return h(e,t),o(e,[{key:"render",value:function(){this.renderCrosshair(this)}}])}($A);YB(),ZB();var xR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.lineStyle;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[i,n]},r),"line")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}])}(bR);xR.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},YB(),rP();var kR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.rectStyle;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:i.x,y:i.y,width:n.x-i.x,height:n.y-i.y},r),"rect")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}])}(bR);kR.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}},YB(),FB();var SR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.lineStyle;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},i),{outerRadius:n}),this.attribute),r),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=Si.distancePP(t,e);this.setAttribute("radius",i)}}])}(bR);SR.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}},YB(),FB();var AR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.innerRadius,a=void 0===r?0:r,o=e.sectorStyle,s=this.attribute,l=s.startAngle,u=s.endAngle;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},i),{outerRadius:n,innerRadius:a,startAngle:l,endAngle:u}),o),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute,i=e.center,n=e.startAngle,r=void 0===n?mP:n,a=e.endAngle,o=(void 0===a?_P:a)-r,s=Mi(Li(i,t));this.setAttributes({startAngle:s-o/2,endAngle:s+o/2})}}])}(bR);AR.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},YB(),QB();var CR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){for(var e,i=this.attribute,n=i.center,r=i.radius,a=i.sides,o=void 0===a?6:a,s=i.lineStyle,l=this.attribute,u=l.startAngle,c=l.endAngle,h=(c-u)%(2*Math.PI)==0,d=(c-u)/o,p=0;p<=o;p++){var f=Pi(n,r,u+d*p);0===p?e="M".concat(f.x,",").concat(f.y):e+="L".concat(f.x,",").concat(f.y),p===o&&h&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},s),"path")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=Si.distancePP(t,e);this.setAttribute("radius",i)}}])}(bR);function MR(){YB(),ZB(),tP(),dP()}function wR(){YB(),ZB(),FB(),dP()}CR.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},MR();var TR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="segment",a.key="segment",a.lines=[],a}return h(e,t),o(e,[{key:"getStartAngle",value:function(){return Ii(this._startAngle)}},{key:"getEndAngle",value:function(){return Ii(this._endAngle)}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"render",value:function(){var t=this;this.removeAllChild(!0),this._reset();var e=this.attribute,i=e.startSymbol,n=e.endSymbol,r=e.lineStyle,a=e.state,o=e.visible,s=void 0===o||o,l=e.multiSegment,u=e.mainSegmentIndex;if(s){this._computeLineAngle();var c=this._getMainSegmentPoints(),h=this._renderSymbol(i,c,"start"),d=this._renderSymbol(n,c,"end");if(this.startSymbol=h,this.endSymbol=d,l){var p=b(this.attribute.points);if(it(u))p[u]=this._clipPoints(p[u]);else{var f=this._clipPoints(Ft(p));p[0][0]=f[0],p[p.length-1][p[p.length-1].length-1]=f[f.length-1]}p.forEach((function(e,i){var n,o,s=B_.line(Object.assign(Object.assign({points:e},Z(r)?null!==(n=r[i])&&void 0!==n?n:r[r.length-1]:r),{fill:!1}));s.name="".concat(t.name,"-line"),s.id=t._getNodeId("line"+i),ct(null==a?void 0:a.line)||(s.states=Z(a.line)?null!==(o=a.line[i])&&void 0!==o?o:a.line[a.line.length-1]:a.line),t.add(s),t.lines.push(s)}))}else{var v=B_.line;Dt(r)[0].cornerRadius&&(v=B_.polygon);var g=v(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},Dt(r)[0]),{fill:!1,closePath:!1}));g.name="".concat(this.name,"-line"),g.id=this._getNodeId("line"),ct(null==a?void 0:a.line)||(g.states=[].concat(a.line)[0]),this.add(g),this.lines.push(g)}}}},{key:"_computeStartRotate",value:function(t){return t+Math.PI/2}},{key:"_computeEndRotate",value:function(t){return t+Math.PI/2}},{key:"_renderSymbol",value:function(t,e,i){if(e.length){var n,r=t.autoRotate,a=void 0===r||r;if(t&&t.visible){var o,s,l=this.getStartAngle(),u=this.getEndAngle(),c=this.attribute.state,h=e[0],d=e[e.length-1],p=t.refX,f=void 0===p?0:p,v=t.refY,g=void 0===v?0:v,y=t.refAngle,m=void 0===y?0:y,_=t.style,b=t.symbolType,x=t.size,k=void 0===x?12:x;"start"===i?(o={x:h.x+(it(l)?f*Math.cos(l)+g*Math.cos(l-Math.PI/2):0),y:h.y+(it(l)?f*Math.sin(l)+g*Math.sin(l-Math.PI/2):0)},s=this._computeStartRotate(this._startAngle)):(o={x:d.x+(it(u)?f*Math.cos(u)+g*Math.cos(u-Math.PI/2):0),y:d.y+(it(u)?f*Math.sin(u)+g*Math.sin(u-Math.PI/2):0)},s=this._computeEndRotate(this._endAngle)),(n=B_.symbol(Object.assign(Object.assign(Object.assign({},o),{symbolType:b,size:k,angle:a?s+m:0,strokeBoundsBuffer:0}),_))).name="".concat(this.name,"-").concat(i,"-symbol"),n.id=this._getNodeId("".concat(i,"-symbol")),ct(null==c?void 0:c.symbol)||(n.states=c.symbol),"start"===i?ct(null==c?void 0:c.startSymbol)||(n.states=c.startSymbol):ct(null==c?void 0:c.endSymbol)||(n.states=c.endSymbol),this.add(n)}return n}}},{key:"_getMainSegmentPoints",value:function(){if(this._mainSegmentPoints)return this._mainSegmentPoints;var t,e=this.attribute,i=e.points,n=e.multiSegment,r=e.mainSegmentIndex;return t=n?it(r)?i[r]:Ft(i):i,this._mainSegmentPoints=t,t}},{key:"_clipPoints",value:function(t){var e=this.attribute,i=e.startSymbol,n=void 0===i?{}:i,r=e.endSymbol,a=void 0===r?{}:r,o=t;if(n.visible){var s=n.clip?n.size||10:0;o=[{x:t[0].x-s/2*(Math.cos(this._startAngle)||0),y:t[0].y-s/2*(Math.sin(this._startAngle)||0)}].concat(b(o.slice(1)))}if(a.visible){var l=a.clip?a.size||10:0,u={x:t[t.length-1].x-l/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-l/2*(Math.sin(this._endAngle)||0)};o=[].concat(b(o.slice(0,o.length-1)),[u])}return o}},{key:"_computeLineAngle",value:function(){var t=this._getMainSegmentPoints();if(!(t.length<=1)){var e=t[0],i=t[1],n=t[t.length-2],r=t[t.length-1],a=[e.x-i.x,e.y-i.y],o=Math.atan2(a[1],a[0]),s=[r.x-n.x,r.y-n.y],l=Math.atan2(s[1],s[0]);this._startAngle=o,this._endAngle=l}}},{key:"_reset",value:function(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}])}($A);TR.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}},wR();var DR,ER,BR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},TR.defaultAttributes,t)])).name="arc-segment",a.key="arc-segment",a.isReverseArc=!1,a}return h(e,t),o(e,[{key:"getStartAngle",value:function(){var t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}},{key:"getEndAngle",value:function(){var t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"_computeStartRotate",value:function(t){return this.isReverseArc?t+Math.PI:t}},{key:"_computeEndRotate",value:function(t){return this.isReverseArc?t:t+Math.PI}},{key:"render",value:function(){this.removeAllChild(!0),this._reset();var t=this.attribute,e=t.startSymbol,i=t.endSymbol,n=t.lineStyle,r=t.state,a=t.visible,o=void 0===a||a,s=t.radius,l=t.startAngle,u=t.endAngle,c=t.center;if(o){this._startAngle=l,this._endAngle=u,this.isReverseArc=l>u;var h={x:c.x+s*Math.cos(this._startAngle),y:c.y+s*Math.sin(this._startAngle)},d={x:c.x+s*Math.cos(this._endAngle),y:c.y+s*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,d];var p=this._renderSymbol(e,this._mainSegmentPoints,"start"),f=this._renderSymbol(i,this._mainSegmentPoints,"end");this.startSymbol=p,this.endSymbol=f;var v=B_.arc(Object.assign({x:c.x,y:c.y,startAngle:l,endAngle:u,innerRadius:s,outerRadius:s},n));v.name="".concat(this.name,"-line"),v.id=this._getNodeId("arc"),ct(null==r?void 0:r.line)||(v.states=[].concat(r.line)[0]),this.add(v),this.line=v}}}])}(TR);!function(t){t.innerView="inner-view",t.axisContainer="axis-container",t.labelContainer="axis-label-container",t.tickContainer="axis-tick-container",t.tick="axis-tick",t.subTick="axis-sub-tick",t.label="axis-label",t.title="axis-title",t.labelHoverOnAxis="axis-label-hover-on-axis",t.gridContainer="axis-grid-container",t.grid="axis-grid",t.gridRegion="axis-grid-region",t.line="axis-line",t.background="axis-background",t.axisLabelBackground="axis-label-background",t.axisBreak="axis-break",t.axisBreakSymbol="axis-break-symbol"}(DR||(DR={})),function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(ER||(ER={}));var PR=l(l(l(l({},ER.selectedReverse,{}),ER.selected,{}),ER.hover,{}),ER.hoverReverse,{}),RR={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},labelHoverOnAxis:{visible:!1,space:7,padding:2,position:0,autoRotate:!1,textStyle:{fontSize:12,fill:"red",fontWeight:"normal",fillOpacity:1},background:{visible:!0,style:{cornerRadius:2,fill:"black"}}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},LR={size:8,stroke:"#000",lineWidth:1,zIndex:1};function IR(t,e){var i,n;return(null===(i=t.OBBBounds)||void 0===i?void 0:i.empty())||(null===(n=e.OBBBounds)||void 0===n?void 0:n.empty())?rn(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||cn(t.rotatedBounds,e.rotatedBounds,!0)):t.OBBBounds.intersects(e.OBBBounds)}var FR=Math.sin(Math.PI/10);function OR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FR,i=!j(t)&&0!==t,n=i?Math.cos(t):1;return i&&Math.abs(n)<=e}function zR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FR,i=!j(t)&&0!==t,n=i?Math.sin(t):0;return!i||Math.abs(n)<=e}function HR(t){var e={};return BP(t,(function(t){"group"!==t.type&&t.id&&(e[t.id]=t)})),e}function NR(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function UR(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[e.x-i.x,e.y-i.y];return jP(a,(n?-1:1)*(r?-1:1)*t/VP(a))}function jR(t,e,i,n,r){for(var a=[],o=r-n,s=0;s<e;s++){var l=n+s*o/e;a.push(Pi(t,i,l))}return a}function VR(t,e){var i="";return 0===t.length||(t.forEach((function(t,e){0===e?i="M".concat(t.x,",").concat(t.y):i+="L".concat(t.x,",").concat(t.y)})),e&&(i+="Z")),i}function WR(t,e,i){var n;if(zR(null===(n=t.attribute)||void 0===n?void 0:n.angle,Number.EPSILON))return i>Rn(t.AABBBounds,e.AABBBounds);var r=t.OBBBounds,a=e.OBBBounds;return!r||!a||r.empty()||a.empty()?i>Rn(t.AABBBounds,e.AABBBounds):r.intersects(a)||i>Ln(r,a)}function GR(t,e){for(var i,n=1,r=t.length,a=t[0];n<r;a=i,++n)if(WR(a,i=t[n],e))return!0;return!1}var YR=function(t,e,i){var n=t.target;return n!==i&&n.name&&!ct(n.states)?(n.addState(yP.hover,!0),BP(e,(function(t){t!==n&&t.name&&!ct(t.states)&&t.addState(yP.hoverReverse,!0)})),n):i},XR=function(t,e,i){return i?(BP(e,(function(t){t.name&&!ct(t.states)&&(t.removeState(yP.hoverReverse),t.removeState(yP.hover))})),null):i},KR=function(t,e,i){var n=t.target;return i===n&&n.hasState(yP.selected)?(BP(e,(function(t){t.name&&!ct(t.states)&&(t.removeState(yP.selectedReverse),t.removeState(yP.selected))})),null):n.name&&!ct(n.states)?(n.addState(yP.selected,!0),BP(e,(function(t){t!==n&&t.name&&!ct(t.states)&&t.addState(yP.selectedReverse,!0)})),n):i},qR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"_prepareAnimate",value:function(t){if(!1!==this.attribute.animation){var e=this.attribute,i=e.animation,n=e.animationEnter,r=e.animationExit,a=e.animationUpdate,o=G(i)?i:{};this._animationConfig={enter:!1!==n&&mt({},t,o,null!=n?n:{}),exit:!1!==r&&mt({},t,o,null!=r?r:{}),update:!1!==a&&(Z(a)?a:mt({},t,o,null!=a?a:{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}])}($A),ZR={type:"default",duration:300,easing:"linear"},JR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="axis",t.data=[],t.tickLineItems=[],t.subTickLineItems=[],t.axisLabelLayerSize={},t.axisLabelsContainer=null,t._onHover=function(e){t._lastHover=YR(e,t.axisContainer,t._lastHover)},t._onUnHover=function(e){t._lastHover=XR(0,t.axisContainer,t._lastHover)},t._onClick=function(e){t._lastSelect=KR(e,t.axisContainer,t._lastSelect)},t}return h(e,t),o(e,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"getBoundsWithoutRender",value:function(t){var e=ft(this.attribute);e.scale=this.attribute.scale,this.attribute=t;var i=B_.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}},{key:"render",value:function(){this._prepare(),this._prevInnerView=this._innerView&&HR(this._innerView),this.removeAllChild(!0),this._innerView=B_.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}},{key:"_prepare",value:function(){this._prepareAnimate(ZR)}},{key:"_bindEvent",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.hover,i=t.select;e&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),i&&this._innerView.addEventListener("pointerdown",this._onClick)}}},{key:"_renderInner",value:function(t){var e=this,i=this.attribute,n=i.title,r=i.label,a=i.tick,o=i.line,s=i.items,l=B_.group({x:0,y:0,zIndex:1,pickable:!1});if(l.name=DR.axisContainer,l.id=this._getNodeId("container"),l.setMode(this.mode),this.axisContainer=l,t.add(l),o&&o.visible&&this.renderLine(l),s&&s.length&&(this.data=this._transformItems(s[0]),a&&a.visible&&this.renderTicks(l),r&&r.visible)){var u=B_.group({x:0,y:0,pickable:!1});u.name=DR.labelContainer,u.id=this._getNodeId("label-container"),this.axisLabelsContainer=u,l.add(u),s.forEach((function(t,i){var n=e.renderLabels(u,t,i),r=n.getChildren();e.beforeLabelsOverlap(r,t,n,i,s.length),e.handleLabelsOverlap(r,t,n,i,s.length),e.afterLabelsOverlap(r,t,n,i,s.length);var a=0,o=0,l="center",c="middle",h=0;r.forEach((function(t,e){var i,n=t.attribute,r=null!==(i=n.angle)&&void 0!==i?i:0,s=t.AABBBounds,u=s.width(),d=s.height();r&&(u=Math.abs(u*Math.cos(r)),d=Math.abs(d*Math.sin(r))),a=Math.max(a,u),o=Math.max(o,d),l=n.textAlign,c=n.textBaseline,0===e&&(h=n.x)})),e.axisLabelLayerSize[i]={width:a,height:o,labelPos:h,textAlign:l,textBaseline:c}}))}n&&n.visible&&this.renderTitle(l)}},{key:"renderTicks",value:function(t){var e=this,i=this.getTickLineItems(),n=B_.group({x:0,y:0,pickable:!1});n.name=DR.tickContainer,n.id=this._getNodeId("tick-container"),t.add(n),i.forEach((function(t,r){var a,o=B_.line(Object.assign({},e._getTickLineAttribute("tick",t,r,i)));if(o.name=DR.tick,o.id=e._getNodeId(t.id),ct(null===(a=e.attribute.tick)||void 0===a?void 0:a.state))o.states=xP;else{var s=e.data[r],l=mt({},xP,e.attribute.tick.state);Object.keys(l).forEach((function(t){U(l[t])&&(l[t]=l[t](s.rawValue,r,s,e.data))})),o.states=l}n.add(o)})),this.tickLineItems=i;var r=this.attribute.subTick;if(r&&r.visible){var a=this.getSubTickLineItems();a.length&&a.forEach((function(t,a){var o=B_.line(Object.assign({},e._getTickLineAttribute("subTick",t,a,i)));if(o.name=DR.subTick,o.id=e._getNodeId("".concat(a)),ct(r.state))o.states=xP;else{var s=mt({},xP,r.state);Object.keys(s).forEach((function(e){U(s[e])&&(s[e]=s[e](t.value,a,t,i))})),o.states=s}n.add(o)})),this.subTickLineItems=a}}},{key:"renderLabels",value:function(t,e,i){var n=this,r=this.attribute.label.dataFilter;r&&U(r)&&(e=r(e,i));var a=this._transformItems(e),o=B_.group({x:0,y:0,pickable:!1});return o.name="".concat(DR.labelContainer,"-layer-").concat(i),o.id=this._getNodeId("label-container-layer-".concat(i)),t.add(o),a.forEach((function(t,e){var r,s=qP(n._getLabelAttribute(t,e,a,i));if(s.name=DR.label,s.id=n._getNodeId("layer".concat(i,"-label-").concat(t.id)),ct(null===(r=n.attribute.label)||void 0===r?void 0:r.state))s.states=xP;else{var l=mt({},xP,n.attribute.label.state);Object.keys(l).forEach((function(n){U(l[n])&&(l[n]=l[n](t,e,a,i))})),s.states=l}s.data=Object.assign(Object.assign({},t),{index:e,layer:i}),o.add(s)})),o}},{key:"renderTitle",value:function(t){var e=this.getTitleAttribute(),i=new iR(Object.assign({},e));i.name=DR.title,i.id=this._getNodeId("title"),t.add(i)}},{key:"getVerticalCoord",value:function(t,e,i){return NR(t,this.getVerticalVector(e,i,t))}},{key:"getTickLineItems",value:function(){var t=this,e=this.attribute.tick,i=this.data,n=[],r=e.alignWithLabel,a=e.inside,o=void 0!==a&&a,s=e.length,l=e.dataFilter,u=1;return i.length>=2&&(u=i[1].value-i[0].value),(l&&U(l)?l(i):i).forEach((function(e){var i=e.point,a=e.value;if(!r){var l=e.value-u/2;if(t.isInValidValue(l))return;i=t.getTickCoord(l),a=l}var c=t.getVerticalCoord(i,s,o);if("3d"===t.mode){var h=t.getVerticalVector(s,o,i),d=0,p=0;ii(h[0])>ii(h[1])?d=Qe/2*(c.x>i.x?1:-1):p=Qe/2*(c.y>i.y?-1:1),n.push({start:i,end:c,value:a,id:"tick-".concat(e.id),anchor:[i.x,i.y],alpha:d,beta:p})}else n.push({start:i,end:c,value:a,id:"tick-".concat(e.id)})})),n}},{key:"getSubTickLineItems",value:function(){var t=this.attribute.subTick,e=[],i=t.count,n=void 0===i?4:i,r=t.inside,a=void 0!==r&&r,o=t.length,s=void 0===o?2:o,l=this.tickLineItems,u=l.length;if(u>=2)for(var c=0;c<u-1;c++)for(var h=l[c],d=l[c+1],p=0;p<n;p++){var f=(p+1)/(n+1),v=(1-f)*h.value+f*d.value,g=this.getTickCoord(v),y=this.getVerticalCoord(g,s,a);e.push({start:g,end:y,value:v,id:"sub-tick-".concat(v)})}return e}},{key:"_getTickLineAttribute",value:function(t,e,i,n){var r=ht(this.attribute,"".concat(t,".style")),a=this.data[i];r=U(r)?mt({},ht(RR,"".concat(t,".style")),"tick"===t?r(a.rawValue,i,a,this.data):r(e.value,i,e,n)):r;var o=e.start,s=e.end,l=e.anchor,u=e.alpha,c=e.beta;return Object.assign({points:[o,s],anchor:l,alpha:u,beta:c},r)}},{key:"_getLabelAttribute",value:function(t,e,i,n){var r,a,o=this.attribute.label,s=o.space,l=void 0===s?4:s,u=o.inside,c=void 0!==u&&u,h=o.formatMethod,d=o.type,p=void 0===d?"text":d,f=o.text,v=l,g=0;(null===(r=this.attribute.tick)||void 0===r?void 0:r.visible)&&this.attribute.tick.inside===c&&(g=this.attribute.tick.length||4),(null===(a=this.attribute.subTick)||void 0===a?void 0:a.visible)&&this.attribute.subTick.inside===c&&(g=Math.max(g,this.attribute.subTick.length||2)),v+=g;var y=this.getRelativeVector(t.point);n>0&&(0===y[1]?v+=(this.axisLabelLayerSize[n-1].height+ht(this.attribute,"label.space",4))*n:v+=(this.axisLabelLayerSize[n-1].width+ht(this.attribute,"label.space",4))*n);var m=this.getVerticalCoord(t.point,v,c),_=this.getVerticalVector(v||1,c,m),b=h?h("".concat(t.label),t,e,i,n):t.label,x=this.attribute.label.style;return x=U(x)?mt({},RR.label.style,x(t,e,i,n)):x,x=mt(this.getLabelAlign(_,c,x.angle),x),U(x.text)&&(x.text=x.text({label:t.label,value:t.rawValue,index:t.index,layer:n})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(m,_,b,x)),{text:null!=f?f:b,_originText:t.label,lineHeight:null==x?void 0:x.fontSize,type:p}),x)}},{key:"getLabelPosition",value:function(t,e,i,n){return t}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"runAnimation",value:function(){var t=this,e=this.lastScale;if(this.attribute.scale){var i=this.attribute.scale;this.lastScale=i.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){var n=this.getInnerView(),r=this.getPrevInnerView();if(!r)return;var a=this._animationConfig;this._newElementAttrMap={},BP(n,(function(i){var n;if("group"!==i.type&&i.id){var o=r[i.id];if(i.setFinalAttributes(i.attribute),o){o.release();var s=o.attribute,l=i.getFinalAttribute(),u=function(t,e,i){var n={};for(var r in e)r in t&&St(t[r],e[r])||(n[r]=e[r]);if(i)for(var a in t)if(!(a in e)){var o=i(a);void 0!==o&&(n[a]=o)}return n}(s,l),c=Object.keys(u).length>0;if("opacity"in s&&l.opacity!==s.opacity&&(u.opacity=null!==(n=l.opacity)&&void 0!==n?n:1,c=!0),a.update&&c){t._newElementAttrMap[i.id]={state:"update",node:i,attrs:i.attribute};var h=o.attribute;i.setAttributes(h),i.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},a.update),{type:"axisUpdate",customParameters:{config:a.update,diffAttrs:u,lastScale:e}})}])}}else a.enter&&(t._newElementAttrMap[i.id]={state:"enter",node:i,attrs:i.attribute},i.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},a.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:a.enter,lastScale:e,getTickCoord:t.getTickCoord.bind(t)}})}]))}}))}}},{key:"release",value:function(){_(e,"release",this,3)([]),this._prevInnerView=null,this._innerView=null}}])}(qR),QR={parity:function(t){return t.filter((function(t,e){return e%2?t.setAttribute("opacity",0):1}))},greedy:function(t,e){var i;return t.filter((function(t,n){return n&&WR(i,t,e)?t.setAttribute("opacity",0):(i=t,1)}))}};function $R(t){var e;return(e=t.OBBBounds.empty()?t.AABBBounds:t.OBBBounds).width()>1&&e.height()>1}function tL(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i&&!t.attribute.opacity){var a=e.length;if(a>1){t.setAttribute("opacity",1);for(var o=0;o<a;o++){var s=r?e[a-1-o]:e[o];if(!n(s))break;s.setAttribute("opacity",0)}}}}function eL(t,e){if(!ct(t)){var i=t.filter($R);if(!ct(i)){var n;n=function(t){return t.forEach((function(t){return t.setAttribute("opacity",1)})),t}(i);var r=e.method,a=void 0===r?"parity":r,o=e.separation,s=void 0===o?0:o,l=U(a)?a:QR[a]||QR.parity;if(n.length>=3&&GR(n,s)){do{n=l(n,s)}while(n.length>=3&&GR(n,s));var u=function(t,e){return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&t<3||e},c=u(n.length,e.firstVisible,!1),h=u(n.length,e.lastVisible),d=i[0],p=Et(i);WR(d,p,s)&&c&&h&&(p.setAttribute("opacity",0),h=!1),tL(d,n,c,(function(t){return WR(t,d,s)})),tL(p,n,h,(function(t){return WR(t,p,s)||!(!c||t===d)&&WR(t,d,s)}),!0)}i.forEach((function(t){t.setAttribute("visible",!!t.attribute.opacity)}))}}}function iL(t,e){if(!ct(t)){var i=e.orient,n=e.labelRotateAngle,r=void 0===n?[0,45,90]:n;if(0!==r.length&&!t.some((function(t){return!!t.attribute.angle}))){var a=0,o=0,s=function(){var e=r[a++];if(t.forEach((function(t){t.attribute.angle=Ci(e)})),function(t,e){"bottom"!==t&&"top"!==t||function(t,e){e.forEach((function(e){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},rL(t,e.attribute.angle)),{angle:nL(e.attribute.angle)}))}))}(t,e),"left"!==t&&"right"!==t||function(t,e){e.forEach((function(e,i){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},aL(t,e.attribute.angle)),{angle:nL(e.attribute.angle)}))}))}(t,e),function(t){t.forEach((function(t){if(!t.rotatedBounds&&t.attribute.angle){var e=function(t){var e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),i=sn({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),n=i.x-e.centerX,r=i.y-e.centerY;e.x1+=n,e.x2+=n,e.y1+=r,e.y2+=r,e.centerX+=n,e.centerY+=r,t.rotatedBounds=e}}))}(e)}(i,t),!function(t){for(var e=1;e<t.length;e++)if(IR(t[e-1],t[e]))return!0;return!1}(t))return 1};for(r&&r.length>0&&(o=r.length);a<o&&!s(););}}}function nL(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function rL(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(i=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);var r,a=(e=nL(e))/(.5*Math.PI);return{textAlign:i[r=a===Math.floor(a)?2*Math.floor(a):2*Math.floor(a)+1],textBaseline:n[r]}}function aL(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(i=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);var r,a=(e=nL(e))/(.5*Math.PI);return{textAlign:i[r=a===Math.floor(a)?2*Math.floor(a):2*Math.floor(a)+1],textBaseline:n[r]}}function oL(t,e){var i=e.limitLength,n=e.verticalLimitLength,r=e.ellipsis,a=void 0===r?"...":r,o=e.orient,s=e.axisLength;if(!ct(t)&&it(i)){var l=function(t){return it(t)?{left:t,right:t}:G(t)?{left:t.left||0,right:t.right||0}:{left:0,right:0}}(e.overflowLimitLength),u=t[0],c=u.attribute.angle,h=!j(c),d=h?Math.cos(c):1,p=h?Math.sin(c):0,f=zR(c),v=OR(c),g="top"===o||"bottom"===o,y=u.attribute.direction,m=!f&&!v&&g&&(t.length<2||t.some((function(t){return Math.abs(t.AABBBounds.width()-u.AABBBounds.width())>=2})))&&u.AABBBounds.width()>Math.abs(i/p);t.forEach((function(t){var e;if(g){if(v&&Math.floor(t.AABBBounds.height())<=i)return;if(f&&Math.floor(t.AABBBounds.width())<=n)return}if(!g){if("vertical"===y&&Math.floor(t.AABBBounds.height())<=n)return;if("vertical"!==y){if(f&&Math.floor(t.AABBBounds.width())<=i)return;if(v&&Math.floor(t.AABBBounds.height())<=n)return}}var r=null;if(f||v)r=g?f?n:i:"vertical"===y||v?n:i;else if(g){var o=t.AABBBounds,u=o.x1,c=o.x2,h=p/d,_=Math.abs(i/p);if(m&&h>0&&u<=s+l.right&&i/h+u>s+l.right){var b=(s-u+l.right)/Math.abs(d);r=Math.min(b,_)}else if(m&&h<0&&c>=-l.left&&i/h+c<-l.left){var x=(c+l.left)/Math.abs(d);r=Math.min(x,_)}else r=_}else r=Math.abs(i/d);it(t.attribute.maxLineWidth)&&(r=it(r)?Math.min(t.attribute.maxLineWidth,r):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:r,ellipsis:null!==(e=t.attribute.ellipsis)&&void 0!==e?e:a})}))}}function sL(t,e,i){var n;return it(e)&&(n=Math.abs(e-t)),it(i)&&(n=it(n)?Math.min(Math.abs(t-i),n):Math.abs(t-i)),n}var lL=function(){return o((function t(){r(this,t)}),[{key:"isInValidValue",value:function(t){return t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute.start,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}},{key:"getRelativeVector",value:function(t){var e=this.attribute,i=e.start,n=e.end;return[n.x-i.x,n.y-i.y]}},{key:"getVerticalVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.attribute.verticalFactor,n=void 0===i?1:i,r=function(t){var e=VP(t);return e>0&&(e=1/e),[t[0]*e,t[1]*e]}(this.getRelativeVector());return jP([r[1],-1*r[0]],t*(e?1:-1)*n)}}])}(),uL=function(){function t(){r(this,t)}return o(t,null,[{key:"linear",value:function(t){return t}},{key:"none",value:function(){return this.linear}},{key:"get",value:function(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}},{key:"getPowIn",value:function(t){return function(e){return Math.pow(e,t)}}},{key:"getPowOut",value:function(t){return function(e){return 1-Math.pow(1-e,t)}}},{key:"getPowInOut",value:function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}},{key:"getBackIn",value:function(t){return function(e){return e*e*((t+1)*e-t)}}},{key:"getBackOut",value:function(t){return function(e){return--e*e*((t+1)*e+t)+1}}},{key:"getBackInOut",value:function(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}},{key:"sineIn",value:function(t){return 1-Math.cos(t*Math.PI/2)}},{key:"sineOut",value:function(t){return Math.sin(t*Math.PI/2)}},{key:"sineInOut",value:function(t){return-(Math.cos(Math.PI*t)-1)/2}},{key:"expoIn",value:function(t){return 0===t?0:Math.pow(2,10*t-10)}},{key:"expoOut",value:function(t){return 1===t?1:1-Math.pow(2,-10*t)}},{key:"expoInOut",value:function(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}},{key:"circIn",value:function(t){return-(Math.sqrt(1-t*t)-1)}},{key:"circOut",value:function(t){return Math.sqrt(1- --t*t)}},{key:"circInOut",value:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},{key:"bounceOut",value:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},{key:"bounceIn",value:function(e){return 1-t.bounceOut(1-e)}},{key:"bounceInOut",value:function(e){return e<.5?.5*t.bounceIn(2*e):.5*t.bounceOut(2*e-1)+.5}},{key:"getElasticIn",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/ei*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*ei/e)}}},{key:"getElasticOut",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/ei*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-n)*ei/e)+1}}},{key:"getElasticInOut",value:function(t,e){return function(i){var n=e/ei*Math.asin(1/t);return(i*=2)<1?t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*ei/e)*-.5:t*Math.pow(2,-10*(i-=1))*Math.sin((i-n)*ei/e)*.5+1}}},{key:"registerFunc",value:function(e,i){t[e]=i}}])}();uL.quadIn=uL.getPowIn(2),uL.quadOut=uL.getPowOut(2),uL.quadInOut=uL.getPowInOut(2),uL.cubicIn=uL.getPowIn(3),uL.cubicOut=uL.getPowOut(3),uL.cubicInOut=uL.getPowInOut(3),uL.quartIn=uL.getPowIn(4),uL.quartOut=uL.getPowOut(4),uL.quartInOut=uL.getPowInOut(4),uL.quintIn=uL.getPowIn(5),uL.quintOut=uL.getPowOut(5),uL.quintInOut=uL.getPowInOut(5),uL.backIn=uL.getBackIn(1.7),uL.backOut=uL.getBackOut(1.7),uL.backInOut=uL.getBackInOut(1.7),uL.elasticIn=uL.getElasticIn(1,.3),uL.elasticOut=uL.getElasticOut(1,.3),uL.elasticInOut=uL.getElasticInOut(1,.3*1.5),uL.easeInOutQuad=function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},uL.easeOutElastic=function(t){var e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},uL.easeInOutElastic=function(t){var e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1};for(var cL=function(t){uL["flicker".concat(t)]=function(e){return function(t,e){for(var i=1/e,n=1;t>i;)t-=i,n*=-1;var r=n*t/i;return r>0?r:1+r}(e,t)}},hL=0;hL<10;hL++)cL(hL);for(var dL=function(t){uL["aIn".concat(t)]=function(e){return t*e*e+(1-t)*e}},pL=2;pL<10;pL++)dL(pL);function fL(t,e,i){return t+(e-t)*i}var vL=new(o((function t(){r(this,t),this.opacity=function(t,e,i,n,r,a){a.attribute.opacity=fL(e,i,n)},this.baseOpacity=function(t,e,i,n,r,a){a.attribute.baseOpacity=fL(e,i,n)},this.fillOpacity=function(t,e,i,n,r,a){a.attribute.fillOpacity=fL(e,i,n)},this.strokeOpacity=function(t,e,i,n,r,a){a.attribute.strokeOpacity=fL(e,i,n)},this.zIndex=function(t,e,i,n,r,a){a.attribute.zIndex=fL(e,i,n)},this.backgroundOpacity=function(t,e,i,n,r,a){a.attribute.backgroundOpacity=fL(e,i,n)},this.shadowOffsetX=function(t,e,i,n,r,a){a.attribute.shadowOffsetX=fL(e,i,n)},this.shadowOffsetY=function(t,e,i,n,r,a){a.attribute.shadowOffsetY=fL(e,i,n)},this.shadowBlur=function(t,e,i,n,r,a){a.attribute.shadowBlur=fL(e,i,n)},this.fill=function(t,e,i,n,r,a){a.attribute.fill=Sy(e,i,n,!1)},this.fillPure=function(t,e,i,n,r,a){a.attribute.fill=r.fromParsedProps.fill?Cy(r.fromParsedProps.fill,r.toParsedProps.fill,n):r.toParsedProps.fill},this.stroke=function(t,e,i,n,r,a){a.attribute.stroke=Sy(e,i,n,!1)},this.strokePure=function(t,e,i,n,r,a){a.attribute.stroke=r.fromParsedProps.stroke?Cy(r.fromParsedProps.stroke,r.toParsedProps.stroke,n):r.toParsedProps.stroke},this.width=function(t,e,i,n,r,a){a.attribute.width=fL(e,i,n),a.addUpdateBoundTag()},this.height=function(t,e,i,n,r,a){a.attribute.height=fL(e,i,n),a.addUpdateBoundTag()},this.x=function(t,e,i,n,r,a){a.attribute.x=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.y=function(t,e,i,n,r,a){a.attribute.y=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.dx=function(t,e,i,n,r,a){a.attribute.dx=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.dy=function(t,e,i,n,r,a){a.attribute.dy=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.angle=function(t,e,i,n,r,a){a.attribute.angle=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.scaleX=function(t,e,i,n,r,a){a.attribute.scaleX=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.scaleY=function(t,e,i,n,r,a){a.attribute.scaleY=fL(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.lineWidth=function(t,e,i,n,r,a){a.attribute.lineWidth=fL(e,i,n),a.addUpdateBoundTag()},this.startAngle=function(t,e,i,n,r,a){a.attribute.startAngle=fL(e,i,n),a.addUpdateBoundTag()},this.endAngle=function(t,e,i,n,r,a){a.attribute.endAngle=fL(e,i,n),a.addUpdateBoundTag()},this.radius=function(t,e,i,n,r,a){a.attribute.radius=fL(e,i,n),a.addUpdateBoundTag()},this.outerRadius=function(t,e,i,n,r,a){a.attribute.outerRadius=fL(e,i,n),a.addUpdateBoundTag()},this.innerRadius=function(t,e,i,n,r,a){a.attribute.innerRadius=fL(e,i,n),a.addUpdateBoundTag()},this.size=function(t,e,i,n,r,a){a.attribute.size=fL(e,i,n),a.addUpdateBoundTag()},this.points=function(t,e,i,n,r,a){a.attribute.points=Hf(e,i,n),a.addUpdateBoundTag()}})));function gL(t,e,i,n,r,a){if(Number.isFinite(i)&&Number.isFinite(e))return a.attribute[t]=e+(i-e)*n,!0;if(Array.isArray(i)&&Array.isArray(e)&&i.length===e.length){for(var o=[],s=!0,l=0;l<i.length;l++){var u=e[l],c=u+(i[l]-u)*n;if(!Number.isFinite(c)){s=!1;break}o.push(c)}return s&&(a.attribute[t]=o),!0}return!1}function yL(){}var mL=function(){return o((function t(e,i,n,a){var o,s=this;r(this,t),this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=function(){s.target.setAttributes(s.target.attribute)},this.type=e,this.props=i,this.duration=n,this.easing=a?"function"==typeof a?a:null!==(o=uL[a])&&void 0!==o?o:uL.linear:uL.linear,"wait"===e&&(this.onUpdate=yL),this.id=vc.GenAutoIncrementId(),this.syncAttributeUpdate=yL}),[{key:"bind",value:function(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}},{key:"append",value:function(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}},{key:"updateDownstreamStartTimes",value:function(){for(var t=this.next,e=this._startTime+this.duration;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}},{key:"getLastProps",value:function(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}},{key:"setDuration",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.duration=t,e&&this.updateDownstreamStartTimes()}},{key:"getDuration",value:function(){return this.duration}},{key:"determineInterpolateUpdateFunction",value:function(){var t=this;if(this.props){var e=[];this.propKeys.forEach((function(i){if("fill"===i||"stroke"===i){var n=t.fromProps[i],r=t.props[i];if(q(n)&&q(r)){var a=xy.Get(n,gy.Color255),o=xy.Get(r,gy.Color255);t.fromParsedProps||(t.fromParsedProps={}),t.toParsedProps||(t.toParsedProps={}),t.fromParsedProps[i]=a,t.toParsedProps[i]=o,e.push(vL["fill"===i?"fillPure":"strokePure"])}else vL[i]?e.push(vL[i]):e.push(gL)}else vL[i]?e.push(vL[i]):e.push(gL)})),this.interpolateUpdateFunctions=e}}},{key:"setStartTime",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._startTime=t,e&&this.updateDownstreamStartTimes()}},{key:"getStartTime",value:function(){return this._startTime}},{key:"onBind",value:function(){"glyph"===this.target.type&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}},{key:"onFirstRun",value:function(){}},{key:"onStart",value:function(){var t=this;if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();var e=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach((function(i){var n;t.fromProps[i]=null!==(n=t.fromProps[i])&&void 0!==n?n:e[i]})),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}},{key:"tryPreventConflict",value:function(){var t=this,e=this.animate;this.target.animates.forEach((function(i){if(!(i===e||i.priority>e.priority||i.priority===1/0)){var n=i.getStartProps();t.propKeys.forEach((function(t){null!=n[t]&&i.preventAttr(t)}))}}))}},{key:"deleteSelfAttr",value:function(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];var i=this.propKeys.indexOf(t);-1!==i&&(this.propKeys.splice(i,1),null===(e=this.interpolateUpdateFunctions)||void 0===e||e.splice(i,1))}},{key:"trySyncStartProps",value:function(){var t=this;this.propKeys.forEach((function(e){t.fromProps[e]=t.animate.target.getComputedAttribute(e)}))}},{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.fromProps[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}},{key:"onUpdate",value:function(t,e,i){}},{key:"onEnd",value:function(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}},{key:"getEndProps",value:function(){return this.props}},{key:"getFromProps",value:function(){return this.fromProps}},{key:"getMergedEndProps",value:function(){return this.getEndProps()}},{key:"stop",value:function(){}},{key:"release",value:function(){}}])}(),_L=function(t){function e(t,i,a,o){return r(this,e),n(this,e,[t,i,a,o])}return h(e,t),o(e,[{key:"onStart",value:function(){_(e,"onStart",this,3)([]);var t=this.getFromProps();this.target.setAttributes(t)}},{key:"update",value:function(t,e,i){this.onStart()}},{key:"determineInterpolateUpdateFunction",value:function(){}}])}(mL),bL=function(t){function e(){var t;return r(this,e),(t=n(this,e)).head=null,t.tail=null,t.animateMap=new Map,t._animateCount=0,t._playSpeed=1,t._totalDuration=0,t._startTime=0,t._currentTime=0,t._animationEndFlag=!0,t.id=vc.GenAutoIncrementId(),t.paused=!1,t}return h(e,t),o(e,[{key:"animateCount",get:function(){return this._animateCount}},{key:"isRunning",value:function(){return!this.paused&&this._animateCount>0}},{key:"forEachAccessAnimate",value:function(t){for(var e=this.head,i=0;e;){var n=e.next;t(e.animate,i),i++,e=n}}},{key:"addAnimate",value:function(t){var e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"tick",value:function(t){var e=this;if(!this.paused){this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));var i=t*this._playSpeed;this._currentTime+=i,this.forEachAccessAnimate((function(t,n){t.status===$c.END?e.removeAnimate(t,!0):t.status!==$c.RUNNING&&t.status!==$c.INITIAL||t.advance(i)})),0===this._animateCount&&(this._animationEndFlag=!0,this.emit("animationEnd"))}}},{key:"clear",value:function(){this.forEachAccessAnimate((function(t){t.release()})),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}},{key:"removeAnimate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach((function(t){return t()})),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}},{key:"recalculateTotalDuration",value:function(){var t=this;this._totalDuration=0,this.forEachAccessAnimate((function(e){t._totalDuration=Math.max(t._totalDuration,e.getStartTime()+e.getDuration())}))}},{key:"getTotalDuration",value:function(){return this._totalDuration}},{key:"getPlaySpeed",value:function(){return this._playSpeed}},{key:"setPlaySpeed",value:function(t){this._playSpeed=t}},{key:"getPlayState",value:function(){return this.paused?"paused":0===this.animateCount?"stopped":"playing"}},{key:"setStartTime",value:function(t){this._startTime=t}},{key:"getStartTime",value:function(){return this._startTime}},{key:"getCurrentTime",value:function(){return this._currentTime}},{key:"setCurrentTime",value:function(t){this._currentTime=t}}])}(z),xL=new bL;xL.isGlobal=!0;var kL=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vc.GenAutoIncrementId(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xL,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.id=e,this.status=$c.INITIAL,this._timeline=i,i.addAnimate(this),this.slience=n,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}),[{key:"getStartProps",value:function(){return this._startProps}},{key:"getEndProps",value:function(){return this._endProps}},{key:"setTimeline",value:function(t){this._timeline=t}},{key:"getTimeline",value:function(){return this._timeline}},{key:"timeline",get:function(){return this._timeline}},{key:"bind",value:function(t){var e=this;return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove((function(){e.stop(),e.target.animates.delete(e.id)})),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}},{key:"to",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",n=new mL(Qc.to,t,e,i);return n.bind(this.target,this),this.updateStepAfterAppend(n),this}},{key:"wait",value:function(t){var e=new _L(Qc.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}},{key:"updateStepAfterAppend",value:function(t){this._firstStep?(this._lastStep.append(t),this._lastStep=t):(this._firstStep=t,this._lastStep=t),this.parseStepProps(t),this.updateDuration()}},{key:"parseStepProps",value:function(t){var e=this;this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach((function(i){var n;t.props[i]=null!==(n=t.props[i])&&void 0!==n?n:e._endProps[i]})),t.propKeys.forEach((function(i){e._endProps[i]=t.props[i]})))}},{key:"reSyncProps",value:function(){var t=this;if(this._lastStep){this._endProps={};for(var e=this._firstStep;e;)Object.keys(this._endProps).forEach((function(i){var n;e.props[i]=null!==(n=e.props[i])&&void 0!==n?n:t._endProps[i]})),e.propKeys.forEach((function(i){t._endProps[i]=e.props[i]})),e=e.next}}},{key:"from",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",n=new mL(Qc.from,t,e,i);return this._firstStep?(this._lastStep.append(n),this._lastStep=n):(this._firstStep=n,this._lastStep=n),this.updateDuration(),this}},{key:"play",value:function(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}},{key:"pause",value:function(){this.status===$c.RUNNING&&(this.status=$c.PAUSED)}},{key:"resume",value:function(){this.status===$c.PAUSED&&(this.status=$c.RUNNING)}},{key:"onStart",value:function(t){var e,i=this;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):(null===(e=this._onStart)||void 0===e||e.forEach((function(t){return t()})),Object.keys(this._endProps).forEach((function(t){i._startProps[t]=i.target.getComputedAttribute(t)})))}},{key:"onEnd",value:function(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):null===(e=this._onEnd)||void 0===e||e.forEach((function(t){return t()}))}},{key:"onFrame",value:function(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}},{key:"onRemove",value:function(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):null===(e=this._onRemove)||void 0===e||e.forEach((function(t){return t()}))}},{key:"preventAttr",value:function(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];for(var e=this._firstStep;e;)e.deleteSelfAttr(t),e=e.next}},{key:"preventAttrs",value:function(t){var e=this;t.forEach((function(t){return e._preventAttrs.add(t)}))}},{key:"validAttr",value:function(t){return!this._preventAttrs.has(t)}},{key:"runCb",value:function(t){var e;return null===(e=this._lastStep)||void 0===e||e.onEnd(t),this}},{key:"startAt",value:function(t){return this._startTime=t,this}},{key:"customInterpolate",value:function(t,e,i,n,r,a){return!1}},{key:"getFromValue",value:function(){return this._startProps}},{key:"getToValue",value:function(){return this._endProps}},{key:"stop",value:function(t){for(var e=this._firstStep;e;)e.stop(),e=e.next;this.status!==$c.END&&this.onEnd(),this.status=$c.END,this.target&&("start"===t?this.target.setAttributes(this._startProps):"end"===t?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}},{key:"release",value:function(){this.status=$c.END,this._onRemove&&this._onRemove.forEach((function(t){return t()})),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[],this.forEachStep((function(t){t.release()}))}},{key:"getDuration",value:function(){return this._duration}},{key:"getStartTime",value:function(){return this._startTime}},{key:"afterAll",value:function(t){if(!t||0===t.length)return this;var e=0;return t.forEach((function(t){var i=t.getStartTime()+t.getTotalDuration();e=Math.max(e,i)})),this.startAt(e)}},{key:"after",value:function(t){if(!t)return this;var e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}},{key:"parallel",value:function(t){return t?(this.startAt(t.getStartTime()),this):this}},{key:"loop",value:function(t){return!0===t?t=1/0:!1===t&&(t=0),this._loopCount=t,this.updateDuration(),this}},{key:"bounce",value:function(t){return this._bounce=t,this}},{key:"advance",value:function(t){var e,i,n;if(this.status!==$c.END){var r=this.currentTime+t;if(r<this._startTime)this.currentTime=r;else{if(r>=this._startTime+this._totalDuration)return null===(e=this._lastStep)||void 0===e||e.onUpdate(!0,1,{}),null===(i=this._lastStep)||void 0===i||i.onEnd(),this.onEnd(),void(this.status=$c.END);this.status=$c.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=r;var a=r-this._startTime,o=!1,s=!1;if(this._loopCount>0){a=(r-this._startTime)%this._duration;var l=Math.floor((r-this._startTime)/this._duration);o=l>this._currentLoop,this._currentLoop=l,(s=this._bounce&&l%2==1)&&(a=this._duration-a)}o&&!s&&this.target.setAttributes(this._startProps);var u=null;if(this._lastStep===this._firstStep)u=this._firstStep;else for(var c=this._firstStep;c;){var h=c.getStartTime(),d=c.getDuration();if(a>=h&&a<=h+d){u=c;break}c=c.next}if(u){u!==this.lastRunStep&&(null===(n=this.lastRunStep)||void 0===n||n.onEnd()),this.lastRunStep=u;var p=(a-u.getStartTime())/u.getDuration(),f=p>=1;u.update(f,p,{}),f&&(u.onEnd(),this.lastRunStep=null)}}}else console.warn("aaa 动画已经结束，不能推进")}},{key:"updateDuration",value:function(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}},{key:"getTotalDuration",value:function(){return this._totalDuration}},{key:"getLoop",value:function(){return this._loopCount}},{key:"forEachStep",value:function(t){for(var e=this._firstStep;e;)t(e),e=e.next}}])}(),SL=new lh,AL=function(){return o((function t(){r(this,t),this.released=!1}),[{key:"tick",value:function(t,e){var i=this;SL.addAnimationFrameCb((function(){if(!i.released)return e(i)}))}},{key:"release",value:function(){this.released=!0}},{key:"getTime",value:function(){return Date.now()}}])}(),CL=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).timelines=[],i.frameTimeHistory=[],i.handleTick=function(t,e){var n=(null!=e?e:{}).once,r=void 0!==n&&n;if(i.ifCanStop())return i.stop(),!1;var a=t.getTime();i._lastTickTime=a,i.lastFrameTime<0&&(i.lastFrameTime=a-i.interval+i.timeOffset,i.frameTimeHistory.push(i.lastFrameTime));var o=a-i.lastFrameTime,s=i.checkSkip(o);return s||(i._handlerTick(o),i.lastFrameTime=a,i.frameTimeHistory.push(i.lastFrameTime)),r||t.tick(i.interval,i.handleTick),!s},i._handlerTick=function(t){i.status===Jc.RUNNING&&(i.tickCounts++,i.timelines.forEach((function(e){e.tick(t)})),i.emit("tick",t))},i.init(),i.lastFrameTime=-1,i.tickCounts=0,i.stage=t,i.autoStop=!0,i.interval=16,i.computeTimeOffsetAndJitter(),i}return h(e,t),o(e,[{key:"bindStage",value:function(t){this.stage=t}},{key:"computeTimeOffsetAndJitter",value:function(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}},{key:"init",value:function(){var t=this;this.interval=16,this.status=Jc.INITIAL,oh.global.hooks.onSetEnv.tap("graph-ticker",(function(){t.initHandler(!1)})),oh.global.env&&this.initHandler(!1)}},{key:"addTimeline",value:function(t){this.timelines.push(t)}},{key:"remTimeline",value:function(t){this.timelines=this.timelines.filter((function(e){return e!==t}))}},{key:"getTimelines",value:function(){return this.timelines}},{key:"initHandler",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setupTickHandler(t)}},{key:"setupTickHandler",value:function(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.tickerHandler)return!0;var t=new AL;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}},{key:"setInterval",value:function(t){this.interval=t,this.computeTimeOffsetAndJitter()}},{key:"getInterval",value:function(){return this.interval}},{key:"setFPS",value:function(t){this.setInterval(Math.floor(1e3/t))}},{key:"getFPS",value:function(){return 1e3/this.interval}},{key:"tick",value:function(t){var e=this;this.tickerHandler.tick(t,(function(t){return e.handleTick(t,{once:!0})}))}},{key:"tickTo",value:function(t){var e=this;this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,(function(t){e.handleTick(t,{once:!0})}))}},{key:"pause",value:function(){return this.status!==Jc.INITIAL&&(this.status=Jc.PAUSE,!0)}},{key:"resume",value:function(){return this.status!==Jc.INITIAL&&(this.status=Jc.RUNNING,!0)}},{key:"ifCanStop",value:function(){if(this.autoStop){if(!this.timelines.length)return!0;if(this.timelines.every((function(t){return!t.isRunning()})))return!0}return!1}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.status===Jc.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!t){if(this.status===Jc.PAUSE)return!1;if(this.ifCanStop())return!1}return this.status=Jc.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0}},{key:"stop",value:function(){this.status=Jc.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}},{key:"trySyncTickStatus",value:function(){this.status===Jc.INITIAL&&this.timelines.some((function(t){return t.isRunning()}))?this.start():this.status===Jc.RUNNING&&this.timelines.every((function(t){return!t.isRunning()}))&&this.stop()}},{key:"release",value:function(){var t;this.stop(),this.timelines=[],null===(t=this.tickerHandler)||void 0===t||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}},{key:"checkSkip",value:function(t){var e,i,n;return"performance"!==(null===(n=null===(i=null===(e=this.stage)||void 0===e?void 0:e.params)||void 0===i?void 0:i.optimize)||void 0===n?void 0:n.tickRenderMode)&&t<this.interval+2*(Math.random()-.5)*this._jitter}}])}(z),ML=function(){return o((function t(){r(this,t),this.released=!1,this.currentTime=-1}),[{key:"tick",value:function(t,e){this.currentTime<0&&(this.currentTime=0),this.currentTime+=t,e(this)}},{key:"release",value:function(){this.released=!0}},{key:"getTime",value:function(){return this.currentTime}},{key:"tickTo",value:function(t,e){this.currentTime<0&&(this.currentTime=0);var i=t-this.currentTime;this.tick(i,e)}}])}(),wL=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).lastFrameTime=0,i.status=Jc.RUNNING,i}return h(e,t),o(e,[{key:"setupTickHandler",value:function(){var t=new ML;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}},{key:"checkSkip",value:function(t){return!1}},{key:"getTime",value:function(){return this.tickerHandler.getTime()}},{key:"tickAt",value:function(t){this.tickTo(t)}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.status===Jc.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!t){if(this.status===Jc.PAUSE)return!1;if(this.ifCanStop())return!1}return this.status=Jc.RUNNING,!0}}])}(CL),TL=function(){function t(){r(this,t),this.transitions=new Map,this.registerDefaultTransitions()}return o(t,[{key:"registerDefaultTransitions",value:function(){this.registerTransition("appear","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("appear","appear",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("appear","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("appear","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("normal","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("normal","normal",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("normal","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("normal","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("exit","*",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("exit","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("exit","enter",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("exit","exit",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("enter","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("enter","enter",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("enter","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("enter","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("disappear","*",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("disappear","appear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("update","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("update","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("update","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("state","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("state","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("state","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}}))}},{key:"isTransitionAllowed",value:function(t,e,i){var n,r,a,o,s=null===(n=this.transitions.get(t))||void 0===n?void 0:n.get(e);return s?s(i,t):(s=null===(r=this.transitions.get(t))||void 0===r?void 0:r.get("*"))?s(i,t):(s=null===(a=this.transitions.get("*"))||void 0===a?void 0:a.get(e))?s(i,t):(s=null===(o=this.transitions.get("*"))||void 0===o?void 0:o.get("*"))?s(i,t):{allowTransition:!0,stopOriginalTransition:!0}}},{key:"registerTransition",value:function(t,e,i){var n=this.transitions.get(t);n||(n=new Map,this.transitions.set(t,n)),n.set(e,i)}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}();TL.getInstance();var DL=function(){function t(e){r(this,t),this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=e}return o(t,[{key:"started",get:function(){return this._started}},{key:"onStart",value:function(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach((function(t){t()}))}},{key:"onEnd",value:function(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach((function(t){t()}))}},{key:"_trackAnimation",value:function(t){var e=this;this._animates.push(t),this._activeCount++,1!==this._activeCount||this._started||(this._started=!0,this.onStart()),t.onEnd((function(){e._activeCount--;var i=e._animates.indexOf(t);i>=0&&e._animates.splice(i,1),0===e._activeCount&&e._started&&(e._started=!1,e.onEnd())}))}},{key:"parseParams",value:function(e,i,n){var r,a,o=this,s=this.resolveValue(e.totalTime,void 0,void 0),l=this.resolveValue(e.startTime,void 0,0),u=Object.assign({},e);u.oneByOneDelay=0,u.startTime=l,u.totalTime=s;var c=this.resolveValue(e.oneByOne,n,!1);if(i){var h=u.timeSlices;Z(h)||(u.timeSlices=[h]);var d=0;u.timeSlices=u.timeSlices.map((function(t){var e=o.resolveValue(t.delay,n,0),i=o.resolveValue(t.delayAfter,n,0),r=o.resolveValue(t.duration,n,300);return d+=e+r+i,Object.assign(Object.assign({},t),{delay:e,delayAfter:i,duration:r})}));var p=0;c&&(p="number"==typeof c?c:c?d:0),u.oneByOneDelay=p;var f=1;if(s){var v=d+p*(this._target.count-2);f=s?s/v:1}u.timeSlices=u.timeSlices.map((function(e){var i=e.effects;return Array.isArray(i)||(i=[i]),Object.assign(Object.assign({},e),{delay:e.delay*f,delayAfter:e.delayAfter*f,duration:e.duration*f,effects:i.map((function(e){var i,n,r=null!==(i=e.custom)&&void 0!==i?i:t.builtInAnimateMap[null!==(n=e.type)&&void 0!==n?n:"fromTo"],a=r&&U(r)?/^class\s/.test(Function.prototype.toString.call(r))?1:2:0;return Object.assign(Object.assign({},e),{custom:r,customType:a})}))})})),u.oneByOneDelay=p*f,u.startTime=l*f}else{var g=this.resolveValue(e.delay,n,0),y=this.resolveValue(e.delayAfter,n,0),m=this.resolveValue(e.duration,n,300),_=0;c&&(_="number"==typeof c?c:c?g+y+m:0),u.oneByOneDelay=_,u.custom=null!==(r=e.custom)&&void 0!==r?r:t.builtInAnimateMap[null!==(a=e.type)&&void 0!==a?a:"fromTo"];var b=u.custom&&U(u.custom)?/^class\s/.test(Function.prototype.toString.call(u.custom))?1:2:0;if(u.customType=b,s){var x=g+y+m+_*(this._target.count-2),k=s?s/x:1;u.delay=g*k,u.delayAfter=y*k,u.duration=m*k,u.oneByOneDelay=_*k,u.startTime=l}}return u}},{key:"execute",value:function(t){var e=this;Array.isArray(t)?t.forEach((function(t){return e._execute(t)})):this._execute(t)}},{key:"_execute",value:function(t){var e=this;if(t.selfOnly)return this._executeItem(t,this._target,0,1);var i,n="timeSlices"in t;n&&t.partitioner&&(i=(null!=i?i:this._target.getChildren()).filter((function(e){var i,n;return t.partitioner(null===(n=null===(i=e.context)||void 0===i?void 0:i.data)||void 0===n?void 0:n[0],e,{})}))),n&&t.sort&&(i=null!=i?i:this._target.getChildren()).sort((function(e,i){var n,r,a,o;return t.sort(null===(r=null===(n=e.context)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0],null===(o=null===(a=i.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],e,i,{})}));var r=n?function(i,r,a){var o=e.parseParams(t,n,i),s=e.executeTimelineItem(o,i,r,a);s&&e._trackAnimation(s)}:function(i,r,a){var o=e.parseParams(t,n,i),s=e.executeTypeConfigItem(o,i,r,a);s&&e._trackAnimation(s)};i?i.forEach((function(t,e){return r(t,e,i.length)})):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((function(t,i){return r(t,i,e._target.count-1)}))}},{key:"executeTypeConfigItem",value:function(t,e,i,n){var r,a,o,s,l,u,c,h,d=t.type,p=void 0===d?"fromTo":d,f=t.channel,v=t.customParameters,g=t.easing,y=void 0===g?"linear":g,m=t.delay,_=void 0===m?0:m,b=t.delayAfter,x=void 0===b?0:b,k=t.duration,S=void 0===k?300:k,A=t.startTime,C=void 0===A?0:A,M=t.oneByOneDelay,w=void 0===M?0:M,T=t.loop,D=t.bounce,E=t.priority,B=void 0===E?0:E,P=t.options,R=t.custom,L=t.customType,I=t.controlOptions,F=e.animate();F.priority=B;var O=U(_)?_(null===(a=null===(r=e.context)||void 0===r?void 0:r.data)||void 0===a?void 0:a[0],e,{}):_,z=null===(s=null===(o=e.context)||void 0===o?void 0:o.data)||void 0===s?void 0:s[0],H=null===(l=e.context)||void 0===l?void 0:l.indexKey;z&&H&&(i=null!==(u=z[H])&&void 0!==u?u:i),F.startAt(C);var N=i*w+O;N>0&&F.wait(N);var j=null,V=t.to,W=t.from;V||(j||(j=this.createPropsFromChannel(f,e)),V=j.props),W||(j||(j=this.createPropsFromChannel(f,e)),W=j.from),this._handleRunAnimate(F,R,L,W,V,S,y,v,I,P,p,e);var G=0;w&&(G=w*(n-i-1));var Y=U(x)?x(null===(h=null===(c=e.context)||void 0===c?void 0:c.data)||void 0===h?void 0:h[0],e,{}):x;return Y>0&&(G+=Y),G>0&&F.wait(G),T&&T>0&&F.loop(T),D&&F.bounce(!0),F}},{key:"_handleRunAnimate",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d,p,f,v,g,y,m,_;if(e&&i){var b=this.resolveValue(s,h);"function"==typeof b&&(b=b(null===(p=null===(d=h.context)||void 0===d?void 0:d.data)||void 0===p?void 0:p[0],h,{})),b=Object.assign({width:(null===(f=h.stage)||void 0===f?void 0:f.width)||0,height:(null===(v=h.stage)||void 0===v?void 0:v.height)||0,group:this._target.parent},b);var x=U(u)?u.call(null,null!==(y=b&&(null===(g=b.data)||void 0===g?void 0:g[0]))&&void 0!==y?y:null===(_=null===(m=h.context)||void 0===m?void 0:m.data)||void 0===_?void 0:_[0],h,b):u;b.options=x,b.controlOptions=l,1===i?this.createCustomAnimation(t,e,n,r,a,o,b):2===i&&this.createCustomInterpolatorAnimation(t,e,r,a,o,b)}else"to"===c?t.to(r,a,o):"from"===c&&t.from(r,a,o)}},{key:"executeTimelineItem",value:function(t,e,i,n){var r,a,o,s,l=this,u=t.timeSlices,c=t.startTime,h=void 0===c?0:c,d=t.loop,p=t.bounce,f=t.oneByOneDelay,v=t.priority,g=t.controlOptions,y=null===(a=null===(r=e.context)||void 0===r?void 0:r.data)||void 0===a?void 0:a[0],m=null===(o=e.context)||void 0===o?void 0:o.indexKey;y&&m&&(i=null!==(s=y[m])&&void 0!==s?s:i);var _=e.animate();return _.priority=v,_.startAt(h),_.wait(i*f),d&&d>0&&_.loop(d),p&&_.bounce(!0),(Array.isArray(u)?u:[u]).forEach((function(t){l.applyTimeSliceToAnimate(t,_,e,g)})),f&&_.wait(f*(n-i-1)),_}},{key:"applyTimeSliceToAnimate",value:function(e,i,n,r){var a,o,s,l,u=this,c=e.effects,h=e.duration,d=void 0===h?300:h,p=e.delay,f=void 0===p?0:p,v=e.delayAfter,g=void 0===v?0:v,y=U(f)?f(null===(o=null===(a=n.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],n,{}):f,m=U(g)?g(null===(l=null===(s=n.context)||void 0===s?void 0:s.data)||void 0===l?void 0:l[0],n,{}):g;y>0&&i.wait(y),(Array.isArray(c)?c:[c]).forEach((function(e){var a,o=e.type,s=void 0===o?"fromTo":o,l=e.channel,c=e.customParameters,h=e.easing,p=void 0===h?"linear":h,f=e.options,v=null,g=e.to,y=e.from;g||(v||(v=u.createPropsFromChannel(l,n)),g=v.props),y||(v||(v=u.createPropsFromChannel(l,n)),y=v.from);var m=null!==(a=e.custom)&&void 0!==a?a:t.builtInAnimateMap[s],_=e.customType;u._handleRunAnimate(i,m,_,y,g,d,p,c,r,f,s,n)})),m>0&&i.wait(m)}},{key:"createCustomInterpolatorAnimation",value:function(t,e,i,n,r,a){var o=i;Object.keys(o).forEach((function(e){t.target.getComputedAttribute(e)})),t.interpolateUpdateFunction=function(i,n,r,o,s){e(r,i,n,o,s,t.target,a)},t.to(i,n,r)}},{key:"createCustomAnimation",value:function(t,e,i,n,r,a,o){var s=new e(i,n,r,a,o);t.play(s)}},{key:"createPropsFromChannel",value:function(t,e){var i={},n=null;return t?(Array.isArray(t)?t.forEach((function(t){var n,r,a=null===(r=null===(n=e.context)||void 0===n?void 0:n.diffAttrs)||void 0===r?void 0:r[t];void 0!==a&&(i[t]=a)})):Object.keys(t).forEach((function(r){var a,o,s,l,u=t[r];void 0!==u.to&&("function"==typeof u.to?i[r]=u.to(null===(o=null===(a=e.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],e,{}):i[r]=u.to),void 0!==u.from&&(n||(n={}),"function"==typeof u.from?n[r]=u.from(null===(l=null===(s=e.context)||void 0===s?void 0:s.data)||void 0===l?void 0:l[0],e,{}):n[r]=u.from)})),{from:n,props:i}):{from:n,props:i}}},{key:"resolveValue",value:function(t,e,i){var n,r;return void 0===t?i:"function"==typeof t&&e?t(null===(r=null===(n=e.context)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0],e,{}):t}},{key:"executeItem",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.isArray(t)?t.map((function(t){return i._executeItem(t,e,n,r)})).filter(Boolean):[this._executeItem(t,e,n,r)].filter(Boolean)}},{key:"_executeItem",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return null;var r,a="timeSlices"in t,o=this.parseParams(t,a);return(r=a?this.executeTimelineItem(o,e,i,n):this.executeTypeConfigItem(o,e,i,n))&&this._trackAnimation(r),r}},{key:"stop",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._animates.length>0;){var i=this._animates.pop();!1===e&&(i.status=$c.END),null==i||i.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,e&&this.onEnd())}}],[{key:"registerBuiltInAnimate",value:function(e,i){t.builtInAnimateMap[e]=i}}])}();DL.builtInAnimateMap={};var EL="appear",BL="disappear",PL="update",RL="highlight",LL="unhighlight",IL=function(){return o((function t(e){r(this,t),this.graphic=e}),[{key:"registerState",value:function(t){this.states||(this.states=new Map),this.states.set(t.name,t)}},{key:"clearStates",value:function(){var t;null===(t=this.states)||void 0===t||t.clear()}}])}(),FL=function(){return o((function t(e){r(this,t),this.stateList=null,this.graphic=e}),[{key:"applyState",value:function(t,e,i){var n,r=this,a=TL.getInstance(),o=[],s=[];if(this.stateList&&this.stateList.length?t.forEach((function(t,i){var n={allowTransition:!0,stopOriginalTransition:!0};r.stateList.forEach((function(e){var i=a.isTransitionAllowed(e.state,t,r.graphic);n.allowTransition=n.allowTransition&&i.allowTransition})),n.allowTransition&&(s.push({state:t,animationConfig:Z(e[i])?e[i].map((function(t){return t.animation})):e[i].animation,executor:new DL(r.graphic)}),r.stateList.forEach((function(e){a.isTransitionAllowed(e.state,t,r.graphic).stopOriginalTransition&&o.push(e)})))})):t.forEach((function(t,i){s.push({state:t,animationConfig:Z(e[i])?e[i].map((function(t){return t.animation})):e[i].animation,executor:new DL(r.graphic)})})),o.forEach((function(t){t.executor.stop(null,!1)})),s.length){s[0].executor.execute(s[0].animationConfig);for(var l=function(t){var e=s[t+1],n=s[t];n.executor.onEnd((function(){e&&e.executor.execute(e.animationConfig),r.stateList=r.stateList.filter((function(t){return t!==n})),t===s.length-1&&i&&i(!1)}))},u=0;u<s.length;u++)l(u)}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter((function(t){return!o.includes(t)})):this.stateList=[],(n=this.stateList).push.apply(n,s)}},{key:"applyAppearState",value:function(t,e){this.applyState([EL],[{name:EL,animation:t}],e)}},{key:"applyDisappearState",value:function(t,e){this.applyState([BL],[{name:BL,animation:t}],e)}},{key:"applyUpdateState",value:function(t,e){this.applyState([PL],[{name:PL,animation:t}],e)}},{key:"applyHighlightState",value:function(t,e){this.applyState([RL],[{name:RL,animation:t}],e)}},{key:"applyUnhighlightState",value:function(t,e){this.applyState([LL],[{name:LL,animation:t}],e)}},{key:"stopState",value:function(t,e){var i,n=null===(i=this.stateList)||void 0===i?void 0:i.find((function(e){return e.state===t}));n&&n.executor.stop(e)}},{key:"clearState",value:function(){var t;null===(t=this.stateList)||void 0===t||t.forEach((function(t){t.executor.stop(null,!1)})),this.stateList=null}},{key:"reApplyState",value:function(t){var e,i=null===(e=this.stateList)||void 0===e?void 0:e.find((function(e){return e.state===t}));if(i&&i.executor.started){var n=this.stateList.slice();i.executor.stop(),this.stateList=n,i.executor.execute(i.animationConfig)}}}])}(),OL=function(){function t(){r(this,t)}return o(t,[{key:"_getAnimationStateManager",value:function(t){return t._animationStateManager||(t._animationStateManager=new FL(t)),t._animationStateManager}},{key:"_getAnimationStateStore",value:function(t){return t._animationStateStore||(t._animationStateStore=new IL(t)),t._animationStateStore}},{key:"registerAnimationState",value:function(t){return this._getAnimationStateStore(this).registerState(t),this}},{key:"applyAnimationState",value:function(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}},{key:"applyAppearState",value:function(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}},{key:"applyDisappearState",value:function(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}},{key:"applyUpdateState",value:function(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}},{key:"applyHighlightState",value:function(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}},{key:"applyUnhighlightState",value:function(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}},{key:"stopAnimationState",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._getAnimationStateManager(this).stopState(t,e),i&&this.isContainer&&this.forEachChildren((function(n){n.stopAnimationState(t,e,i)})),this}},{key:"clearAnimationStates",value:function(){var t=this._animationStateManager;return t&&t.clearState(),this}},{key:"reApplyAnimationState",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._animationStateManager;return i&&i.reApplyState(t),e&&this.isContainer&&this.forEachChildren((function(i){i.reApplyAnimationState(t,e)})),this}}],[{key:"extend",value:function(e){return(new t)._getAnimationStateManager(e),e}}])}(),zL=function(){return o((function t(){r(this,t)}),[{key:"getAttributes",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.finalAttribute?this.finalAttribute:this.attribute}},{key:"animate",value:function(t){var e,i,n,r=new kL(null==t?void 0:t.id,null!==(i=null!==(e=null==t?void 0:t.timeline)&&void 0!==e?e:this.stage&&this.stage.getTimeline())&&void 0!==i?i:xL,null==t?void 0:t.slience);if(r.bind(this),t){var a=t.onStart,o=t.onEnd,s=t.onRemove;null!=a&&r.onStart(a),null!=o&&r.onEnd(o),null!=s&&r.onRemove(s)}return null===(n=this.stage)||void 0===n||n.ticker.start(),r}},{key:"createTimeline",value:function(){return new bL}},{key:"createTicker",value:function(t){return new CL(t)}},{key:"setFinalAttributes",value:function(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}},{key:"initFinalAttributes",value:function(t){this.finalAttribute=t}},{key:"initAnimateExecutor",value:function(){this._animateExecutor||(this._animateExecutor=new DL(this))}},{key:"executeAnimation",value:function(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}},{key:"executeAnimations",value:function(t){var e=this;return this.initAnimateExecutor(),t.forEach((function(t){e._animateExecutor.execute(t)})),this}},{key:"getFinalAttribute",value:function(){return this.finalAttribute}},{key:"getGraphicAttribute",value:function(t){return!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}},{key:"pauseAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animates&&this.animates.forEach((function(t){return t.pause()})),t&&this.isContainer&&this.forEachChildren((function(e){e.pauseAnimation(t)}))}},{key:"resumeAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animates&&this.animates.forEach((function(t){return t.resume()})),t&&this.isContainer&&this.forEachChildren((function(e){e.resumeAnimation(t)}))}},{key:"stopAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animates&&this.animates.forEach((function(t){return t.stop()})),t&&this.isContainer&&this.forEachChildren((function(e){e.stopAnimation(t)}))}}])}();function HL(){Tt(Uy,OL),Tt(Uy,zL)}var NL=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,["customAnimate",i,a,o])).type="customAnimate",l.customFrom=t,l.params=s,l.from=t,l.to=i,l}return h(e,t),o(e,[{key:"update",value:function(t,e,i){if(this.onStart(),this.props&&this.propKeys){var n=this.easing(e);this.onUpdate(t,n,i),this.syncAttributeUpdate()}}},{key:"setProps",value:function(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}])}(mL),UL=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"completeBind",value:function(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}},{key:"stop",value:function(){this._animator&&this._animator.stop()}}])}(NL),jL=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).willCallBeforeStageRender=!0,l.willCallAfterStageRender=!0,l._beforeStageRender=function(){if(l.willCallBeforeStageRender){l.willCallBeforeStageRender=!1;var t=l.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=l.beforeStageRender(t,e);i&&l.renderToStage(t,i)}},l._afterStageRender=function(){if(l.willCallAfterStageRender){l.willCallAfterStageRender=!1;var t=l.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=l.afterStageRender(t,e);i&&l.renderToStage(t,i)}},l.props={},l}return h(e,t),o(e,[{key:"beforeStageRender",value:function(t,e){return!1}},{key:"afterStageRender",value:function(t,e){return!1}},{key:"onFirstRun",value:function(){_(e,"onFirstRun",this,3)([]),this.target.stage.setBeforeRender(this._beforeStageRender),this.target.stage.setAfterRender(this._afterStageRender),this.target.stage.disableDirtyBounds()}},{key:"stop",value:function(){_(e,"stop",this,3)([]),this.target.stage.removeBeforeRender(this._beforeStageRender),this.target.stage.removeAfterRender(this._afterStageRender)}},{key:"onUpdate",value:function(t,i,n){_(e,"onUpdate",this,3)([t,i,n]),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0}},{key:"renderToStage",value:function(t,e){var i=t.window.getContext().canvas.nativeCanvas,n=i.getContext("2d");return!!n&&(n.clearRect(0,0,i.width,i.height),n.drawImage(e,0,0),i)}}])}(NL),VL=function(){return o((function t(e){r(this,t),this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=e}),[{key:"animate",value:function(t,e){return this.started?(console.warn("Cannot add animations after animation has started"),this):(this.tasks.push({graphic:t,config:e}),this)}},{key:"onStart",value:function(t){return this.onStartCallbacks.push(t),this}},{key:"onEnd",value:function(t){return this.onEndCallbacks.push(t),this}},{key:"onUpdate",value:function(t){return this.onUpdateCallbacks.push(t),this}},{key:"start",value:function(){var t=this;return this.started?(console.warn("Animation has already started"),this):(this.started=!0,this.completed=0,this.onStartCallbacks.forEach((function(t){return t()})),0===this.tasks.length?(setTimeout((function(){t.onEndCallbacks.forEach((function(t){return t()}))}),0),this):(this.tasks.forEach((function(e){var i=new DL(e.graphic);i.onEnd((function(){t.completed++,t.completed===t.tasks.length&&t.onEndCallbacks.forEach((function(t){return t()}))}));var n=i.executeItem(e.config,e.graphic);e.animate=n,n.forEach((function(e){t.totalDuration=Math.max(t.totalDuration,e.getStartTime()+e.getDuration())}))})),this))}},{key:"deleteSelfAttr",value:function(t){this.tasks.forEach((function(e){e.animate&&e.animate.forEach((function(e){return e.preventAttr(t)}))}))}},{key:"stop",value:function(t){return this.tasks.forEach((function(e){e.animate&&e.animate.forEach((function(e){return e.stop(t)}))})),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach((function(t){return t()})),this.completed=this.tasks.length),this}},{key:"getDuration",value:function(){return this.totalDuration}}])}();function WL(t){return new VL(t)}var GL=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).formatTemplate=null,l.decimalLength=null==s?void 0:s.decimalLength,(null==s?void 0:s.formatTemplate)&&s.formatTemplate.includes("{{var}}")&&(l.formatTemplate=s.formatTemplate),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n=this.getLastProps(),r=this.getEndProps(),a=null!==(t=n.text)&&void 0!==t?t:0,o=null!==(e=r.text)&&void 0!==e?e:0;this.valid=!0;var s=0,l=0,u="",c="",h=0;if("number"==typeof a){s=a;var d=a.toString().split(".")[1]||"";h=Math.max(h,d.length)}else{if("string"!=typeof a)return void(this.valid=!1);if(a.endsWith("%")){u="%";var p=a.substring(0,a.length-1).replace(/,/g,"");if(s=parseFloat(p)/100,isNaN(s))return void(this.valid=!1);var f=p.split(".")[1]||"";h=Math.max(h,f.length+2)}else{var v=a.replace(/,/g,"");if(s=parseFloat(v),isNaN(s))return void(this.valid=!1);a.includes(",")&&(u=",");var g=v.split(".")[1]||"";h=Math.max(h,g.length)}}if("number"==typeof o){l=o;var y=o.toString().split(".")[1]||"";h=Math.max(h,y.length)}else{if("string"!=typeof o)return void(this.valid=!1);if(o.endsWith("%")){c="%";var m=o.substring(0,o.length-1).replace(/,/g,"");if(l=parseFloat(m)/100,isNaN(l))return void(this.valid=!1);var _=m.split(".")[1]||"";h=Math.max(h,_.length+2)}else{var b=o.replace(/,/g,"");if(l=parseFloat(b),isNaN(l))return void(this.valid=!1);o.includes(",")&&(c=",");var x=b.split(".")[1]||"";h=Math.max(h,x.length)}}if(null===(i=this.params)||void 0===i?void 0:i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=c||u}"%"===this.format&&"%"!==c&&"%"!==u&&void 0===this.decimalLength&&(this.decimalLength=2),"%"===this.format||"%"!==c&&"%"!==u||(s*=100,l*=100)}else this.format=c||u;this.fromNumber=s,this.toNumber=l,void 0===this.decimalLength&&(this.decimalLength=h)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||this.props&&this.target.setAttributes(this.props)}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r,a=this.fromNumber+(this.toNumber-this.fromNumber)*e,o=this.format,s=("%"===o?100*a:a).toFixed(this.decimalLength),l=s;if(parseFloat(s)===Math.floor(parseFloat(s))&&(l=Math.floor(parseFloat(s))),"%"===o)r="".concat(l,"%");else if(","===o){var u=l.toString().split(".");u[0]=u[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),r=u.join(".")}else r=l;n=this.formatTemplate?this.formatTemplate.replace("{{var}}",r.toString()):r,this.target.setAttribute("text",n)}}}])}(NL),YL=1e3,XL="quadInOut",KL=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"],qL=function(t,e,i){t.forEach((function(t){if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){var n=Sy(t.from,t.to,i,!1);n&&(e[t.key]=n)}}))},ZL=function(t,e,i){var n=[],r=[];e.clear();for(var a=0;a<t.length;a++){var o=t[a],s=o.from,l=o.to,u=o.rotation*i,c=o.fromCp,h=o.toCp,d=Math.sin(u),p=Math.cos(u);r[0]=c[0]+(h[0]-c[0])*i,r[1]=c[1]+(h[1]-c[1])*i;for(var f=0;f<s.length;f+=2){var v=s[f],g=s[f+1],y=v*(1-i)+l[f]*i,m=g*(1-i)+l[f+1]*i;n[f]=y*p-m*d+r[0],n[f+1]=y*d+m*p+r[1]}var _=n[0],b=n[1];e.moveTo(_,b);for(var x=2;x<s.length;x+=6){var k=n[x],S=n[x+1],A=n[x+2],C=n[x+3],M=n[x+4],w=n[x+5];_===k&&b===S&&A===M&&C===w?e.lineTo(M,w):e.bezierCurveTo(k,S,A,C,M,w),_=M,b=w}}},JL=function(t,e,i){var n=t?IS(t):[],r=IS(e);i&&n&&(i.fromTransform&&FS(n,i.fromTransform.clone().getInverse()),FS(n,i.toTransfrom));var a=function(t,e){for(var i,n,r=[],a=[],o=0;o<Math.max(t.length,e.length);o++){var s,l=t[o],u=e[o],c=void 0,h=void 0;l?u?(i=c=(s=m(ES(l,u),2))[0],n=h=s[1]):(h=BS(n,l),c=l):(c=BS(i,u),h=u),r.push(c),a.push(h)}return[r,a]}(n,r),o=m(a,2),s=o[0],l=o[1];return t?function(t,e,i,n){for(var r,a=[],o=0;o<t.length;o++){var s=t[o],l=e[o],u=RS(s),c=RS(l);null==r&&(r=u[2]<0!=c[2]<0);var h=[],d=[],p=0,f=1/0,v=[],g=s.length;r&&(s=PS(s));for(var y=6*LS(s,l,u,c),m=g-2,_=0;_<m;_+=2){var b=(y+_)%m+2;h[_+2]=s[b]-u[0],h[_+3]=s[b+1]-u[1]}if(h[0]=s[y]-u[0],h[1]=s[y+1]-u[1],i>0)for(var x=n/i,k=-n/2;k<=n/2;k+=x){for(var S=Math.sin(k),A=Math.cos(k),C=0,M=0;M<s.length;M+=2){var w=h[M],T=h[M+1],D=l[M]-c[0],E=l[M+1]-c[1],B=D*A-E*S,P=D*S+E*A;v[M]=B,v[M+1]=P;var R=B-w,L=P-T;C+=R*R+L*L}if(C<f){f=C,p=k;for(var I=0;I<v.length;I++)d[I]=v[I]}}else for(var F=0;F<g;F+=2)d[F]=l[F]-c[0],d[F+1]=l[F+1]-c[1];a.push({from:h,to:d,fromCp:u,toCp:c,rotation:-p})}return a}(s,l,10,Math.PI):l.map((function(t,e){return{from:s[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}}))},QL=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],$L=function(t,e){if(!t||!e)return null;var i=[],n=!1;return Object.keys(t).forEach((function(r){if(QL.includes(r)){var a=e[r];if(!j(a)&&!j(t[r])&&a!==t[r]){if("fill"===r||"stroke"===r){var o=function(t){return"string"==typeof t?xy.Get(t,gy.Color255):t};i.push({from:Z(t[r])?t[r].map(o):o(t[r]),to:Z(a)?a.map(o):o(a),key:r})}else i.push({from:t[r],to:a,key:r});n=!0}}})),n?i:null},tI=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[{},{},i,a])).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o.saveOnEnd=t.saveOnEnd,o}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this.target,r="function"==typeof n.pathProxy?n.pathProxy(n.attribute):n.pathProxy;ZL(this.morphingData,r,e),this.otherAttrs&&this.otherAttrs.length&&qL(this.otherAttrs,i,e),this.target.setAttributes(i),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}])}(NL),eI=function(t,e,i,n){var r,a,o;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;var s=null==t?void 0:t.globalTransMatrix;n&&s&&(s=n.clone().multiply(s.a,s.b,s.c,s.d,s.e,s.f));var l=JL(null===(r=null==t?void 0:t.toCustomPath)||void 0===r?void 0:r.call(t),e.toCustomPath(),{fromTransform:s,toTransfrom:e.globalTransMatrix}),u=$L(null==t?void 0:t.attribute,e.attribute),c=e.animate(i);(null==i?void 0:i.delay)&&c.wait(i.delay);var h=new tI({morphingData:l,otherAttrs:u},null!==(a=null==i?void 0:i.duration)&&void 0!==a?a:YL,null!==(o=null==i?void 0:i.easing)&&void 0!==o?o:XL);return c.play(h),c},iI=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[{},{},i,a])).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.addPathProxy()}},{key:"addPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.createPathProxy()})),this.onUpdate(!1,0,this.target.attribute)}},{key:"clearPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.pathProxy=null}))}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this;this.target.shadowRoot.forEachChildren((function(t,i){var r;ZL(n.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null===(r=n.otherAttrs)||void 0===r?void 0:r[i])&&n.otherAttrs[i].length&&qL(n.otherAttrs[i],t.attribute,e)})),t&&(this.clearPathProxy(),this.morphingData=null)}}])}(NL),nI=function(t){var e={};return Object.keys(t).forEach((function(i){(function(t){return KL.includes(t)})(i)||(e[i]=t[i])})),e},rI=function(t,e,i){var n=nI(t.attribute),r=t.attachShadow();if(e.length)r.setTheme(l({},e[0].type,n)),e.forEach((function(t){t.setAttributes({pickable:!1}),r.appendChild(t)}));else{var a=t.AABBBounds,o=a.width(),s=a.height();r.setTheme({rect:n}),new Array(i).fill(0).forEach((function(t){var i=oh.graphicService.creator.rect({x:0,y:0,width:o,height:s,pickable:!1});r.appendChild(i),e.push(i)}))}},aI=function(t,e,i){for(var n=[],r=i?null:nI(t.attribute),a=t.toCustomPath(),o=0;o<e;o++){var s={path:(new Md).fromCustomPath2D(a)};n.push(oh.graphicService.creator.path(i?s:Object.assign({},r,s)))}return i&&rI(t,n,e),n},oI=function(t,e,i){var n=[],r=i?null:nI(t.attribute);if("rect"===t.type)(function(t,e){for(var i=Vm(t.attribute),n=i.width,r=i.height,a=zS(n,r,e),o=[],s=r/a.length,l=0,u=a.length;l<u;l++)for(var c=a[l],h=n/c,d=0;d<c;d++)o.push({x:0+d*h,y:0+l*s,width:h,height:s});return o})(t,e).forEach((function(t){n.push(oh.graphicService.creator.rect(i?t:Object.assign({},r,t)))}));else if("arc"===t.type)(function(t,e){for(var i=t.getParsedAngle(),n=i.startAngle,r=i.endAngle,a=t.getComputedAttribute("innerRadius"),o=t.getComputedAttribute("outerRadius"),s=Math.abs(n-r),l=Math.abs(o-a),u=zS(s*(a+o)/2,l,e),c=[],h=l/u.length,d=o>=a?1:-1,p=r>=n?1:-1,f=0,v=u.length;f<v;f++)for(var g=u[f],y=s/g,m=0;m<g;m++)c.push({innerRadius:o-h*f*d,outerRadius:o-h*(f+1)*d,startAngle:n+y*m*p,endAngle:n+y*(m+1)*p});return c})(t,e).forEach((function(t){n.push(oh.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("circle"===t.type)(function(t,e){for(var i=t.getComputedAttribute("startAngle"),n=t.getComputedAttribute("endAngle"),r=t.getComputedAttribute("radius"),a=Math.abs(i-n),o=zS(a*r,r,e),s=[],l=a/o[0],u=r/o.length,c=n>=i?1:-1,h=0,d=o.length;h<d;h++)for(var p=0,f=o[h];p<f;p++)s.push({innerRadius:u*h,outerRadius:u*(h+1),startAngle:i+l*p*c,endAngle:i+l*(p+1)*c});return s})(t,e).forEach((function(t){n.push(oh.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("line"===t.type){var a=function(t,e){var i=t.attribute,n=i.points;if(n)return HS(n,e);if(i.segments){var r=i.segments.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]);return HS(r,e)}return[]}(t,e),o={size:10,symbolType:"circle"};a.forEach((function(t){n.push(oh.graphicService.creator.symbol(i?Object.assign({},t,o):Object.assign({},r,t,o)))}))}else"polygon"===t.type?function(t,e){var i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:US(i)}];var n=[];return VS(i,e,n),n}(t,e).forEach((function(t){n.push(oh.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"area"===t.type?function(t,e){var i,n,r=t.attribute,a=r.points,o=r.segments;a||(a=o.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]));var s=a.filter((function(t){return!1!==t.defined&&$(t.x)&&$(t.y)}));if(!s.length)return[];var l=[];s.forEach((function(t){l.push({x:t.x,y:t.y})}));for(var u=s.length-1;u>=0;u--){var c=s[u];l.push({x:null!==(i=c.x1)&&void 0!==i?i:c.x,y:null!==(n=c.y1)&&void 0!==n?n:c.y})}var h=[];return VS(l,e,h),h}(t,e).forEach((function(t){n.push(oh.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"path"===t.type&&function(t,e){var i=IS(t.getParsedPathShape());if(!i.length||e<0)return[];var n=i.length;if(i.length>=e){for(var r=[],a=Math.floor(i.length/e),o=0;o<e;o++){var s=i.slice(o*a,o===e-1?n:(o+1)*a);r.push({path:OS(s)})}return r}for(var l=[],u=Math.floor(e/n),c=e,h=0;h<n;h++){for(var d=[],p=2,f=i[h].length;p<f;p+=2)d.push({x:i[0][p],y:i[0][p+1]});VS(d,h===n-1?c:u,l),c-=u}return l}(t,e).forEach((function(t){"path"in t?n.push(oh.graphicService.creator.path(i?t:Object.assign({},r,t))):n.push(oh.graphicService.creator.polygon(i?t:Object.assign({},r,t)))}));return i&&rI(t,n,e),n},sI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromText="",l.toText="",l.showCursor=!1,l.cursorChar="|",l.blinkCursor=!0,l.beforeText="",l.afterText="",void 0!==(null==s?void 0:s.showCursor)&&(l.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(l.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(l.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.beforeText)&&(l.beforeText=s.beforeText),void 0!==(null==s?void 0:s.afterText)&&(l.afterText=s.afterText),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i=this.getLastProps(),n=this.getEndProps(),r=null!==(t=i.text)&&void 0!==t?t:"",a=null!==(e=n.text)&&void 0!==e?e:"";this.valid=!0,this.fromText=r.toString(),this.toText=a.toString(),this.toText||""===this.toText||(this.valid=!1)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r,a=this.toText.length,o=this.fromText.length;o>a?(n=Math.round(o-(o-a)*e),r=this.fromText.substring(0,n)):(n=Math.round(o+(a-o)*e),r=this.toText.startsWith(this.fromText)?this.toText.substring(0,n):n<=o?this.fromText.substring(0,n):this.toText.substring(0,n-o+Math.min(o,n)));var s=this.beforeText+r+this.afterText;if(this.showCursor)if(this.blinkCursor){Math.floor(e/.1)%2==0&&(s=this.beforeText+r+this.cursorChar+this.afterText)}else s=this.beforeText+r+this.cursorChar+this.afterText;this.target.setAttribute("text",s)}}}])}(NL),lI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[null,{},a,o,s])).clipFromAttribute=t,l.clipToAttribute=i,l._group=null==s?void 0:s.group,l._clipGraphic=null==s?void 0:s.clipGraphic,l}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]),this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:Sh.ANIMATE_BIND}))}},{key:"onEnd",value:function(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:Sh.ANIMATE_END})}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this._clipGraphic){var r={};Object.keys(this.clipFromAttribute).forEach((function(t){r[t]=n.clipFromAttribute[t]+(n.clipToAttribute[t]-n.clipFromAttribute[t])*e})),this._clipGraphic.setAttributes(r,!1,{type:Sh.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}}])}(NL),uI=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p,f,v,g,y,m,_;r(this,e);var b=null!==(u=null===(l=null==s?void 0:s.group)||void 0===l?void 0:l.attribute)&&void 0!==u?u:{},x=null!==(c=b.width)&&void 0!==c?c:0,k=null!==(h=b.height)&&void 0!==h?h:0,S=null!==(d=null==s?void 0:s.animationType)&&void 0!==d?d:"in",A=null!==(p=null==s?void 0:s.startAngle)&&void 0!==p?p:0,C=null!==(f=null==s?void 0:s.orient)&&void 0!==f?f:"clockwise",M=0,w=0;"anticlockwise"===C?(w="in"===S?A+2*Math.PI:A,w=A+2*Math.PI):(M=A,w="out"===S?A+2*Math.PI:A);var T,D,E=oh.graphicService.creator.arc({x:null!==(g=null===(v=null==s?void 0:s.center)||void 0===v?void 0:v.x)&&void 0!==g?g:x/2,y:null!==(m=null===(y=null==s?void 0:s.center)||void 0===y?void 0:y.y)&&void 0!==m?m:k/2,outerRadius:null!==(_=null==s?void 0:s.radius)&&void 0!==_?_:(x+k)/2,innerRadius:0,startAngle:M,endAngle:w,fill:!0});return"anticlockwise"===C?(T={startAngle:A+2*Math.PI},D={startAngle:A}):(T={endAngle:A},D={endAngle:A+2*Math.PI}),n(this,e,["in"===S?T:D,"in"===S?D:T,a,o,{group:null==s?void 0:s.group,clipGraphic:E}])}return h(e,t),o(e)}(lI),cI=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p,f,v,g;r(this,e);var y=null!==(u=null===(l=null==s?void 0:s.group)||void 0===l?void 0:l.attribute)&&void 0!==u?u:{},m=null!==(h=null!==(c=null==s?void 0:s.width)&&void 0!==c?c:y.width)&&void 0!==h?h:0,_=null!==(p=null!==(d=null==s?void 0:s.height)&&void 0!==d?d:y.height)&&void 0!==p?p:0,b=null!==(f=null==s?void 0:s.animationType)&&void 0!==f?f:"in",x=null!==(v=null==s?void 0:s.direction)&&void 0!==v?v:"x",k=null!==(g=null==s?void 0:s.orient)&&void 0!==g?g:"positive",S=oh.graphicService.creator.rect({x:0,y:0,width:"in"===b&&"x"===x?0:m,height:"in"===b&&"y"===x?0:_,fill:!0}),A={},C={};return"y"===x?"negative"===k?(A={y:_,height:0},C={y:0,height:_}):(A={height:0},C={height:_}):"negative"===k?(A={x:m,width:0},C={x:0,width:m}):(A={width:0},C={width:m}),n(this,e,["in"===b?A:C,"in"===b?C:A,a,o,{group:null==s?void 0:s.group,clipGraphic:S}])}return h(e,t),o(e)}(lI),hI=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).newPointAnimateType=null!==(u=null==s?void 0:s.newPointAnimateType)&&void 0!==u?u:"grow",l.clipRangeByDimension=null!==(c=null==s?void 0:s.clipRangeByDimension)&&void 0!==c?c:"x",l}return h(e,t),o(e,[{key:"getPoints",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.points)return t.points;if(t.segments){var n=[];return this.segmentsCache||(this.segmentsCache=[]),t.segments.map((function(t){var r,a;t.points&&n.push.apply(n,b(t.points)),i&&e.segmentsCache.push(null!==(a=null===(r=t.points)||void 0===r?void 0:r.length)&&void 0!==a?a:0)})),n}return[]}},{key:"onBind",value:function(){var t=this;_(e,"onBind",this,3)([]);var i=this.target.attribute,n=i.points,r=i.segments,a=this.target.getFinalAttribute(),o=a.points,s=a.segments;this.from={points:n,segments:r},this.to={points:o,segments:s},this.props=this.to;var l=this.getPoints(this.from),u=this.getPoints(this.to,!0);this.fromPoints=l?Array.isArray(l)?l:[l]:[],this.toPoints=u?Array.isArray(u)?u:[u]:[];var c=new Map;this.fromPoints.forEach((function(t){t.context&&c.set(t.context,t)}));for(var h,d,p=1/0,f=-1/0,v=0;v<this.toPoints.length;v+=1)if(c.has(this.toPoints[v].context)){p=v,h=c.get(this.toPoints[v].context);break}for(var g=this.toPoints.length-1;g>=0;g-=1)if(c.has(this.toPoints[g].context)){f=g,d=c.get(this.toPoints[g].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(f)?(this.clipRange=this.toPoints[f][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],1===this.clipRange&&(this.shrinkClipRange=this.toPoints[f][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),it(this.clipRange)?this.clipRange=he(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);var y=this.toPoints[0];this.interpolatePoints=this.toPoints.map((function(e,i){var n=c.get(e.context);return n?(y=n,[n,e]):"appear"===t.newPointAnimateType||"clip"===t.newPointAnimateType?[e,e]:i<p&&h?[h,e]:i>f&&d?[d,e]:[y,e]})),this.points=this.interpolatePoints.map((function(t){var e=t[0],i=t[1],n=new ki(e.x,e.y,e.x1,e.y1);return n.defined=i.defined,n.context=i.context,n}))}},{key:"onFirstRun",value:function(){var t=this.target.attribute.clipRange;it(t*this.clipRange)&&(this.clipRange*=t)}},{key:"onUpdate",value:function(t,e,i){var n=this;if(t)return Object.keys(this.to).forEach((function(t){n.target.attribute[t]=n.to[t]})),this.target.addUpdatePositionTag(),void this.target.addUpdateShapeAndBoundsTag();if(this.points=this.points.map((function(t,i){var r=zf(n.interpolatePoints[i][0],n.interpolatePoints[i][1],e);return r.context=t.context,r})),this.clipRange){if(this.shrinkClipRange)return void(t?(i.points=this.toPoints,i.clipRange=1):(i.points=this.fromPoints,i.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*e));this.target.setAttributes({clipRange:this.clipRange+(1-this.clipRange)*e})}if(this.segmentsCache&&this.to.segments){var r=0,a=this.to.segments.map((function(t,e){var i=r+n.segmentsCache[e],a=n.points.slice(r,i);return r=i,Object.assign(Object.assign({},t),{points:a})}));this.target.attribute.segments=a}else this.target.attribute.points=this.points;this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),dI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=this.target.getFinalAttribute(),a=null!==(t=this.target.attribute)&&void 0!==t?t:{},o={},s=null!==(i=this.from)&&void 0!==i?i:{};this.keys.forEach((function(t){var e,i,n;o[t]=null!==(e=null==r?void 0:r[t])&&void 0!==e?e:1,s[t]=null!==(n=null!==(i=s[t])&&void 0!==i?i:a[t])&&void 0!==n?n:0}));var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),this.props=o,this.propKeys=this.keys,this.from=s,this.to=o,!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),pI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=this.target.attribute,i={},n={};this.keys.forEach((function(e){var r;i[e]=0,n[e]=null!==(r=t[e])&&void 0!==r?r:1})),this.props=i,this.propKeys=this.keys,this.from=n,this.to=i,Object.assign(this.target.attribute,n),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),fI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]),this.propKeys=["x","y","z","alpha","zIndex"]}},{key:"onFirstRun",value:function(){_(e,"onFirstRun",this,3)([]);var t=this.target.getFinalAttribute();t&&this.target.setAttributes(t)}},{key:"onStart",value:function(){_(e,"onStart",this,3)([]);var t="function"==typeof this.params?this.params():this.params,i=t.center,n=t.r,r=this.target.finalAttribute.x,a=this.target.finalAttribute.y,o=this.target.finalAttribute.z,s=Math.acos((a-i.y)/n),l=Math.acos((r-i.x)/n/Math.sin(s));o-i.z<0&&(l=ei-l),this.theta=l,this.phi=s}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){if(null!=this.phi&&null!=this.theta){var n=this.target,r="function"==typeof this.params?this.params():this.params,a=r.center,o=r.r,s=r.cb,l=2*Math.PI*e,u=this.theta+l,c=this.phi,h=o*Math.sin(c)*Math.cos(u)+a.x,d=o*Math.cos(c)+a.y,p=o*Math.sin(c)*Math.sin(u)+a.z;for(n.attribute.x=h,n.attribute.y=d,n.attribute.z=p,n.attribute.alpha=u+Qe/2;n.attribute.alpha>ei;)n.attribute.alpha-=ei;n.attribute.alpha=ei-n.attribute.alpha,n.attribute.zIndex=-1e4*n.attribute.z,s&&s(i)}}}])}(NL),vI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["clipRange"],l.from={clipRange:0},l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t;_(e,"onFirstRun",this,3)([]);var i=((null===(t=this.params)||void 0===t?void 0:t.options)||{}).clipDimension;i&&(this.target.attribute.clipRangeByDimension=i)}}])}(dI),gI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["clipRange"],l}return h(e,t),o(e)}(pI),yI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["opacity","fillOpacity","strokeOpacity"],l.from={opacity:0,fillOpacity:0,strokeOpacity:0},l}return h(e,t),o(e)}(dI),mI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["opacity","fillOpacity","strokeOpacity"],l}return h(e,t),o(e)}(pI),_I=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAttribute();if(e&&"anticlockwise"===e.orient){var r=$(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r,endAngle:r},to:{startAngle:null==n?void 0:n.startAngle,endAngle:null==n?void 0:n.endAngle}}}var a=$(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:a,endAngle:a},to:{startAngle:null==n?void 0:n.startAngle,endAngle:null==n?void 0:n.endAngle}}}(t,e):function(t,e,i){var n=t.getFinalAttribute();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==n?void 0:n.endAngle},to:{startAngle:null==n?void 0:n.startAngle}}:{from:{endAngle:null==n?void 0:n.startAngle},to:{endAngle:null==n?void 0:n.endAngle}}}(t,e)},bI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"determineUpdateFunction",value:function(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}},{key:"deleteSelfAttr",value:function(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];var e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this._updateFunction=null}},{key:"updateStartAngle",value:function(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}},{key:"updateEndAngle",value:function(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}},{key:"updateAngle",value:function(t){this.updateStartAngle(t),this.updateEndAngle(t)}},{key:"onUpdate",value:function(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}])}(NL),xI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=_I(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s),this.determineUpdateFunction()}}])}(bI),kI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r=(t=this.target,i=this.params.options,this.params,!1!==(null!==(n=null==i?void 0:i.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.attribute;if(e&&"anticlockwise"===e.orient){var r=$(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:n.startAngle,endAngle:n.endAngle},to:{startAngle:r,endAngle:r}}}var a=$(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:n.startAngle,endAngle:n.endAngle},to:{startAngle:a,endAngle:a}}}(t,i):function(t,e,i){var n=t.attribute;return e&&"anticlockwise"===e.orient?{from:{startAngle:n.startAngle},to:{startAngle:null==n?void 0:n.endAngle}}:{from:{endAngle:n.endAngle},to:{endAngle:null==n?void 0:n.startAngle}}}(t,i)),a=r.from,o=r.to,s=a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=null!=s?s:this.target.attribute,this.to=o,this.determineUpdateFunction()}}])}(bI),SI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=function(t,e,i){var n=t.getFinalAttribute();switch(null==e?void 0:e.direction){case"x":var r=n.x,a=n.x1,o=n.width;return{from:W(o)?{x:r+o/2,x1:void 0,width:0}:{x:(r+a)/2,x1:(r+a)/2,width:void 0},to:{x:r,x1:a,width:o}};case"y":var s=n.y,l=n.y1,u=n.height;return{from:W(u)?{y:s+u/2,y1:void 0,height:0}:{y:(s+l)/2,y1:(s+l)/2,height:void 0},to:{y:s,y1:l,height:u}};default:var c=n.x,h=n.x1,d=n.width,p=n.y,f=n.y1,v=n.height,g={};return W(d)?(g.x=c+d/2,g.width=0,g.x1=void 0):(g.x=(c+h)/2,g.x1=(c+h)/2,g.width=void 0),W(v)?(g.y=p+v/2,g.height=0,g.y1=void 0):(g.y=(p+f)/2,g.y1=(p+f)/2,g.height=void 0),{from:g,to:{x:c,y:p,x1:h,y1:f,width:d,height:v}}}}(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),AI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=function(t,e,i){var n=t.attribute;switch(null==e?void 0:e.direction){case"x":var r=n.x,a=n.x1,o=n.width;return{to:W(o)?{x:r+o/2,x1:void 0,width:0}:{x:(r+a)/2,x1:(r+a)/2,width:void 0}};case"y":var s=n.y,l=n.y1,u=n.height;return{to:W(u)?{y:s+u/2,y1:void 0,height:0}:{y:(s+l)/2,y1:(s+l)/2,height:void 0}};default:var c=n.x,h=n.y,d=n.x1,p=n.y1,f=n.width,v=n.height,g={};return W(f)?(g.x=c+f/2,g.width=0,g.x1=void 0):(g.x=(c+d)/2,g.x1=(c+d)/2,g.width=void 0),W(v)?(g.y=h+v/2,g.height=0,g.y1=void 0):(g.y=(h+p)/2,g.y1=(h+p)/2,g.height=void 0),{to:g}}}(this.target,this.params.options,this.params),i=t.from,n=t.to;this.props=n,this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.from=null!=i?i:this.target.attribute,this.to=n}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL);var CI=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a,o,s=t.getFinalAttribute(),l=s.y,u=s.y1,c=s.height;return e&&"negative"===e.orient?$(e.overall)?o=e.overall:i.group?(o=null!==(a=null!==(n=i.groupHeight)&&void 0!==n?n:null===(r=e.layoutRect)||void 0===r?void 0:r.height)&&void 0!==a?a:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=$(null==e?void 0:e.overall)?e.overall:0,{from:{y:o,y1:j(u)?void 0:o,height:j(c)?void 0:0},to:{y:l,y1:u,height:c}}}(t,e,i):function(t,e,i){var n=t.getFinalAttribute(),r=n.y,a=n.y1,o=n.height;if(e&&"negative"===e.orient){var s=W(o)?Math.max(r,r+o):Math.max(r,a);return{from:{y:s,y1:j(a)?void 0:s,height:j(o)?void 0:0},to:{y:r,y1:a,height:o}}}var l=W(o)?Math.min(r,r+o):Math.min(r,a);return{from:{y:l,y1:j(a)?void 0:l,height:j(o)?void 0:0},to:{y:r,y1:a,height:o}}}(t,e)},MI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=CI(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL);var wI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r,a=(t=this.target,i=this.params.options,n=this.params,!1!==(null!==(r=null==i?void 0:i.overall)&&void 0!==r&&r)?function(t,e,i){var n,r,a,o,s=t.getFinalAttribute(),l=s.y1,u=s.height;return e&&"negative"===e.orient?$(e.overall)?o=e.overall:i.group?(o=null!==(a=null!==(n=i.groupHeight)&&void 0!==n?n:null===(r=e.layoutRect)||void 0===r?void 0:r.height)&&void 0!==a?a:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=$(null==e?void 0:e.overall)?e.overall:0,{to:{y:o,y1:j(l)?void 0:o,height:j(u)?void 0:0}}}(t,i,n):function(t,e,i){var n=t.getFinalAttribute(),r=n.y,a=n.y1,o=n.height;if(e&&"negative"===e.orient){var s=W(o)?Math.max(r,r+o):Math.max(r,a);return{to:{y:s,y1:j(a)?void 0:s,height:j(o)?void 0:0}}}var l=W(o)?Math.min(r,r+o):Math.min(r,a);return{to:{y:l,y1:j(a)?void 0:l,height:j(o)?void 0:0}}}(t,i)),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=null!=o?o:this.target.attribute,this.to=s}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),TI=function(t,e,i){var n=t.getFinalAttribute().points,r={x:0,y:0};return n.forEach((function(t){r.x+=t.x,r.y+=t.y})),r.x/=n.length,r.y/=n.length,e&&e.center&&(it(e.center.x)&&(r.x=e.center.x),it(e.center.y)&&(r.y=e.center.y)),"area"===t.type&&(r.x1=r.x,r.y1=r.y),n.map((function(t){return Object.assign({},t,r)}))},DI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n,r,a=null===(n=this.from)||void 0===n?void 0:n.points,o=null===(r=this.to)||void 0===r?void 0:r.points;a&&o&&(this.target.attribute.points=a.map((function(t,i){return zf(a[i],o[i],e)})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}])}(NL),EI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r;if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var a=(i=this.target,n=this.params.options,this.params,r=i.getFinalAttribute(),{from:{points:TI(i,n)},to:{points:r.points}}),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=o,this.to=s;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(o)}else this.valid=!1}}])}(DI),BI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){if(_(e,"onBind",this,3)([]),["area","line"].includes(this.target.type)){var t=this.target.getFinalAttribute(),i=(a=this.target,o=this.params.options,this.params,{from:{points:a.getFinalAttribute().points},to:{points:TI(a,o)}}),n=i.from,r=i.to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=n||t,this.to=r}else this.valid=!1;var a,o}}])}(DI),PI=function(t,e,i){return t.getFinalAttribute().points.map((function(i){if(e&&"negative"===e.orient){var n=t.stage.viewWidth;return t.parent.parent.parent&&(n=t.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:n,y:i.y,x1:n,y1:i.y1,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:!1!==i.defined})}))},RI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r;if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var a=(i=this.target,n=this.params.options,this.params,r=i.getFinalAttribute(),{from:{points:PI(i,n)},to:{points:r.points}}),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=o,this.to=s;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(o)}else this.valid=!1}}])}(DI),LI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){if(_(e,"onBind",this,3)([]),["area","line"].includes(this.target.type)){var t=this.target.getFinalAttribute(),i=(a=this.target,o=this.params.options,this.params,{from:{points:a.getFinalAttribute().points},to:{points:PI(a,o)}}),n=i.from,r=i.to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=n||t,this.to=r}else this.valid=!1;var a,o}}])}(DI),II=function(t,e,i){return t.getFinalAttribute().points.map((function(i){if(e&&"negative"===e.orient){var n=t.stage.viewHeight;return t.parent.parent.parent&&(n=t.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:n,x1:i.x1,y1:n,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:!1!==i.defined})}))},FI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r;if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var a=(i=this.target,n=this.params.options,this.params,r=i.getFinalAttribute(),{from:{points:II(i,n)},to:{points:r.points}}),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=o,this.to=s;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(o)}else this.valid=!1}}])}(DI),OI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var t=(r=this.target,a=this.params.options,this.params,{from:{points:r.getFinalAttribute().points},to:{points:II(r,a)}}),i=t.from,n=t.to;this.props=n,this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.from=null!=i?i:this.target.attribute,this.to=n}else this.valid=!1;var r,a}}])}(DI),zI=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAttribute(),r=$(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:r,outerRadius:r},to:{innerRadius:null==n?void 0:n.innerRadius,outerRadius:null==n?void 0:n.outerRadius}}}(t,e):function(t,e,i){var n=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==n?void 0:n.outerRadius},to:{innerRadius:null==n?void 0:n.innerRadius}}:{from:{outerRadius:null==n?void 0:n.innerRadius},to:{outerRadius:null==n?void 0:n.outerRadius}}}(t,e)},HI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),NI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=zI(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}}])}(HI),UI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r=(t=this.target,i=this.params.options,this.params,!1!==(null!==(n=null==i?void 0:i.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAttribute(),r=$(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:null==n?void 0:n.innerRadius,outerRadius:null==n?void 0:n.outerRadius},to:{innerRadius:r,outerRadius:r}}}(t,i):function(t,e,i){var n=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==n?void 0:n.innerRadius},to:{innerRadius:null==n?void 0:n.outerRadius}}:{from:{outerRadius:null==n?void 0:n.outerRadius},to:{outerRadius:null==n?void 0:n.innerRadius}}}(t,i)).to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=this.target.attribute,this.to=r}}])}(HI);var jI=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a=t.getFinalAttribute(),o=a.x,s=a.x1,l=a.width;return e&&"negative"===e.orient?$(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=$(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:r,x1:j(s)?void 0:r,width:j(l)?void 0:0},to:{x:o,x1:s,width:l}}}(t,e,i):function(t,e,i){var n=t.getFinalAttribute(),r=n.x,a=n.x1,o=n.width;if(e&&"negative"===e.orient){var s=W(o)?Math.max(r,r+o):Math.max(r,a);return{from:{x:s,x1:j(a)?void 0:s,width:j(o)?void 0:0},to:{x:r,x1:a,width:o}}}var l=W(o)?Math.min(r,r+o):Math.min(r,a);return{from:{x:l,x1:j(a)?void 0:l,width:j(o)?void 0:0},to:{x:r,x1:a,width:o}}}(t,e)};var VI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=jI(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),WI=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r,a=(t=this.target,i=this.params.options,n=this.params,!1!==(null!==(r=null==i?void 0:i.overall)&&void 0!==r&&r)?function(t,e,i){var n,r,a=t.getFinalAttribute(),o=a.x1,s=a.width;return e&&"negative"===e.orient?$(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=$(null==e?void 0:e.overall)?e.overall:0,{to:{x:r,x1:j(o)?void 0:r,width:j(s)?void 0:0}}}(t,i,n):function(t,e,i){var n=t.getFinalAttribute(),r=n.x,a=n.x1,o=n.width;if(e&&"negative"===e.orient){var s=W(o)?Math.max(r,r+o):Math.max(r,a);return{to:{x:s,x1:j(a)?void 0:s,width:j(o)?void 0:0}}}var l=W(o)?Math.min(r,r+o):Math.min(r,a);return{to:{x:l,x1:j(a)?void 0:l,width:j(o)?void 0:0}}}(t,i)),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=null!=o?o:this.target.attribute,this.to=s}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),GI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=WL(this.target);this._animator=t;var i,n,r=this.duration,a=this.easing,o=this.target,s=this.params,l=s.symbolStartOuterType,u=void 0===l?"scale":l,c=s.titleType,h=void 0===c?"typewriter":c,d=s.titlePanelType,p=void 0===d?"scale":d,f=r/10;if(o._symbolStart.setAttributes({scaleX:0,scaleY:0}),t.animate(o._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*f,easing:a}),"scale"===u?(i={scaleX:0,scaleY:0},n={scaleX:1,scaleY:1}):(i={clipRange:0},n={clipRange:1}),o._symbolStartOuter.setAttributes(i),t.animate(o._symbolStartOuter,{type:"to",to:n,duration:5*f,easing:a}),o._symbolEnd.setAttributes({scaleX:0,scaleY:0}),t.animate(o._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*f,delay:8*f,easing:a}),o._line.setAttributes({clipRange:0}),t.animate(o._line,{type:"to",to:{clipRange:1},duration:9*f,easing:a}),"typewriter"===h){var v=o._titleTop.attribute.text;o._titleTop.setAttributes({text:""}),t.animate(o._titleTop,{type:"custom",delay:5*f,duration:4*f,easing:"linear",to:{text:v},custom:sI});var g=o._titleBottom.attribute.text;o._titleBottom.setAttributes({text:""}),t.animate(o._titleBottom,{type:"custom",delay:5*f,duration:4*f,easing:"linear",to:{text:g},custom:sI})}else o._titleTop.setAttributes({dy:o._titleTop.AABBBounds.height()+10}),t.animate(o._titleTop,{type:"to",to:{dy:0},delay:5*f,duration:4*f,easing:"linear"}),o._titleBottom.setAttributes({dy:-(10+o._titleBottom.AABBBounds.height())}),t.animate(o._titleBottom,{type:"to",to:{dy:0},delay:5*f,duration:4*f,easing:"linear"});"scale"===p?[o._titleTopPanel,o._titleBottomPanel].forEach((function(e){var i,n=null!==(i=e.attribute.scaleX)&&void 0!==i?i:1;e.setAttributes({scaleX:0}),t.animate(e,{type:"to",to:{scaleX:n},duration:r,easing:a})})):"stroke"===p&&[o._titleTopPanel,o._titleBottomPanel].forEach((function(e){var i=e.AABBBounds,n=2*(i.width()+i.height());e.setAttributes({lineDash:[0,10*n]}),t.animate(e,{type:"to",to:{lineDash:[n,10*n]},duration:r,easing:a})})),this.completeBind(t)}}])}(UL),YI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=WL(this.target);this._animator=t;var i=this.duration,n=this.easing,r=this.target;"scale"===this.params.mode?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:i,easing:n}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:i,easing:n}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:i/2,delay:i/2,easing:n}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:i,easing:n}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:i/2,easing:n}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:i/2,easing:n}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:i/2,delay:i/2,easing:n}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:i,easing:n}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:i,easing:n})),this.completeBind(t)}}])}(UL),XI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=WL(this.target);this._animator=t;var i=this.duration,n=this.easing,r=this.target,a=this.params.wave;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:i/3*2,easing:n}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:i,easing:n,custom:sI}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:i,easing:n,custom:sI}),a){var o=i/6;t.animate(r.group,{timeSlices:[{duration:o,effects:{type:"to",to:{angle:a},easing:n}},{duration:2*o,effects:{type:"to",to:{angle:-a},easing:n}},{duration:2*o,effects:{type:"to",to:{angle:a},easing:n}},{duration:o,effects:{type:"to",to:{angle:0},easing:n}}]})}this.completeBind(t)}}])}(UL),KI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=WL(this.target);this._animator=t;var i=this.duration,n=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:i,easing:n}),this.completeBind(t)}}])}(UL),qI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.showCursor=!1,l.cursorChar="|",l.blinkCursor=!0,l.fadeInChars=!1,l.fadeInDuration=.3,l.strokeFirst=!1,l.strokeToFillRatio=.3,void 0!==(null==s?void 0:s.showCursor)&&(l.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(l.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(l.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.fadeInChars)&&(l.fadeInChars=s.fadeInChars),void 0!==(null==s?void 0:s.fadeInDuration)&&(l.fadeInDuration=s.fadeInDuration),void 0!==(null==s?void 0:s.strokeFirst)&&(l.strokeFirst=s.strokeFirst),void 0!==(null==s?void 0:s.strokeToFillRatio)&&(l.strokeToFillRatio=s.strokeToFillRatio),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?b(e.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?u_.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=u_.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||this.target.setAttribute("textConfig",this.originalTextConfig)}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this.valid){var r,a,o=this.toTextConfig.length,s=this.fromTextConfig.length,l=this.fadeInChars?1-this.fadeInDuration:1;if(s>o)r=Math.round(s-(s-o)*e);else if(this.fadeInChars){var u=Math.min(1,e/l);r=Math.round(s+(o-s)*u)}else r=Math.round(s+(o-s)*e);if(a=s>o?this.fromTextConfig.slice(0,r):this.toTextConfig.slice(0,r).map((function(t,i){if("text"in t){var r=Object.assign({},t);if(n.strokeFirst){var a=i/o*l,s=Math.max(0,e-a),u=1-a,c=Math.min(1,s/(n.strokeToFillRatio*u));if("fill"in r&&r.fill&&(r.stroke=r.fill,c<1&&(r.fillOpacity=c)),n.fadeInChars){var h=Math.min(1,s/(n.fadeInDuration*u));r.opacity=Math.max(0,Math.min(1,h))}}else if(n.fadeInChars){var d=(e-i/o*l)/n.fadeInDuration;r.opacity=Math.max(0,Math.min(1,d))}return r}return t})),this.showCursor&&r<o){var c=!0;if(this.blinkCursor){c=Math.floor(e/.1)%2==0}if(c&&a.length>0){var h=a.length-1,d=a[h];if("text"in d)a[h]=Object.assign(Object.assign({},d),{text:String(d.text)+this.cursorChar});else{var p={text:this.cursorChar,fontSize:16};a.push(p)}}}this.target.setAttribute("textConfig",a)}}}])}(NL),ZI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.showCursor=!1,l.cursorChar="|",l.blinkCursor=!0,l.beforeText="",l.afterText="",l.fadeOutChars=!1,l.fadeOutDuration=.3,l.direction="backward",void 0!==(null==s?void 0:s.showCursor)&&(l.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(l.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(l.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.beforeText)&&(l.beforeText=s.beforeText),void 0!==(null==s?void 0:s.afterText)&&(l.afterText=s.afterText),void 0!==(null==s?void 0:s.fadeOutChars)&&(l.fadeOutChars=s.fadeOutChars),void 0!==(null==s?void 0:s.fadeOutDuration)&&(l.fadeOutDuration=s.fadeOutDuration),void 0!==(null==s?void 0:s.direction)&&(l.direction=s.direction),l.propKeys=["textConfig"],l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?b(t.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=u_.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?u_.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r=this.fromTextConfig.length,a=this.fadeOutChars?1-this.fadeOutDuration:1;if("forward"===this.direction){if(this.fadeOutChars){var o=Math.min(1,e/a);n=Math.round(r*(1-o))}else n=Math.round(r*(1-e));var s="forward"===this.direction?this.fromTextConfig.slice(r-n):this.fromTextConfig.slice(0,n);this.fadeOutChars&&(s=this.applyFadeEffect(s,e,r,n)),this.showCursor&&n>0&&(s=this.addCursor(s,e)),this.target.setAttribute("textConfig",s)}else{if(this.fadeOutChars){var l=Math.min(1,e/a);n=Math.round(r*(1-l))}else n=Math.round(r*(1-e));var u=this.fromTextConfig.slice(0,n);this.fadeOutChars&&(u=this.applyFadeEffect(u,e,r,n)),this.showCursor&&n>0&&(u=this.addCursor(u,e)),this.target.setAttribute("textConfig",u)}}}},{key:"applyFadeEffect",value:function(t,e,i,n){var r=this;this.direction;var a=(e-(1-this.fadeOutDuration))/this.fadeOutDuration,o=Math.max(0,1-Math.min(1,a));return t.map((function(e,i){if("forward"===r.direction){if(0===i&&"text"in e)return Object.assign(Object.assign({},e),{opacity:o})}else if(i===t.length-1&&"text"in e)return Object.assign(Object.assign({},e),{opacity:o});return e}))}},{key:"addCursor",value:function(t,e){var i=!0;if(this.blinkCursor){i=Math.floor(e/.1)%2==0}if(i&&t.length>0){var n="forward"===this.direction?0:t.length-1,r=t[n];if("text"in r){var a=b(t);return"forward"===this.direction?a[n]=Object.assign(Object.assign({},r),{text:this.cursorChar+String(r.text)}):a[n]=Object.assign(Object.assign({},r),{text:String(r.text)+this.cursorChar}),a}}return t}}])}(NL),JI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.singleCharConfig=[],l.fadeInDuration=.3,l.slideDirection="right",l.slideDistance=30,l.wordByWord=!1,l.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,l.wordGroups=[],void 0!==(null==s?void 0:s.fadeInDuration)&&(l.fadeInDuration=s.fadeInDuration),void 0!==(null==s?void 0:s.slideDirection)&&(l.slideDirection=s.slideDirection),void 0!==(null==s?void 0:s.slideDistance)&&(l.slideDistance=s.slideDistance),void 0!==(null==s?void 0:s.wordByWord)&&(l.wordByWord=s.wordByWord),void 0!==(null==s?void 0:s.wordRegex)&&(l.wordRegex=s.wordRegex),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this,e=this.getLastProps(),i=this.getEndProps();this.originalTextConfig=i.textConfig?b(i.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=e.textConfig&&e.textConfig.length>0?u_.TransformTextConfig2SingleCharacter(e.textConfig):[],this.toTextConfig=u_.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map((function(e){return"text"in e?Object.assign(Object.assign({},e),{opacity:0,dx:t.getInitialDx(),dy:t.getInitialDy()}):Object.assign(Object.assign({},e),{opacity:0})})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}},{key:"calculateWordGroups",value:function(){this.wordGroups=[];var t,e="",i={},n=0;for(this.toTextConfig.forEach((function(t,r){if("text"in t){var a=String(t.text);e+=a,i[n]=r,n++}})),this.wordRegex.lastIndex=0;null!==(t=this.wordRegex.exec(e));){for(var r=t.index,a=t.index+t[0].length,o=[],s=r;s<a;s++)void 0!==i[s]&&o.push(i[s]);o.length>0&&this.wordGroups.push(o)}var l=new Set;this.wordGroups.forEach((function(t){t.forEach((function(t){return l.add(t)}))}));for(var u=0;u<this.toTextConfig.length;u++)"text"in this.toTextConfig[u]&&!l.has(u)&&this.wordGroups.push([u])}},{key:"getInitialDx",value:function(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}},{key:"getInitialDy",value:function(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||this.target.setAttribute("textConfig",this.originalTextConfig)}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r=1-this.fadeInDuration;n=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",n)}}},{key:"updateByWord",value:function(t,e){for(var i=this.wordGroups.length,n=b(this.singleCharConfig),r=0;r<this.wordGroups.length;r++){var a;if(t<(a="left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){var o,l=s(this.wordGroups[r]);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=n[u];"text"in c&&(n[u]=Object.assign(Object.assign({},c),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}}catch(t){l.e(t)}finally{l.f()}}else{var h,d=(t-a)/this.fadeInDuration,p=Math.max(0,Math.min(1,d)),f=this.getInitialDx()*(1-p),v=this.getInitialDy()*(1-p),g=s(this.wordGroups[r]);try{for(g.s();!(h=g.n()).done;){var y=h.value,m=n[y];"text"in m&&(n[y]=Object.assign(Object.assign({},m),{opacity:p,dx:f,dy:v}))}}catch(t){g.e(t)}finally{g.f()}}}return n}},{key:"updateByCharacter",value:function(t,e){for(var i=this.toTextConfig.length,n=b(this.singleCharConfig),r=0;r<n.length;r++){var a=n[r];if("text"in a){var o;if(t<(o="left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){n[r]=Object.assign(Object.assign({},a),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}var s=(t-o)/this.fadeInDuration,l=Math.max(0,Math.min(1,s)),u=this.getInitialDx()*(1-l),c=this.getInitialDy()*(1-l);n[r]=Object.assign(Object.assign({},a),{opacity:l,dx:u,dy:c})}}return n}}])}(NL),QI=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.singleCharConfig=[],l.fadeOutDuration=.3,l.slideDirection="right",l.slideDistance=30,l.wordByWord=!1,l.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,l.wordGroups=[],l.reverseOrder=!1,void 0!==(null==s?void 0:s.fadeOutDuration)&&(l.fadeOutDuration=s.fadeOutDuration),void 0!==(null==s?void 0:s.slideDirection)&&(l.slideDirection=s.slideDirection),void 0!==(null==s?void 0:s.slideDistance)&&(l.slideDistance=s.slideDistance),void 0!==(null==s?void 0:s.wordByWord)&&(l.wordByWord=s.wordByWord),void 0!==(null==s?void 0:s.wordRegex)&&(l.wordRegex=s.wordRegex),void 0!==(null==s?void 0:s.reverseOrder)&&(l.reverseOrder=s.reverseOrder),l.propKeys=["textConfig"],l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?b(t.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=u_.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?u_.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map((function(t){return"text"in t?Object.assign(Object.assign({},t),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},t),{opacity:1})})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}},{key:"calculateWordGroups",value:function(){this.wordGroups=[];var t,e="",i={},n=0;for(this.fromTextConfig.forEach((function(t,r){if("text"in t){var a=String(t.text);e+=a,i[n]=r,n++}})),this.wordRegex.lastIndex=0;null!==(t=this.wordRegex.exec(e));){for(var r=t.index,a=t.index+t[0].length,o=[],s=r;s<a;s++)void 0!==i[s]&&o.push(i[s]);o.length>0&&this.wordGroups.push(o)}var l=new Set;this.wordGroups.forEach((function(t){t.forEach((function(t){return l.add(t)}))}));for(var u=0;u<this.fromTextConfig.length;u++)"text"in this.fromTextConfig[u]&&!l.has(u)&&this.wordGroups.push([u])}},{key:"getTargetDx",value:function(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}},{key:"getTargetDy",value:function(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r=1-this.fadeOutDuration;n=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",n)}}},{key:"updateByWord",value:function(t,e){for(var i=this.wordGroups.length,n=b(this.singleCharConfig),r=0;r<this.wordGroups.length;r++){var a;if(t<(a=this.reverseOrder?"left"===this.slideDirection?r/i*e:(i-1-r)/i*e:"left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){var o,l=s(this.wordGroups[r]);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=n[u];"text"in c&&(n[u]=Object.assign(Object.assign({},c),{opacity:1,dx:0,dy:0}))}}catch(t){l.e(t)}finally{l.f()}}else{var h,d=(t-a)/this.fadeOutDuration,p=Math.max(0,Math.min(1,d)),f=this.getTargetDx()*p,v=this.getTargetDy()*p,g=1-p,y=s(this.wordGroups[r]);try{for(y.s();!(h=y.n()).done;){var m=h.value,_=n[m];"text"in _&&(n[m]=Object.assign(Object.assign({},_),{opacity:g,dx:f,dy:v}))}}catch(t){y.e(t)}finally{y.f()}}}return n}},{key:"updateByCharacter",value:function(t,e){for(var i=this.fromTextConfig.length,n=b(this.singleCharConfig),r=0;r<n.length;r++){var a=n[r];if("text"in a){var o;if(t<(o=this.reverseOrder?"left"===this.slideDirection?r/i*e:(i-1-r)/i*e:"left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){n[r]=Object.assign(Object.assign({},a),{opacity:1,dx:0,dy:0});continue}var s=(t-o)/this.fadeOutDuration,l=Math.max(0,Math.min(1,s)),u=this.getTargetDx()*l,c=this.getTargetDy()*l,h=1-l;n[r]=Object.assign(Object.assign({},a),{opacity:h,dx:u,dy:c})}}return n}}])}(NL),$I=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u,c,h,d,p;_(e,"onBind",this,3)([]);var f=this.target.getFinalAttribute(),v=null!==(t=this.target.attribute)&&void 0!==t?t:{};switch(null===(i=this.params)||void 0===i?void 0:i.direction){case"x":d={scaleX:null!==(n=v.scaleX)&&void 0!==n?n:0},p={scaleX:null!==(r=null==f?void 0:f.scaleX)&&void 0!==r?r:1},this._updateFunction=this.updateX;break;case"y":d={scaleY:null!==(a=v.scaleY)&&void 0!==a?a:0},p={scaleY:null!==(o=null==f?void 0:f.scaleY)&&void 0!==o?o:1},this._updateFunction=this.updateY;break;default:d={scaleX:null!==(s=v.scaleX)&&void 0!==s?s:0,scaleY:null!==(l=v.scaleY)&&void 0!==l?l:0},p={scaleX:null!==(u=null==f?void 0:f.scaleX)&&void 0!==u?u:1,scaleY:null!==(c=null==f?void 0:f.scaleY)&&void 0!==c?c:1},this._updateFunction=this.updateXY}var g=this.target.getFinalAttribute();g&&this.target.setAttributes(g),this.props=p,this.from=d,this.to=p,!1!==(null===(h=this.params.controlOptions)||void 0===h?void 0:h.immediatelyApply)&&this.target.setAttributes(d)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"updateX",value:function(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}},{key:"updateY",value:function(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}},{key:"updateXY",value:function(t){this.updateX(t),this.updateY(t)}},{key:"deleteSelfAttr",value:function(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];var e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:"scaleX"===this.propKeys[0]?this._updateFunction=this.updateX:"scaleY"===this.propKeys[0]?this._updateFunction=this.updateY:this._updateFunction=null}},{key:"onUpdate",value:function(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}])}(NL),tF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s;_(e,"onBind",this,3)([]);var l=this.target.attribute;switch(null===(t=this.params)||void 0===t?void 0:t.direction){case"x":o={scaleX:null!==(i=null==l?void 0:l.scaleX)&&void 0!==i?i:1},s={scaleX:0};break;case"y":o={scaleY:null!==(n=null==l?void 0:l.scaleY)&&void 0!==n?n:1},s={scaleY:0};break;default:o={scaleX:null!==(r=null==l?void 0:l.scaleX)&&void 0!==r?r:1,scaleY:null!==(a=null==l?void 0:l.scaleY)&&void 0!==a?a:1},s={scaleX:0,scaleY:0}}this.props=s,this.from=o,this.to=s}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}])}(NL),eF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.fromProps[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}}])}(NL),iF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u,c,h,d;_(e,"onBind",this,3)([]);var p=this.target.getFinalAttribute(),f=(null===(t=this.params)||void 0===t?void 0:t.direction)||"right",v=(null===(i=this.params)||void 0===i?void 0:i.distance)||50,g=null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:0,y={opacity:g,baseOpacity:g},m={opacity:1,baseOpacity:1};"top"===f?(y.y=(null!==(a=p.y)&&void 0!==a?a:0)-v,m.y=null!==(o=p.y)&&void 0!==o?o:0,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===f?(y.y=(null!==(s=p.y)&&void 0!==s?s:0)+v,m.y=null!==(l=p.y)&&void 0!==l?l:0,this.propKeys=["opacity","baseOpacity","y"]):"left"===f?(y.x=(null!==(u=p.x)&&void 0!==u?u:0)-v,m.x=null!==(c=p.x)&&void 0!==c?c:0,this.propKeys=["opacity","baseOpacity","x"]):(y.x=(null!==(h=p.x)&&void 0!==h?h:0)+v,m.x=null!==(d=p.x)&&void 0!==d?d:0,this.propKeys=["opacity","baseOpacity","x"]),this.from=y,this.to=m,this.props=m,this.target.setAttributes(y)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),nF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s;_(e,"onBind",this,3)([]);var l=this.target.getFinalAttribute(),u=null!==(i=null===(t=this.params)||void 0===t?void 0:t.fromScale)&&void 0!==i?i:0,c=(null===(n=this.params)||void 0===n?void 0:n.direction)||"xy",h=null!==(a=null===(r=this.params)||void 0===r?void 0:r.fromOpacity)&&void 0!==a?a:0,d={opacity:h,baseOpacity:h},p={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],"x"!==c&&"xy"!==c||(d.scaleX=u,p.scaleX=null!==(o=l.scaleX)&&void 0!==o?o:1,this.propKeys.push("scaleX")),"y"!==c&&"xy"!==c||(d.scaleY=u,p.scaleY=null!==(s=l.scaleY)&&void 0!==s?s:1,this.propKeys.push("scaleY")),this.from=d,this.to=p,this.props=p,this.target.setAttributes(d)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),rF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u;_(e,"onBind",this,3)([]);var c=this.target.getFinalAttribute(),h=null!==(i=null===(t=this.params)||void 0===t?void 0:t.fromAngle)&&void 0!==i?i:2*Math.PI,d=null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromScale)&&void 0!==r?r:0,p=null!==(o=null===(a=this.params)||void 0===a?void 0:a.fromOpacity)&&void 0!==o?o:0,f={opacity:p,baseOpacity:p,angle:h,scaleX:d,scaleY:d},v={opacity:1,baseOpacity:1,angle:null!==(s=c.angle)&&void 0!==s?s:0,scaleX:null!==(l=c.scaleX)&&void 0!==l?l:1,scaleY:null!==(u=c.scaleY)&&void 0!==u?u:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=f,this.to=v,this.props=v,this.target.setAttributes(f)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),aF=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).perimeter=0,l.originalAttributes={},l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m;if(_(e,"onBind",this,3)([]),this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){var b=this.target.attribute,x=null!==(t=b.width)&&void 0!==t?t:100,k=null!==(i=b.height)&&void 0!==i?i:100;this.perimeter=2*(x+k)}else if("circle"===this.target.type){var S=null!==(n=this.target.attribute.radius)&&void 0!==n?n:50;this.perimeter=2*Math.PI*S}else if("ellipse"===this.target.type){var A=this.target.attribute,C=null!==(r=A.radiusX)&&void 0!==r?r:50,M=null!==(a=A.radiusY)&&void 0!==a?a:50;this.perimeter=2*Math.PI*Math.sqrt((C*C+M*M)/2)}else this.perimeter=1e3;var w=null!==(s=null===(o=this.params)||void 0===o?void 0:o.lineWidth)&&void 0!==s?s:2,T=null!==(u=null===(l=this.params)||void 0===l?void 0:l.strokeColor)&&void 0!==u?u:"black",D=null!==(h=null===(c=this.params)||void 0===c?void 0:c.fromOpacity)&&void 0!==h?h:1,E=null!==(p=null===(d=this.params)||void 0===d?void 0:d.dashLength)&&void 0!==p?p:this.perimeter,B=null!==(v=null===(f=this.params)||void 0===f?void 0:f.showFill)&&void 0!==v&&v,P=null!==(y=null===(g=this.params)||void 0===g?void 0:g.fillOpacity)&&void 0!==y?y:0;this.from={lineDash:[E,E],lineDashOffset:E,lineWidth:w,stroke:T,strokeOpacity:D},this.to={lineDash:[E,E],lineDashOffset:0,lineWidth:w,stroke:T,strokeOpacity:D},B?(this.from.fillOpacity=P,this.to.fillOpacity=null!==(m=this.originalAttributes.fillOpacity)&&void 0!==m?m:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}},{key:"onUpdate",value:function(t,e,i){var n,r=this.target.attribute;r.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null===(n=this.params)||void 0===n?void 0:n.showFill)&&(r.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}},{key:"onEnd",value:function(){var t;if(_(e,"onEnd",this,3)([]),!(null===(t=this.params)||void 0===t?void 0:t.showFill)){var i=Object.assign({},this.originalAttributes);i.fillOpacity=0,this.target.setAttributes(i)}}}])}(NL),oF=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).perimeter=0,l.originalAttributes={},l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){var g=this.target.attribute,y=null!==(t=g.width)&&void 0!==t?t:100,m=null!==(e=g.height)&&void 0!==e?e:100;this.perimeter=2*(y+m)}else if("circle"===this.target.type){var _=null!==(i=this.target.attribute.radius)&&void 0!==i?i:50;this.perimeter=2*Math.PI*_}else if("ellipse"===this.target.type){var b=this.target.attribute,x=null!==(n=b.radiusX)&&void 0!==n?n:50,k=null!==(r=b.radiusY)&&void 0!==r?r:50;this.perimeter=2*Math.PI*Math.sqrt((x*x+k*k)/2)}else this.perimeter=1e3;var S=null!==(o=null===(a=this.params)||void 0===a?void 0:a.lineWidth)&&void 0!==o?o:2,A=null!==(l=null===(s=this.params)||void 0===s?void 0:s.strokeColor)&&void 0!==l?l:"black",C=null!==(c=null===(u=this.params)||void 0===u?void 0:u.fromOpacity)&&void 0!==c?c:1,M=null!==(d=null===(h=this.params)||void 0===h?void 0:h.dashLength)&&void 0!==d?d:this.perimeter,w=null!==(f=null===(p=this.params)||void 0===p?void 0:p.showFill)&&void 0!==f&&f;this.from={lineDash:[M,M],lineDashOffset:0,lineWidth:S,stroke:A,strokeOpacity:C},this.to={lineDash:[M,M],lineDashOffset:-M,lineWidth:S,stroke:A,strokeOpacity:C},w?(this.from.fillOpacity=null!==(v=this.originalAttributes.fillOpacity)&&void 0!==v?v:1,this.to.fillOpacity=0):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}},{key:"onUpdate",value:function(t,e,i){var n,r=this.target.attribute;r.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null===(n=this.params)||void 0===n?void 0:n.showFill)&&(r.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}])}(NL),sF=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.slideInDuration=a*c,l.growInDuration=a*(1-c),l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o;_(e,"onBind",this,3)([]);var s=new DL(this.target);s.execute({type:"custom",custom:iF,customParameters:{direction:(null===(t=this.params)||void 0===t?void 0:t.slideDirection)||"right",distance:(null===(i=this.params)||void 0===i?void 0:i.slideDistance)||50,fromOpacity:null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:0},duration:this.slideInDuration,easing:this.easing}),s.execute({type:"custom",custom:nF,customParameters:{fromScale:(null===(a=this.params)||void 0===a?void 0:a.fromScale)||.5,direction:(null===(o=this.params)||void 0===o?void 0:o.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(NL),lF=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.slideInDuration=a*c,l.spinInDuration=a*(1-c),l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o;_(e,"onBind",this,3)([]);var s=new DL(this.target);s.execute({type:"custom",custom:iF,customParameters:{direction:(null===(t=this.params)||void 0===t?void 0:t.slideDirection)||"right",distance:(null===(i=this.params)||void 0===i?void 0:i.slideDistance)||50,fromOpacity:null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:0},duration:this.slideInDuration,easing:this.easing}),s.execute({type:"custom",custom:rF,customParameters:{fromAngle:(null===(a=this.params)||void 0===a?void 0:a.fromAngle)||Math.PI,fromScale:(null===(o=this.params)||void 0===o?void 0:o.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(NL),uF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f=this.target.getAttributes(),v=(null===(t=this.params)||void 0===t?void 0:t.direction)||"right",g=(null===(e=this.params)||void 0===e?void 0:e.distance)||50,y=null!==(n=null===(i=this.params)||void 0===i?void 0:i.fromOpacity)&&void 0!==n?n:1,m=null!==(a=null===(r=this.params)||void 0===r?void 0:r.toOpacity)&&void 0!==a?a:0,_={opacity:y,baseOpacity:y},b={opacity:m,baseOpacity:m};"top"===v?(_.y=null!==(o=f.y)&&void 0!==o?o:0,b.y=(null!==(s=f.y)&&void 0!==s?s:0)-g,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===v?(_.y=null!==(l=f.y)&&void 0!==l?l:0,b.y=(null!==(u=f.y)&&void 0!==u?u:0)+g,this.propKeys=["opacity","baseOpacity","y"]):"left"===v?(_.x=null!==(c=f.x)&&void 0!==c?c:0,b.x=(null!==(h=f.x)&&void 0!==h?h:0)-g,this.propKeys=["opacity","baseOpacity","x"]):(_.x=null!==(d=f.x)&&void 0!==d?d:0,b.x=(null!==(p=f.x)&&void 0!==p?p:0)+g,this.propKeys=["opacity","baseOpacity","x"]),this.from=_,this.to=b,this.props=b}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),cF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u=this.target.getAttributes(),c=null!==(e=null===(t=this.params)||void 0===t?void 0:t.fromScale)&&void 0!==e?e:0,h=(null===(i=this.params)||void 0===i?void 0:i.direction)||"xy",d=null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:1,p=null!==(o=null===(a=this.params)||void 0===a?void 0:a.toOpacity)&&void 0!==o?o:0,f={opacity:d,baseOpacity:d},v={opacity:p,baseOpacity:p};this.propKeys=["opacity","baseOpacity"],"x"!==h&&"xy"!==h||(f.scaleX=null!==(s=u.scaleX)&&void 0!==s?s:1,v.scaleX=c,this.propKeys.push("scaleX")),"y"!==h&&"xy"!==h||(f.scaleY=null!==(l=u.scaleY)&&void 0!==l?l:1,v.scaleY=c,this.propKeys.push("scaleY")),this.from=f,this.to=v,this.props=v}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),hF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h=this.target.getAttributes(),d=null!==(e=null===(t=this.params)||void 0===t?void 0:t.fromAngle)&&void 0!==e?e:2*Math.PI,p=null!==(n=null===(i=this.params)||void 0===i?void 0:i.fromScale)&&void 0!==n?n:0,f=null!==(a=null===(r=this.params)||void 0===r?void 0:r.fromOpacity)&&void 0!==a?a:1,v=null!==(s=null===(o=this.params)||void 0===o?void 0:o.toOpacity)&&void 0!==s?s:0,g={opacity:f,baseOpacity:f,angle:null!==(l=h.angle)&&void 0!==l?l:0,scaleX:null!==(u=h.scaleX)&&void 0!==u?u:1,scaleY:null!==(c=h.scaleY)&&void 0!==c?c:1},y={opacity:v,baseOpacity:v,angle:d,scaleX:p,scaleY:p};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=g,this.to=y,this.props=y}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),dF=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.growOutDuration=a*(1-c),l.slideOutDuration=a*c,l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r=new DL(this.target);r.execute({type:"custom",custom:cF,customParameters:{fromScale:(null===(t=this.params)||void 0===t?void 0:t.fromScale)||.5,direction:(null===(e=this.params)||void 0===e?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),r.execute({type:"custom",custom:uF,customParameters:{direction:(null===(i=this.params)||void 0===i?void 0:i.slideDirection)||"right",distance:(null===(n=this.params)||void 0===n?void 0:n.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(NL),pF=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.spinOutDuration=a*(1-c),l.slideOutDuration=a*c,l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r=new DL(this.target);r.execute({type:"custom",custom:hF,customParameters:{fromAngle:(null===(t=this.params)||void 0===t?void 0:t.fromAngle)||Math.PI,fromScale:(null===(e=this.params)||void 0===e?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),r.execute({type:"custom",custom:uF,customParameters:{direction:(null===(i=this.params)||void 0===i?void 0:i.slideDirection)||"right",distance:(null===(n=this.params)||void 0===n?void 0:n.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(NL),fF=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).originalAttributes={},l.pulseCount=3,l.pulseOpacity=.3,l.pulseScale=1.05,l.pulseColor=null,l.pulseColorIntensity=.2,l.strokeOnly=!1,l.fillOnly=!1,l.useScale=!0,l.useOpacity=!0,l.useStroke=!0,l.useFill=!0,l.useColor=!1,l.originalFill=null,l.originalStroke=null,void 0!==(null==s?void 0:s.pulseCount)&&(l.pulseCount=s.pulseCount),void 0!==(null==s?void 0:s.pulseScale)&&(l.pulseScale=s.pulseScale),void 0!==(null==s?void 0:s.pulseColor)&&(l.pulseColor=s.pulseColor),void 0!==(null==s?void 0:s.pulseColorIntensity)&&(l.pulseColorIntensity=s.pulseColorIntensity),void 0!==(null==s?void 0:s.strokeOnly)&&(l.strokeOnly=s.strokeOnly),void 0!==(null==s?void 0:s.fillOnly)&&(l.fillOnly=s.fillOnly),void 0!==(null==s?void 0:s.useScale)&&(l.useScale=s.useScale),void 0!==(null==s?void 0:s.useOpacity)&&(l.useOpacity=s.useOpacity),void 0!==(null==s?void 0:s.useStroke)&&(l.useStroke=s.useStroke),void 0!==(null==s?void 0:s.useFill)&&(l.useFill=s.useFill),void 0!==(null==s?void 0:s.useColor)&&(l.useColor=s.useColor),l}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}},{key:"onUpdate",value:function(t,e,i){var n=e*Math.PI*this.pulseCount,r=Math.abs(Math.sin(n)),a=this.target.attribute;if(this.useOpacity){var o=1+(this.pulseOpacity-1)*r;this.useStroke&&(a.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*o),this.useFill&&(a.fillOpacity=(this.originalAttributes.fillOpacity||1)*o)}if(this.useScale){var s=1+(this.pulseScale-1)*r;a.scaleX=(this.originalAttributes.scaleX||1)*s,a.scaleY=(this.originalAttributes.scaleY||1)*s}this.useColor&&this.pulseColor&&this.applyColorPulse(a,r),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}},{key:"applyColorPulse",value:function(t,e){var i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=Sy(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=Sy(this.originalStroke,this.pulseColor,i,!0))}},{key:"onEnd",value:function(){_(e,"onEnd",this,3)([]),this.target.setAttributes(this.originalAttributes)}}])}(NL),vF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i;_(e,"onBind",this,3)([]);var n=(null!==(t=this.target.context)&&void 0!==t?t:{}).diffAttrs,r=void 0===n?{}:n,a=this.params.options;r=Object.assign({},r),(null===(i=null==a?void 0:a.excludeChannels)||void 0===i?void 0:i.length)&&a.excludeChannels.forEach((function(t){delete r[t]})),this.props=r}},{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.fromProps[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i)}}}])}(NL),gF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),yF=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t;_(e,"onBind",this,3)([]);var i=function(t,e,i){var n,r,a,o,s=null!=e?e:{},l=s.offset,u=void 0===l?0:l,c=s.orient,h=s.direction,d=s.point,p=s.excludeChannels,f=void 0===p?[]:p,v=s.layoutRect,g=void 0===v?{}:v,y=0,m=0;"negative"===c&&(y=null!==(n=g.width)&&void 0!==n?n:t.stage.viewWidth,m=null!==(r=g.height)&&void 0!==r?r:t.stage.viewHeight),y+=u,m+=u;var _=U(d)?d.call(null,null===(o=null===(a=t.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],t,i):d,b=t.getGraphicAttribute("x"),x=t.getGraphicAttribute("y"),k=f.includes("x")?b:_&&it(_.x)?_.x:y,S=f.includes("y")?x:_&&it(_.y)?_.y:m;switch(h){case"x":return{from:{x:f.includes("x")?b:k},to:{x:b}};case"y":return{from:{y:S},to:{y:x}};default:return{from:{x:k,y:S},to:{x:b,y:x}}}}(this.target,this.params.options,this.params),n=i.from,r=i.to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=n,this.to=r;var a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(n)}}])}(gF),mF=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=function(t,e,i){var n,r,a,o,s=null!=e?e:{},l=s.offset,u=void 0===l?0:l,c=s.orient,h=s.direction,d=s.point,p=i.group?i.group.AABBBounds:null,f=null!==(n=p.width())&&void 0!==n?n:i.width,v=null!==(r=p.height())&&void 0!==r?r:i.height,g=("negative"===c?f:0)+u,y=("negative"===c?v:0)+u,m=U(d)?d.call(null,null===(o=null===(a=t.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],t,i):d,_=m&&it(m.x)?m.x:g,b=m&&it(m.y)?m.y:y;switch(h){case"x":return{from:{x:t.getGraphicAttribute("x")},to:{x:_}};case"y":return{from:{y:t.getGraphicAttribute("y")},to:{y:b}};default:return{from:{x:t.getGraphicAttribute("x"),y:t.getGraphicAttribute("y")},to:{x:_,y:b}}}}(this.target,this.params.options,this.params),i=t.from,n=t.to;this.props=n,this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.from=i,this.to=n}}])}(gF),_F=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(NL),bF=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t;_(e,"onBind",this,3)([]);var i=function(t,e){var i,n=null!==(i=t.getFinalAttribute().angle)&&void 0!==i?i:0;return{from:{angle:ie(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:it(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2},to:{angle:n}}}(this.target,this.params.options),n=i.from,r=i.to;this.props=r,this.propKeys=["angle"],this.from=n,this.to=r;var a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(n)}}])}(_F),xF=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=function(t,e){var i,n=null!==(i=t.getFinalAttribute().angle)&&void 0!==i?i:0;return{from:{angle:n},to:{angle:ie(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:it(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2}}}(this.target,this.params.options),i=t.from,n=t.to;this.props=n,this.propKeys=["angle"],this.from=i,this.to=n}}])}(_F),kF=function(t){function e(t,i,a,o,s){var l,u;return r(this,e),l=n(this,e,[t,i,a,o,s]),s&&(l.pathLength=s.path.getLength(),l.path=s.path,l.distance=s.distance,l.totalLength=l.distance*l.pathLength,l.initAngle=null!==(u=s.initAngle)&&void 0!==u?u:0,l.changeAngle=!!s.changeAngle,l.cb=s.cb),l}return h(e,t),o(e,[{key:"onBind",value:function(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}},{key:"onUpdate",value:function(t,e,i){var n={},r=this.totalLength*e,a=this.path.getAttrAt(r),o=a.pos,s=a.angle;n.x=o.x,n.y=o.y,this.changeAngle&&(n.angle=s+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(n)}}])}(NL),SF=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).from=null!=t?t:{},l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n=this;_(e,"onBind",this,3)([]),Object.keys(this.from).forEach((function(t){null==n.props[t]&&(n.props[t]=n.target.getGraphicAttribute(t))}));var r=this.target.getFinalAttribute();"appear"===(null===(t=this.target.context)||void 0===t?void 0:t.animationState)&&r&&this.target.setAttributes(r),!1!==(null===(i=this.params.controlOptions)||void 0===i?void 0:i.immediatelyApply)&&this.target.setAttributes(this.from)}},{key:"onFirstRun",value:function(){var t=this;this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);var e=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach((function(i){var n;t.from[i]=null!==(n=t.from[i])&&void 0!==n?n:e[i]})),this.target.setAttributes(this.from)}},{key:"deleteSelfAttr",value:function(t){_(e,"deleteSelfAttr",this,3)([t]),delete this.from[t]}},{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.from[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}}])}(NL),AF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onStart",value:function(){this.target&&("rect"===this.target.type?this.onStartRect():"line"===this.target.type?this.onStartLineOrArea("line"):"area"===this.target.type&&this.onStartLineOrArea("area"))}},{key:"onStartLineOrArea",value:function(t){var e,i=this.target.attachShadow(),n=oh.graphicService.creator[t](Object.assign({},null===(e=this.params)||void 0===e?void 0:e.attribute));this[t]=n,n.pathProxy=new Md,i.add(n)}},{key:"onStartRect",value:function(){var t,e,i,n=this.target.attachShadow(),r=null===(e=null===(t=this.params)||void 0===t?void 0:t.isHorizontal)||void 0===e||e,a=r?"height":"width",o=r?"width":"height",s=this.target.AABBBounds[a](),u=r?0:this.target.AABBBounds.y1,c=oh.graphicService.creator.rect(Object.assign(Object.assign(l(l(l(l({},a,s),"fill","#bcdeff"),"shadowBlur",30),"shadowColor","#bcdeff"),null===(i=this.params)||void 0===i?void 0:i.attribute),l({x:0,y:u},o,0)));this.rect=c,n.add(c)}},{key:"onBind",value:function(){}},{key:"onEnd",value:function(){this.target.detachShadow()}},{key:"onUpdate",value:function(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}},{key:"onUpdateRect",value:function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_=null===(r=null===(n=this.params)||void 0===n?void 0:n.isHorizontal)||void 0===r||r,b=this.target.attribute;if(_){var x=null!==(o=null!==(a=b.width)&&void 0!==a?a:Math.abs(b.x1-b.x))&&void 0!==o?o:250,k=null!==(l=null===(s=this.params)||void 0===s?void 0:s.streamLength)&&void 0!==l?l:x,S=null!==(h=null===(c=null===(u=this.params)||void 0===u?void 0:u.attribute)||void 0===c?void 0:c.width)&&void 0!==h?h:60,A=-S,C=A+(k-A)*e,M=Math.max(C,0),w=Math.min(Math.min(C+S,S),k-C),T=w+M>x?Math.max(x-M,0):w;this.rect.setAttributes({x:M+Math.min(b.x1-b.x,0),width:T},!1,{type:Sh.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{var D,E=null!==(p=null!==(d=b.height)&&void 0!==d?d:Math.abs(b.y1-b.y))&&void 0!==p?p:250,B=null!==(v=null===(f=this.params)||void 0===f?void 0:f.streamLength)&&void 0!==v?v:E,P=null!==(m=null===(y=null===(g=this.params)||void 0===g?void 0:g.attribute)||void 0===y?void 0:y.height)&&void 0!==m?m:60,R=E-(B+P)*e,L=Math.min(R,E),I=Math.min(E-R,P);L<=0?(D=Math.max(L+I,0),L=0):D=I,this.rect.setAttributes({y:L+Math.min(b.y1-b.y,0),height:D},!1,{type:Sh.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}},{key:"onUpdateLineOrArea",value:function(t,e,i){var n=this.line||this.area;if(n){var r=n.pathProxy,a=this.target;a.cache||a.cacheArea?this._onUpdateLineOrAreaWithCache(r,a,t,e,i):this._onUpdateLineWithoutCache(r,a,t,e,i);var o=a.attribute;n.setAttributes(Object.assign({stroke:o.stroke},n.attribute)),n.addUpdateBoundTag()}}},{key:"_onUpdateLineOrAreaWithCache",value:function(t,e,i,n,r){var a,o;if(t.clear(),"line"===e.type){var s=e.cache;Array.isArray(s)||(s=[s]);var l=s.reduce((function(t,e){return t+e.getLength()}),0),u=[];return s.forEach((function(t){t.curves.forEach((function(t){return u.push(t)}))})),this._updateCurves(t,u,l,n)}if("area"===e.type&&(null===(o=null===(a=e.cacheArea)||void 0===a?void 0:a.top)||void 0===o?void 0:o.curves)){var c=e.cacheArea,h=c.top.curves.reduce((function(t,e){return t+e.getLength()}),0);return this._updateCurves(t,c.top.curves,h,n)}}},{key:"_updateCurves",value:function(t,e,i,n){for(var r,a,o=i*n,s=Math.min(o+(null!==(a=null===(r=this.params)||void 0===r?void 0:r.streamLength)&&void 0!==a?a:10),i),l=0,u=!1,c=0;c<e.length;c++)if(!1!==e[c].defined){var h=e[c],d=h.getLength(),p=1-(l+d-o)/d,f=void 0,v=1-(l+d-s)/d;if(l<o&&l+d>o)if(u=!0,h.p2&&h.p3){var g=m(Vh(h,p),2);g[0];var y=g[1];t.moveTo(y.p0.x,y.p0.y),f=y}else{var _=h.getPointAt(p);t.moveTo(_.x,_.y)}if(l<s&&l+d>s){if(h.p2&&h.p3){f&&(v=(s-o)/f.getLength());var b=m(Vh(f||h,v),1)[0];t.bezierCurveTo(b.p1.x,b.p1.y,b.p2.x,b.p2.y,b.p3.x,b.p3.y)}else{var x=h.getPointAt(v);t.lineTo(x.x,x.y)}break}if(u)if(h.p2&&h.p3){var k=f||h;t.bezierCurveTo(k.p1.x,k.p1.y,k.p2.x,k.p2.y,k.p3.x,k.p3.y)}else t.lineTo(h.p1.x,h.p1.y);l+=d}}},{key:"_onUpdateLineWithoutCache",value:function(t,e,i,n,r){var a,o,s=e.attribute,l=s.points,u=s.curveType;if(l&&!(l.length<2)&&"linear"===u){for(var c=0,h=1;h<l.length;h++)c+=Si.distancePP(l[h],l[h-1]);for(var d=c*n,p=Math.min(d+(null!==(o=null===(a=this.params)||void 0===a?void 0:a.streamLength)&&void 0!==o?o:10),c),f=[],v=0,g=1;g<l.length;g++){var y=Si.distancePP(l[g],l[g-1]);if(v<d&&v+y>d&&f.push(Si.pointAtPP(l[g-1],l[g],1-(v+y-d)/y)),v<p&&v+y>p){f.push(Si.pointAtPP(l[g-1],l[g],1-(v+y-p)/y));break}f.length&&f.push(l[g]),v+=y}if(f.length&&!(f.length<2)){t.clear(),t.moveTo(f[0].x,f[0].y);for(var m=1;m<f.length;m++)t.lineTo(f[m].x,f[m].y)}}}}])}(NL),CF=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).webglCanvas=null,l.gl=null,l.program=null,l.currentAnimationRatio=0,l.animationTime=0,l}return h(e,t),o(e,[{key:"onUpdate",value:function(t,i,n){_(e,"onUpdate",this,3)([t,i,n]),this.currentAnimationRatio=i,this.animationTime=i*Math.PI*2}},{key:"getAnimationTime",value:function(){return this.currentAnimationRatio>0?this.animationTime:Date.now()/1e3}},{key:"getDurationFromParent",value:function(){return this.duration||1e3}},{key:"initWebGL",value:function(t){try{if(this.webglCanvas=tS.createCanvas({width:t.width,height:t.height,dpr:tS.devicePixelRatio}),!this.webglCanvas)return console.warn("WebGL canvas creation failed"),!1;this.webglCanvas.style.width=t.style.width||"".concat(t.width,"px"),this.webglCanvas.style.height=t.style.height||"".concat(t.height,"px");var e=null;try{(e=this.webglCanvas.getContext("webgl"))||(e=this.webglCanvas.getContext("experimental-webgl"))}catch(t){console.warn("Failed to get WebGL context:",t)}if(this.gl=e,!this.gl)return console.warn("WebGL not supported"),!1;var i=this.getShaderSources();return this.program=this.createShaderProgram(i.vertex,i.fragment),null!==this.program}catch(t){return console.warn("Failed to initialize WebGL:",t),!1}}},{key:"createShaderProgram",value:function(t,e){if(!this.gl)return null;var i=this.createShader(this.gl.VERTEX_SHADER,t),n=this.createShader(this.gl.FRAGMENT_SHADER,e);if(!i||!n)return null;var r=this.gl.createProgram();return r?(this.gl.attachShader(r,i),this.gl.attachShader(r,n),this.gl.linkProgram(r),this.gl.getProgramParameter(r,this.gl.LINK_STATUS)?r:(console.error("Shader program link error:",this.gl.getProgramInfoLog(r)),null)):null}},{key:"createShader",value:function(t,e){if(!this.gl)return null;var i=this.gl.createShader(t);return i?(this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.error("Shader compile error:",this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)):null}},{key:"setupWebGLState",value:function(t){this.gl&&this.webglCanvas&&(this.webglCanvas.width===t.width&&this.webglCanvas.height===t.height||(this.webglCanvas.width=t.width,this.webglCanvas.height=t.height),this.gl.viewport(0,0,this.webglCanvas.width,this.webglCanvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT))}},{key:"createFullScreenQuad",value:function(){if(!this.gl)return null;var t=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),e}},{key:"createTextureFromCanvas",value:function(t){if(!this.gl)return null;var e=this.gl.createTexture();return this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),e}},{key:"setupVertexAttributes",value:function(){if(this.gl&&this.program){var t=this.gl.getAttribLocation(this.program,"a_position"),e=this.gl.getAttribLocation(this.program,"a_texCoord");this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,16,8)}}},{key:"createOutputCanvas",value:function(t){var e=tS.createCanvas({width:t.width,height:t.height,dpr:tS.devicePixelRatio}),i=e.getContext("2d");return i?(i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),{canvas:e,ctx:i}):null}},{key:"getShaderSources",value:function(){return null}},{key:"applyWebGLEffect",value:function(t){return null}},{key:"applyCanvas2DEffect",value:function(t){return null}},{key:"supportsWebGL",value:function(){return null!==this.getShaderSources()}},{key:"supportsCanvas2D",value:function(){return this.applyCanvas2DEffect!==e.prototype.applyCanvas2DEffect}},{key:"release",value:function(){_(e,"release",this,3)([]),this.gl&&(this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.gl=null),this.webglCanvas&&(this.webglCanvas=null),this.currentAnimationRatio=0,this.animationTime=0}},{key:"afterStageRender",value:function(t,e){var i=null;if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(i=this.applyWebGLEffect(e))return i;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(i=this.applyCanvas2DEffect(e))return i;console.warn("Canvas 2D特效执行失败")}return this.supportsWebGL()||this.supportsCanvas2D()||console.error("特效类 ".concat(this.constructor.name," 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。")),e}}])}(jL),MF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return null}},{key:"applyWebGLEffect",value:function(t){return null}}])}(CF),wF=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return null}},{key:"applyWebGLEffect",value:function(t){return null}},{key:"applyCanvas2DEffect",value:function(t){return null}},{key:"supportsWebGL",value:function(){return this.getShaderSources!==e.prototype.getShaderSources&&null!==this.getShaderSources()}},{key:"supportsCanvas2D",value:function(){return this.applyCanvas2DEffect!==e.prototype.applyCanvas2DEffect}},{key:"afterStageRender",value:function(t,e){var i,n,r=null;if(!1!==(null===(n=null===(i=this.params)||void 0===i?void 0:i.options)||void 0===n?void 0:n.useWebGL)){if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(r=this.applyWebGLEffect(e))return r;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(r=this.applyCanvas2DEffect(e))return r;console.warn("Canvas 2D特效执行失败")}}else if(this.supportsCanvas2D()){if(r=this.applyCanvas2DEffect(e))return r;console.warn("Canvas 2D特效执行失败")}else console.warn("".concat(this.constructor.name,": useWebGL=false 但未实现Canvas 2D方法"));return this.supportsWebGL()||this.supportsCanvas2D()||console.error("特效类 ".concat(this.constructor.name," 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。")),e}}])}(CF),TF=function(){return o((function t(){r(this,t)}),null,[{key:"createTempCanvas",value:function(t,e,i){return tS.createCanvas({width:t,height:e,dpr:i||tS.devicePixelRatio})}},{key:"cloneImageData",value:function(t){var e=new Uint8ClampedArray(t.data);return new ImageData(e,t.width,t.height)}},{key:"lerp",value:function(t,e,i){return t*(1-i)+e*i}},{key:"smoothstep",value:function(t,e,i){var n=Math.max(0,Math.min(1,(i-t)/(e-t)));return n*n*(3-2*n)}},{key:"distance",value:function(t,e,i,n){var r=i-t,a=n-e;return Math.sqrt(r*r+a*a)}},{key:"normalizeAngle",value:function(t){return(t+Math.PI)/(2*Math.PI)}},{key:"pixelNoise",value:function(t,e,i){if(i<=0)return 0;var n=Math.floor(t/i)*i,r=Math.floor(e/i)*i,a=43758.5453*Math.sin(12.9898*n+78.233*r);return a-Math.floor(a)}},{key:"generateNoiseTexture",value:function(t,e){for(var i=new Uint8Array(t*e),n=0;n<i.length;n++)i[n]=Math.floor(256*Math.random());return i}},{key:"applyCSSFilter",value:function(t,e){var i=this.createTempCanvas(t.width,t.height),n=i.getContext("2d");return n?(n.filter=e,n.drawImage(t,0,0),n.filter="none",i):t}},{key:"extractChannel",value:function(t,e){for(var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length),o=0;o<i.length;o+=4)a[o]=0,a[o+1]=0,a[o+2]=0,a[o+3]=i[o+3],e>=0&&e<=2&&(a[o+e]=i[o+e]);return new ImageData(a,n,r)}},{key:"blendImageData",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=e.data,s=new Uint8ClampedArray(n.length),l=0;l<n.length;l+=4)s[l]=Math.round(this.lerp(n[l],o[l],i)),s[l+1]=Math.round(this.lerp(n[l+1],o[l+1],i)),s[l+2]=Math.round(this.lerp(n[l+2],o[l+2],i)),s[l+3]=Math.round(this.lerp(n[l+3],o[l+3],i));return new ImageData(s,r,a)}},{key:"getLuminance",value:function(t,e,i){return.299*t+.587*e+.114*i}},{key:"applySepiaToPixel",value:function(t,e,i){return[Math.min(255,.393*t+.769*e+.189*i),Math.min(255,.349*t+.686*e+.168*i),Math.min(255,.272*t+.534*e+.131*i)]}},{key:"calculateDynamicStrength",value:function(t,e){return t*(e/(2*Math.PI))}}])}(),DF=o((function t(){r(this,t)}));DF.STANDARD_VERTEX_SHADER="\n    attribute vec2 a_position;\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n      v_texCoord = a_texCoord;\n    }\n  ",DF.SHADER_FUNCTIONS="\n    // 亮度计算函数\n    float luminance(vec3 color) {\n      return dot(color, vec3(0.299, 0.587, 0.114));\n    }\n\n    // 褐色调函数\n    vec3 sepia(vec3 color) {\n      float r = color.r * 0.393 + color.g * 0.769 + color.b * 0.189;\n      float g = color.r * 0.349 + color.g * 0.686 + color.b * 0.168;\n      float b = color.r * 0.272 + color.g * 0.534 + color.b * 0.131;\n      return vec3(r, g, b);\n    }\n\n    // 线性插值函数\n    float lerp(float a, float b, float t) {\n      return a * (1.0 - t) + b * t;\n    }\n\n\n    // 简单噪声函数\n    float pixelNoise(vec2 coord, float pixelSize) {\n      vec2 gridCoord = floor(coord / pixelSize) * pixelSize;\n      return fract(sin(dot(gridCoord, vec2(12.9898, 78.233))) * 43758.5453123);\n    }\n\n    // 动态强度计算\n    float calculateDynamicStrength(float baseStrength, float time) {\n      return baseStrength * (time / 6.28318531); // 2π\n    }\n  ";var EF=function(t){function e(t,i,a,o,s){var l,u,c,h,d;r(this,e),(l=n(this,e,[t,i,a,o,s])).noiseData=null;var p=null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.noiseScale,f=void 0!==p?Math.max(0,Math.floor(p)):8;return l.dissolveConfig={dissolveType:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.dissolveType)||"outward",useWebGL:void 0===(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.useWebGL)||s.options.useWebGL,noiseScale:f,fadeEdge:void 0===(null===(d=null==s?void 0:s.options)||void 0===d?void 0:d.fadeEdge)||s.options.fadeEdge},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:DF.STANDARD_VERTEX_SHADER,fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform sampler2D u_noiseTexture;\n      uniform float u_time;\n      uniform int u_dissolveType;\n      uniform vec2 u_resolution;\n      uniform float u_noiseScale;\n      uniform bool u_fadeEdge;\n      varying vec2 v_texCoord;\n\n      ".concat(DF.SHADER_FUNCTIONS,"\n\n      // 向外溶解函数\n      float outwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        vec2 center = vec2(0.5, 0.5);\n        float distFromCenter = length(uv - center);\n        float maxDist = length(vec2(0.5, 0.5));\n\n        // 归一化距离 (0为中心，1为边缘)\n        float normalizedDist = distFromCenter / maxDist;\n\n        // 向外溶解：从边缘开始溶解，time控制溶解进度\n        // 增加安全边距，确保动画结束时完全溶解\n        float edgeThreshold = 1.2 - time * 1.5;\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          // 添加基于像素大小的噪声，让边缘呈现颗粒状\n          vec2 pixelCoord = uv * resolution; // 转换为像素坐标\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.4; // 增强噪声影响\n          edgeThreshold += noiseInfluence;\n          return normalizedDist > edgeThreshold ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.15; // 渐变宽度\n            return 1.0 - smoothstep(edgeThreshold - fadeWidth, edgeThreshold, normalizedDist);\n          } else {\n            // 硬边缘：返回0或1\n            return normalizedDist > edgeThreshold ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 向内溶解函数\n      float inwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        vec2 center = vec2(0.5, 0.5);\n        float distFromCenter = length(uv - center);\n        float maxDist = length(vec2(0.5, 0.5));\n\n        float normalizedDist = distFromCenter / maxDist;\n\n        // 向内溶解：从中心开始溶解，time控制溶解进度\n        // 增加系数，确保动画结束时完全溶解\n        float centerThreshold = time * 1.4;\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.4;\n          centerThreshold += noiseInfluence;\n          return normalizedDist < centerThreshold ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.15; // 渐变宽度\n            return smoothstep(centerThreshold, centerThreshold + fadeWidth, normalizedDist);\n          } else {\n            // 硬边缘：返回0或1\n            return normalizedDist < centerThreshold ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 径向溶解函数\n      float radialDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        vec2 center = vec2(0.5, 0.5);\n        float angle = atan(uv.y - center.y, uv.x - center.x);\n        float normalizedAngle = (angle + 3.14159) / (2.0 * 3.14159);\n\n        // 径向溶解：按角度顺序溶解，time控制溶解进度\n        // 增加系数，确保动画结束时完全溶解\n        float angleThreshold = time * 1.2;\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          angleThreshold += noiseInfluence;\n          return normalizedAngle < angleThreshold ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(angleThreshold, angleThreshold + fadeWidth, normalizedAngle);\n          } else {\n            // 硬边缘：返回0或1\n            return normalizedAngle < angleThreshold ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从左到右溶解函数\n      float leftToRightDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 左到右溶解：从x=0开始向x=1溶解\n        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.x < dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.x);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.x < dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从右到左溶解函数\n      float rightToLeftDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 右到左溶解：从x=1开始向x=0溶解\n        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.x > dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.x);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.x > dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从上到下溶解函数\n      float topToBottomDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 上到下溶解：从y=0开始向y=1溶解\n        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.y < dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.y);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.y < dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从下到上溶解函数\n      float bottomToTopDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 下到上溶解：从y=1开始向y=0溶解\n        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.y > dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.y);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.y > dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      void main() {\n        vec2 uv = v_texCoord;\n        vec4 texColor = texture2D(u_texture, uv);\n\n        float alpha = 1.0;\n\n        // 根据溶解类型选择对应的溶解函数\n        if (u_dissolveType == 0) {\n          alpha = outwardDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 1) {\n          alpha = inwardDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 2) {\n          alpha = radialDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 3) {\n          alpha = leftToRightDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 4) {\n          alpha = rightToLeftDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 5) {\n          alpha = topToBottomDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 6) {\n          alpha = bottomToTopDissolve(uv, u_time, u_noiseScale, u_resolution);\n        }\n\n        gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n      }\n    ")}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return t;this.setupWebGLState(t);var e=this.createTextureFromCanvas(t);if(!e)return t;this.noiseData||(this.noiseData=TF.generateNoiseTexture(256,256));var i=this.gl.createTexture();this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,256,256,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,this.noiseData),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);var n=this.createFullScreenQuad();return n?(this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setUniforms(),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.deleteTexture(e),this.gl.deleteTexture(i),this.gl.deleteBuffer(n),this.webglCanvas):t}},{key:"setUniforms",value:function(){if(this.gl&&this.program&&this.webglCanvas){var t=this.gl.getUniformLocation(this.program,"u_texture"),e=this.gl.getUniformLocation(this.program,"u_noiseTexture"),i=this.gl.getUniformLocation(this.program,"u_time"),n=this.gl.getUniformLocation(this.program,"u_dissolveType"),r=this.gl.getUniformLocation(this.program,"u_resolution"),a=this.gl.getUniformLocation(this.program,"u_noiseScale"),o=this.gl.getUniformLocation(this.program,"u_fadeEdge");this.gl.uniform1i(t,0),this.gl.uniform1i(e,1),this.gl.uniform1f(i,this.currentAnimationRatio),this.gl.uniform2f(r,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1f(a,this.dissolveConfig.noiseScale),this.gl.uniform1i(o,this.dissolveConfig.fadeEdge?1:0),this.gl.uniform1i(n,{outward:0,inward:1,radial:2,leftToRight:3,rightToLeft:4,topToBottom:5,bottomToTop:6}[this.dissolveConfig.dissolveType]||0)}}},{key:"applyCanvas2DEffect",value:function(t){var e=this.createOutputCanvas(t);if(!e)return t;var i,n=e.canvas,r=e.ctx,a=r.getImageData(0,0,t.width,t.height),o=this.currentAnimationRatio;switch(this.dissolveConfig.dissolveType){case"outward":i=this.applyOutwardDissolve(a,o);break;case"inward":i=this.applyInwardDissolve(a,o);break;case"radial":i=this.applyRadialDissolve(a,o);break;case"leftToRight":i=this.applyLeftToRightDissolve(a,o);break;case"rightToLeft":i=this.applyRightToLeftDissolve(a,o);break;case"topToBottom":i=this.applyTopToBottomDissolve(a,o);break;case"bottomToTop":i=this.applyBottomToTopDissolve(a,o);break;default:i=a}return r.putImageData(i,0,0),n}},{key:"applyOutwardDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=n/2,s=r/2,l=Math.sqrt(o*o+s*s),u=this.dissolveConfig.noiseScale,c=0;c<r;c++)for(var h=0;h<n;h++){var d=h-o,p=c-s,f=Math.sqrt(d*d+p*p)/l,v=1.2-1.4*e,g=1;if(u>0)g=f>(v+=.4*(TF.pixelNoise(h,c,u)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var y=v-.15;g=f<y?1:f>v?0:1-(f-y)/(v-y)}else g=f>v?0:1;var m=4*(c*n+h);a[m+3]=Math.floor(a[m+3]*g)}return new ImageData(a,n,r)}},{key:"applyInwardDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=n/2,s=r/2,l=Math.sqrt(o*o+s*s),u=this.dissolveConfig.noiseScale,c=0;c<r;c++)for(var h=0;h<n;h++){var d=h-o,p=c-s,f=Math.sqrt(d*d+p*p)/l,v=1.4*e,g=1;if(u>0)g=f<(v+=.4*(TF.pixelNoise(h,c,u)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var y=v+.15;g=f<v?0:f>y?1:(f-v)/(y-v)}else g=f<v?0:1;var m=4*(c*n+h);a[m+3]=Math.floor(a[m+3]*g)}return new ImageData(a,n,r)}},{key:"applyRadialDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=n/2,s=r/2,l=this.dissolveConfig.noiseScale,u=0;u<r;u++)for(var c=0;c<n;c++){var h=c-o,d=u-s,p=(Math.atan2(d,h)+Math.PI)/(2*Math.PI),f=1.2*e,v=1;if(l>0)v=p<(f+=.3*(TF.pixelNoise(c,u,l)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var g=f+.08;v=p<f?0:p>g?1:(p-f)/(g-f)}else v=p<f?0:1;var y=4*(u*n+c);a[y+3]=Math.floor(a[y+3]*v)}return new ImageData(a,n,r)}},{key:"applyLeftToRightDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=l/n,c=1.2*e,h=1;if(o>0)h=u<(c+=.3*(TF.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c+.08;h=u<c?0:u>d?1:(u-c)/(d-c)}else h=u<c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}},{key:"applyRightToLeftDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=l/n,c=1-1.2*e,h=1;if(o>0)h=u>(c+=.3*(TF.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c-.08;h=u<d?1:u>c?0:1-(u-d)/(c-d)}else h=u>c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}},{key:"applyTopToBottomDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=s/r,c=1.2*e,h=1;if(o>0)h=u<(c+=.3*(TF.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c+.08;h=u<c?0:u>d?1:(u-c)/(d-c)}else h=u<c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}},{key:"applyBottomToTopDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=s/r,c=1-1.2*e,h=1;if(o>0)h=u>(c+=.3*(TF.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c-.08;h=u<d?1:u>c?0:1-(u-d)/(c-d)}else h=u>c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}}])}(wF),BF=function(t){function e(t,i,a,o,s){var l,u,c,h;r(this,e),l=n(this,e,[t,i,a,o,s]);var d=void 0!==(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.strength)?s.options.strength:1,p=Math.max(0,Math.min(1,d));return l.colorConfig={effectType:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.effectType)||"grayscale",strength:p,useWebGL:void 0===(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.useWebGL)||s.options.useWebGL},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:DF.STANDARD_VERTEX_SHADER,fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform float u_time;\n      uniform float u_strength;\n      uniform int u_effectType;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n\n      ".concat(DF.SHADER_FUNCTIONS,"\n\n      void main() {\n        vec2 uv = v_texCoord;\n        vec4 originalColor = texture2D(u_texture, uv);\n        vec3 color = originalColor.rgb;\n\n        // 计算动态强度\n        float dynamicStrength = calculateDynamicStrength(u_strength, u_time);\n\n        if (u_effectType == 0) {\n          // 灰度效果\n          float gray = luminance(color);\n          vec3 grayColor = vec3(gray);\n          color = mix(color, grayColor, dynamicStrength);\n        } else if (u_effectType == 1) {\n          // 褐色调效果\n          vec3 sepiaColor = sepia(color);\n          color = mix(color, sepiaColor, dynamicStrength);\n        }\n\n        gl_FragColor = vec4(color, originalColor.a);\n      }\n    ")}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);var e=this.createTextureFromCanvas(t);if(!e)return null;var i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setColorUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}},{key:"setColorUniforms",value:function(){if(this.gl&&this.program){var t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),n=this.gl.getUniformLocation(this.program,"u_effectType"),r=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.colorConfig.strength),this.gl.uniform2f(r,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(n,{grayscale:0,sepia:1}[this.colorConfig.effectType]||0)}}},{key:"applyCanvas2DEffect",value:function(t){if(this.colorConfig.strength<=0){var e=this.createOutputCanvas(t);return e?e.canvas:null}if(this.canUseCSSFilter())return this.applyCSSFilter(t);var i=this.createOutputCanvas(t);if(!i)return null;var n=i.ctx;try{var r,a=n.getImageData(0,0,t.width,t.height),o=this.getAnimationTime();switch(this.colorConfig.effectType){case"grayscale":default:r=this.applyGrayscaleEffect(a,this.colorConfig.strength,o);break;case"sepia":r=this.applySepiaEffect(a,this.colorConfig.strength,o)}return n.clearRect(0,0,t.width,t.height),n.putImageData(r,0,0),i.canvas}catch(t){return console.warn("Canvas 2D color effect failed:",t),null}}},{key:"canUseCSSFilter",value:function(){var t;return!!window.useFilterAPI&&"undefined"!=typeof CSS&&(null===(t=CSS.supports)||void 0===t?void 0:t.call(CSS,"filter","grayscale(1)"))}},{key:"applyCSSFilter",value:function(t){try{var e=TF.createTempCanvas(t.width,t.height),i=e.getContext("2d");if(!i)return null;var n=this.getAnimationTime(),r=TF.calculateDynamicStrength(this.colorConfig.strength,n),a="";return"grayscale"===this.colorConfig.effectType?a="grayscale(".concat(Math.min(1,r),")"):"sepia"===this.colorConfig.effectType&&(a="sepia(".concat(Math.min(1,r),")")),i.filter=a,i.drawImage(t,0,0),i.filter="none",e}catch(t){return console.warn("CSS Filter API failed, falling back to pixel processing:",t),null}}},{key:"applyGrayscaleEffect",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=TF.calculateDynamicStrength(e,i),l=0;l<n.length;l+=4){var u=n[l],c=n[l+1],h=n[l+2],d=n[l+3],p=TF.getLuminance(u,c,h);o[l]=Math.round(TF.lerp(u,p,s)),o[l+1]=Math.round(TF.lerp(c,p,s)),o[l+2]=Math.round(TF.lerp(h,p,s)),o[l+3]=d}return new ImageData(o,r,a)}},{key:"applySepiaEffect",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=TF.calculateDynamicStrength(e,i),l=0;l<n.length;l+=4){var u=n[l],c=n[l+1],h=n[l+2],d=n[l+3],p=m(TF.applySepiaToPixel(u,c,h),3),f=p[0],v=p[1],g=p[2];o[l]=Math.round(TF.lerp(u,f,s)),o[l+1]=Math.round(TF.lerp(c,v,s)),o[l+2]=Math.round(TF.lerp(h,g,s)),o[l+3]=d}return new ImageData(o,r,a)}},{key:"afterStageRender",value:function(t,i){if(this.canUseCSSFilter()&&this.colorConfig.strength>0){var n=this.applyCSSFilter(i);if(n)return n}return _(e,"afterStageRender",this,3)([t,i])}}])}(wF),PF=function(t){function e(t,i,a,o,s){var l,u,c,h;return r(this,e),(l=n(this,e,[t,i,a,o,s])).distortionConfig={distortionType:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.distortionType)||"wave",strength:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.strength)||.3,useWebGL:void 0===(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.useWebGL)||s.options.useWebGL},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        v_texCoord = a_texCoord;\n      }\n    ",fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform float u_time;\n      uniform float u_strength;\n      uniform int u_distortionType;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n\n      // 波浪扭曲函数\n      vec2 wave(vec2 uv, float time, float strength) {\n        float waveX = sin(uv.y * 10.0 + time * 3.0) * strength * 0.1;\n        float waveY = sin(uv.x * 10.0 + time * 2.0) * strength * 0.1;\n        return uv + vec2(waveX, waveY);\n      }\n\n      // 涟漪扭曲函数\n      vec2 ripple(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        float distance = length(uv - center);\n        float ripple = sin(distance * 20.0 - time * 5.0) * strength * 0.1;\n        vec2 direction = normalize(uv - center);\n        return uv + direction * ripple;\n      }\n\n      // 漩涡扭曲函数\n      vec2 swirl(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        vec2 delta = uv - center;\n        float dist = length(delta);\n        float originalAngle = atan(delta.y, delta.x);\n        float rotationAngle = dist * strength * time * 2.0;\n        float finalAngle = originalAngle + rotationAngle;\n        return center + dist * vec2(cos(finalAngle), sin(finalAngle));\n      }\n\n      void main() {\n        vec2 uv = v_texCoord;\n\n        // 根据扭曲类型应用相应变换\n        if (u_distortionType == 0) {\n          uv = wave(uv, u_time, u_strength);\n        } else if (u_distortionType == 1) {\n          uv = ripple(uv, u_time, u_strength);\n        } else if (u_distortionType == 2) {\n          uv = swirl(uv, u_time, u_strength);\n        }\n\n        // 边界检查\n        if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        } else {\n          gl_FragColor = texture2D(u_texture, uv);\n        }\n      }\n    "}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);var e=this.createTextureFromCanvas(t);if(!e)return null;var i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setDistortionUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}},{key:"setDistortionUniforms",value:function(){if(this.gl&&this.program){var t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),n=this.gl.getUniformLocation(this.program,"u_distortionType"),r=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.distortionConfig.strength),this.gl.uniform2f(r,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(n,{wave:0,ripple:1,swirl:2}[this.distortionConfig.distortionType]||0)}}},{key:"applyCanvas2DEffect",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n,r=i.getImageData(0,0,t.width,t.height),a=this.getAnimationTime();switch(this.distortionConfig.distortionType){case"wave":n=this.applyWaveDistortion(r,this.distortionConfig.strength,a);break;case"ripple":n=this.applyRippleDistortion(r,this.distortionConfig.strength,a);break;case"swirl":n=this.applySwirlDistortion(r,this.distortionConfig.strength,a);break;default:n=r}return i.clearRect(0,0,t.width,t.height),i.putImageData(n,0,0),e.canvas}catch(t){return console.warn("Canvas 2D distortion effect failed:",t),null}}},{key:"applyWaveDistortion",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=0;s<a;s++)for(var l=0;l<r;l++){var u=Math.sin(.1*s+3*i)*e*20,c=Math.sin(.1*l+2*i)*e*20,h=Math.round(l-u),d=Math.round(s-c),p=4*(s*r+l);if(h>=0&&h<r&&d>=0&&d<a){var f=4*(d*r+h);o[p]=n[f],o[p+1]=n[f+1],o[p+2]=n[f+2],o[p+3]=n[f+3]}else o[p+3]=0}return new ImageData(o,r,a)}},{key:"applyRippleDistortion",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=r/2,l=a/2,u=0;u<a;u++)for(var c=0;c<r;c++){var h=c-s,d=u-l,p=Math.sqrt(h*h+d*d),f=Math.sin(.2*p-5*i)*e*10,v=Math.atan2(d,h),g=Math.round(c-Math.cos(v)*f),y=Math.round(u-Math.sin(v)*f),m=4*(u*r+c);if(g>=0&&g<r&&y>=0&&y<a){var _=4*(y*r+g);o[m]=n[_],o[m+1]=n[_+1],o[m+2]=n[_+2],o[m+3]=n[_+3]}else o[m+3]=0}return new ImageData(o,r,a)}},{key:"applySwirlDistortion",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=r/2,l=a/2,u=0;u<a;u++)for(var c=0;c<r;c++){var h=c-s,d=u-l,p=Math.sqrt(h*h+d*d),f=Math.atan2(d,h)+p*e*i*.02,v=Math.round(s+p*Math.cos(f)),g=Math.round(l+p*Math.sin(f)),y=4*(u*r+c);if(v>=0&&v<r&&g>=0&&g<a){var m=4*(g*r+v);o[y]=n[m],o[y+1]=n[m+1],o[y+2]=n[m+2],o[y+3]=n[m+3]}else o[y+3]=0}return new ImageData(o,r,a)}},{key:"afterStageRender",value:function(t,i){return this.distortionConfig.strength<=0?i:_(e,"afterStageRender",this,3)([t,i])}}])}(wF),RF=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p;return r(this,e),(l=n(this,e,[t,i,a,o,s])).particles=[],l.positionBuffer=null,l.colorBuffer=null,l.particleConfig={effectType:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.effectType)||"gravity",count:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.count)||4e3,size:(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.size)||20,strength:(null===(d=null==s?void 0:s.options)||void 0===d?void 0:d.strength)||1.5,useWebGL:void 0===(null===(p=null==s?void 0:s.options)||void 0===p?void 0:p.useWebGL)||s.options.useWebGL},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_size;\n\n      uniform vec2 u_resolution;\n      uniform float u_time;\n      uniform float u_forceStrength;\n      uniform int u_effectType;\n\n      varying vec4 v_color;\n\n      void main() {\n        // 将像素坐标转换为剪辑空间坐标\n        vec2 clipSpace = ((a_position / u_resolution) * 2.0) - 1.0;\n        clipSpace.y = -clipSpace.y; // 翻转Y轴\n\n        gl_Position = vec4(clipSpace, 0.0, 1.0);\n        gl_PointSize = a_size;\n        v_color = a_color;\n      }\n    ",fragment:"\n      precision mediump float;\n      varying vec4 v_color;\n\n      void main() {\n        // 创建圆形粒子\n        vec2 coord = gl_PointCoord - vec2(0.5);\n        float distance = length(coord);\n\n        if (distance > 0.5) {\n          discard;\n        }\n\n        // 保持原始颜色，只调整透明度渐变\n        gl_FragColor = vec4(v_color.rgb, v_color.a);\n      }\n    "}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t),0===this.particles.length&&this.extractParticles(t),this.updateParticles(t);var e=this.gl;return e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.program),this.prepareAndDrawParticles(e),this.webglCanvas}},{key:"applyCanvas2DEffect",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.canvas,n=e.ctx,r=this.currentAnimationRatio;switch(this.particleConfig.effectType){case"explode":this.applyCanvas2DExplode(n,t,r);break;case"gravity":this.applyCanvas2DGravity(n,t,r);break;case"vortex":this.applyCanvas2DVortex(n,t,r);break;default:n.globalAlpha=Math.max(0,1-r),n.drawImage(t,0,0)}return i}},{key:"extractParticles",value:function(t){var e=TF.createTempCanvas(t.width,t.height,1),i=e.getContext("2d");if(i){i.drawImage(t,0,0,e.width,e.height);var n=i.getImageData(0,0,e.width,e.height).data;this.particles=[];for(var r=Math.max(1,Math.floor(Math.sqrt(e.width*e.height/(1.5*this.particleConfig.count)))),a=0;a<e.height;a+=r)for(var o=0;o<e.width;o+=r){var s=4*(a*e.width+o),l=n[s],u=n[s+1],c=n[s+2],h=n[s+3];if(h>5){var d=o/e.width*t.width,p=a/e.height*t.height,f={x:d,y:p,originX:d,originY:p,vx:0,vy:0,r:l/255,g:u/255,b:c/255,a:Math.max(.6,h/255),life:1,size:this.particleConfig.size*(1+.5*Math.random())};this.particles.push(f)}}}}},{key:"updateParticles",value:function(t){var e=this,i=t.width/2,n=t.height/2,r=this.currentAnimationRatio,a=this.getDurationFromParent(),o=a<2e3,s=o?Math.max(1.5,3e3/a):1,l=o?Math.min(2,2e3/a):1;this.particles.forEach((function(a){var u=a.x-i,c=a.y-n,h=Math.sqrt(u*u+c*c),d=Math.atan2(c,u);e.applyParticleForces(a,d,h,r,l,t),e.updateParticleProperties(a,r,o,s,l)}))}},{key:"applyParticleForces",value:function(t,e,i,n,r,a){var o=this.getAnimationTime();switch(this.particleConfig.effectType){case"explode":var s=n*this.particleConfig.strength*r*5;t.vx+=Math.cos(e)*s,t.vy+=Math.sin(e)*s;break;case"gravity":this.applyGravityEffect(t,n,r,a,o);break;case"vortex":this.applyVortexEffect(t,n,r,a,e,i)}}},{key:"applyGravityEffect",value:function(t,e,i,n,r){var a=(t.originX+.7*t.originY)/(n.width+n.height)*.8;if(e>a){var o=(e-a)/(1-a),s=this.particleConfig.strength*o*o*12*i;t.vy+=s;var l=Math.sin(3*r+.02*t.originX)*Math.cos(2*r+.015*t.originY);t.vx+=l*this.particleConfig.strength*2*i}}},{key:"applyVortexEffect",value:function(t,e,i,n,r,a){var o=n.width/2,s=n.height/2,l=r+e*Math.PI*.8,u=a+e*Math.max(n.width,n.height)*.7*1.8,c=o+Math.cos(l)*u,h=s+Math.sin(l)*u,d=e*this.particleConfig.strength*.08*i;t.vx+=(c-t.x)*d,t.vy+=(h-t.y)*d}},{key:"updateParticleProperties",value:function(t,e,i,n,r){var a=i?.99:.98;if(t.vx*=a,t.vy*=a,t.x+=t.vx,t.y+=t.vy,i){var o=Math.max(.1,.5/n);t.life=Math.max(0,1-e*o),t.a=Math.max(.2,t.life*Math.min(1,1.2*t.a)),t.size=Math.max(.7*this.particleConfig.size,this.particleConfig.size*(.5+.5*t.life))}else t.life=Math.max(0,1-.2*e),t.a=Math.max(.1,t.life*Math.min(1,1.5*t.a)),t.size=Math.max(.5*this.particleConfig.size,this.particleConfig.size*(.3+.7*t.life))}},{key:"prepareAndDrawParticles",value:function(t){var e=new Float32Array(2*this.particles.length),i=new Float32Array(4*this.particles.length),n=new Float32Array(this.particles.length);this.particles.forEach((function(t,r){e[2*r]=t.x,e[2*r+1]=t.y,i[4*r]=t.r,i[4*r+1]=t.g,i[4*r+2]=t.b,i[4*r+3]=Math.max(.1,t.a),n[r]=Math.max(6,1.5*t.size)})),this.updateParticleBuffers(t,e,i,n),this.setParticleUniforms(t),t.drawArrays(t.POINTS,0,this.particles.length),this.cleanupTempBuffers(t)}},{key:"updateParticleBuffers",value:function(t,e,i,n){this.positionBuffer||(this.positionBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW);var r=t.getAttribLocation(this.program,"a_position");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),this.colorBuffer||(this.colorBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW);var a=t.getAttribLocation(this.program,"a_color");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,4,t.FLOAT,!1,0,0);var o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,n,t.DYNAMIC_DRAW);var s=t.getAttribLocation(this.program,"a_size");t.enableVertexAttribArray(s),t.vertexAttribPointer(s,1,t.FLOAT,!1,0,0),this._tempSizeBuffer=o}},{key:"setParticleUniforms",value:function(t){var e=t.getUniformLocation(this.program,"u_resolution"),i=t.getUniformLocation(this.program,"u_time"),n=t.getUniformLocation(this.program,"u_forceStrength"),r=t.getUniformLocation(this.program,"u_effectType");t.uniform2f(e,this.webglCanvas.width,this.webglCanvas.height),t.uniform1f(i,this.getAnimationTime()),t.uniform1f(n,this.particleConfig.strength),t.uniform1i(r,{explode:0,vortex:1,gravity:2}[this.particleConfig.effectType]||0)}},{key:"cleanupTempBuffers",value:function(t){var e=this._tempSizeBuffer;e&&(t.deleteBuffer(e),delete this._tempSizeBuffer)}},{key:"applyCanvas2DExplode",value:function(t,e,i){var n=e.width/2,r=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(n,r);var a=1+.5*i;t.scale(a,a),t.translate(-n,-r),t.drawImage(e,0,0),t.restore()}},{key:"applyCanvas2DGravity",value:function(t,e,i){t.save(),t.globalAlpha=Math.max(0,1-i);var n=i*e.height*.3;t.drawImage(e,0,n),t.restore()}},{key:"applyCanvas2DVortex",value:function(t,e,i){var n=e.width/2,r=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(n,r),t.rotate(i*Math.PI*2),t.translate(-n,-r),t.drawImage(e,0,0),t.restore()}}])}(wF),LF=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).glitchConfig={effectType:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.effectType)||"rgb-shift",intensity:void 0!==(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.intensity)?s.options.intensity:.5},l}return h(e,t),o(e,[{key:"applyCanvas2DEffect",value:function(t){if(this.glitchConfig.intensity<=0){var e=this.createOutputCanvas(t);return e?e.canvas:null}try{switch(this.glitchConfig.effectType){case"rgb-shift":default:return this.applyRGBShiftGlitch(t);case"digital-distortion":return this.applyDigitalDistortionGlitch(t);case"scan-lines":return this.applyScanLineGlitch(t);case"data-corruption":return this.applyDataCorruptionGlitch(t)}}catch(t){return console.warn("Glitch effect failed:",t),null}}},{key:"applyRGBShiftGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{i.clearRect(0,0,t.width,t.height);var n=TF.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),r=Math.floor(20*n),a=this.generateRandomOffset(r),o=this.generateRandomOffset(r,.3),s=this.generateRandomOffset(-r),l=TF.createTempCanvas(t.width,t.height),u=l.getContext("2d");u.drawImage(t,0,0);var c=u.getImageData(0,0,t.width,t.height),h=TF.extractChannel(c,0),d=TF.extractChannel(c,1),p=TF.extractChannel(c,2);return i.globalCompositeOperation="screen",u.clearRect(0,0,t.width,t.height),u.putImageData(h,0,0),i.drawImage(l,a.x,a.y),u.clearRect(0,0,t.width,t.height),u.putImageData(d,0,0),i.drawImage(l,o.x,o.y),u.clearRect(0,0,t.width,t.height),u.putImageData(p,0,0),i.drawImage(l,s.x,s.y),i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("RGB shift glitch failed:",t),null}}},{key:"applyDigitalDistortionGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n=i.getImageData(0,0,t.width,t.height),r=TF.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),a=this.processDigitalDistortion(n,r);return i.clearRect(0,0,t.width,t.height),i.putImageData(a,0,0),e.canvas}catch(t){return console.warn("Digital distortion glitch failed:",t),null}}},{key:"applyScanLineGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n=TF.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),r=Math.max(2,Math.floor(10-8*n));i.globalCompositeOperation="multiply";for(var a=0;a<t.height;a+=r)if(Math.random()<n){var o=.1+.4*n;i.fillStyle="rgba(0, 0, 0, ".concat(o,")"),i.fillRect(0,a,t.width,1)}i.globalCompositeOperation="screen";for(var s=Math.floor(20*n),l=0;l<s;l++){var u=Math.random()*t.height,c=.3*n;i.fillStyle="rgba(255, 255, 255, ".concat(c,")"),i.fillRect(0,Math.floor(u),t.width,1)}return i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("Scan line glitch failed:",t),null}}},{key:"applyDataCorruptionGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n=i.getImageData(0,0,t.width,t.height),r=TF.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),a=this.processDataCorruption(n,r);return i.clearRect(0,0,t.width,t.height),i.putImageData(a,0,0),e.canvas}catch(t){return console.warn("Data corruption glitch failed:",t),null}}},{key:"generateRandomOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{x:(Math.random()-.5)*t,y:(Math.random()-.5)*t*e}}},{key:"processDigitalDistortion",value:function(t,e){for(var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i),o=Math.floor(20*e)+5,s=Math.floor(r/o),l=0;l<o;l++)if(Math.random()<e){var u=l*s,c=Math.min(u+s,r),h=Math.floor((Math.random()-.5)*n*e*.1);this.shiftSliceHorizontal(a,n,r,u,c,h)}for(var d=.3*e,p=0;p<i.length;p+=4)Math.random()<d&&(a[p]=255*Math.random(),a[p+1]=255*Math.random(),a[p+2]=255*Math.random());return new ImageData(a,n,r)}},{key:"shiftSliceHorizontal",value:function(t,e,i,n,r,a){for(var o=new Uint8ClampedArray(4*e),s=n;s<r;s++){for(var l=s*e*4,u=0;u<4*e;u++)o[u]=t[l+u];for(var c=0;c<e;c++){var h=l+4*c,d=(c-a+e)%e*4;t[h]=o[d],t[h+1]=o[d+1],t[h+2]=o[d+2],t[h+3]=o[d+3]}}}},{key:"processDataCorruption",value:function(t,e){for(var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i),o=Math.floor(15*e)+5,s=0;s<o;s++)if(Math.random()<e)for(var l=Math.floor(Math.random()*n),u=Math.floor(5*Math.random())+1,c=Math.random()<.5?0:255,h=0;h<r;h++)for(var d=0;d<u&&l+d<n;d++){var p=4*(h*n+l+d);a[p]=c,a[p+1]=c,a[p+2]=c}for(var f=Math.floor(20*e),v=0;v<f;v++){var g=Math.floor(Math.random()*n),y=Math.floor(Math.random()*r),m=Math.floor(20*Math.random())+5,_=Math.floor(10*Math.random())+2;this.corruptBlock(a,n,r,g,y,m,_)}return new ImageData(a,n,r)}},{key:"corruptBlock",value:function(t,e,i,n,r,a,o){for(var s=0;s<o&&r+s<i;s++)for(var l=0;l<a&&n+l<e;l++){var u=4*((r+s)*e+(n+l));Math.random()<.7&&(t[u]=255*Math.random(),t[u+1]=255*Math.random(),t[u+2]=255*Math.random())}}}])}(MF),IF=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).blurConfig={blurRadius:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.blurRadius)||8,useOptimizedBlur:void 0===(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.useOptimizedBlur)||s.options.useOptimizedBlur},l}return h(e,t),o(e,[{key:"applyCSSBlur",value:function(t,e){var i=tS.createCanvas({width:t.width,height:t.height,dpr:tS.devicePixelRatio}),n=i.getContext("2d");return n?(n.filter="blur(".concat(e,"px)"),n.drawImage(t,0,0),n.filter="none",i):t}},{key:"applyDownsampleBlur",value:function(t,e){var i=t.width,n=t.height,r=Math.max(1,Math.floor(e/2)),a=Math.floor(i/r),o=Math.floor(n/r),s=tS.createCanvas({width:a,height:o,dpr:1}),l=s.getContext("2d");if(!l)return t;var u=tS.createCanvas({width:i,height:n,dpr:1}),c=u.getContext("2d");return c?(c.putImageData(t,0,0),l.drawImage(u,0,0,a,o),l.filter="blur(".concat(e/r,"px)"),l.drawImage(s,0,0),l.filter="none",c.clearRect(0,0,i,n),c.drawImage(s,0,0,i,n),c.getImageData(0,0,i,n)):t}},{key:"afterStageRender",value:function(t,e){if(this.blurConfig.blurRadius<=0)return e;var i;if(this.blurConfig.useOptimizedBlur)i=this.applyCSSBlur(e,this.blurConfig.blurRadius);else{var n=tS.createCanvas({width:e.width,height:e.height,dpr:tS.devicePixelRatio}),r=n.getContext("2d");if(!r)return!1;r.clearRect(0,0,e.width,e.height),r.drawImage(e,0,0);var a=r.getImageData(0,0,e.width,e.height),o=this.applyDownsampleBlur(a,this.blurConfig.blurRadius);r.putImageData(o,0,0),i=n}var s=i.getContext("2d");return s&&(s.globalCompositeOperation="overlay",s.fillStyle="rgba(255, 255, 255, 0.1)",s.fillRect(0,0,i.width,i.height),s.globalCompositeOperation="source-over"),i}}])}(jL),FF=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).pixelationConfig={maxPixelSize:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.maxPixelSize)||20,method:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.method)||"out"},l}return h(e,t),o(e,[{key:"applyDownsamplePixelation",value:function(t,e){if(e<=1)return t;var i=t.width,n=t.height,r=Math.ceil(i/e),a=Math.ceil(n/e),o=tS.createCanvas({width:r,height:a,dpr:1}),s=o.getContext("2d");if(!s)return t;var l=tS.createCanvas({width:i,height:n,dpr:tS.devicePixelRatio}),u=l.getContext("2d");return u?(s.imageSmoothingEnabled=!1,u.imageSmoothingEnabled=!1,s.drawImage(t,0,0,r,a),u.drawImage(o,0,0,i,n),l):t}},{key:"updateAnimationProgress",value:function(){return"in"===this.pixelationConfig.method?this.pixelationConfig.maxPixelSize-this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1):1+this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1)}},{key:"afterStageRender",value:function(t,e){var i=this.updateAnimationProgress();return i<=1?e:this.applyDownsamplePixelation(e,i)}}])}(CF),OF=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,e=WL(this.target);this._animator=e;var i=this.duration,n=this.easing,r=this.params,a=r.config,o=r.lastScale,s=r.getTickCoord,l=1,u=this.target.data;if(o&&s&&u){l=.7;var c=s(o.scale(u.rawValue)),h=this.target.attribute.x,d=this.target.attribute.y;this.target.setAttributes({x:c.x,y:c.y}),e.animate(this.target,{type:"to",to:{x:h,y:d},duration:i,easing:n})}e.animate(this.target,{type:null!==(t=a.type)&&void 0!==t?t:"fadeIn",to:a.to,duration:i*l,easing:n}),this.completeBind(e)}}])}(UL),zF=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=WL(this.target);this._animator=t;var e=this.duration,i=this.easing,n=this.params;n.config;var r=n.diffAttrs;t.animate(this.target,{type:"to",to:Object.assign({},r),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},r)}}),this.completeBind(t)}},{key:"deleteSelfAttr",value:function(t){_(e,"deleteSelfAttr",this,3)([t]),this._animator.deleteSelfAttr(t)}},{key:"tryPreventConflict",value:function(){}}])}(UL);function HF(){YB(),ZB(),lP(),fP(),DL.registerBuiltInAnimate("axisEnter",OF),DL.registerBuiltInAnimate("axisUpdate",zF)}var NF=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};HF(),rP();var UF=function(t){function e(t,i){var a,o;if(r(this,e),t.labelHoverOnAxis&&(t.labelHoverOnAxis.textStyle=Object.assign({},t.label.style,t.labelHoverOnAxis.textStyle),void 0===t.labelHoverOnAxis.space)){var s=t.labelHoverOnAxis.padding,l=rr(void 0===s?2:s),u="bottom"===t.orient?l[0]:"left"===t.orient?l[1]:"top"===t.orient?l[2]:l[3],c=(null!==(o=t.label.space)&&void 0!==o?o:e.defaultAttributes.label.space)-u;t.labelHoverOnAxis.space=c}return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t),i])).labelHoverOnAxisGroup=null,a}return h(e,t),o(e,[{key:"_renderInner",value:function(t){var i,n=this;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){for(var r=[],a=0;a<this.attribute.breaks.length;a++){var o=this.attribute.breaks[a],s=o.range,l=o.breakSymbol,u=o.rawRange;r.push({startPoint:this.getTickCoord(s[0]),endPoint:this.getTickCoord(s[1]),range:s,breakSymbol:l,rawRange:u})}this._breaks=r}_(e,"_renderInner",this,3)([t]),this._breaks&&this._breaks.length&&this._breaks.forEach((function(e,i){var r=e.startPoint,a=e.endPoint,o=e.breakSymbol,s=e.rawRange;if(!1!==(null==o?void 0:o.visible)){var l=B_.group({zIndex:999});l.name=DR.axisBreak,l.id=n._getNodeId("".concat(DR.axisBreak,"-").concat(i)),l.data=s;var u=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.style,r=void 0===n?{}:n,a=i.angle,o=void 0===a?.5*Math.PI:a,s=mt({},LR,r),l=null!==(t=s.size)&&void 0!==t?t:LR.size;return Object.assign(Object.assign({},s),{symbolType:null!==(e=s.symbolType)&&void 0!==e?e:"M ".concat(-l/2," ").concat(l*Math.sin(o)," L ").concat(l/2," ").concat(-l*Math.sin(o)),symbolSize:l})}(o),c=B_.symbol(Object.assign({x:r.x,y:r.y},u));c.name=DR.axisBreakSymbol;var h=B_.symbol(Object.assign({x:a.x,y:a.y},u));h.name=DR.axisBreakSymbol,l.add(c),l.add(h),t.add(l)}}));var c=this.attribute.panel;if(c&&c.visible){var h=this.axisContainer,d=h.AABBBounds,p=B_.rect(Object.assign({x:d.x1,y:d.y1,width:d.width(),height:d.height()},c.style));p.name=DR.background,p.id=this._getNodeId("background"),p.states=mt({},PR,null!==(i=c.state)&&void 0!==i?i:{}),h.insertBefore(p,h.firstChild)}var f=this.attribute.labelHoverOnAxis;f&&f.visible&&this.renderLabelHoverOnAxis()}},{key:"renderLabelHoverOnAxis",value:function(){var t=this.getLabelHoverOnAxisAttribute(),e=new iR(Object.assign({},t));e.name=DR.title,e.id=this._getNodeId("hover-on-label"),this.labelHoverOnAxisGroup=e,this.axisContainer.add(e)}},{key:"renderLine",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.line,a=r.startSymbol,o=r.endSymbol,s=r.style,l=r.state,u=NF(r,["startSymbol","endSymbol","style","state"]),c=Object.assign({startSymbol:a,endSymbol:o,lineStyle:s},u);if(this._breaks&&this._breaks.length){var h=[],d=i;this._breaks.forEach((function(t){var e=t.startPoint,i=t.endPoint;h.push([d,e]),d=i})),h.push([d,n]),c.points=h,c.multiSegment=!0}else c.points=[i,n];ct(l)||(c.state={line:mt({},PR,l),symbol:mt({},PR,l)});var p=new TR(c);p.name=DR.line,p.id=this._getNodeId("line"),t.add(p)}},{key:"getTextAlign",value:function(t){var e="center";return ie(t[0],0)?ie(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this,r=this.attribute.title,a=r.position,o=void 0===a?"middle":a,s=r.space,l=void 0===s?4:s,u=r.textStyle,c=void 0===u?{}:u,h=r.autoRotate,d=void 0===h||h,p=r.shape,f=r.background,v=r.state,g=void 0===v?{}:v,y=r.maxWidth,m=NF(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),_=.5;"start"===o?_=0:"end"===o&&(_=1);var b=this.attribute.verticalFactor,x=-1*(void 0===b?1:b),k=this.getTickCoord(_),S=this.getRelativeVector(),A=0;if((null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside){var C=+ht(this.attribute,"label.space",4);A+=C;var M=Object.keys(this.axisLabelLayerSize).length;if(0===S[1]){var w=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(w)?A+=w+(M-1)*C:A=0}else if(0===S[0])if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){var T=this.axisLabelLayerSize[0].labelPos,D=this.axisLabelsContainer.AABBBounds;A+=(1===x?D.x2>T?Math.min(D.x2-T,D.width()):0:D.x1<T?Math.min(T-D.x1,D.width()):0)+(M-1)*C}else A=0;else Object.keys(this.axisLabelLayerSize).forEach((function(t,e){A+=n.axisLabelLayerSize[t].width+(e>0?C:0)}))}var E=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(E=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(E=Math.max(E,this.attribute.subTick.length||2));var B,P,R=E+A+l,L=this.getVerticalCoord(k,R,!1),I=this.getVerticalVector(R,!1,{x:0,y:0}),F=m.angle;if(B="start"===o?"start":"end"===o?"end":"center",j(F)&&d){F=WP(S,[1,0],!0);var O=this.attribute.verticalFactor;P=1==-1*(void 0===O?1:O)?"bottom":"top"}else B=this.getTextAlign(I),P=this.getTextBaseline(I,!1);var z=y;if(j(z)){var H=this.attribute,N=H.verticalLimitSize,U=H.verticalMinSize,V=H.orient,W=Math.min(N||1/0,U||1/0);if(it(W))if("bottom"===V||"top"===V)if(F!==Math.PI/2){var G=Math.abs(Math.cos(null!=F?F:0));z=G<1e-6?1/0:this.attribute.end.x/G}else z=W-R;else if(F&&0!==F){var Y=Math.abs(Math.sin(F));z=Y<1e-6?1/0:this.attribute.end.y/Y}else z=W-R}var X=Object.assign(Object.assign(Object.assign({},L),m),{maxWidth:z,textStyle:Object.assign({textAlign:B,textBaseline:P},c),state:{text:mt({},PR,g.text),shape:mt({},PR,g.shape),panel:mt({},PR,g.background)}});return X.angle=F,p&&p.visible&&(X.shape=Object.assign({visible:!0},p.style),p.space&&(X.space=p.space)),f&&f.visible&&(X.panel=Object.assign({visible:!0},f.style)),X}},{key:"getLabelHoverOnAxisAttribute",value:function(){var t,e,i=this.attribute.orient,n=this.attribute.labelHoverOnAxis,r=n.position,a=void 0===r?0:r,o=n.space,s=void 0===o?4:o,l=n.autoRotate,u=void 0===l||l,c=n.textStyle,h=void 0===c?{}:c,d=n.background,p=void 0===d?{}:d,f=n.formatMethod,v=n.text,g=void 0===v?"":v,y=n.maxWidth,m=NF(n,["position","space","autoRotate","textStyle","background","formatMethod","text","maxWidth"]),_=this.getTickCoord(0);"bottom"===i||"top"===i?_.x=a:_.y=a;var b=0;(null===(t=this.attribute.tick)||void 0===t?void 0:t.visible)&&!1===this.attribute.tick.inside&&(b=this.attribute.tick.length||4),(null===(e=this.attribute.subTick)||void 0===e?void 0:e.visible)&&!1===this.attribute.subTick.inside&&(b=Math.max(b,this.attribute.subTick.length||2));var x,k=b+0+s,S=this.getVerticalCoord(_,k,!1),A=this.getVerticalVector(k,!1,{x:0,y:0}),C=m.angle,M="center";if(j(C)&&u){C=WP(this.getRelativeVector(),[1,0],!0);var w=this.attribute.verticalFactor;x=1==-1*(void 0===w?1:w)?"bottom":"top"}else{var T=this.getLabelAlign(A,!1,h.angle);M=T.textAlign,x=T.textBaseline}var D=y,E=f?f(g):g,B=Object.assign(Object.assign(Object.assign({},S),m),{maxWidth:D,textStyle:Object.assign({textAlign:M,textBaseline:x},h),text:E});return B.angle=C,p&&p.visible&&(B.panel=Object.assign(Object.assign({visible:!0},m.panel),p.style)),B}},{key:"getTextBaseline",value:function(t,e){var i="middle",n=this.attribute.verticalFactor,r=(e?1:-1)*(void 0===n?1:n);return ie(t[1],0)?i=!ie(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1===r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}},{key:"getLabelAlign",value:function(t,e,i){var n=this.attribute.orient;if(["top","bottom","right","left"].includes(n)||0===t[0]&&0===t[1]){if("top"===n||"bottom"===n)return rL(e?"bottom"===n?"top":"bottom":n,i);if("left"===n||"right"===n)return aL(e?"left"===n?"right":"left":n,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){var a,o,s,l,u=(this.attribute.label||{}).flush;if(void 0!==u&&u&&t.length){var c=this.attribute,h=c.orient,d=c.start,p=c.end,f="bottom"===h||"top"===h,v=t[0],g=Et(t),y=f?v.attribute.x>g.attribute.x:v.attribute.y<g.attribute.y;if(f){var m=y?g:v,_=y?v:g,b=d.x,x=p.x,k=m.AABBBounds.x1,S=_.AABBBounds.x2;k<b&&(m.attribute.angle?m.setAttributes({dx:(null!==(a=m.attribute.dx)&&void 0!==a?a:0)+b-k}):m.setAttributes({x:b,textAlign:"left"})),S>x&&(_.attribute.angle?_.setAttributes({dx:(null!==(o=_.attribute.dx)&&void 0!==o?o:0)+x-S}):_.setAttributes({x:x,textAlign:"right"}))}else{var A=y?g:v,C=y?v:g,M=A.AABBBounds.y2,w=C.AABBBounds.y1,T=d.y,D=p.y;w<T&&(C.attribute.angle?C.setAttributes({dy:(null!==(s=C.attribute.dy)&&void 0!==s?s:0)+T-w}):C.setAttributes({y:T,textBaseline:"top"})),M>D&&(A.attribute.angle?A.setAttributes({dy:(null!==(l=A.attribute.dy)&&void 0!==l?l:0)+D-M}):A.setAttributes({y:D,textBaseline:"bottom"}))}}}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!ct(t)){var a=this.attribute,o=a.verticalLimitSize,s=a.label,l=a.orient,u=this._getAxisLabelLimitLength(o,r),c=s.layoutFunc,h=s.autoRotate,d=s.autoRotateAngle,p=s.autoLimit,f=s.limitEllipsis,v=s.autoHide,g=s.autoHideMethod,y=s.autoHideSeparation,m=s.lastVisible,_=s.firstVisible,b=s.autoWrap,x=s.overflowLimitLength;if(U(c))c(t,e,n,this);else{if(h)iL(t,{labelRotateAngle:d,orient:l});else if(b){!function(t,e){var i=e.limitLength,n=e.axisLength,r=e.ellipsis,a=void 0===r?"...":r,o=e.orient;if(!ct(t)&&it(i)){var s=t[0].attribute.angle,l=zR(s),u=OR(s),c="top"===o||"bottom"===o,h=n/t.length;t.forEach((function(e,n){var r,o,s,d,p;if(c){if(u&&Math.floor(e.AABBBounds.height())<=i)return;if(l){var f=sL(e.attribute.x,null===(r=t[n+1])||void 0===r?void 0:r.attribute.x,null===(o=t[n-1])||void 0===o?void 0:o.attribute.x);it(f)&&(h=oi(h,f))}}else{if(u){var v=sL(e.attribute.y,null===(s=t[n+1])||void 0===s?void 0:s.attribute.y,null===(d=t[n-1])||void 0===d?void 0:d.attribute.y);it(v)&&(h=oi(h,v))}if(l&&Math.floor(e.AABBBounds.width())<=i)return}var g=null,y=null;c?u?(g=i,y=h):(g=h,y=i):u?(g=h,y=i):(g=i,y=h),e.setAttributes({maxLineWidth:g,ellipsis:null!==(p=e.attribute.ellipsis)&&void 0!==p?p:a,whiteSpace:"normal",heightLimit:y})}))}}(t,{orient:l,limitLength:u,axisLength:"left"===l||"right"===l?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),ellipsis:f})}if(!b&&p&&it(u)&&u>0){var k="left"===l||"right"===l,S=k?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x);oL(t,{limitLength:u,verticalLimitLength:k?S/t.length:v||h?1/0:S/t.length,ellipsis:f,orient:l,axisLength:S,overflowLimitLength:x})}v&&eL(t,{orient:l,method:g,separation:y,lastVisible:m,firstVisible:_})}}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){var a,o=this.attribute,s=o.verticalLimitSize,l=o.orient,u="bottom"===l||"top"===l,c=i.AABBBounds,h=u?c.height():c.width(),d=this.attribute.verticalMinSize;if(it(d)&&(!it(s)||d<=s)){var p,f,v=this._getAxisLabelLimitLength(d,r);h=Math.max(h,v),"left"===l?(p=c.x2-h,f=c.y1):"right"===l?(p=c.x1,f=c.y1):"top"===l?(p=c.x1,f=c.y2-h):"bottom"===l&&(p=c.x1,f=c.y1);var g=B_.rect({x:p,y:f,width:u?c.width():h,height:u?h:c.height(),pickable:!1});g.name=DR.axisLabelBackground,g.id=this._getNodeId("axis-label-background"),i.insertBefore(g,i.firstChild)}W(this.attribute.label.containerAlign)&&("left"===l?a=c.x2-h:"right"===l?a=c.x1:"top"===l?a=c.y2-h:"bottom"===l&&(a=c.y1),function(t,e,i,n,r){"left"===n||"right"===n?"left"===r?t.forEach((function(t){var i;t.setAttributes({dx:(null!==(i=t.attribute.dx)&&void 0!==i?i:0)+e-t.AABBBounds.x1})})):"right"===r?t.forEach((function(t){var n;t.setAttributes({dx:(null!==(n=t.attribute.dx)&&void 0!==n?n:0)+e+i-t.AABBBounds.x2})})):"center"===r&&t.forEach((function(t){var n;t.setAttributes({dx:(null!==(n=t.attribute.dx)&&void 0!==n?n:0)+e+i/2-(t.AABBBounds.x1+t.AABBBounds.x2)/2})})):"bottom"!==n&&"top"!==n||("top"===r?t.forEach((function(t){var i;t.setAttributes({dy:(null!==(i=t.attribute.dy)&&void 0!==i?i:0)+e-t.AABBBounds.y1})})):"bottom"===r?t.forEach((function(t){var n;t.setAttributes({dy:(null!==(n=t.attribute.dy)&&void 0!==n?n:0)+e+i-t.AABBBounds.y2})})):"middle"===r&&t.forEach((function(t){var n;t.setAttributes({dy:(null!==(n=t.attribute.dy)&&void 0!==n?n:0)+e+i/2-(t.AABBBounds.y1+t.AABBBounds.y2)/2})})))}(t,a,h,l,this.attribute.label.containerAlign))}},{key:"_getAxisLabelLimitLength",value:function(t,e){var i,n,r,a,o,s=this.attribute,l=s.label,u=s.title,c=s.line,h=s.tick,d=null!==(i=l.space)&&void 0!==i?i:4,p=t,f=0,v=0,g=c&&c.visible?null!==(n=c.style.lineWidth)&&void 0!==n?n:1:0,y=h&&h.visible?null!==(r=h.length)&&void 0!==r?r:4:0;if(u&&u.visible&&"string"==typeof u.text){f=YP(u.text,u.textStyle,null===(o=null===(a=this.stage)||void 0===a?void 0:a.getTheme())||void 0===o?void 0:o.text).height;var m=rr(u.padding);v=u.space+m[0]+m[2]}return p&&(p=(p-d-v-f-g-y)/e),p}},{key:"showLabelHoverOnAxis",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.attribute.labelHoverOnAxis){var n=this.axisContainer.AABBBounds,r=n.width(),a=n.height(),o=n.x1,s=n.y1,l=n.x2,u=n.y2;if(this.labelHoverOnAxisGroup){var c=this.attribute.labelHoverOnAxis.formatMethod,h=c?c(e):e;this.labelHoverOnAxisGroup.setAttribute("text",h),this.labelHoverOnAxisGroup.setAttribute("visible",!0),this.labelHoverOnAxisGroup.setAttribute("visibleAll",!0),"left"===this.attribute.orient||"right"===this.attribute.orient?this.labelHoverOnAxisGroup.setAttributes({y:t}):this.labelHoverOnAxisGroup.setAttributes({x:t})}else this.attribute.labelHoverOnAxis.visible=!0,this.attribute.labelHoverOnAxis.position=t,this.attribute.labelHoverOnAxis.text=e,this.renderLabelHoverOnAxis();if(i){var d=this.axisContainer.AABBBounds,p=d.width()-r,f=d.height()-a;p>0&&("top"===this.attribute.orient||"bottom"===this.attribute.orient)&&(d.x1<o?this.showLabelHoverOnAxis(t+p,e,!1):d.x2>l&&this.showLabelHoverOnAxis(t-p,e,!1)),f>0&&("left"===this.attribute.orient||"right"===this.attribute.orient)&&(d.y1<s?this.showLabelHoverOnAxis(t+f,e,!1):d.y2>u&&this.showLabelHoverOnAxis(t-f,e,!1))}}}},{key:"hideLabelHoverOnAxis",value:function(){this.attribute.labelHoverOnAxis&&this.labelHoverOnAxisGroup&&this.labelHoverOnAxisGroup.setAttributes({visible:!1,visibleAll:!1})}},{key:"release",value:function(){_(e,"release",this,3)([]),this._breaks=null}}])}(JR);UF.defaultAttributes=RR,Tt(UF,lL);var jF=function(){return o((function t(){r(this,t)}),[{key:"isInValidValue",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?mP:i,r=e.endAngle,a=void 0===r?_P:r;return Math.abs(a-n)%(2*Math.PI)==0?t>1:t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?mP:i,r=e.endAngle,a=void 0===r?_P:r,o=e.center,s=e.radius,l=e.inside,u=void 0!==l&&l,c=e.innerRadius,h=void 0===c?0:c;return Pi(o,u&&h>0?h:s,n+(a-n)*t)}},{key:"getVerticalVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return UR(t,arguments.length>2?arguments[2]:void 0,this.attribute.center,e,this.attribute.inside)}},{key:"getRelativeVector",value:function(t){var e=this.attribute.center;return[t.y-e.y,-1*(t.x-e.x)]}}])}();function VF(t,e){var i=t.length;return{prevLabel:e>=1?t[e-1]:t[i-1],nextLabel:e<i-1?t[e+1]:t[0]}}function WF(t,e,i){var n;t.setAttributes({maxLineWidth:e,ellipsis:null!==(n=t.attribute.ellipsis)&&void 0!==n?n:i})}function GF(t,e,i){var n=[];if(t.length>=3){var r=VF(t,e),a=r.prevLabel,o=r.nextLabel;n.push(a,o)}else 2===t.length&&n.push(t[0===e?1:0]);var s=t[e],l=Math.min(Math.abs(s.attribute.y-i.y1),Math.abs(s.attribute.y-i.y2));n.forEach((function(t){l=Math.min(l,Math.abs(t.attribute.y-s.attribute.y))})),l>0&&s.setAttributes({whiteSpace:"normal",heightLimit:l})}var YF=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};HF(),jB();var XF=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderLine",value:function(t){var e,i=this.attribute,n=i.startAngle,r=void 0===n?mP:n,a=i.endAngle,o=void 0===a?_P:a,s=i.radius,l=i.center,u=i.innerRadius,c=void 0===u?0:u,h=i.line,d=void 0===h?{}:h,p=i.inside,f=void 0!==p&&p,v=i.sides,g=s,y=c;if(f&&c>0&&(g=c,y=0),it(v)&&v>=3){var m=jR(l,v,g,r,o);e=B_.path(Object.assign(Object.assign({},d.style),{path:VR(m,!0)}))}else{var _=Object.assign(Object.assign(Object.assign({},l),{startAngle:r,endAngle:o,radius:g,innerRadius:y}),d.style);e=B_.circle(_)}e.name=DR.line,e.id=this._getNodeId("line"),ct(d.state)||(e.states=mt({},PR,d.state)),t.add(e)}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this.attribute,r=n.center,a=n.radius,o=n.innerRadius,s=void 0===o?0:o,l=this.attribute.title,u=l.space,c=void 0===u?4:u,h=l.textStyle,d=void 0===h?{}:h,p=l.shape,f=l.background,v=l.state,g=void 0===v?{}:v,y=YF(l,["space","textStyle","shape","background","state"]),m=r,_=0;(null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside&&(_=ht(this.attribute.label,"style.fontSize",12)+ht(this.attribute.label,"space",4));var b=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(b=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(b=Math.max(b,this.attribute.subTick.length||2));var x=a+b+_+c,k="middle",S=this.attribute.title.position;j(S)&&(S=0===s?"end":"middle"),"start"===S?(k="bottom",m={x:r.x,y:r.y-x}):"end"===S&&(k="top",m={x:r.x,y:r.y+x});var A=Object.assign(Object.assign(Object.assign({},m),y),{textStyle:Object.assign({textBaseline:k,textAlign:"center"},d),state:{text:mt({},PR,g.text),shape:mt({},PR,g.shape),panel:mt({},PR,g.background)}}),C=y.angle;return A.angle=C,p&&p.visible&&(A.shape=Object.assign({visible:!0},p.style),p.space&&(A.space=p.space)),f&&f.visible&&(A.panel=Object.assign({visible:!0},f.style)),A}},{key:"getSubTickLineItems",value:function(){var t,e,i=this.attribute.subTick,n=[],r=i.count,a=void 0===r?4:r,o=i.inside,s=void 0!==o&&o,l=i.length,u=void 0===l?2:l,c=this.tickLineItems,h=c.length;if(h>=2)for(var d=this.data[1].value-this.data[0].value,p=null===(e=null===(t=this.attribute)||void 0===t?void 0:t.tick)||void 0===e?void 0:e.alignWithLabel,f=0;f<h;f++)for(var v=c[f],g=c[f+1],y=0;y<a;y++){var m=(y+1)/(a+1),_=(1-m)*v.value+m*(g?g.value:p?1:v.value+d),b=this.getTickCoord(_),x=this.getVerticalCoord(b,u,s);n.push({start:b,end:x,value:_})}return n}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!ct(t)){var a=this.attribute,o=a.inside,s=a.radius,l=a.center,u=a.size,c=a.label,h=a.orient,d=u?{x1:0,y1:0,x2:u.width,y2:u.height}:{x1:l.x-s,y1:l.y-s,x2:l.x+s,y2:l.y+s},p=c.layoutFunc,f=c.autoLimit,v=c.limitEllipsis,g=c.autoHide,y=c.autoHideMethod,m=c.autoHideSeparation,_=c.autoWrap;U(p)?p(t,e,n,this):((f||_)&&function(t,e){var i=e.ellipsis,n=e.inside,r=e.bounds,a=e.autoWrap,o=e.center;n||t.forEach((function(e,n){var s=e.attribute,l=s.x,u=s.y,c=e.AABBBounds;if(ie(l,o.x)){if(u>r.y2||u<r.y1)return void WF(e,0,i);var h=r.x2-r.x1;if(t.length>=3){var d=VF(t,n),p=d.prevLabel,f=d.nextLabel,v=p.attribute.x,g=f.attribute.x;v>g&&(v=f.attribute.x,g=p.attribute.x);var y=v===g?h:l>=v&&l<=g?g-v:Math.min(Math.abs(v-l),Math.abs(g-l));e.AABBBounds.width()>y&&WF(e,y,i)}else e.AABBBounds.width()>h&&WF(e,h,i)}else l>o.x&&c.x2>r.x2?(WF(e,r.x2-l,i),a&&GF(t,n,r)):l<o.x&&c.x1<r.x1&&(WF(e,l-r.x1,i),a&&GF(t,n,r))}))}(t,{inside:o,autoWrap:_,bounds:d,ellipsis:v,center:l}),g&&eL(t,{orient:h,method:y,separation:m}))}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){}},{key:"getTextBaseline",value:function(t){return Math.abs(t[1]/t[0])<.3?"middle":t[1]<0?"bottom":t[1]>0?"top":"middle"}},{key:"getLabelAlign",value:function(t,e,i){return ie(t[0],0)?{textAlign:"center",textBaseline:t[1]>0?"top":"bottom"}:t[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(t)}:t[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(t)}:{textAlign:"center",textBaseline:"middle"}}},{key:"getLabelPosition",value:function(t,e,i,n){return t}}])}(JR);XF.defaultAttributes=RR,Tt(XF,jF);var KF,qF=function(t){return t.map((function(t,e){return{index:e,value:t}}))},ZF=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new On(t).expand(i/2),r=new On(e).expand(i/2);return n.intersects(r)},JF=function(t,e,i,n){return i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<n?i:i-e},QF=function(t,e,i){var n,r,a,o=i.labelStyle,s=i.axisOrientType,l=i.labelFlush,u=i.labelFormatter,c=i.startAngle,h=void 0===c?0:c,d=null!==(n=o.angle)&&void 0!==n?n:0;"vertical"===o.direction&&(d+=Ci(90));var p=["bottom","top"].includes(s),f=["left","right"].includes(s),v=1,g=0;p||(f?(v=0,g=1):h&&(v=Math.cos(h),g=-Math.sin(h)));for(var y=GP(o),m=t.range(),_=[],b=0;b<e.length;b++){var x=e[b],k=u?u(x):"".concat(x);if(X(k)){_=void 0;break}var S=y.quickMeasure(k),A=S.width,C=S.height,M=Math.max(A,12),w=Math.max(C,12),T=t.scale(x),D=v*T,E=g*T,B=void 0,P=void 0,R=D,L=E;l&&p&&0===b?R=JF(D,M,m[0],m[m.length-1]):l&&p&&b===e.length-1?R=JF(D,M,m[m.length-1],m[0]):B=null!==(r=o.textAlign)&&void 0!==r?r:"center","right"===B?R-=M:"center"===B&&(R-=M/2),l&&f&&0===b?L=JF(E,w,m[0],m[m.length-1]):l&&f&&b===e.length-1?L=JF(E,w,m[m.length-1],m[0]):P=null!==(a=o.textBaseline)&&void 0!==a?a:"middle","bottom"===P?L-=w:"middle"===P&&(L-=w/2);var I=(new On).set(R,L,R+M,L+w);d&&I.rotate(d,D,E),_.push(I)}return _};!function(t){t.Identity="identity",t.Linear="linear",t.Log="log",t.Pow="pow",t.Sqrt="sqrt",t.Symlog="symlog",t.Time="time",t.Quantile="quantile",t.Quantize="quantize",t.Threshold="threshold",t.Ordinal="ordinal",t.Point="point",t.Band="band"}(KF||(KF={}));var $F={};function tO(t){switch(t){case KF.Linear:case KF.Log:case KF.Pow:case KF.Sqrt:case KF.Symlog:case KF.Time:return!0;default:return!1}}function eO(t){return!!$F[t]}function iO(t){switch(t){case KF.Ordinal:case KF.Point:case KF.Band:return!0;default:return!1}}function nO(t){return t}Object.values(KF).forEach((function(t){$F[t]=!0}));var rO=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},aO=function(t){return t<0?-t*t:t*t},oO=function(t){return-Math.log(-t)},sO=function(t){return-Math.exp(-t)},lO=function(t){return isFinite(t)?Math.pow(10,t):t<0?0:t},uO=function(t){return 10===t?lO:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}},cO=function(t){return t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),function(e){return Math.log(e)/t})},hO=function(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}},dO=function(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}};function pO(t,e){if(t=Number(t),e=Number(e),e-=t)return function(i){return(i-t)/e};var i=Number.isNaN(e)?NaN:.5;return function(){return i}}function fO(t,e,i){var n,r,a=t[0],o=t[1],s=e[0],l=e[1];return o<a?(n=pO(o,a),r=i(l,s)):(n=pO(a,o),r=i(s,l)),function(t){return r(n(t))}}function vO(t,e,i){var n;return n=1===t?t+2*i:t-e+2*i,t?n>0?n:1:0}function gO(t,e,i,n){return 1===i&&(i=0),vO(t,i,n)*(e/(1-i))}function yO(t,e){var i=(t[1]-t[0])/(e[1]-e[0]),n=t[0]-i*e[0];return[n,i+n]}function mO(t,e,i){var n=Math.min(t.length,e.length)-1,r=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)r[o]=pO(t[o],t[o+1]),a[o]=i(e[o],e[o+1]);return function(e){var i=Gt(t,e,1,n)-1;return a[i](r[i](e))}}var _O=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Math.floor(Math.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},bO=function(){return o((function t(){r(this,t),this._rangeFactorStart=null,this._rangeFactorEnd=null}),[{key:"_calculateWholeRange",value:function(t){return this._wholeRange?this._wholeRange:W(this._rangeFactorStart)&&W(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=yO(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}},{key:"rangeFactor",value:function(t,e,i){return t?(2===t.length&&t.every((function(t){return t>=0&&t<=1}))&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):W(this._rangeFactorStart)&&W(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}},{key:"rangeFactorStart",value:function(t,e){var i;return j(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!j(this._rangeFactorEnd)&&1!==this._rangeFactorEnd?(this._rangeFactorStart=t,this._rangeFactorEnd=null!==(i=this._rangeFactorEnd)&&void 0!==i?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"rangeFactorEnd",value:function(t,e){var i;return j(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!j(this._rangeFactorStart)&&0!==this._rangeFactorStart?(this._rangeFactorEnd=t,this._rangeFactorStart=null!==(i=this._rangeFactorStart)&&void 0!==i?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"generateFishEyeTransform",value:function(){var t;if(this._fishEyeOptions){var e=this._fishEyeOptions,i=e.distortion,n=void 0===i?2:i,r=e.radiusRatio,a=void 0===r?.1:r,o=e.radius,s=this.range(),l=s[0],u=s[s.length-1],c=Math.min(l,u),h=Math.max(l,u),d=he(null!==(t=this._fishEyeOptions.focus)&&void 0!==t?t:0,c,h),p=j(o)?(h-c)*a:o,f=Math.exp(n);f=f/(f-1)*p;var v=n/p;this._fishEyeTransform=function(t){var e=Math.abs(t-d);if(e>=p)return t;if(e<=1e-6)return d;var i=f*(1-Math.exp(-e*v))/e*.75+.25;return d+(t-d)*i}}else this._fishEyeTransform=null}},{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"get",value:function(t,e){var i;return null!==(i=null==this?void 0:this[t])&&void 0!==i?i:e}}])}(),xO=Symbol("implicit"),kO=function(t){function e(){var t;return r(this,e),(t=n(this,e)).type=KF.Ordinal,t._index=new Map,t._domain=[],t._ordinalRange=[],t._unknown=xO,t}return h(e,t),o(e,[{key:"specified",value:function(t){var e;return t?(this._specified=Object.assign(null!==(e=this._specified)&&void 0!==e?e:{},t),this):Object.assign({},this._specified)}},{key:"_getSpecifiedValue",value:function(t){if(this._specified)return this._specified[t]}},{key:"clone",value:function(){var t=(new e).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}},{key:"calculateVisibleDomain",value:function(t){return W(this._rangeFactorStart)&&W(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}},{key:"scale",value:function(t){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==xO)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._ordinalRange[(n-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(r):r}},{key:"invert",value:function(t){for(var e=0;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}},{key:"domain",value:function(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r="".concat(n);this._index.has(r)||this._index.set(r,this._domain.push(n))}}catch(t){i.e(t)}finally{i.f()}return this}},{key:"range",value:function(t){if(!t)return this._ordinalRange.slice();var e=Array.from(t);return this._ordinalRange=e,this}},{key:"index",value:function(t){var e;return this._index&&null!==(e=this._index.get("".concat(t)))&&void 0!==e?e:-1}}])}(bO);function SO(t,e,i,n){for(var r=[],a=t;a<=e;)r.push(a),a+=i;return n&&r.reverse(),r}function AO(t,e,i,n){var r,a;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(r=e<t){var o=t;t=e,e=o}var s=pe(1,e-t+1)(i);if(a=Math.floor((e-t+1)/s),!n)for(;Math.ceil((e-t+1)/a)>i&&s>1;)s-=1,a=Math.floor((e-t)/s);return SO(t,e,a,r)}var CO=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).type=KF.Band,i._range=[0,1],i._step=void 0,i._bandwidth=void 0,i._isFixed=!1,i._round=!1,i._paddingInner=0,i._paddingOuter=0,i._align=.5,i._unknown=void 0,delete i.unknown,i.rescale(t),i}return h(e,t),o(e,[{key:"rescale",value:function(t,i){if(t)return this;this._wholeRange=null;var n=this._calculateWholeRange(this._range,i),r=_(e,"domain",this,3)([]).length,a=n[1]<n[0],o=n[Number(a)-0],s=n[1-Number(a)],l=vO(r,this._paddingInner,this._paddingOuter);return this._step=(s-o)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),o+=(s-o-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(o=Math.round(o),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:a,start:a?he(o+this._step*(r-1),n[1],n[0]):he(o,n[0],n[1]),min:a?n[1]:n[0],max:s,count:r},this.generateFishEyeTransform(),this}},{key:"scale",value:function(t){if(this._bandRangeState){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==xO)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._bandRangeState,a=r.count,o=r.start,s=r.reverse,l=r.min,u=r.max,c=o+(n-1)%a*(s?-1:1)*this._step;return he(this._fishEyeTransform?this._fishEyeTransform(c):c,l,u)}}},{key:"_calculateWholeRange",value:function(t,i){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var n;if(W(this._rangeFactorStart)&&W(this._rangeFactorEnd)&&2===t.length){var r=yO(t,[this._rangeFactorStart,this._rangeFactorEnd]);n=Math.abs(r[1]-r[0])}else n=Math.abs(t[1]-t[0]);var a=function(t,e,i,n,r){var a=vO(t,i,n),o=e/Math.max(1,a||1);r&&(o=Math.floor(o));var s=o*(1-i);return r&&(s=Math.round(s)),s}(_(e,"domain",this,3)([]).length,n,this._paddingInner,this._paddingOuter,this._round);a<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):a>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=a,this._isFixed=!1)}if(this.isBandwidthFixed()){var o=gO(_(e,"domain",this,3)([]).length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),s=Math.min((t[1]-t[0])/o,1);if(W(this._rangeFactorStart)&&W(this._rangeFactorEnd)){var l=this._rangeFactorStart+s<=1,u=this._rangeFactorEnd-s>=0;if("rangeFactorStart"===i&&l?this._rangeFactorEnd=this._rangeFactorStart+s:"rangeFactorEnd"===i&&u?this._rangeFactorStart=this._rangeFactorEnd-s:t[0]<=t[1]?l?this._rangeFactorEnd=this._rangeFactorStart+s:u?this._rangeFactorStart=this._rangeFactorEnd-s:(this._rangeFactorStart=0,this._rangeFactorEnd=s):u?this._rangeFactorStart=this._rangeFactorEnd-s:l?this._rangeFactorEnd=this._rangeFactorStart+s:(this._rangeFactorStart=1-s,this._rangeFactorEnd=1),o>0){var c=t[0]-o*this._rangeFactorStart,h=c+o;this._wholeRange=[c,h]}else{var d=t[1]+o*(1-this._rangeFactorEnd),p=d-o;this._wholeRange=[p,d]}}else this._rangeFactorStart=0,this._rangeFactorEnd=s,this._wholeRange=[t[0],t[0]+o];return this._wholeRange}return _(e,"_calculateWholeRange",this,3)([t])}},{key:"calculateWholeRangeSize",value:function(){var t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}},{key:"calculateVisibleDomain",value:function(t){var e=this._domain;if(W(this._rangeFactorStart)&&W(this._rangeFactorEnd)&&e.length){var i=this._getInvertIndex(t[0]),n=this._getInvertIndex(t[1]);return e.slice(Math.min(i,n),Math.max(i,n)+1)}return e}},{key:"domain",value:function(t,i){return t?(_(e,"domain",this,3)([t]),this.rescale(i)):_(e,"domain",this,3)([])}},{key:"range",value:function(t,e){return t?(this._range=[Ht(t[0]),Ht(t[1])],this.rescale(e)):this._range}},{key:"rangeRound",value:function(t,e){return this._range=[Ht(t[0]),Ht(t[1])],this._round=!0,this.rescale(e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return-1===t?e:AO(0,e.length-1,t,!1).map((function(t){return e[t]}))}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.ticks(e).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0]+t._bandwidth/2)/(t._range[1]-t._range[0])}}))}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return AO(0,e.length-1,t,!0).filter((function(t){return t<e.length})).map((function(t){return e[t]}))}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n;if(i=pe(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),n=e<t){var r=t;t=e,e=r}return SO(t,e,i,n)}(0,e.length-1,t).map((function(t){return e[t]}))}},{key:"_getInvertIndex",value:function(t){var e=0,i=this.step()/2,n=this.bandwidth()/2,r=this._domain.length,a=this.range(),o=a[0]>a[a.length-1];for(e=0;e<r;e++){var s=this.scale(this._domain[e])+n;if(0===e&&(!o&&!ne(t,s+i)||o&&!re(t,s-i)))break;if(e===r-1)break;if(!re(t,s-i)&&!ne(t,s+i))break}return e>=0&&e<=r-1?e:r-1}},{key:"invert",value:function(t){return this._domain[this._getInvertIndex(t)]}},{key:"padding",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}},{key:"paddingInner",value:function(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}},{key:"paddingOuter",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}},{key:"step",value:function(){return this._step}},{key:"round",value:function(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}},{key:"align",value:function(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}},{key:"rangeFactor",value:function(t,i){return t?(_(e,"rangeFactor",this,3)([t]),this.rescale(i)):_(e,"rangeFactor",this,3)([])}},{key:"rangeFactorStart",value:function(t,i){return j(t)?_(e,"rangeFactorStart",this,3)([]):(_(e,"rangeFactorStart",this,3)([t]),this.rescale(i,"rangeFactorStart"))}},{key:"rangeFactorEnd",value:function(t,i){return j(t)?_(e,"rangeFactorEnd",this,3)([]):(_(e,"rangeFactorEnd",this,3)([t]),this.rescale(i,"rangeFactorEnd"))}},{key:"bandwidth",value:function(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}},{key:"maxBandwidth",value:function(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}},{key:"minBandwidth",value:function(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"isBandwidthFixed",value:function(){return this._isFixed&&!!this._bandwidth}},{key:"_isBandwidthFixedByUser",value:function(){return this._isFixed&&this._userBandwidth&&$(this._userBandwidth)}},{key:"clone",value:function(){var t,i,n;return new e(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!==(t=this._userBandwidth)&&void 0!==t?t:"auto",!0).maxBandwidth(null!==(i=this._maxBandwidth)&&void 0!==i?i:"auto",!0).minBandwidth(null!==(n=this._maxBandwidth)&&void 0!==n?n:"auto")}}])}(kO),MO=ir;function wO(t,e){var i,n=k(e);if(j(e)||"boolean"===n)return function(){return e};if("number"===n)return ye(t,e);if("string"===n){if(i=Qn.parseColorString(e)){var r=MO(Qn.parseColorString(t),i);return function(t){return r(t).formatRgb()}}return ye(Number(t),Number(e))}return e instanceof $n?MO(t,e):e instanceof Qn?MO(t.color,e.color):e instanceof Date?_e(t,e):ye(Number(t),Number(e))}var TO=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nO,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nO;return r(this,e),(t=n(this,e))._unknown=void 0,t.transformer=i,t.untransformer=a,t._forceAlign=!0,t._domain=[0,1],t._range=[0,1],t._clamp=nO,t._piecewise=fO,t._interpolate=wO,t}return h(e,t),o(e,[{key:"calculateVisibleDomain",value:function(t){var e;return W(this._rangeFactorStart)&&W(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!==(e=this._niceDomain)&&void 0!==e?e:this._domain}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"invert",value:function(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),ye)),this._clamp(this.untransformer(this._input(t)))}},{key:"domain",value:function(t,e){var i;if(!t)return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;var n=Array.from(t,Ht);return this._domain=n,this.rescale(e)}},{key:"range",value:function(t,e){if(!t)return this._range.slice();var i=Array.from(t);return this._range=i,this.rescale(e)}},{key:"rangeRound",value:function(t,e){var i=Array.from(t);return this._range=i,this._interpolate=me,this.rescale(e)}},{key:"rescale",value:function(t){var e;if(t)return this;var i=null!==(e=this._niceDomain)&&void 0!==e?e:this._domain,n=i.length,r=this._range.length,a=Math.min(n,r);if(n&&n<r&&this._forceAlign){for(var o=r-n+1,s=i[n-1],l=n>=2?(s-i[n-2])/o:0,u=1;u<=o;u++)i[n-2+u]=s-l*(o-u);a=r}return this._autoClamp&&(this._clamp=pe(i[0],i[a-1])),this._piecewise=a>2?mO:fO,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}},{key:"clamp",value:function(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:nO),this.rescale(i)):this._clamp!==nO}},{key:"interpolate",value:function(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}},{key:"ticks",value:function(){return[]}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=this.ticks(e);return(null!=i?i:[]).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0])/(t._range[1]-t._range[0])}}))}},{key:"rangeFactor",value:function(t,i){return t?(_(e,"rangeFactor",this,3)([t]),this._output=this._input=null,this):_(e,"rangeFactor",this,3)([])}},{key:"rangeFactorStart",value:function(t,i){return j(t)?_(e,"rangeFactorStart",this,3)([]):(_(e,"rangeFactorStart",this,3)([t]),this._output=this._input=null,this)}},{key:"rangeFactorEnd",value:function(t,i){return j(t)?_(e,"rangeFactorEnd",this,3)([]):(_(e,"rangeFactorEnd",this,3)([t]),this._output=this._input=null,this)}},{key:"forceAlignDomainRange",value:function(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}])}(bO),DO=Math.sqrt(50),EO=Math.sqrt(10),BO=Math.sqrt(2),PO=[1,2,5,10],RO=function(t,e,i){var n=1,r=t,a=Math.floor((e-1)/2),o=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?r=0:t<0&&t>=-Number.MIN_VALUE?r=-(e-1):!i&&o<1?n=OO(o).step:(i||o>1)&&(r=Math.floor(t)-a*n),n>0?(t>0?r=Math.max(r,0):t<0&&(r=Math.min(r,-(e-1)*n)),Ot(0,e).map((function(t){return r+t*n}))):t>0?IO(0,-(e-1)/n,n):IO((e-1)/n,0,n)},LO=oe((function(t,e,i,n){var r,a,o,s,l=-1;if(i=+i,(t=+t)==(e=+e))return[t];if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((r=e<t)&&(a=t,t=e,e=a),s=zO(t,e,i).step,!isFinite(s))return[];if(s>0){var u=Math.round(t/s),c=Math.round(e/s);for(u*s<t&&++u,c*s>e&&--c,o=new Array(a=c-u+1);++l<a;)o[l]=(u+l)*s}else if(s<0&&(null==n?void 0:n.noDecimals)){s=1;var h=Math.ceil(t),d=Math.floor(e);if(!(h<=d))return[];for(o=new Array(a=d-h+1);++l<a;)o[l]=h+l}else{s=-s;var p=Math.round(t*s),f=Math.round(e*s);for(p/s<t&&++p,f/s>e&&--f,o=new Array(a=f-p+1);++l<a;)o[l]=(p+l)/s}return r&&o.reverse(),o})),IO=function(t,e,i){var n,r,a=-1;if(i>0){var o=Math.floor(t/i),s=Math.ceil(e/i);for((o+1)*i<t&&++o,(s-1)*i>e&&--s,r=new Array(n=s-o+1);++a<n;)r[a]=(o+a)*i}else{i=-i;var l=Math.floor(t*i),u=Math.ceil(e*i);for((l+1)/i<t&&++l,(u-1)/i>e&&--u,r=new Array(n=u-l+1);++a<n;)r[a]=(l+a)/i}return r},FO=oe((function(t,e,i,n){var r,a,o;if(i=+i,(t=+t)==(e=+e))return RO(t,i,null==n?void 0:n.noDecimals);if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return RO(t,i,null==n?void 0:n.noDecimals);(r=e<t)&&(o=t,t=e,e=o);var s=zO(t,e,i),l=s.step;if(!isFinite(l))return[];if(l>0){for(var u=1,c=s.power,h=10===s.gap?2*Math.pow(10,c):1*Math.pow(10,c);u<=5&&(a=IO(t,e,l)).length>i+1&&i>2;)l+=h,u+=1;i>2&&a.length<i-1&&(a=function(t,e,i){var n,r=t[0],a=t[t.length-1],o=e-t.length;if(a<=0){var s=[];for(n=o;n>=1;n--)s.push(r-n*i);return s.concat(t)}if(r>=0){for(n=1;n<=o;n++)t.push(a+n*i);return t}var l=[],u=[];for(n=1;n<=o;n++)n%2==0?l=[r-Math.floor(n/2)*i].concat(l):u.push(a+Math.ceil(n/2)*i);return l.concat(t).concat(u)}(a,i,l))}else(null==n?void 0:n.noDecimals)&&l<0&&(l=1),a=IO(t,e,l);return r&&a.reverse(),a})),OO=function(t){var e=Math.floor(Math.log(t)/Math.LN10),i=t/Math.pow(10,e),n=PO[0];return i>=DO?n=PO[3]:i>=EO?n=PO[2]:i>=BO&&(n=PO[1]),e>=0?{step:n*Math.pow(10,e),gap:n,power:e}:{step:-Math.pow(10,-e)/n,gap:n,power:e}};function zO(t,e,i){var n=(e-t)/Math.max(0,i);return OO(n)}function HO(t,e,i){var n;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if(i<=0||0===(n=function(t,e,i){return(e-t)/Math.max(1,i-1)}(t,e,i))||!isFinite(n))return[];for(var r=new Array(i),a=0;a<i;a++)r[a]=t+a*n;return r}function NO(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=0,a=t.length-1,o=t[r],s=t[a],l=10;for(s<o&&(i=o,o=s,s=i,i=r,r=a,a=i);l-- >0;){if((i=zO(o,s,n).step)===e)return t[r]=o,t[a]=s,t;if(i>0)o=Math.floor(o/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;o=Math.ceil(o*i)/i,s=Math.floor(s*i)/i}e=i}}function UO(t,e){var i=$(e.forceMin),n=$(e.forceMax),r=null,a=[],o=null,s=i&&n?function(t){return t>=e.forceMin&&t<=e.forceMax}:i?function(t){return t>=e.forceMin}:n?function(t){return t<=e.forceMax}:null;return i?a[0]=e.forceMin:$(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(a[0]=e.min),n?a[1]=e.forceMax:$(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(a[1]=e.max),$(a[0])&&$(a[1])?((o=t.slice())[0]=a[0],o[o.length-1]=a[1]):r=$(a[0])||$(a[1])?$(a[0])?"max":"min":"all",{niceType:r,niceDomain:o,niceMinMax:a,domainValidator:s}}var jO=function(t,e,i){return Math.abs(e-t)<1?+i.toFixed(1):Math.round(+i)},VO=oe((function(t,e,i,n,r,a,o){var s,l=t,u=e,c=u<l;c&&(l=(s=[u,l])[0],u=s[1]);var h,d,p=r(l),f=r(u),v=[];if(!(n%1)&&f-p<i){if(p=Math.floor(p),f=Math.ceil(f),l>0){for(;p<=f;++p)for(h=1;h<n;++h)if(!((d=p<0?h/a(-p):h*a(p))<l)){if(d>u)break;v.push(d)}}else for(;p<=f;++p)for(h=n-1;h>=1;--h)if(!((d=p>0?h/a(-p):h*a(p))<l)){if(d>u)break;v.push(d)}2*v.length<i&&(v=FO(l,u,i))}else v=FO(p,f,Math.min(f-p,i)).map(a);return v=v.filter((function(t){return 0!==t})),(null==o?void 0:o.noDecimals)&&(v=Array.from(new Set(v.map((function(t){return Math.floor(t)}))))),c?v.reverse():v})),WO=oe((function(t,e,i,n,r,a){var o=[],s={},l=r(t),u=r(e),c=[];if(Number.isInteger(n))c=FO(l,u,i);else for(var h=(u-l)/(i-1),d=0;d<i;d++)c.push(l+d*h);return c.forEach((function(i){var r=a(i),l=Number.isInteger(n)?jO(t,e,r):jO(t,e,_O(r)),u=jO(t,e,function(t,e){var i,n;return e[0]<e[1]?(i=e[0],n=e[1]):(i=e[1],n=e[0]),Math.min(Math.max(t,i),n)}(l,[t,e]));!s[u]&&!isNaN(u)&&c.length>1&&(s[u]=1,o.push(u))})),o})),GO=oe((function(t,e,i,n,r){return HO(n(t),n(e),i).map((function(t){return _O(r(t))}))})),YO=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type=KF.Linear,t}return h(e,t),o(e,[{key:"clone",value:function(){var t,i=new e;return i.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(i._niceType=this._niceType,i._domainValidator=this._domainValidator,i._niceDomain=null===(t=this._niceDomain)||void 0===t?void 0:t.slice()),i}},{key:"tickFormat",value:function(){return function(){}}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.calculateVisibleDomain(this._range);return LO(i[0],i[i.length-1],t,e)}},{key:"ticks",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0;if(U(null==i?void 0:i.customTicks))return i.customTicks(this,e);if(W(this._rangeFactorStart)&&W(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(e,i);var n=null!==(t=this._niceDomain)&&void 0!==t?t:this._domain,r=this._domain,a=n[0],o=n[n.length-1],s=FO(r[0],r[r.length-1],e,i);if(!s.length)return s;if(this._domainValidator)s=s.filter(this._domainValidator);else if((s[0]!==a||s[s.length-1]!==o)&&this._niceType){var l=n.slice();if("all"===this._niceType?(l[0]=s[0],l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()):"min"===this._niceType&&s[0]!==a?(l[0]=s[0],this._niceDomain=l,this.rescale()):"max"===this._niceType&&s[s.length-1]!==o&&(l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()),"all"!==this._niceType){var u=Math.min(l[0],l[l.length-1]),c=Math.max(l[0],l[l.length-1]);s=s.filter((function(t){return t>=u&&t<=c}))}}return s}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return HO(e[0],e[e.length-1],t)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n,r,a=-1;if(i=+i,(r=(e=+e)<(t=+t))&&(n=t,t=e,e=n),!isFinite(i)||e-t<=i)return[t];for(var o=Math.floor((e-t)/i+1),s=new Array(o);++a<o;)s[a]=t+a*i;return r&&s.reverse(),s}(e[0],e[e.length-1],t)}},{key:"nice",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1?arguments[1]:void 0,r=this._domain,a=[];if(n){var o=UO(r,n);if(a=o.niceMinMax,this._domainValidator=o.domainValidator,this._niceType=o.niceType,o.niceDomain)return this._niceDomain=o.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){var s=NO(r.slice(),i);"min"===this._niceType?s[s.length-1]=null!==(t=a[1])&&void 0!==t?t:s[s.length-1]:"max"===this._niceType&&(s[0]=null!==(e=a[0])&&void 0!==e?e:s[0]),this._niceDomain=s,this.rescale()}return this}},{key:"niceMin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="min";var e=this._domain[this._domain.length-1],i=NO(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}},{key:"niceMax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="max";var e=this._domain[0],i=NO(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}])}(TO),XO=function(){return o((function t(){r(this,t)}),[{key:"nice",value:function(){var t,e,i,n,r=arguments.length>1?arguments[1]:void 0,a=this._domain,o=[],s=null;if(r){var l=UO(a,r);if(o=l.niceMinMax,this._domainValidator=l.domainValidator,s=l.niceType,l.niceDomain)return this._niceDomain=l.niceDomain,this.rescale(),this}else s="all";if(s){var u=function(t,e){var i,n,r=t.slice(),a=0,o=r.length-1,s=r[a],l=r[o];return l<s&&(a=(i=[o,a])[0],o=i[1],s=(n=[l,s])[0],l=n[1]),r[a]=e.floor(s),r[o]=e.ceil(l),r}(a.slice(),null!==(e=null===(t=this.getNiceConfig)||void 0===t?void 0:t.call(this))&&void 0!==e?e:{floor:function(t){return Math.floor(t)},ceil:function(t){return Math.ceil(t)}});return"min"===s?u[u.length-1]=null!==(i=o[1])&&void 0!==i?i:u[u.length-1]:"max"===s&&(u[0]=null!==(n=o[0])&&void 0!==n?n:u[0]),this._niceDomain=u,this.rescale(),this}return this}},{key:"niceMin",value:function(){var t=this._domain[this._domain.length-1];this.nice();var e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}},{key:"niceMax",value:function(){var t=this._domain[0];this.nice();var e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}])}();function KO(t){return function(e){return-t(-e)}}function qO(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.max(e,t)}}var ZO=function(t){function e(){var t;return r(this,e),(t=n(this,e,[cO(10),uO(10)])).type=KF.Log,t._limit=qO(),t._logs=t.transformer,t._pows=t.untransformer,t._domain=[1,10],t._base=10,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}},{key:"rescale",value:function(t){var i;if(t)return this;_(e,"rescale",this,3)([]);var n=cO(this._base),r=uO(this._base);return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain)[0]<0?(this._logs=KO(n),this._pows=KO(r),this._limit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.min(e,-t)}}(),this.transformer=oO,this.untransformer=sO):(this._logs=n,this._pows=r,this._limit=qO(),this.transformer=this._logs,this.untransformer=r),this}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"base",value:function(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}},{key:"tickFormat",value:function(){return nO}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.domain(),n=this._limit(i[0]),r=this._limit(i[i.length-1]);return VO(n,r,t,this._base,this.transformer,this.untransformer,e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return WO(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return GO(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return GO(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}},{key:"getNiceConfig",value:function(){var t=this;return{floor:function(e){return t._pows(Math.floor(t._logs(t._limit(e))))},ceil:function(e){return Math.abs(e)>=1?Math.ceil(e):t._pows(Math.ceil(t._logs(t._limit(e))))}}}}])}(TO);Tt(ZO,XO);var JO=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[!1])).type=KF.Point,i._padding=0,i.paddingInner(1,t),i.padding=i.paddingOuter,i.paddingInner=void 0,i.paddingOuter=void 0,i}return h(e,t),o(e)}(CO),QO=function(t){function e(){var t;return r(this,e),(t=n(this,e,[rO,aO])).type=KF.Sqrt,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}])}(YO),$O=function(t){function e(){var t;return r(this,e),(t=n(this,e,[hO(1),dO(1)])).type=KF.Symlog,t._const=1,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}},{key:"constant",value:function(t,e){return arguments.length?(this._const=t,this.transformer=hO(t),this.untransformer=dO(t),this.rescale(e)):this._const}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.domain(),n=i[0],r=i[i.length-1];return VO(n,r,t,this._const,this.transformer,this.untransformer,e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return WO(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return GO(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return GO(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}])}(YO);Tt($O,XO);var tz=function(){function t(){r(this,t),this.type=KF.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}return o(t,[{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"scale",value:function(t){return!j(t)&&it(+t)?this._range[Gt(this._domain,t,0,this.n)]:this._unknown}},{key:"invertExtent",value:function(t){var e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}},{key:"domain",value:function(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}},{key:"range",value:function(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}},{key:"clone",value:function(){return(new t).domain(this._domain).range(this._range).unknown(this._unknown)}}])}();function ez(t,e,i,n){var r,a=t.breakData;if(a&&a()){var o=a().breakDomains,s=e.domain();r=[];for(var l=0;l<s.length-1;l++)n(i,[s[l],s[l+1]]).forEach((function(t){o.some((function(e){return t>=e[0]&&t<=e[1]}))||r.push(t)}));e.domain(s)}else r=n(i);return r}function iz(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i&&!e.includes(t)){var a=e.length;if(a>1){r?e.push(t):e.unshift(t);for(var o=0;o<a;o++){var s=r?a-1-o:o;if(!n(e[s]))break;e.splice(s,1),o--,a--}}}}var nz=function(t,e){var i,n,r,a;if(!tO(t.type))return qF(t.domain());var o=t.range(),s=Math.abs(o[o.length-1]-o[0]);if(s<2)return qF([t.domain()[0]]);var l,u,c,h=e.tickCount,d=e.forceTickCount,p=e.tickStep,f=e.noDecimals,v=void 0!==f&&f,g=e.labelStyle,y=e.breakData;if(W(p))u=t.stepTicks(p),c=y&&y()?y().breakDomains:null,l=c&&c.length?u.filter((function(t){return c.every((function(e){return t<e[0]||t>e[1]}))})):u;else if(W(d))l=ez(e,t,d,(function(e,i){return i&&i.length?t.domain(i,!0).forceTicks(e):t.forceTicks(e)}));else if("d3"===e.tickMode){var m=null!==(i=U(h)?h({axisLength:s,labelStyle:g}):h)&&void 0!==i?i:5;l=ez(e,t,m,(function(e,i){return i&&i.length?t.domain(i,!0).d3Ticks(e,{noDecimals:v}):t.d3Ticks(e,{noDecimals:v})}))}else{var _=null!==(n=U(h)?h({axisLength:s,labelStyle:g}):h)&&void 0!==n?n:5,b=U(e.tickMode)?e.tickMode:void 0;l=ez(e,t,_,(function(e,i){return i&&i.length?t.domain(i,!0).ticks(e,{noDecimals:v,customTicks:b}):t.ticks(e,{noDecimals:v,customTicks:b})}))}var x=t.domain();if(e.labelFirstVisible&&x[0]!==l[0]&&!l.includes(x[0])&&l.unshift(x[0]),e.labelLastVisible&&x[x.length-1]!==l[l.length-1]&&!l.includes(x[x.length-1])&&l.push(x[x.length-1]),e.sampling&&l.length>1&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){var k,S=e.labelGap,A=void 0===S?4:S,C=e.labelFlush;if(6*l.length>s){var M=[],w=Math.floor(6*l.length/s);l.forEach((function(t,e){e%w!=0&&e!==l.length-1||M.push(t)})),k=null===(r=QF(t,M,e))||void 0===r?void 0:r.map((function(t,e){return{AABBBounds:t,value:M[e]}}))}else k=null===(a=QF(t,l,e))||void 0===a?void 0:a.map((function(t,e){return{AABBBounds:t,value:l[e]}}));if(k){for(var T=k[0],D=Et(k),E=y&&y()?rz.greedy:rz.parity;k.length>=3&&GR(k,A);)k=E(k,A);var B=e.labelFirstVisible,P=e.labelLastVisible;WR(T,D,A)&&k.includes(D)&&k.length>1&&B&&P&&(k.splice(k.indexOf(D),1),P=!1),iz(T,k,B,(function(t){return WR(t,T,A)})),iz(D,k,P,(function(t){return WR(t,D,A)||!(!B||t===T)&&WR(t,T,A)}),!0);var R=k.map((function(t){return t.value}));R.length<3&&C&&(R.length>1&&R.pop(),Et(R)!==Et(l)&&R.push(Et(l))),l=R}}return qF(l)},rz={parity:function(t){return t.filter((function(t,e){return e%2==0}))},greedy:function(t,e){var i;return t.filter((function(t,n){return!(n&&WR(i,t,e)||(i=t,0))}))}},az=function(t,e,i,n){var r=QF(t,e,i);return r&&r.map((function(t){return n?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()]}))},oz=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2},sz=function(t,e){return t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0},lz=function(t,e){var i,n=t.domain();if(!n.length)return[];var r,a=e.tickCount,o=e.forceTickCount,s=e.tickStep,l=e.labelGap,u=void 0===l?4:l,c=e.axisOrientType,h=e.labelStyle,d=function(t){return["bottom","top","z"].includes(t)}(c),p=t.range(),f=t.calculateWholeRangeSize();if(f<2)return e.labelLastVisible?qF([n[n.length-1]]):qF([n[0]]);if(W(s))r=t.stepTicks(s);else if(W(o))r=t.forceTicks(o);else if(W(a)){var v=U(a)?a({axisLength:f,labelStyle:h}):a;r=t.ticks(v)}else if(e.sampling){var g=(null!==(i=e.labelStyle.fontSize)&&void 0!==i?i:12)+2,y=Pt(p),m=Bt(p);if(n.length<=f/g){var _=az(t,n,e,d);if(_){var x=Math.min.apply(Math,b(_.map((function(t){return t[2]})))),k=(m-y)/n.length,S=uz(n,_,u,e.labelLastVisible,Math.floor(x/k),!1);r=t.stepTicks(S.step),e.labelLastVisible&&(S.delCount&&(r=r.slice(0,r.length-S.delCount)),r.push(n[n.length-1]))}}else{var A=[n[0],n[Math.floor(n.length/2)],n[n.length-1]],C=az(t,A,e,d);if(C){var M=null;C.forEach((function(t){M?M[2]<t[2]&&(M=t):M=t}));var w=m-y-u>0?Math.ceil(n.length*(u+M[2])/(m-y-u)):n.length-1;r=t.stepTicks(w),!e.labelLastVisible||r.length&&r[r.length-1]===n[n.length-1]||(r.length&&Math.abs(t.scale(r[r.length-1])-t.scale(n[n.length-1]))<M[2]&&(r=r.slice(0,-1)),r.push(n[n.length-1]))}}}return j(r)&&(r=t.domain()),qF(r)},uz=function(t,e,i,n,r,a){var o=0,s=0,l=-1,u=Number.MAX_VALUE,c=function(n){var r=!0,a=0;do{a+n<t.length&&oz(e[a],e[a+n],i)&&(r=!1),a+=n}while(r&&a<t.length);return r},h=Kt(r,t.length,(function(t){return c(t)?1:-1})),d=h;do{if(d>h&&!a&&!c(d))d++;else{if(!n){s=d;break}var p=t.length-1,f=void 0,v=0;f=t.length%d>0?t.length-t.length%d+d:t.length;do{if((f-=d)!==p&&!oz(e[f],e[p],i))break;v++}while(f>0);if(f===p){s=d,o=v;break}var g=Math.floor(t.length/d)-v+1;if(g<l)break;l=g;var y=sz(e[f],e[p]),m=f-d>=0?sz(e[f-d],e[f]):y,_=Math.abs(y-m);if(_<u&&(u=_,s=d,o=v),y<=m)break;d++}}while(d<=t.length);return{step:s,delCount:o}},cz=function(t,e,i){var n,r=i.labelStyle,a=i.getRadius,o=i.labelOffset,s=i.labelFormatter,l=i.inside,u=null==a?void 0:a(),c=null!==(n=r.angle)&&void 0!==n?n:0,h=GP(r);return e.map((function(e){var i,n,a=s?s(e):"".concat(e),d=h.quickMeasure(a),p=d.width,f=d.height,v=Math.max(p,12),g=Math.max(f,12),y=t.scale(e),m={x:0,y:0},_={align:r.textAlign,baseline:r.textBaseline},b=function(t,e,i,n,r){var a,o,s=Pi({x:0,y:0},i,t),l=NR(s,UR(n,s,e,r));return a=l,o=UR(n||1,l,e,r),{x:a.x+o[0],y:a.y+o[1]}}(y,m,u,o,l),x=b.x,k=b.y;return _.align||(ie(x,m.x)?_.baseline||(_.baseline=k>m.y?"top":"bottom"):x>m.x?_.align="left":x<m.x&&(_.align="right")),i=x+("right"===_.align?-v:"left"===_.align?0:-v/2),n=k+("bottom"===_.baseline?-g:"top"===_.baseline?0:-g/2),(new On).set(i,n,i+v,n+g).rotate(c,i+v/2,n+g/2)}))},hz=function(t,e){var i,n=e.tickCount,r=e.forceTickCount,a=e.tickStep,o=e.getRadius,s=e.labelOffset,l=e.labelGap,u=void 0===l?0:l,c=e.labelStyle,h=null==o?void 0:o();if(!h||h<=0)return qF(t.domain());if(W(a))i=t.stepTicks(a);else if(W(r))i=t.forceTicks(r);else if(W(n)){var d=t.range(),p=Math.abs(d[d.length-1]-d[0]),f=U(n)?n({axisLength:p,labelStyle:c}):n;i=t.ticks(f)}else if(e.sampling){var v=t.domain(),g=t.range(),y=cz(t,v,e),m=Pt(g),_=Bt(g),b=Math.abs(_-m)*(h+s)/v.length,x=dz(v,y,u,Math.floor(y.reduce((function(t,e){return Math.min(t,e.width(),e.height())}),Number.MAX_VALUE)/b)),k=x.step,S=x.delCount;i=(i=t.stepTicks(k)).slice(0,i.length-S)}else i=t.domain();return qF(i)},dz=function(t,e,i,n){var r=n;do{var a=!0;r++;var o=0;do{o+r<t.length&&ZF(e[o],e[o+r],i)&&(a=!1),o+=r}while(a&&o<t.length);if(a)break}while(r<=t.length);var s=0;if(t.length>2){var l=t.length-t.length%r;for(l>=t.length&&(l-=r);l>0&&ZF(e[0],e[l]);)s++,l-=r}return{step:r,delCount:s}},pz=new Uint32Array(33),fz=new Uint32Array(33);fz[0]=0,pz[0]=~fz[0];for(var vz=1;vz<=32;++vz)fz[vz]=fz[vz-1]<<1|1,pz[vz]=~fz[vz];function gz(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,left:0,right:0,bottom:0},n=i.top,r=void 0===n?0:n,a=i.left,o=void 0===a?0:a,s=i.right,l=void 0===s?0:s,u=i.bottom,c=void 0===u?0:u,h=Math.max(1,Math.sqrt(t*e/1e6)),d=~~((t+o+l+h)/h),p=~~((e+r+c+h)/h),f=function(t){return~~(t/h)};return f.bitmap=function(){return function(t,e){var i=new Uint32Array(~~((t*e+32)/32));function n(t,e){i[t]|=e}function r(t,e){i[t]&=e}return{array:i,get:function(e,n){var r=n*t+e;return i[r>>>5]&1<<(31&r)},set:function(e,i){var r=i*t+e;n(r>>>5,1<<(31&r))},clear:function(e,i){var n=i*t+e;r(n>>>5,~(1<<(31&n)))},getRange:function(n){var r=n.x1,a=n.y1,o=n.x2,s=n.y2;if(o<0||s<0||r>t||a>e)return!0;for(var l,u,c,h,d=s;d>=a;--d)if((c=(l=d*t+r)>>>5)==(h=(u=d*t+o)>>>5)){if(i[c]&pz[31&l]&fz[1+(31&u)])return!0}else{if(i[c]&pz[31&l])return!0;if(i[h]&fz[1+(31&u)])return!0;for(var p=c+1;p<h;++p)if(i[p])return!0}return!1},setRange:function(i){var r=i.x1,a=i.y1,o=i.x2,s=i.y2;if(!(o<0||s<0||r>t||a>e))for(var l,u,c,h,d;a<=s;++a)if((c=(l=a*t+r)>>>5)==(h=(u=a*t+o)>>>5))n(c,pz[31&l]&fz[1+(31&u)]);else for(n(c,pz[31&l]),n(h,fz[1+(31&u)]),d=c+1;d<h;++d)n(d,4294967295)},clearRange:function(e){for(var i,n,a,o,s,l=e.x1,u=e.y1,c=e.x2,h=e.y2;u<=h;++u)if((a=(i=u*t+l)>>>5)==(o=(n=u*t+c)>>>5))r(a,fz[31&i]|pz[1+(31&n)]);else for(r(a,fz[31&i]),r(o,pz[1+(31&n)]),s=a+1;s<o;++s)r(s,0)},outOfBounds:function(i){var n=i.x1,r=i.y1,a=i.x2,o=i.y2;return n<0||r<0||o>=e||a>=t},toImageData:function(n){for(var r=n.createImageData(t,e),a=r.data,o=0;o<e;++o)for(var s=0;s<t;++s){var l=o*t+s,u=4*l,c=i[l>>>5]&1<<(31&l);a[u+0]=255*c,a[u+1]=255*c,a[u+2]=255*c,a[u+3]=31}return r}}}(d,p)},f.x=function(t){return~~((t+o)/h)},f.y=function(t){return~~((t+r)/h)},f.ratio=h,f.padding=i,f.width=t,f.height=e,f}function yz(t,e){var i=e.x1,n=e.x2,r=e.y1,a=e.y2,o=t.padding,s=o.top,l=void 0===s?0:s,u=o.left,c=void 0===u?0:u,h=o.right,d=void 0===h?0:h,p=o.bottom,f=void 0===p?0:p,v=he(i,-c,t.width+d),g=he(n,-c,t.width+d),y=he(r,-l,t.height+f),m=he(a,-l,t.height+f);return{x1:t.x(v),x2:t.x(g),y1:t.y(y),y2:t.y(m)}}function mz(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?yz(t,e):{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}function _z(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=i;r>0&&(a={x1:i.x1-r,x2:i.x2+r,y1:i.y1-r,y2:i.y2+r}),a=mz(t,a);var o=e.outOfBounds(a);return!(n&&o||(o&&(a=yz(t,a)),e.getRange(a)))}function bz(t,e,i){for(var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).filter((function(t){return W(t)})),s=0;s<o.length;s++){var l=void 0;if((l=a?i:i.clone()).setAttributes(o[s]),_z(t,e,l.AABBBounds,n,r))return e.setRange(mz(t,l.AABBBounds,!0)),o[s]}return!1}function xz(t,e,i,n,r,a,o){var s,l,u=null===(s=n.overlap)||void 0===s?void 0:s.clampForce,c=null===(l=n.overlap)||void 0===l?void 0:l.overlapPadding;if("bound"===i.type||"position"===i.type){if(U(o)){var h=((U(i.position)?i.position(r.attribute):i.position)||function(t){return"rect"===t?Sz:kz}(n.type)).map((function(t){return o(r.AABBBounds,a,t,n.offset)})),d=!1===i.restorePosition;return bz(t,e,r,h,u,c,d)}return!1}if("moveY"===i.type){var p=(i.offset?U(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x,y:r.attribute.y+t}}));return bz(t,e,r,p,u,c)}if("moveX"===i.type){var f=(i.offset?U(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x+t,y:r.attribute.y}}));return bz(t,e,r,f,u,c)}return!1}var kz=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],Sz=["top","inside-top","inside"];function Az(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=t.AABBBounds,a=r.x1,o=r.x2,s=r.y1,l=r.y2,u=n.top,c=void 0===u?0:u,h=n.left,d=void 0===h?0:h,p=n.right,f=void 0===p?0:p,v=n.bottom,g=void 0===v?0:v,y=Math.min(a,o),m=Math.max(a,o),_=Math.min(s,l),b=Math.max(s,l),x=e+f,k=i+g,S=0,A=0;return y<0-d?S=-y:m>x&&(S=x-m),_<0-c?A=-_:b>k&&(A=k-b),{dx:S,dy:A}}var Cz={mode:"same-time",duration:300,easing:"linear"};function Mz(t){return 3===t||4===t}var wz=function(t){if(!t||!t.attribute)return[];var e=t.attribute,i=e.points,n=e.segments;if(n&&n.length){var r=[];return n.forEach((function(t){t.points.forEach((function(t){r.push(t)}))})),r}return i};function Tz(t,e,i,n,r,a){return Math.abs(e/t)<a/r?{x:i+(t>0?r:-r),y:n+e*r/Math.abs(t)}:{x:i+t*a/Math.abs(e),y:n+(e>0?a:-a)}}var Dz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},Ez=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=WL(this.target);this._animator=t;var e=this.duration,i=this.easing,n=this.params,r=n.prevText,a=n.curText,o=n.prevLabelLine,s=n.curLabelLine,l=n.increaseEffect,u=void 0===l||l,c={};for(var h in a.attribute)r.attribute[h]!==a.attribute[h]&&(c[h]=a.attribute[h]);c.text;var d=Dz(c,["text"]);t.animate(r,{type:"to",to:d,duration:e,easing:i}),!1!==u&&t.animate(r,{type:"increaseCount",to:{text:a.attribute.text},duration:e,easing:i}),o&&t.animate(o,{type:"to",to:s.attribute,duration:e,easing:i}),this.completeBind(t)}},{key:"tryPreventConflict",value:function(){}}])}(UL),Bz=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=WL(this.target);this._animator=t;var e=this.duration,i=this.easing,n=this.params,r=n.relatedGraphic,a=n.relatedGraphics,o=n.config,s=o.mode,l=o.type,u=void 0===l?"fadeIn":l,c=this.target,h=0;"after"===s?r.animates&&r.animates.forEach((function(t){h=Math.max(h,t.getStartTime()+t.getTotalDuration())})):"after-all"===s?a&&a.forEach((function(t){t.animates&&t.animates.forEach((function(t){h=Math.max(h,t.getStartTime()+t.getTotalDuration())}))})):r.animates&&r.animates.forEach((function(t){h=Math.max(h,t.getStartTime())})),t.animate(c,Object.assign(Object.assign({},o),{duration:e,easing:i,startTime:h,type:u})),this.completeBind(t)}},{key:"tryPreventConflict",value:function(){}}])}(UL);var Pz=function(t,e){return Math.ceil(t)>Math.floor(e)},Rz=function(t,e){var i=m(t,2),n=i[0],r=i[1],a=m(e,2),o=a[0];return a[1]>n&&r>o};function Lz(t,e){var i=m(t,2),n=i[0],r=i[1],a=m(e,2),o=a[0],s=a[1],l=Math.max(n,o),u=Math.min(r,s);return Math.max(0,u-l)}var Iz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};YB(),fP(),lP(),ZB(),DL.registerBuiltInAnimate("increaseCount",GL),DL.registerBuiltInAnimate("labelUpdate",Ez),DL.registerBuiltInAnimate("labelEnter",Bz);var Fz=function(t){function e(t,a){var o;r(this,e);var s=t.data,l=Iz(t,["data"]);return(o=n(this,e,[(null==a?void 0:a.skipDefault)?t:Object.assign({data:s},mt({},e.defaultAttributes,l))])).name="label",o._onHover=function(t){var e=t.target;e===o._lastHover||ct(e.states)||(e.addState(yP.hover,!0),BP(i(o),(function(t){t===e||ct(t.states)||t.addState(yP.hoverReverse,!0)})),o._lastHover=e)},o._onUnHover=function(t){o._lastHover&&(BP(i(o),(function(t){ct(t.states)||(t.removeState(yP.hoverReverse),t.removeState(yP.hover))})),o._lastHover=null)},o._onClick=function(t){var e=t.target;if(o._lastSelect===e&&e.hasState("selected"))return o._lastSelect=null,void BP(i(o),(function(t){ct(t.states)||(t.removeState(yP.selectedReverse),t.removeState(yP.selected))}));ct(e.states)||(e.addState(yP.selected,!0),BP(i(o),(function(t){t===e||ct(t.states)||t.addState(yP.selectedReverse,!0)})),o._lastSelect=e)},o._handleRelatedGraphicSetState=function(t){var e,i,n,r,a;if((null===(e=t.detail)||void 0===e?void 0:e.type)===Sh.STATE||(null===(i=t.detail)||void 0===i?void 0:i.type)===Sh.ANIMATE_UPDATE&&(null===(n=t.detail.animationState)||void 0===n?void 0:n.isFirstFrameOfStep)){var s=null!==(a=null===(r=t.target)||void 0===r?void 0:r.currentStates)&&void 0!==a?a:[],l=o._isCollectionBase?b(o._graphicToText.values()):[o._graphicToText.get(t.target)];o.updateStatesOfLabels(l,s)}},o}return h(e,t),o(e,[{key:"setBitmap",value:function(t){this._bitmap=t}},{key:"setBitmapTool",value:function(t){this._bmpTool=t}},{key:"labeling",value:function(t,e,i,n){}},{key:"_getLabelLinePoints",value:function(t,e){return function(t,e){if(t&&e&&!rn(t,e,!0)){var i=Math.min(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.min(e.x1,e.x2),a=Math.min(e.y1,e.y2),o=Math.abs(t.x2-i)/2,s=Math.abs(t.y2-n)/2,l=Math.abs(e.x2-r)/2,u=Math.abs(e.y2-a)/2,c=i+o,h=n+s,d=r+l,p=a+u,f=d-c,v=p-h;return[Tz(f,v,c,h,o,s),Tz(-f,-v,d,p,l,u)]}}(t.AABBBounds,null==e?void 0:e.AABBBounds)}},{key:"_createLabelLine",value:function(t,e){var i=this._getLabelLinePoints(t,e);if(i){var n=B_.line({points:i}),r=t.attribute.line,a=void 0===r?{}:r;if(a.customShape){var o=a.customShape;n.pathProxy=function(i){return o({text:t,baseMark:e},i,new Md)}}return e&&e.getAttributes(!0).fill&&n.setAttribute("stroke",e.getAttributes(!0).fill),this.attribute.line&&!ct(this.attribute.line.style)&&n.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(n),n}}},{key:"render",value:function(){var t=this;if(this._prepare(),!(j(this._idToGraphic)||this._isCollectionBase&&j(this._idToPoint))){var e=[];!1!==this._enableAnimation&&this._baseMarks.forEach((function(t){e.push(t.attribute),t.initAttributes(t.getAttributes(!0))}));var i=this.attribute,n=i.overlap,r=i.smartInvert,a=i.dataFilter,o=i.customLayoutFunc,s=i.customOverlapFunc,l=this.attribute.data;if(U(a)&&(l=a(l)),l&&l.length){var u=new Set;l=l.filter((function(t){return!u.has(t.id)&&u.add(t.id)}))}var c=this._initText(l);c=U(o)?o(l,c,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this):this._layout(c);var h=[],d=c;if(!N(n)&&U(n.filterBeforeOverlap)){var p=this.getRelatedGraphic.bind(this);c.forEach((function(e){n.filterBeforeOverlap(e,p,t)?d.push(e):h.push(e)}))}U(s)?c=s(d,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this).concat(h):!1!==n&&(c=this._overlapping(d).concat(h)),U(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(c,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this),c&&c.length&&c.forEach((function(e){t._bindEvent(e),t._setStatesOfText(e)})),!1!==r&&this._smartInvert(c),this._renderLabels(c),!1!==this._enableAnimation&&this._baseMarks.forEach((function(t,i){t.initAttributes(e[i])}))}}},{key:"_bindEvent",value:function(t){if(!this.attribute.disableTriggerEvent&&t){var e=this.attribute,i=e.hover,n=e.select;i&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),n&&t.addEventListener("pointerdown",this._onClick)}}},{key:"_setStatesOfText",value:function(t){if(t){var e=this.attribute.state;e&&!ct(e)&&(t.states=e)}}},{key:"_setStatesOfLabelLine",value:function(t){if(t){var e=this.attribute.labelLineState;e&&!ct(e)&&(t.states=e)}}},{key:"_createLabelText",value:function(t){var e,i;return qP(Object.assign(Object.assign({},null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),t),"textType")}},{key:"_prepare",value:function(){var t,e,i=[];if((U(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.getChildren():[]}(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach((function(t){"willRelease"!==t.releaseStatus&&i.push(t)})),null===(t=this._idToGraphic)||void 0===t||t.clear(),null===(e=this._idToPoint)||void 0===e||e.clear(),this._baseMarks=i,this._isCollectionBase="line-data"===this.attribute.type,i&&0!==i.length){var n=this.attribute.data;if(n&&0!==n.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);for(var r=0,a=0;a<i.length;a++){var o=i[a],s=wz(o);if(s&&s.length)for(var l=0;l<s.length;l++){var u=n[r];u&&s[l]&&(W(u.id)||(u.id="vrender-component-".concat(this.name,"-").concat(r)),this._idToPoint.set(u.id,s[l]),this._idToGraphic.set(u.id,o)),r++}}}else for(var c=0;c<i.length;c++){var h=n[c],d=i[c];h&&d&&(W(h.id)||(h.id="vrender-component-".concat(this.name,"-").concat(c)),this._idToGraphic.set(h.id,d))}this._prepareAnimate(Cz)}}}},{key:"getRelatedGraphic",value:function(t){return this._idToGraphic.get(t.id)}},{key:"_initText",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.attribute.textStyle,i=void 0===e?{}:e,n=[],r=0;r<t.length;r++){var a=t[r],o=this.getRelatedGraphic(a);if(o){var s=o.getAttributes(!0),l=Object.assign(Object.assign({fill:this._isCollectionBase?Z(s.stroke)?s.stroke.find((function(t){return!!t&&!0!==t})):s.stroke:s.fill},i),a),u=this._createLabelText(l);n.push(u)}}return n}},{key:"_layout",value:function(t){for(var e=this.attribute,i=e.position,n=e.offset,r=0;r<t.length;r++){var a=t[r];if(!a)return;var o=a.attribute,s=this.getRelatedGraphic(o);if(s){a.attachedThemeGraphic=this;var l=this.getGraphicBounds(a);a.attachedThemeGraphic=null;var u=U(i)?i(o):i,c=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(o.id),u):this.getGraphicBounds(s,{x:o.x,y:o.y},u),h=this.labeling(l,c,u,n);h&&a.setAttributes(h)}}return t}},{key:"_overlapping",value:function(t){var e,i,n;if(0===t.length)return[];var r=G(this.attribute.overlap)?this.attribute.overlap:{},a=this.getBaseMarkGroup(),o=null!==(e=r.size)&&void 0!==e?e:{width:null!==(i=null==a?void 0:a.AABBBounds.width())&&void 0!==i?i:0,height:null!==(n=null==a?void 0:a.AABBBounds.height())&&void 0!==n?n:0};if(0===o.width||0===o.height)return t;var s=r.strategy,l=r.priority,u=this._bmpTool||gz(o.width,o.height),c=this._bitmap||u.bitmap();return l&&(t=t.sort((function(t,e){return l(e.attribute.data)-l(t.attribute.data)}))),"shiftY"===(null==s?void 0:s.type)?this._overlapGlobal(t,r,u,c):this._overlapByStrategy(t,r,u,c)}},{key:"_overlapGlobal",value:function(t,e,i,n){var r=this,a=t.filter((function(t){return t.attribute.visible&&0!==t.attribute.opacity&&r.isMarkInsideRect(r.getRelatedGraphic(t.attribute),i)})),o=e.clampForce,l=void 0===o||o,u=e.hideOnHit,c=void 0===u||u,h=e.hideOnOverflow,d=void 0!==h&&h,p=e.overlapPadding,f=e.strategy;if(l||d)for(var v=0;v<a.length;v++){var g=t[v],y=Az(g,i.width,i.height,i.padding),_=y.dx,b=void 0===_?0:_,x=y.dy,k=void 0===x?0:x;0===b&&0===k||(d?g.setAttributes({visible:!1}):(g.setAttributes({x:g.attribute.x+b,y:g.attribute.y+k}),g._isClamped=!0))}a=function(t,e){var i=e.maxY,n=void 0===i?Number.MAX_VALUE:i,r=e.labelling,a=e.globalShiftY,o=void 0===a?{enable:!0,maxIterations:10,maxError:.1,padding:1}:a,l=t.length;if(l<=1)return t;var u=new Map,c=new Map,h=function(t){return c.get(t).y1Initial},d=function(t){return c.get(t).height},p=function(t){return c.get(t).y1},f=function(t){return c.get(t).x},v=function(t){return c.get(t).x1},g=function(t){return c.get(t).x2},y=function(t){return c.get(t).attempts},_=function(t,e){c.get(t).y1=e},b=function(t,e){c.get(t).attempts=e};function x(t){for(var e=t.length-1;e>=0;e--){var i=t[e],a=t[e-1],o=t[e+1];if(a&&Pz(p(a)+d(a),p(i))||0===p(i)&&i._isClamped){var s=r(i).y;o&&Pz(s+d(i)/2,p(o))||s+d(i)/2<=n&&_(i,p(i)+s-(l=i,c.get(l).y))}}var l}t.sort((function(t,e){return t.attribute.x-e.attribute.x}));var k,S=s(t);try{for(S.s();!(k=S.n()).done;){var A=k.value,C=A.AABBBounds,M=C.y1,w=C.y2,T=C.x1,D=C.x2,E=A.attribute,B=E.x,P=E.y;c.set(A,{y1Initial:M,y1:M,y2:w,y:P,height:w-M,x1:T,x2:D,x:B,attempts:0});var R,L=!1,I=s(u);try{for(I.s();!(R=I.n()).done;){var F=m(R.value,2),O=F[0],z=F[1],H=O.start,N=O.end;if(T>=H&&D<=N)z.push(A),L=!0;else if(ie(B,f(z[0]),void 0,5)){var U={start:Math.min(H,T),end:Math.max(N,D)};z.push(A),u.set(U,z),u.delete(O),L=!0}else if(Lz([H,N],[T,D])/(N-H)>.5){var j={start:Math.min(H,T),end:Math.max(N,D)};z.push(A),u.set(j,z),u.delete(O),L=!0}if(L)break}}catch(t){I.e(t)}finally{I.f()}L||u.set({start:T,end:D},[A])}}catch(t){S.e(t)}finally{S.f()}var V,W=s(u.values());try{for(W.s();!(V=W.n()).done;){var G=V.value;G.sort((function(t,e){return h(t)-h(e)})),x(G)}}catch(t){W.e(t)}finally{W.f()}if(!1!==o.enable)for(var Y=o.maxIterations,X=void 0===Y?10:Y,K=o.maxError,q=void 0===K?.1:K,Z=o.padding,J=void 0===Z?1:Z,Q=o.maxAttempts,$=void 0===Q?1e3:Q,tt=o.deltaYTolerance,et=void 0===tt?Number.MAX_VALUE:tt,it=0;it<X;it++){t.sort((function(t,e){return h(t)-h(e)}));for(var nt=0,rt=0;rt<l-1;rt++){var at=t[rt];if(!(y(at)>=$)){for(var ot=void 0,st=rt+1;(ot=t[st])&&!Rz([v(at),g(at)],[v(ot),g(ot)]);)st+=1;if(ot){var lt=p(at),ut=d(at),ct=p(ot),ht=ct-(lt+ut);if(ht<J){var dt=(J-ht)/2;if(nt=Math.max(nt,dt),lt+dt+d(ot)>n){var pt=lt-(J-ht),ft=h(at)-pt;Math.abs(ft)<=et&&(_(at,pt),b(at,y(at)+1))}else if(lt-dt<0){var vt=ct+(J-ht),gt=h(ot)-vt;Math.abs(gt)<=et&&(_(ot,vt),b(ot,y(ot)+1))}else{var yt=lt-dt,mt=h(at)-yt,_t=ct+dt,bt=h(ot)-_t;Math.abs(mt)<=et&&Math.abs(bt)<=et&&(_(at,yt),_(ot,_t),b(at,y(at)+1),b(ot,y(ot)+1))}}}}}if(nt<q)break}var xt,kt=s(t);try{for(kt.s();!(xt=kt.n()).done;){var St=xt.value,At=St.attribute.y+p(St)-h(St);St.setAttribute("y",At)}}catch(t){kt.e(t)}finally{kt.f()}var Ct=[];t.sort((function(t,e){return t.attribute.x-e.attribute.x}));for(var Mt=0,wt=t.length-1;Mt<=wt;)Mt===wt?Ct.push(t[Mt]):(Ct.push(t[Mt]),Ct.push(t[wt])),Mt++,wt--;return Ct}(a,Object.assign(Object.assign({maxY:i.height},f),{labelling:function(t){var e=r.getRelatedGraphic(t.attribute),i=r._isCollectionBase?r.getGraphicBounds(null,r._idToPoint.get(t.attribute.id)):r.getGraphicBounds(e,t);return r.labeling(t.AABBBounds,i,"bottom",r.attribute.offset)}}));for(var S=0;S<a.length;S++){var A=a[S],C=A.AABBBounds,M=mz(i,C,!0);if(_z(i,n,C,l||d,p))n.setRange(M);else{if(d){if(this._processHideOnOverflow(A,i))continue}else if(l&&this._processClampForce(A,i,n,p))continue;c?A.setAttributes({visible:!1}):n.setRange(M)}}return a}},{key:"_processHideOnOverflow",value:function(t,e){var i=Az(t,e.width,e.height,e.padding),n=i.dy,r=void 0===n?0:n,a=i.dx;return 0===(void 0===a?0:a)&&0===r||(t.setAttributes({visible:!1}),!1)}},{key:"_processClampForce",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=Az(t,e.width,e.height,e.padding),a=r.dy,o=void 0===a?0:a,s=r.dx,l=void 0===s?0:s;if(0===l&&0===o){if(_z(e,i,t.AABBBounds,!1,n))return i.setRange(mz(e,t.AABBBounds,!0)),!0}else if(_z(e,i,{x1:t.AABBBounds.x1+l,x2:t.AABBBounds.x2+l,y1:t.AABBBounds.y1+o,y2:t.AABBBounds.y2+o}))return t.setAttributes({x:t.attribute.x+l,y:t.attribute.y+o}),i.setRange(mz(e,t.AABBBounds,!0)),!0;return!1}},{key:"_overlapByStrategy",value:function(t,e,i,n){var r,a=this,o=e.avoidBaseMark,s=e.strategy,l=void 0===s?[]:s,u=e.hideOnHit,c=void 0===u||u,h=e.clampForce,d=void 0===h||h,p=e.avoidMarks,f=void 0===p?[]:p,v=e.overlapPadding,g=e.hideOnOverflow,y=void 0!==g&&g,m=[],_=l.some((function(t){return"bound"===t.type}));o&&(null===(r=this._baseMarks)||void 0===r||r.forEach((function(t){t.AABBBounds&&n.setRange(mz(i,t.AABBBounds,!0))}))),f.length>0&&f.forEach((function(t){q(t)?function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.findAll((function(t){return"group"!==t.type}),!0):[]}(a.getRootNode(),t).forEach((function(t){t.AABBBounds&&n.setRange(mz(i,t.AABBBounds,!0))})):t.AABBBounds&&n.setRange(mz(i,t.AABBBounds,!0))}));for(var b=0;b<t.length;b++)if(!1!==t[b].attribute.visible){var x=t[b],k=this.getRelatedGraphic(x.attribute);if(x.update(),this.isMarkInsideRect(k,i)){if(_z(i,n,x.AABBBounds,d||y,v)){if(!_){n.setRange(mz(i,x.AABBBounds,!0)),m.push(x);continue}if(_&&k&&k.AABBBounds&&this._canPlaceInside(x.AABBBounds,k.AABBBounds)){n.setRange(mz(i,x.AABBBounds,!0)),m.push(x);continue}}for(var S=!1,A=0;A<l.length;A++)if(!1!==(S=xz(i,n,l[A],this.attribute,x,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[b].attribute.id)):this.getGraphicBounds(k,t[b].attribute),this.labeling))&&(x.setAttributes({x:S.x,y:S.y}),!y||this._processHideOnOverflow(x,i))){m.push(x);break}if(!S){if(y&&!this._processHideOnOverflow(x,i))continue;if(d&&this._processClampForce(x,i,n,v)){m.push(x);continue}}!S&&!c&&m.push(x)}}return m}},{key:"isMarkInsideRect",value:function(t,e){var i=e.padding,n=i.left,r=i.right,a=i.top,o=i.bottom,s={x1:-n,x2:e.width+r,y1:-a,y2:e.height+o},l=t.AABBBounds;if(0!==l.width()&&0!==l.height())return rn(t.AABBBounds,s,!0);var u=t.attribute;if("rect"===t.type){var c=u.x,h=u.x1,d=u.y,p=u.y1;return an({x:null!=c?c:h,y:null!=d?d:p},s,!0)}return"x"in u&&"y"in u&&an({x:u.x,y:u.y},s,!0)}},{key:"getBaseMarkGroup",value:function(){var t=this.attribute.baseMarkGroupName;if(t)return this.getRootNode().find((function(e){return e.name===t}),!0)}},{key:"getGraphicBounds",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(t){if(!1!==t.attribute.visible){if(null===(e=t.context)||void 0===e?void 0:e.animationState){var r=t.clone();return Object.assign(r.attribute,t.getAttributes(!0)),r.AABBBounds}return t.AABBBounds}var a=t.attribute,o=a.x,s=a.y;return{x1:o,x2:o,y1:s,y2:s}}if(i&&n&&"inside-middle"===n){var l=i.x,u=i.y,c=i.x1,h=void 0===c?l:c,d=i.y1,p=void 0===d?u:d;return{x1:(l+h)/2,x2:(l+h)/2,y1:(u+p)/2,y2:(u+p)/2}}var f=i.x,v=i.y;return{x1:f,x2:f,y1:v,y2:v}}},{key:"_renderLabels",value:function(t){var e,i=this,n=this.attribute.syncState,r=new Map,a=this._graphicToText||new Map,o=[],s=[],l=(null!==(e=this.attribute.line)&&void 0!==e?e:{}).visible;t&&t.forEach((function(t,e){var u,c,h=i.getRelatedGraphic(t.attribute),d=i._isCollectionBase?t.attribute.id:h,p=(null==a?void 0:a.get(d))?"update":"enter";l&&(c=i._createLabelLine(t,h));var f=c?{text:t,labelLine:c}:{text:t};if(n&&i.updateStatesOfLabels([f],null!==(u=h.currentStates)&&void 0!==u?u:[]),"enter"===p)o.push(t),r.set(d,f),i._addLabel(f,o,s,e);else if("update"===p){var v=a.get(d);a.delete(d),r.set(d,v),i._updateLabel(v,f)}})),this._removeLabel(a),this._graphicToText=r}},{key:"runEnterAnimation",value:function(t,e){var i=this;if(!1!==this._enableAnimation&&this._animationConfig.enter){var n=this.getRelatedGraphic(t.attribute),r=this._animationConfig.enter;[t,e].filter(Boolean).forEach((function(e){var a;null===(a=e.setFinalAttributes)||void 0===a||a.call(e,e.attribute),e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r),{type:"labelEnter",selfOnly:!0,customParameters:{relatedGraphic:n,relatedGraphics:i._idToGraphic,config:Object.assign(Object.assign({},r),{type:e===t?r.type:"fadeIn"})}})}])}))}}},{key:"_runUpdateAnimation",value:function(t,e){var i=t.text,n=t.labelLine,r=e.text,a=e.labelLine;i.applyAnimationState(["update"],[{name:"update",animation:{type:"labelUpdate",customParameters:Object.assign(Object.assign({},this._animationConfig.update),{prevText:i,curText:r,prevLabelLine:n,curLabelLine:a})}}])}},{key:"_syncStateWithRelatedGraphic",value:function(t){this.attribute.syncState&&t&&t.on("afterStateUpdate",this._handleRelatedGraphicSetState)}},{key:"_addLabel",value:function(t,e,i,n){var r=t.text,a=t.labelLine,o=this.getRelatedGraphic(r.attribute);this._syncStateWithRelatedGraphic(o),r&&this.add(r),a&&this.add(a),this.runEnterAnimation(r,a)}},{key:"_updateLabel",value:function(t,e){t.text;var i=t.labelLine,n=e.text,r=e.labelLine;!1===this._enableAnimation||!1===this._animationConfig.update?(t.text.setAttributes(n.attribute),i&&r&&t.labelLine.setAttributes(r.attribute)):this._runUpdateAnimation(t,e)}},{key:"_removeLabel",value:function(t){var e=this,i=function(t){e.removeChild(t.text),t.labelLine&&e.removeChild(t.labelLine)};!1!==this._enableAnimation&&!1!==this._animationConfig.exit?t.forEach((function(t){var n;t.text.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},e._animationConfig.exit),{type:"fadeOut"})}],(function(){i(t)})),null===(n=t.labelLine)||void 0===n||n.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},e._animationConfig.exit),{type:"fadeOut"})}],(function(){}))})):t.forEach((function(t){i(t)}))}},{key:"updateStatesOfLabels",value:function(t,e){t.forEach((function(t){t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))}))}},{key:"_smartInvert",value:function(t){var e,i,n,r,a,o,s,l=G(this.attribute.smartInvert)?this.attribute.smartInvert:{},u=l.textType,c=l.contrastRatiosThreshold,h=l.alternativeColors,d=l.mode,p=l.interactInvertType,f=null!==(e=l.fillStrategy)&&void 0!==e?e:"invertBase",v=null!==(i=l.strokeStrategy)&&void 0!==i?i:"base",g=null!==(n=l.brightColor)&&void 0!==n?n:"#ffffff",y=null!==(r=l.darkColor)&&void 0!==r?r:"#000000",m=null!==(a=l.outsideEnable)&&void 0!==a&&a;if("null"!==f||"null"!==v)for(var _=0;_<t.length;_++){var b=t[_];if(b){var x=this.getRelatedGraphic(b.attribute),k=x.getAttributes(!0).fill,S=b.attribute.fill;if(G(k)&&k.gradient){var A=null===(s=null===(o=k.stops)||void 0===o?void 0:o[0])||void 0===s?void 0:s.color;A&&(k=A,S=A)}var C=OP(S,k,u,c,h,d),M=zP(C,g)?g:y,w=this._canPlaceInside(b.AABBBounds,x.AABBBounds),T=!w&&b.AABBBounds&&x.AABBBounds&&x.AABBBounds.intersects(b.AABBBounds);if(w||m||T&&"inside"===p){var D=UP(f,k,C,M);if(D&&b.setAttributes({fill:D}),0===b.attribute.lineWidth||0===b.attribute.strokeOpacity)continue;var E=UP(v,k,C,M);E&&b.setAttributes({stroke:E})}else if(T&&"none"!==p){if(0===b.attribute.lineWidth||0===b.attribute.strokeOpacity)continue;if(b.attribute.stroke){b.setAttributes({fill:OP(b.attribute.fill,b.attribute.stroke,u,c,h,d)});continue}var B=UP(f,k,C,M);B&&b.setAttributes({fill:B});var P=UP(v,k,C,M);P&&b.setAttributes({stroke:P})}}}}},{key:"_canPlaceInside",value:function(t,e){return!(!t||!e)&&e.encloses(t)}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._enableAnimation=!1}},{key:"enableAnimation",value:function(){this._enableAnimation=!0}}])}(qR);Fz.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};var Oz={},zz=function(t,e){Oz[t]=e},Hz=function(t){return Oz[t]},Nz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},Uz=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=Nz(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},mt({},e.defaultAttributes,s))])).name="symbol-label",a}return h(e,t),o(e,[{key:"labeling",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t){var r=t.x1,a=t.y1,o=t.x2,s=t.y2,l=Math.abs(o-r),u=Math.abs(s-a),c=(e.x1+e.x2)/2,h=(e.y1+e.y2)/2,d=0,p=0,f=0,v=0;e&&(f=Math.abs(e.x1-e.x2)/2,v=Math.abs(e.y1-e.y2)/2);var g={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":d=-1;break;case"right":d=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":d=Math.sin(g[i]*(Math.PI/180)),p=Math.cos(g[i]*(Math.PI/180));break;case"center":d=0,p=0}return{x:c+d*(n+f)+Math.sign(d)*(l/2),y:h+p*(n+v)+Math.sign(p)*(u/2)}}}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}])}(Fz);Uz.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};var jz=function(){zz("symbol",Uz),zz("line-data",Uz)},Vz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},Wz=function(t){function e(t,i){r(this,e);var a=t.data,o=Vz(t,["data"]);return n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:a},mt({},e.defaultAttributes,o))])}return h(e,t),o(e,[{key:"labeling",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t&&e){var r=t.x1,a=t.y1,o=t.x2,s=t.y2,l=Math.abs(o-r),u=Math.abs(s-a),c=Pn(e,i),h=c.x,d=c.y,p=0,f=0,v=i.includes("inside");switch(i.includes("top")?f=v?1:-1:i.includes("bottom")?f=v?-1:1:i.includes("left")?p=v?1:-1:i.includes("right")&&(p=v?-1:1),i){case"top-right":case"bottom-right":p=-1;break;case"top-left":case"bottom-left":p=1}return{x:h+p*n+p*l/2,y:d+f*n+f*u/2}}}}])}(Fz);Wz.tag="rect-label",Wz.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};var Gz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},Yz=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=Gz(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},mt({},e.defaultAttributes,s))])).name="line-label",a}return h(e,t),o(e,[{key:"getGraphicBounds",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end";if(!t||"line"!==t.type&&"area"!==t.type)return _(e,"getGraphicBounds",this,3)([t,i]);var r=t.attribute.points,a=t.attribute.segments;!r&&a&&a.length&&(r=a.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[])),r&&0!==r.length||(r=[i]);var o="start"===n?0:r.length-1;return r[o]?{x1:r[o].x,x2:r[o].x,y1:r[o].y,y2:r[o].y}:void 0}},{key:"labeling",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!t||!e)return{x:1/0,y:1/0};var r=t.x1,a=t.x2,o=Math.abs(a-r),s=e.x1,l=s;return"end"===i?l=s+o/2+n:"start"===i&&(l=s-o/2-n),{x:l,y:e.y1}}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}])}(Fz);Yz.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};var Xz=function(){zz("line",Yz),zz("area",Yz)},Kz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},qz=function(){return o((function t(e,i,n,a,o,s,l,u,c){r(this,t),this.refDatum=e,this.center=i,this.outerCenter=n,this.quadrant=a,this.radian=o,this.middleAngle=s,this.innerRadius=l,this.outerRadius=u,this.circleCenter=c,this.labelVisible=!0}),[{key:"getLabelBounds",value:function(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}])}(),Zz=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=Kz(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},mt({},e.defaultAttributes,s))])).name="arc-label",a._ellipsisWidth=0,a._arcLeft=new Map,a._arcRight=new Map,a._line2MinLength=0,a._alignOffset=0,a}return h(e,t),o(e,[{key:"_overlapping",value:function(t){return["inside","inside-center"].includes(this.attribute.position)?_(e,"_overlapping",this,3)([t]):t}},{key:"labeling",value:function(t,e){if(t&&e)return{x:0,y:0}}},{key:"_layout",value:function(t){var i,n,r,a=this;if(t&&t.length){var o=_(e,"_layout",this,3)([t]),s=o.map((function(t){return a.getGraphicBounds(t)})),l=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),u=1/0;if(!1!==l.ellipsis){var c=this._createLabelText(l),h=this.getGraphicBounds(c);u=h.x2-h.x1}var d=o.map((function(t){return t.attribute})),p=Array.from(this._idToGraphic.values());this._line2MinLength=U(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(t,p,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=null!==(i=U(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(t,p,this.attribute):this.attribute.layout.alignOffset)&&void 0!==i?i:0;for(var f=this.layoutArcLabels(this.attribute.position,this.attribute,p,d,s,u),v=function(){var t=d[g],e=f.find((function(e){var i;return(null===(i=e.refDatum)||void 0===i?void 0:i.id)===t.id}));if(e){var i={visible:e.labelVisible,x:e.labelPosition.x,y:e.labelPosition.y,angle:e.angle,points:e.pointA&&e.pointB&&e.pointC?[e.pointA,e.pointB,e.pointC]:void 0,line:e.labelLine};"richtext"===o[g].type?i.width=null!==(n=e.labelLimit)&&void 0!==n?n:o[g].attribute.width:i.maxLineWidth=null!==(r=e.labelLimit)&&void 0!==r?r:o[g].attribute.maxLineWidth,e.refArc&&"arc3d"===e.refArc.type&&(i.anchor3d=[e.circleCenter.x-i.x,e.circleCenter.y-i.y],i.beta=e.refArc.attribute.beta),o[g].setAttributes(i)}},g=0;g<d.length;g++)v();return o}}},{key:"layoutArcLabels",value:function(t,e,i,n,r,a){var o=this;this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=a;var s=0;i.forEach((function(t){t.attribute.outerRadius>s&&(s=t.attribute.outerRadius)})),n.forEach((function(t,i){var a,l,u,c=o._idToGraphic.get(t.id),h=c.getAttributes(!0),d={x:null!==(a=null==h?void 0:h.x)&&void 0!==a?a:0,y:null!==(l=null==h?void 0:h.y)&&void 0!==l?l:0};if(!j(n[i])&&!j(r[i])){var p=n[i]?n[i]:null,f=r[i]?r[i]:{x1:0,x2:0,y1:0,y2:0},v=(h.startAngle+h.endAngle)/2,g=h.endAngle-h.startAngle,y=zi(h.endAngle-g/2),m=Pi(d,h.outerRadius,v),_=Pi(d,s+e.line.line1MinLength,v),b=new qz(p,m,_,y,g,v,h.innerRadius,h.outerRadius,d);b.refArc=c,b.pointA=Pi(d,o.computeDatumRadius(2*d.x,2*d.y,h.outerRadius),b.middleAngle),b.labelSize={width:f.x2-f.x1,height:f.y2-f.y1},1===(u=b.quadrant)||2===u?o._arcRight.set(b.refDatum,b):Mz(b.quadrant)&&o._arcLeft.set(b.refDatum,b)}}));var l=Array.from(this._arcLeft.values()),u=Array.from(this._arcRight.values()),c=[];switch(t){case"inside":case"inside-inner":case"inside-outer":case"inside-center":c.push.apply(c,b(this._layoutInsideLabels(u,e,i))),c.push.apply(c,b(this._layoutInsideLabels(l,e,i)));break;default:c.push.apply(c,b(this._layoutOutsideLabels(u,e,i))),c.push.apply(c,b(this._layoutOutsideLabels(l,e,i)))}return c}},{key:"_layoutInsideLabels",value:function(t,e,i){var n,r,a=this,o=e,s=o.spaceWidth,l=null!==(n=o.position)&&void 0!==n?n:"inside",u=null!==(r=o.offsetRadius)&&void 0!==r?r:-s;return t.forEach((function(t){var i,n,r,c,h=t.labelSize,d=t.radian,p=t.innerRadius,f=t.outerRadius;d<function(t,e){return e>2*t?NaN:2*Math.asin(e/2/t)}(f,h.height)?c=0:c=f-(d>=Math.PI?p:Math.max(p,h.height/2/Math.tan(d/2)))-s;!0!==o.rotate&&(c=f-s);var v=a._getFormatLabelText(t.refDatum,c);t.labelText=v;var g,y=Math.min(c,t.labelSize.width),m=a._computeAlign(t,e),_=0;if("inside"===l&&(_="left"===m?y:"right"===m?0:y/2),g="inside-inner"===l?p-u+_:"inside-center"===l?p+(f-p)/2:f+u-_,t.labelPosition=Pi(t.circleCenter,g,t.middleAngle),t.labelLimit=y,ne(y,0)||(t.labelVisible=!1),!1!==o.rotate){t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:t.middleAngle;var b=null!==(r=o.offsetAngle)&&void 0!==r?r:0;["inside-inner","inside-outer"].includes(l)&&(b+=Math.PI/2),t.angle+=b}})),t}},{key:"_layoutOutsideLabels",value:function(t,e,i){var n,r,a,o=this,l=null!==(n=i[0].attribute.x)&&void 0!==n?n:0,u=2*(null!==(r=i[0].attribute.y)&&void 0!==r?r:0),c=e.layout,h=e.spaceWidth;if(t.forEach((function(t){var e=Mz(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+o._line2MinLength+h),y:t.outerCenter.y}})),t.sort((function(t,e){return t.labelPosition.y-e.labelPosition.y})),!1!==e.coverEnable||"none"===c.strategy){var d,p=s(t);try{for(p.s();!(d=p.n()).done;){var f=d.value,v=f.labelPosition,g=f.labelSize;f.labelLimit=g.width,f.pointB=Mz(f.quadrant)?{x:v.x+g.width/2+this._line2MinLength+h,y:v.y}:{x:v.x-g.width/2-this._line2MinLength-h,y:v.y},this._computeX(f,e,i)}}catch(t){p.e(t)}finally{p.f()}!1===e.coverEnable&&"none"===c.strategy&&this._coverLabels(t)}else{var y=u/((null===(a=e.textStyle)||void 0===a?void 0:a.fontSize)||16);this._adjustY(t,y,e,i);var m,_=t.reduce((function(t,e){var i=e.getLabelBounds(),n=i.y1,r=i.y2;return t.minY=Math.max(0,Math.min(n,t.minY)),t.maxY=Math.min(u,Math.max(r,t.maxY)),t}),{minY:1/0,maxY:-1/0}),b=_.minY,x=_.maxY,k=Math.max(Math.abs(u/2-b),Math.abs(x-u/2)),S=this._computeLayoutRadius(k,e,i),A=s(t);try{for(A.s();!(m=A.n()).done;){var C=m.value;this._computePointB(C,S,e,i),this._computeX(C,e,i)}}catch(t){A.e(t)}finally{A.f()}}var M=2*l;return t.forEach((function(t){var i,n;t.labelVisible&&(re(t.pointB.x,o._line2MinLength+h)||ne(t.pointB.x,M-o._line2MinLength-h))&&(t.labelVisible=!1),t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign(Object.assign({},e.line),{visible:t.labelVisible})})),t}},{key:"_computeX",value:function(t,e,i){var n,r=t.circleCenter,a=this.attribute.width;this.attribute.height;var o=0;i.forEach((function(t){t.getAttributes(!0).outerRadius>o&&(o=t.getAttributes(!0).outerRadius)}));var s=this.computeLayoutOuterRadius(o,e.width,e.height),l=e.line.line1MinLength,u=null===(n=e.layout)||void 0===n?void 0:n.align,c=e.spaceWidth,h=t.labelPosition,d=t.quadrant,p=t.pointB;it(p.x*p.y)||(t.pointC={x:NaN,y:NaN},h.x=NaN,t.labelLimit=0);var f=this.computeRadius(s,e.width,e.height),v=Mz(d)?-1:1,g=0,y=(v>0?a-p.x:p.x-0)+this._alignOffset-this._line2MinLength-c;"labelLine"===u&&(g=(f+l+this._line2MinLength)*v+r.x,y=(v>0?a-g:g-0)-c);var m=this._getFormatLabelText(t.refDatum,y);t.labelText=m;var _=Math.min(y,t.labelSize.width);switch(u){case"labelLine":break;case"edge":g=v>0?a-_-c:0+_+c;break;default:g=p.x+v*this._line2MinLength}var b=(_=Math.max(this._ellipsisWidth,_))<t.labelSize.width-1;t.labelLimit=b?_:null,t.pointC={x:g,y:h.y};var x=function(t){return"left"===t?0:"right"===t?1:.5}(this._computeAlign(t,e))*(b?_:t.labelSize.width);"edge"===u?(h.x=(v>0?a:0)-v*x+v*this._alignOffset,t.pointC.x+=v*this._alignOffset):h.x=g+v*(this._alignOffset+c+x)}},{key:"_computeAlign",value:function(t,e){var i,n,r,a,o,s,l=e,u=null!==(n=null===(i=l.textStyle)||void 0===i?void 0:i.textAlign)&&void 0!==n?n:null===(r=l.textStyle)||void 0===r?void 0:r.align,c=null!==(o=null===(a=l.layout)||void 0===a?void 0:a.textAlign)&&void 0!==o?o:null===(s=l.layout)||void 0===s?void 0:s.align;return"inside"!==l.position?j(u)||"auto"===u?"edge"===c?Mz(t.quadrant)?"left":"right":Mz(t.quadrant)?"right":"left":u:j(u)||"auto"===u?"center":u}},{key:"_getFormatLabelText",value:function(t,e){var i;return null!==(i=null==t?void 0:t.text)&&void 0!==i?i:""}},{key:"_adjustY",value:function(t,e,i,n){var r;n[0].attribute.x;var a=2*(null!==(r=n[0].attribute.y)&&void 0!==r?r:0),o=i.layout;if("vertical"===o.strategy){var s,l=0,u=t.length;if(u<=0)return;for(var c=0;c<u;c++){if(re(s=t[c].getLabelBounds().y1-l,0)){var h=this._shiftY(t,c,u-1,-s);this._shiftY(t,h,0,s/2)}l=t[c].getLabelBounds().y2}re(s=t[0].getLabelBounds().y1-0,0)&&this._shiftY(t,0,u-1,-s);for(var d=t.length-1;d>=0&&t[d].getLabelBounds().y2>a;d--)t[d].labelVisible=!1}else if("none"!==o.strategy){var p=t.map((function(t,e){return{arc:t,originIndex:e,priorityIndex:0}}));p.sort((function(t,e){return e.arc.radian-t.arc.radian})),p.forEach((function(t,e){t.priorityIndex=e,t.arc.labelVisible=!1}));for(var f=1/0,v=-1/0,g=0;g<e&&g<t.length;g++){this._storeY(t);var y=p[g].arc;this._computeYRange(y,i,n),y.labelVisible=!0;var m=y.labelPosition.y,_=this._findNeighborIndex(t,p[g]),b=_.lastIndex,x=_.nextIndex,k=t[b],S=t[x];if(-1===b&&-1!==x){var A=S.labelPosition.y;m>A?y.labelPosition.y=A-S.labelSize.height/2-y.labelSize.height/2:this._twoWayShift(t,y,S,x)}else if(-1!==b&&-1===x){var C=k.labelPosition.y;m<C?y.labelPosition.y=C+k.labelSize.height/2+y.labelSize.height/2:this._twoWayShift(t,k,y,p[g].originIndex)}else if(-1!==b&&-1!==x){var M=k.labelPosition.y,w=S.labelPosition.y;m>w?(y.labelPosition.y=w-S.labelSize.height/2-y.labelSize.height/2,this._twoWayShift(t,k,y,p[g].originIndex)):m<M?(y.labelPosition.y=M+k.labelSize.height/2+y.labelSize.height/2,this._twoWayShift(t,y,S,x)):(this._twoWayShift(t,k,y,p[g].originIndex),this._twoWayShift(t,y,S,x))}var T=Math.min(f,p[g].originIndex),D=Math.max(v,p[g].originIndex),E=void 0;if(ne(E=t[D].getLabelBounds().y2-a,0)&&this._shiftY(t,D,0,-E),re(E=t[T].getLabelBounds().y1-0,0)&&this._shiftY(t,T,t.length-1,-E),ne(E=t[D].getLabelBounds().y2-a,0)){y.labelVisible=!1,this._restoreY(t);break}o.tangentConstraint&&!this._checkYRange(t)?(y.labelVisible=!1,this._restoreY(t)):(f=T,v=D)}}}},{key:"_shiftY",value:function(t,e,i,n){for(var r=e<i?1:-1,a=e;-1!==a;){t[a].labelPosition.y+=n;var o=this._findNextVisibleIndex(t,a,i,r);if(o>=0&&o<t.length){var s=t[a].getLabelBounds(),l=s.y1,u=s.y2,c=t[o].getLabelBounds(),h=c.y1,d=c.y2;if(r>0&&u<h||r<0&&l>d)return a}a=o}return i}},{key:"_findNextVisibleIndex",value:function(t,e,i,n){for(var r=(i-e)*n,a=1;a<=r;a++){var o=e+a*n;if(t[o].labelVisible)return o}return-1}},{key:"_computePointB",value:function(t,e,i,n){var r=i,a=0;n.forEach((function(t){t.getAttributes(!0).outerRadius>a&&(a=t.getAttributes(!0).outerRadius)}));var o=this.computeLayoutOuterRadius(a,i.width,i.height),s=r.line.line1MinLength;if("none"===r.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{var l=t.circleCenter,u=this.computeRadius(o,i.width,i.height),c=t.labelPosition,h=t.quadrant,d=e-Math.max(u+s,t.outerRadius),p=Math.sqrt(Math.pow(e,2)-Math.pow(Math.abs(l.y-c.y),2))-d;it(p)?t.pointB={x:l.x+p*(Mz(h)?-1:1),y:c.y}:t.pointB={x:NaN,y:NaN}}}},{key:"_storeY",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.lastLabelY=n.labelPosition.y)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_computeYRange",value:function(t,e,i){var n=t.circleCenter,r={width:2*n.x,height:2*n.y},a=0;i.forEach((function(t){t.getAttributes(!0).outerRadius>a&&(a=t.getAttributes(!0).outerRadius)}));var o,s,l,u=this.computeLayoutOuterRadius(a,e.width,e.height),c=e.line.line1MinLength,h=r.width,d=r.height,p=this.computeRadius(u,e.width,e.height),f=this._computeLayoutRadius(d/2,e,i),v=Math.abs(t.center.x-h/2),g=t.center.y-d/2;if(ie(h/2,v))o=0,s=1,l=-g;else if(ie(d/2,g))o=1,s=0,l=-v;else{var y=-1/(g/v);o=y,s=-1,l=g-y*v}var m,_,b=function(t,e,i,n,r,a){if(0===t&&0===e||a<=0)return[];if(0===t){var o=-i/e,s=Math.pow(a,2)-Math.pow(o-r,2);return s<0?[]:0===s?[{x:n,y:o}]:[{x:Math.sqrt(s)+n,y:o},{x:-Math.sqrt(s)+n,y:o}]}if(0===e){var l=-i/t,u=Math.pow(a,2)-Math.pow(l-n,2);return u<0?[]:0===u?[{x:l,y:r}]:[{x:l,y:Math.sqrt(u)+r},{x:l,y:-Math.sqrt(u)+r}]}var c=Math.pow(e/t,2)+1,h=2*((i/t+n)*(e/t)-r),d=Math.pow(h,2)-4*c*(Math.pow(i/t+n,2)+Math.pow(r,2)-Math.pow(a,2));if(d<0)return[];var p=(-h+Math.sqrt(d))/(2*c),f=(-h-Math.sqrt(d))/(2*c),v=-(e*p+i)/t;return 0===d?[{x:v,y:p}]:[{x:v,y:p},{x:-(e*f+i)/t,y:f}]}(o,s,l,c+p-f,0,f);b.length<2||(b[0].x>b[1].x&&b.reverse(),b[0].x<0?ie(b[0].y,b[1].y)?ne(t.middleAngle,-Math.PI)&&re(t.middleAngle,0)||ne(t.middleAngle,Math.PI)&&re(t.middleAngle,2*Math.PI)?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=d):b[0].y<b[1].y?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=r.height):(m=Math.min(b[0].y,b[1].y)+d/2,_=Math.max(b[0].y,b[1].y)+d/2),t.labelYRange=[m,_])}},{key:"_computeLayoutRadius",value:function(t,e,i){var n=e,r=n.layoutArcGap,a=n.line.line1MinLength,o=0;i.forEach((function(t){t.getAttributes(!0).outerRadius>o&&(o=t.getAttributes(!0).outerRadius)}));var s=this.computeLayoutOuterRadius(o,e.width,e.height),l=this.computeRadius(s,e.width,e.height)+a,u=l-r;return Math.max((Math.pow(u,2)+Math.pow(t,2))/(2*u),l)}},{key:"_findNeighborIndex",value:function(t,e){for(var i=e.originIndex,n=-1,r=-1,a=i-1;a>=0;a--)if(t[a].labelVisible){n=a;break}for(var o=i+1;o<t.length;o++)if(t[o].labelVisible){r=o;break}return{lastIndex:n,nextIndex:r}}},{key:"_twoWayShift",value:function(t,e,i,n){var r=i.getLabelBounds().y1-e.getLabelBounds().y2;if(re(r,0)){var a=this._shiftY(t,n,t.length-1,-r);this._shiftY(t,a,0,r/2)}}},{key:"_restoreY",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.labelPosition.y=n.lastLabelY)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_checkYRange",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r=n.labelYRange,a=n.labelPosition;if(n.labelVisible&&r&&(re(a.y,r[0])||ne(a.y,r[1])))return!1}}catch(t){i.e(t)}finally{i.f()}return!0}},{key:"_coverLabels",value:function(t){if(!(t.length<=1))for(var e,i,n,r,a,o,s,l,u,c,h=t[0].getLabelBounds(),d=1;d<t.length;d++){var p=t[d].getLabelBounds();i=p,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=void 0,n=(e=h).x1,r=e.y1,a=e.x2,o=e.y2,s=i.x1,l=i.y1,u=i.x2,c=i.y2,n<=s&&a<=s||n>=u&&a>=u||r<=l&&o<=l||r>=c&&o>=c?h=p:t[d].labelVisible=!1}}},{key:"_getLabelLinePoints",value:function(t,e){return t.attribute.points}},{key:"_createLabelLine",value:function(t,i){var n,r,a,o,s,l=t.attribute,u=l.line,c=void 0===u?{}:u,h=l.visible,d=_(e,"_createLabelLine",this,3)([t,i]);if(d&&(d.setAttributes({visible:null===(a=null!==(n=c.visible&&h)&&void 0!==n?n:null===(r=t.attribute)||void 0===r?void 0:r.visible)||void 0===a||a,lineWidth:null!==(s=null===(o=c.style)||void 0===o?void 0:o.lineWidth)&&void 0!==s?s:1}),c.smooth&&d.setAttributes({curveType:"basis"}),"arc3d"===i.type&&i)){var p=i.getAttributes(!0),f=p.beta,v=p.x,g=p.y;d.setAttributes({beta:f,anchor3d:[v,g]})}return d}},{key:"computeRadius",value:function(t,e,i,n){return this.computeLayoutRadius(e||0,i||0)*t*(j(n)?1:n)}},{key:"computeLayoutRadius",value:function(t,e){return Math.min(t/2,e/2)}},{key:"_canPlaceInside",value:function(t,e){return"inside"===this.attribute.position||"inside-center"===this.attribute.position}},{key:"computeLayoutOuterRadius",value:function(t,e,i){return t/(Math.min(e,i)/2)}},{key:"computeDatumRadius",value:function(t,e,i){var n=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*n}}])}(Fz);Zz.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};var Jz=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},Qz=function(t){function e(t,i){var a;r(this,e);var o=t.dataLabels,s=Jz(t,["dataLabels"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({dataLabels:o},mt({},e.defaultAttributes,s))])).name="data-label",a}return h(e,t),o(e,[{key:"render",value:function(){var t,e=this,i=this.attribute,n=i.dataLabels,r=i.size;if(n&&0!==n.length){var a=r||{},o=a.width,s=void 0===o?0:o,l=a.height,u=void 0===l?0:l,c=a.padding;if(s&&u&&it(u*s)){this._componentMap||(this._componentMap=new Map);for(var h=gz(s,u,c),d=h.bitmap(),p=new Map,f=this._componentMap,v=0;v<n.length;v++){var g=n[v],y=Hz(g.type)||Fz;if(y){var m=g.baseMarkGroupName,_=g.type,b=null!==(t=g.id)&&void 0!==t?t:"".concat(m,"-").concat(_,"-").concat(v);"arc"===g.type&&(g.width=r.width,g.height=r.height);var x=this._componentMap.get(b);x?(x.setBitmapTool(h),x.setBitmap(d),x.setAttributes(g),p.set(b,x)):((x=new y(g)).setBitmap(d),x.setBitmapTool(h),this.add(x),p.set(b,x))}}f.forEach((function(t,i){p.get(i)||e.removeChild(t)})),this._componentMap=p}}}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._componentMap.forEach((function(t){t.disableAnimation()}))}},{key:"enableAnimation",value:function(){this._componentMap.forEach((function(t){t.enableAnimation()}))}}])}($A);function $z(t,e,i,n){var r="";if(!t||0===e.length)return r;var a=e[0],o=Si.distancePP(t,a),s=i?0:1;return n?r+="M".concat(t.x,",").concat(t.y-o,"A").concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y+o,"A").concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y-o,"Z"):e.forEach((function(t,e){0===e?r="M".concat(t.x,",").concat(t.y):r+="A".concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y)})),r}function tH(t,e,i){var n=i.type,r=i.closed,a=e.slice(0).reverse(),o="",s="";if("line"===n&&i.smoothLink&&i.center){var l=t[0],u=a[0],c=i.center;o=VR(t,!!r),s=VR(a,!!r);var h=Si.distancePP(u,c),d=Si.distancePP(l,c);o+="A".concat(h,",").concat(h,",0,0,1,").concat(u.x,",").concat(u.y,"L").concat(u.x,",").concat(u.y),s+="A".concat(d,",").concat(d,",0,0,0,").concat(l.x,",").concat(l.y)}else if("circle"===n){var p=i.center;o=$z(p,t,!1,!!r),s=$z(p,a,!0,!!r)}else"line"!==n&&"polygon"!==n||(o=VR(t,!!r),s=VR(a,!!r));return r?o+=s:(o+=s="L"+s.substring(1),o+="Z"),o}Qz.defaultAttributes={pickable:!1};var eH=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="axis-grid",t.data=[],t}return h(e,t),o(e,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"render",value:function(){this._prevInnerView=this._innerView&&HR(this._innerView),this.removeAllChild(!0),this._innerView=B_.group({x:0,y:0,pickable:!1}),this.add(this._innerView);var t=this.attribute,e=t.items,i=t.visible;e&&e.length&&!1!==i&&(this.data=this._transformItems(e),this._renderGrid(this._innerView))}},{key:"getVerticalCoord",value:function(t,e,i){return NR(t,this.getVerticalVector(e,i,t))}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"_renderGrid",value:function(t){(this.attribute.subGrid||{}).visible&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}},{key:"_renderGridByType",value:function(t,i){var n=this,r=mt({},this.attribute,this.getGridAttribute(t)),a=r.type,o=r.items,s=r.style,l=r.closed,u=r.alternateColor,c=r.depth,h=void 0===c?0:c,d=t?"".concat(DR.grid,"-sub"):"".concat(DR.grid);if(o.forEach((function(t,r){var o=t.id,u=t.points,c="";if("line"===a||"polygon"===a)c=VR(u,!!l);else if("circle"===a){c=$z(n.attribute.center,u,!1,!!l)}var p=B_.path(Object.assign({path:c,z:h},U(s)?mt({},n.skipDefault?null:e.defaultAttributes.style,s(t,r)):s));p.name="".concat(d,"-line"),p.id=n._getNodeId("".concat(d,"-path-").concat(o)),i.add(p)})),h&&"line"===a&&o.forEach((function(t,r){var a=t.id,o=t.points,u=[];u.push(o[0]);var c=o[1].x-o[0].x,p=o[1].y-o[0].y,f=Math.sqrt(c*c+p*p),v=h/f;u.push({x:o[0].x+c*v,y:o[0].y+p*v});var g=VR(u,!!l),y=ii(u[0].x-u[1].x),m=ii(u[0].y-u[1].y),_=B_.path(Object.assign({path:g,z:0,alpha:y>m?(o[1].x-o[0].x>0?-1:1)*Qe/2:0,beta:y<m?-Qe/2:0,anchor3d:y>m?[u[0].x,0]:[0,u[0].y]},U(s)?mt({},n.skipDefault?null:e.defaultAttributes.style,s(t,r)):s));_.name="".concat(d,"-line"),_.id=n._getNodeId("".concat(d,"-path-").concat(a)),i.add(_)})),o.length>1&&u){var p=Z(u)?u:[u,"transparent"],f=function(t){return p[t%p.length]},v=this.attribute.items,g=v[0],y=v[v.length-1],m=!ie(g.value,0)&&!ie(y.value,0),_=!ie(g.value,1)&&!ie(y.value,1),b=[],x=g.value>y.value;(x&&_||!x&&m)&&b.push(this.getGridPointsByValue(x?1:0)),o.forEach((function(t){b.push(t.points)})),(x&&m||!x&&_)&&b.push(this.getGridPointsByValue(x?0:1));for(var k=0;k<b.length-1;k++){var S=tH(b[k],b[k+1],r),A=B_.path({path:S,fill:f(k)});A.name="".concat(d,"-region"),A.id=this._getNodeId("".concat(d,"-region-").concat(k)),i.add(A)}}}},{key:"_getNodeId",value:function(t){return"".concat(this.id,"-").concat(t)}},{key:"_parseTickSegment",value:function(){var t=1;return this.data.length>=2&&(t=this.data[1].value-this.data[0].value),t}},{key:"_getPointsOfSubGrid",value:function(t,e){var i=this,n=this.data.length,r=[];return n>=2&&this.data.forEach((function(n){var a=n.value;if(!e){var o=n.value-t/2;if(i.isInValidValue(o))return;a=o}r.push({value:a})})),r}},{key:"release",value:function(){_(e,"release",this,3)([]),this._prevInnerView=null,this._innerView=null}}])}($A);eH.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}},YB(),QB();var iH=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},eH.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"_getGridPoint",value:function(t,e){var i;if("line"===t){var n=this.attribute.length;i=[e,this.getVerticalCoord(e,n,!0)]}else if("circle"===t||"polygon"===t){var r=this.attribute,a=r.center,o=r.sides,s=void 0===o?6:o,l=r.startAngle,u=void 0===l?mP:l,c=r.endAngle,h=void 0===c?_P:c;i=jR(a,s,Si.distancePP(a,e),u,h)}return i}},{key:"getGridPointsByValue",value:function(t){var e=this.getTickCoord(t);return this._getGridPoint(this.attribute.type,e)}},{key:"getGridAttribute",value:function(t){var e,i=this,n=this.attribute,r=n.type,a=n.alignWithLabel,o=void 0===a||a,s=this._parseTickSegment(),l=[];if(t){var u=[],c=(e=mt({},this.attribute,this.attribute.subGrid)).count,h=void 0===c?4:c;if(this.data.length>=2){for(var d=this._getPointsOfSubGrid(s,o),p=0;p<d.length-1;p++){var f=d[p],v=d[p+1];u.push({id:"sub-".concat(p,"-0"),points:this.getGridPointsByValue(f.value),datum:{}});for(var g=0;g<h;g++){var y=(g+1)/(h+1),m=(1-y)*f.value+y*v.value;u.push({id:"sub-".concat(p,"-").concat(g+1),points:this.getGridPointsByValue(m),datum:{}})}p===d.length-2&&u.push({id:"sub-".concat(p,"-").concat(h+1),points:this.getGridPointsByValue(v.value),datum:{}})}l=u}}else{e=this.attribute;var _=[];this.data.forEach((function(t){var e=t.point;if(!o){var n=t.value-s/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}_.push({id:t.label,datum:t,points:i._getGridPoint(r,e)})})),l=_}return Object.assign(Object.assign({},e),{items:l})}}])}(eH);Tt(iH,lL);var nH=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};YB(),QB();var rH,aH,oH,sH=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},eH.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"getGridPointsByValue",value:function(t){var e=this.getTickCoord(t),i=this.attribute,n=i.radius,r=i.innerRadius,a=void 0===r?0:r;return[e,this.getVerticalCoord(e,n-a,!0)]}},{key:"getGridAttribute",value:function(t){var e,i=this,n=[],r=this.attribute,a=r.radius,o=r.innerRadius,s=void 0===o?0:o,l=r.startAngle,u=void 0===l?mP:l,c=r.endAngle,h=void 0===c?_P:c,d=r.center,p=r.subGrid,f=nH(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),v=(f||{}).alignWithLabel,g=void 0===v||v,y=a-s,m=this._parseTickSegment();if(t){e=mt({},f,p);var _=[],x=(p||{}).count,k=void 0===x?4:x,S=this.data.length;if(S>=2){for(var A=this._getPointsOfSubGrid(m,g),C=0;C<S;C++){var M=A[C],w=A[C+1];_.push({id:"sub-".concat(C,"-0"),points:[this.getTickCoord(M.value),this.getVerticalCoord(this.getTickCoord(M.value),y,!0)],datum:{}});for(var T=0;T<k;T++){var D=(T+1)/(k+1),E=(1-D)*M.value+D*(w?w.value:g?1:M.value+m),B=this.getTickCoord(E),P=this.getVerticalCoord(B,y,!0);_.push({id:"sub-".concat(C,"-").concat(T+1),points:[B,P],datum:{}})}}Math.abs(h-u)%(2*Math.PI)==0&&_.push(_[0]),n=_}}else{e=f;var R=[];(Math.abs(h-u)%(2*Math.PI)==0?b(this.data).concat(this.data[0]):this.data).forEach((function(t){var e=t.point;if(!g){var n=t.value-m/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}var r=i.getVerticalCoord(e,y,!0);R.push({id:t.id,points:[e,r],datum:t})})),n=R}return Object.assign(Object.assign({},e),{items:n,center:d,type:"line"})}}])}(eH);Tt(sH,jF),function(t){t.startHandler="startHandler",t.endHandler="endHandler",t.middleHandler="middleHandler",t.background="background"}(rH||(rH={})),function(t){t.stateUpdate="stateUpdate",t.maskUpdate="maskUpdate",t.dataZoomUpdate="dataZoomUpdate"}(aH||(aH={})),function(t){t.dataZoomChange="dataZoomChange"}(oH||(oH={}));var lH="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",uH={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:lH,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:lH,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}},cH={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}},hH=function(t,e,i,n){if(!e)return!1;if(n){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1},dH=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},pH=function(){return o((function t(e){r(this,t),this._previewData=[],this._statePointToData=function(t){return t};var i=e.attribute.showDetail;this._showText="auto"!==i&&i,this._initAttrs(e)}),[{key:"startHandlerMask",get:function(){return this._startHandlerMask}},{key:"middleHandlerSymbol",get:function(){return this._middleHandlerSymbol}},{key:"middleHandlerRect",get:function(){return this._middleHandlerRect}},{key:"endHandlerMask",get:function(){return this._endHandlerMask}},{key:"selectedBackground",get:function(){return this._selectedBackground}},{key:"dragMask",get:function(){return this._dragMask}},{key:"startText",get:function(){return this._startText}},{key:"endText",get:function(){return this._endText}},{key:"startValue",get:function(){return this._startValue}},{key:"endValue",get:function(){return this._endValue}},{key:"showText",set:function(t){this._showText=t}},{key:"background",get:function(){return this._background}},{key:"previewData",set:function(t){this._previewData=t}},{key:"previewGroup",get:function(){return this._previewGroup}},{key:"selectedPreviewGroup",get:function(){return this._selectedPreviewGroup}},{key:"previewPointsX",set:function(t){this._previewPointsX=t}},{key:"previewPointsY",set:function(t){this._previewPointsY=t}},{key:"previewPointsX1",set:function(t){this._previewPointsX1=t}},{key:"previewPointsY1",set:function(t){this._previewPointsY1=t}},{key:"statePointToData",set:function(t){this._statePointToData=t}},{key:"_initAttrs",value:function(t){this.attribute=t.attribute,this._isHorizontal="top"===this.attribute.orient||"bottom"===this.attribute.orient;var e=this.attribute,i=e.previewData,n=e.previewPointsX,r=e.previewPointsY,a=e.previewPointsX1,o=e.previewPointsY1;i&&(this._previewData=i),U(n)&&(this._previewPointsX=n),U(r)&&(this._previewPointsY=r),U(a)&&(this._previewPointsX1=a),U(o)&&(this._previewPointsY1=o),this._getState=t.getState,this._getLayoutAttrFromConfig=t.getLayoutAttrFromConfig,this._getContainer=t.getContainer}},{key:"setAttributes",value:function(t){this._initAttrs(t)}},{key:"renderDataZoom",value:function(){var t,e,i,n,r,a,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=this.attribute,l=s.backgroundChartStyle,u=void 0===l?{}:l,c=s.selectedBackgroundChartStyle,h=void 0===c?{}:c,d=s.brushSelect;this._renderBackground(),(null===(t=u.line)||void 0===t?void 0:t.visible)&&!o&&this._setPreviewAttributes("line",this._getContainer()),(null===(e=u.area)||void 0===e?void 0:e.visible)&&!o&&this._setPreviewAttributes("area",this._getContainer()),d&&this.renderDragMask(),this._renderSelectedBackground(),(null===(i=h.line)||void 0===i?void 0:i.visible)&&this._setSelectedPreviewClipAttributes("line",this._getContainer()),(null===(n=h.line)||void 0===n?void 0:n.visible)&&!o&&this._setSelectedPreviewAttributes("line"),(null===(r=h.line)||void 0===r?void 0:r.visible)&&this._setSelectedPreviewClipAttributes("area",this._getContainer()),(null===(a=h.area)||void 0===a?void 0:a.visible)&&!o&&this._setSelectedPreviewAttributes("area"),this._renderHandler(),this._showText&&this.renderText()}},{key:"renderDragMask",value:function(){var t=this.attribute.dragMaskStyle,e=this._getLayoutAttrFromConfig(),i=e.position,n=e.width,r=e.height,a=this._getState(),o=a.start,s=a.end;return this._isHorizontal?this._dragMask=this._getContainer().createOrUpdateChild("dragMask",Object.assign({x:i.x+o*n,y:i.y,width:(s-o)*n,height:r},t),"rect"):this._dragMask=this._getContainer().createOrUpdateChild("dragMask",Object.assign({x:i.x,y:i.y+o*r,width:n,height:(s-o)*r},t),"rect"),{start:o,end:s}}},{key:"_renderBackground",value:function(){var t,e=this.attribute,i=e.backgroundStyle,n=e.brushSelect,r=e.zoomLock,a=this._getLayoutAttrFromConfig(),o=a.position,s=a.width,l=a.height,u=this._getContainer();this._background=u.createOrUpdateChild("background",Object.assign(Object.assign({x:o.x,y:o.y,width:s,height:l,cursor:n?"crosshair":"auto"},i),{pickable:!r&&(null===(t=i.pickable)||void 0===t||t)}),"rect")}},{key:"_renderHandler",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,C,M,w=this.attribute,T=w.orient,D=w.middleHandlerStyle,E=void 0===D?{}:D,B=w.startHandlerStyle,P=void 0===B?{}:B,R=w.endHandlerStyle,L=void 0===R?{}:R,I=w.zoomLock,F=this._getState(),O=F.start,z=F.end,H=this._getLayoutAttrFromConfig(),N=H.position,U=H.width,j=H.height,V=null!==(t=P.triggerMinSize)&&void 0!==t?t:40,W=null!==(e=L.triggerMinSize)&&void 0!==e?e:40,G=this._getContainer();if(this._isHorizontal){if(E.visible){var Y=(null===(i=E.background)||void 0===i?void 0:i.size)||10;this._middleHandlerRect=G.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:N.x+O*U,y:N.y-Y,width:(z-O)*U,height:Y},null===(n=E.background)||void 0===n?void 0:n.style),{pickable:!I&&(null===(o=null===(a=null===(r=E.background)||void 0===r?void 0:r.style)||void 0===a?void 0:a.pickable)||void 0===o||o)}),"rect"),this._middleHandlerSymbol=G.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:N.x+(O+z)/2*U,y:N.y-Y/2,strokeBoundsBuffer:0,angle:0,symbolType:null!==(l=null===(s=E.icon)||void 0===s?void 0:s.symbolType)&&void 0!==l?l:"square"},E.icon),{pickable:!I&&(null===(u=E.icon.pickable)||void 0===u||u)}),"symbol")}this._startHandler=G.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:N.x+O*U,y:N.y+j/2,size:j,symbolType:null!==(c=P.symbolType)&&void 0!==c?c:"square"},cH.horizontal),P),{pickable:!I&&(null===(h=P.pickable)||void 0===h||h)}),"symbol"),this._endHandler=G.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:N.x+z*U,y:N.y+j/2,size:j,symbolType:null!==(d=L.symbolType)&&void 0!==d?d:"square"},cH.horizontal),L),{pickable:!I&&(null===(p=L.pickable)||void 0===p||p)}),"symbol");var X=Math.max(this._startHandler.AABBBounds.width(),V),K=Math.max(this._startHandler.AABBBounds.height(),V),q=Math.max(this._endHandler.AABBBounds.width(),W),Z=Math.max(this._endHandler.AABBBounds.height(),W);this._startHandlerMask=G.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:N.x+O*U-X/2,y:N.y+j/2-K/2,width:X,height:K,fill:"white",fillOpacity:0,zIndex:999},cH.horizontal),{pickable:!I}),"rect"),this._endHandlerMask=G.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:N.x+z*U-q/2,y:N.y+j/2-Z/2,width:q,height:Z,fill:"white",fillOpacity:0,zIndex:999},cH.horizontal),{pickable:!I}),"rect")}else{if(E.visible){var J=(null===(f=E.background)||void 0===f?void 0:f.size)||10;this._middleHandlerRect=G.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===T?N.x-J:N.x+U,y:N.y+O*j,width:J,height:(z-O)*j},null===(v=E.background)||void 0===v?void 0:v.style),{pickable:!I&&(null===(m=null===(y=null===(g=E.background)||void 0===g?void 0:g.style)||void 0===y?void 0:y.pickable)||void 0===m||m)}),"rect"),this._middleHandlerSymbol=G.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===T?N.x-J/2:N.x+U+J/2,y:N.y+(O+z)/2*j,angle:Math.PI/180*90,symbolType:null!==(b=null===(_=E.icon)||void 0===_?void 0:_.symbolType)&&void 0!==b?b:"square",strokeBoundsBuffer:0},E.icon),{pickable:!I&&(null===(k=null===(x=E.icon)||void 0===x?void 0:x.pickable)||void 0===k||k)}),"symbol")}this._startHandler=G.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:N.x+U/2,y:N.y+O*j,size:U,symbolType:null!==(S=P.symbolType)&&void 0!==S?S:"square"},cH.vertical),P),{pickable:!I&&(null===(A=P.pickable)||void 0===A||A)}),"symbol"),this._endHandler=G.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:N.x+U/2,y:N.y+z*j,size:U,symbolType:null!==(C=L.symbolType)&&void 0!==C?C:"square"},cH.vertical),L),{pickable:!I&&(null===(M=L.pickable)||void 0===M||M)}),"symbol");var Q=Math.max(this._startHandler.AABBBounds.width(),V),$=Math.max(this._startHandler.AABBBounds.height(),V),tt=Math.max(this._endHandler.AABBBounds.width(),W),et=Math.max(this._endHandler.AABBBounds.height(),W);this._startHandlerMask=G.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:N.x+U/2+Q/2,y:N.y+O*j-$/2,width:et,height:tt,fill:"white",fillOpacity:0,zIndex:999},cH.vertical),{pickable:!I}),"rect"),this._endHandlerMask=G.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:N.x+U/2+tt/2,y:N.y+z*j-et/2,width:et,height:tt,fill:"white",fillOpacity:0,zIndex:999},cH.vertical),{pickable:!I}),"rect")}}},{key:"_renderSelectedBackground",value:function(){var t,e,i=this.attribute,n=i.selectedBackgroundStyle,r=void 0===n?{}:n,a=i.selectedBackgroundChartStyle,o=void 0===a?{}:a,s=i.brushSelect,l=i.zoomLock,u=this._getState(),c=u.start,h=u.end,d=this._getLayoutAttrFromConfig(),p=d.position,f=d.width,v=d.height,g=this._getContainer();this._isHorizontal?this._selectedBackground=g.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:p.x+c*f,y:p.y,width:(h-c)*f,height:v,cursor:s?"crosshair":"move"},r),{pickable:!l&&(null===(t=o.pickable)||void 0===t||t)}),"rect"):this._selectedBackground=g.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:p.x,y:p.y+c*v,width:f,height:(h-c)*v,cursor:s?"crosshair":"move"},r),{pickable:!l&&(null===(e=r.pickable)||void 0===e||e)}),"rect")}},{key:"_setPreviewAttributes",value:function(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");var i=this.attribute.backgroundChartStyle,n=void 0===i?{}:i;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this._getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this._getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"_setSelectedPreviewClipAttributes",value:function(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group"));var i=this._getState(),n=i.start,r=i.end,a=this._getLayoutAttrFromConfig(),o=a.position,s=a.width,l=a.height;this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?o.x+n*s:o.x,y:this._isHorizontal?o.y:o.y+n*l,width:this._isHorizontal?(r-n)*s:s,height:this._isHorizontal?l:(r-n)*l,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?o.x+n*s:o.x),y:-(this._isHorizontal?o.y:o.y+n*l),width:this._isHorizontal?(r-n)*s:s,height:this._isHorizontal?l:(r-n)*l,pickable:!1})}},{key:"_setSelectedPreviewAttributes",value:function(t){var e=this.attribute.selectedBackgroundChartStyle,i=void 0===e?{}:e;"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area"),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this._getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this._getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}},{key:"_computeBasePoints",value:function(t){var e=this.attribute.orient,i="bottom"===e||"top"===e?"x":"y",n=Math.sign(t[t.length-1][i]-t[0][i]);0===n&&(n=1);var r,a,o=this._getLayoutAttrFromConfig(),s=o.position,l=o.width,u=o.height;return this._isHorizontal?(r=[{x:s.x,y:s.y+u}],a=[{x:s.x+l,y:s.y+u}]):"left"===e?(r=[{x:s.x+l,y:s.y}],a=[{x:s.x+l,y:s.y+u}]):(r=[{x:s.x,y:s.y+u}],a=[{x:s.x,y:s.y}]),Math.sign(a[0][i]-r[0][i])!==n?{basePointStart:a,basePointEnd:r}:{basePointStart:r,basePointEnd:a}}},{key:"_simplifyPoints",value:function(t){var e;return t.length>1e4?function(t,e,i){return t.length<=10||i?t:function(t,e){for(var i,n,r=t[0].x,a=t[0].y,o=[t[0]],s=1,l=t.length;s<l;s++)(i=t[s].x-r)*i+(n=t[s].y-a)*n>e&&(r=t[s].x,a=t[s].y,o.push(t[s]));return t[t.length-1].x===r&&t[t.length-1].y===a||o.push(t[t.length-1]),o}(t,void 0!==e?e*e:1)}(t,null!==(e=this.attribute.tolerance)&&void 0!==e?e:this._previewData.length/1e4,!1):t}},{key:"_getPreviewLinePoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e)}}));if(0===e.length)return e;e=this._simplifyPoints(e);var i=this._computeBasePoints(e),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"_getPreviewAreaPoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e),x1:t._previewPointsX1&&t._previewPointsX1(e),y1:t._previewPointsY1&&t._previewPointsY1(e)}}));if(0===e.length)return e;e=this._simplifyPoints(e);var i=this._computeBasePoints(e),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"renderText",value:function(){var t=null,e=null;if(this._setTextAttr(t,e),this._showText){t=this._startText.AABBBounds,e=this._endText.AABBBounds,this._setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;var i=t,n=i.x1,r=i.x2,a=i.y1,o=i.y2,s=this.attribute.startTextStyle,l=s.dx,u=void 0===l?0:l,c=s.dy,h=void 0===c?0:c;if((new Fn).set(n,a,r,o).intersects(e)){var d="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;this._isHorizontal?this._startText.setAttribute("dy",h+d*Math.abs(e.y1-e.y2)):this._startText.setAttribute("dx",u+d*Math.abs(e.x1-e.x2))}else this._isHorizontal?this._startText.setAttribute("dy",h):this._startText.setAttribute("dx",u)}}},{key:"_setTextAttr",value:function(t,e){var i,n,r,a,o,s,l,u,c=this.attribute,h=c.startTextStyle,d=c.endTextStyle,p=h.formatMethod,f=dH(h,["formatMethod"]),v=d.formatMethod,g=dH(d,["formatMethod"]),y=this._getState(),m=y.start,_=y.end;this._startValue=this._statePointToData(m),this._endValue=this._statePointToData(_);var b,x,k,S,A=this._getLayoutAttrFromConfig(),C=A.position,M=A.width,w=A.height,T=p?p(this._startValue):this._startValue,D=v?v(this._endValue):this._endValue,E={x1:C.x,y1:C.y,x2:C.x+M,y2:C.y+w};this._isHorizontal?(b={x:C.x+m*M,y:C.y+w/2},x={x:C.x+_*M,y:C.y+w/2},k={textAlign:hH(E,t,"start",this._isHorizontal)?"left":"right",textBaseline:null!==(n=null===(i=null==f?void 0:f.textStyle)||void 0===i?void 0:i.textBaseline)&&void 0!==n?n:"middle"},S={textAlign:hH(E,e,"end",this._isHorizontal)?"right":"left",textBaseline:null!==(a=null===(r=null==g?void 0:g.textStyle)||void 0===r?void 0:r.textBaseline)&&void 0!==a?a:"middle"}):(b={x:C.x+M/2,y:C.y+m*w},x={x:C.x+M/2,y:C.y+_*w},k={textAlign:null!==(s=null===(o=null==f?void 0:f.textStyle)||void 0===o?void 0:o.textAlign)&&void 0!==s?s:"center",textBaseline:hH(E,t,"start",this._isHorizontal)?"top":"bottom"},S={textAlign:null!==(u=null===(l=null==g?void 0:g.textStyle)||void 0===l?void 0:l.textAlign)&&void 0!==u?u:"center",textBaseline:hH(E,e,"end",this._isHorizontal)?"bottom":"top"}),this._startText=this._maybeAddLabel(this._getContainer(),mt({},f,{text:T,x:b.x,y:b.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:k}),"data-zoom-start-text"),this._endText=this._maybeAddLabel(this._getContainer(),mt({},g,{text:D,x:x.x,y:x.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:S}),"data-zoom-end-text")}},{key:"_maybeAddLabel",value:function(t,e,i){var n=t.find((function(t){return t.name===i}),!0);return n?n.setAttributes(e):((n=new iR(e)).name=i,t.add(n)),n}}])}(),fH={debounce:ve,throttle:ge},vH=function(t){function e(t){var i;return r(this,e),(i=n(this,e))._activeState=!1,i._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},i._layoutCache={attPos:"x",attSize:"width",size:0},i._handleTouchMove=function(t){i._activeState&&t.preventDefault()},i._onHandlerPointerDown=function(t,e){i.clearDragEvents(),"start"===e?(i._activeTag=rH.startHandler,i._activeItem=i._startHandlerMask):"end"===e?(i._activeTag=rH.endHandler,i._activeItem=i._endHandlerMask):"middleRect"===e?(i._activeTag=rH.middleHandler,i._activeItem=i._middleHandlerRect):"middleSymbol"===e?(i._activeTag=rH.middleHandler,i._activeItem=i._middleHandlerSymbol):"background"===e&&(i._activeTag=rH.background,i._activeItem=i._background),i._activeState=!0,i._activeCache.startPos=i._eventPosToStagePos(t),i._activeCache.lastPos=i._eventPosToStagePos(t);var n="browser"===tS.env?tS:i.stage,r=AP();n.addEventListener("pointermove",i._onHandlerPointerMove,{capture:!0}),i.on("pointermove",i._onHandlerPointerMove,{capture:!0}),r.forEach((function(t){n.addEventListener(t,i._onHandlerPointerUp)}))},i._pointerMove=function(t){var e,n,r,a,o=i.attribute.brushSelect,s=i._getLayoutAttrFromConfig().position,l=i._eventPosToStagePos(t),u=i._layoutCache,c=u.attPos,h=u.size,d=u.attSize,p=(l[c]-i._activeCache.lastPos[c])/h,f=(l[c]-s[c])/i._getLayoutAttrFromConfig()[d],v=i._getState(),g=v.start,y=v.end,m=!0;i._activeState&&(i._activeTag===rH.middleHandler?(g=(e=i._moveZoomWithMiddle(p)).start,y=e.end):i._activeTag===rH.startHandler?(g=(n=i._moveZoomWithHandler(f,"start")).start,y=n.end):i._activeTag===rH.endHandler?(g=(r=i._moveZoomWithHandler(f,"end")).start,y=r.end):i._activeTag===rH.background&&o&&(g=(a=i._moveZoomWithBackground(f)).start,y=a.end,m=!1,i._dispatchEvent(aH.maskUpdate)),i._activeCache.lastPos=l),i._getState().start===g&&i._getState().end===y||(i._setStateAttr(g,y),i._dispatchEvent(aH.stateUpdate,{start:i._getState().start,end:i._getState().end,shouldRender:m,tag:i._activeTag}),i.attribute.realTime&&i._dispatchEvent(aH.dataZoomUpdate,{start:i._getState().start,end:i._getState().end,shouldRender:!0,tag:i._activeTag}))},i._onHandlerPointerUp=function(t){i._activeState&&i._activeTag===rH.background&&(i._setStateAttr(i._getState().start,i._getState().end),i._dispatchEvent(aH.stateUpdate,{start:i._getState().start,end:i._getState().end,shouldRender:!0,tag:i._activeTag})),i._activeState=!1,i._dispatchEvent(aH.dataZoomUpdate,{start:i._getState().start,end:i._getState().end,shouldRender:!0,tag:i._activeTag}),i.clearDragEvents()},i._initAttrs(t),i}return h(e,t),o(e,[{key:"setAttributes",value:function(t){var e,i,n,r,a,o;this._initAttrs(t),this._onHandlerPointerMove=0===(null!==(i=null===(e=this.attribute)||void 0===e?void 0:e.delayTime)&&void 0!==i?i:0)?this._pointerMove:fH[null!==(r=null===(n=this.attribute)||void 0===n?void 0:n.delayType)&&void 0!==r?r:"debounce"](this._pointerMove,null!==(o=null===(a=this.attribute)||void 0===a?void 0:a.delayTime)&&void 0!==o?o:0)}},{key:"_initAttrs",value:function(t){this.stage=t.stage,this.attribute=t.attribute,this._startHandlerMask=t.startHandlerMask,this._endHandlerMask=t.endHandlerMask,this._middleHandlerSymbol=t.middleHandlerSymbol,this._middleHandlerRect=t.middleHandlerRect,this._selectedBackground=t.selectedBackground,this._background=t.background,this._previewGroup=t.previewGroup,this._selectedPreviewGroup=t.selectedPreviewGroup,this._getLayoutAttrFromConfig=t.getLayoutAttrFromConfig,this._getState=t.getState,this._setState=t.setState;var e=this._getLayoutAttrFromConfig(),i=e.width,n=e.height;this._spanCache=this._getState().end-this._getState().start;var r="top"===this.attribute.orient||"bottom"===this.attribute.orient;this._layoutCache.size=r?i:n,this._layoutCache.attPos=r?"x":"y",this._layoutCache.attSize=r?"width":"height",this._getGlobalTransMatrix=t.getGlobalTransMatrix}},{key:"clearDragEvents",value:function(){var t=this,e="browser"===tS.env?tS:this.stage,i=AP();e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),i.forEach((function(i){e.removeEventListener(i,t._onHandlerPointerUp)})),this.off("pointermove",this._onHandlerPointerMove,{capture:!0})}},{key:"clearVGlobalEvents",value:function(){("browser"===tS.env?tS:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}},{key:"bindEvents",value:function(){var t,e,i,n,r,a,o,s,l=this,u=this.attribute.brushSelect;null===(t=this._startHandlerMask)||void 0===t||t.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,"start")})),null===(e=this._endHandlerMask)||void 0===e||e.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,"end")})),null===(i=this._middleHandlerSymbol)||void 0===i||i.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,"middleSymbol")})),null===(n=this._middleHandlerRect)||void 0===n||n.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,"middleRect")}));var c=u?"background":"middleRect";null===(r=this._selectedBackground)||void 0===r||r.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,c)})),u&&(null===(a=this._background)||void 0===a||a.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,"background")}))),u&&(null===(o=this._previewGroup)||void 0===o||o.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,"background")}))),null===(s=this._selectedPreviewGroup)||void 0===s||s.addEventListener("pointerdown",(function(t){return l._onHandlerPointerDown(t,c)})),("browser"===tS.env?tS:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}},{key:"_setStateAttr",value:function(t,e){var i=this.attribute,n=i.zoomLock,r=void 0!==n&&n,a=i.minSpan,o=void 0===a?0:a,s=i.maxSpan,l=void 0===s?1:s,u=e-t;u!==this._spanCache&&(r||u<o||u>l)||(this._spanCache=u,this._setState({start:t,end:e}))}},{key:"_moveZoomWithMiddle",value:function(t){var e=this._getState(),i=e.start,n=e.end;return t>0&&n+t>1?t=1-n:t<0&&i+t<0&&(t=-i),{start:he(i+t,0,1),end:he(n+t,0,1)}}},{key:"_moveZoomWithHandler",value:function(t,e){var i=this._getState(),n=i.start,r=i.end,a=n,o=r;return"start"===e?t>r?(a=r,o=t,this._activeTag=rH.endHandler):a=t:"end"===e&&(t<n?(o=n,a=t,this._activeTag=rH.startHandler):o=t),{start:he(a,0,1),end:he(o,0,1)}}},{key:"_moveZoomWithBackground",value:function(t){var e,i=this._getLayoutAttrFromConfig().position,n=this._layoutCache.attSize,r=(this._activeCache.startPos[this._layoutCache.attPos]-i[this._layoutCache.attPos])/this._getLayoutAttrFromConfig()[n],a=t,o=he(r,0,1),s=he(a,0,1);return o>s&&(o=(e=[s,o])[0],s=e[1]),{start:o,end:s}}},{key:"_eventPosToStagePos",value:function(t){var e,i,n={x:0,y:0},r=null!==(i=null===(e=this.stage)||void 0===e?void 0:e.eventPointTransform(t))&&void 0!==i?i:{x:0,y:0};return this._getGlobalTransMatrix().transformPoint(r,n),n}},{key:"_dispatchEvent",value:function(t,e){this.emit(t,e)}}])}(z);tR(),rP(),dP(),NB(),ZB();var gH,yH,mH,_H,bH=function(t){function e(t,i){var a;r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="dataZoom",a._state={start:0,end:1},a.getLayoutAttrFromConfig=function(){var t,e,i,n,r,o;if(a._layoutCacheFromConfig)return a._layoutCacheFromConfig;var s,l,u,c=a.attribute,h=c.position,d=c.size,p=c.orient,f=c.middleHandlerStyle,v=void 0===f?{}:f,g=c.startHandlerStyle,y=void 0===g?{}:g,m=c.endHandlerStyle,_=void 0===m?{}:m,b=c.backgroundStyle,x=void 0===b?{}:b,k=d.width,S=d.height,A=null!==(e=null===(t=v.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10;v.visible?a._isHorizontal?(s=k,l=S-A,u={x:h.x,y:h.y+A}):(s=k-A,l=S,u={x:h.x+("left"===p?A:0),y:h.y}):(s=k,l=S,u=h);var C=null!==(i=y.size)&&void 0!==i?i:a._isHorizontal?l:s,M=null!==(n=_.size)&&void 0!==n?n:a._isHorizontal?l:s;return y.visible&&(a._isHorizontal?(s-=(C+M)/2,u={x:u.x+C/2,y:u.y}):(l-=(C+M)/2,u={x:u.x,y:u.y+C/2})),l+=(null!==(r=x.lineWidth)&&void 0!==r?r:2)/2,s+=(null!==(o=x.lineWidth)&&void 0!==o?o:2)/2,a._layoutCacheFromConfig={position:u,width:s,height:l},a._layoutCacheFromConfig};var o=a.attribute,s=o.start,l=o.end,u=o.orient;return a._isHorizontal="top"===u||"bottom"===u,s&&(a._state.start=s),l&&(a._state.end=l),a._renderer=new pH(a._getRendererAttrs()),a._interaction=new vH(a._getInteractionAttrs()),a}return h(e,t),o(e,[{key:"_getRendererAttrs",value:function(){var t=this;return{attribute:this.attribute,getLayoutAttrFromConfig:this.getLayoutAttrFromConfig,setState:function(e){t._state=e},getState:function(){return t._state},getContainer:function(){return t._container}}}},{key:"_getInteractionAttrs",value:function(){var t=this;return{stage:this.stage,attribute:this.attribute,startHandlerMask:this._renderer.startHandlerMask,endHandlerMask:this._renderer.endHandlerMask,middleHandlerSymbol:this._renderer.middleHandlerSymbol,middleHandlerRect:this._renderer.middleHandlerRect,selectedBackground:this._renderer.selectedBackground,background:this._renderer.background,previewGroup:this._renderer.previewGroup,selectedPreviewGroup:this._renderer.selectedPreviewGroup,getLayoutAttrFromConfig:this.getLayoutAttrFromConfig,setState:function(e){t._state=e},getState:function(){return t._state},getGlobalTransMatrix:function(){return t.globalTransMatrix}}}},{key:"bindEvents",value:function(){var t=this;this.attribute.disableTriggerEvent?this.setAttribute("childrenPickable",!1):(this._interaction.bindEvents(),this._interaction.on(aH.stateUpdate,(function(e){e.shouldRender&&t._renderer.renderDataZoom(!0)})),this._interaction.on(aH.dataZoomUpdate,(function(e){var i=e.start,n=e.end,r=e.tag;t._dispatchEvent(oH.dataZoomChange,{start:i,end:n,tag:r})})),this._interaction.on(aH.maskUpdate,(function(){t._renderer.renderDragMask()})),"auto"===this.attribute.showDetail&&(this._container.addEventListener("pointerenter",(function(){t._renderer.showText=!0,t._renderer.renderText()})),this._container.addEventListener("pointerleave",(function(){t._renderer.showText=!1,t._renderer.renderText()}))))}},{key:"setAttributes",value:function(t,i){var n,r,a=this.attribute,o=a.start,s=a.end;o&&(this._state.start=null!==(n=t.start)&&void 0!==n?n:o),s&&(this._state.end=null!==(r=t.end)&&void 0!==r?r:s),this._renderer.setAttributes(this._getRendererAttrs()),this._interaction.setAttributes(this._getInteractionAttrs()),_(e,"setAttributes",this,3)([t,i])}},{key:"render",value:function(){this._layoutCacheFromConfig=null,this._container=this.createOrUpdateChild("datazoom-container",{},"group"),this._renderer.renderDataZoom(),this._interaction.setAttributes(this._getInteractionAttrs())}},{key:"release",value:function(t){_(e,"release",this,3)([t]),this._interaction.clearDragEvents()}},{key:"setStartAndEnd",value:function(t,e){var i=this._state,n=i.start,r=i.end;W(t)&&W(e)&&(t!==n||e!==r)&&(this._state={start:t,end:e},this._renderer.renderDataZoom(!0),this._dispatchEvent(oH.dataZoomChange,{start:t,end:e}))}},{key:"setPreviewData",value:function(t){this._renderer.previewData=t}},{key:"setText",value:function(t,e){"start"===e?this._renderer.startText.setAttribute("text",t):this._renderer.endText.setAttribute("text",t)}},{key:"getStartValue",value:function(){return this._renderer.startValue}},{key:"getEndTextValue",value:function(){return this._renderer.endValue}},{key:"getMiddleHandlerSize",value:function(){var t,e,i,n,r=this.attribute.middleHandlerStyle,a=void 0===r?{}:r,o=null!==(e=null===(t=a.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10,s=null!==(n=null===(i=a.icon)||void 0===i?void 0:i.size)&&void 0!==n?n:10;return Math.max.apply(Math,[o].concat(b(Dt(s))))}},{key:"setPreviewPointsX",value:function(t){U(t)&&(this._renderer.previewPointsX=t)}},{key:"setPreviewPointsY",value:function(t){U(t)&&(this._renderer.previewPointsY=t)}},{key:"setPreviewPointsX1",value:function(t){U(t)&&(this._renderer.previewPointsX1=t)}},{key:"setPreviewPointsY1",value:function(t){U(t)&&(this._renderer.previewPointsY1=t)}},{key:"setStatePointToData",value:function(t){U(t)&&(this._renderer.statePointToData=t)}}])}($A);function xH(){YB(),tR(),HL()}bH.defaultAttributes=uH,function(t){t.start="start",t.startTop="startTop",t.startBottom="startBottom",t.insideStart="insideStart",t.insideStartTop="insideStartTop",t.insideStartBottom="insideStartBottom",t.middle="middle",t.insideMiddleTop="insideMiddleTop",t.insideMiddleBottom="insideMiddleBottom",t.end="end",t.endTop="endTop",t.endBottom="endBottom",t.insideEnd="insideEnd",t.insideEndTop="insideEndTop",t.insideEndBottom="insideEndBottom"}(gH||(gH={})),function(t){t.left="left",t.right="right",t.top="top",t.bottom="bottom",t.topLeft="topLeft",t.topRight="topRight",t.bottomLeft="bottomLeft",t.bottomRight="bottomRight",t.middle="middle",t.insideLeft="insideLeft",t.insideRight="insideRight",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideTopLeft="insideTopLeft",t.insideTopRight="insideTopRight",t.insideBottomLeft="insideBottomLeft",t.insideBottomRight="insideBottomRight"}(yH||(yH={})),function(t){t.arcInnerStart="arcInnerStart",t.arcInnerEnd="arcInnerEnd",t.arcInnerMiddle="arcInnerMiddle",t.arcOuterStart="arcOuterStart",t.arcOuterEnd="arcOuterEnd",t.arcOuterMiddle="arcOuterMiddle",t.center="center"}(mH||(mH={})),function(t){t.top="top",t.bottom="bottom",t.middle="middle",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideMiddle="insideMiddle"}(_H||(_H={}));var kH=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="marker",t._onHover=function(e){t._lastHover=YR(e,t._container,t._lastHover)},t._onUnHover=function(e){t._lastHover=XR(0,t._container,t._lastHover)},t._onClick=function(e){t._lastSelect=KR(e,t._container,t._lastSelect)},t}return h(e,t),o(e,[{key:"transAnimationConfig",value:function(){var t,e,i;if(!1!==this.attribute.animation){var n=G(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:mt({},this.defaultUpdateAnimation,n,null!==(t=this.attribute.animationEnter)&&void 0!==t?t:{}),exit:mt({},this.defaultExitAnimation,n,null!==(e=this.attribute.animationExit)&&void 0!==e?e:{}),update:mt({},this.defaultUpdateAnimation,n,null!==(i=this.attribute.animationUpdate)&&void 0!==i?i:{})}}}},{key:"setAttribute",value:function(t,i,n){_(e,"setAttribute",this,3)([t,i,n]),"visible"===t&&this.render()}},{key:"_bindEvent",value:function(){var t,e,i;if(this.attribute.interactive){var n=this.attribute,r=n.hover,a=n.select;r&&(null===(t=this._container)||void 0===t||t.addEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.addEventListener("pointerout",this._onUnHover)),a&&(null===(i=this._container)||void 0===i||i.addEventListener("pointerdown",this._onClick))}}},{key:"_releaseEvent",value:function(){var t,e,i;null===(t=this._container)||void 0===t||t.removeEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.removeEventListener("pointerout",this._onUnHover),null===(i=this._container)||void 0===i||i.removeEventListener("pointerdown",this._onClick)}},{key:"_initContainer",value:function(){var t,e,i,n=this.attribute,r=n.limitRect,a=void 0===r?{}:r;if(n.clipInRange){var o=B_.group(Object.assign(Object.assign({},a),{clip:!0,pickable:!1}));i=B_.group({x:-(null!==(t=a.x)&&void 0!==t?t:0),y:-(null!==(e=a.y)&&void 0!==e?e:0),pickable:!1}),o.add(i),this._containerClip=o,this.add(o)}else i=B_.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}},{key:"_updateContainer",value:function(){var t,e,i=this.attribute,n=i.limitRect,r=void 0===n?{}:n,a=i.clipInRange;this._containerClip&&this._containerClip.setAttributes(Object.assign({},r)),this._container.setAttributes({x:a?-(null!==(t=r.x)&&void 0!==t?t:0):0,y:a?-(null!==(e=r.y)&&void 0!==e?e:0):0})}},{key:"render",value:function(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);var e=null===(t=this.attribute.visible)||void 0===t||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}},{key:"release",value:function(){this.markerAnimate("exit"),_(e,"release",this,3)([]),this._releaseEvent(),this._container=null}}])}($A);function SH(t,e,i,n){var r,a,o,s,l;if(t){null===(r=null==t?void 0:t.animates)||void 0===r||r.forEach((function(t){return t.stop("end")}));var u=null!==(o=null===(a=t.attribute)||void 0===a?void 0:a.fillOpacity)&&void 0!==o?o:1,c=null!==(l=null===(s=t.attribute)||void 0===s?void 0:s.strokeOpacity)&&void 0!==l?l:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:u,strokeOpacity:c},i,n)}}function AH(t,e,i,n){t&&(SH(t.startSymbol,e,i,n),t.lines.forEach((function(t){return SH(t,e,i,n)})),SH(t.line,e,i,n),SH(t.endSymbol,e,i,n))}function CH(t,e,i,n){t&&(SH(t.getTextShape(),e,i,n),SH(t.getBgRect(),e,i,n))}function MH(t,e,i,n){var r,a,o,s;t&&(t.setAttributes({fillOpacity:null!==(a=null===(r=t.attribute)||void 0===r?void 0:r.fillOpacity)&&void 0!==a?a:1,strokeOpacity:null!==(s=null===(o=t.attribute)||void 0===o?void 0:o.strokeOpacity)&&void 0!==s?s:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,n))}function wH(t,e,i,n){t&&(MH(t.startSymbol,e,i,n),t.lines.forEach((function(t){return MH(t,e,i,n)})),MH(t.line,e,i,n),MH(t.endSymbol,e,i,n))}function TH(t,e,i,n){t&&(MH(t.getTextShape(),e,i,n),MH(t.getBgRect(),e,i,n))}function DH(t,e,i,n,r){var a=.1*i,o=.7*i,s=.1*i,l=.1*i;SH(t.startSymbol,n,a,r),t.lines.forEach((function(t){return t.setAttribute("clipRange",0)})),t.lines.forEach((function(e,i){var s=o/t.lines.length;e.animate().wait(n+a+i*s).to({clipRange:1},s,r)})),SH(t.endSymbol,n+a+o,s,r),Dt(e).forEach((function(t){var e=n+a+o+s;SH(t.getTextShape(),e,l,r),SH(t.getBgRect(),e,l,r)}))}function EH(t,e,i,n,r){AH(t,n,i,r),Dt(e).forEach((function(t){CH(t,n,i,r)}))}function BH(t,e,i,n,r){SH(t,n,i,r),Dt(e).forEach((function(t){CH(t,n,i,r)}))}function PH(t,e,i,n,r){SH(t,n,i,r),Dt(e).forEach((function(t){CH(t,n,i,r)}))}function RH(t,e,i,n,r,a){var o;AH(t,r,n,a),SH(e,r,n,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?CH(i,r,n,a):SH(i,r,n,a)}function LH(t,e,i,n,r,a){var o,s=.1*n,l=.65*n,u=.05*n,c=.1*n,h=.1*n;SH(t.startSymbol,r,s,a),t.lines.forEach((function(t){return t.setAttribute("clipRange",0)})),t.lines.forEach((function(e,i){var n=l/t.lines.length;e.animate().wait(r+s+i*n).to({clipRange:1},n,a)})),SH(e,r+s+l,u,a),SH(t.endSymbol,r+s+l+u,c,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?(SH(i.getTextShape(),r+s+l+u+c,h,a),SH(i.getBgRect(),r+s+l+c,h,a)):SH(i,r+s+l+c,h,a)}function IH(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"clipIn"===s?DH(t,e,l,u,c):"fadeIn"===s&&EH(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"clipIn"===h?DH(t,e,d,p,f):"fadeIn"===h&&EH(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){wH(t,n,i,r),Dt(e).forEach((function(t){TH(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function FH(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"fadeIn"===s&&BH(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"fadeIn"===h&&BH(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){MH(t,n,i,r),Dt(e).forEach((function(t){TH(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function OH(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"fadeIn"===s&&PH(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"fadeIn"===h&&PH(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){MH(t,n,i,r),Dt(e).forEach((function(t){TH(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function zH(t,e,i,n){var r=m(t,2),a=r[0],o=r[1],s=i.enter,l=i.update,u=i.exit;if("enter"===n){var c=s.type,h=s.duration,d=s.delay,p=s.easing;"fadeIn"===c?RH(a,o,e,h,d,p):"callIn"===c&&LH(a,o,e,h,d,p)}else if("update"===n){var f=l.type,v=l.duration,g=l.delay,y=l.easing;"fadeIn"===f?RH(a,o,e,v,g,y):"callIn"===f&&LH(a,o,e,v,g,y)}else if("exit"===n){!function(t,e,i,n,r,a){var o;wH(t,r,n,a),MH(e,r,n,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?TH(i,r,n,a):MH(i,r,n,a)}(a,o,e,u.duration,u.delay,u.easing)}}var HH={type:"clipIn",duration:500,easing:"linear",delay:0},NH={type:"fadeIn",duration:500,easing:"linear",delay:0},UH={type:"callIn",duration:500,easing:"linear",delay:0},jH={type:"fadeOut",duration:500,easing:"linear",delay:0},VH=function(){return o((function t(){r(this,t)}),[{key:"getLabel",value:function(){return this._label}},{key:"_addMarkLabels",value:function(t,e,i){var n=this,r=this.attribute,a=r.label,o=r.state,s=Dt(null==o?void 0:o.label),l=Dt(null==o?void 0:o.labelBackground),u=Dt(a).map((function(r,a){var o,u,c=mt({},i,r),h=new iR(Object.assign(Object.assign({},c),{state:{panel:mt({},xP,null!==(o=l[a])&&void 0!==o?o:Et(l)),text:mt({},xP,null!==(u=s[a])&&void 0!==u?u:Et(s))}}));return h.name=e,t.add(h),n.setLabelPos(h,c),h}));this._label=1===Dt(u).length?u[0]:u}},{key:"_updateMarkLabels",value:function(t){var e=this,i=this.attribute,n=i.label,r=i.state,a=Dt(this._label),o=Dt(null==r?void 0:r.label),s=Dt(null==r?void 0:r.labelBackground);if(a.length){var l=Dt(n);a.forEach((function(i,n){var r,a,u=mt({},t,l[n]);i.setAttributes(Object.assign(Object.assign({dx:0,dy:0},u),{state:{panel:mt({},xP,null!==(r=s[n])&&void 0!==r?r:Et(s)),text:mt({},xP,null!==(a=o[n])&&void 0!==a?a:Et(o))}})),e.setLabelPos(i,u)}))}}}])}(),WH=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="markCommonLine",t.defaultUpdateAnimation=HH,t.defaultExitAnimation=jH,t}return h(e,t),o(e,[{key:"getLine",value:function(){return this._line}},{key:"setLabelPos",value:function(t,e){var i=this.attribute.limitRect,n=e.position,r=e.confine,a=e.autoRotate,o=this.getPointAttrByPosition(n,e),s=n.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(t.setAttributes(Object.assign(Object.assign({},o.position),{angle:a?this.getRotateByAngle(o.angle,e):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(n,s,a)),e.textStyle)})),i&&r){var l=i.x,u=i.y;$P(t,{x1:l,y1:u,x2:l+i.width,y2:u+i.height})}}},{key:"initMarker",value:function(t){var e=this.createSegment();e.name="mark-common-line-line",this._line=e,t.add(e),this.addMarkLineLabels(t)}},{key:"updateMarker",value:function(){this.setLineAttributes(),this.updateMarkLineLabels()}}])}(kH);Tt(WH,VH);var GH=.001,YH={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:gH.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},XH={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},KH={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{autoRotate:!0,position:mH.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},qH={interactive:!0,label:{position:yH.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},ZH={interactive:!0,label:{autoRotate:!0,position:mH.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},JH={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},QH={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},$H={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function tN(){eN._animate=IH}xH(),MR(),HL();var eN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="markLine",a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._line,this._label,this._animationConfig,t)}},{key:"getPointAttrByPosition",value:function(t,e){var i,n=e.refX,r=void 0===n?0:n,a=e.refY,o=void 0===a?0:a,s=this._line.getMainSegmentPoints(),l=null!==(i=this._line.getEndAngle())&&void 0!==i?i:0,u=r*Math.cos(l)+o*Math.cos(l-Math.PI/2),c=r*Math.sin(l)+o*Math.sin(l-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:s[0].x+u,y:s[0].y+c},angle:l}:t.includes("middle")||t.includes("Middle")?{position:{x:(s[0].x+s[s.length-1].x)/2+u,y:(s[0].y+s[s.length-1].y)/2+c},angle:l}:{position:{x:s[s.length-1].x+u,y:s[s.length-1].y+c},angle:l}}},{key:"getRotateByAngle",value:function(t,e){var i;return(RP(t)?t:t-Math.PI)+(null!==(i=e.refAngle)&&void 0!==i?i:0)}},{key:"getTextStyle",value:function(t,e,i){return LP(Math.abs(e),Math.PI/2,GH)||LP(Math.abs(e),3*Math.PI/2,GH)?IP(i,e,t):RP(e)?XH.postiveXAxis[t]:XH.negativeXAxis[t]}},{key:"createSegment",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.lineStyle,a=t.mainSegmentIndex,o=t.multiSegment,s=t.state;return new TR({points:e,startSymbol:i,endSymbol:n,lineStyle:r,mainSegmentIndex:a,multiSegment:o,pickable:!1,state:{line:mt({},xP,null==s?void 0:s.line),startSymbol:mt({},xP,null==s?void 0:s.lineStartSymbol),endSymbol:mt({},xP,null==s?void 0:s.lineEndSymbol)}})}},{key:"setLineAttributes",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.lineStyle,a=t.mainSegmentIndex,o=t.multiSegment,s=t.state;this._line&&this._line.setAttributes({points:e,startSymbol:i,endSymbol:n,lineStyle:r,mainSegmentIndex:a,multiSegment:o,state:{line:mt({},xP,null==s?void 0:s.line),startSymbol:mt({},xP,null==s?void 0:s.lineStartSymbol),endSymbol:mt({},xP,null==s?void 0:s.lineEndSymbol)}})}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<2)return!1;var e=!0;return t.forEach((function(t){if(t.length)t.forEach((function(t){it(t.x)&&it(t.y)||(e=!1)}));else if(!it(t.x)||!it(t.y))return void(e=!1)})),e}},{key:"addMarkLineLabels",value:function(t){this._addMarkLabels(t,"mark-common-line-label",e.defaultAttributes.label)}},{key:"updateMarkLineLabels",value:function(){this._updateMarkLabels(e.defaultAttributes.label)}}])}(WH);function iN(){nN._animate=FH}eN.defaultAttributes=YH,xH(),tP(),HL();var nN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="markArea",a.defaultUpdateAnimation=NH,a.defaultExitAnimation=jH,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._area,this._label,this._animationConfig,t)}},{key:"getArea",value:function(){return this._area}},{key:"getPointAttrByPosition",value:function(t){var e=this._area.AABBBounds,i=e.x1,n=e.x2,r=e.y1,a=e.y2,o={x:(i+n)/2,y:(r+a)/2};return(t.includes("left")||t.includes("Left"))&&(o.x=i),(t.includes("right")||t.includes("Right"))&&(o.x=n),(t.includes("top")||t.includes("Top"))&&(o.y=r),(t.includes("bottom")||t.includes("Bottom"))&&(o.y=a),o}},{key:"setLabelPos",value:function(t,e){var i;if(this._area){var n=null!==(i=e.position)&&void 0!==i?i:"middle",r=this.getPointAttrByPosition(n);if(t.setAttributes(Object.assign(Object.assign({},r),{textStyle:Object.assign(Object.assign({},QH[n]),e.textStyle)})),this.attribute.limitRect&&e.confine){var a=this.attribute.limitRect,o=a.x,s=a.y;$P(t,{x1:o,y1:s,x2:o+a.width,y2:s+a.height})}}}},{key:"initMarker",value:function(t){var i=this.attribute,n=i.points,r=i.areaStyle,a=i.state,o=B_.polygon(Object.assign({points:n},r));o.states=mt({},xP,null==a?void 0:a.area),o.name="mark-area-polygon",this._area=o,t.add(o),this._addMarkLabels(t,"mark-area-label",e.defaultAttributes.label)}},{key:"updateMarker",value:function(){var t=this.attribute,i=t.points,n=t.areaStyle,r=t.state;this._area&&(this._area.setAttributes(Object.assign({points:i},n)),this._area.states=mt({},xP,null==r?void 0:r.area)),this._updateMarkLabels(e.defaultAttributes.label)}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<3)return!1;var e=!0;return t.forEach((function(t){it(t.x)&&it(t.y)||(e=!1)})),e}}])}(kH);nN.defaultAttributes=qH,Tt(nN,VH),xH(),wR(),HL();var rN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="markArcLine",a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._line,this._label,this._animationConfig,t)}},{key:"getPointAttrByPosition",value:function(t,e){var i,n=this.attribute,r=n.center,a=n.radius,o=n.startAngle,s=n.endAngle,l=e.refX,u=void 0===l?0:l,c=e.refY,h=void 0===c?0:c;switch(t){case mH.arcInnerStart:i=o;case mH.arcOuterStart:i=o;break;case mH.arcInnerEnd:i=s;case mH.arcOuterEnd:i=s;break;case mH.center:case mH.arcInnerMiddle:case mH.arcOuterMiddle:default:i=(o+s)/2}return{position:{x:r.x+(a+h)*Math.cos(i)+u*Math.cos(i-Math.PI/2),y:r.y+(a+h)*Math.sin(i)+u*Math.sin(i-Math.PI/2)},angle:i}}},{key:"getTextStyle",value:function(t){return JH[t]}},{key:"getRotateByAngle",value:function(t,e){var i;return t-Math.PI/2+(null!==(i=e.refAngle)&&void 0!==i?i:0)}},{key:"createSegment",value:function(){var t=this.attribute,e=t.center,i=t.radius,n=t.startAngle,r=t.endAngle,a=t.startSymbol,o=t.endSymbol,s=t.lineStyle,l=t.state;return new BR({center:e,radius:i,startAngle:n,endAngle:r,startSymbol:a,endSymbol:o,lineStyle:s,state:{line:mt({},xP,null==l?void 0:l.line),startSymbol:mt({},xP,null==l?void 0:l.lineStartSymbol),endSymbol:mt({},xP,null==l?void 0:l.lineEndSymbol)}})}},{key:"setLineAttributes",value:function(){var t=this.attribute,e=t.center,i=t.radius,n=t.startAngle,r=t.endAngle,a=t.startSymbol,o=t.endSymbol,s=t.lineStyle,l=t.state;this._line&&this._line.setAttributes({center:e,radius:i,startAngle:n,endAngle:r,startSymbol:a,endSymbol:o,lineStyle:s,state:{line:mt({},xP,null==l?void 0:l.line),startSymbol:mt({},xP,null==l?void 0:l.lineStartSymbol),endSymbol:mt({},xP,null==l?void 0:l.lineEndSymbol)}})}},{key:"isValidPoints",value:function(){return!0}},{key:"addMarkLineLabels",value:function(t){this._addMarkLabels(t,"mark-common-line-label",e.defaultAttributes.label)}},{key:"updateMarkLineLabels",value:function(){this._updateMarkLabels(e.defaultAttributes.label)}}])}(WH);rN.defaultAttributes=KH,xH(),FB(),HL();var aN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="markArcArea",a.defaultUpdateAnimation=NH,a.defaultExitAnimation=jH,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._area,this._label,this._animationConfig,t)}},{key:"getArea",value:function(){return this._area}},{key:"getPointAttrByPosition",value:function(t,e){var i,n,r=this.attribute,a=r.center,o=r.innerRadius,s=r.outerRadius,l=r.startAngle,u=r.endAngle,c=e.refX,h=void 0===c?0:c,d=e.refY,p=void 0===d?0:d;switch(t){case mH.center:i=(o+s)/2,n=(l+u)/2;break;case mH.arcInnerStart:i=o,n=l;break;case mH.arcOuterStart:i=s,n=l;break;case mH.arcInnerEnd:i=o,n=u;break;case mH.arcOuterEnd:i=s,n=u;break;case mH.arcInnerMiddle:i=o,n=(l+u)/2;break;case mH.arcOuterMiddle:i=s,n=(l+u)/2;break;default:i=o,n=(l+u)/2}return{position:{x:a.x+(i+p)*Math.cos(n)+h*Math.cos(n-Math.PI/2),y:a.y+(i+p)*Math.sin(n)+h*Math.sin(n-Math.PI/2)},angle:n}}},{key:"setLabelPos",value:function(t,e){var i;if(this._area){var n=e.position,r=void 0===n?"arcInnerMiddle":n,a=e.autoRotate,o=this.getPointAttrByPosition(r,e);if(t.setAttributes(Object.assign(Object.assign({},o.position),{angle:a?o.angle-Math.PI/2+(null!==(i=e.refAngle)&&void 0!==i?i:0):0,textStyle:Object.assign(Object.assign({},JH[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){var s=this.attribute.limitRect,l=s.x,u=s.y;$P(t,{x1:l,y1:u,x2:l+s.width,y2:u+s.height})}}}},{key:"initMarker",value:function(t){var i=this.attribute,n=i.center,r=i.innerRadius,a=i.outerRadius,o=i.startAngle,s=i.endAngle,l=i.areaStyle,u=i.state,c=B_.arc(Object.assign({x:n.x,y:n.y,innerRadius:r,outerRadius:a,startAngle:o,endAngle:s},l));c.states=mt({},xP,null==u?void 0:u.area),c.name="polar-mark-area-area",this._area=c,t.add(c),this._addMarkLabels(t,"mark-area-label",e.defaultAttributes.label)}},{key:"updateMarker",value:function(){var t=this.attribute,i=t.center,n=t.innerRadius,r=t.outerRadius,a=t.startAngle,o=t.endAngle,s=t.areaStyle;t.label;var l=t.state;this._area&&(this._area.setAttributes(Object.assign({x:i.x,y:i.y,innerRadius:n,outerRadius:r,startAngle:a,endAngle:o},s)),this._area.states=mt({},xP,null==l?void 0:l.area)),this._updateMarkLabels(e.defaultAttributes.label)}},{key:"isValidPoints",value:function(){return!0}}])}(kH);function oN(){sN._animate=zH}aN.defaultAttributes=ZH,Tt(aN,VH),xH(),MR(),wR(),dP(),KB(),ZB(),HL();var sN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="markPoint",a.defaultUpdateAnimation=UH,a.defaultExitAnimation=jH,a._isArcLine=!1,a._isStraightLine=!1,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}},{key:"setLabelPos",value:function(){}},{key:"getTextAlignAttr",value:function(t,e,i,n,r){return LP(Math.abs(n),Math.PI/2,GH)||LP(Math.abs(n),3*Math.PI/2,GH)?IP(t,n,r):RP(n)?$H.postiveXAxis[r]:$H.negativeXAxis[r]}},{key:"setItemAttributes",value:function(t,e,i,n,r){var a,o;if(t){var s=e.autoRotate,l=void 0===s||s,u=e.refX,c=void 0===u?0:u,h=e.refY,d=void 0===h?0:h,p=e.refAngle,f=void 0===p?0:p,v=e.style,g=e.position,y=void 0===g?_H.middle:g,m=this.attribute.state,_=(null===(a=this._line)||void 0===a?void 0:a.getEndAngle())||0,b=c*Math.cos(_)+d*Math.cos(_-Math.PI/2),x=c*Math.sin(_)+d*Math.sin(_-Math.PI/2);if("text"===r){var k=n.x-i.x,S=n.y-i.y;t.setAttributes(Object.assign(Object.assign({},v),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(l,k,S,_,null!==(o=e.position)&&void 0!==o?o:"end")),v.textStyle),state:{panel:mt({},xP,null==m?void 0:m.textBackground),text:mt({},xP,null==m?void 0:m.itemContent)}}))}else("richText"===r||"image"===r)&&(t.setAttributes({dx:this.getItemDx(t,y,v)+(v.dx||0),dy:this.getItemDy(t,y,v)+(v.dy||0)}),t.states=mt({},xP,null==m?void 0:m.itemContent));var A=RP(_)?_:_-Math.PI;t.setAttributes({x:n.x+(b||0),y:n.y+(x||0),angle:l&&A+f})}}},{key:"getItemDx",value:function(t,e,i){var n,r,a=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.width())&&void 0!==r?r:(null==i?void 0:i.width)||0;return e.includes("inside")?-a:0}},{key:"getItemDy",value:function(t,e,i){var n,r,a=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.height())&&void 0!==r?r:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-a:e.includes("middle")||e.includes("Middle")?-a/2:0}},{key:"initItem",value:function(t,e,i){var n,r=this.attribute.state,a=t.type,o=void 0===a?"text":a,s=t.style,l=t.renderCustomCallback;return"symbol"===o?(n=B_.symbol(Object.assign(Object.assign({},i),s))).states=mt({},xP,null==r?void 0:r.itemContent):"text"===o?n=new iR(Object.assign(Object.assign({},i),{state:{panel:mt({},xP,null==r?void 0:r.textBackground),text:mt({},xP,null==r?void 0:r.itemContent)}})):"richText"===o?(n=B_.richtext(Object.assign(Object.assign({},i),s))).states=mt({},xP,null==r?void 0:r.itemContent):"image"===o?(n=B_.image(Object.assign(Object.assign({},i),s))).states=mt({},xP,null==r?void 0:r.itemContent):"custom"===o&&l&&((n=l()).states=mt({},xP,null==r?void 0:r.itemContent)),n.name="mark-point-".concat(o),this.setItemAttributes(n,t,e,i,o),n}},{key:"getItemLineAttr",value:function(t,e,i){var n=[],r={x:0,y:0},a=0,o=0,s=0,l=t.type,u=void 0===l?"type-s":l,c=t.arcRatio,h=void 0===c?.8:c,d=i.x-e.x,p=i.y-e.y;if(this._isStraightLine=LP(d,0,GH)||LP(p,0,GH),this._isArcLine){var f=this.attribute.position,v=f.x,g=f.y,y=i.x,m=i.y,_=(v+y)/2,b=_+h*(m>g?-1:1)*_,x=(g===m?0:-(v-y)/(g-m))*(b-_)+(g+m)/2;o=JP(g-x,v-b),s=JP(m-x,y-b),r={x:b,y:x};var k=Math.sqrt((b-v)*(b-v)+(x-g)*(x-g)),S=this.attribute.targetSymbol.style.size/2;o+=2*Math.acos(Math.sqrt(1-S*S/(4*k*k))),h>0?s<o&&(s+=2*Math.PI):o<s&&(o+=2*Math.PI),a=Math.sqrt((b-v)*(b-v)+(x-g)*(x-g))}else n="type-do"!==u||this._isStraightLine?"type-po"!==u||this._isStraightLine?"type-op"!==u||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return n=function(t){for(var e=[t[0]],i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}(n),{points:n,center:r,radius:a,startAngle:o,endAngle:s}}},{key:"reDrawLine",value:function(t,e){this._line.release();var i=t.startSymbol,n=t.endSymbol,r=t.lineStyle;t.type;var a=this.attribute.state,o=this._isArcLine?BR:TR;this._container.removeChild(this._line),this._line=new o(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:n,lineStyle:r,visible:t.visible,state:{line:mt({},xP,null==a?void 0:a.line),startSymbol:mt({},xP,null==a?void 0:a.lineStartSymbol),endSymbol:mt({},xP,null==a?void 0:a.lineEndSymbol)}})),this._container.add(this._line)}},{key:"setItemLineAttr",value:function(t,e,i){if(this._line){var n=t.startSymbol,r=t.endSymbol,a=t.lineStyle;t.type;var o=this.attribute.state,s=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},s),{startSymbol:n,endSymbol:r,lineStyle:a,visible:t.visible,state:{line:mt({},xP,null==o?void 0:o.line),startSymbol:mt({},xP,null==o?void 0:o.lineStartSymbol),endSymbol:mt({},xP,null==o?void 0:o.lineEndSymbol)}})):this.reDrawLine(t,s)}}},{key:"getDecorativeLineAttr",value:function(t){var e,i=(null===(e=null==t?void 0:t.decorativeLine)||void 0===e?void 0:e.length)||10,n=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(n-Math.PI/2),startPointOffsetY:i/2*Math.sin(n-Math.PI/2),endPointOffsetX:-i/2*Math.cos(n-Math.PI/2),endPointOffsetY:-i/2*Math.sin(n-Math.PI/2)}}},{key:"setDecorativeLineAttr",value:function(t,e,i){var n;if(this._decorativeLine){var r=t.lineStyle,a=this.getDecorativeLineAttr(t),o=a.startPointOffsetX,s=a.startPointOffsetY,l=a.endPointOffsetX,u=a.endPointOffsetY;this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+o,y:e.y+s},{x:e.x+l,y:e.y+u}]},r),{visible:i})),this._decorativeLine.states=mt({},xP,null===(n=this.attribute.state)||void 0===n?void 0:n.line)}}},{key:"setTargetItemAttributes",value:function(t,e){var i,n;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!==(i=t.visible)&&void 0!==i&&i,size:t.size},t.style)),this._targetItem.states=mt({},xP,null===(n=this.attribute.state)||void 0===n?void 0:n.targetItem))}},{key:"setAllOfItemsAttr",value:function(t,e){var i,n=this.attribute,r=n.position,a=n.itemLine,o=void 0===a?{}:a,s=n.itemContent,l=void 0===s?{}:s,u=n.limitRect,c=n.targetSymbol,h=l.type,d=void 0===h?"text":h,p=l.confine;if(u&&p){var f=u.x,v=u.y,g=u.width,y=u.height,m=QP(this._item,{x1:f,y1:v,x2:f+g,y2:v+y}),_=m.dx,b=m.dy;e.x=e.x+_,e.y=e.y+b}this.setTargetItemAttributes(c,r),this.setItemLineAttr(o,t,e),this.setItemAttributes(this._item,l,t,e,d),this.setDecorativeLineAttr(o,e,null===(i=o.decorativeLine)||void 0===i?void 0:i.visible)}},{key:"computeNewPositionAfterTargetItem",value:function(t){var e,i,n,r=this.attribute,a=r.itemContent,o=void 0===a?{}:a,s=r.targetSymbol,l=r.itemLine,u=o.offsetX,c=void 0===u?0:u,h=o.offsetY,d=void 0===h?0:h,p=s.offset,f=void 0===p?0:p,v=s.style,g=s.visible,y=void 0!==g&&g,m=s.size,_=y?null!==(i=null!==(e=v.size)&&void 0!==e?e:m)&&void 0!==i?i:20:0;return n="type-do"===l.type?JP(d,c/2):"type-po"===l.type?JP(0,c):"type-op"===l.type?JP(d,0):JP(d,c),{newPosition:{x:t.x+(_/2+f)*Math.cos(n),y:t.y+(_/2+f)*Math.sin(n)},newItemPosition:{x:t.x+(_/2+f)*Math.cos(n)+c,y:t.y+(_/2+f)*Math.sin(n)+d}}}},{key:"initMarker",value:function(t){var e=this.attribute,i=e.position,n=e.itemContent,r=void 0===n?{}:n,a=e.itemLine,o=a.type,s=void 0===o?"type-s":o,l=a.arcRatio,u=void 0===l?.8:l,c=r.offsetX,h=void 0===c?0:c,d=r.offsetY,p=void 0===d?0:d;this._isStraightLine=LP(h,0,GH)||LP(p,0,GH),this._isArcLine="type-arc"===s&&0!==u&&!this._isStraightLine;var f=this.computeNewPositionAfterTargetItem(i),v=f.newPosition,g=f.newItemPosition,y=new(this._isArcLine?BR:TR)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});y.name="mark-point-line",this._line=y,t.add(y);var m=B_.line({points:[]});m.name="mark-point-decorativeLine",this._decorativeLine=m,t.add(m);var _=B_.symbol({});_.name="mark-point-targetItem",this._targetItem=_,t.add(this._targetItem);var b=this.initItem(r,v,g);this._item=b,t.add(b),this.setAllOfItemsAttr(v,g)}},{key:"updateMarker",value:function(){var t=this.attribute,e=t.position,i=t.itemContent,n=void 0===i?{}:i,r=t.itemLine,a=n.type,o=void 0===a?"text":a,s=r.type,l=void 0===s?"type-s":s,u=r.arcRatio,c=void 0===u?.8:u,h=n.offsetX,d=void 0===h?0:h,p=n.offsetY,f=void 0===p?0:p;this._isStraightLine=LP(d,0,GH)||LP(f,0,GH);var v="type-arc"===l&&0!==c&&!this._isStraightLine,g=this.computeNewPositionAfterTargetItem(e),y=g.newPosition,m=g.newItemPosition;v!==this._isArcLine?(this._isArcLine=v,this.reDrawLine(r,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=v,this.setItemAttributes(this._item,n,y,m,o),this.setAllOfItemsAttr(y,m)}},{key:"isValidPoints",value:function(){var t=this.attribute.position;return!(!it(t.x)||!it(t.y))}}])}(kH);function lN(){YB(),dP(),fP()}sN.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10}};var uN={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};lN();var cN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="pager",a._current=1,a._onHover=function(t){var e=t.target;e.hasState("disable")||e.addState("hover")},a._onUnHover=function(t){t.target.removeState("hover")},a._onClick=function(t){var e=t.target;if("preHandler"===e.name){if(1===a._current)return;a._current-=1,1===a._current?e.addState("disable"):e.removeState("disable"),a._dispatchEvent("toPrev",{current:a._current,total:a._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(a._current===a._total)return;a._current+=1,a._current===a._total?e.addState("disable"):e.removeState("disable"),a._dispatchEvent("toNext",{current:a._current,total:a._total,direction:"next",event:t})}a._current>1&&a.preHandler.removeState("disable"),a._current<a._total&&a.nextHandler.removeState("disable"),a.text.setAttribute("text",a._getPageText(a._current))},a}return h(e,t),o(e,[{key:"getCurrent",value:function(){return this._current}},{key:"render",value:function(){var t,e,i;this._reset();var n=this.attribute,r=n.layout,a=void 0===r?"horizontal":r,o=n.handler,s=void 0===o?uN:o,l=n.total,u=n.defaultCurrent,c=void 0===u?1:u,h=n.textStyle,d=n.padding,p=void 0===d?0:d;this._current=c;var f=rr(p),v="horizontal"===a,g=B_.group({x:0,y:0}),y=s.style||{},m=y.size||15,_=null!==(t=s.space)&&void 0!==t?t:8,b=s.state||{},x=s.preShape,k=s.nextShape;x||(x=v?"triangleLeft":"triangleUp"),k||(k=v?"triangleRight":"triangleDown");var S=B_.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:0,y:0,symbolType:x,size:m}));S.states=b,S.name="preHandler",this.preHandler=S,g.add(S);var A=YP(this._getPageText(l),Object.assign({textAlign:"center",textBaseline:"middle"},h),null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),C=A.width,M=A.height,w=$(m)?m:m[0],T=$(m)?m:m[1],D=B_.text(Object.assign({x:v?w/2+_+C/2:0,y:v?0:T/2+_+M/2,text:this._getPageText(c),textAlign:"center",textBaseline:"middle",lineHeight:null==h?void 0:h.fontSize},h));this.text=D,g.add(D);var E=B_.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:v?w+2*_+C:0,y:v?0:T+2*_+M,symbolType:k,size:m}));E.name="nextHandler",E.states=b,this.nextHandler=E,g.add(E),1===this._total?(S.addState("disable"),E.addState("disable")):1===this._current?S.addState("disable"):this._current===l&&E.addState("disable");var B=g.AABBBounds,P=B.width(),R=B.height();g.translateTo(0-B.x1+f[3],0-B.y1+f[0]),this.add(g),this.attribute.width=P+f[1]+f[3],this.attribute.height=R+f[0]+f[2],this._bindEvents()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}},{key:"_reset",value:function(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}},{key:"_getPageText",value:function(t){var e=this.attribute.pageFormatter;return e?U(e)?e(t,this._total):"".concat(e).replace("{current}","".concat(t)).replace("{total}","".concat(this._total)):"".concat(t,"/").concat(this._total)}},{key:"setTotal",value:function(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}])}($A);cN.defaultAttributes={handler:uN,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var hN,dN,pN;!function(t){t.selected="selected",t.unSelected="unSelected",t.selectedHover="selectedHover",t.unSelectedHover="unSelectedHover",t.focus="focus"}(hN||(hN={})),function(t){t.legendItemHover="legendItemHover",t.legendItemUnHover="legendItemUnHover",t.legendItemClick="legendItemClick",t.legendItemAttributeUpdate="legendItemAttributeUpdate"}(dN||(dN={})),function(t){t.innerView="innerView",t.title="legendTitle",t.item="legendItem",t.itemShape="legendItemShape",t.itemLabel="legendItemLabel",t.itemValue="legendItemValue",t.focus="legendItemFocus"}(pN||(pN={}));var fN=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="legend",t._title=null,t}return h(e,t),o(e,[{key:"render",value:function(){this.removeAllChild(!0);var t=this.attribute,e=t.interactive,i=void 0===e||e,n=t.title,r=t.padding,a=void 0===r?0:r;this._parsedPadding=rr(a);var o=B_.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:i,childrenPickable:i});o.name=pN.innerView,this.add(o),this._innerView=o,(null==n?void 0:n.visible)&&this._renderTitle(n),this._renderContent(),this._adjustLayout(),i&&this._bindEvents();var s=this._innerView.AABBBounds;this.attribute.width=s.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=s.height()+this._parsedPadding[0]+this._parsedPadding[2]}},{key:"_renderTitle",value:function(t){var e=t.text,i=void 0===e?"":e,n=t.textStyle,r=t.padding,a=void 0===r?0:r,o=t.background,s=t.minWidth,l=t.maxWidth,u=t.shape,c={x:0,y:0,text:i,textStyle:n,padding:rr(a),minWidth:s,maxWidth:l};u&&u.visible&&(c.shape=Object.assign({visible:!0},u.style),W(u.space)&&(c.space=u.space)),o&&o.visible&&(c.panel=Object.assign({visible:!0},o.style));var h=new iR(c);h.name=pN.title,this._title=h,this._innerView.add(h)}},{key:"_adjustLayout",value:function(){var t;if(this._title){var e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),n=null===(t=this.attribute.title)||void 0===t?void 0:t.align;"center"===n?this._title.setAttribute("x",(e-i)/2):"end"===n&&this._title.setAttribute("x",e-i)}}}])}($A);function vN(){YB(),fP(),rP(),dP()}function gN(){YB(),tR()}var yN=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},mN=l(l(l(l(l({},hN.focus,{}),hN.selected,{}),hN.selectedHover,{}),hN.unSelected,{}),hN.unSelectedHover,{});gN(),lN(),gP();var _N,bN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="discreteLegend",a._itemsContainer=null,a._itemHeightByUser=void 0,a._itemHeight=0,a._itemMaxWidth=0,a._contentMaxHeight=0,a._onHover=function(t){var e=t.target;if(e&&e.name&&e.name.startsWith(pN.item)){var i=e.delegate;if(a._lastActiveItem){if(a._lastActiveItem.id===i.id)return;a._unHover(a._lastActiveItem,t)}a._hover(i,t)}else a._lastActiveItem&&(a._unHover(a._lastActiveItem,t),a._lastActiveItem=null)},a._onUnHover=function(t){a._lastActiveItem&&(a._unHover(a._lastActiveItem,t),a._lastActiveItem=null)},a._onClick=function(t){var e,i,n,r,o=t.target;if(o&&o.name&&o.name.startsWith(pN.item)){var s=o.delegate,l=a.attribute.selectMode,u=void 0===l?"multiple":l;if(o.name===pN.focus||"focus"===u){var c=s.hasState(hN.focus);s.toggleState(hN.focus),c?null===(e=a._itemsContainer)||void 0===e||e.getChildren().forEach((function(e){a._removeLegendItemState(e,[hN.unSelected,hN.unSelectedHover,hN.focus],t),a._setLegendItemState(e,hN.selected,t)})):(a._setLegendItemState(s,hN.selected,t),a._removeLegendItemState(s,[hN.unSelected,hN.unSelectedHover],t),null===(i=a._itemsContainer)||void 0===i||i.getChildren().forEach((function(e){s!==e&&(a._removeLegendItemState(e,[hN.selected,hN.selectedHover,hN.focus],t),a._setLegendItemState(e,hN.unSelected,t))})))}else{null===(n=a._itemsContainer)||void 0===n||n.getChildren().forEach((function(t){t.removeState(hN.focus)}));var h=a.attribute.allowAllCanceled,d=void 0===h||h,p=s.hasState(hN.selected),f=a._getSelectedLegends();if("multiple"===u){if(!1===d&&p&&1===f.length)return void a._dispatchLegendEvent(dN.legendItemClick,s,t);p?(a._removeLegendItemState(s,[hN.selected,hN.selectedHover],t),a._setLegendItemState(s,hN.unSelected,t)):(a._setLegendItemState(s,hN.selected,t),a._removeLegendItemState(s,[hN.unSelected,hN.unSelectedHover],t))}else a._setLegendItemState(s,hN.selected,t),a._removeLegendItemState(s,[hN.unSelected,hN.unSelectedHover],t),null===(r=a._itemsContainer)||void 0===r||r.getChildren().forEach((function(e){s!==e&&(a._removeLegendItemState(e,[hN.selected,hN.selectedHover],t),a._setLegendItemState(e,hN.unSelected,t))}))}a._dispatchLegendEvent(dN.legendItemClick,s,t)}},a}return h(e,t),o(e,[{key:"render",value:function(){_(e,"render",this,3)([]),this._lastActiveItem=null}},{key:"setSelected",value:function(t){var e,i=this;(null===(e=this._itemsContainer)||void 0===e?void 0:e.getChildren()).forEach((function(e){var n=e.data;t.includes(n.label)?(i._setLegendItemState(e,hN.selected),i._removeLegendItemState(e,[hN.unSelected,hN.unSelectedHover])):(i._removeLegendItemState(e,[hN.selected,hN.selectedHover]),i._setLegendItemState(e,hN.unSelected))}))}},{key:"_renderItems",value:function(){for(var t,e=this.attribute,i=e.item,n=void 0===i?{}:i,r=e.maxCol,a=void 0===r?1:r,o=e.maxRow,s=void 0===o?2:o,l=e.maxWidth,u=e.defaultSelected,c=e.lazyload,h=e.autoPage,d=n.spaceCol,p=void 0===d?16:d,f=n.spaceRow,v=void 0===f?8:f,g=n.verticalAlign,y=void 0===g?"middle":g,m=this._itemsContainer,_=this._itemContext,b=_.items,x=_.isHorizontal,k=_.startIndex,S=_.isScrollbar,A=S?1:x?s:a,C=this._contentMaxHeight,M=this._itemContext,w=M.doWrap,T=M.maxWidthInCol,D=M.startX,E=M.startY,B=M.pages,P=0,R=0,L=[],I=k,F=b.length;I<F&&!(c&&B>this._itemContext.currentPage*A);I++){c&&(this._itemContext.startIndex=I+1),(t=b[I]).id||(t.id=t.label),t.index=I;var O=!0;Z(u)&&(O=u.includes(t.label));var z=this._renderEachItem(t,O,I,b),H=z.attribute.width,N=z.attribute.height;this._itemHeight=Math.max(this._itemHeight,N),T=Math.max(H,T),this._itemMaxWidth=Math.max(H,this._itemMaxWidth),x?(W(l)&&(S&&h?w=(B=Math.ceil((D+H)/l))>1:D+H>l&&(w=!0,D>0&&("middle"!==y&&"bottom"!==y||L.forEach((function(t){t.setAttributes({y:t.attribute.y+(R-t.attribute.height)/("middle"===y?2:1)})})),B+=1,D=0,E+=R+v,R=0,L.length=0))),0===D&&0===E||z.setAttributes({x:D,y:E}),D+=p+H,R=Math.max(R,N),L.push(z)):(W(C)&&(S&&h?w=(B=Math.ceil((E+N)/C))>1:C<=N?(B+=1,w=!0,E=0,I>0&&(D+=P+p)):C<E+N&&(B+=1,w=!0,E=0,D+=T+p,T=0)),0===D&&0===E||z.setAttributes({x:D,y:E}),E+=v+N),m.add(z),P=H}return!x||"middle"!==y&&"bottom"!==y||L.forEach((function(t){t.setAttributes({y:t.attribute.y+(R-t.attribute.height)/("middle"===y?2:1)})})),this._itemContext.doWrap=w,this._itemContext.startX=D,this._itemContext.startY=E,this._itemContext.maxWidthInCol=T,this._itemContext.pages=B,this._itemContext.maxPages=A,S&&(this._itemContext.totalPage=B),c||(this._itemContext.startIndex=b.length),this._itemContext}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.item,i=void 0===e?{}:e,n=t.items,r=t.reversed,a=t.maxWidth,o=t.maxHeight;if(!1!==i.visible&&!ct(n)){var s=n;r&&(s=null==n?void 0:n.reverse()),this._contentMaxHeight=Math.max(0,o-this._parsedPadding[0]-this._parsedPadding[2]);var l=B_.group({x:0,y:0});this._itemsContainer=l;var u=this.attribute,c=u.layout,h=u.autoPage,d="horizontal"===c,p=i.maxWidth,f=i.width,v=i.height,g=[];W(p)&&g.push(p),W(f)&&g.push(f),g.length&&(W(a)&&g.push(a),this._itemWidthByUser=Pt(g)),W(v)&&(this._itemHeightByUser=v);var y=this.attribute.pager;this._itemContext={currentPage:y&&y.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:s,isHorizontal:d,totalPage:1/0,isScrollbar:y&&"scrollbar"===y.type,clipContainer:void 0},this._itemContext=this._renderItems();var m=!1;this._itemContext.doWrap&&h&&this._itemContext.pages>this._itemContext.maxPages&&(m=this._renderPagerComponent()),m||(l.setAttribute("y",this._title?this._title.AABBBounds.height()+ht(this.attribute,"title.space",8):0),this._innerView.add(l))}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent&&this._itemsContainer){var t=this.attribute,e=t.hover,i=void 0===e||e,n=t.select,r=void 0===n||n;if(i){var a="pointermove",o="pointerleave";G(i)&&(i.trigger&&(a=i.trigger),i.triggerOff&&(o=i.triggerOff)),this._itemsContainer.addEventListener(a,this._onHover),this._itemsContainer.addEventListener(o,this._onUnHover)}if(r){var s="pointerdown";G(r)&&r.trigger&&(s=r.trigger),this._itemsContainer.addEventListener(s,this._onClick)}}}},{key:"_autoEllipsis",value:function(t,e,i,n){var r,a,o=this.attribute.item,s=o.label,l=o.value,u=n.AABBBounds,c=i.AABBBounds,h=u.width(),d=c.width(),p=!1;"labelFirst"===t?d>e?p=!0:n.setAttribute("maxLineWidth",e-d):"valueFirst"===t?h>e?p=!0:i.setAttribute("maxLineWidth",e-h):h+d>e&&(p=!0),p&&(n.setAttribute("maxLineWidth",Math.max(e*(null!==(r=s.widthRatio)&&void 0!==r?r:.5),e-d)),i.setAttribute("maxLineWidth",Math.max(e*(null!==(a=l.widthRatio)&&void 0!==a?a:.5),e-h)))}},{key:"_renderEachItem",value:function(t,e,i,n){var r,a,o,s=t.id,l=t.label,u=t.value,c=t.shape,h=this.attribute.item,d=h.padding,p=void 0===d?0:d,f=h.focus,v=h.focusIconStyle,g=h.align,y=h.autoEllipsisStrategy,m=this.attribute.item,_=m.shape,b=m.label,x=m.value,k=m.background,S=this._handleStyle(_,t,e,i,n),A=this._handleStyle(b,t,e,i,n),C=this._handleStyle(x,t,e,i,n),M=this._handleStyle(k,t,e,i,n),w=rr(p);!1===k.visible?(o=B_.group({x:0,y:0,cursor:null===(r=M.style)||void 0===r?void 0:r.cursor}),this._appendDataToShape(o,pN.item,t,o)):(o=B_.group(Object.assign({x:0,y:0},M.style)),this._appendDataToShape(o,pN.item,t,o,M.state)),o.id="".concat(null!=s?s:l,"-").concat(i),o.addState(e?hN.selected:hN.unSelected);var T=B_.group({x:0,y:0,pickable:!1});o.add(T);var D,E=0,B=0,P=0;if(_&&!1!==_.visible){var R=ht(S,"style.size",10);B=Z(R)?R[0]||0:R,P=ht(_,"space",8);var L=B_.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},c),S.style));Object.keys(S.state||{}).forEach((function(t){var e=S.state[t].fill||S.state[t].stroke;c.fill&&j(S.state[t].fill)&&e&&(S.state[t].fill=e),c.stroke&&j(S.state[t].stroke)&&e&&(S.state[t].stroke=e)})),this._appendDataToShape(L,pN.itemShape,t,o,S.state),L.addState(e?hN.selected:hN.unSelected),T.add(L)}var I=0;if(f){var F=ht(v,"size",10);D=B_.symbol(Object.assign(Object.assign({x:0,y:-F/2-1,strokeBoundsBuffer:0,boundsPadding:w},v),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(D,pN.focus,t,o),I=F}var O=b.formatMethod?b.formatMethod(l,t,i):l,z=qP(Object.assign(Object.assign({x:B/2+P,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null===(a=A.style)||void 0===a?void 0:a.fontSize},A.style),{text:O,_originText:b.formatMethod?l:void 0}));this._appendDataToShape(z,pN.itemLabel,t,o,A.state),z.addState(e?hN.selected:hN.unSelected),T.add(z);var H=ht(b,"space",8);if(W(u)){var N=ht(x,"space",f?8:0),U=x.formatMethod?x.formatMethod(u,t,i):u,V=qP(Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:C.style.fontSize},C.style),{text:U,_originText:x.formatMethod?u:void 0}));if(this._appendDataToShape(V,pN.itemValue,t,o,C.state),V.addState(e?hN.selected:hN.unSelected),this._itemWidthByUser){var G=this._itemWidthByUser-w[1]-w[3]-B-P-H-I-N;this._autoEllipsis(y,G,z,V),x.alignRight?V.setAttributes({textAlign:"right",x:this._itemWidthByUser-B/2-w[1]-w[3]-I-N}):V.setAttribute("x",H+(z.AABBBounds.empty()?0:z.AABBBounds.x2))}else V.setAttribute("x",H+(z.AABBBounds.empty()?0:z.AABBBounds.x2));E=N+(V.AABBBounds.empty()?0:V.AABBBounds.x2),T.add(V)}else this._itemWidthByUser?(z.setAttribute("maxLineWidth",this._itemWidthByUser-w[1]-w[3]-B-P-I),E=H+(z.AABBBounds.empty()?0:z.AABBBounds.x2)):E=H+(z.AABBBounds.empty()?0:z.AABBBounds.x2);D&&(D.setAttribute("x",E),T.add(D));var Y=T.AABBBounds,X=Y.width();if("right"===g){var K=Y.x2,q=Y.x1;T.forEachChildren((function(t,e){"symbol"!==t.type&&"right"!==t.attribute.textAlign||t===D?t.setAttribute("x",q+K-t.attribute.x-t.AABBBounds.width()):"symbol"!==t.type?t.setAttributes({x:q+K-t.attribute.x,textAlign:"left"}):t.setAttribute("x",q+K-t.attribute.x)}))}var J=Y.height(),Q=W(this.attribute.item.width)?this.attribute.item.width:X+w[1]+w[3],$=this._itemHeightByUser||J+w[0]+w[2];return o.attribute.width=Q,o.attribute.height=$,D&&D.setAttribute("visible",!1),T.translateTo(-Y.x1+w[3],-Y.y1+w[0]),o}},{key:"_createPager",value:function(t){var e,i,n=this.attribute,r=n.disableTriggerEvent,a=n.maxRow,o=function(t){return t<=99?99:t<=999?999:9999};return this._itemContext.isHorizontal?new cN(Object.assign(Object.assign({layout:1===a?"horizontal":"vertical",total:o(this._itemContext.pages)},mt({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null===(e=this.attribute.pager)||void 0===e?void 0:e.defaultCurrent,disableTriggerEvent:r})):new cN(Object.assign({layout:"horizontal",total:o(this._itemContext.pages),disableTriggerEvent:r,defaultCurrent:null===(i=this.attribute.pager)||void 0===i?void 0:i.defaultCurrent},t))}},{key:"_createScrollbar",value:function(t,e){var i=this.attribute.disableTriggerEvent;return this._itemContext.isHorizontal?new MP(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:!1===t.visible?0:12},t),{width:e})):new MP(Object.assign(Object.assign({direction:"vertical",width:!1===t.visible?0:12,range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}},{key:"_updatePositionOfPager",value:function(t,e,i){var n,r,a=this.attribute.pager,o=this._itemContext,s=o.totalPage,l=o.isHorizontal,u=a&&a.position||"middle";(this._pagerComponent.setTotal(s),l)?(n="start"===u?t:"end"===u?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:n})):(r="start"===u?0:"end"===u?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:r,y:i-this._pagerComponent.AABBBounds.height()}))}},{key:"_computeScrollbarDelta",value:function(){var t,e=this._itemContext,i=e.isHorizontal,n=e.clipContainer,r=this._itemsContainer.AABBBounds,a=n.AABBBounds;return i?t=a.width()/r.width():t=a.height()/r.height(),t}},{key:"_updatePositionOfScrollbar",value:function(t,e,i){var n=this._itemContext,r=n.isHorizontal,a=(n.currentPage-1)/n.totalPage;this._pagerComponent.setScrollRange([a,a+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}},{key:"_bindEventsOfPager",value:function(t,e){var i=this,n=this.attribute.pager||{},r=n.animation,a=void 0===r||r,o=n.animationDuration,s=void 0===o?450:o,u=n.animationEasing,c=void 0===u?"quadIn":u,h=this._itemContext.isScrollbar?function(t){var e=t.detail.value;return 0===e[0]?1:1===e[1]?i._itemContext.totalPage:e[0]*i._itemContext.totalPage+1}:function(t){return t.detail.current},d=function(n){var r=h(n);if(r!==i._itemContext.currentPage){if(i._itemContext.currentPage=r,i._itemContext&&i._itemContext.startIndex<i._itemContext.items.length){i._renderItems();var o=Math.ceil(i._itemContext.pages/i._itemContext.maxPages);if(i._itemContext.totalPage=o,i._itemContext.isScrollbar&&i._pagerComponent){var u=i._computeScrollbarDelta(),d=m(i._pagerComponent.getScrollRange(),1)[0];i._pagerComponent.setScrollRange([d,d+u])}}if(i._itemContext.isScrollbar){var p=m(i._pagerComponent.getScrollRange(),1)[0],f=(i._itemContext.isHorizontal?i._itemsContainer.AABBBounds.width():i._itemsContainer.AABBBounds.height())*p;i.updateScrollMask(),a?i._itemsContainer.animate().to(l({},e,-f),s,c):i._itemsContainer.setAttribute(e,-f)}else a?i._itemsContainer.animate().to(l({},e,-(r-1)*t),s,c):i._itemsContainer.setAttribute(e,-(r-1)*t)}};if(this._itemContext.isScrollbar){if(this._pagerComponent.addEventListener("scrollDrag",d),this._pagerComponent.addEventListener("scrollUp",d),this.attribute.pager.roamScroll){this.addEventListener("wheel",(function(t){return t.nativeEvent.preventDefault()})),this.addEventListener("wheel",ge((function(t){var e=i._pagerComponent,n=e.getScrollRange(),r=e.attribute.direction,a=e.getSliderRenderBounds(),o=a.width,s=a.height,l="vertical"===r?t.deltaY/s:t.deltaX/o;e.setScrollRange([n[0]+l,n[1]+l],!0),i.updateScrollMask()}),50))}}else this._pagerComponent.addEventListener("toPrev",d),this._pagerComponent.addEventListener("toNext",d)}},{key:"_renderPager",value:function(){var t,e=this,i=this._title?this._title.AABBBounds.height()+ht(this.attribute,"title.space",8):0,n=this.attribute,r=n.maxWidth,a=n.maxCol,o=void 0===a?1:a,s=n.maxRow,l=void 0===s?2:s,u=n.item,c=void 0===u?{}:u,h=n.pager,d=void 0===h?{}:h,p=c.spaceCol,f=void 0===p?16:p,v=c.spaceRow,g=void 0===v?8:v,y=this._itemsContainer,m=d.space,_=void 0===m?12:m,b=d.defaultCurrent,x=void 0===b?1:b,k=yN(d,["space","defaultCurrent"]),S=this._itemContext.isHorizontal,A=this._contentMaxHeight,C=0,M=0,w=0,T=0,D=0,E=0,B=1;if(S){if(M=(l-1)*g+this._itemHeight*l,C=r,t=this._createPager(k),this._pagerComponent=t,this._innerView.add(t),(w=r-t.AABBBounds.width()-_)<=0)return this._innerView.removeChild(t),!1;y.getChildren().forEach((function(t,e){var i=t.attribute,n=i.width,r=i.height;w<D+n&&e>0&&(D=0,E+=r+g,B+=1),e>0&&t.setAttributes({x:D,y:E}),D+=f+n})),this._itemContext.startX=D,this._itemContext.startY=E,this._itemContext.pages=B;var P=Math.ceil(B/l);this._itemContext.totalPage=P,this._updatePositionOfPager(i,C,M)}else{if(C=this._itemMaxWidth*o+(o-1)*f,M=A,w=C,t=this._createPager(k),this._pagerComponent=t,this._innerView.add(t),(T=A-t.AABBBounds.height()-_-i)<=0)return this._innerView.removeChild(t),!1;y.getChildren().forEach((function(t,i){var n=t.attribute;n.width;var r=n.height;T<E+r&&i>0&&(E=0,D+=e._itemMaxWidth+f,B+=1),i>0&&t.setAttributes({x:D,y:E}),E+=g+r}));var R=Math.ceil(B/o);this._itemContext.totalPage=R,this._updatePositionOfPager(i,C,M)}x>1&&(S?y.setAttribute("y",-(x-1)*(M+g)):y.setAttribute("x",-(x-1)*(C+f)));var L=B_.group({x:0,y:i,width:S?w:C,height:S?M:T,clip:!0,pickable:!1});return L.add(y),this._innerView.add(L),this._itemContext.clipContainer=L,this._bindEventsOfPager(S?M+g:C+f,S?"y":"x"),!0}},{key:"_renderScrollbar",value:function(){var t,e=this._title?this._title.AABBBounds.height()+ht(this.attribute,"title.space",8):0,i=this.attribute,n=i.maxWidth,r=i.item,a=void 0===r?{}:r,o=i.pager,s=void 0===o?{}:o,l=a.spaceCol,u=void 0===l?16:l,c=a.spaceRow,h=void 0===c?8:c,d=this._itemsContainer;s.space;var p,f=s.defaultCurrent,v=void 0===f?1:f,g=yN(s,["space","defaultCurrent"]),y=this._itemContext.isHorizontal,m=this._contentMaxHeight,_=0,b=0,x=0,k=1;if(y)_=n,b=this._itemHeight,p=this._createScrollbar(g,_),this._pagerComponent=p,this._innerView.add(p);else{if(b=m-e,_=this._itemMaxWidth,p=this._createScrollbar(g,b),this._pagerComponent=p,this._innerView.add(p),b<=0)return this._innerView.removeChild(p),!1;var S=d.getChildren(),A=S.map((function(t){return t.attribute.height}));if(1===A.length||A.every((function(t){return t===A[0]}))){var C=A[0],M=b,w=Math.floor(M/(h+C));b=w*(h+C),k=Math.ceil(S.length/w)}else S.forEach((function(t,e){var i=t.attribute.height,n=k,r=x;k=Math.floor((x+i)/b)+1,x+=h+i,n!==k&&e===d.getChildren().length-1&&x-b>=1/3*i&&(b=r+i,k-=1)}));this._itemContext.totalPage=k,this._itemContext.pages=k}if(v>1)if(y){var T=this._itemsContainer.AABBBounds.width()-_;d.setAttribute("x",-Math.min((v-1)*(_+u),T))}else{var D=this._itemsContainer.AABBBounds.height()-b;d.setAttribute("y",-Math.min((v-1)*(b+h),D))}var E=B_.group({x:0,y:e,width:_,height:b,clip:!0,pickable:!1});return E.add(d),this._innerView.add(E),this._itemContext.clipContainer=E,this._updatePositionOfScrollbar(_,b,e),(null===(t=s.scrollMask)||void 0===t?void 0:t.visible)&&this.renderScrollMask(E),this._bindEventsOfPager(y?_:b,y?"x":"y"),!0}},{key:"renderScrollMask",value:function(t){var e=this.attribute.pager.scrollMask,i=void 0===e?{}:e,n=i.visible,r=void 0===n||n,a=i.gradientLength,o=void 0===a?16:a,s=i.gradientStops;if(r&&s){var l=t.AABBBounds.width(),u=t.AABBBounds.height(),c=this._itemContext.isHorizontal?l:u,h=s.map((function(t){return{offset:o*t.offset/c,color:t.color}})),d=s.map((function(t){return{offset:(c-o*t.offset)/c,color:t.color}})),p=B_.rect({x:0,y:0,width:l,height:u});this._scrollMask=p,this._scrollMaskContext={startStops:h,endStops:d},this.updateScrollMask(),t.add(p)}}},{key:"updateScrollMask",value:function(){if(this._scrollMask&&this._pagerComponent&&this._itemContext.isScrollbar){var t=m(this._pagerComponent.getScrollRange(),2),e=t[0],i=t[1],n=[];ie(he(i,0,1),1)||n.push.apply(n,b(this._scrollMaskContext.endStops)),ie(he(e,0,1),0)||n.push.apply(n,b(this._scrollMaskContext.startStops)),n.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:n}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:n}}))}}},{key:"_renderPagerComponent",value:function(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}},{key:"_hover",value:function(t,e){this._lastActiveItem=t,t.hasState(hN.selected)?this._setLegendItemState(t,hN.selectedHover,e):this._setLegendItemState(t,hN.unSelectedHover,e);var i=t.getChildren()[0].find((function(t){return t.name===pN.focus}),!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(dN.legendItemHover,t,e)}},{key:"_unHover",value:function(t,e){var i=!1;(t.hasState(hN.unSelectedHover)||t.hasState(hN.selectedHover))&&(i=!0),t.removeState(hN.unSelectedHover),t.removeState(hN.selectedHover),t.getChildren()[0].getChildren().forEach((function(t){i||!t.hasState(hN.unSelectedHover)&&!t.hasState(hN.selectedHover)||(i=!0),t.removeState(hN.unSelectedHover),t.removeState(hN.selectedHover)}));var n=t.getChildren()[0].find((function(t){return t.name===pN.focus}),!1);n&&n.setAttribute("visible",!1),i&&this._dispatchLegendEvent(dN.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(dN.legendItemUnHover,t,e)}},{key:"_setLegendItemState",value:function(t,e,i){var n=!1;t.hasState(e)||(n=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach((function(t){t.name!==pN.focus&&(n||t.hasState(e)||(n=!0),t.addState(e,!0))})),n&&this._dispatchLegendEvent(dN.legendItemAttributeUpdate,t,i)}},{key:"_removeLegendItemState",value:function(t,e,i){var n=!1;e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)})),t.getChildren()[0].getChildren().forEach((function(t){t.name!==pN.focus&&e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)}))})),n&&this._dispatchLegendEvent(dN.legendItemAttributeUpdate,t,i)}},{key:"_getSelectedLegends",value:function(){var t,e=[];return null===(t=this._itemsContainer)||void 0===t||t.getChildren().forEach((function(t){t.hasState(hN.selected)&&e.push(t.data)})),e}},{key:"_appendDataToShape",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.name=e,t.data=i,t.delegate=n,t.states=mt({},mN,r)}},{key:"_dispatchLegendEvent",value:function(t,e,i){var n=this._getSelectedLegends();n.sort((function(t,e){return t.index-e.index}));var r=n.map((function(t){return t.label}));this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(hN.selected),currentSelectedItems:n,currentSelected:r,event:i})}},{key:"_handleStyle",value:function(t,e,i,n,r){var a={};return t.style&&(U(t.style)?a.style=t.style(e,i,n,r):a.style=t.style),t.state&&(a.state={},Object.keys(t.state).forEach((function(o){t.state[o]&&(U(t.state[o])?a.state[o]=t.state[o](e,i,n,r):a.state[o]=t.state[o])}))),a}},{key:"release",value:function(){_(e,"release",this,3)([]),this.removeAllEventListeners()}}])}(fN);function xN(t){return Z(t)?t:[t,t]}function kN(t){return t?"ew-resize":"ns-resize"}bN.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:16,spaceRow:8,shape:{space:8,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:8,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:10,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0},function(t){t.innerView="innerView",t.railContainer="sliderRailContainer",t.rail="sliderRail",t.startText="sliderStartText",t.endText="sliderEndText",t.startHandler="sliderStartHandler",t.startHandlerText="startHandlerText",t.endHandler="sliderEndHandler",t.endHandlerText="sliderEndHandlerText",t.track="sliderTrack",t.trackContainer="sliderTrackContainer"}(_N||(_N={})),vN();var SN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="slider",a._isHorizontal=!0,a._startHandler=null,a._endHandler=null,a._startHandlerText=null,a._endHandlerText=null,a._currentHandler=null,a._currentValue={},a._onTooltipShow=function(t){a._isChanging||a._tooltipState&&a._tooltipState.isActive||(a._tooltipState?a._tooltipState.isActive=!0:a._tooltipState={isActive:!0},a._onTooltipUpdate(t),a._dispatchTooltipEvent("sliderTooltipShow"))},a._onTooltipUpdate=function(t){if(!a._isChanging&&a._tooltipState&&a._tooltipState.isActive){var e=a._isHorizontal?a._rail.globalAABBBounds.width():a._rail.globalAABBBounds.height(),i=he(a._isHorizontal?(t.viewX-a._rail.globalAABBBounds.x1)/e:(t.viewY-a._rail.globalAABBBounds.y1)/e,0,1);i!==a._tooltipState.pos&&(a._tooltipState.pos=i,a._tooltipState.value=a.calculateValueByPos(i*e),a._updateTooltip(),a._dispatchTooltipEvent("sliderTooltipUpdate"))}},a._onTooltipHide=function(){var t=a.attribute.tooltip;t&&t.alwaysShow||(a._tooltipState=null,a._tooltipShape&&a._tooltipShape.setAttribute("visible",!1),a._tooltipText&&a._tooltipText.setAttribute("visible",!1),a._dispatchTooltipEvent("sliderTooltipHide"))},a._onHandlerPointerdown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.stage.eventPointTransform(t),i=e.x,n=e.y;a._currentHandler=t.target,a._prePos=a._isHorizontal?i:n;var r=AP(),o="browser"===tS.env?tS:a.stage;o.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),r.forEach((function(t){o.addEventListener(t,a._onHandlerPointerUp)}))},a._onHandlerPointerMove=function(t){var e,i;a._isChanging=!0;var n=a.attribute,r=n.railWidth,o=n.railHeight,s=n.min;if(n.max!==s){var l,u,c,h=a.stage.eventPointTransform(t),d=h.x,p=h.y,f=0;a._isHorizontal?(f=(l=d)-a._prePos,u=null===(i=a._currentHandler)||void 0===i?void 0:i.attribute.x,c=r):(f=(l=p)-a._prePos,u=null===(e=a._currentHandler)||void 0===e?void 0:e.attribute.y,c=o);var v=he(u+f,0,c),g=a.calculateValueByPos(v);"text"===a._currentHandler.type?a._updateHandlerText(a._currentHandler,v,g):a._updateHandler(a._currentHandler,v,g),a._updateTrack(),a._prePos=l,a._dispatchChangeEvent()}},a._onHandlerPointerUp=function(t){a._isChanging=!1,a._currentHandler=null,a._clearAllDragEvents()},a._handleTouchMove=function(t){a._isChanging&&t.preventDefault()},a._onTrackPointerdown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.stage.eventPointTransform(t),i=e.x,n=e.y;a._prePos=a._isHorizontal?i:n;var r=AP(),o="browser"===tS.env?tS:a.stage;o.addEventListener("pointermove",a._onTrackPointerMove,{capture:!0}),r.forEach((function(t){o.addEventListener(t,a._onTrackPointerUp)}))},a._onTrackPointerMove=function(t){a._isChanging=!0;var e=a.attribute,i=e.railWidth,n=e.railHeight,r=e.min,o=e.max,s=e.inverse;if(o!==r){var l,u,c,h=a._getHandlers(),d=h.startHandler,p=h.endHandler,f=a.stage.eventPointTransform(t),v=f.x,g=f.y;a._isHorizontal?(l=v,u=a._track.attribute.width,c=i):(l=g,u=a._track.attribute.height,c=n);var y=l-a._prePos;if(d){var m=a._isHorizontal?d.attribute.x:d.attribute.y,_=s?he(m+y,u,c):he(m+y,0,c-u),b=a.calculateValueByPos(_);a._updateHandler(d,_,b)}if(p){var x=a._isHorizontal?p.attribute.x:p.attribute.y,k=s?he(x+y,0,c-u):he(x+y,u,c),S=a.calculateValueByPos(k),A=null==d?void 0:d.attribute;a._updateHandler(p,k,S),a._track.setAttributes(a._isHorizontal?{x:Math.min(A.x,p.attribute.x),width:Math.abs(A.x-p.attribute.x)}:{y:Math.min(A.y,p.attribute.y),height:Math.abs(A.y-p.attribute.y)})}a._prePos=l,a._dispatchChangeEvent()}},a._onTrackPointerUp=function(t){a._isChanging=!1,a._clearAllDragEvents()},a._onRailPointerDown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.attribute,i=(e.railWidth,e.railHeight,e.min);if(e.max!==i){var n,r,o,s=a._startHandler,l=a._endHandler;a._isHorizontal?(n=t.viewX-a._rail.globalAABBBounds.x1,r=null==s?void 0:s.attribute.x,o=null==l?void 0:l.attribute.x):(n=t.viewY-a._rail.globalAABBBounds.y1,r=null==s?void 0:s.attribute.y,o=null==l?void 0:l.attribute.y);var u=a.calculateValueByPos(n);if(W(o)){var c=Math.abs(n-r)>Math.abs(n-o)?l:s;a._updateHandler(c,n,u)}else a._updateHandler(s,n,u);a._updateTrack(),a._dispatchChangeEvent()}},a}return h(e,t),o(e,[{key:"track",get:function(){return this._track}},{key:"currentValue",get:function(){return this._currentValue}},{key:"startHandler",get:function(){return this._startHandler}},{key:"endHandler",get:function(){return this._endHandler}},{key:"tooltipShape",get:function(){return this._tooltipShape}},{key:"calculatePosByValue",value:function(t,e){var i,n=this.attribute,r=n.layout,a=n.railWidth,o=n.railHeight,s=n.min,l=n.max;return i=s===l?"start"===e?0:"end"===e?1:0:(t-s)/(l-s),(n.inverse?1-i:i)*("vertical"===r?o:a)}},{key:"calculateValueByPos",value:function(t){var e=this.attribute,i=e.layout,n=e.railWidth,r=e.railHeight,a=e.min,o="vertical"===i?r:n;return a+(e.max-a)*(e.inverse?1-t/o:t/o)}},{key:"setValue",value:function(t){var e=this.attribute,i=e.min;if(e.max!==i){var n=m(Dt(t),2),r=n[0],a=n[1],o=this._getHandlers(),s=o.startHandler,l=o.endHandler;s&&this._updateHandler(s,this.calculatePosByValue(r),r),l&&this._updateHandler(l,this.calculatePosByValue(a),a),this._updateTrack()}}},{key:"render",value:function(){var t,e;this.removeAllChild(!0);var i=this.attribute,n=i.layout,r=void 0===n?"horizontal":n,a=i.railWidth,o=i.railHeight,s=i.startText,l=i.endText,u=i.min,c=i.max,h=i.showHandler,d=void 0===h||h,p=i.showTooltip,f=this.attribute.value;j(f)&&(f=[u,c]),this._currentValue={startValue:xN(f)[0],endValue:xN(f)[1]};var v="horizontal"===r;this._isHorizontal=v;var g=B_.group({x:0,y:0});g.name=_N.innerView,this.add(g),this._innerView=g;var y,m=0;if(s&&s.visible){(y=B_.text(Object.assign({x:v?0:a/2,y:v?o/2:0,textAlign:v?"start":"center",textBaseline:v?"middle":"top",text:s.text,lineHeight:null===(t=s.style)||void 0===t?void 0:t.fontSize},s.style))).name=_N.startText,g.add(y);var _=W(s.space)?s.space:0;m+=(v?y.AABBBounds.width():y.AABBBounds.height())+_}var b=B_.group({x:v?m:0,y:v?0:m});g.add(b);var x,k=B_.group({x:0,y:0});if(k.name=_N.railContainer,this._railContainer=k,b.add(k),this._mainContainer=b,this._renderRail(k),m+=v?a:o,l&&l.visible){var S=W(l.space)?l.space:0;(x=B_.text(Object.assign({x:v?m+S:a/2,y:v?o/2:m+S,textAlign:v?"start":"center",textBaseline:v?"middle":"top",text:l.text,lineHeight:null===(e=l.style)||void 0===e?void 0:e.fontSize},l.style))).name=_N.endText,g.add(x)}this._renderTrack(k),d&&(this._renderHandlers(b),this._bindEvents()),p&&(this._renderTooltip(),this._bindTooltipEvents())}},{key:"_renderRail",value:function(t){var e=this.attribute,i=e.railWidth,n=e.railHeight,r=e.railStyle,a="default";!1!==e.slidable&&(a="pointer");var o=B_.rect(Object.assign({x:0,y:0,width:i,height:n,cursor:a},r));return o.name=_N.rail,t.add(o),this._rail=o,o}},{key:"_renderHandlers",value:function(t){var e=this.attribute,i=e.range,n=e.min,r=e.max,a=e.handlerSize,o=void 0===a?14:a,s=e.handlerStyle,l=e.handlerText,u=e.railHeight,c=e.railWidth,h=e.slidable,d=this.attribute.value;j(d)&&(d=[n,r]);var p=l&&l.visible,f=this._isHorizontal,v=m(xN(d),2),g=v[0],y=v[1],_=this.calculatePosByValue(g,i?"start":"end"),b=this._renderHandler(Object.assign({x:f?_:c/2,y:f?u/2:_,size:o,strokeBoundsBuffer:0,cursor:!1===h?"default":kN(f)},s));if(b.name=_N.startHandler,this._startHandler=b,t.add(b),this._currentValue.startPos=_,p){var x=this._renderHandlerText(g,i?"start":"end");x.name=_N.startHandlerText,t.add(x),this._startHandlerText=x}if(i){var k=this.calculatePosByValue(y,"end"),S=this._renderHandler(Object.assign({x:f?k:c/2,y:f?u/2:k,size:o,strokeBoundsBuffer:0,cursor:!1===h?"default":kN(f)},s));if(S.name=_N.endHandler,this._endHandler=S,t.add(S),this._currentValue.endPos=k,p){var A=this._renderHandlerText(y,"end");A.name=_N.endHandlerText,t.add(A),this._endHandlerText=A}}}},{key:"_renderTrack",value:function(t){var e,i,n=this.attribute,r=n.range,a=n.min,o=n.max,s=n.railHeight,l=n.railWidth,u=n.trackStyle,c=n.railStyle,h=n.slidable,d=n.value;if(j(d))r?(e=a,i=o):e=i=a;else if(r){var p=de(d,a,o);e=p[0],i=p[1]}else e=a,i=he(d,a,o);var f=this._isHorizontal;r||(e=a);var v=B_.group({x:0,y:0,width:l,height:s,cornerRadius:null==c?void 0:c.cornerRadius,clip:!0,pickable:!1});v.name=_N.trackContainer;var g,y=G(r)&&!0===r.draggableTrack;g=!1===h?"default":!1===r||!1===y?"pointer":kN(f);var m=this.calculatePosByValue(e,"start"),_=this.calculatePosByValue(i,r?"end":"start"),b=B_.rect(Object.assign({x:f?Math.min(m,_):0,y:f?0:Math.min(m,_),width:f?Math.abs(_-m):l,height:f?s:Math.abs(_-m),cursor:g},u));b.name=_N.track,this._track=b,v.add(b),t.add(v)}},{key:"_renderHandler",value:function(t){return B_.symbol(t)}},{key:"_renderHandlerText",value:function(t,e){var i,n,r,a=this.attribute,o=a.align,s=a.handlerSize,l=void 0===s?14:s,u=a.handlerText,c=void 0===u?{}:u,h=a.railHeight,d=a.railWidth,p=a.slidable,f=this._isHorizontal,v=this.calculatePosByValue(t,e),g=null!==(i=c.space)&&void 0!==i?i:4,y={text:c.formatter?c.formatter(t):t.toFixed(null!==(n=c.precision)&&void 0!==n?n:0),lineHeight:null===(r=c.style)||void 0===r?void 0:r.lineHeight,cursor:!1===p?"default":kN(f)};return f?"top"===o?(y.textBaseline="bottom",y.textAlign="center",y.x=v,y.y=(h-l)/2-g):(y.textBaseline="top",y.textAlign="center",y.x=v,y.y=(h+l)/2+g):"left"===o?(y.textBaseline="middle",y.textAlign="end",y.x=(d-l)/2-g,y.y=v):(y.textBaseline="middle",y.textAlign="start",y.x=(d+l)/2+g,y.y=v),B_.text(Object.assign(Object.assign({},y),c.style))}},{key:"_renderTooltip",value:function(){var t,e=this.attribute,i=e.tooltip,n=e.railHeight,r=e.railWidth,a=e.align;i&&i.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;var o=this._isHorizontal?0:r/2,s=this._isHorizontal?n/2:0;if(i&&i.shape){var l=B_.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:o,y:s,symbolType:"circle"},i.shapeStyle));this._tooltipShape=l,this._mainContainer.add(l)}var u=i&&i.text||{},c=null!==(t=u.space)&&void 0!==t?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=o,h.y="top"===a?s-n/2-c:s+n/2+c,h.textAlign="center",h.textBaseline="top"===a?"bottom":"top"):(h.y=s,h.x="left"===a?o-r/2-c:s+r/2+c,h.textAlign="left"===a?"end":"start",h.textBaseline="middle");var d=B_.text(Object.assign(Object.assign({},h),u.style));this._mainContainer.add(d),this._tooltipText=d,this._tooltipState&&this._updateTooltip()}},{key:"_updateTooltip",value:function(){var t,e;if((this._tooltipShape||this._tooltipText)&&this._tooltipState){var i=this.attribute,n=i.railWidth,r=i.railHeight,a=this._isHorizontal?n:r,o=this._tooltipState.pos*a,s=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes(l({visible:!0},s,o));var u=this.attribute.align;if(this._tooltipText){var c=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes(l(l({visible:!0},s,o),"text",c.formatter?c.formatter(this._tooltipState.value):this._isHorizontal||"left"!==u?"≈ ".concat(this._tooltipState.value.toFixed(null!==(e=c.precision)&&void 0!==e?e:0)):"".concat(this._tooltipState.value.toFixed(null!==(t=c.precision)&&void 0!==t?t:0)," ≈")))}}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.slidable,i=t.range;e&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),G(i)&&i.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),("browser"===tS.env?tS:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}}},{key:"_bindTooltipEvents",value:function(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}},{key:"_clearAllDragEvents",value:function(){var t=this,e=AP(),i="browser"===tS.env?tS:this.stage;i.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onHandlerPointerUp)})),i.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onTrackPointerUp)}))}},{key:"_updateTrack",value:function(){var t=this.attribute,e=t.inverse,i=t.railWidth,n=t.railHeight,r=this._startHandler,a=this._endHandler;if(this._isHorizontal){var o=null==r?void 0:r.attribute.x;if(a){var s=null==a?void 0:a.attribute.x;this._track.setAttributes({x:Math.min(o,s),width:Math.abs(o-s)})}else e?this._track.setAttributes({x:o,width:i-o}):this._track.setAttributes({width:o})}else{var l=null==r?void 0:r.attribute.y;if(a){var u=null==a?void 0:a.attribute.y;this._track.setAttributes({y:Math.min(l,u),height:Math.abs(l-u)})}else e?this._track.setAttributes({y:l,height:n-l}):this._track.setAttributes({height:l})}}},{key:"_updateHandler",value:function(t,e,i){var n,r=this._isHorizontal;t.setAttribute(r?"x":"y",e);var a=t.name===_N.startHandler?this._startHandlerText:this._endHandlerText;if(a){var o=this.attribute.handlerText,s=void 0===o?{}:o;a.setAttributes(l({text:s.formatter?s.formatter(i):i.toFixed(null!==(n=s.precision)&&void 0!==n?n:0)},r?"x":"y",e))}t.name===_N.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_updateHandlerText",value:function(t,e,i){var n,r=this._isHorizontal,a=this.attribute.handlerText,o=void 0===a?{}:a;t.setAttributes(l(l({},r?"x":"y",e),"text",o.formatter?o.formatter(i):i.toFixed(null!==(n=o.precision)&&void 0!==n?n:0)));var s=t.name===_N.startHandlerText?this._startHandler:this._endHandler;s&&s.setAttributes(l({},r?"x":"y",e)),t.name===_N.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_dispatchChangeEvent",value:function(){var t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}},{key:"_dispatchTooltipEvent",value:function(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}},{key:"_getHandlers",value:function(){var t,e,i=this.attribute.inverse,n=this._startHandler,r=this._endHandler;return r?(this._isHorizontal?(!i&&r.attribute.x<(null==n?void 0:n.attribute.x)||i&&r.attribute.x>(null==n?void 0:n.attribute.x))&&(n=(t=[r,n])[0],r=t[1]):(!i&&r.attribute.y<(null==n?void 0:n.attribute.y)||i&&r.attribute.y>(null==n?void 0:n.attribute.y))&&(n=(e=[r,n])[0],r=e[1]),{startHandler:n,endHandler:r}):{startHandler:n,endHandler:r}}},{key:"release",value:function(t){_(e,"release",this,3)([t]),("browser"===tS.env?tS:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}])}($A);SN.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}},gN(),vN();var AN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="colorLegend",a._onSliderToolipChange=function(t){var e=a._slider.tooltipShape;if(e&&t.detail&&!j(t.detail.value)){var i=a._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}a.dispatchEvent(t)},a._onSliderChange=function(t){a._updateColor(),a.dispatchEvent(t)},a}return h(e,t),o(e,[{key:"setSelected",value:function(t){this._slider&&(this._slider.setValue(t),this._updateColor())}},{key:"_renderContent",value:function(){for(var t=this.attribute,e=t.colors,i=t.slidable,n=t.layout,r=t.align,a=t.min,o=t.max,s=t.value,l=t.railWidth,u=t.railHeight,c=t.showHandler,h=void 0===c||c,d=t.handlerSize,p=t.handlerStyle,f=t.railStyle,v=t.trackStyle,g=t.startText,y=t.endText,m=t.handlerText,_=t.showTooltip,b=t.tooltip,x=t.inverse,k=t.disableTriggerEvent,S=[],A=(o-a)/(e.length-1),C=0;C<e.length;C++)S.push(a+A*C);this._colorScale=(new YO).domain(S,!0).range(e),this._color=this._getTrackColor();var M=new SN({x:0,y:0,range:{draggableTrack:!0},slidable:i,layout:n,align:r,min:a,max:o,value:s,railWidth:l,railHeight:u,showHandler:h,handlerSize:d,handlerStyle:p,railStyle:f,trackStyle:Object.assign({fill:this._color},v),startText:g,endText:y,handlerText:m,showTooltip:_,tooltip:b,disableTriggerEvent:k,inverse:x});this._innerView.add(M),this._slider=M,M.translateTo(0-M.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+ht(this.attribute,"title.space",12):0)-M.AABBBounds.y1),this._updateColor()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}},{key:"_getTrackColor",value:function(){var t=this.attribute,e=t.colors,i=t.layout,n=t.inverse;if(!ct(e)){var r=e.length;if(1===r)return e[0];for(var a=[],o=0;o<r;o++){var s=o/(r-1);a.push({offset:s,color:e[o]})}var l="horizontal"===i,u={gradient:"linear",stops:a,x0:0,y0:0,x1:l?1:0,y1:l?0:1};return n&&(l?(u.x0=1,u.x1=0):(u.y0=1,u.y1=0)),u}}},{key:"_updateColor",value:function(){var t,e=this.attribute,i=e.layout,n=void 0===i?"horizontal":i,r=e.colors,a=e.railWidth,o=e.railHeight,s=this._slider,l=s.startHandler,u=s.endHandler,c=s.track,h=s.attribute,d=this._slider.currentValue,p=d.startValue,f=d.endValue,v=d.startPos,g=d.endPos,y=null===(t=h.handlerStyle)||void 0===t?void 0:t.fill;if(l&&!y){var m=this._colorScale.scale(p);l.setAttribute("fill",m)}if(u&&!y){var _=this._colorScale.scale(f);u.setAttribute("fill",_)}var b="horizontal"===n?a:o;if(Math.abs(v-g)!==b&&r&&r.length>1){var x=this._color.stops,k=Math.min(v,g),S=Math.max(v,g),A=k/b,C=S/b,M=C-A,w=x.filter((function(t){return t.offset>A&&t.offset<C})),T=Math.min(p,f),D=Math.max(p,f),E=this._colorScale.scale(T),B=this._colorScale.scale(D),P=[{offset:0,color:E}];w.forEach((function(t){P.push({offset:(t.offset-A)/M,color:t.color})})),P.push({offset:1,color:B}),c.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:P}))}}}])}(fN);function CN(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom",e=0;return"top"===t?"\n    M".concat(e,",-6L").concat(e-3.5,",-2.5\n    v5\n    h7\n    v-5\n    Z\n"):"left"===t?"\n    M".concat((e=1)-6,",0L").concat(e-6+2.5,",-3.5\n    h5\n    v7\n    h-5\n    Z\n"):"right"===t?"\n    M".concat((e=-1)+6,",0L").concat(e+6-2.5,",-3.5\n    h-5\n    v7\n    h5\n    Z\n  "):"\n    M".concat(e,",6L").concat(e-3.5,",2.5\n    v-5\n    h7\n    v5\n    Z\n")}AN.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}},gN(),vN(),QB();var MN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="sizeLegend",a._onSliderChange=function(t){a.dispatchEvent(t)},a._onSliderToolipChange=function(t){a.dispatchEvent(t)},a}return h(e,t),o(e,[{key:"setSelected",value:function(t){this._slider&&this._slider.setValue(t)}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.slidable,i=t.layout,n=t.align,r=t.min,a=t.max,o=t.value,s=t.railWidth,l=t.railHeight,u=t.showHandler,c=void 0===u||u,h=t.handlerSize,d=t.handlerStyle,p=t.railStyle,f=t.trackStyle,v=t.startText,g=t.endText,y=t.handlerText,m=t.showTooltip,_=t.tooltip,b=t.sizeBackground,x=t.disableTriggerEvent,k=t.inverse,S=B_.group({x:0,y:0});this._innerView.add(S);var A=new SN({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:e,layout:i,align:n,min:r,max:a,value:o,railWidth:s,railHeight:l,showHandler:c,handlerSize:h,handlerStyle:Object.assign({symbolType:CN(n)},d),railStyle:p,trackStyle:f,startText:v,endText:g,handlerText:y,showTooltip:m,tooltip:_,disableTriggerEvent:x,inverse:k});S.add(A);var C,M=0;"horizontal"===i?"top"===n?(C="M0,0L".concat(s,",0L").concat(k?0:s,",12Z"),M=l):(C="M0,12L".concat(s,",12L").concat(k?0:s,",0Z"),A.setAttribute("y",12)):"left"===n?C="M".concat(s,",0L").concat(s+12,",").concat(k?0:l,"L").concat(s,",").concat(l,"Z"):(C="M0,".concat(k?0:l,"L12,").concat(l,"L12,0Z"),A.setAttribute("x",12));var w=B_.path(Object.assign(Object.assign({x:0,y:M,path:C},b),{zIndex:0}));S.add(w);var T=this._title?this._title.AABBBounds.height()+ht(this.attribute,"title.space",12):0;S.translate(0-S.AABBBounds.x1,T-S.AABBBounds.y1),this._slider=A}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}])}(fN);MN.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}},YB(),fP(),lP();var wN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="title",a}return h(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b=this.attribute,x=b.textType,k=b.text,S=b.subtextType,A=b.textStyle,C=void 0===A?{}:A,M=b.subtext,w=b.subtextStyle,T=void 0===w?{}:w,D=b.width,E=b.height,B=b.minWidth,P=b.maxWidth,R=b.minHeight,L=b.maxHeight,I=b.align,F=b.verticalAlign,O=b.padding,z=rr(void 0===O?0:O),H=this.createOrUpdateChild("title-container",{x:z[3],y:z[0],zIndex:1},"group"),N=null!==(t=C.height)&&void 0!==t?t:E;if(!1!==this.attribute.visible&&!1!==C.visible){var U=C.width,j=C.maxHeight,V=C.maxWidth,G=C.x,Y=void 0===G?0:G,X=C.y,K=void 0===X?0:X,q=C.ellipsis,J=void 0===q||q,Q=C.wordBreak,$=void 0===Q?"break-word":Q,tt=C.maxWidth,et=C.lineClamp;if("rich"===x||W(C.character)){var it=Object.assign({x:Y,y:K,width:null!==(e=null!=U?U:D)&&void 0!==e?e:0,height:null!=N?N:0,ellipsis:null==J||J,wordBreak:null!=$?$:"break-word",maxHeight:null!=j?j:L,maxWidth:null!=V?V:tt,textConfig:null!==(i=C.character)&&void 0!==i?i:k},C);this._mainTitle=H.createOrUpdateChild("mainTitle",it,"richtext")}else if("html"===x){var nt=Object.assign({html:Object.assign(Object.assign({dom:k},kP),C),x:Y,y:K,width:null!==(n=null!=U?U:D)&&void 0!==n?n:0,height:null!=N?N:0,ellipsis:J,wordBreak:$,maxHeight:null!=j?j:L,maxWidth:null!=V?V:tt,textConfig:[]},C);this._mainTitle=H.createOrUpdateChild("mainTitle",nt,"richtext")}else W(k)&&(this._mainTitle=H.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:Z(k)?k:[k],whiteSpace:"normal"},C),{maxLineWidth:null!==(a=null!==(r=C.maxLineWidth)&&void 0!==r?r:U)&&void 0!==a?a:D,heightLimit:null!==(o=C.height)&&void 0!==o?o:L,lineClamp:et,ellipsis:J,x:Y,y:K}),"text"))}var rt=this._mainTitle?this._mainTitle.AABBBounds.height():0,at=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==T.visible){var ot=T.width,st=T.height,lt=T.maxWidth,ut=T.maxHeight,ct=T.x,ht=void 0===ct?0:ct,dt=T.y,pt=void 0===dt?0:dt,ft=T.ellipsis,vt=void 0===ft||ft,gt=T.wordBreak,yt=void 0===gt?"break-word":gt,mt=T.lineClamp,_t=Math.max(Number.MIN_VALUE,L-rt);if("rich"===S||W(T.character)){var bt=Object.assign({x:ht,y:pt,width:null!==(s=null!=ot?ot:D)&&void 0!==s?s:0,height:null!==(l=null!=st?st:E)&&void 0!==l?l:0,ellipsis:vt,wordBreak:yt,maxHeight:null!=ut?ut:_t,maxWidth:null!=lt?lt:P,textConfig:null!==(u=T.character)&&void 0!==u?u:M},T);this._subTitle=H.createOrUpdateChild("subTitle",bt,"richtext")}else if("html"===S){var xt=Object.assign({html:Object.assign(Object.assign({dom:M},kP),T),x:ht,y:pt,width:null!==(c=null!=ot?ot:D)&&void 0!==c?c:0,height:null!==(h=null!=st?st:E)&&void 0!==h?h:0,ellipsis:vt,wordBreak:yt,maxHeight:null!=ut?ut:_t,maxWidth:null!=lt?lt:P,textConfig:[]},T);this._subTitle=H.createOrUpdateChild("subTitle",xt,"richtext")}else W(M)&&(this._subTitle=H.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:Z(M)?M:[M],whiteSpace:"normal"},T),{maxLineWidth:null!==(d=T.maxLineWidth)&&void 0!==d?d:D,heightLimit:null!==(p=T.heightLimit)&&void 0!==p?p:_t,lineClamp:mt,ellipsis:vt,x:0,y:rt}),"text"))}var kt=this._subTitle?this._subTitle.AABBBounds.height():0,St=this._subTitle?this._subTitle.AABBBounds.width():0,At=Math.max(at,St),Ct=rt+(null!==(f=T.height)&&void 0!==f?f:kt);if(W(D)&&(At=D),W(E)&&(Ct=E),W(B)&&At<B&&(At=B),W(P)&&At>P&&(At=P),W(R)&&Ct<R&&(Ct=R),W(L)&&Ct>L&&(Ct=L),H.attribute.width=At,H.attribute.height=Ct,H.attribute.boundsPadding=z,this._mainTitle){if(W(I)||W(C.align)){var Mt=C.align?C.align:I,wt=null!==(v=C.width)&&void 0!==v?v:At;"center"===Mt?(this._mainTitle.setAttribute("x",wt/2),this._mainTitle.setAttribute("textAlign","center")):"right"===Mt?(this._mainTitle.setAttribute("x",wt),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}var Tt=C.verticalAlign?C.verticalAlign:F,Dt=null!=N?N:this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height();"middle"===Tt?(this._mainTitle.setAttribute("y",Dt/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===Tt?(this._mainTitle.setAttribute("y",Dt),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if(W(I)||W(T.align)){var Et=T.align?T.align:I,Bt=null!==(y=null!==(g=T.width)&&void 0!==g?g:C.width)&&void 0!==y?y:At;"center"===Et?(this._subTitle.setAttribute("x",Bt/2),this._subTitle.setAttribute("textAlign","center")):"right"===Et?(this._subTitle.setAttribute("x",Bt),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}var Pt=T.verticalAlign?T.verticalAlign:F,Rt=this._mainTitle?W(N)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),N):this._mainTitle.AABBBounds.y2:0,Lt=null!==(_=null!==(m=T.height)&&void 0!==m?m:E)&&void 0!==_?_:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();"middle"===Pt?(this._subTitle.setAttribute("y",Rt+Lt/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===Pt?(this._subTitle.setAttribute("y",Rt+Lt),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",Rt),this._subTitle.setAttribute("textBaseline","top"))}}}])}($A);wN.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};var TN={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};YB(),fP(),lP();var DN,EN,BN=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="indicator",t}return h(e,t),o(e,[{key:"_renderText",value:function(t,e,i,n,r,a){if(!1!==e.visible){var o=mt({},ht(TN,r),e.style,{visible:e.visible});o.lineHeight=W(o.lineHeight)?o.lineHeight:o.fontSize,e.formatMethod&&(o._originText=o.text,o.text=e.formatMethod(o.text,o));var s=qP(o);return s.name=a,t.appendChild(s),e.autoFit&&it(i)&&this._setLocalAutoFit(i,s,e),e.autoLimit&&it(n)&&s.setAttribute("maxLineWidth",i),s}}},{key:"render",value:function(){var t,e,i=this;if(this.removeAllChild(!0),!0===this.attribute.visible){var n=this.attribute,r=n.title,a=void 0===r?{}:r,o=n.content,s=n.size,l=n.limitRatio,u=void 0===l?1/0:l,c=Math.min(s.width,s.height)*u,h=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:null===(t=this.attribute.pickable)||void 0===t||t},"group");if(W(a)&&(this._title=this._renderText(h,a,c,u,"title.style","indicator-title")),W(o)){var d=Dt(o),p=[];d.forEach((function(t,e){!1!==t.visible&&p.push(i._renderText(h,t,c,u,"content.style","indicator-content-"+e))})),this._content=p}this._setGlobalAutoFit(c),this._setYPosition();var f=null!==(e=null==h?void 0:h.AABBBounds.height())&&void 0!==e?e:0;h.setAttribute("y",s.height/2-f/2),h.setAttribute("x",s.width/2)}}},{key:"_setLocalAutoFit",value:function(t,e,i){var n,r,a,o,s,l,u,c,h;if("default"===(null!==(n=i.fitStrategy)&&void 0!==n?n:"default")){var d=YP(null!==(a=null===(r=i.style)||void 0===r?void 0:r.text)&&void 0!==a?a:"",null!==(o=i.style)&&void 0!==o?o:{},null===(l=null===(s=this.stage)||void 0===s?void 0:s.getTheme())||void 0===l?void 0:l.text).width;if(d>0){var p=t*(null!==(u=i.fitPercent)&&void 0!==u?u:.5)/d,f=Math.floor((null!==(h=null===(c=i.style)||void 0===c?void 0:c.fontSize)&&void 0!==h?h:20)*p);e.setAttribute("fontSize",f),e.setAttribute("lineHeight",W(i.style.lineHeight)?i.style.lineHeight:f)}}}},{key:"_setGlobalAutoFit",value:function(t){var e,i,n,r,a,o,s,l=this,u=t/2,c=[],h=0,d=null!==(e=this.attribute.title)&&void 0!==e?e:{};d.autoFit&&"inscribed"===d.fitStrategy?(this._title.setAttribute("fontSize",12),c.push({text:this._title,spec:null!==(i=this.attribute.title)&&void 0!==i?i:{}})):h+=null!==(o=null===(a=null===(r=null===(n=this._title)||void 0===n?void 0:n.AABBBounds)||void 0===r?void 0:r.height)||void 0===a?void 0:a.call(r))&&void 0!==o?o:0;var p=null!==(s=d.space)&&void 0!==s?s:0;if(h+=p,Dt(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n,r,a,o=l._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(o.setAttribute("fontSize",12),c.push({text:o,spec:t})):h+=null!==(r=null===(n=null===(i=null==o?void 0:o.AABBBounds)||void 0===i?void 0:i.height)||void 0===n?void 0:n.call(i))&&void 0!==r?r:0;var s=null!==(a=t.space)&&void 0!==a?a:0;h+=s})),!(c.length<=0)){var f=12/c.reduce((function(t,e){return Math.max(t,e.text.AABBBounds.width())}),0)*c.length,v=h/2,g=Math.pow(f,2)+1,y=2*v*f,m=Math.pow(v,2)-Math.pow(u,2),_=2*(f*((-y+Math.sqrt(Math.pow(y,2)-4*g*m))/(2*g))+v),b=(_-h)/c.length;it(_)&&c.forEach((function(t){var e,i=null===(e=t.spec.style)||void 0===e?void 0:e.lineHeight;t.text.setAttribute("fontSize",b),t.text.setAttribute("lineHeight",W(i)?i:b)}))}}},{key:"_setYPosition",value:function(){var t,e,i,n,r,a,o=this,s=0,l=null!==(n=null===(i=null===(e=null===(t=this._title)||void 0===t?void 0:t.AABBBounds)||void 0===e?void 0:e.height)||void 0===i?void 0:i.call(e))&&void 0!==n?n:0,u=null!==(a=null===(r=this.attribute.title)||void 0===r?void 0:r.space)&&void 0!==a?a:0;Dt(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n=o._content[e];n.setAttribute("y",l+u+s);var r=null!==(i=t.space)&&void 0!==i?i:0;s+=n.AABBBounds.height()+r}))}}])}($A),PN=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e)}(zm);!function(t){t.OnPlay="onPlay",t.OnPause="onPause",t.OnForward="onForward",t.OnBackward="onBackward"}(DN||(DN={})),function(t){t.Start="start",t.Pause="pause",t.Forward="forward",t.Backward="backward"}(EN||(EN={}));var RN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)]))._isPaused=!0,a.updateAttributes=function(){a._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},e.defaultControllerAttr),{visible:a.attribute.start.visible}),a.attribute.start.style)},a._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},e.defaultControllerAttr),{visible:a.attribute.pause.visible}),a.attribute.pause.style)},a._forwardAttr={style:Object.assign(Object.assign(Object.assign({},e.defaultControllerAttr),{visible:a.attribute.forward.visible}),a.attribute.forward.style)},a._backwardAttr={style:Object.assign(Object.assign(Object.assign({},e.defaultControllerAttr),{visible:a.attribute.backward.visible}),a.attribute.backward.style)},a.updateLayout()},a.updateLayout=function(){var t,e,i,n;a._layout=a.attribute.layout,"horizontal"===a._layout?(a._backwardAttr.style.symbolType=null!==(t=a._backwardAttr.style.symbolType)&&void 0!==t?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",a._forwardAttr.style.symbolType=null!==(e=a._forwardAttr.style.symbolType)&&void 0!==e?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===a._layout&&(a._backwardAttr.style.symbolType=null!==(i=a._backwardAttr.style.symbolType)&&void 0!==i?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",a._forwardAttr.style.symbolType=null!==(n=a._forwardAttr.style.symbolType)&&void 0!==n?n:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},a._initPlay=function(){j(a._playController)&&(a._playController=new PN(Object.assign({},a._startAttr.style)),a.add(a._playController))},a._initBackward=function(){j(a._backwardController)&&(a._backwardController=new PN(Object.assign({},a._backwardAttr.style)),a.add(a._backwardController))},a._initForward=function(){j(a._forwardController)&&(a._forwardController=new PN(Object.assign({},a._forwardAttr.style)),a.add(a._forwardController))},a._initEvents=function(){a.attribute.disableTriggerEvent||(a._playController.addEventListener("pointerdown",(function(t){t.stopPropagation(),!0===a._isPaused?a.play():a.pause()})),a._backwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),a.backward()})),a._forwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),a.forward()})))},a.renderPlay=function(){a._isPaused?a._playController.setAttributes(Object.assign({symbolType:a._playController.getComputedAttribute("symbolType")},a._startAttr.style)):a._playController.setAttributes(Object.assign({symbolType:a._playController.getComputedAttribute("symbolType")},a._pauseAttr.style))},a.renderBackward=function(){a._backwardController.setAttributes(a._backwardAttr.style)},a.renderForward=function(){a._forwardController.setAttributes(a._forwardAttr.style)},a.play=function(){a._dispatchEvent(DN.OnPlay)},a.pause=function(){a._dispatchEvent(DN.OnPause)},a.forward=function(){a._dispatchEvent(DN.OnForward)},a.backward=function(){a._dispatchEvent(DN.OnBackward)},a.togglePlay=function(){a._playController.setAttributes(a._startAttr.style),a._isPaused=!0},a.togglePause=function(){a._playController.setAttributes(a._pauseAttr.style),a._isPaused=!1},a.updateAttributes(),a._initPlay(),a._initBackward(),a._initForward(),a._initEvents(),a}return h(e,t),o(e,[{key:"render",value:function(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}])}($A);RN.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},RN.defaultAttributes=l(l(l(l({},EN.Start,{}),EN.Pause,{}),EN.Backward,{}),EN.Forward,{});var LN,IN,FN={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},ON=[200,10];!function(t){t.Default="default",t.Reverse="reverse"}(LN||(LN={})),function(t){t.change="change",t.play="play",t.pause="pause",t.backward="backward",t.forward="forward",t.end="end",t.OnChange="change",t.OnPlay="play",t.OnPause="pause",t.OnBackward="backward",t.OnForward="forward",t.OnEnd="end"}(IN||(IN={}));var zN=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===LN.Default&&n===i}({direction:e,maxIndex:i,dataIndex:r})||function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===LN.Reverse&&n===i}({direction:e,minIndex:n,dataIndex:r})},HN=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===LN.Default&&n===i}({direction:e,minIndex:n,dataIndex:r})||function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===LN.Reverse&&n===i}({direction:e,maxIndex:i,dataIndex:r})},NN=function(t){return"top"===t||"bottom"===t},UN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)]))._data=[],a._dataIndex=0,a._layoutInfo={},a._updateSliderAttrs=function(){var t,e,i;it(a._handlerStyle.size)?i=a._handlerStyle.size:a._handlerStyle.size&&a._handlerStyle.size.length&&(i=ai(a._handlerStyle.size[0],a._handlerStyle.size[1]));var n={visible:a._sliderVisible,min:a._minIndex,max:a._maxIndex,value:a._dataIndex,railWidth:a._railStyle.width,railHeight:a._railStyle.height,railStyle:a._railStyle,trackStyle:a._trackStyle,handlerSize:it(i)?i:void 0,handlerStyle:a._handlerStyle,dy:a.attribute.slider.dy,dx:a.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:a.attribute.disableTriggerEvent};if(NN(a._orient)){var r=Math.max(0,a._layoutInfo.slider.size),o=null!==(t=a._railStyle.height)&&void 0!==t?t:ON[1];n.layout="horizontal",n.railHeight=o,n.railWidth=r,n.x=a._layoutInfo.slider.x,n.y=a._layoutInfo.slider.y}else{var s=Math.max(0,a._layoutInfo.slider.size),l=null!==(e=a._railStyle.width)&&void 0!==e?e:ON[1];n.layout="vertical",n.railWidth=l,n.railHeight=s,n.x=a._layoutInfo.slider.x,n.y=a._layoutInfo.slider.y}return n},a._initSlider=function(){var t=a._updateSliderAttrs();a._slider=new SN(t),a._sliderVisible&&a.add(a._slider)},a._updateControllerAttrs=function(){var t={start:a._start,pause:a._pause,forward:a._forward,backward:a._backward,disableTriggerEvent:a.attribute.disableTriggerEvent};return t.layout=NN(a._orient)?"horizontal":"vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:a._layoutInfo.start.x,y:a._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:a._layoutInfo.start.x,y:a._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:a._layoutInfo.backward.x,y:a._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:a._layoutInfo.forward.x,y:a._layoutInfo.forward.y})}),t},a._initController=function(){var t=a._updateControllerAttrs();a._controller=new RN(t),a._controllerVisible&&a.add(a._controller)},a._initAttributes(),a._initDataIndex(),a._initLayoutInfo(),a._initController(),a._initSlider(),a}return h(e,t),o(e,[{key:"getMinIndex",value:function(){return this._minIndex}},{key:"getMaxIndex",value:function(){return this._maxIndex}},{key:"getDataIndex",value:function(){return this._dataIndex}},{key:"_initAttributes",value:function(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;var t=this.attribute,e=t.slider,i=void 0===e?{}:e,n=t.controller,r=void 0===n?{}:n;this._sliderVisible=i.visible,this._railStyle=Object.assign({},i.railStyle),this._trackStyle=Object.assign({},i.trackStyle),this._handlerStyle=Object.assign({},i.handlerStyle),this._controllerVisible=r.visible,this._start=Object.assign({},r.start),this._pause=Object.assign({},r.pause),this._forward=Object.assign({},r.forward),this._backward=Object.assign({},r.backward)}},{key:"_initDataIndex",value:function(){var t;this._dataIndex=null!==(t=this.attribute.dataIndex)&&void 0!==t?t:0}},{key:"_initLayoutInfo",value:function(){var t,e,i,n=this,r=[this._start,this._backward,this._forward].sort((function(t,e){return t.order-e.order})),a=r.filter((function(t){return"end"!==t.position})),o=r.filter((function(t){return"end"===t.position})),s=null!==(t=NN(this._orient)?this._railStyle.height:this._railStyle.width)&&void 0!==t?t:ON[1],l=r.reduce((function(t,e){var i=e.style.size,n=$(i)?i:ai(i[0],i[1]);return t+e.space+n}),0),u=this._sliderVisible?(NN(this._orient)?null===(e=this._size)||void 0===e?void 0:e.width:null===(i=this._size)||void 0===i?void 0:i.height)-l:0,c=u-this.attribute.slider.space,h=a.reduce((function(t,e){var i=e.key,r=e.space,a=e.style.size,o=$(a)?a:ai(a[0],a[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:o,x:NN(n._orient)?t+r:(n._size.width-o)/2,y:NN(n._orient)?(n._size.height-o)/2:t+r}),t+r+o}),0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:c,x:NN(this._orient)?h+this.attribute.slider.space:(this._size.width-s)/2,y:NN(this._orient)?(this._size.height-s)/2:h+this.attribute.slider.space}),o.reduce((function(t,e){var i=e.key,r=e.space,a=e.style.size,o=$(a)?a:ai(a[0],a[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:o,x:NN(n._orient)?t+r:(n._size.width-o)/2,y:NN(n._orient)?(n._size.height-o)/2:t+r}),t+r+o}),h+u)}},{key:"render",value:function(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}},{key:"renderSlider",value:function(){var t=this._updateSliderAttrs();this._slider.setAttributes(t)}},{key:"renderController",value:function(){var t=this._updateControllerAttrs();this._controller.setAttributes(t)}},{key:"dispatchCustomEvent",value:function(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}])}($A);function jN(){vN(),YB(),dP()}UN.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},FN),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},FN),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},FN),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},FN),{key:"backward",position:"start"})}},jN();var VN=function(t){function e(t,a){var o;return r(this,e),(o=n(this,e,[(null==a?void 0:a.skipDefault)?t:mt({},t)]))._activeIndex=-1,o._isReachEnd=!1,o._initAttributes=function(){var t,n,r;_((i(o),e),"_initAttributes",o,3)([]),o._alternate=null!==(t=o.attribute.alternate)&&void 0!==t&&t,o._interval=null!==(n=o.attribute.interval)&&void 0!==n?n:1e3,o._direction=null!==(r=o.attribute.direction)&&void 0!==r?r:LN.Default},o._initDataIndex=function(){var t;o._dataIndex=j(o.attribute.dataIndex)?"default"===o._direction?o._minIndex:o._maxIndex:null!==(t=o.attribute.dataIndex)&&void 0!==t?t:0,o._slider.setAttribute("value",o._dataIndex)},o._initEvents=function(){o.attribute.disableTriggerEvent||(o._controller.addEventListener(DN.OnPlay,(function(t){t.stopPropagation(),o.play()})),o._controller.addEventListener(DN.OnPause,(function(t){t.stopPropagation(),o.pause()})),o._controller.addEventListener(DN.OnForward,(function(t){t.stopPropagation(),o.forward()})),o._controller.addEventListener(DN.OnBackward,(function(t){t.stopPropagation(),o.backward()})),o._slider.addEventListener("change",(function(t){var e=Math.floor(t.detail.value)+.5;o._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),o._slider.setValue(o._dataIndex),o.dispatchCustomEvent(IN.change)})))},o.play=function(){o._isPlaying||1!==o._data.length&&(o._controller.togglePause(),o._isPlaying=!0,(zN({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction})||HN({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction}))&&(o._direction===LN.Default?o._updateDataIndex(o._minIndex):o._updateDataIndex(o._maxIndex)),o.dispatchCustomEvent(IN.play),o._isReachEnd=!1,o._tickTime=Date.now(),o._rafId=tS.getRequestAnimationFrame()(o._play.bind(i(o),!0)))},o._play=function(t){var e=Date.now();if(o._isReachEnd&&e-o._tickTime>=o._interval)return o._isReachEnd=!1,void o._playEnd();t&&o._activeIndex!==o._dataIndex?(o.dispatchCustomEvent(IN.change),o._activeIndex=o._dataIndex):e-o._tickTime>=o._interval&&(o._tickTime=e,o._updateDataIndex(function(t,e,i,n){return"default"===t?Math.min(e+1,n):Math.max(e-1,i)}(o._direction,o._dataIndex,o._minIndex,o._maxIndex)),o._activeIndex=o._dataIndex,o.dispatchCustomEvent(IN.change)),("default"===o._direction&&o._dataIndex>=o._maxIndex||"reverse"===o._direction&&o._dataIndex<=o._minIndex)&&(o._isReachEnd=!0),o._rafId=tS.getRequestAnimationFrame()(o._play.bind(i(o),!1))},o._updateDataIndex=function(t){o._dataIndex=t,o._slider.setValue(o._dataIndex)},o._playEnd=function(){o._isPlaying=!1,o._controller.togglePlay(),tS.getCancelAnimationFrame()(o._rafId),o._activeIndex=-1,o.dispatchCustomEvent(IN.end)},o.pause=function(){o._isPlaying&&(o._isPlaying=!1,tS.getCancelAnimationFrame()(o._rafId),o._controller.togglePlay(),o.dispatchCustomEvent(IN.pause))},o.backward=function(){var t,e=o.attribute.loop;t=void 0!==e&&e?o._dataIndex-1<o._minIndex?o._maxIndex:o._dataIndex-1:Math.max(o._dataIndex-1,o._minIndex),o._updateDataIndex(t),o.dispatchCustomEvent(IN.change),o.dispatchCustomEvent(IN.backward)},o.forward=function(){var t,e=o.attribute.loop;t=void 0!==e&&e?o._dataIndex+1>o._maxIndex?o._minIndex:o._dataIndex+1:Math.min(o._dataIndex+1,o._maxIndex),o._updateDataIndex(t),o.dispatchCustomEvent(IN.change),o.dispatchCustomEvent(IN.forward)},o._initAttributes(),o._initDataIndex(),o._initEvents(),o}return h(e,t),o(e,[{key:"setAttributes",value:function(t,i){_(e,"setAttributes",this,3)([t,i]),this._initAttributes()}},{key:"dispatchCustomEvent",value:function(t){_(e,"dispatchCustomEvent",this,3)([t,this._dataIndex])}}])}(UN),WN=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};jN();var GN,YN=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t]))._isPlaying=!1,a._startTime=Date.now(),a._initAttributes=function(){var t;_((i(a),e),"_initAttributes",a,3)([]),a._maxIndex=a._data.length,a._slider.setAttribute("max",a._maxIndex),a._isPlaying=!1,a._elapsed=0,a._interval=null!==(t=a.attribute.interval)&&void 0!==t?t:1e3;var n=a._data.length;a.attribute.totalDuration&&a._data.length?(a._totalDuration=a.attribute.totalDuration,a._interval=a._totalDuration/(null!=n?n:1)):(a._totalDuration=a._interval*n,a._interval=a.attribute.interval)},a._initDataIndex=function(){var t;a._dataIndex=null!==(t=a.attribute.dataIndex)&&void 0!==t?t:a._minIndex},a._initEvents=function(){a.attribute.disableTriggerEvent||(a._controller.addEventListener(DN.OnPlay,(function(t){t.stopPropagation(),a.play()})),a._controller.addEventListener(DN.OnPause,(function(t){t.stopPropagation(),a.pause()})),a._controller.addEventListener(DN.OnForward,(function(t){t.stopPropagation(),a.forward()})),a._controller.addEventListener(DN.OnBackward,(function(t){t.stopPropagation(),a.backward()})),a._slider.addEventListener("change",(function(t){var e;t.stopPropagation();var i=null===(e=t.detail)||void 0===e?void 0:e.value,n=i/a._maxIndex;a._elapsed=n*a._totalDuration,a._startTime=Date.now()-a._elapsed,a._dispatchChange(i)})))},a._getSliderValue=function(){var t=a._elapsed/a._totalDuration;return Math.min(t*a._maxIndex,a._maxIndex)},a._updateSlider=function(){var t=a._getSliderValue();a._dataIndex=Math.floor(t),a._slider.setValue(Math.min(t,a._maxIndex)),a._dispatchChange(Math.floor(t))},a._dispatchChange=function(t){var e=Math.floor(t);e!==a._activeIndex&&(a._dataIndex=e,a._activeIndex=e,e!==a._maxIndex&&a.dispatchCustomEvent(IN.change))},a.play=function(){return WN(i(a),void 0,void 0,f().m((function t(){return f().w((function(t){for(;;)switch(t.n){case 0:this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(IN.play),this._rafId=tS.getRequestAnimationFrame()(this._play.bind(this)));case 1:return t.a(2)}}),t,this)})))},a._play=function(){a._elapsed=Date.now()-a._startTime;var t=a._getSliderValue();a._updateSlider(),t>=a._maxIndex?a._playEnd():a._rafId=tS.getRequestAnimationFrame()(a._play.bind(i(a)))},a._playEnd=function(){a._isPlaying=!1,tS.getCancelAnimationFrame()(a._rafId),a._controller.togglePlay(),a.dispatchCustomEvent(IN.end)},a.pause=function(){a._isPlaying&&(a._isPlaying=!1,a._elapsed=Date.now()-a._startTime,tS.getCancelAnimationFrame()(a._rafId),a._controller.togglePlay(),a.dispatchCustomEvent(IN.pause))},a.backward=function(){var t=Date.now(),e=1*a._interval,i=a._elapsed-e;i<=0?(a._elapsed=0,a._startTime=t):(a._elapsed=i,a._startTime=a._startTime+a._interval),a._updateSlider(),a.dispatchCustomEvent(IN.backward)},a.forward=function(){var t=Date.now(),e=1*a._interval,i=a._elapsed+e;i>=a._totalDuration?(a._startTime=t-a._totalDuration,a._elapsed=a._totalDuration):(a._startTime=a._startTime-e,a._elapsed=i),a._updateSlider(),a.dispatchCustomEvent(IN.forward)},a._initAttributes(),a._initDataIndex(),a._initEvents(),a}return h(e,t),o(e,[{key:"dispatchCustomEvent",value:function(t){_(e,"dispatchCustomEvent",this,3)([t,this._dataIndex])}},{key:"render",value:function(){_(e,"render",this,3)([])}}])}(UN);!function(t){t.drawStart="drawStart",t.drawEnd="drawEnd",t.drawing="drawing",t.moving="moving",t.moveStart="moveStart",t.moveEnd="moveEnd",t.brushActive="brushActive",t.brushClear="brushClear"}(GN||(GN={}));var XN={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:["pointerup","pointerleave"],resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{minY:-1/0,maxY:1/0,minX:-1/0,maxX:1/0}};var KN={debounce:ve,throttle:ge};YB(),tP();var qN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t)])).name="brush",a._activeBrushState=!1,a._activeDrawState=!1,a._cacheDrawPoints=[],a._activeMoveState=!1,a._operatingMaskMoveDx=0,a._operatingMaskMoveDy=0,a._operatingMaskMoveRangeX=[-1/0,1/0],a._operatingMaskMoveRangeY=[-1/0,1/0],a._brushMaskAABBBoundsDict={},a._firstUpdate=!0,a._onBrushStart=function(t){var e=a.attribute,i=e.updateTrigger,n=void 0===i?XN.updateTrigger:i,r=e.endTrigger,o=void 0===r?XN.endTrigger:r,s=e.brushMoved,l=void 0===s||s;Dt(n).forEach((function(t){return a.stage.addEventListener(t,a._onBrushingWithDelay)})),Dt(o).forEach((function(t){return a.stage.addEventListener(t,a._onBrushEnd)})),t.stopPropagation(),a._firstUpdate=!0,a._activeMoveState=l&&a._isPosInBrushMask(t),a._activeDrawState=!a._activeMoveState,a._startPos=a.eventPosToStagePos(t),a._cacheDrawPoints=[a._startPos]},a._onBrushing=function(t){a._outOfInteractiveRange(t)||(t.stopPropagation(),a._firstUpdate?(a._activeDrawState&&a._initDraw(t),a._activeMoveState&&a._initMove(t),a._firstUpdate=!1):(a._activeDrawState&&a._drawing(t),a._activeMoveState&&a._moving(t)))},a._onBrushingWithDelay=0===a.attribute.delayTime?a._onBrushing:KN[a.attribute.delayType](a._onBrushing,a.attribute.delayTime),a._onBrushEnd=function(t){a._releaseBrushUpdateEvents(),t.preventDefault(),a._activeDrawState&&a._drawEnd(t),a._activeMoveState&&a._moveEnd(t),a._activeDrawState=!1,a._activeMoveState=!1},a._onBrushClear=function(t){t.preventDefault(),a._isEmptyMask()||(a._clearMask(),a._dispatchBrushEvent(GN.brushClear,t)),a._activeDrawState=!1,a._activeMoveState=!1},a}return h(e,t),o(e,[{key:"_bindBrushEvents",value:function(){var t=this;if(this.releaseBrushEvents(),!this.attribute.disableTriggerEvent){var e=this.attribute,i=e.trigger,n=void 0===i?XN.trigger:i,r=e.resetTrigger,a=void 0===r?XN.resetTrigger:r;Dt(n).forEach((function(e){return t.stage.addEventListener(e,t._onBrushStart)})),Dt(a).forEach((function(e){return t.stage.addEventListener(e,t._onBrushClear)}))}}},{key:"_initDraw",value:function(t){var e=this.attribute.brushMode,i=this.eventPosToStagePos(t);this._cacheDrawPoints.push(i),"single"===e&&this._clearMask(),this._addBrushMask(),this._dispatchBrushEvent(GN.drawStart,t),this._activeBrushState=!1}},{key:"_initMove",value:function(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!==(e=this._operatingMask.attribute.dx)&&void 0!==e?e:0,this._operatingMaskMoveDy=null!==(i=this._operatingMask.attribute.dy)&&void 0!==i?i:0;var n=this.attribute.interactiveRange,r=n.minY,a=void 0===r?-1/0:r,o=n.maxY,s=void 0===o?1/0:o,l=n.minX,u=void 0===l?-1/0:l,c=n.maxX,h=void 0===c?1/0:c,d=this._operatingMask.globalAABBBounds,p=u-d.x1,f=h-d.x2,v=a-d.y1,g=s-d.y2;this._operatingMaskMoveRangeX=[p,f],this._operatingMaskMoveRangeY=[v,g],this._operatingMask.setAttribute("pickable",!0),this._dispatchBrushEvent(GN.moveStart,t)}},{key:"_drawing",value:function(t){var e,i=this.eventPosToStagePos(t),n=this.attribute,r=n.brushType,a=n.sizeThreshold,o=void 0===a?5:a,s=this._cacheDrawPoints.length;if(s>0){var l=null!==(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])&&void 0!==e?e:{};if(i.x===l.x&&i.y===l.y)return}"polygon"===r||s<=1?this._cacheDrawPoints.push(i):this._cacheDrawPoints[s-1]=i;var u=this._computeMaskPoints();this._operatingMask.setAttribute("points",u);var c=this._startPos,h=c.x,d=c.y,p=this.eventPosToStagePos(t),f=p.x,v=p.y;(Math.abs(f-h)>o||Math.abs(d-v)>o)&&(1!==Object.keys(this._brushMaskAABBBoundsDict).length||this._activeBrushState?this._dispatchBrushEvent(GN.drawing,t):(this._activeBrushState=!0,this._dispatchBrushEvent(GN.brushActive,t)))}},{key:"_moving",value:function(t){var e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x!==(null==e?void 0:e.x)||i.y!==(null==e?void 0:e.y)){var n=i.x-e.x,r=i.y-e.y,a=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],n))+this._operatingMaskMoveDx,o=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],r))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:a,dy:o}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(GN.moving,t)}}},{key:"_drawEnd",value:function(t){var e=this.attribute,i=e.removeOnClick,n=void 0===i||i,r=e.sizeThreshold,a=void 0===r?5:r;if(this._outOfInteractiveRange(t))this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(GN.brushClear,t));else{var o=this._startPos,s=o.x,l=o.y,u=this.eventPosToStagePos(t),c=u.x,h=u.y;Math.abs(c-s)<=1&&Math.abs(h-l)<=1&&n?this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(GN.brushClear,t)):Math.abs(c-s)<a&&Math.abs(l-h)<a?(delete this._brushMaskAABBBoundsDict[this._operatingMask.name],this._container.setAttributes({}),this._container.removeChild(this._operatingMask),this._isEmptyMask()&&this._dispatchBrushEvent(GN.brushClear,t)):(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(GN.drawEnd,t))}}},{key:"_moveEnd",value:function(t){this._operatingMask&&this._operatingMask.setAttribute("pickable",!1),this._dispatchBrushEvent(GN.moveEnd,t)}},{key:"render",value:function(){this._bindBrushEvents();var t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}},{key:"releaseBrushEvents",value:function(){var t=this,e=this.attribute,i=e.trigger,n=void 0===i?XN.trigger:i,r=e.resetTrigger,a=void 0===r?XN.resetTrigger:r;Dt(n).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushStart)})),Dt(a).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushClear)})),this._releaseBrushUpdateEvents()}},{key:"_releaseBrushUpdateEvents",value:function(){var t=this,e=this.attribute,i=e.updateTrigger,n=void 0===i?XN.updateTrigger:i,r=e.endTrigger,a=void 0===r?XN.endTrigger:r;Dt(n).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushingWithDelay)})),Dt(a).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushEnd)}))}},{key:"_computeMaskPoints",value:function(){var t=this.attribute,e=t.brushType,i=t.xRange,n=void 0===i?[0,0]:i,r=t.yRange,a=void 0===r?[0,0]:r,o=this._cacheDrawPoints[0],s=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===e?[o,{x:s.x,y:o.y},s,{x:o.x,y:s.y}]:"x"===e?[{x:o.x,y:a[0]},{x:s.x,y:a[0]},{x:s.x,y:a[1]},{x:o.x,y:a[1]}]:"y"===e?[{x:n[0],y:o.y},{x:n[0],y:s.y},{x:n[1],y:s.y},{x:n[1],y:o.y}]:ft(this._cacheDrawPoints)}},{key:"_addBrushMask",value:function(){var t,e=this.attribute,i=e.brushStyle,n=e.hasMask,r=B_.polygon(Object.assign(Object.assign({points:ft(this._cacheDrawPoints),cursor:"move",pickable:!1},i),{opacity:n?null!==(t=i.opacity)&&void 0!==t?t:1:0}));r.name="brush-".concat(Date.now()),this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}},{key:"_isPosInBrushMask",value:function(t){for(var e,i=this,n=this.eventPosToStagePos(t),r=this._container.getChildren(),a=function(){var t=r[o].attribute,e=t.points,a=void 0===e?[]:e,s=t.dx,l=void 0===s?0:s,u=t.dy,c=void 0===u?0:u,h=a.map((function(t){return{x:t.x+l,y:t.y+c}}));if(kn(h,n.x,n.y))return{v:(i._operatingMask=r[o],!0)}},o=0;o<r.length;o++)if(e=a())return e.v;return!1}},{key:"_outOfInteractiveRange",value:function(t){var e=this.attribute.interactiveRange,i=e.minY,n=void 0===i?-1/0:i,r=e.maxY,a=void 0===r?1/0:r,o=e.minX,s=void 0===o?-1/0:o,l=e.maxX,u=void 0===l?1/0:l,c=this.eventPosToStagePos(t);return c.x>u||c.x<s||c.y>a||c.y<n}},{key:"_dispatchBrushEvent",value:function(t,e){this._dispatchEvent(t,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}},{key:"_clearMask",value:function(){this._brushMaskAABBBoundsDict={},this._container.removeAllChild(),this._operatingMask=null}},{key:"_isEmptyMask",value:function(){var t=this;return ct(this._brushMaskAABBBoundsDict)||Object.keys(this._brushMaskAABBBoundsDict).every((function(e){return t._brushMaskAABBBoundsDict[e].empty()}))}}])}($A);qN.defaultAttributes=XN;var ZN=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r=[t.shape].concat(b(i.map((function(t){return null==t?void 0:t.shape})))),a=[t.key].concat(b(i.map((function(t){return null==t?void 0:t.key})))),o=[t.value].concat(b(i.map((function(t){return null==t?void 0:t.value}))));return mt.apply(void 0,[t].concat(i,[{shape:r.every(j)?void 0:mt.apply(void 0,[{}].concat(b(r))),key:a.every(j)?void 0:mt.apply(void 0,[{}].concat(b(a))),value:o.every(j)?void 0:mt.apply(void 0,[{}].concat(b(o)))}]))},JN=function(t){var e=t.width,i=t.height,n=t.wordBreak,r=void 0===n?"break-word":n,a=t.textAlign,o=t.textBaseline,s=t.text;return Array.isArray(s)?{width:e,height:i,wordBreak:r,textAlign:a,textBaseline:o,singleLine:!1,textConfig:Dt(s).map((function(e){return Object.assign(Object.assign({},t),{text:e})}))}:{width:e,height:i,wordBreak:r,textAlign:a,textBaseline:o,singleLine:!1,textConfig:null==s?void 0:s.text}},QN={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:bP,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:bP,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:bP,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new On).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},$N=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];YB(),rP(),dP(),fP(),lP();var tU=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:mt({},e.defaultAttributes,t),i])).name="tooltip",a}return h(e,t),o(e,[{key:"render",value:function(){var t,i=this,n=this.attribute,r=n.visible,a=n.content,o=n.panel,s=n.keyWidth,l=n.valueWidth,u=n.hasContentShape,c=n.autoCalculatePosition,h=n.autoMeasure,d=n.align;if(r){h&&e.measureTooltip(this.attribute),c&&e.calculateTooltipPosition(this.attribute);var p=rr(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},o),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:p[3],y:p[0]},"group");var f=e.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",mt({symbolType:"circle"},f.shape,{visible:PP(f)&&PP(f.shape)}),"symbol"),"object"!=k(f.value.text)||null===f.value.text||"rich"!==f.value.text.type&&"html"!==f.value.text.type?f.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:PP(f)&&PP(f.value)},JN(f.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!==(t=f.value.text)&&void 0!==t?t:"",visible:PP(f)&&PP(f.value)},f.value),"text"):"rich"===f.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:PP(f)&&PP(f.value)},JN(f.value)),"richtext"):"html"===f.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:f.value.text.text},kP),f.value),visible:PP(f)&&PP(f.value),width:f.value.width,height:f.value.height,wordBreak:f.value.wordBreak,textAlign:f.value.textAlign,textBaseline:f.value.textBaseline,singleLine:!1,textConfig:[]},f.value),"richtext"));var v=PP(f.shape)?f.shape.size+f.shape.spacing:0,g=f.value,y=g.textAlign,m=g.textBaseline,_=o.width-p[3]-p[0]-v;"center"===y?this._tooltipTitle.setAttribute("x",v+_/2):"right"===y||"end"===y?this._tooltipTitle.setAttribute("x",v+_):this._tooltipTitle.setAttribute("x",v),"bottom"===m?this._tooltipTitle.setAttribute("y",f.height):"middle"===m?this._tooltipTitle.setAttribute("y",f.height/2):this._tooltipTitle.setAttribute("y",0);var b=PP(f)?f.height+f.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),a&&a.length){this._tooltipContent.setAttribute("x",p[3]),this._tooltipContent.setAttribute("y",p[0]+b);var x=0;a.forEach((function(t,n){var r=e.getContentAttr(i.attribute,n);if(PP(r)){var a="tooltip-content-".concat(n),o=i._tooltipContent.createOrUpdateChild(a,{visible:!0,x:0,y:x},"group"),c=r.shape.size+r.shape.spacing,h="right"===d?(u?c:0)+(PP(r.key)?s+r.key.spacing:0)+(PP(r.value)?l:0):0;i._createShape("right"===d?h-r.shape.size/2:h+r.shape.size/2,r,o,a),u&&("right"===d?h-=c:h+=c);var p=i._createKey(r,o,a);p&&(ZP(d,p,r.key.textAlign,h,s),p.setAttribute("y",0),"right"===d?h-=s+r.key.spacing:h+=s+r.key.spacing);var f=i._createValue(r,o,a);if(f){var v="right";W(r.value.textAlign)?v=r.value.textAlign:PP(r.key)||"right"===d||(v="left"),f.setAttribute("textAlign",v),ZP(d,f,v,h,l),f.setAttribute("y",0)}x+=r.height+r.spaceRow}}))}}else this.hideAll()}},{key:"_createShape",value:function(t,e,i,n){var r;if(PP(e.shape))return i.createOrUpdateChild("".concat(n,"-shape"),Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!==(r=Vf(e.key.lineHeight,e.key.fontSize))&&void 0!==r?r:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}},{key:"_createKey",value:function(t,e,i){var n;if(PP(t.key))return t.key.multiLine?e.createOrUpdateChild("".concat(i,"-key"),Object.assign(Object.assign({visible:!0},JN(t.key)),{textBaseline:"top"}),"richtext"):"object"!=k(t.key.text)||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild("".concat(i,"-key"),Object.assign(Object.assign({visible:!0,text:null!==(n=t.key.text)&&void 0!==n?n:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},JN(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild("".concat(i,"-value"),{html:Object.assign(Object.assign({dom:t.key.text.text},kP),t.key)},"richtext")}},{key:"_createValue",value:function(t,e,i){var n;if(PP(t.value))return t.value.multiLine?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},JN(t.value)),{textBaseline:"top"}),"richtext"):"object"!=k(t.value.text)||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0,text:null!==(n=t.value.text)&&void 0!==n?n:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},JN(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild("".concat(i,"-value"),{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}},{key:"setAttributes",value:function(t,i){var n=Object.keys(t);this.attribute.autoCalculatePosition&&n.every((function(t){return $N.includes(t)}))?(this._mergeAttributes(t,n),j(this.attribute.panel.width)&&this.attribute.autoMeasure&&e.measureTooltip(this.attribute),e.calculateTooltipPosition(this.attribute),_(e,"setAttributes",this,3)([{x:this.attribute.x,y:this.attribute.y},i])):_(e,"setAttributes",this,3)([t,i])}}],[{key:"calculateTooltipPosition",value:function(t){var e=t.panel,i=e.width,n=void 0===i?0:i,r=e.height,a=void 0===r?0:r,o=t.offsetX,s=t.offsetY,l=t.pointerX,u=t.pointerY,c=t.positionX,h=t.positionY,d=t.parentBounds,p=l,f=u;return"left"===c?p-=n+o:"center"===c?p-=n/2:p+=o,"top"===h?f-=a+s:"middle"===h?f-=a/2:f+=s,p+n>d.x2&&(p-=n+o),f+a>d.y2&&(f-=a+s),p<d.x1&&(p=d.x1),f<d.y1&&(f=d.y1),t.x=p,t.y=f,t}},{key:"measureTooltip",value:function(t){var i=t.content,n=t.contentStyle,r=rr(t.padding),a=e.getTitleAttr(t),o=0,s=r[0]+r[2],l=0,u=a.value,c=a.shape,h=null!=c?c:{},d=h.visible,p=void 0!==d&&d,f=h.symbolType,v=void 0===f?"":f;if(W(u)&&"object"!=k(a.value.text)){var g=GP(u).quickMeasure(u.text),y=g.width,_=g.height;o=y,l=_}if(p&&vg[v]&&(o+=c.size+c.spacing,l=Math.max(c.size,l)),t.title&&(t.title.width=o,t.title.height=l),PP(a)&&(s+=l+a.spaceRow),i&&i.length){var b=[];if(i.forEach((function(i,n){var r=e.getContentAttr(t,n);(i.key||i.value)&&PP(r)&&b.push([i,r])})),b.length){var x=!1,S=[],A=[],C=[];b.forEach((function(t,e){var i,r=m(t,2),a=r[0],o=r[1],l=o.key,u=o.value,c=o.shape,h=o.spaceRow,d=PP(c),p=null!==(i=null==c?void 0:c.symbolType)&&void 0!==i?i:"",f=GP(l),v=GP(u),g=0;if(PP(l)){var y=f.quickMeasure(l.text),_=y.width,k=y.height;A.push(_),g=Math.max(g,k)}if(PP(u)){var M=v.quickMeasure(u.text),w=M.width,T=M.height;C.push(w),g=Math.max(g,T)}d&&vg[p]&&(x=!0,S.push(c.size),g=Math.max(c.size,g)),a.height=g,s+=g,e<b.length-1&&(s+=null!=h?h:n.spaceRow)}));var M=S.length?Math.max.apply(Math,S):0,w=A.length?Math.max.apply(Math,A):0,T=C.length?Math.max.apply(Math,C):0;o=Math.max(w+T+n.key.spacing+n.value.spacing+(x?M+n.shape.spacing:0),o),i.forEach((function(t){t.width=o})),t.hasContentShape=x,t.keyWidth=w,t.valueWidth=T}}return t.panel.width=o+r[1]+r[3],t.panel.height=s,t}},{key:"getTitleAttr",value:function(t){return ZN({},e.defaultAttributes.titleStyle,e.defaultAttributes.title,t.titleStyle,t.title)}},{key:"getContentAttr",value:function(t,i){return ZN({},e.defaultAttributes.contentStyle,t.contentStyle,t.content[i])}}])}($A);tU.defaultAttributes=QN;var eU=ie;function iU(t,e){var i=[];return t.forEach((function(t){var n=+t[e];it(n)&&i.push(n)})),0===i.length?null:Pt(i)}function nU(t,e){var i=[];return t.forEach((function(t){var n=+t[e];it(n)&&i.push(n)})),0===i.length?null:Bt(i)}function rU(t,e){return t.reduce((function(t,i){var n=e?+i[e]:+i;return it(n)&&(t+=n),t}),0)}function aU(t,e){var i=0,n=0;return t.forEach((function(t){var r=e?+t[e]:+t;it(r)&&(i+=r,n++)})),i/n}function oU(t,e){var i=aU(t,e);if(t.length<=1)return 0;var n=t.reduce((function(t,n){return t+Math.pow(e?+n[e]:+n-i,2)}),0);return n/(t.length-1)}function sU(t,e){var i=lU(t),n=lU(e),r=Math.asin((t.x*e.y-e.x*t.y)/i/n),a=Math.acos((t.x*e.x+t.y*e.y)/i/n);return r<0?-a:a}function lU(t,e){return void 0===e&&(e={x:0,y:0}),Si.distancePP(t,e)}function uU(t){return it(t.x)&&it(t.y)}function cU(t,e,i){var n,r,a,o,s=!1;if(e&&U(e))try{for(var l=E(t),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var h=(a=void 0,E(c.getSeries(i))),d=h.next();!d.done;d=h.next()){var p=d.value;if(s=!!e.call(null,p))return s}}catch(t){a={error:t}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s}function hU(t,e){var i,n,r,a,o=[];try{for(var s=E(t),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(r=void 0,E(u.getSeries(e))),h=c.next();!h.done;h=c.next()){var d=h.value;o.push(d)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}}catch(t){i={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}var dU,pU,fU,vU=function(t,e){for(var i=0;i<t.length;i++)for(var n=t[i].getSeries(),r=0;r<n.length;r++){var a=n[r];if(e&&a&&a.coordinate===e)return a;if(!e&&a)return a}return null};function gU(t){return function(e){return Z(t)?t.reduce((function(t,e){return null==t?void 0:t[e]}),e):null==e?void 0:e[t]}}function yU(t,e){if(void 0===e&&(e=!1),null===t||"object"!=typeof t)return t;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(void 0===t[i]){delete t[i];continue}e&&yU(t[i],e)}}function mU(e){var i,n;return e.type===t.SeriesTypeEnum.sankey?null!==(i=e.direction)&&void 0!==i?i:"horizontal":null!==(n=e.direction)&&void 0!==n?n:"vertical"}t.SeriesTypeForThemeEnum=void 0,(dU=t.SeriesTypeForThemeEnum||(t.SeriesTypeForThemeEnum={})).area_horizontal="area_horizontal",dU.area_vertical="area_vertical",dU.area_stack="area_stack",dU.line_horizontal="line_horizontal",dU.line_vertical="line_vertical",dU.line_stack="line_stack",dU.bar_horizontal="bar_horizontal",dU.bar_vertical="bar_vertical",dU.bar_stack="bar_stack",dU.rangeColumn_horizontal="rangeColumn_horizontal",dU.rangeColumn_vertical="rangeColumn_vertical",dU.rangeArea_horizontal="rangeArea_horizontal",dU.rangeArea_vertical="rangeArea_vertical",dU.linearProgress_horizontal="linearProgress_horizontal",dU.linearProgress_vertical="linearProgress_vertical",dU.linearProgress_stack="linearProgress_stack",dU.boxPlot_horizontal="boxPlot_horizontal",dU.boxPlot_vertical="boxPlot_vertical",dU.sankey_horizontal="sankey_horizontal",dU.sankey_vertical="sankey_vertical",dU.waterfall_horizontal="waterfall_horizontal",dU.waterfall_vertical="waterfall_vertical",dU.circularProgress_stack="circularProgress_stack",dU.radar_stack="radar_stack",dU.rose_stack="rose_stack",t.SeriesTypeEnum=void 0,(pU=t.SeriesTypeEnum||(t.SeriesTypeEnum={})).area="area",pU.line="line",pU.bar="bar",pU.rangeColumn="rangeColumn",pU.rangeArea="rangeArea",pU.dot="dot",pU.geo="geo",pU.link="link",pU.map="map",pU.pie="pie",pU.radar="radar",pU.rose="rose",pU.scatter="scatter",pU.circularProgress="circularProgress",pU.wordCloud="wordCloud",pU.funnel="funnel",pU.linearProgress="linearProgress",pU.boxPlot="boxPlot",pU.sankey="sankey",pU.gaugePointer="gaugePointer",pU.gauge="gauge",pU.treemap="treemap",pU.sunburst="sunburst",pU.circlePacking="circlePacking",pU.waterfall="waterfall",pU.heatmap="heatmap",pU.correlation="correlation",pU.liquid="liquid",pU.venn="venn",pU.mosaic="mosaic",pU.pictogram="pictogram",t.SeriesMarkNameEnum=void 0,(fU=t.SeriesMarkNameEnum||(t.SeriesMarkNameEnum={})).label="label",fU.point="point",fU.line="line",fU.area="area",fU.bar="bar",fU.boxPlot="boxPlot",fU.outlier="outlier",fU.circlePacking="circlePacking",fU.group="group",fU.gridBackground="gridBackground",fU.grid="grid",fU.dot="dot",fU.title="title",fU.subTitle="subTitle",fU.symbol="symbol",fU.funnel="funnel",fU.transform="transform",fU.transformLabel="transformLabel",fU.outerLabel="outerLabel",fU.outerLabelLine="outerLabelLine",fU.pin="pin",fU.pinBackground="pinBackground",fU.pointer="pointer",fU.segment="segment",fU.track="track",fU.cell="cell",fU.cellBackground="cellBackground",fU.link="link",fU.arrow="arrow",fU.pie="pie",fU.labelLine="labelLine",fU.progress="progress",fU.minLabel="minLabel",fU.maxLabel="maxLabel",fU.rose="rose",fU.node="node",fU.sunburst="sunburst",fU.nonLeaf="nonLeaf",fU.leaf="leaf",fU.nonLeafLabel="nonLeafLabel",fU.leaderLine="leaderLine",fU.stackLabel="stackLabel",fU.word="word",fU.fillingWord="fillingWord",fU.wordMask="wordMask",fU.nodePoint="nodePoint",fU.ripplePoint="ripplePoint",fU.centerPoint="centerPoint",fU.centerLabel="centerLabel",fU.barBackground="barBackground",fU.lineLabel="lineLabel",fU.areaLabel="areaLabel",fU.liquidGroup="liquidGroup",fU.liquid="liquid",fU.liquidBackground="liquidBackground",fU.liquidOutline="liquidOutline",fU.circle="circle",fU.overlap="overlap",fU.overlapLabel="overlapLabel";var _U={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},bU={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function xU(t,e){var i;if(!t)return[];var n=TU(t,e);if(!n||Z(n))return null!==(i=n)&&void 0!==i?i:[];if(G(n)){var r=n.dataScheme;return r?MU(r)?r.map((function(i){return M(M({},i),{scheme:i.scheme.map((function(i){return CU(i)?SU(t,i,e):i})).filter(W)})})):r.map((function(i){return CU(i)?SU(t,i,e):i})).filter(W):[]}return[]}function kU(t,e){var i,n;return MU(t)?null!==(n=null===(i=t.find((function(t){return W(t.isAvailable)?U(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!W(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength})))||void 0===i?void 0:i.scheme)&&void 0!==n?n:t[t.length-1].scheme:t}function SU(t,e,i){var n,r=TU(t,i);if(r){var a,o=r.palette;if(G(o)&&(a=null!==(n=function(t,e){var i=_U[e];if(i&&t[i])return t[i];if(t[e])return t[e];var n=bU[e];return n?t[n]:void 0}(o,e.key))&&void 0!==n?n:e.default),a){if(j(e.a)&&j(e.l)||!q(a))return a;var s=new Qn(a);if(W(e.l)){var l=s.color,u=Vn(l.r,l.g,l.b),c=jn(u.h,u.s,e.l),h=new Qn("rgb(".concat(c.r,", ").concat(c.g,", ").concat(c.b,")"));h.setOpacity(s.color.opacity),s=h}return W(e.a)&&s.setOpacity(e.a),s.toRGBA()}}}var AU=function(t,e){if(e&&CU(t)){var i=SU(e,t);if(i)return i}return t};function CU(t){return t&&"palette"===t.type&&!!t.key}function MU(t){return!(!Z(t)||0===t.length)&&t.every((function(t){return W(t.scheme)}))}function wU(t){return Z(t)?{dataScheme:t}:t}function TU(t,e){var i,n,r,a=(null!=e?e:{}).type;if(!e||j(a))r=null==t?void 0:t.default;else{var o=mU(e);r=null!==(n=null!==(i=null==t?void 0:t["".concat(a,"_").concat(o)])&&void 0!==i?i:null==t?void 0:t[a])&&void 0!==n?n:null==t?void 0:t.default}return r}var DU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.range=function(e){return e?(this._range=e,this._resetRange(),this):t.prototype.range.call(this)},e.prototype.domain=function(e){return e?(t.prototype.domain.call(this,e),this._resetRange(),this):t.prototype.domain.call(this)},e.prototype._resetRange=function(){if(MU(this._range)){var e=kU(this._range,this._domain);t.prototype.range.call(this,e)}else t.prototype.range.call(this,this._range)},e}(kO),EU={linear:YO,band:CO,point:JO,ordinal:kO,threshold:tz,colorOrdinal:DU};function BU(t){var e=EU[t];return e?new e:null}function PU(t,e){if("scale"in t&&t.scale)return q(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;var i=BU(t.type);return i&&function(t,e){if(!t||!e)return;e.domain&&t.domain(e.domain);e.range&&t.range(e.range);e.specified&&t.specified&&t.specified(e.specified);e.clamp&&t.clamp&&t.clamp(e.clamp)}(i,t),i}function RU(t,e,i){if(!e)return t;var n=e.range(),r=i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range(),a=Math.min(r[0],r[r.length-1]),o=Math.max(r[0],r[r.length-1]);return Math.min(Math.max(a,t),o)}function LU(t,e,i){if(!e)return!0;var n=e.range(),r=(i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range()).map((function(t){return e.invert(t)})),a=Math.min(r[0],r[r.length-1]),o=Math.max(r[0],r[r.length-1]);return Array.isArray(t)?t.every((function(t){return t>=a&&t<=o})):t>=a&&t<=o}function IU(t){return W(null==t?void 0:t.field)&&W(null==t?void 0:t.scale)}function FU(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function OU(t){return!!q(t)&&(!!t.endsWith("%")&&ZA(t.substring(0,t.length-1)))}function zU(t){return!!G(t)&&("percent"in t||"offset"in t)}function HU(t,e,i,n){var r,a;return void 0===n&&(n=0),$(t)?t:OU(t)?Number(t.substring(0,t.length-1))*e/100:U(t)?t(i):G(t)?e*(null!==(r=t.percent)&&void 0!==r?r:0)+(null!==(a=t.offset)&&void 0!==a?a:0):n}function NU(t,e,i){var n,r,a,o,s={top:0,bottom:0,left:0,right:0};return Object.values(t).every((function(t){return $(t)}))?(s.top=null!==(n=t.top)&&void 0!==n?n:0,s.right=null!==(r=t.right)&&void 0!==r?r:0,s.bottom=null!==(a=t.bottom)&&void 0!==a?a:0,s.left=null!==(o=t.left)&&void 0!==o?o:0,s):([{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach((function(e){e.orients.forEach((function(n){s[n]=HU(t[n],e.size,i)}))})),s)}function UU(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}function jU(t){var e={};return Z(t)?(j(t[0])||(e.top=e.left=e.bottom=e.right=t[0]),j(t[1])||(e.left=e.right=t[1]),j(t[2])||(e.bottom=t[2]),j(t[3])||(e.left=t[3]),e):$(t)||OU(t)||U(t)||zU(t)?(e.top=e.left=e.bottom=e.right=t,e):G(t)?e=M({},t):e}function VU(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}var WU=function(t,e){var i=Number(t),n=t.toString();return isNaN(i)&&"%"===n[n.length-1]?e*(Number(n.slice(0,n.length-1))/100):i},GU=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}];function YU(t,e){return t&&e.key in t?t[e.key]:e.default}function XU(t){return t&&"token"===t.type&&!!t.key}var KU={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,'-apple-system',segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},qU={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:{default:{dataScheme:GU,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},token:KU,component:{poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}}},mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},animationThreshold:2e3},ZU={name:"dark",colorScheme:{default:{dataScheme:GU,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}},JU=function(t,e){return t===e||!U(t)&&!U(e)&&(Z(t)&&Z(e)?e.every((function(e){return t.some((function(t){return JU(t,e)}))})):!(!G(t)||!G(e))&&Object.keys(e).every((function(i){return JU(t[i],e[i])})))},QU=function(t,e,i){if(j(e))return t;var n=e[0];return j(n)?t:1===e.length?(t[n]=i,t):(j(t[n])&&("number"==typeof e[1]?t[n]=[]:t[n]={}),QU(t[n],e.slice(1),i))},$U=function(t){return t instanceof cc||ya(t)};function tj(t){return ft(t,$U,arguments.length>1&&void 0!==arguments[1]?arguments[1]:["data"])}function ej(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;){vt(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0,!0)}return t}var ij=function(){function t(){}return t.registerChart=function(e,i){t._charts[e]=i},t.registerSeries=function(e,i){t._series[e]=i},t.registerComponent=function(e,i,n,r){t._components[e]={cmp:i,alwaysCheck:n,createOrder:null!=r?r:0}},t.registerGraphicComponent=function(e,i){t._graphicComponents[e]=i},t.createGraphicComponent=function(e,i,n){var r=t._graphicComponents[e];return r?r(i,n):null},t.registerMark=function(e,i){t._marks[e]=i},t.registerRegion=function(e,i){t._regions[e]=i},t.registerTransform=function(e,i){t.transforms[e]=i},t.registerGrammarTransform=function(e,i){t._grammarTransforms[e]=i},t.getGrammarTransform=function(e){return t._grammarTransforms[e]},t.registerLayout=function(e,i){t._layout[e]=i},t.registerAnimation=function(e,i){t._animations[e]=i},t.registerImplement=function(e,i){t._implements[e]=i},t.registerChartPlugin=function(e,i){t._chartPlugin[e]=i},t.registerVChartPlugin=function(e,i){t._vChartPlugin[e]=i},t.registerComponentPlugin=function(e,i){t._componentPlugin[e]=i},t.createChart=function(e,i,n){return t._charts[e]?new(0,t._charts[e])(i,n):null},t.getChart=function(e){return t._charts[e]},t.createChartSpecTransformer=function(e,i){if(!t._charts[e])return null;var n=t._charts[e];return new(0,n.transformerConstructor)(M({seriesType:n.seriesType},i))},t.createRegion=function(e,i,n){return t._regions[e]?new(0,t._regions[e])(i,n):null},t.createRegionSpecTransformer=function(e,i){return t._regions[e]?new(0,t._regions[e].transformerConstructor)(i):null},t.createSeries=function(e,i,n){return t._series[e]?new(0,t._series[e])(i,n):null},t.createSeriesSpecTransformer=function(e,i){return t._series[e]?new(0,t._series[e].transformerConstructor)(i):null},t.createMark=function(e,i,n){if(!t._marks[e])return null;var r=new(0,t._marks[e])(i,n);return"group"===r.type&&r.setMarkConfig({interactive:!1}),r},t.getComponents=function(){return Object.values(t._components)},t.getComponentInKey=function(e){return t._components[e].cmp},t.getLayout=function(){return Object.values(t._layout)},t.getLayoutInKey=function(e){return t._layout[e]},t.getSeries=function(){return Object.values(t._series)},t.getSeriesInType=function(e){return t._series[e]},t.getRegionInType=function(e){return t._regions[e]},t.getAnimationInKey=function(e){return t._animations[e]},t.getImplementInKey=function(e){return t._implements[e]},t.getSeriesMarkMap=function(e){return t._series[e]?t._series[e].mark:{}},t.getSeriesBuiltInTheme=function(e){for(var i in t._series){var n=t._series[i];if(n&&n.builtInTheme&&n.builtInTheme[e])return n.builtInTheme[e]}return null},t.getComponentBuiltInTheme=function(e){for(var i in t._components){var n=t._components[i];if(n&&n.cmp&&n.cmp.builtInTheme&&n.cmp.builtInTheme[e])return n.cmp.builtInTheme[e]}return null},t.getChartPlugins=function(){return Object.values(t._chartPlugin)},t.getVChartPlugins=function(){return Object.values(t._vChartPlugin)},t.getComponentPlugins=function(){return Object.values(t._componentPlugin)},t.getComponentPluginInType=function(e){return t._componentPlugin[e]},t.registerFormatter=function(t){this._formatter=t},t.getFormatter=function(){return this._formatter},t.createInteractionTrigger=function(e,i){var n=t._interactionTriggers[e];return n?new n(i):null},t.hasInteractionTrigger=function(e){return!!t._interactionTriggers[e]},t.getComposedEvent=function(e){return t._composedEventMap[e]},t._charts={},t._series={},t._components={},t._graphicComponents={},t._marks={},t._regions={},t._animations={},t._implements={},t._chartPlugin={},t._vChartPlugin={},t._componentPlugin={},t.transforms={fields:hu,filter:qa,fold:cu},t.dataParser={csv:Cu,dsv:Au,tsv:Mu},t._layout={},t._grammarTransforms={},t._stageEventPlugins={},t.registerStageEventPlugin=function(e,i){t._stageEventPlugins[e]=i},t.getStageEventPlugin=function(e){return t._stageEventPlugins[e]},t._interactionTriggers={},t.registerInteractionTrigger=function(e,i){t._interactionTriggers[e]=i},t._composedEventMap={},t.registerComposedEvent=function(e,i){t._composedEventMap[e]=i},t._tooltipProcessors={},t.registerTooltipProcessor=function(e,i){t._tooltipProcessors[e]=i},t.createTooltipProcessor=function(e,i){var n=t._tooltipProcessors[e];return n?new n(i):null},t}();function nj(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return ej.apply(void 0,P([rj(t)],B(e.map(rj)),!1))}function rj(t){var e;if(!t)return t;var i=function(t){t&&(t=Object.keys(t).reduce((function(e,i){var n=t[i];return e[i]=wU(n),e}),{}));return t}(t.colorScheme);return Object.assign({},t,{colorScheme:i,token:null!==(e=t.token)&&void 0!==e?e:{},series:Object.assign({},t.series)})}var aj,oj=function(t){var e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[t?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},sj=oj(),lj=((aj={})[qU.name]=qU,aj),uj=qU.name,cj=new Map(Object.keys(lj).map((function(t){return[t,lj[t]]}))),hj=new Map,dj=new Map(Object.keys(lj).map((function(t){return[t,t===uj]}))),pj=function(t,e){if(t){var i=yj(e);cj.set(t,i),dj.set(t,!0)}},fj=function(t){return void 0===t&&(t=uj),dj.has(t)&&!dj.get(t)&&pj(t,cj.get(t)),cj.get(t)},vj=function(t){return cj.delete(t)&&hj.delete(t)&&dj.delete(t)},gj=function(t){return!!q(t)&&cj.has(t)},yj=function(t){var e,i=null!==(e=t.type)&&void 0!==e?e:uj;return nj({},fj(i),t)},mj=function(){function t(){}return t.registerInstance=function(e){t.instances.set(e.id,e)},t.unregisterInstance=function(e){t.instances.delete(e.id)},t.getInstance=function(e){return t.instances.get(e)},t.instanceExist=function(e){return t.instances.has(e)},t.forEach=function(e,i,n){void 0===i&&(i=[]);var r=Dt(i);return t.instances.forEach((function(t,i,n){r.includes(i)||e(t,i,n)}),n)},t.instances=new Map,t}(),_j=function(){function t(){}return t.registerTheme=function(t,e){pj(t,e)},t.getTheme=function(t,e){return fj(t)},t.removeTheme=function(t){return vj(t)},t.themeExist=function(t){return gj(t)},t.getDefaultTheme=function(){return t.themes.get(uj)},t.setCurrentTheme=function(e){t.themeExist(e)&&(t._currentThemeName=e,mj.forEach((function(t){return null==t?void 0:t.setCurrentTheme(e)})))},t.getCurrentTheme=function(e){return void 0===e&&(e=!1),t.getTheme(t._currentThemeName,e)},t.getCurrentThemeName=function(){return t._currentThemeName},t.themes=cj,t._currentThemeName=uj,t}();function bj(t){return q(t)?_j.themeExist(t)?_j.getTheme(t):{}:G(t)?t:{}}var xj=["animationThreshold","colorScheme","name","padding"];function kj(t,e,i){if(!t)return t;e||(e=t.colorScheme),i||(i=t.token);var n={};return Object.keys(t).forEach((function(r){var a=t[r];xj.includes(r)?n[r]=a:X(a)?CU(a)?n[r]=AU(a,e):XU(a)?n[r]=YU(i,a):n[r]=kj(a,e,i):n[r]=a})),n}function Sj(t,e){if(void 0===e&&(e={data:function(t){return t}}),!t)return t;if(t.constructor===Object){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e[n]){i[n]=e[n](t[n]);continue}i[n]=Sj(t[n],e)}return i}return Z(t)?t.map((function(t){return Sj(t,e)})):t}function Aj(t,e){if(!t)return t;if(X(t)){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(q(t[n])&&e.getFunction(t[n])){i[n]=e.getFunction(t[n]);continue}i[n]=Aj(t[n],e)}return i}return Z(t)?t.map((function(t){return Aj(t,e)})):t}var Cj=function(t,e,i,n){return function(t,e,i){return GP(t,e,i,{fontFamily:KU.fontFamily,fontSize:KU.fontSize})}(e,i,n).measure(t)},Mj="__VCHART",wj=500,Tj=500,Dj="".concat(Mj,"_MEASURE_CANVAS_ID"),Ej="".concat(Mj,"_DEFAULT_DATA_INDEX"),Bj="".concat(Mj,"_DEFAULT_DATA_KEY"),Pj="".concat(Mj,"_DEFAULT_DATA_SERIES_FIELD"),Rj="".concat(Mj,"_DEFAULT_SERIES_STYLE_NAME"),Lj="".concat(Mj,"_STACK_KEY"),Ij="".concat(Mj,"_STACK_START"),Fj="".concat(Mj,"_STACK_END"),Oj="".concat(Mj,"_STACK_START_PERCENT"),zj="".concat(Mj,"_STACK_END_PERCENT"),Hj="".concat(Mj,"_STACK_START_OffsetSilhouette"),Nj="".concat(Mj,"_STACK_END_OffsetSilhouette"),Uj="".concat(Mj,"_STACK_TOTAL"),jj="".concat(Mj,"_STACK_TOTAL_PERCENT"),Vj="".concat(Mj,"_STACK_TOTAL_TOP"),Wj="".concat(Mj,"_STACK_TOTAL_BOTTOM"),Gj="".concat(Mj,"_MOSAIC_VALUE_START_PERCENT"),Yj="".concat(Mj,"_MOSAIC_VALUE_END_PERCENT"),Xj="".concat(Mj,"_MOSAIC_CAT_START_PERCENT"),Kj="".concat(Mj,"_MOSAIC_CAT_END_PERCENT"),qj="".concat(Mj,"_SEGMENT_START"),Zj="".concat(Mj,"_SEGMENT_END"),Jj="".concat(Mj,"_KEY");function Qj(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=$j(t,n.key);r?r.operations=P([],B(new Set(r.operations.concat(n.operations))),!1):t.push(n)}return t}function $j(t,e){return t.find((function(t){return t.key===e}))}function tV(t,e){var i;if(!t)return null!=e?e:null;var n=t.getFields();return n&&n[e]?null!==(i=n[e].alias)&&void 0!==i?i:e:null!=e?e:null}function eV(t,e,i){var n=t.getStackSort(),r={},a=null;return n&&(a={},t.getSeries().forEach((function(t){var e=t.getSeriesField();if(e){var i=t.getRawDataStatisticsByField(e);i.values&&(a[e]||(a[e]={lastIndex:0,sort:{}}),i.values.forEach((function(t,i){t in a[e].sort||(a[e].sort[t]=a[e].lastIndex,a[e].lastIndex++)})))}}))),t.getSeries().forEach((function(t){var n,o=t.getStackData(),s=t.getStackValue(),l=t.getStackValueField(),u=!i||i(t);o&&l&&u&&(r[s]=null!==(n=r[s])&&void 0!==n?n:{groupField:o.groupField,nodes:{}},lV(t,o,r[s],l,e,a))})),n?iV(r):r}function iV(t,e){var i;for(var n in t)(null===(i=t[n].sortDatums)||void 0===i?void 0:i.length)?(t[n].sortDatums.sort((function(t,e){return t.index-e.index})),t[n].values=t[n].sortDatums.map((function(t){return t.datum}))):iV(t[n].nodes);return t}function nV(t,e){if("values"in t&&t.values.length){var i=rU(t.values,e),n=nU(t.values,zj);t.values.forEach((function(t){t[Uj]=i,t[jj]=n}))}else for(var r in t.nodes)nV(t.nodes[r],e)}function rV(t,e){var i,n;if("values"in t&&t.values.length)W(null===(i=t.values[0])||void 0===i?void 0:i[Uj])?t.total=null===(n=t.values[0])||void 0===n?void 0:n[Uj]:t.total=rU(t.values,e);else{for(var r in t.nodes)rV(t.nodes[r],e);t.nodes&&(t.total=rU(Object.keys(t.nodes).map((function(e){return t.nodes[e]})),"total"))}}function aV(t,e,i){var n;if(e.groupField&&e.nodes){var r=(null===(n=t.getRawDataStatisticsByField(e.groupField,!1))||void 0===n?void 0:n.values)||[],a={key:"".concat(e.groupField),values:r.map((function(i){var n,r,a,o=e.nodes[i];return{groupValue:i,value:a=t.bandWidthField&&null!==(r=null===(n=o.values.find((function(e){return W(e[t.bandWidthField])})))||void 0===n?void 0:n[t.bandWidthField])&&void 0!==r?r:o.total,end:a}}))};sV(a,!1,!0,!1,{key:"groupField",start:"start",end:"end",startPercent:"startPercent",endPercent:"endPercent"}),a.values.forEach((function(t){e.nodes[t.groupValue].mosaicData=t}))}else if("values"in e&&e.values.length&&i&&i.length){for(var o=i.length,s=0,l=1,u=0,c=1,h=0;h<o;h++)if(h%2==0){var d=l-s;l=s+i[h].endPercent*d,s+=i[h].startPercent*d}else{var p=c-u;c=u+i[h].endPercent*p,u+=i[h].startPercent*p}o%2==0?e.values.forEach((function(t){var e=l-s;t[Kj]=s+e*t[zj],t[Xj]=s+e*t[Oj],t[Yj]=c,t[Gj]=u})):e.values.forEach((function(t){var e=c-u;t[Yj]=u+e*t[zj],t[Gj]=u+e*t[Oj],t[Kj]=l,t[Xj]=s}))}for(var f in e.nodes)aV(t,e.nodes[f],e.nodes[f].mosaicData?i?P(P([],B(i),!1),[e.nodes[f].mosaicData],!1):[e.nodes[f].mosaicData]:null)}function oV(t){if(t.values.length)for(var e=t.values[t.values.length-1][Fj]/2,i=0;i<t.values.length;i++)t.values[i][Hj]=t.values[i][Ij]-e,t.values[i][Nj]=t.values[i][Fj]-e}function sV(t,e,i,n,r){void 0===r&&(r={key:Lj,start:Ij,end:Fj,startPercent:Oj,endPercent:zj,max:Vj,min:Wj});var a=n&&W(r.min),o=n&&W(r.max);if(t.values.length>0){for(var s=0,l=0,u=1,c=0,h=null,d=null,p=t.values.length,f=0;f<p;f++){(c=(v=t.values[e?p-1-f:f])[r.end])>=0?(v[r.start]=s,s+=v[r.end],v[r.end]=s):(v[r.start]=l,l+=v[r.end],v[r.end]=l),v[r.key]=t.key,o&&(delete v[r.max],(!d||v[r.end]>d[r.end])&&(d=v)),a&&(delete v[r.min],(!h||v[r.start]<h[r.start])&&(h=v))}if(o&&d&&(d[r.max]=!0),a&&h&&(h[r.min]=!0),i)for(f=0;f<p;f++){var v,g=(c=(v=t.values[e?p-1-f:f])[r.end])>=0?s:l;u=c>=0?1:-1,v[r.startPercent]=0===g?0:Math.min(1,v[r.start]/g)*u,v[r.endPercent]=0===g?0:Math.min(1,v[r.end]/g)*u}}for(var y in t.nodes)sV(t.nodes[y],e,i,n,r)}function lV(t,e,i,n,r,a,o){var s,l;if("values"in e)if(r&&e.values.forEach((function(t){return t[Fj]=function(t){if(it(t))return t;var e=+t;return it(e)?e:0}(t[n])})),i.series.push({s:t,values:e.values}),a){var u=t.getSeriesField();e.values.forEach((function(e){i.sortDatums.push({series:t,datum:e,index:u?a[u].sort[e[u]]:0})}))}else(s=i.values).push.apply(s,P([],B(e.values),!1));else for(var c in e.nodes){var h=o?"".concat(o,"_").concat(c):c;i.nodes[c]||(i.nodes[c]={values:[],series:[],nodes:{},sortDatums:[],key:h},W(null===(l=e.nodes[c])||void 0===l?void 0:l.groupField)&&(i.nodes[c].groupField=e.nodes[c].groupField)),lV(t,e.nodes[c],i.nodes[c],n,r,a,h)}}var uV=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var a=t[r];if(a[i]===e)return a;if(a[n]){var o=uV(a[n],e,i,n);if(o)return o}}return null},cV=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var a=t[r];if(a[n])for(var o=0;o<a[n].length;o++){var s=a[n][o];if(s[i]===e)return a;var l=cV([s],e,i,n);if(l)return l}}return null};function hV(t,e,i,n,r){return void 0===n&&(n="value"),void 0===r&&(r="children"),Array.isArray(t)?t.map((function(t){var a=M({},t);return Array.isArray(a[r])&&(a[r]=hV(a[r],e,i,n,r)),a})).filter((function(t){return+t[n]>=e&&+t[n]<=i||t[r]&&t[r].length>0})):t}function dV(t){void 0===t&&(t={});var e=M({},t);if(U(t.style)?e.style=function(e,i,n,r){return vV(t.style(e,i,n,r))}:ct(t.style)||(e.style=vV(t.style)),!ct(t.state)){var i={};Object.keys(t.state).forEach((function(e){U(t.state[e])?i[e]=function(i,n,r,a){return vV(t.state[e](i,n,r,a))}:ct(t.state[e])||(i[e]=vV(t.state[e]))})),e.state=i}return e}function pV(t){if(ct(t))return null;var e={};return Object.keys(t).forEach((function(i){U(t[i])?e[i]=function(e,n,r,a){return vV(t[i](e,n,r,a))}:ct(t[i])||(e[i]=vV(t[i]))})),e}function fV(t,e){if(ct(t))return null;var i={};return Object.keys(t).forEach((function(n){U(t[n])?i[n]=t[n](e):i[n]=t[n]})),vV(i)}function vV(t){return(null==t?void 0:t.angle)?M(M({},t),{angle:Ci(t.angle)}):t}var gV,yV=function(t){return"line"===t||"area"===t},mV=function(t){if(!t||!t.context)return null;var e=t.context,i=e.data,n=e.markType;return yV(n)?i:null==i?void 0:i[0]},_V=function(t,e){for(var i=e;(null==i?void 0:i.parent)&&i.parent!==t;)if((i=i.parent).context)return i;return null},bV=function(t,e){var i=t.getAttributes(!0),n={};return Object.keys(e).forEach((function(t){i[t]!==e[t]&&(n[t]=e[t])})),n},xV=function(){function t(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}return t.prototype.getComposedEventMap=function(){return this._composedEventMap},t.prototype.on=function(t,e,i){var n="function"==typeof e?{query:null,callback:e}:{query:e,callback:i},r=ij.getComposedEvent(t);if(r){var a=new r(this._eventDispatcher,this._mode);a.register(t,n),this._composedEventMap.set(i,{eventType:t,event:a})}else this._eventDispatcher.register(t,n);return this},t.prototype.off=function(t,e,i){var n,r,a,o,s=null!=i?i:e;if(ij.getComposedEvent(t))if(s)null===(a=this._composedEventMap.get(s))||void 0===a||a.event.unregister(),this._composedEventMap.delete(s);else try{for(var l=E(this._composedEventMap.entries()),u=l.next();!u.done;u=l.next()){var c=u.value;c[1].eventType===t&&(null===(o=this._composedEventMap.get(c[0]))||void 0===o||o.event.unregister(),this._composedEventMap.delete(c[0]))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}else if(s){var h={callback:s,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,h)}else this._eventDispatcher.unregister(t);return this},t.prototype.emit=function(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this},t.prototype.prevent=function(t,e){return this._eventDispatcher.prevent(t,e),this},t.prototype.allow=function(t){return this._eventDispatcher.allow(t),this},t.prototype.release=function(){this._eventDispatcher.clear(),this._composedEventMap.clear()},t}();!function(t){t.BEFORE_EVALUATE_DATA="beforeEvaluateData",t.AFTER_EVALUATE_DATA="afterEvaluateData",t.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",t.AFTER_EVALUATE_SCALE="afterEvaluateScale",t.BEFORE_PARSE_VIEW="beforeParseView",t.AFTER_PARSE_VIEW="afterParseView",t.BEFORE_TRANSFORM="beforeTransform",t.AFTER_TRANSFORM="afterTransform",t.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",t.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",t.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",t.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",t.BEFORE_STAGE_RESIZE="beforeStageResize",t.AFTER_STAGE_RESIZE="afterStageResize",t.BEFORE_VRENDER_DRAW="beforeVRenderDraw",t.AFTER_VRENDER_DRAW="afterVRenderDraw",t.BEFORE_MARK_JOIN="beforeMarkJoin",t.AFTER_MARK_JOIN="afterMarkJoin",t.BEFORE_MARK_UPDATE="beforeMarkUpdate",t.AFTER_MARK_UPDATE="afterMarkUpdate",t.BEFORE_MARK_STATE="beforeMarkState",t.AFTER_MARK_STATE="afterMarkState",t.BEFORE_MARK_ENCODE="beforeMarkEncode",t.AFTER_MARK_ENCODE="afterMarkEncode",t.BEFORE_DO_LAYOUT="beforeDoLayout",t.AFTER_DO_LAYOUT="afterDoLayout",t.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",t.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",t.BEFORE_DO_RENDER="beforeDoRender",t.AFTER_DO_RENDER="afterDoRender",t.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",t.AFTER_MARK_RENDER_END="afterMarkRenderEnd",t.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",t.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",t.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",t.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",t.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",t.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",t.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",t.BEFORE_ELEMENT_STATE="beforeElementState",t.AFTER_ELEMENT_STATE="afterElementState",t.BEFORE_ELEMENT_ENCODE="beforeElementEncode",t.AFTER_ELEMENT_ENCODE="afterElementEncode",t.ANIMATION_START="animationStart",t.ANIMATION_END="animationEnd",t.ELEMENT_ANIMATION_START="elementAnimationStart",t.ELEMENT_ANIMATION_END="elementAnimationEnd",t.ALL_ANIMATION_START="allAnimationStart",t.ALL_ANIMATION_END="allAnimationEnd"}(gV||(gV={}));var kV,SV,AV,CV=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];t.ChartEvent=void 0,(kV=t.ChartEvent||(t.ChartEvent={})).initialized="initialized",kV.rendered="rendered",kV.renderFinished="renderFinished",kV.animationFinished="animationFinished",kV.regionSeriesDataFilterOver="regionSeriesDataFilterOver",kV.afterInitData="afterInitData",kV.afterInitEvent="afterInitEvent",kV.afterInitMark="afterInitMark",kV.rawDataUpdate="rawDataUpdate",kV.viewDataFilterOver="viewDataFilterOver",kV.viewDataUpdate="viewDataUpdate",kV.viewDataStatisticsUpdate="viewDataStatisticsUpdate",kV.markDeltaYUpdate="markDeltaYUpdate",kV.viewDataLabelUpdate="viewDataLabelUpdate",kV.scaleDomainUpdate="scaleDomainUpdate",kV.scaleRawDomainUpdate="scaleRawDomainUpdate",kV.scaleUpdate="scaleUpdate",kV.dataZoomChange="dataZoomChange",kV.drill="drill",kV.layoutStart="layoutStart",kV.layoutEnd="layoutEnd",kV.layoutRectUpdate="layoutRectUpdate",kV.playerPlay="playerPlay",kV.playerPause="playerPause",kV.playerEnd="playerEnd",kV.playerChange="playerChange",kV.playerForward="playerForward",kV.playerBackward="playerBackward",kV.scrollBarChange="scrollBarChange",kV.brushStart="brushStart",kV.brushChange="brushChange",kV.brushEnd="brushEnd",kV.brushClear="brushClear",kV.brushActive="brushActive",kV.legendSelectedDataChange="legendSelectedDataChange",kV.legendFilter="legendFilter",kV.legendItemClick="legendItemClick",kV.legendItemHover="legendItemHover",kV.legendItemUnHover="legendItemUnHover",kV.tooltipShow="tooltipShow",kV.tooltipHide="tooltipHide",kV.tooltipRelease="tooltipRelease",kV.afterResize="afterResize",kV.afterRender="afterRender",kV.afterLayout="afterLayout",kV.afterMarkLayoutEnd="afterMarkLayoutEnd",kV.afterWordcloudShapeDraw="afterWordcloudShapeDraw",function(t){t.chart="chart",t.window="window",t.canvas="canvas"}(SV||(SV={})),function(t){t.vchart="vchart",t.chart="chart",t.model="model",t.mark="mark"}(AV||(AV={}));var MV=[AV.mark,AV.model,AV.chart,AV.vchart],wV=function(){function t(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(AV.vchart,[]),this._levelNodes.set(AV.chart,[]),this._levelNodes.set(AV.model,[]),this._levelNodes.set(AV.mark,[])}return t.prototype.addHandler=function(t,e){var i,n={level:e,handler:t};return null===(i=this._levelNodes.get(e))||void 0===i||i.push(n),this._map.set(t.callback,n),this},t.prototype.removeHandler=function(t){var e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);var i=this._levelNodes.get(e.level),n=null==i?void 0:i.findIndex((function(e){return e.handler.callback===t.callback}));return void 0!==n&&n>=0&&(null==i||i.splice(n,1)),this},t.prototype.preventHandler=function(t){return t&&(t.prevented=!0),this},t.prototype.allowHandler=function(t){return t&&(t.prevented=!1),this},t.prototype.getHandlers=function(t){var e;return(null===(e=this._levelNodes.get(t))||void 0===e?void 0:e.map((function(t){return t.handler})))||[]},t.prototype.getAllHandlers=function(){return Array.from(this._map.values()).map((function(t){return t.handler}))||[]},t.prototype.getCount=function(){return this._map.size},t.prototype.release=function(){this._map.clear(),this._levelNodes.clear()},t}(),TV={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"},DV=function(){function t(t,e){var i=this;this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=function(t){var e,n=i.globalInstance.getChart(),r=W(t.modelId)&&(null==n?void 0:n.getModelById(t.modelId))||void 0,a=W(t.markId)&&(null==n?void 0:n.getMarkById(t.markId))||null,o=ht(t.event,"target"),s=t.datum;r&&"component"===r.modelType&&(s=null!==(e=r.getDatum(o))&&void 0!==e?e:s);var l={event:t.event,item:t.item,source:t.source,datum:s,chart:n,model:r,mark:null!=a?a:void 0,node:o};i.dispatch(t.type,l)},this._onDelegateInteractionEvent=function(t){var e=i.globalInstance.getChart(),n=t.event,r=null;n.graphics&&(r=n.graphics);var a={event:t.event,chart:e,graphics:r,datums:r&&r.map((function(t){return mV(t)}))};i.dispatch(t.type,a)},this.globalInstance=t,this._compiler=e}return t.prototype.register=function(t,e){var i,n,r,a,o;this._parseQuery(e);var s=this.getEventBubble((null===(i=e.filter)||void 0===i?void 0:i.source)||SV.chart),l=this.getEventListeners((null===(n=e.filter)||void 0===n?void 0:n.source)||SV.chart);if(s.get(t)||s.set(t,new wV),s.get(t).addHandler(e,null===(r=e.filter)||void 0===r?void 0:r.level),this._isValidEvent(t)&&!l.has(t)){var u=this._onDelegate.bind(this);this._compiler.addEventListener(null===(a=e.filter)||void 0===a?void 0:a.source,t,u),l.set(t,u)}else if(this._isInteractionEvent(t)&&!l.has(t)){u=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null===(o=e.filter)||void 0===o?void 0:o.source,t,u),l.set(t,u)}return this},t.prototype.unregister=function(t,e){var i,n,r,a,o,s=!1,l=this.getEventBubble((null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.source)||SV.chart),u=this.getEventListeners((null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.source)||SV.chart);e?(null==(o=l.get(t))||o.removeHandler(e),0===(null==o?void 0:o.getCount())&&(null==o||o.release(),l.delete(t),s=!0),(null===(r=null==e?void 0:e.wrappedCallback)||void 0===r?void 0:r.cancel)&&e.wrappedCallback.cancel()):(null==(o=l.get(t))||o.release(),l.delete(t),s=!0);if(s&&this._isValidEvent(t)){var c=u.get(t);this._compiler.removeEventListener((null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.source)||SV.chart,t,c),u.delete(t)}return this},t.prototype.dispatch=function(t,e,i){var n=this.getEventBubble(e.source||SV.chart).get(t);if(!n)return this;var r=!1;if(i){var a=n.getHandlers(i);r=this._invoke(a,t,e)}else for(var o=0;!r&&o<MV.length;)r=this._invoke(n.getHandlers(MV[o]),t,e),o++;return this},t.prototype.prevent=function(t,e){var i=this;return["canvas","chart","window"].forEach((function(n){var r=i.getEventBubble(n).get(t);r&&r.getAllHandlers().forEach((function(t){e?MV.indexOf(t.filter.level)<MV.indexOf(e.level)&&t.callback!==e.handler&&r.preventHandler(t):r.preventHandler(t)}))})),this},t.prototype.allow=function(t){var e=this;return["canvas","chart","window"].forEach((function(i){var n=e.getEventBubble(i).get(t);n&&n.getAllHandlers().forEach((function(t){return n.allowHandler(t)}))})),this},t.prototype.clear=function(){var t=this;[SV.chart,SV.window,SV.canvas].forEach((function(e){var i,n,r=t.getEventListeners(e);try{for(var a=E(r.entries()),o=a.next();!o.done;o=a.next()){var s=o.value;t._compiler.removeEventListener(e,s[0],s[1])}}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}r.clear()})),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach((function(t){var e,i;try{for(var n=E(t.values()),r=n.next();!r.done;r=n.next()){r.value.release()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}t.clear()}))},t.prototype.release=function(){this.clear(),this.globalInstance=null,this._compiler=null},t.prototype._filter=function(t,e,i){var n,r,a;if(U(t.filter)&&!t.filter(i))return!1;if(t.nodeName&&ht(i,"node.name")!==t.nodeName)return!1;if(t.markName&&(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name)!==t.markName)return!1;var o=null===(r=i.model)||void 0===r?void 0:r.type;return TV[o]&&(o=TV[o]),(!t.type||o===t.type)&&(!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&(!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!W(t.userId)||(null===(a=i.model)||void 0===a?void 0:a.userId)===t.userId)))},t.prototype._invoke=function(t,e,i){var n=this,r=t.map((function(t){var r,a,o,s=t.filter;if(!t.prevented&&(!t.query||n._filter(s,e,i))){var l=(t.wrappedCallback||t.callback).call(null,M({},i)),u=null!=l?l:null===(r=t.query)||void 0===r?void 0:r.consume;return u&&(null===(a=i.event)||void 0===a||a.stopPropagation(),null===(o=i.event)||void 0===o||o.preventDefault()),!!u}}));return r.some((function(t){return!0===t}))},t.prototype._getQueryLevel=function(t){return t?t.level?t.level:W(t.id)?AV.model:AV.vchart:AV.vchart},t.prototype._parseQuery=function(t){var e,i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=ge(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=ve(t.callback,i.debounce));var n=this._getQueryLevel(i),r=null,a=SV.chart,o=null,s=null,l=null;return(null==i?void 0:i.nodeName)&&(o=i.nodeName),(null==i?void 0:i.markName)&&(s=i.markName),!(null==i?void 0:i.type)||n!==AV.model&&n!==AV.mark||(r=i.type),(null==i?void 0:i.source)&&(a=i.source),W(null==i?void 0:i.id)&&(l=null==i?void 0:i.id,n=AV.model),t.filter={level:n,markName:s,type:r,source:a,nodeName:o,userId:l,filter:null!==(e=null==i?void 0:i.filter)&&void 0!==e?e:null},t},t.prototype.getEventBubble=function(t){switch(t){case SV.chart:return this._viewBubbles;case SV.window:return this._windowBubbles;case SV.canvas:return this._canvasBubbles;default:return this._viewBubbles}},t.prototype.getEventListeners=function(t){switch(t){case SV.chart:return this._viewListeners;case SV.window:return this._windowListeners;case SV.canvas:return this._canvasListeners;default:return this._viewListeners}},t.prototype._isValidEvent=function(t){return CV.includes(t)||Object.values(gV).includes(t)},t.prototype._isInteractionEvent=function(t){var e;return t&&(e=t.split(":")[0])&&ij.hasInteractionTrigger(e)},t}();function EV(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function BV(t,e,i){t.getParser(e)||t.registerParser(e,i)}var PV,RV=new Map;function LV(){PV||(BV(PV=new uc,"geojson",Wu),BV(PV,"topojson",Yu),EV(PV,"simplify",uu))}function IV(t,e,i){void 0===i&&(i={type:"geojson",centroid:!0}),RV.has(t)&&NA("map type of '".concat(t,"' already exists, will be overwritten.")),LV();var n=new cc(PV),r=mt({},{centroid:!0,simplify:!1},i);"topojson"===i.type?n.parse(e,{type:"topojson",options:r}):n.parse(e,{type:"geojson",options:r});var a=i.simplify;!0===a?n.transform({type:"simplify"}):G(a)&&n.transform({type:"simplify",options:a}),RV.set(t,n)}function FV(t){RV.has(t)?RV.delete(t):NA("map type of '".concat(t,"' does not exists."))}function OV(t,e){void 0===e&&(e=!1);var i=e;return t.latestData instanceof cc&&(i=!1),i?ft(t.latestData):t.latestData&&t.latestData.slice()}var zV,HV,NV,UV,jV=function(t,e){return 0===t.length?[]:1===t.length?OV(t[0],null==e?void 0:e.deep):t.map((function(t){return OV(t,null==e?void 0:e.deep)}))};function VV(e,i,n){EV(i=i instanceof uc?i:e.dataSet,"copyDataView",jV);var r=new cc(i,n);return r.parse([e],{type:"dataview"}),r.transform({type:"copyDataView",level:t.TransformLevel.copyDataView}),r}function WV(t,e,i){var n;if(void 0===i&&(i=[]),t instanceof cc)return t;var r,a=t.id,o=t.values,s=void 0===o?[]:o,l=t.fromDataIndex,u=t.fromDataId,c=t.transforms,h=void 0===c?[]:c,d=t.parser?ft(t.parser):{clone:!0},p=ft(t.fields);d.clone=!(!1===d.clone);var f=i.find((function(t){return t.name===a}));if(f)r=f;else{var v={name:a};if(p&&(v.fields=p),r=new cc(e,v),"string"==typeof u){if(!(g=i.find((function(t){return t.name===u}))))return NA("no data matches fromDataId ".concat(u)),null;r.parse([g],{type:"dataview"}),r.transform({type:"copyDataView"})}else if("number"==typeof l){var g;if(!(g=i[l]))return NA("no data matches fromDataIndex ".concat(l)),null;r.parse([g],{type:"dataview"}),r.transform({type:"copyDataView"})}else Array.isArray(s)?r.parse(s,d):!q(s)||d&&!["csv","dsv","tsv"].includes(d.type)?(r.parse([]),NA("values should be array")):r.parse(s,null!==(n=d)&&void 0!==n?n:{type:"csv"});h&&h.length&&h.forEach((function(t){e.getTransform(t.type)&&r.transform(t)}))}return r}function GV(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}t.TransformLevel=void 0,(zV=t.TransformLevel||(t.TransformLevel={}))[zV.copyDataView=-10]="copyDataView",zV[zV.treemapFilter=-8]="treemapFilter",zV[zV.treemapFlatten=-7]="treemapFlatten",zV[zV.dotObjFlat=-7]="dotObjFlat",zV[zV.linkDotInfo=-7]="linkDotInfo",zV[zV.sankeyLayout=-7]="sankeyLayout",zV[zV.dataZoomFilter=-6]="dataZoomFilter",zV[zV.legendFilter=-5]="legendFilter",function(t){t.appear="appear",t.disappear="disappear",t.enter="enter",t.update="update",t.state="state",t.exit="exit",t.normal="normal",t.none="none"}(HV||(HV={})),function(t){t.data="data",t.mark="mark"}(NV||(NV={})),function(t){t.before="before",t.layouting="layouting",t.reevaluate="reevaluate",t.after="after"}(UV||(UV={}));var YV=["line","area","trail"];function XV(t,e,i){var n=new Map;if(!t||0===t.length)return{keys:[],data:n};if(!e)return n.set(Jj,i?t.slice().sort(i):t.slice()),{keys:[Jj],data:n};if(1===t.length){var r=e(t[0],0);return n.set(r,[t[0]]),{keys:[r],data:n}}var a=new Set;return t.forEach((function(t,i){var r,o=e(t,i),s=null!==(r=n.get(o))&&void 0!==r?r:[];s.push(t),n.set(o,s),a.add(o)})),i&&a.forEach((function(t){n.get(t).sort(i)})),{keys:Array.from(a),data:n}}var KV=function(t,e,i){return void 0===i&&(i={}),t&&Object.keys(t).forEach((function(n){i[n]=t[n](e)})),i};function qV(t,e,i,n,r){var a=function(t){if(!n&&t&&(!i||i(t))){var o=e.call(null,t);if(r&&o)return o}if("group"===t.type){var s=t.getMarks();if(s)for(var l=0;l<s.length;l++){if((o=a(s[l]))&&r)return o}}if(n&&(t&&(!i||i(t))&&(o=e.call(null,t))&&r))return o};return a(t)}function ZV(t){var e=[];return t.forEach((function(t){qV(t,(function(t){"group"!==t.type&&"component"!==t.type&&e.push(t)}))})),e}function JV(t,e,i,n){var r=XV(t,(function(t){return i(t)})),a=XV(e,(function(t){return n(t)})),o=t,s=e,l=[];return a.keys.forEach((function(t){if(!j(t)){var e=r.data.get(t),i=a.data.get(t);e&&i&&(l.push({prev:e,next:i}),o=o.filter((function(t){return!e.includes(t)})),s=s.filter((function(t){return!i.includes(t)})))}})),{prev:o,next:s,update:l}}var QV=function(){function e(e,i){var n=this;this._count=0,this._rootMarks=[],this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._compileChart=null,this.handleLayoutEnd=function(){var e,i;null===(i=null===(e=n._compileChart)||void 0===e?void 0:e.getEvent())||void 0===i||i.emit(t.ChartEvent.afterMarkLayoutEnd,{chart:n._compileChart})},this.handleStageRender=function(){var e,i;null===(i=null===(e=n._compileChart)||void 0===e?void 0:e.getEvent())||void 0===i||i.emit(t.ChartEvent.afterRender,{chart:n._compileChart})},this._handleAfterNextRender=function(){var e,i,r,a;n._stage&&!n._option.disableDirtyBounds&&n._stage.enableDirtyBounds(),n._compileChart&&(null===(e=n._compileChart.getEvent())||void 0===e||e.emit(t.ChartEvent.renderFinished,{chart:n._compileChart,vchart:null===(i=n._compileChart.getOption())||void 0===i?void 0:i.globalInstance})),null===(a=null===(r=n._option.performanceHook)||void 0===r?void 0:r.afterVRenderDraw)||void 0===a||a.call(r,n._compileChart.getOption().globalInstance)},this.handleProgressiveFrame=function(){n._progressiveMarks.length&&n._progressiveMarks.forEach((function(t){t.isDoingProgressive()&&t.renderProgressive()})),n.doPreProgressive()},this._container=e,this._option=i}return e.prototype.getRootGroup=function(){return this._rootGroup},e.prototype.getChart=function(){return this._compileChart},e.prototype.getCanvas=function(){var t;return null===(t=this._stage)||void 0===t?void 0:t.window.getNativeHandler().nativeCanvas},e.prototype.getStage=function(){return this._stage},e.prototype.initView=function(){var e,i,n,r,a=this;if(!this._released&&(this.isInited=!0,!this._stage)){var o=this._option,s=o.autoRefreshDpr,l=o.dpr,u=o.mode,c=o.modeParams,h=o.gestureConfig,d=o.interactive,p=o.clickInterval,f=o.autoPreventDefault,v=o.background;tS.setEnv(function(e){switch(e){case t.RenderModeEnum["desktop-browser"]:case t.RenderModeEnum["mobile-browser"]:return"browser";case t.RenderModeEnum.node:case t.RenderModeEnum.worker:return"node";case t.RenderModeEnum.miniApp:case t.RenderModeEnum["desktop-miniApp"]:return"feishu";case t.RenderModeEnum.lynx:return"lynx";case t.RenderModeEnum.wx:return"wx";case t.RenderModeEnum.tt:return"tt";case t.RenderModeEnum.harmony:return"harmony"}return"browser"}(u),null!=c?c:{}),this._stage=null!==(e=this._option.stage)&&void 0!==e?e:new fS(M({background:v,width:this._width,height:this._height,container:null!==(i=this._container.dom)&&void 0!==i?i:null,canvas:null!==(n=this._container.canvas)&&void 0!==n?n:null,dpr:l,viewBox:this._option.viewBox,canvasControled:this._option.canvasControled,beforeRender:function(t){var e,i,n;null===(e=a._compileChart)||void 0===e||e.onBeforeRender(),null===(n=(i=a._option).beforeRender)||void 0===n||n.call(i,t)},afterRender:this._option.afterRender,disableDirtyBounds:!0,autoRender:!0,ticker:this._option.ticker,pluginList:this._option.pluginList,enableHtmlAttribute:this._option.enableHtmlAttribute,optimize:this._option.optimize,supportsTouchEvents:this._option.supportsTouchEvents,supportsPointerEvents:this._option.supportsPointerEvents,event:{clickInterval:p,autoPreventDefault:f},ReactDOM:this._option.ReactDOM,autoRefresh:W(s)?s:!W(l)},null!==(r=this._option.renderHooks)&&void 0!==r?r:{})),this._stage.enableIncrementalAutoRender(),this._stage.setTheme({symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}});var g=Vy({x:0,y:0,width:this._width,height:this._height});g.name="root",this._stage.defaultLayer.appendChild(g),this._rootGroup=g;var y=(W(h)?h:YA(u))&&!1!==d&&ij.getStageEventPlugin("gesture");y&&(this._gestureController=new y(this._stage,G(h)?h:{})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==d&&this._viewListeners.forEach((function(t){}))}},e.prototype.getLayoutState=function(){return this._layoutState},e.prototype.updateLayoutTag=function(){this._layoutState=UV.before},e.prototype._setCanvasStyle=function(){if(this._stage&&this._container.dom&&!q(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";var t=this.getCanvas();t&&(t.style.display="block")}},e.prototype.compile=function(t,e){if(!this._released){var i=t.chart;this._compileChart=i,this.initView(),this._stage&&("render"!==(null==e?void 0:e.actionSource)&&this._cachedMarks&&(this.reuseOrMorphing(e.morphConfig),this._cachedMarks=null),i.compile(),i.afterCompile())}},e.prototype.clearNextRender=function(){return!!this._nextRafId&&(tS.getSpecifiedCancelAnimationFrame(10)(this._nextRafId),this._nextRafId=null,!0)},e.prototype.clear=function(t){var e=t.chart;this.clearNextRender(),e.clear()},e.prototype.renderNextTick=function(t){var e=this;this._released||(this._nextRafId&&this.clearNextRender(),this._nextRafId=tS.getSpecifiedRequestAnimationFrame(10)((function(){e._nextRafId=null,e.render(t)})))},e.prototype._commitedAll=function(){return this._rootMarks.some((function(t){return qV(t,(function(t){return t.commit()}))}))},e.prototype._hasCommitedMark=function(){return this._rootMarks.some((function(t){return qV(t,(function(t){return t.isCommited()}),null,null,!0)}))},e.prototype._doRender=function(t){var e,i,n,r,a,o,s=this;null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeDoRender)||void 0===i||i.call(e,this._compileChart.getOption().globalInstance),this._stage&&(this.runStageAnimation(),this._rootMarks.forEach((function(t){qV(t,(function(t){t.needClear&&(s._progressiveMarks||t.runAnimation(),t.clearExitGraphics(),t.needClear=!1)}),null,!0)})),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.beforeVRenderDraw)||void 0===r||r.call(n,this._compileChart.getOption().globalInstance),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this._handleAfterNextRender),t&&(this._stage.render(),null===(o=null===(a=this._option.performanceHook)||void 0===a?void 0:a.afterVRenderDraw)||void 0===o||o.call(a,this._compileChart.getOption().globalInstance)))},e.prototype.renderMarks=function(){var t;this._hasCommitedMark()&&(HA("--- start of renderMarks(".concat(this._count,") ---")),this.clearProgressive(),this._rootMarks.forEach((function(t){t.render()})),this._layoutState===UV.before&&(this._layoutState=UV.layouting,null===(t=this._compileChart)||void 0===t||t.onLayout(),this._layoutState=UV.reevaluate,this._hasCommitedMark()&&this._rootMarks.forEach((function(t){t.render()})),this.handleLayoutEnd()),this.findProgressiveMarks(),this.updateStateAnimation(),this._doRender(!0),this.doPreProgressive(),HA("--- start of renderMarks(".concat(this._count,") ---")),this._count++)},e.prototype.reuseOrMorphing=function(t){void 0===t&&(t={});var e=t.reuse,i=void 0===e||e,n=t.morph,r=void 0===n||n,a=t.morphAll,o=void 0!==a&&a;t.animation,t.enableExitAnimation;var s=ZV(this._rootMarks),l=function(t,e,i){var n={enter:[],exit:[],update:[]},r=[],a=[];t.forEach((function(t){i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?r.push(t):n.exit.push({prev:[t]})})),e.forEach((function(t){i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?a.push(t):n.enter.push({next:[t]})}));var o=JV(r,a,(function(t){return t.getMarkConfig().morphKey}),(function(t){return t.getMarkConfig().morphKey}));r=o.prev,a=o.next,n.update=n.update.concat(o.update);var s=JV(r,a,(function(t){return"".concat(t.getUserId())}),(function(t){return"".concat(t.getUserId())}));r=s.prev,a=s.next,n.update=n.update.concat(s.update);var l=XV(r,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)})),u=XV(a,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)}));return Object.keys(u).forEach((function(t){var e=l.data.get(t),i=u.data.get(t);if(e&&i){for(var o=0;o<Math.max(e.length,i.length);o+=1){var s=e[o],c=i[o];s&&c?n.update.push({prev:[s],next:[c]}):s?n.exit.push({prev:[s]}):c&&n.enter.push({next:[c]})}r=r.filter((function(t){return!e.includes(t)})),a=a.filter((function(t){return!i.includes(t)}))}})),r.forEach((function(t){return n.exit.push({prev:[t]})})),a.forEach((function(t){return n.enter.push({next:[t]})})),n}(this._cachedMarks,s,{morph:r,morphAll:o,reuse:i}),u=l.update,c=l.exit;u.forEach((function(t){var e=t.prev,n=t.next;if(i&&1===e.length&&1===n.length&&e[0].type===n[0].type)n[0].reuse(e[0]);else{var r=e.filter((function(t){return t.getMarkConfig().morph}))[0];r&&n.forEach((function(t){t.getMarkConfig().morph&&t.prepareMorph(r)}))}})),c.forEach((function(t){t.prev.forEach((function(t){t.removeProduct()}))}))},e.prototype.render=function(t){if(!this._released&&(this.clearNextRender(),this.initView(),this._stage)){var e=this._rootGroup.attribute,i=e.width,n=e.height;this._width===i&&this._height===n||this._rootGroup.setAttributes({width:this._width,height:this._height}),this.renderMarks(),this.clearNextRender()&&this.renderMarks()}},e.prototype.setStageAnimationConfig=function(t){var e={};Object.keys(t).forEach((function(i){var n=t[i];Z(n)?e[i]=n.map((function(t){var e,i=null!==(e=t.options)&&void 0!==e?e:{};return M(M({},t),{options:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="function"==typeof i?i.apply(void 0,P([],B(t),!1)):i;return M({},n)}})})):e[i]=M({},t[i])})),this._stateAnimationConfig=e},e.prototype.updateStateAnimation=function(){var t=[];this._rootMarks.forEach((function(e){qV(e,(function(e){t.push(e)}))}));var e=t.map((function(t){return t.getAnimationState()})),i=e.every((function(t){return t===HV.appear}))?HV.appear:e.every((function(t){return t===HV.disappear}))?HV.disappear:HV.none;this._stage.context||(this._stage.context={}),this._stage.context.animationState=i},e.prototype.runStageAnimation=function(){var t,e=null===(t=this._stage.context)||void 0===t?void 0:t.animationState;if(this._stateAnimationConfig&&e!==HV.none){var i=Dt(this._stateAnimationConfig[e]).filter((function(t){return t.type}));i.length&&(e===HV.appear?this._stage.stopAnimationState(HV.disappear):e===HV.disappear&&this._stage.stopAnimationState(HV.appear),this._stage.applyAnimationState([e],[{name:e,animation:i}]))}},e.prototype.updateViewBox=function(t,e){if(void 0===e&&(e=!0),this._stage){var i=this._stage.viewBox;!t||i&&i.x1===t.x1&&i.y1===t.y1&&i.x2===t.x2&&i.y2===t.y2||this._stage.setViewBox(t,e)}},e.prototype.resize=function(t,e,i){if(void 0===i&&(i=!0),this._stage){var n=this._width!==t||this._height!==e;this._width=t,this._height=e,n&&(this._stage.resize(t,e),this._commitedAll(),i&&this.render({morph:!1}))}},e.prototype.setBackground=function(t){this._stage&&(this._stage.background=t)},e.prototype.setSize=function(t,e){this._width=t,this._height=e,this._stage},e.prototype.setViewBox=function(t,e){void 0===e&&(e=!0),this.updateViewBox(t,e)},e.prototype.addEventListener=function(t,e,i){var n,r;if(!1!==this._option.interactive)if(t===SV.chart){var a=this.getRootGroup(),o=function(n){var r,o=n.target,s=null;o&&(s=W(o.context)?o:_V(a,o));var l=null!==(r=null==s?void 0:s.context)&&void 0!==r?r:{},u=W(l.markId)?l.markId:null,c=W(l.modelId)?l.modelId:null,h=W(l.modelUserId)?l.modelUserId:null,d=W(l.markUserId)?l.markUserId:null,p={event:n,type:e,source:t,item:s,datum:mV(s),markId:u,modelId:c,markUserId:d,modelUserId:h};i.call(null,p)}.bind(this);this._viewListeners.set(i,{type:e,callback:o}),null===(n=this._stage)||void 0===n||n.addEventListener(e,o)}else if(t===SV.window){o=function(n){var r={event:n,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};i.call(null,r)}.bind(this);this._windowListeners.set(i,{type:e,callback:o});var s=this._getGlobalThis();null==s||s.addEventListener(e,o)}else if(t===SV.canvas){o=function(n){var r={event:n,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};i.call(null,r)}.bind(this);this._canvasListeners.set(i,{type:e,callback:o});var l=null===(r=this.getStage())||void 0===r?void 0:r.window;null==l||l.addEventListener(e,o)}},e.prototype.removeEventListener=function(t,e,i){var n,r,a,o,s;if(!1!==this._option.interactive)if(t===SV.chart)(c=null===(n=this._viewListeners.get(i))||void 0===n?void 0:n.callback)&&(null===(r=this._stage)||void 0===r||r.removeEventListener(e,c)),this._viewListeners.delete(i);else if(t===SV.window){var l=this._getGlobalThis();(c=null===(a=this._windowListeners.get(i))||void 0===a?void 0:a.callback)&&(null==l||l.removeEventListener(e,c)),this._windowListeners.delete(i)}else if(t===SV.canvas){var u=null===(o=this.getStage())||void 0===o?void 0:o.window,c=null===(s=this._canvasListeners.get(i))||void 0===s?void 0:s.callback;u&&c&&(null==u||u.removeEventListener(e,c)),this._canvasListeners.delete(i)}},e.prototype.releaseEvent=function(){var t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()},e.prototype.release=function(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this.releaseGrammar(!0),this._stage!==(null===(t=this._option)||void 0===t?void 0:t.stage)&&this._stage.release(),this._stage=null,this.isInited=!1,this._compileChart=null,this._released=!0},e.prototype.releaseGrammar=function(t){void 0===t&&(t=!1),t?this._rootMarks.forEach((function(t){qV(t,(function(t){t.removeProduct()}),null,!0)})):this._cachedMarks=ZV(this._rootMarks),this._rootMarks=[]},e.prototype.addRootMark=function(t){this._rootMarks.includes(t)||this._rootMarks.push(t)},e.prototype.getRootMarks=function(){return this._rootMarks},e.prototype.removeRootMark=function(t){var e=this._rootMarks.findIndex((function(e){return e===t}));return e>=0&&(this._rootMarks.splice(e,1),!0)},e.prototype._getGlobalThis=function(){var t;return GA(this._option.mode)?globalThis:null===(t=this.getStage())||void 0===t?void 0:t.window},e.prototype._combineIncrementalLayers=function(){var t=this;this._stage&&function(t){return wg(this,void 0,void 0,f().m((function e(){var i,n;return f().w((function(e){for(;;)switch(e.n){case 0:return i=[],n=t.getChildren(),e.n=1,new Promise((function(t){oh.global.getRequestAnimationFrame()((function(){t(null)}))}));case 1:return n.forEach((function(t){t.subLayers.size&&t.subLayers.forEach((function(t){t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&i.push(new Promise((function(e){t.drawContribution.hooks.completeDraw.tap("outWait",(function(){t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter((function(t){return"outWait"!==t.name})),e(null)}))})))}))})),e.n=2,Promise.all(i);case 2:return e.a(2)}}),e)})))}(this._stage).then((function(){t._stage&&t._stage.defaultLayer.combineSubLayer()}))},e.prototype.findProgressiveMarks=function(){var t=[];return this._rootMarks.forEach((function(e){qV(e,(function(e){e.isProgressive()&&t.push(e)}))})),t.length?(this._progressiveMarks=t,this._combineIncrementalLayers(),t):(this._progressiveMarks=null,null)},e.prototype.doPreProgressive=function(){if(this._progressiveMarks&&this._progressiveMarks.some((function(t){return t.isDoingProgressive()}))){var t=tS.getSpecifiedRequestAnimationFrame(10);this._progressiveRafId=t(this.handleProgressiveFrame)}else this._progressiveMarks&&this._progressiveMarks.every((function(t){return t.canAnimateAfterProgressive()}))?this._progressiveMarks.forEach((function(t){t.runAnimation()})):this._progressiveMarks&&(this._progressiveMarks=null)},e.prototype.clearProgressive=function(){this._progressiveRafId&&tS.getSpecifiedCancelAnimationFrame(10)(this._progressiveRafId);this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach((function(t){t.clearProgressive()})),this._progressiveMarks=null)},e}();function $V(t){return new Promise((function(e){t.convertToBlob().then((function(t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){e(i.result)}}))}))}function tW(t,e){var i;return T(this,void 0,void 0,(function(){return D(this,(function(n){if(!t)return[2,""];try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return[2,$V(t)]}catch(t){(null!==(i=null==e?void 0:e.onError)&&void 0!==i?i:UA)("getCanvasDataURL error : ".concat(t.toString()))}return[2,t.toDataURL()]}))}))}function eW(t){t.crosshair=Dt(t.crosshair||{}).map((function(e){var i;return ej(((i={})["horizontal"===t.direction?"yField":"xField"]={visible:!0,line:{visible:!0,type:"rect"}},i),e)}))}function iW(t,e,i){var n,r=t.width,a=t.height;if(W(r)&&W(a))return{width:r,height:a};var o=i.width,s=i.height,l=e.container,u=e.canvas;if(l){var c=ca(l,i.width,i.height);o=c.width,s=c.height}else if(u&&GA(e.mode)){var h=ca(q(u)?tS.getElementById(u):u,i.width,i.height);o=h.width,s=h.height}else if(XA(e.mode)&&(null===(n=e.modeParams)||void 0===n?void 0:n.domref)){var d=e.modeParams.domref;o=d.width,s=d.height}return{width:o=null!=r?r:o,height:s=null!=a?a:s}}function nW(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=function(i){return e.reduce((function(t,e){return t||(null==e?void 0:e[i])}),t[i])};return Object.assign(t,{change:n("change"),reCompile:n("reCompile"),reMake:n("reMake"),reRender:n("reRender"),reSize:n("reSize"),reTransformSpec:n("reTransformSpec"),changeTheme:n("changeTheme"),changeBackground:n("changeBackground")}),t}function rW(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every((function(t){return"area"===t.type||"line"===t.type}))?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}var aW,oW,sW;t.LayoutZIndex=void 0,(aW=t.LayoutZIndex||(t.LayoutZIndex={}))[aW.SeriesGroup=0]="SeriesGroup",aW[aW.Axis_Grid=50]="Axis_Grid",aW[aW.CrossHair_Grid=100]="CrossHair_Grid",aW[aW.Region=450]="Region",aW[aW.Mark=300]="Mark",aW[aW.Node=400]="Node",aW[aW.Axis=100]="Axis",aW[aW.MarkLine=500]="MarkLine",aW[aW.MarkArea=100]="MarkArea",aW[aW.MarkPoint=500]="MarkPoint",aW[aW.DataZoom=500]="DataZoom",aW[aW.ScrollBar=500]="ScrollBar",aW[aW.Player=500]="Player",aW[aW.Legend=500]="Legend",aW[aW.CrossHair=500]="CrossHair",aW[aW.Indicator=500]="Indicator",aW[aW.Title=500]="Title",aW[aW.Label=500]="Label",aW[aW.Brush=500]="Brush",aW[aW.CustomMark=500]="CustomMark",aW[aW.Interaction=700]="Interaction",t.LayoutLevel=void 0,(oW=t.LayoutLevel||(t.LayoutLevel={}))[oW.Indicator=10]="Indicator",oW[oW.Region=20]="Region",oW[oW.Axis=30]="Axis",oW[oW.DataZoom=40]="DataZoom",oW[oW.Player=40]="Player",oW[oW.ScrollBar=40]="ScrollBar",oW[oW.Legend=50]="Legend",oW[oW.Title=70]="Title",oW[oW.CustomMark=70]="CustomMark",t.AttributeLevel=void 0,(sW=t.AttributeLevel||(t.AttributeLevel={}))[sW.Default=0]="Default",sW[sW.Theme=1]="Theme",sW[sW.Chart=2]="Chart",sW[sW.Base_Series=3]="Base_Series",sW[sW.Series=4]="Series",sW[sW.Mark=5]="Mark",sW[sW.User_Chart=6]="User_Chart",sW[sW.User_Series=7]="User_Series",sW[sW.User_Mark=8]="User_Mark",sW[sW.User_SeriesStyle=9]="User_SeriesStyle",sW[sW.Built_In=99]="Built_In";var lW=function(){function t(){this._children=[],this._markNameMap={},this._infoMap=new Map}return t.prototype.getMarkNameMap=function(){return this._markNameMap},t.prototype.addMark=function(e,i){j(e)||(this._children.push(e),this._markNameMap[e.name]=e,this._infoMap.set(e,mt({},t.defaultMarkInfo,i)))},t.prototype.removeMark=function(t){var e=this._children.findIndex((function(e){return e.name===t}));e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))},t.prototype.clear=function(){this._children=[],this._markNameMap={},this._infoMap.clear()},t.prototype.forEach=function(t){this._children.forEach(t)},t.prototype.includes=function(t,e){return this._children.includes(t,e)},t.prototype.get=function(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]},t.prototype.getMarks=function(){return this._children.slice()},t.prototype.getMarksInType=function(t){var e=Dt(t);return this._children.filter((function(t){return e.includes(t.type)}))},t.prototype.getMarkInId=function(t){return this._children.find((function(e){return e.id===t}))},t.prototype.getMarkWithInfo=function(t){var e=this;return this._children.find((function(i){return Object.keys(t).every((function(n){return t[n]===e._infoMap.get(i)[n]}))}))},t.defaultMarkInfo={},t}(),uW=function(){function t(t){this._option=t,this.getCompiler=this._option.getCompiler}return t.prototype.getOption=function(){return this._option},t.prototype.getStage=function(){var t;return null===(t=this.getCompiler())||void 0===t?void 0:t.getStage()},t.prototype.release=function(){this._option=null,this.getCompiler=null},t}(),cW=function(){function t(t){this._option=t,this.type=t.type}return t.prototype._initTheme=function(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)},t.prototype.getTheme=function(t,e){},t.prototype.transformSpec=function(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);var n=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(n.spec,e,i),n},t.prototype._transformSpecBeforeMergingTheme=function(t,e,i){},t.prototype._transformSpecAfterMergingTheme=function(t,e,i){},t.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){return ej({},i,n,t)};return Z(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},t.prototype._shouldMergeThemeToSpec=function(){return!0},t.prototype._getDefaultSpecFromChart=function(t){},t}(),hW=function(t){function e(e,i){var n,r=this;return(r=t.call(this,i)||this).transformerConstructor=cW,r.type="null",r.modelType="null",r.userId=void 0,r._data=null,r._layout=null,r.specKey="",r._marks=new lW,r._lastLayoutRect=null,r.id=qA(),r.userId=e.id,r._spec=e,r.effect={},r.event=new xV(i.eventDispatcher,i.mode),null===(n=i.map)||void 0===n||n.set(r.id,r),r}return C(e,t),e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getSpecPath=function(){var t;return null===(t=this._option)||void 0===t?void 0:t.specPath},e.prototype.getSpecInfoPath=function(){var t,e,i;return null!==(e=null===(t=this._option)||void 0===t?void 0:t.specInfoPath)&&void 0!==e?e:null===(i=this._option)||void 0===i?void 0:i.specPath},e.prototype.getData=function(){return this._data},Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},enumerable:!1,configurable:!0}),e.prototype.getOption=function(){return this._option},e.prototype.getMarks=function(){var t,e;return null!==(e=null===(t=this._marks)||void 0===t?void 0:t.getMarks())&&void 0!==e?e:[]},e.prototype.getMarkNameMap=function(){var t;return null===(t=this._marks)||void 0===t?void 0:t.getMarkNameMap()},e.prototype.getMarkSet=function(){return this._marks},e.prototype.getChart=function(){return this._option.getChart()},Object.defineProperty(e.prototype,"_theme",{get:function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.theme},enumerable:!1,configurable:!0}),e.prototype._releaseEvent=function(){this.event.release()},e.prototype.created=function(){this.setAttrFromSpec()},e.prototype.init=function(t){},e.prototype.afterInit=function(){},e.prototype.getVisible=function(){var t;return!1!==(null===(t=this._spec)||void 0===t?void 0:t.visible)},e.prototype.onLayoutStart=function(t,e){var i;null===(i=this._layout)||void 0===i||i.onLayoutStart(t,e)},e.prototype.onLayoutEnd=function(){var t;null===(t=this._layout)||void 0===t||t.onLayoutEnd(),this.getMarks().forEach((function(t){return t.commit(!1,!0)}))},e.prototype.onEvaluateEnd=function(t){},e.prototype.onBeforeRender=function(){},e.prototype.onDataUpdate=function(){},e.prototype.beforeRelease=function(){},e.prototype.clear=function(){this.getMarks().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},e.prototype.release=function(){var e;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach((function(t){return t.release()})),null===(e=this._data)||void 0===e||e.release(),this._data=null,this._marks.clear(),t.prototype.release.call(this)},e.prototype.updateSpec=function(t){var e,i=this._compareSpec(t,this._spec);return(i.reRender||i.reMake||i.reCompile)&&(null===(e=this._layout)||void 0===e||e.setWillLayoutTag()),this._spec=t,i},e.prototype._compareSpec=function(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}},e.prototype.reInit=function(t){t&&(this._spec=t),this.setAttrFromSpec()},e.prototype.updateLayoutAttribute=function(){},e.prototype.setAttrFromSpec=function(){var t;null===(t=this._layout)||void 0===t||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())},e.prototype._convertMarkStyle=function(t){return M({},t)},e.prototype.setMarkStyle=function(t,e,i,n){W(t)&&W(e)&&t.setStyle(this._convertMarkStyle(e),i,n)},e.prototype.initMarkStyleWithSpec=function(t,e){var i=this;if(W(t)&&W(e)){var n=e.style,r=e.state,a=M({},e);n&&(a.style=this._convertMarkStyle(n)),r&&(a.state={},Object.keys(r).forEach((function(t){a.state[t]=i._convertMarkStyle(r[t])}))),t.initStyleWithSpec(a)}},e.prototype.stateKeyToSignalName=function(t,e){var i="".concat(Mj,"_").concat(this.modelType,"_").concat(this.type,"_").concat(this.id,"_").concat(t);return e&&(i+="_".concat(e)),i},e.prototype.compileData=function(){var t;null===(t=this._data)||void 0===t||t.compile()},e.prototype.compileMarks=function(t){this.getMarks().forEach((function(e){e.compile({group:t})}))},e.prototype._createMark=function(t,e,i){void 0===e&&(e={});var n=t.type,r=t.name,a=e.parent,o=w(e,["parent"]),s=ij.createMark(n,r,M({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},o));return a?a.addMark(s):this.getCompiler().addRootMark(s),s&&(s.created(),i&&s.setMarkConfig(i)),s},e.prototype._getDataIdKey=function(){},e.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t,"colorScheme")},e.prototype.getSpecInfo=function(){var t,e,i;return function(t,e,i){if(!j(e))return ht(t,e,i)}(null!==(i=null===(e=(t=this._option).getSpecInfo)||void 0===e?void 0:e.call(t))&&void 0!==i?i:{},this.getSpecInfoPath())},e.prototype.getSpecIndex=function(){var t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;var e=Number(t[t.length-1]);return isNaN(e)?0:e},e.prototype.updateAnimateStateCallback=function(t){this._aniamtionStateCallback=t},e.prototype.getAnimationStateCallback=function(){return this._aniamtionStateCallback},e}(uW),dW=function(){function e(e,i){var n,r=this;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:0,height:0},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=function(){return r._layoutRect},this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=t.LayoutLevel.Region,this._willLayoutTag=!0,this._model=e,this._option=i,this.layoutLevel=i.layoutLevel,this.layoutType=i.layoutType,i.layoutOrient&&(this.layoutOrient=i.layoutOrient),this._spec=null===(n=null==e?void 0:e.getSpec)||void 0===n?void 0:n.call(e)}return e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getLayoutStartPoint=function(){return this._layoutStartPoint},Object.defineProperty(e.prototype,"layoutRectLevelMap",{get:function(){return this._layoutRectLevelMap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minWidth",{get:function(){return this._minWidth},set:function(t){this._minWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minHeight",{get:function(){return this._minHeight},set:function(t){this._minHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){this._maxHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastComputeRect",{get:function(){return this._lastComputeRect},enumerable:!1,configurable:!0}),e.prototype.getLastComputeOutBounds=function(){return this._lastComputeOutBounds},Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._layoutOrient},set:function(t){this._layoutOrient=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._model.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"willLayoutTag",{get:function(){return this._willLayoutTag},enumerable:!1,configurable:!0}),e.prototype._setLayoutAttributeFromSpec=function(t,e){var i,n,r,a;if(this._spec&&!1!==this._spec.visible){var o=NU(jU(t.padding),e,e);this._option.transformLayoutPadding&&(o=this._option.transformLayoutPadding(o)),this.layoutPaddingLeft=o.left,this.layoutPaddingRight=o.right,this.layoutPaddingTop=o.top,this.layoutPaddingBottom=o.bottom,this._minHeight=j(t.minHeight)?null!==(i=this._minHeight)&&void 0!==i?i:null:HU(t.minHeight,e.height,e),this._maxHeight=j(t.maxHeight)?null!==(n=this._maxHeight)&&void 0!==n?n:null:HU(t.maxHeight,e.height,e),this._minWidth=j(t.minWidth)?null!==(r=this._minWidth)&&void 0!==r?r:null:HU(t.minWidth,e.width,e),this._maxWidth=j(t.maxWidth)?null!==(a=this._maxWidth)&&void 0!==a?a:null:HU(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:HU(t.width,e.width,e)},{width:9}),t.height&&this.setLayoutRect({height:HU(t.height,e.height,e)},{height:9}),j(t.offsetX)||(this.layoutOffsetX=HU(t.offsetX,e.width,e)),j(t.offsetY)||(this.layoutOffsetY=HU(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}},e.prototype.setAttrFromSpec=function(t,e){var i,n,r,a;this._spec=t,this.layoutType=null!==(i=t.layoutType)&&void 0!==i?i:this.layoutType,this.layoutLevel=null!==(n=t.layoutLevel)&&void 0!==n?n:this.layoutLevel,this.layoutOrient=null!==(r=t.orient)&&void 0!==r?r:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!==(a=t.clip)&&void 0!==a?a:this.layoutClip},e.prototype.onLayoutStart=function(t,e){this._setLayoutAttributeFromSpec(this._spec,e)},e.prototype.onLayoutEnd=function(){},e.prototype._getAbsoluteSpecValue=function(t){var e=this,i={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach((function(n){j(e._spec[n])||(i[n]=HU(e._spec[n],"top"===n||"bottom"===n?t.height:t.width,t))})),i},e.prototype.absoluteLayoutInRect=function(t){var e=this._getAbsoluteSpecValue(t),i=e.top,n=e.bottom,r=e.left,a=e.right,o={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};j(r)||(o.width-=r),j(a)||(o.width-=a),j(i)||(o.height-=i),j(n)||(o.height-=n),this.setLayoutRect(o);var s=this.computeBoundsInRect(this.getLayoutRect()),l=s.width,u=s.height;this.setLayoutRect({width:l,height:u});var c={x:t.x,y:t.y};!0===this._spec.center?(c.x=t.x+.5*t.width-.5*l,c.y=t.y+.5*t.height-.5*u):(j(r)?j(a)||(c.x=t.x+t.width-this.layoutPaddingRight-a-l):c.x=t.x+r+this.layoutPaddingLeft,j(i)?j(n)||(c.y=t.y+t.height-this.layoutPaddingBottom-n-u):c.y=t.y+i+this.layoutPaddingTop),this.setLayoutStartPosition(c)},e.prototype.setLayoutStartPosition=function(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),it(t.x)&&(this._layoutStartPoint.x=t.x),it(t.y)&&(this._layoutStartPoint.y=t.y),null===(i=(e=this._model).afterSetLayoutStartPoint)||void 0===i||i.call(e,this._layoutStartPoint)},e.prototype.setLayoutRect=function(t,e){var i,n,r,a,o=t.width,s=t.height;it(o)&&(null!==(i=null==e?void 0:e.width)&&void 0!==i?i:0)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=o,this._layoutRectLevelMap.width=null!==(n=null==e?void 0:e.width)&&void 0!==n?n:0),it(s)&&(null!==(r=null==e?void 0:e.height)&&void 0!==r?r:0)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=s,this._layoutRectLevelMap.height=null!==(a=null==e?void 0:e.height)&&void 0!==a?a:0),this.setRectInSpec(this._layoutRect)},e.prototype.getLayout=function(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}},e.prototype.mergeLayoutRect=function(t){var e={width:t.width,height:t.height};return this._layoutRectLevelMap.width>0&&(e.width=this._layoutRect.width),this._layoutRectLevelMap.height>0&&(e.height=this._layoutRect.height),e},e.prototype.getOrientPosAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"},e.prototype.getOrientSizeAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"},e.prototype.changeBoundsBySetting=function(t){return this._layoutRectLevelMap.width>0&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>0&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t},e.prototype.setRectInSpec=function(t){var e=M({},t);return this._layoutRectLevelMap.width<9?(j(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),j(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<9?(j(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),j(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e},e.prototype.computeBoundsInRect=function(t){if(this._lastComputeRect=t,!("region-relative"!==this.layoutType&&"region-relative-overlap"!==this.layoutType||(9!==this._layoutRectLevelMap.width||"left"!==this.layoutOrient&&"right"!==this.layoutOrient)&&(9!==this._layoutRectLevelMap.height||"bottom"!==this.layoutOrient&&"top"!==this.layoutOrient)))return this._layoutRect;var e=M({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));var i=this.setRectInSpec(UU(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i},e.prototype.getModelId=function(){return this._model.id},e.prototype.getModelVisible=function(){return this._model.getVisible()},e.prototype.setWillLayoutTag=function(){this._willLayoutTag=!0},e.prototype.clearWillLayoutTag=function(){this._willLayoutTag=!1},e}(),pW=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="normal",e.layoutLevel=0,e.layoutZIndex=0,e._forceLayoutTag=!1,e._layout=null,e._orient=null,e._layoutRect={width:0,height:0},e._layoutStartPos={x:0,y:0},e._isLayout=!0,e.getGraphicBounds=function(){return e._layout?{x1:e._layout.getLayoutStartPoint().x,y1:e._layout.getLayoutStartPoint().y,x2:e._layout.getLayoutStartPoint().x+e._layout.getLayoutRect().width,y2:e._layout.getLayoutStartPoint().y+e._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0}},e._transformLayoutRect=null,e._transformLayoutPosition=null,e._transformLayoutPadding=null,e}return C(e,t),Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._orient},set:function(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)},enumerable:!1,configurable:!0}),e.prototype.initLayout=function(){"none"!==this.layoutType&&(this._layout=new dW(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition,transformLayoutPadding:this._transformLayoutPadding}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))},e.prototype.onLayoutStart=function(e,i){this._isLayout=!0,t.prototype.onLayoutStart.call(this,e,i)},e.prototype.onLayoutEnd=function(){t.prototype.onLayoutEnd.call(this),this.updateLayoutAttribute();var e=this.getLayoutRect();!this._forceLayoutTag&&St(this._lastLayoutRect,e)||(this._lastLayoutRect=M({},e)),this._forceLayoutTag=!1,this._isLayout=!1},e.prototype.afterSetLayoutStartPoint=function(t){},e.prototype._forceLayout=function(){var t,e;this._isLayout||(null===(t=this._layout)||void 0===t||t.setWillLayoutTag(),this._forceLayoutTag=!0,null===(e=this._option.globalInstance.getChart())||void 0===e||e.setLayoutTag(!0))},e.prototype.getLayoutStartPoint=function(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos},e.prototype.setLayoutStartPosition=function(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=mt(this._layoutStartPos,t)},e.prototype.getLayoutRect=function(){return this._layout?this._layout.getLayoutRect():this._layoutRect},e.prototype.setLayoutRect=function(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=mt(this._layoutRect,t)},e.prototype.getLastComputeOutBounds=function(){var t;return null===(t=this._layout)||void 0===t?void 0:t.getLastComputeOutBounds()},e.prototype.setAttrFromSpec=function(){var e,i,n,r,a;t.prototype.setAttrFromSpec.call(this),this.layoutClip=null!==(e=this._spec.clip)&&void 0!==e?e:this.layoutClip,this.layoutZIndex=null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex,this.layoutType=null!==(n=this._spec.layoutType)&&void 0!==n?n:this.layoutType,this._orient=null!==(r=this._spec.orient)&&void 0!==r?r:this._orient,this.layoutLevel=null!==(a=this._spec.layoutLevel)&&void 0!==a?a:this.layoutLevel},e}(hW),fW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(cW),vW=function(e){function i(n,r){var a,o=this;return(o=e.call(this,n,r)||this).transformerConstructor=fW,o.modelType="region",o.specKey="region",o.type=i.type,o._series=[],o.layoutType="region",o.layoutZIndex=t.LayoutZIndex.Region,o.seriesDataFilterOver=function(){o.event.emit(t.ChartEvent.regionSeriesDataFilterOver,{model:o,chart:o.getChart()}),o._series.forEach((function(t){t.getViewDataFilter()&&t.reTransformViewData()}))},o.getBoundsInRect=function(){return{x1:o._layout.getLayoutStartPoint().x,y1:o._layout.getLayoutStartPoint().y,x2:o._layout.getLayoutStartPoint().x+o._layout.getLayoutRect().width,y2:o._layout.getLayoutStartPoint().y+o._layout.getLayoutRect().height}},o.userId=n.id,o.coordinate=null!==(a=n.coordinate)&&void 0!==a?a:"cartesian",o}return C(i,e),i.prototype.getMaxWidth=function(){return this._layout.maxWidth},i.prototype.setMaxWidth=function(t){this._layout.maxWidth=t},i.prototype.getMaxHeight=function(){return this._layout.maxHeight},i.prototype.setMaxHeight=function(t){this._layout.maxHeight=t},i.prototype.getGroupMark=function(){return this._groupMark},i.prototype.getInteractionMark=function(){return this._interactionMark},i.prototype.getStackInverse=function(){return!0===this._spec.stackInverse},i.prototype.getStackSort=function(){return!0===this._spec.stackSort},i.prototype._getClipDefaultValue=function(){var t,e,i,n,r=this._option.getChart().getSpec(),a=null===(e=null===(t=r.dataZoom)||void 0===t?void 0:t.some)||void 0===e?void 0:e.call(t,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"filter")})),o=null===(n=null===(i=r.scrollBar)||void 0===i?void 0:i.some)||void 0===n?void 0:n.call(i,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"axis")}));return!(!a&&!o)||this._layout.layoutClip},i.prototype.created=function(){var i,n,r=this;this.initLayout(),e.prototype.created.call(this);var a=null!==(i=this._spec.clip)&&void 0!==i?i:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",(null!==(n=this.userId)&&void 0!==n?n:this.type)+"_interaction",t.LayoutZIndex.Interaction),ct(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"},{parent:this._groupMark}),a&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"},{parent:this._groupMark})),[this._backgroundMark,this._foregroundMark].forEach((function(e){e&&(e.created(),r.setMarkStyle(e,{width:function(){return r.getLayoutRect().width},height:function(){return r.getLayoutRect().height}},"normal",t.AttributeLevel.Built_In),r._groupMark.addMark(e))})),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:t.LayoutZIndex.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:t.LayoutZIndex.Mark+1}))},i.prototype._createGroupMark=function(e,i,n){var r,a,o=this,s=this._createMark({type:"group",name:e});s.setUserId(i),s.setMarkConfig({zIndex:n});var l=null!==(r=this._spec.clip)&&void 0!==r?r:this._getClipDefaultValue();return this.setMarkStyle(s,{x:function(){return o.getLayoutStartPoint().x},y:function(){return o.getLayoutStartPoint().y},width:function(){return o.getLayoutRect().width},height:function(){return o.getLayoutRect().height},clip:l},"normal",t.AttributeLevel.Built_In),this.setMarkStyle(s,{cornerRadius:null===(a=this._spec.style)||void 0===a?void 0:a.cornerRadius},"normal",t.AttributeLevel.User_Mark),this._marks.addMark(s),s},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initMark(),this.initSeriesDataflow()},i.prototype.initMark=function(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},i.prototype._initBackgroundMarkStyle=function(){var e,i;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,M({fillOpacity:(null===(e=this._spec.style)||void 0===e?void 0:e.fill)?1:0},this._spec.style),"normal",t.AttributeLevel.User_Mark),(null!==(i=this._spec.clip)&&void 0!==i?i:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",t.AttributeLevel.Built_In))},i.prototype._initForegroundMarkStyle=function(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,M(M({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",t.AttributeLevel.User_Mark)},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return St(null==i?void 0:i.style,null==t?void 0:t.style)||(n.reMake=!0),n},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},i.prototype.addSeries=function(t){t&&(this._series.includes(t)||this._series.push(t))},i.prototype.removeSeries=function(t){if(t){var e=this._series.findIndex((function(e){return e===t}));e>=0&&this._series.splice(e,1)}},i.prototype.getSeries=function(t){return void 0===t&&(t={}),this._series.filter((function(e){var i,n;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||Dt(t.userId).includes(e.userId))&&(!W(t.specIndex)||Dt(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null===(n=null===(i=e.getRawData)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.name)===t.dataName)}))},i.prototype.getSeriesInName=function(t){return this.getSeries({name:t})[0]},i.prototype.getSeriesInUserId=function(t){return this.getSeries({userId:t})[0]},i.prototype.getSeriesInId=function(t){return this.getSeries({id:t})[0]},i.prototype.getSeriesInType=function(t){return this.getSeries({type:t})},i.prototype.getSeriesInCoordinateType=function(t){return this.getSeries({coordinateType:t})},i.prototype.getSeriesInDataName=function(t){return this.getSeries({dataName:t})},i.prototype.initSeriesDataflow=function(){var t=this._series.map((function(t){var e;return null!==(e=t.getViewDataFilter())&&void 0!==e?e:t.getViewData()})).filter((function(t){return!!t}));this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)},i.prototype.release=function(){e.prototype.release.call(this),this._series=[]},i.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){i.compile({group:t,context:{model:e}})}))},i.prototype.compile=function(){this.compileMarks()},i.prototype.onLayoutEnd=function(){this._series.forEach((function(t){return t.onLayoutEnd()})),e.prototype.onLayoutEnd.call(this)},i.type="region",i.transformerConstructor=fW,i.specKey="region",i}(pW);function gW(t){var e=[],i=[],n=[];return t.forEach((function(t){j(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&n.push(t)})),{startItems:e,endItems:n,middleItems:i}}function yW(t,e,i){e?t.forEach((function(t){var e=Et(t),n=e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})}))})):t.forEach((function(t){var e=Et(t),n=e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})}))}))}function mW(t,e,i,n){var r;t.forEach((function(t,a){t.length>1&&(r=i[a],t.forEach((function(t){if(t.alignSelf&&"start"!==t.alignSelf){var i=t.getLayoutStartPoint(),a="middle"===t.alignSelf?.5:1,o=e?r-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):r-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+n*o*a,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+n*o*a})}})))}))}function _W(t,e,i,n,r,a){if(t.length){var o=0,s="right"===r,l=s?-1:1,u=s?e.rightCurrent:e.leftCurrent,c=e.topCurrent,h=[],d=[],p=[];t.forEach((function(t){var n=SW(t,e,a).rect,r=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=s?-n.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:u+t.layoutOffsetX+v,y:c+t.layoutOffsetY+t.layoutPaddingTop}),(c+=r)>i&&d.length?(p.push(o),u+=l*o,o=f,c=e.topCurrent+r,t.setLayoutStartPosition({x:u+t.layoutOffsetX+v,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),h.push(d),d=[t]):(o=Math.max(o,f),d.push(t))})),p.push(o),h.push(d),mW(h,!0,p,l),n&&yW(h,!0,i),s?e.rightCurrent=u+l*o:e.leftCurrent=u+l*o}}function bW(t,e,i,n,r){if(t.length){var a=0,o="right"===n,s=o?-1:1,l=o?e.rightCurrent:e.leftCurrent,u=e.bottomCurrent,c=[],h=[],d=[];t.forEach((function(t){var i=SW(t,e,r).rect,n=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=o?-i.width-t.layoutPaddingRight:t.layoutPaddingLeft;u<n&&h.length?(d.push(a),l+=s*a,a=p,u=e.bottomCurrent,t.setLayoutStartPosition({x:l+t.layoutOffsetX+f,y:u+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),c.push(h),h=[t]):(t.setLayoutStartPosition({x:l+t.layoutOffsetX+f,y:u+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),a=Math.max(a,p),u-=n,h.push(t))})),d.push(a),c.push(h),mW(c,!0,d,s),o?e.rightCurrent=l+s*a:e.leftCurrent=l+s*a}}function xW(t,e,i,n,r,a){if(t.length){var o="top"===r,s=o?1:-1,l=0,u=e.leftCurrent,c=o?e.topCurrent:e.bottomCurrent,h=[],d=[],p=[];t.forEach((function(t){var n=SW(t,e,a).rect,r=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=o?t.layoutPaddingTop:-n.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:u+t.layoutOffsetX+t.layoutPaddingLeft,y:c+t.layoutOffsetY+v}),(u+=f)>i&&d.length?(p.push(l),u=e.leftCurrent+f,c+=s*l,l=r,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:c+t.layoutOffsetY+v}),h.push(d),d=[t]):(l=Math.max(l,r),d.push(t))})),p.push(l),h.push(d),mW(h,!1,p,s),n&&yW(h,!1,i),o?e.topCurrent=c+s*l:e.bottomCurrent=c+s*l}}function kW(t,e,i,n,r){if(t.length){var a="top"===n,o=a?1:-1,s=0,l=e.rightCurrent,u=a?e.topCurrent:e.bottomCurrent,c=[],h=[],d=[];t.forEach((function(t){var i=SW(t,e,r).rect,n=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,d=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,p=a?t.layoutPaddingTop:-i.height-t.layoutPaddingBottom;l<d&&h.length?(l=e.rightCurrent,u+=o*s,s=n,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:u+t.layoutOffsetY+p}),c.push(h),h=[t]):(h.push(t),t.setLayoutStartPosition({x:l+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:u+t.layoutOffsetY+p}),s=Math.max(s,n),l-=d)})),d.push(s),c.push(h),mW(c,!1,d,o),a?e.topCurrent=u+o*s:e.bottomCurrent=u+o*s}}function SW(t,e,i,n){var r,a;void 0===n&&(n=!0);var o="recomputeHeight",s="recomputeWidth",l="width";"top"!==t.layoutOrient&&"bottom"!==t.layoutOrient||(o="recomputeWidth",s="recomputeHeight",l="height");var u=!(!t.willLayoutTag&&!1===i[o]);if(u){var c=M({},t.getLayoutRect()),h=t.lastComputeRect;r=e.getItemComputeLayoutRect(t),!t.willLayoutTag&&St(r,h)?(u=!1,a=t.getLayoutRect()):(a=t.computeBoundsInRect(r),St(c[l],a[l])?u=!1:(n&&t.setLayoutRect(a),i[s]=!0))}else r=t.getLastComputeOutBounds(),a=t.getLayoutRect();return{layoutRect:r,rect:a,layoutTag:u}}var AW,CW,MW,wW=function(){function t(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this.recomputeWidth=!1,this.recomputeHeight=!1,this._onError=null==e?void 0:e.onError}return t.prototype._layoutInit=function(t,e,i,n){this._chartLayoutRect=i,this._chartViewBox=n,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,this.recomputeWidth=!1,this.recomputeHeight=!1,e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}))},t.prototype._layoutNormalItems=function(t,e){this.layoutNormalInlineItems(t.filter((function(t){return"normal-inline"===t.layoutType})),e),this.layoutNormalItems(t.filter((function(t){return"normal"===t.layoutType})),e)},t.prototype._groupItems=function(t){var e=t.filter((function(t){return"region"===t.layoutType})),i=t.filter((function(t){return"region-relative"===t.layoutType})),n=t.filter((function(t){return"region-relative-overlap"===t.layoutType})),r=i.concat(n),a={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return n.forEach((function(t){a[t.layoutOrient].items.push(t)})),{regionItems:e,relativeItems:i,relativeOverlapItems:n,allRelatives:r,overlapItems:a}},t.prototype.layoutItems=function(t,e,i,n){var r,a,o;this._layoutInit(t,e,i,n);var s={recomputeWidth:this.recomputeWidth,recomputeHeight:this.recomputeHeight},l=null!==(o=null===(a=null===(r=null==t?void 0:t.getSpec())||void 0===r?void 0:r.layout)||void 0===a?void 0:a.secondLayoutLeftRight)&&void 0!==o&&o;this._layoutNormalItems(e,s);var u={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},c=this._groupItems(e),h=c.regionItems,d=c.relativeItems,p=c.relativeOverlapItems,f=c.allRelatives,v=c.overlapItems;this.layoutRegionItems(h,d,p,v,s,l),this._processAutoIndent(h,d,p,v,f,u,s,l),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType}))),e.forEach((function(t){t.clearWillLayoutTag()}))},t.prototype._processAutoIndent=function(t,e,i,n,r,a,o,s){if(void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}),void 0===s&&(s=!1),r.some((function(t){return t.autoIndent}))){var l=this._checkAutoIndent(r,a),u=l.top,c=l.bottom,h=l.left,d=l.right;(u||c||h||d)&&(this.topCurrent=a.top+u,this.bottomCurrent=a.bottom-c,this.leftCurrent=a.left+h,this.rightCurrent=a.right-d,this.layoutRegionItems(t,e,i,n,o,s))}},t.prototype.layoutNormalItems=function(t,e){var i=this;t.forEach((function(t){var n=SW(t,i,e).rect;"left"===t.layoutOrient?(t.setLayoutStartPosition({x:i.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:i.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),i.leftCurrent+=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:i.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:i.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),i.topCurrent+=n.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:i.rightCurrent+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:i.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),i.rightCurrent-=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:i.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:i.bottomCurrent+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),i.bottomCurrent-=n.height+t.layoutPaddingTop+t.layoutPaddingBottom)}))},t.prototype.layoutNormalInlineItems=function(t,e){var i=t.filter((function(t){return"left"===t.layoutOrient})),n=t.filter((function(t){return"right"===t.layoutOrient})),r=t.filter((function(t){return"top"===t.layoutOrient})),a=t.filter((function(t){return"bottom"===t.layoutOrient})),o=this._chartLayoutRect.width+this._chartLayoutRect.x,s=this._chartLayoutRect.height+this._chartLayoutRect.y;return i.length&&function(t,e,i,n){var r=gW(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&_W(a,e,i,!1,"left",n),o.length&&_W(o,e,i,!0,"left",n),s.length&&bW(s,e,0,"left",n)}(i,this,s,e),r.length&&function(t,e,i,n){var r=gW(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&xW(a,e,i,!1,"top",n),o.length&&xW(o,e,i,!0,"top",n),s.length&&kW(s,e,0,"top",n)}(r,this,o,e),n.length&&function(t,e,i,n){var r=gW(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&_W(a,e,i,!1,"right",n),o.length&&_W(o,e,i,!0,"right",n),s.length&&bW(s,e,0,"right",n)}(n,this,s,e),a.length&&function(t,e,i,n){var r=gW(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&xW(a,e,i,!1,"bottom",n),o.length&&xW(o,e,i,!0,"bottom",n),s.length&&kW(s,e,0,"bottom",n)}(a,this,o,e),!0},t.prototype._layoutRelativeOverlap=function(t,e,i){var n=this;e.items.forEach((function(t){var r=SW(t,n,i).rect;e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)})),e.items.forEach((function(i){St(i.getLayoutRect(),e.rect)||i.setLayoutRect(e.rect),"left"===t?i.setLayoutStartPosition({x:n.leftCurrent+i.layoutOffsetX}):"right"===t?i.setLayoutStartPosition({x:n.rightCurrent-e.rect.width+i.layoutOffsetX}):"top"===t?i.setLayoutStartPosition({x:n.topCurrent+i.layoutOffsetY}):i.setLayoutStartPosition({x:n.bottomCurrent-e.rect.height+i.layoutOffsetY})})),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height},t.prototype._layoutRelativeItem=function(t,e){var i=SW(t,this,e,!1).rect;"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))},t.prototype._layoutRegionItem=function(t,e,i){var n=this,r=Math.max(Math.min.apply(Math,P([e],B(t.map((function(t){var e;return null!==(e=t.maxWidth)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0),a=Math.max(Math.min.apply(Math,P([i],B(t.map((function(t){var e;return null!==(e=t.maxHeight)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0);return t.forEach((function(t){var e=r-t.layoutPaddingLeft-t.layoutPaddingRight,i=a-t.layoutPaddingTop-t.layoutPaddingBottom;t.setLayoutRect({width:e,height:i}),t.setLayoutStartPosition({x:n.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:n.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})})),{regionHeight:a,regionWidth:r}},t.prototype.layoutRegionItems=function(t,e,i,n,r,a){var o=this;void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}),void 0===a&&(a=!1);var s=this.leftCurrent,l=this.rightCurrent,u=this.rightCurrent-this.leftCurrent,c=(this.bottomCurrent,this.topCurrent);e.filter((function(t){return"left"===t.layoutOrient||"right"===t.layoutOrient})).forEach((function(t){o._layoutRelativeItem(t,r)})),this._layoutRelativeOverlap("left",n.left,r),this._layoutRelativeOverlap("right",n.right,r),u=this.rightCurrent-this.leftCurrent,e.filter((function(t){return"top"===t.layoutOrient||"bottom"===t.layoutOrient})).forEach((function(t){o._layoutRelativeItem(t,r)})),this._layoutRelativeOverlap("top",n.top,r),this._layoutRelativeOverlap("bottom",n.bottom,r),c=this.bottomCurrent-this.topCurrent,a&&(this.leftCurrent=s,this.rightCurrent=l,e.filter((function(t){return"left"===t.layoutOrient||"right"===t.layoutOrient})).forEach((function(t){o._layoutRelativeItem(t,r)})),u=this.rightCurrent-this.leftCurrent);var h=this._layoutRegionItem(t,u,c),d=h.regionWidth,p=h.regionHeight;e.concat(i).forEach((function(e){if(["left","right"].includes(e.layoutOrient)){var i=o.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+d-u})}else if(["top","bottom"].includes(e.layoutOrient)){i=o.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+p-c})}}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.willLayoutTag&&t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.filterRegionsWithID=function(t,e){var i,n=t.find((function(t){return t.getModelId()===e}));return n||(null!==(i=this._onError)&&void 0!==i?i:UA)("can not find target region item, invalid id"),n},t.prototype.getItemComputeLayoutRect=function(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype._checkAutoIndent=function(t,e){var i=this,n={top:0,left:0,bottom:0,right:0};return t.forEach((function(t){if(t.getModelVisible()&&t.autoIndent){var r="left"===t.layoutOrient||"right"===t.layoutOrient,a=t.getLastComputeOutBounds(),o=i._getOutInLayout(a,t,e);r?(n.top=Math.max(n.top,o.top),n.bottom=Math.max(n.bottom,o.bottom)):(n.left=Math.max(n.left,o.left),n.right=Math.max(n.right,o.right))}})),n},t.prototype._getOutInLayout=function(t,e,i){var n=e.getLayoutStartPoint(),r=n.x,a=n.y,o=e.getLayoutRect(),s=o.width,l=o.height;return{left:i.left-(r-t.x1),right:r+s+t.x2-i.right,top:i.top-(a-t.y1),bottom:a+l+t.y2-i.bottom}},t.type="base",t}();!function(t){t.enter="enter",t.update="update",t.exit="exit",t.unChange="unChange"}(AW||(AW={})),t.STATE_VALUE_ENUM=void 0,(CW=t.STATE_VALUE_ENUM||(t.STATE_VALUE_ENUM={})).STATE_NORMAL="normal",CW.STATE_HOVER="hover",CW.STATE_HOVER_REVERSE="hover_reverse",CW.STATE_DIMENSION_HOVER="dimension_hover",CW.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",CW.STATE_SELECTED="selected",CW.STATE_SELECTED_REVERSE="selected_reverse",CW.STATE_SANKEY_EMPHASIS="selected",CW.STATE_SANKEY_EMPHASIS_REVERSE="blur",CW.STATE_HIGHLIGHT="highlight",CW.STATE_BLUR="blur",CW.STATE_ACTIVE="active",function(t){t.STATE_HOVER_REVERSE="hover_reverse",t.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",t.STATE_SELECTED_REVERSE="selected_reverse"}(MW||(MW={}));var TW,DW=["linear","radial","conical"],EW={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}};var BW={};Object.values(t.STATE_VALUE_ENUM).forEach((function(t){BW[t]=!0})),(TW={})[t.STATE_VALUE_ENUM.STATE_HOVER]=t.STATE_VALUE_ENUM.STATE_HOVER_REVERSE,TW[t.STATE_VALUE_ENUM.STATE_SELECTED]=t.STATE_VALUE_ENUM.STATE_SELECTED_REVERSE,TW[t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER]=t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE;var PW,RW=function(t){function e(e,i){var n=t.call(this,e)||this;return n._stateInfoList=[],n._mark=i,n}return C(e,t),e.prototype.getStateInfoList=function(){return this._stateInfoList},e.prototype._getDefaultStateMap=function(){return{markUpdateRank:1}},e.prototype.getStateInfo=function(t){return this._stateInfoList.find((function(e){return e.stateValue===t}))},e.prototype.addStateInfo=function(t){if(!this.getStateInfo(t.stateValue)){t.level=t.level||0;for(var e=!0,i=0;i<this._stateInfoList.length;i++){var n=this._stateInfoList[i].level;if(n&&n>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}},e.prototype._clearStateBeforeSet=function(t){t.datums=null,t.items=null,t.fields=null,t.filter=null},e.prototype.changeStateInfo=function(t){var e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(var i in e.fields=e.fields||{},t.fields){var n=t.fields[i];e.fields[i]=e.fields[i]||{};var r=e.fields[i];W(n.domain)&&(r.domain=n.domain),W(n.type)&&(r.type=n.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)},e.prototype.clearStateInfo=function(t){var e=this;t.forEach((function(t){e.getStateInfo(t)&&e.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})}))},e.prototype._isMultiMark=function(){return!this._mark||function(t){return YV.includes(t)}(this._mark.type)},e.prototype.checkOneState=function(t,e,i){var n,r=!1,a=!1;if(W(i.datums)&&i.datums.length>0)r=this.checkDatumState(i,e),a=!0;else if(i.items)r=null!==(n=this.checkItemsState(i,t))&&void 0!==n&&n,a=!0;else if(i.fields)r=this.checkFieldsState(i,e,t),a=!0;else if(!r&&i.filter){var o={mark:this._mark,renderNode:t,type:this._mark.type};r=i.filter(null==e?void 0:e[0],o),a=!0}return a?r?"in":"out":"skip"},e.prototype.checkState=function(t,e){for(var i,n=(null!==(i=t.context.states)&&void 0!==i?i:[]).filter((function(t){return function(t){return!!BW[t]}(t)})).map((function(t){return[t,10]})),r=0;r<this._stateInfoList.length;r++){var a=this._stateInfoList[r],o=this.checkOneState(t,e,a);"skip"!==o&&("in"===o&&n.push([a.stateValue,a.level]))}return n.map((function(t){return t[0]}))},e.prototype.checkDatumState=function(t,e){var i=!1,n=e[0];if(Z(t.datums)){var r=this._isMultiMark(),a=t.datumKeys||Object.keys(t.datums[0]).filter((function(t){return!t.startsWith(Mj)}));i=t.datums.some((function(t){return r&&Z(null==t?void 0:t.items)?a.every((function(e){var i,r;return(null===(r=null===(i=null==t?void 0:t.items)||void 0===i?void 0:i[0])||void 0===r?void 0:r[e])===(null==n?void 0:n[e])})):a.every((function(e){return(null==t?void 0:t[e])===(null==n?void 0:n[e])}))}))}else if(G(t.datums)){var o=t.datumKeys||Object.keys(t.datums).filter((function(t){return!t.startsWith(Mj)})),s=this._isMultiMark();i=o.every((function(e){var i,r;return s?(null===(i=t.datums.items)||void 0===i?void 0:i[0][e])===n[e]:(null===(r=t.datums)||void 0===r?void 0:r[e])===n[e]}))}else i=e===t.datums;return i},e.prototype.checkItemsState=function(t,e){var i;return null===(i=t.items)||void 0===i?void 0:i.includes(e)},e.prototype.checkFieldsState=function(t,e,i){var n,r=!0,a=function(a){var s=t.fields[a],l=s.type,u=s.domain,c=null===(n=e[0])||void 0===n?void 0:n[a];if(tO(l)&&u.length>1){if(o.checkLinearFieldState(u,a,e,i))return r=!1,"break";r=!0}else{if(!u.some((function(t){return t===c})))return r=!1,"break";r=!0}},o=this;for(var s in t.fields){if("break"===a(s))break}return r},e.prototype.checkLinearFieldState=function(t,e,i,n){var r,a=this._isMultiMark()?null===(r=i[0])||void 0===r?void 0:r[e]:i[e];return a<t[0]||a>t[t.length-1]},e.prototype.release=function(){},e}(function(t){function e(e){var i=t.call(this,e)||this;return i.initStateMap(),i}return C(e,t),e.prototype.compile=function(){},e.prototype.getStateMap=function(){return this._stateMap},e.prototype._getDefaultStateMap=function(){return{}},e.prototype.initStateMap=function(t){this._stateMap=null!=t?t:this._getDefaultStateMap()},e.prototype.updateState=function(t,e){if(t&&(mt(this._stateMap,t),!e))return this.getCompiler().renderNextTick()},e}(uW)),LW=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=qA(),e._compiledProductId=null,e}return C(e,t),e.prototype.getProductId=function(){var t;return null!==(t=this._compiledProductId)&&void 0!==t?t:this.generateProductId()},e.prototype.compile=function(t){this._compileProduct(t)},e.prototype.setTransform=function(t){this._transform=t},e.prototype.runTransforms=function(t,e){if(!t||!t.length)return e;var i=e;return t.forEach((function(t){var e;i=null===(e=ij.getGrammarTransform(t.type))||void 0===e?void 0:e.transform(t,i)})),i},e}(uW),IW=function(t){function e(e,i){var n=t.call(this,e)||this;return n._data=null,n._data=i,n}return C(e,t),e.prototype.getProduct=function(){return this._product||(this._product=this.runTransforms(this._transform,this.getLatestData())),this._product},e.prototype.getDataView=function(){return this._data},e.prototype.setDataView=function(t){this._data=t},e.prototype.getLatestData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.latestData},e.prototype.removeProduct=function(){this._product=null,this._prevProduct=null,this._compiledProductId=null},e.prototype.release=function(){this.removeProduct(),t.prototype.release.call(this),this._data=null},e.prototype.addRelatedMark=function(t){this._relatedMarks||(this._relatedMarks={}),this._relatedMarks[t.id]=t},e.prototype.updateData=function(t){var e=this;if(this._compileProduct(),this._relatedMarks){var i=!1;if(Object.keys(this._relatedMarks).forEach((function(t){e._relatedMarks[t]&&(i=!0,e._relatedMarks[t].commit())})),!t&&i)return this.getCompiler().renderNextTick()}},e.prototype._compileProduct=function(){this._prevProduct=this._product,this._product=null},e.prototype.generateProductId=function(){var t;return"".concat(null===(t=this.getDataView())||void 0===t?void 0:t.name)},e}(LW),FW=function(t,e,i,n){return"function"==typeof t?t(e,i,n):t},OW=function(t,e,i,n,r){var a,o={prev:t.map((function(t){var e,i;return null===(i=null===(e=t.context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]})),next:e.map((function(t){var e,i;return null===(i=null===(e=t.context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]}))},s={prev:t.slice(),next:e.slice()},l=null!==(a=i.animation)&&void 0!==a?a:{},u=l.easing,c=FW(l.delay,r,o,s),h=FW(l.duration,r,o,s),d=FW(l.oneByOne,r,o,s),p=FW(l.splitPath,r,o,s),f=it(d)&&d>0?function(t){return $(d)?t*d:!0===d?t*h:0}:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?function(t,e,i){var n,r=e.filter((function(t){return t&&t.toCustomPath&&t.valid}));r.length||__DEV__&&console.error(r," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");var a=("clone"===(null==i?void 0:i.splitPath)?aI:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:oI)(t,r.length,!1),o=null==i?void 0:i.onEnd,s=r.length,l=function(){0==--s&&o&&o()};r.forEach((function(e,n){var o,s=a[n],u=(null!==(o=null==i?void 0:i.delay)&&void 0!==o?o:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(n,r.length,s,e):0);eI(s,e,Object.assign({},i,{onEnd:l,delay:u}),t.globalTransMatrix)}))}(t[0],e,{delay:c,duration:h,easing:u,onEnd:n,individualDelay:f,splitPath:p}):t.length>1&&1===e.length&&function(t,e,i){var n,r,a,o=t.filter((function(t){return t.toCustomPath&&t.valid}));o.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");var s=("clone"===(null==i?void 0:i.splitPath)?aI:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:oI)(e,o.length,!0),l=e.attribute;e.setAttribute("visible",!1);var u=o.map((function(t,e){return JL(t.toCustomPath(),s[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:s[e].globalTransMatrix})})),c=o.map((function(t,e){return $L(t.attribute,l)}));if(null==i?void 0:i.individualDelay){var h=i.onEnd,d=o.length,p=function(){0==--d&&(e.setAttributes({visible:!0,ratio:null},!1,{type:Sh.ANIMATE_END}),e.detachShadow(),h&&h())};s.forEach((function(e,n){var r,a,s,l=(null!==(r=i.delay)&&void 0!==r?r:0)+i.individualDelay(n,o.length,t[n],e),h=e.animate(Object.assign({},i,{onEnd:p}));h.wait(l),h.play(new tI({morphingData:u[n],saveOnEnd:!0,otherAttrs:c[n]},null!==(a=i.duration)&&void 0!==a?a:YL,null!==(s=i.easing)&&void 0!==s?s:XL))}))}else{var f=null==i?void 0:i.onEnd,v=i?Object.assign({},i):{};v.onEnd=function(){e.setAttribute("visible",!0,!1,{type:Sh.ANIMATE_END}),e.detachShadow(),f&&f()};var g=e.animate(v);(null==i?void 0:i.delay)&&g.wait(i.delay),g.play(new iI({morphingData:u,otherAttrs:c},null!==(r=null==i?void 0:i.duration)&&void 0!==r?r:YL,null!==(a=null==i?void 0:i.easing)&&void 0!==a?a:XL))}}(t,e[0],{delay:c,duration:h,easing:u,onEnd:n,individualDelay:f,splitPath:p}):eI(t[0],e[0],{delay:c,duration:h,easing:u,onEnd:n})},zW=function(t,e){var i=Math.floor(t.length/e);return new Array(e).fill(0).map((function(n,r){return t.slice(i*r,r===e-1?t.length:i*(r+1))}))},HW=function(t){var e=t.getMarkConfig();W(e.morphElementKey)&&t.getGraphics().forEach((function(t){var i,n,r=null===(n=null===(i=t.context)||void 0===i?void 0:i.data)||void 0===n?void 0:n[0];r&&(t.context.morphKey=r[e.morphElementKey])}))},NW=function(e){function i(i,n){var r,a=this;return(a=e.call(this,n)||this).type=void 0,a.name="mark",a._markConfig={zIndex:t.LayoutZIndex.Mark,morph:!1},a._visible=!0,a.stateStyle={},a._unCompileChannel={},a._disabledAnimationStates=[],a._skipBeforeLayouted=!1,a._extensionChannel={},a._computeExChannel={},a._graphicMap=new Map,a._graphics=[],a._getEncoderOfStyle=function(t,e){if(e&&t){var i={};return Object.keys(e).forEach((function(e){a._unCompileChannel[e]||(i[e]=a._computeAttribute(e,t))})),i}return null},a._setGraphicFromMarkConfig=function(t){var e=a._markConfig,i=e.setCustomizedShape,n=e.graphicName;i&&(t.pathProxy=function(e){return i(t.context.data,e,new Md)}),n&&(U(n)?t.name=n(t):t.name=n)},a._setStateOfGraphic=function(t,e){t.clearStates(),t.stateProxy=null,t.context.diffState!==AW.enter&&t.context.diffState!==AW.update||(t.stateProxy=function(e,i){var n;return a._runEncoderOfGraphic(null===(n=a._encoderOfState)||void 0===n?void 0:n[e],t)},t.context.states&&t.useStates(t.context.states,e))},a.name=i,a.model=n.model,a.key=n.key,a.state=new RW(n,a),a._attributeContext=n.attributeContext,null===(r=n.map)||void 0===r||r.set(a.id,a),a}return C(i,e),i.prototype.commit=function(t,e){e&&this.getMarks().length>0&&this.getMarks().forEach((function(t){return t.commit(!1,e)})),this._isCommited=!0,t&&this.getCompiler().renderNextTick()},i.prototype.uncommit=function(){this._isCommited=!1},i.prototype.isCommited=function(){return this._isCommited},i.prototype.getMarkConfig=function(){return this._markConfig},i.prototype.setMarkConfig=function(t){var e=this;Object.keys(t).forEach((function(i){e._markConfig[i]=t[i]}))},i.prototype.getVisible=function(){return this._visible},i.prototype.setVisible=function(t){this._visible=t},i.prototype.getUserId=function(){return this._userId},i.prototype.setUserId=function(t){W(t)&&(this._userId=t)},i.prototype.getDataView=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.setDataView=function(t){j(this._data)&&this.initMarkData(this._option),this._data.setDataView(t)},i.prototype.getData=function(){return this._data},i.prototype.setData=function(t){this._data=t,t&&t.addRelatedMark(this)},i.prototype.hasState=function(t){return t in this.state.getStateMap()},i.prototype.getState=function(t){return this.state.getStateMap()[t]},i.prototype.getAnimationConfig=function(){return this._animationConfig},i.prototype.setAnimationConfig=function(t){var e="group"===this.type?{selfOnly:!0}:{},i=function(t){var i,n=null!==(i=t.options)&&void 0!==i?i:{};return M(M(M({},e),t),{options:function(t,e,i){var r,a,o="function"==typeof n?n(t,e,i):n;if(e&&e.context&&e.context.compiler&&W(e.context.modelId)){var s=null===(r=e.context.compiler.getChart())||void 0===r?void 0:r.getModelById(e.context.modelId);return M(M({},o),{layoutRect:null===(a=null==s?void 0:s.getLayoutRect)||void 0===a?void 0:a.call(s)})}return M({},o)}})},n={};Object.keys(t).forEach((function(e){var r=t[e];Z(r)?n[e]=r.map(i):W(r)&&(n[e]=i(r))})),this._animationConfig=n},i.prototype.disableAnimationByState=function(t){var e=Dt(t);this._disabledAnimationStates=P([],B(new Set(P(P([],B(this._disabledAnimationStates),!1),B(e),!1))),!1)},i.prototype.enableAnimationByState=function(t){var e=Dt(t);this._disabledAnimationStates=this._disabledAnimationStates.filter((function(t){return!e.includes(t)}))},i.prototype.setSkipBeforeLayouted=function(t){this._skipBeforeLayouted=t},i.prototype.setGroupKey=function(t){this._groupKey=t},i.prototype.getProduct=function(){return this._product},i.prototype.initMarkData=function(t){this._data=new IW(t),this._data.addRelatedMark(this)},i.prototype._compileProduct=function(t){this.commit(),this._context=null==t?void 0:t.context;var e=this.getProduct();if(this._visible){if(W(e))t.group&&e.parent!==t.group&&t.group.appendChild(e);else{if(!this.getCompiler().isInited)return;this._initProduct(null==t?void 0:t.group)}j(this._product)||(this.compileData(),this.compileState(),this.compileEncode())}else W(e)&&this.removeProduct()},i.prototype._initProduct=function(t){var e;if(this.getStage()){var i=this.getProductId();this._product=Vy("group"!==this.type?{pickable:!1,zIndex:this._markConfig.zIndex,overflow:this._markConfig.overflow}:{}),this._product.name=i,this._product.mark=this,(null!=t?t:null===(e=this.getCompiler())||void 0===e?void 0:e.getRootGroup()).appendChild(this._product),this._compiledProductId=i}},i.prototype.generateProductId=function(){return this._userId?"".concat(this._userId):"".concat(this.name,"_").concat(this.id)},i.prototype.layout=function(t){},i.prototype.compileData=function(){j(this._data)||this._data.compile()},i.prototype.compileEncode=function(){},i.prototype.compileState=function(){},i.prototype.compileAnimation=function(){},i.prototype.compileContext=function(t){this._context=M({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},t)},i.prototype.getContext=function(){return this._context},i.prototype.compileTransform=function(){},i.prototype.updateState=function(t,e){return this.commit(),this.state.updateState(t,e)},i.prototype.getMarks=function(){return[]},i.prototype.runAnimationByState=function(t){},i.prototype.stopAnimationByState=function(t){},i.prototype.pauseAnimationByState=function(t){},i.prototype.resumeAnimationByState=function(t){},i.prototype.removeProduct=function(){this._product&&this._product.parent&&this._product.parent.removeChild(this._product),this._product=null,this._compiledProductId=null},i.prototype.release=function(){this.state.release(),e.prototype.release.call(this),this._lastMark=null},i.prototype.setSimpleStyle=function(t){this._simpleStyle=t},i.prototype.getSimpleStyle=function(){return this._simpleStyle},i.prototype.created=function(){this._initStyle()},i.prototype.initStyleWithSpec=function(t){t&&(W(t.id)&&(this._userId=t.id),N(t.interactive)&&(this._markConfig.interactive=t.interactive),W(t.zIndex)&&(this._markConfig.zIndex=t.zIndex),N(t.visible)&&this.setVisible(t.visible),this._markConfig.setCustomizedShape=t.customShape,this._stateSort=t.stateSort,this._initSpecStyle(t))},i.prototype._transformStyleValue=function(t,e){if(t.scale){var i=t.scale,n=i.range();return i.range(n.map(e)),t}return"function"==typeof t?function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return e(t.apply(void 0,P([],B(i),!1)))}:e(t)},i.prototype.convertAngleToRadian=function(t){return this._transformStyleValue(t,Ci)},i.prototype.isUserLevel=function(e){return[t.AttributeLevel.User_Mark,t.AttributeLevel.User_Series,t.AttributeLevel.User_Chart,t.AttributeLevel.User_SeriesStyle].includes(e)},i.prototype.setStyle=function(t,e,i){var n=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),!j(t)){void 0===this.stateStyle[e]&&(this.stateStyle[e]={});var r=this.isUserLevel(i);Object.keys(t).forEach((function(a){var o=t[a];j(o)||(o=n._filterAttribute(a,o,e,i,r),n.setAttribute(a,o,e,i))}))}},i.prototype.getStyle=function(t,e){var i;return void 0===e&&(e="normal"),null===(i=this.stateStyle[e][t])||void 0===i?void 0:i.style},i.prototype._filterAttribute=function(t,e,i,n,r){var a=this,o=this._styleConvert(e);if(r)switch(t){case"angle":o=this.convertAngleToRadian(o);break;case"innerPadding":case"outerPadding":o=this._transformStyleValue(o,(function(t){return-t}));break;case"curveType":o=this._transformStyleValue(o,(function(t){return function(t,e){return"monotone"===t?"horizontal"===e?"monotoneY":"monotoneX":t}(t,a._option.model.direction)}))}return o},i.prototype.setReferer=function(t,e,i){var n,r,a=this;if(t)if(e&&i){var o=null!==(r=this.stateStyle[i])&&void 0!==r?r:((n={})[e]={},n);this.stateStyle[i][e]=M(M({},o[e]),{referer:t})}else Object.entries(this.stateStyle).forEach((function(e){var i=B(e,2),n=i[0],r=i[1];Object.entries(r).forEach((function(e){var i=B(e,2),r=i[0];i[1],a.stateStyle[n][r].referer=t}))}))},i.prototype.setPostProcess=function(t,e,i){var n;void 0===i&&(i="normal"),(null===(n=this.stateStyle[i])||void 0===n?void 0:n[t])&&(this.stateStyle[i][t].postProcess=e)},i.prototype.getAttribute=function(t,e,i){return void 0===i&&(i="normal"),this._computeAttribute(t,i)(e)},i.prototype.getAttributesOfState=function(t,e){var i=this;void 0===e&&(e="normal");var n=this.stateStyle[e];if(n){var r={};return Object.keys(n).forEach((function(n){i._unCompileChannel[n]||(r[n]=i._computeAttribute(n,e)(t))})),r}},i.prototype.setAttribute=function(t,e,i,n){var r,a=this;void 0===i&&(i="normal"),void 0===n&&(n=0),void 0===this.stateStyle[i]&&(this.stateStyle[i]={}),void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]={level:n,style:e,referer:void 0});var o=null===(r=this.stateStyle[i][t])||void 0===r?void 0:r.level;W(o)&&o<=n&&ej(this.stateStyle[i][t],{style:e,level:n}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach((function(t){void 0===a.stateStyle[i][t]&&(a.stateStyle[i][t]=a.stateStyle.normal[t])}))},i.prototype._getDefaultStyle=function(){return{visible:!0,x:0,y:0}},i.prototype._styleConvert=function(t){if(!t)return t;if(eO(t.type)||t.scale){var e=PU(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t},i.prototype._computeAttribute=function(t,e){var i,n=this,r=null===(i=this.stateStyle[e])||void 0===i?void 0:i[t];r||(r=this.stateStyle.normal[t]);var a=this._computeStateAttribute(r,t,e),o=U(null==r?void 0:r.postProcess),s=t in this._computeExChannel;if(o&&s){var l=this._computeExChannel[t];return function(i){var o=a(i);return o=r.postProcess(o,i,n._attributeContext,n.getDataView()),l(t,i,e,o)}}if(o)return function(t){return r.postProcess(a(t),t,n._attributeContext,n.getDataView())};if(s){var u=this._computeExChannel[t];return function(i){return u(t,i,e,a(i))}}return a},i.prototype._computeStateAttribute=function(t,e,i){var n,r=this;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?function(e){return t.style(e,r._attributeContext,{mark:r},r.getDataView())}:DW.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):eO(null===(n=t.style.scale)||void 0===n?void 0:n.type)?function(e){var i=e;return"series"===r.model.modelType&&r.model.getMarkData&&(i=r.model.getMarkData(e)),t.style.scale.scale(i[t.style.field])}:function(e){return t.style}:function(e){return t.style}:function(t){}},i.prototype._initStyle=function(){var t=this._getDefaultStyle();this.setStyle(t,"normal",0)},i.prototype._initSpecStyle=function(e){var i=this;e.style&&this.setStyle(e.style,"normal",t.AttributeLevel.User_Mark);var n=e.state;n&&Object.keys(n).forEach((function(e){var r=n[e];if("style"in r){var a=r.style,o={stateValue:e};"level"in r&&(o.level=r.level),"filter"in r&&(o=U(r.filter)?M({filter:r.filter},o):M(M({},r.filter),o)),i.state.addStateInfo(o),i.setStyle(a,e,t.AttributeLevel.User_Mark)}else i.setStyle(r,e,t.AttributeLevel.User_Mark)}))},i.prototype._computeGradientAttr=function(t){var e,i,n=this,r=t.gradient,a=t.scale,o=t.field,s=w(t,["gradient","scale","field"]),l=a,u=o;if(!(a&&o||"series"!==this.model.modelType)){var c=this.model.getColorAttribute(),h=c.scale,d=c.field;a||(l=h),u||(u=d)}var p=kU(xU(this.model.getColorScheme(),"series"===this.model.modelType?null===(i=(e=this.model).getSpec)||void 0===i?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),f=M(M({},EW[r]),s);return function(t){var e={},i=n.getDataView();return Object.keys(f).forEach((function(r){var a=f[r];"stops"===r?e.stops=a.map((function(e){var r=e.opacity,a=e.color,o=e.offset,s=null!=a?a:null==l?void 0:l.scale(t[u]);return U(a)&&(s=a(t,n._attributeContext,i)),W(r)&&(s=Qn.SetOpacity(s,r)),{offset:U(o)?o(t,n._attributeContext,i):o,color:s||p[0]}})):U(a)?e[r]=a(t,n._attributeContext,i):e[r]=a})),e.gradient=r,e}},i.prototype._computeBorderAttr=function(t){var e=this,i=t.scale,n=t.field,r=w(t,["scale","field"]);return function(t){var a,o,s,l={};if(Object.keys(r).forEach((function(i){var n=r[i];U(n)?l[i]=n(t,e._attributeContext,e.getDataView()):l[i]=n})),"stroke"in l)DW.includes(null===(s=r.stroke)||void 0===s?void 0:s.gradient)&&(l.stroke=e._computeGradientAttr(r.stroke)(t));else{var u=kU(xU(e.model.getColorScheme(),"series"===e.model.modelType?null===(o=(a=e.model).getSpec)||void 0===o?void 0:o.call(a):void 0),e.model.getDefaultColorDomain()),c=i,h=n;if(!(i&&n||"series"!==e.model.modelType)){var d=e.model.getColorAttribute(),p=d.scale,f=d.field;i||(c=p),h||(h=f),l.stroke=(null==c?void 0:c.scale(t[h]))||u[0]}}return l}},i.prototype._getDataByKey=function(t){var e=this;return XV(t,(function(t,i){var n;return"".concat(e._groupKeyGetter(t),"_").concat(null!==(n=e._keyGetter(t))&&void 0!==n?n:i)}))},i.prototype._getCommonContext=function(){return{compiler:this.getCompiler(),markType:this.type,markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId}},i.prototype.prepareMorph=function(t){this._lastMark=t},i.prototype.reuse=function(t){var e=this;this.type===t.type&&(this._product=t.getProduct(),this._graphics=t.getGraphics(),this._graphicMap=t._graphicMap,this._graphicMap.forEach((function(t){t.context=M(M({},t.context),e._getCommonContext())})),this._dataByKey=t._dataByKey,this._prevDataByKey=t._prevDataByKey,this.needClear=t.needClear)},i.prototype._parseProgressiveContext=function(t){var e=this,i=this._markConfig.progressiveStep>0&&this._markConfig.progressiveThreshold>0&&this._markConfig.progressiveStep<this._markConfig.progressiveThreshold,n=this._markConfig.large&&this._markConfig.largeThreshold>0&&t.length>=this._markConfig.largeThreshold;if(i){var r=this._dataByGroup;return r&&r.keys&&r.keys.some((function(t){return r.data.get(t).length>e._markConfig.progressiveThreshold}))?{large:n,progressive:{data:t,step:this._markConfig.progressiveStep,currentIndex:0,totalStep:r.keys.reduce((function(t,i){return Math.max(Math.ceil(r.data.get(i).length/e._markConfig.progressiveStep),t)}),1),groupedData:r.data}}:{large:n}}return{large:n}},i.prototype.getGraphics=function(){return this._graphics},i.prototype._createGraphic=function(t){return void 0===t&&(t={}),ij.createGraphicComponent(this.type,t)},i.prototype._runGroupData=function(t){var e=this;this._keyGetter=U(this.key)?this.key:W(this.key)?function(t){return null==t?void 0:t[e.key]}:function(t){return null==t?void 0:t[Bj]},this._groupKeyGetter=W(this._groupKey)?function(t){return"".concat(null==t?void 0:t[e._groupKey])}:function(){return"key"},this._dataByGroup=XV(t,this._groupKeyGetter)},i.prototype.getAnimationState=function(){var t=this._graphics.map((function(t){return t.context.animationState})),e=t.every((function(t){return t===HV.appear}))?HV.appear:t.every((function(t){return t===HV.disappear}))?HV.disappear:t[0];return null!=e?e:HV.none},i.prototype.createAnimationStateList=function(t,e){var i,n=e[t];return n&&Array.isArray(n)&&(n=1===n.length?n[0]:n),Array.isArray(n)?n.map((function(t,e){var i;return M(M({},t),{priority:null!==(i=t.priority)&&void 0!==i?i:1/0})})):n?M(M({},n),{priority:"normal"===t?null!==(i=n.priority)&&void 0!==i?i:1/0:n.priority}):n},i.prototype.tryRunMorphing=function(t){if(this._lastMark){t.forEach((function(t){"appear"!==t.context.animationState&&"enter"!==t.context.animationState||t.setAttributes(t.getAttributes(!0))}));var e=function(t,e,i){void 0===i&&(i={});var n=[],r=[];t.forEach((function(t){HW(t),n.push.apply(n,P([],B(t.getGraphics()),!1))})),e.forEach((function(t){HW(t),r.push.apply(r,P([],B(t.getGraphics()),!1))}));var a=function(t){var e,i,n;return null!==(i=null===(e=t.context)||void 0===e?void 0:e.morphKey)&&void 0!==i?i:null===(n=t.context)||void 0===n?void 0:n.key},o=new Map,s=new Map;if(n.forEach((function(t){var e=a(t);e&&(o.has(e)||o.set(e,[]),o.get(e).push(t))})),r.forEach((function(t){var e=a(t);e&&(s.has(e)||s.set(e,[]),s.get(e).push(t))})),o.size!==s.size||!Array.from(o.keys()).every((function(t){return s.has(t)})))return!1;var l=P([],B(new Set(P([],B(o.keys()),!1).filter((function(t){return s.has(t)})))),!1),u=P([],B(s.keys()),!1).filter((function(t){return!o.has(t)})),c=0,h=function(){0==(c-=1)&&e.forEach((function(t){}))};return u.forEach((function(t){var e=s.get(t);OW([],e,i,h,{}),c+=1})),l.forEach((function(t){var e=o.get(t),n=s.get(t),r=Math.min(e.length,n.length);if(r>0)for(var a=zW(e,r),l=zW(n,r),u=0;u<r;u++)OW(a[u],l[u],i,h,{}),c+=1})),0===c&&h(),!0}([this._lastMark],[this],{});return this._lastMark=null,e}return!1},i.prototype._runStateAnimation=function(t){var e,i;if(this._animationConfig&&0!==t.length&&!this.tryRunMorphing(t)){var n=this.getAnimationConfig();if(null!==(e=this._markConfig.useSequentialAnimation)&&void 0!==e&&e&&this._runSequentialAnimations)this._runSequentialAnimations(t);else{var r=t.every((function(t){return"appear"===t.context.animationState})),a=this.createAnimationStateList("appear",n);if(r&&this._product){var o=a?["appear"]:[],s=a?[{name:"appear",animation:a}]:[];if(n.normal){o.push("normal");var l={name:"normal",animation:this.createAnimationStateList("normal",n)};s.push(l)}this._product.applyAnimationState(o,s)}var u=!1;if(t.forEach((function(t){var e=t.context.animationState;if("appear"!==e){var i=n[e];if(i&&i.length>0){var r=i.map((function(t,i){return{name:"".concat(e,"_").concat(i),animation:t}}));r.forEach((function(e){e.animation.customParameters=t.context}));var a=[e];t.applyAnimationState(a,[1===r.length?r[0]:r])}"enter"===e&&n.normal&&(u=!0)}})),u&&this._product&&(null===(i=n.normal)||void 0===i?void 0:i.length)){this._product.stopAnimationState("normal","start");l={name:"normal",animation:this.createAnimationStateList("normal",n)};this._product.applyAnimationState(["normal"],[l])}}}},i.prototype._setAnimationState=function(t){var e,i,n,r=("component"===this.type?this.model.getAnimationStateCallback():null===(n=null===(i=(e=this.model).getRegion)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.getAnimationStateCallback())||function(t){var e,i=null===(e=t.context)||void 0===e?void 0:e.diffState;return i===HV.exit?HV.exit:i===HV.update?HV.update:HV.appear},a=r(t);t.context.animationState=null!=a?a:t.context.diffState,t.context.animationState===AW.exit&&(t.context.reusing=!0,t.animates&&t.animates.forEach((function(t){return t.stop()})))},i.prototype._runJoin=function(t){var e=this,i=this._getDataByKey(t),n=this._prevDataByKey,r=[],a=new Set(this._graphics.filter((function(t){return t.context.diffState===AW.enter}))),o=function(t,i,n){var o,s,l,u,c,h,d,p,f,v,g;return j(i)?(v=e._graphicMap.get(t))&&(g=AW.exit):j(n)?(v=e._graphicMap.has(t)?e._graphicMap.get(t):{},g=AW.enter,v.isExiting=!1,e._graphicMap.set(t,v),r.push(v)):(v=e._graphicMap.get(t))&&(g=AW.update,r.push(v)),v&&(a.delete(v),v.context=M(M({},e._getCommonContext()),{diffState:g,reusing:null===(o=v.context)||void 0===o?void 0:o.reusing,originalFieldX:null===(s=v.context)||void 0===s?void 0:s.originalFieldX,originalFieldY:null===(l=v.context)||void 0===l?void 0:l.originalFieldY,fieldX:null===(u=v.context)||void 0===u?void 0:u.fieldX,fieldY:null===(c=v.context)||void 0===c?void 0:c.fieldY,data:null!=i?i:null===(h=v.context)||void 0===h?void 0:h.data,uniqueKey:t,key:i?e._keyGetter(i[0]):null===(d=v.context)||void 0===d?void 0:d.key,groupKey:i?e._groupKeyGetter(i[0]):null===(p=v.context)||void 0===p?void 0:p.groupKey,indexKey:"__VCHART_DEFAULT_DATA_INDEX",stateAnimateConfig:null===(f=e.getAnimationConfig())||void 0===f?void 0:f.state}),e._setAnimationState(v)),v};if(n&&i){var s=new Map(n.data);i.keys.forEach((function(t){o(t,i.data.get(t),s.get(t)),s.delete(t)})),n.keys.forEach((function(t){s.has(t)&&o(t,null,s.get(t))}))}else i?i.keys.forEach((function(t){var e=o(t,i.data.get(t),null);e&&(e.context.animationState=HV.appear)})):n&&n.keys.forEach((function(t){o(t,null,n.data.get(t)).context.animationState=HV.disappear}));a.forEach((function(t){e._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release()}));var l=r.length;r.forEach((function(t,e){t.context.graphicCount=l,t.context.graphicIndex=e})),this._dataByKey=i,this._graphics=r,this.needClear=!0},i.prototype._runEncoderOfGraphic=function(t,e,i){return void 0===i&&(i={}),KV(t,e.context.data[0],i)},i.prototype._runGroupEncoder=function(t){var e=this;if(!this._dataByGroup)return null;var i={};return this._dataByGroup.keys.forEach((function(n){i[n]=KV(t,e._dataByGroup.data.get(n)[0])})),this._attrsByGroup=i,i},i.prototype._transformGraphicAttributes=function(t,e,i){return M(M({},i),e)},i.prototype._separateNormalStyle=function(t){var e=this,i={},n={};return Object.keys(t).forEach((function(r){e._unCompileChannel[r]||(e._option.noSeparateStyle||function(t,e,i){var n,r=null===(n=e[t])||void 0===n?void 0:n.style,a=function(t,e){return("fill"===t||"stroke"===t)&&(null==e?void 0:e.gradient)&&(null==e?void 0:e.stops)}(t,r);return!!a||!!U(r)||!(!(null==r?void 0:r.scale)||r.field===i)}(r,t,e._groupKey)?i[r]=t[r]:n[r]=t[r])})),{updateStyles:i,groupStyles:n}},i.prototype._addProgressiveGraphic=function(t,e){t.incrementalAppendChild(e)},i.prototype._runEncoder=function(t,e){var i,n=this,r=e?null:this._runGroupEncoder(null===(i=this._encoderOfState)||void 0===i?void 0:i.group);t.forEach((function(t,e){var i,a=n._runEncoderOfGraphic(null===(i=n._encoderOfState)||void 0===i?void 0:i.update,t);j(n._markConfig.interactive)||(a.pickable=n._markConfig.interactive);var o=n._transformGraphicAttributes(t,a,null==r?void 0:r[t.context.groupKey]);t.context.finalAttrs=o}))},i.prototype._runApplyGraphic=function(t){var e=this,i=this.hasAnimation();t.forEach((function(n,r){var a,o,s=n.context.finalAttrs,l=e.hasAnimationByState(n.context.animationState);if(n.setAttributes){var u=bV(n,s);n.context.diffAttrs=u,n.context.reusing?(n.context.lastAttrs=n.attribute,n.initAttributes({}),n.context.reusing=!1):l||(i?n.setAttributesAndPreventAnimate(u):n.setAttributes(u)),i&&n.setFinalAttributes(s)}else{var c=n;n=e._createGraphic(s),i&&(null===(a=n.setFinalAttributes)||void 0===a||a.call(n,s)),n.context=c.context,n.context.diffAttrs=s;var h=e._graphics===t?r:r+e._graphics.length-t.length;if(h>=0&&(e._graphics[h]=n),null===(o=e.renderContext)||void 0===o?void 0:o.progressive){var d=e._dataByGroup?e._dataByGroup.keys.indexOf(n.context.groupKey):0,p=d>=0?e._product.getChildAt(d):null;p&&e._addProgressiveGraphic(p,n)}else e._product.appendChild(n),e._graphicMap.set(n.context.uniqueKey,n)}e._setStateOfGraphic(n,l),e._setGraphicFromMarkConfig(n)}))},i.prototype._updateEncoderByState=function(){var e=this,i={};Object.keys(this.stateStyle).forEach((function(n){if(n===t.STATE_VALUE_ENUM.STATE_NORMAL){var r=e._separateNormalStyle(e.stateStyle[n]),a=r.groupStyles,o=r.updateStyles;i.group=e._getEncoderOfStyle(n,a),i.update=e._getEncoderOfStyle(n,o)}else i[n]=e._getEncoderOfStyle(n,e.stateStyle[n])})),this._encoderOfState=i},i.prototype._runState=function(t){var e=this;t.forEach((function(t){var i,n=P(P([],B((null!==(i=t.currentStates)&&void 0!==i?i:[]).filter((function(t){return!e.state.getStateInfo(t)}))),!1),B(e.state.checkState(t,t.context.data)),!1);e._stateSort&&n.length&&n.sort(e._stateSort),t.context.states=n}))},i.prototype._getAttrsFromConfig=function(t){void 0===t&&(t={});var e=this._markConfig,i=e.zIndex,n=e.clip,r=e.clipPath,a=e.overflow;if(j(i)||(t.zIndex=i),j(n)||(t.clip=n),!j(r)){var o=Z(r)?r:r(this._graphics);o&&o.length||(t.clip=!1),t.path=o}return j(a)||(t.overflow=a),t},i.prototype._updateAttrsOfGroup=function(){var t,e=this._getAttrsFromConfig();null===(t=this._product)||void 0===t||t.setAttributes(e),this._markConfig.support3d&&this._product&&this._product.setMode("3d")},i.prototype._runBeforeTransform=function(t){var e,i=null===(e=this._transform)||void 0===e?void 0:e.filter((function(t){if(t.type){var e=ij.getGrammarTransform(t.type);return e&&(!e.runType||"beforeJoin"===e.runType)}return!1}));return this.runTransforms(i,t)},i.prototype._runEncoderTransform=function(t,e){var i,n=null===(i=this._transform)||void 0===i?void 0:i.filter((function(t){if(t.type){var i=ij.getGrammarTransform(t.type);return i&&"afterEncode"===i.runType&&!!i.canProgressive===e}return!1}));return this.runTransforms(n,t)},i.prototype.renderInner=function(){var t,e,i;this._updateEncoderByState();var n,r=null!==(e=null===(t=this._data)||void 0===t?void 0:t.getProduct())&&void 0!==e?e:[{}],a=this._runBeforeTransform(r);if(null==a?void 0:a.progressive){this.renderContext={beforeTransformProgressive:a.progressive};var o=a.progressive;if(o.canAnimate&&o.canAnimate()&&o.unfinished())return void this._updateAttrsOfGroup();n=o.output()}else n=Dt(a),this._runGroupData(n),this.renderContext=this._parseProgressiveContext(n);(null===(i=this.renderContext)||void 0===i?void 0:i.progressive)?(this._graphicMap.clear(),this._runProgressiveStep()):(this._runJoin(n),this._runState(this._graphics),this._runEncoder(this._graphics),this._runEncoderTransform(this._graphics,!1),this._runApplyGraphic(this._graphics)),this._updateAttrsOfGroup()},i.prototype.render=function(){this.isCommited()&&(!this.getVisible()||this._skipBeforeLayouted&&this.getCompiler().getLayoutState()===UV.before||(HA("render mark: ".concat(this.getProductId(),", type is ").concat(this.type)),this.renderInner()),this.uncommit())},i.prototype.updateMarkState=function(t){var e=this;if(this._product){var i=this.state.getStateInfo(t);this._graphics.forEach((function(n){"in"===e.state.checkOneState(n,n.context.data,i)?n.addState(t,!0,e.hasAnimationByState("state")):n.removeState(t,e.hasAnimationByState("state"))}))}},i.prototype.clearExitGraphics=function(){var t=this;this._prevDataByKey=this._dataByKey;var e=function(e,i){t._graphicMap.delete(i),e.parent&&e.parent.removeChild(e),e.release&&e.release()};this._graphicMap.forEach((function(i,n){if(i.context.diffState===AW.exit&&!i.isExiting)if(i.context.animationState===AW.exit&&t.hasAnimationByState("exit")){i.isExiting=!0;var r=t.getAnimationConfig();if(r.exit&&r.exit.length){var a=r.exit.map((function(t,e){return{name:"exit_".concat(e),animation:M(M({},t),{customParameters:i.context})}}));i.applyAnimationState(["exit"],[1===a.length?a[0]:a],(function(){e(i,n)}))}}else e(i,n)}))},i.prototype.isProgressive=function(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)},i.prototype.canAnimateAfterProgressive=function(){var t,e;return this.renderContext&&this.renderContext.beforeTransformProgressive&&(null===(e=(t=this.renderContext.beforeTransformProgressive).canAnimate)||void 0===e?void 0:e.call(t))},i.prototype.isDoingProgressive=function(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())},i.prototype.clearProgressive=function(){this.renderContext&&this.renderContext.progressive&&(this._graphics=[],this._product.children.forEach((function(t){t.incrementalClearChild()})),this._product.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null},i.prototype.restartProgressive=function(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)},i.prototype._runBeforeProgressive=function(){var t,e=this.renderContext.beforeTransformProgressive;e.progressiveRun();var i=e.output();if(null===(t=e.canAnimate)||void 0===t?void 0:t.call(e)){if(e.unfinished())return;this._runGroupData(i),this._runJoin(i),this._runState(this._graphics),this._runEncoder(this._graphics),this._runApplyGraphic(this._graphics)}},i.prototype._runProgressiveJoin=function(){var t=this,e=this.renderContext.progressive.currentIndex,i=[],n={};return this._dataByGroup.keys.forEach((function(r){var a=t.renderContext.progressive.groupedData.get(r),o=t.renderContext.progressive.step,s=a.slice(e*o,(e+1)*o),l=[];s.forEach((function(n,a){var s=t._keyGetter(n),u={context:M(M({},t._getCommonContext()),{diffState:AW.enter,data:[n],uniqueKey:"".concat(r,"_").concat(null!=s?s:e*o+a),key:s,groupKey:r})};l.push(u),i.push(u)})),n[r]=l})),{graphicsByGroup:n,graphics:i,needUpdate:!0}},i.prototype._createIncrementalGraphics=function(){var t=this;this._product.removeAllChild(),this._dataByGroup.keys.forEach((function(e){var i=Vy({pickable:!1,zIndex:t._markConfig.zIndex});i.incremental=t.renderContext.progressive.step,t._product.appendChild(i)}))},i.prototype._setCommonAttributesToTheme=function(t){var e,i,n;if(this._attrsByGroup&&t){var r=t.parent;r&&(null===(e=this._attrsByGroup)||void 0===e?void 0:e[null===(i=t.context)||void 0===i?void 0:i.groupKey])&&r.setTheme({common:this._attrsByGroup[null===(n=t.context)||void 0===n?void 0:n.groupKey]})}},i.prototype._runProgressiveEncoder=function(t){0===this.renderContext.progressive.currentIndex?this._runEncoder(t):this._runEncoder(t,!0)},i.prototype._runProgressiveApplyGraphic=function(t){0===this.renderContext.progressive.currentIndex?(this._runApplyGraphic(t),this._setCommonAttributesToTheme(t[0])):this._runApplyGraphic(t)},i.prototype._runProgressiveStep=function(){var t=this,e=this._runProgressiveJoin(),i=e.graphics,n=e.graphicsByGroup,r=e.needUpdate;0===this.renderContext.progressive.currentIndex?(this._createIncrementalGraphics(),this._graphics=i):r&&i.forEach((function(e){t._graphics.push(e)})),this._runState(i),Object.keys(n).forEach((function(e){t._runProgressiveEncoder(n[e])})),this._runEncoderTransform(this._graphics,!0),Object.keys(n).forEach((function(e){t._runProgressiveApplyGraphic(n[e])})),this.renderContext.progressive.currentIndex+=1},i.prototype.renderProgressive=function(){var t;(null===(t=this.renderContext)||void 0===t?void 0:t.beforeTransformProgressive)?this._runBeforeProgressive():this.renderContext.progressive&&this._runProgressiveStep()},i.prototype.hasAnimationByState=function(t){if(!t||!this._animationConfig||!this._animationConfig[t]||this._disabledAnimationStates.includes(t))return!1;var e=this._animationConfig[t];return e.length>0||G(e)},i.prototype.hasAnimation=function(){return!!this._animationConfig&&Object.keys(this._animationConfig).length>0},i.prototype.runAnimation=function(){this._runStateAnimation(this.getGraphics())},i}(LW);t.MarkTypeEnum=void 0,(PW=t.MarkTypeEnum||(t.MarkTypeEnum={})).group="group",PW.symbol="symbol",PW.rule="rule",PW.line="line",PW.text="text",PW.rect="rect",PW.image="image",PW.path="path",PW.area="area",PW.arc="arc",PW.polygon="polygon",PW.boxPlot="boxPlot",PW.linkPath="linkPath",PW.cell="cell",PW.ripple="ripple",PW.liquid="liquid",PW.component="component",PW.dataLabel="dataLabel",PW.label="label",PW.pictogram="pictogram";var UW=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._marks=[],i._diffState=AW.enter,i}return C(e,t),e.prototype.getMarks=function(){return this._marks},e.prototype.isMarkExist=function(t){return void 0!==this._marks.find((function(e){return e.id===t.id}))},e.prototype.addMark=function(t){return this.isMarkExist(t)?(NA("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)},e.prototype.removeMark=function(t){var e=this._marks.findIndex((function(e){return e.id===t.id||e.name===t.name}));return-1===e?(NA("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)},e.prototype.getMarkInType=function(t){return this._marks.filter((function(e){return e.type===t}))},e.prototype.getMarkInId=function(t){return this._marks.find((function(e){return e.id===t}))},e.prototype.getMarkInUserId=function(t){var e;return qV(this,(function(t){e=t}),(function(e){return e.getUserId()===t}),null,!0),e},e.prototype.getMarkInName=function(t){return this._marks.filter((function(e){return e.name===t}))},e.prototype._compileProduct=function(e){var i=this;t.prototype._compileProduct.call(this,e),this.getMarks().forEach((function(t){t.compile({group:i._product})}))},e.prototype._getAttrsFromConfig=function(e){void 0===e&&(e={});var i=t.prototype._getAttrsFromConfig.call(this,e);return j(this._markConfig.interactive)||(i.pickable=this._markConfig.interactive),e},e.prototype.getGraphics=function(){return[this._product]},e.prototype.renderInner=function(){var t;if(this._product){var e=null!==(t=this._simpleStyle)&&void 0!==t?t:this.getAttributesOfState({});this._product.context=M(M(M({},this._product.context),this._getCommonContext()),{diffState:this._diffState}),this._setAnimationState(this._product);var i=this._getAttrsFromConfig(e);if(this._product.context.diffState===AW.update){var n=this.hasAnimation(),r=bV(this._product,i);this._product.context.diffAttrs=r,this.hasAnimationByState(this._product.context.animationState)||(n?this._product.setAttributesAndPreventAnimate(r):this._product.setAttributes(r)),n&&this._product.setFinalAttributes(i)}else this._product.setAttributes(i);this.needClear=!0}},e.prototype.clearExitGraphics=function(){this._diffState=AW.update},e.prototype.render=function(){this._isCommited&&(HA("render mark: ".concat(this.getProductId(),", type is ").concat(this.type)),this.renderInner(),this.uncommit()),this.getMarks().forEach((function(t){t.render()}))},e.prototype.release=function(){t.prototype.release.call(this),this.removeProduct()},e.type="group",e}(NW),jW=function(){cP(),YB(),ij.registerMark(UW.type,UW)},VW={measureText:Cj},WW=function(){function t(){this.functions={}}return t.instance=function(){return t.instance_||(t.instance_=new t),t.instance_},t.prototype.registerFunction=function(t,e){t&&e&&(this.functions[t]=e)},t.prototype.unregisterFunction=function(t){t&&delete this.functions[t]},t.prototype.getFunction=function(t){return this.functions[t]||null},t.prototype.getFunctionNameList=function(){return Object.keys(this.functions)},t}(),GW=function(){cM(rh)},YW=function(){BT(rh)},XW=function(){function t(){this.id=qA(),this._plugins=[]}return t.prototype.add=function(t){var e=this;if(!t||0===t.length)return null;var i=[];return t.forEach((function(t){e._plugins.find((function(e){return e.id===t.id}))?NA("不要重复添加相同的plugin"):(e._plugins.push(t),i.push(t),t.onAdd&&t.onAdd(e))})),i},t.prototype.load=function(t){var e=this.add(t);e&&e.length&&this.activate(t)},t.prototype.activate=function(t){t.length&&t.forEach((function(t){t.init&&t.init()}))},t.prototype.get=function(t){return this._plugins.find((function(e){return e.id===t}))},t.prototype.getAll=function(){return this._plugins.slice()},t.prototype.release=function(t){var e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter((function(t){return t!==e})))},t.prototype.releaseAll=function(){var t=this;this._plugins.forEach((function(e){e.release(t)})),this._plugins=[]},t.prototype.clear=function(t){var e=this.get(t);e&&e.clear(this)},t.prototype.clearAll=function(){var t=this;this._plugins.forEach((function(e){var i;null===(i=e.clear)||void 0===i||i.call(e,t)}))},t}(),KW=function(t){function e(e){var i=t.call(this)||this;return i.globalInstance=e,i}return C(e,t),e.prototype.onInit=function(t){var e=this;this._plugins.forEach((function(i){i.onInit&&i.onInit(e,t)}))},e.prototype.onBeforeResize=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeResize&&n.onBeforeResize(i,t,e)}))},e.prototype.onAfterChartSpecTransform=function(t,e){var i=this;this._plugins.forEach((function(n){n.onAfterChartSpecTransform&&n.onAfterChartSpecTransform(i,t,e)}))},e.prototype.onAfterModelSpecTransform=function(t,e,i){var n=this;this._plugins.forEach((function(r){r.onAfterModelSpecTransform&&r.onAfterModelSpecTransform(n,t,e,i)}))},e.prototype.onBeforeInitChart=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeInitChart&&n.onBeforeInitChart(i,t,e)}))},e.prototype.onAfterInitChart=function(t,e){var i=this;this._plugins.forEach((function(n){n.onAfterInitChart&&n.onAfterInitChart(i,t,e)}))},e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.globalInstance=null},e}(XW),qW={type:"fadeIn"};function ZW(t,e){switch(e){case"grow":return function(t){return{type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}}(t);case"fadeIn":return qW;default:return function(t){return{type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}}(t)}}var JW={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},QW={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},$W={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},tG=function(){ij.registerAnimation("scaleInOut",(function(){return QW}))},eG=function(){ij.registerAnimation("fadeInOut",(function(){return $W}))},iG=function(t,e){return{appear:ZW(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:hI,duration:JW.update.duration,easing:JW.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}],disappear:{type:"clipOut"}}},nG=function(){ij.registerAnimation("line",iG)},rG=function(){DL.registerBuiltInAnimate("growHeightIn",MI),DL.registerBuiltInAnimate("growHeightOut",wI),DL.registerBuiltInAnimate("growWidthIn",VI),DL.registerBuiltInAnimate("growWidthOut",WI),DL.registerBuiltInAnimate("growCenterIn",SI),DL.registerBuiltInAnimate("growCenterOut",AI)},aG=function(){DL.registerBuiltInAnimate("growRadiusIn",NI),DL.registerBuiltInAnimate("growRadiusOut",UI),DL.registerBuiltInAnimate("growAngleIn",xI),DL.registerBuiltInAnimate("growAngleOut",kI)},oG=function(){DL.registerBuiltInAnimate("growPointsIn",EI),DL.registerBuiltInAnimate("growPointsOut",BI),DL.registerBuiltInAnimate("growPointsXIn",RI),DL.registerBuiltInAnimate("growPointsXOut",LI),DL.registerBuiltInAnimate("growPointsYIn",FI),DL.registerBuiltInAnimate("growPointsYOut",OI),DL.registerBuiltInAnimate("clipIn",vI),DL.registerBuiltInAnimate("clipOut",gI)},sG=function(){DL.registerBuiltInAnimate("growPointsOut",BI)},lG=function(){HL(),DL.registerBuiltInAnimate("scaleIn",$I),DL.registerBuiltInAnimate("scaleOut",tF),DL.registerBuiltInAnimate("fadeIn",yI),DL.registerBuiltInAnimate("fadeOut",mI),DL.registerBuiltInAnimate("moveIn",yF),DL.registerBuiltInAnimate("moveOut",mF),DL.registerBuiltInAnimate("rotateIn",bF),DL.registerBuiltInAnimate("rotateOut",xF),DL.registerBuiltInAnimate("update",vF),DL.registerBuiltInAnimate("state",eF),DL.registerBuiltInAnimate("fromTo",SF),DL.registerBuiltInAnimate("distortion",PF),DL.registerBuiltInAnimate("particle",RF),DL.registerBuiltInAnimate("pixelation",FF),DL.registerBuiltInAnimate("gaussianBlur",IF),DL.registerBuiltInAnimate("glitch",LF),DL.registerBuiltInAnimate("grayscale",BF),DL.registerBuiltInAnimate("dissolve",EF)},uG=function(){ij.registerStageEventPlugin("gesture",PC)},cG=function(t,e){if(!e||!e.length)return[];var i=[];return t.markIds?e.filter((function(e){t.markIds.includes(e.getProductId())&&i.push(e)})):t.markNames?e.forEach((function(e){t.markNames.includes(e.name)&&i.push(e)})):e.forEach((function(t){i.push(t)})),i},hG=function(t){return t.filterField?function(e){var i;return null===(i=mV(e))||void 0===i?void 0:i[t.filterField]}:function(e){return e.context[t.filterType]}},dG={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"},pG=function(){function t(t){var e=this;this._markSet=new lW,this.options=t,t.marks&&t.marks.length&&t.marks.forEach((function(t){e.registerMark(t)}))}return t.prototype.getMarks=function(){return this._markSet.getMarks()},t.prototype.getMarksByState=function(t){if(this._markIdByState&&this._markSet){var e=this._markIdByState[t];return e?this.getMarks().filter((function(t){return t&&e.includes(t.id)})):[]}return[]},t.prototype.registerMark=function(t){var e=this;Z(t)?t.forEach((function(t){e._markSet.addMark(t)})):this._markSet.addMark(t)},t.prototype.updateMarkIdByState=function(t){this._markIdByState=function(t,e){if(!e||!t)return null;var i={};return t.forEach((function(t){var n=t.stateStyle;n&&e.forEach((function(e){e&&n[e]&&(i[e]||(i[e]=[]),i[e].push(t.id))}))})),i}(this.getMarks(),t)},t.prototype.getMarkIdByState=function(){var t;return null!==(t=this._markIdByState)&&void 0!==t?t:{}},t.prototype.isGraphicInStateMark=function(t,e){var i,n=this.getMarkIdByState();return n&&n[e]&&n[e].includes(null===(i=t.context)||void 0===i?void 0:i.markId)},t.prototype.isGraphicInMark=function(t){var e;return!!this._markSet.getMarkInId(null===(e=t.context)||void 0===e?void 0:e.markId)},t.prototype.getStartState=function(){return null},t.prototype.getResetState=function(){return null},t.prototype.init=function(){var t=this,e=this.getEvents();e&&this.options.event&&e.forEach((function(e){e.type&&e.handler&&(Z(e.type)?e.type.forEach((function(i){i&&"none"!==i&&t.options.event.on(i,e.handler)})):"none"!==e.type&&t.options.event.on(e.type,e.handler))}))},t.prototype.release=function(){var t=this,e=this.getEvents();e&&this.options.event&&(null!=e?e:[]).forEach((function(e){e.type&&e.handler&&(Z(e.type)?e.type.forEach((function(i){i&&"none"!==i&&t.options.event.on(i,e.handler)})):"none"!==e.type&&t.options.event.off(e.type,e.handler))}))},t.prototype.start=function(t){},t.prototype.reset=function(t){},t.prototype.dispatchEvent=function(t,e){this.options.event&&(this.options.event.emit("".concat(this.type,":").concat(t),e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e))},t}(),fG={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"},vG=function(t){function e(e){var i=t.call(this,e)||this;return i.type="element-highlight",i.resetAll=function(){var t=i.options,e=t.highlightState,n=t.blurState,r=t.interaction;i._lastGraphic&&(r.clearAllStatesOfTrigger(i,e,n),i.dispatchEvent("reset",{graphics:[i._lastGraphic],options:i.options}),i._lastGraphic=null,r.setStatedGraphics(i,[]))},i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){var e=i.options.interaction.getStatedGraphics(i);if(e&&e.length){var n=t.item,r=n&&i._markSet.getMarkInId(n.context.markId);(i._resetType.includes("view")&&!r||i._resetType.includes("self")&&r)&&i.resetAll()}},i.options=Object.assign({},fG,e),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return C(e,t),e.prototype.getStartState=function(){return this.options.highlightState},e.prototype.getResetState=function(){return this.options.blurState},e.prototype.getEvents=function(){var t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return q(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e},e.prototype.start=function(t){if(t&&this._markSet.getMarkInId(t.context.markId)){var e=this.options,i=e.highlightState,n=e.blurState,r=e.interaction;if(this._lastGraphic===t)return;var a=r.updateStates(this,[t],r.getStatedGraphics(this),i,n);r.setStatedGraphics(this,a),this._lastGraphic=t,this.dispatchEvent("start",{graphics:a,options:this.options})}else this._lastGraphic&&"view"===this._resetType&&this.resetAll()},e.prototype.reset=function(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()},e.type="element-highlight",e.defaultOptions=fG,e}(pG),gG=function(){ij.registerInteractionTrigger(vG.type,vG)},yG={state:t.STATE_VALUE_ENUM.STATE_SELECTED,trigger:"click"},mG=function(t){function e(e){var i=t.call(this,e)||this;return i.type="element-select",i._resetType=[],i.resetAll=function(){var t=i.options,e=t.state,n=t.reverseState,r=t.interaction,a=r.getStatedGraphics(i);a&&a.length&&(r.clearAllStatesOfTrigger(i,e,n),i.dispatchEvent("reset",{graphics:a,options:i.options}),r.setStatedGraphics(i,[]))},i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){var e=i.options.interaction.getStatedGraphics(i);if(e&&e.length){var n=t.item,r=n&&i._markSet.getMarkInId(n.context.markId);(i._resetType.includes("view")&&!r||i._resetType.includes("self")&&r)&&i.resetAll()}},i.options=Object.assign({},yG,e),i.updateMarkIdByState([i.options.state,i.options.reverseState]),i}return C(e,t),e.prototype.getStartState=function(){return this.options.state},e.prototype.getResetState=function(){return this.options.reverseState},e.prototype.getEvents=function(){var t=this,e=this.options.triggerOff,i=this.options.trigger,n=[{type:i,handler:this.handleStart}],r=function(t){var e=Dt(t),i=[],n=[];return e.forEach((function(t){"empty"===t?i.push("view"):q(t)&&"none"!==t?t.includes("view:")?(n.push(t.replace("view:","")),i.push("view")):(n.push(t),i.push("self")):$(t)&&i.push("timeout")})),{eventNames:n,resetType:i}}(e),a=r.eventNames,o=r.resetType;return a.forEach((function(e){e&&(Z(i)?!i.includes(e):e!==i)&&n.push({type:e,handler:t.handleReset})})),this._resetType=o,n},e.prototype.start=function(t){var e=this,i=this.options,n=i.state,r=i.reverseState,a=i.isMultiple,o=i.interaction,s=o.getStatedGraphics(this);if(t&&this._markSet.getMarkInId(t.context.markId))if(t.hasState(n)){if(this._resetType.includes("self"))(l=s&&s.filter((function(e){return e!==t})))&&l.length?o.setStatedGraphics(this,o.updateStates(this,l,s,n,r)):this.resetAll()}else{this._timer&&clearTimeout(this._timer),t.addState(n,!0);var l=this.options.interaction.updateStates(this,a&&s?P(P([],B(s),!1),[t],!1):[t],s,n,r);o.setStatedGraphics(this,l),this.dispatchEvent("start",{graphics:l,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout((function(){e.resetAll()}),this.options.triggerOff))}else this._resetType.includes("view")&&s&&s.length&&this.resetAll()},e.prototype.reset=function(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.state,this.options.reverseState]):this.resetAll()},e.type="element-select",e.defaultOptions=yG,e}(pG),_G=function(){ij.registerInteractionTrigger(mG.type,mG)},bG=function(t){function e(e){var i=t.call(this)||this;return i.globalInstance=e,i}return C(e,t),e.prototype.onInit=function(){var t=this;this._plugins.forEach((function(e){e.onInit&&e.onInit(t)}))},e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.globalInstance=null},e}(XW),xG=function(){function e(e,i){var n,r,a,o,s,l,u,c,h,d=this;this.id=qA(),this._userEvents=[],this._autoSize=!0,this._option={mode:t.RenderModeEnum["desktop-browser"],onError:function(t){throw new Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._doResize=function(){var t=d.getCurrentSize(),e=t.width,i=t.height;d._currentSize.width===e&&d._currentSize.height===i||(d._currentSize={width:e,height:i},d.resizeSync(e,i))},this._renderSync=function(t){var e;void 0===t&&(t={});var i=d;return d._beforeRender(t)?(null===(e=d._compiler)||void 0===e||e.render(t.morphConfig),d._updateAnimateState(!1),d._afterRender(),i):i},this._updateSpec=function(t,e,i){var n;void 0===e&&(e=!1);var r=d._spec,a={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(d._setNewSpec(t,e)){St(r.theme,d._spec.theme)?St(d._spec.background,r.background)||(a.reMake=!0,a.changeBackground=!0):a.changeTheme=!0;var o=d._shouldChartResize(r);if(a.reSize=o,d._spec.type!==r.type)return null===(n=d._compiler)||void 0===n||n.updateLayoutTag(),a.reMake=!0,a.reTransformSpec=!0,a.change=!0,a.changeTheme=!0,a;d._initChartSpec(d._spec,"updateSpec");var s=nW(d._chart.updateSpec(d._spec),a);return i?M(M({},s),i):s}},this.getTheme=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(d._currentTheme&&t&&t.length){d._cachedProcessedTheme||(d._cachedProcessedTheme={});var i=t.join(".");if(d._cachedProcessedTheme[i])return d._cachedProcessedTheme[i];var n=d._currentTheme;return t.forEach((function(e,i){var r;if(1!==i||"series"!==t[0]&&"component"!==t[0])n=null==n?void 0:n[e];else{var a="series"===t[0]?ij.getSeriesBuiltInTheme(e):ij.getComponentBuiltInTheme(e);n=n?ej({},a,n[e]):a}i===t.length-1&&W(n)&&(n=kj((r={},r[e]=n,r),d._currentTheme.colorScheme,d._currentTheme.token)[e])})),d._cachedProcessedTheme[i]=n,n}},yU(i),this._option=M(M({},this._option),i),(null==i?void 0:i.optimize)&&(this._option.optimize=M(M({},this._option.optimize),i.optimize)),this._onError=null===(n=this._option)||void 0===n?void 0:n.onError;var p=this._option,f=p.dom,v=p.renderCanvas,g=p.mode,y=p.stage,m=p.poptip,_=w(p,["dom","renderCanvas","mode","stage","poptip"]),b=GA(g);if(b?GW():"node"===g&&YW(),b&&f&&(this._container=q(f)?tS.getElementById(f):f),v&&(this._canvas=v),y&&(this._stage=y),"node"===g||this._container||this._canvas||this._stage){this._viewBox=this._option.viewBox,this._currentThemeName=_j.getCurrentThemeName(),this._setNewSpec(e),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();var x=[];!1!==m&&x.push("poptipForText"),"sankey"===e.type&&x.push("scrollbar");var k=new Wt(null!==(a=this._option.logLevel)&&void 0!==a?a:t.LoggerLevel.Error);Wt.setInstance(k),(null===(o=this._option)||void 0===o?void 0:o.onError)&&k.addErrorHandler((function(){for(var t,e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];null===(e=null===(t=d._option)||void 0===t?void 0:t.onError)||void 0===e||e.call.apply(e,P([t],B(i),!1))})),this._compiler=new QV({dom:null!==(s=this._container)&&void 0!==s?s:"none",canvas:v},M(M({mode:this._option.mode,stage:y,pluginList:x},_),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new DV(this,this._compiler),this._event=new xV(this._eventDispatcher,g),this._compiler.initView(),this._compiler.updateLayoutTag(),this._setFontFamilyTheme(this.getTheme("fontFamily")),this._initDataSet(this._option.dataSet),this._autoSize=!!b&&(null===(u=null!==(l=e.autoFit)&&void 0!==l?l:this._option.autoFit)||void 0===u||u),this._bindResizeEvent(),this._bindViewEvent(),this._initChartPlugin(),mj.registerInstance(this),null===(h=null===(c=this._option.performanceHook)||void 0===c?void 0:c.afterCreateVChart)||void 0===h||h.call(c,this)}else null===(r=this._option)||void 0===r||r.onError("please specify container or renderCanvas!")}return e.useRegisters=function(t){t.forEach((function(t){"function"==typeof t?t():console.error("Invalid function:",t)}))},e.useChart=function(t){t.forEach((function(t){return ij.registerChart(t.type,t)}))},e.useSeries=function(t){t.forEach((function(t){return ij.registerSeries(t.type,t)}))},e.useComponent=function(t){t.forEach((function(t){return ij.registerComponent(t.type,t)}))},e.useMark=function(t){t.forEach((function(t){var e;return ij.registerMark(null!==(e=t.constructorType)&&void 0!==e?e:t.type,t)}))},e.useLayout=function(t){t.forEach((function(t){return ij.registerLayout(t.type,t)}))},e.registerDataSetTransform=function(t,e){ij.registerTransform(t,e)},e.registerFunction=function(t,e){t&&e&&WW.instance().registerFunction(t,e)},e.unregisterFunction=function(t){t&&WW.instance().unregisterFunction(t)},e.getFunction=function(t){return t?WW.instance().getFunction(t):null},e.getFunctionList=function(){return WW.instance().getFunctionNameList()},e.registerMap=function(t,e,i){var n=ij.getImplementInKey("registerMap");n&&n(t,e,i)},e.unregisterMap=function(t){var e=ij.getImplementInKey("unregisterMap");e&&e(t)},e.getMap=function(t){return function(t){return RV.get(t)}(t)},e.registerSVG=function(t,e,i){var n=ij.getImplementInKey("registerSVG");n&&n(t,e,i)},e.unregisterSVG=function(t){var e=ij.getImplementInKey("unregisterSVG");e&&e(t)},e.hideTooltip=function(t){void 0===t&&(t=[]),mj.forEach((function(t){var e;return null===(e=null==t?void 0:t.hideTooltip)||void 0===e?void 0:e.call(t)}),t)},e.getLogger=function(){return Wt.getInstance()},e.prototype.getSpec=function(){return this._spec},e.prototype.getSpecInfo=function(){return this._specInfo},Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.getDataSet=function(){return this._dataSet},e.prototype._setNewSpec=function(t,e){return!!t&&(q(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=ej({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)},e.prototype._getSpecFromOriginalSpec=function(){var t,e=Sj(this._originalSpec);return e.data=null!==(t=e.data)&&void 0!==t?t:[],e},e.prototype._initChartSpec=function(t,i){var n,r;e.getFunctionList()&&e.getFunctionList().length&&(t=Aj(t,e)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=ij.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null===(n=this._chartSpecTransformer)||void 0===n||n.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,i),this._specInfo=null===(r=this._chartSpecTransformer)||void 0===r?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,i)},e.prototype._updateSpecInfo=function(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=ij.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null===(t=this._chartSpecTransformer)||void 0===t?void 0:t.createSpecInfo(this._spec)},e.prototype._initChart=function(e){var i,n,r;if(this._compiler)if(this._chart)null===(n=this._option)||void 0===n||n.onError("chart is already initialized");else{var a=ij.createChart(e.type,e,this._getChartOption(e.type));a?(this._chart=a,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(t.ChartEvent.initialized,{chart:a,vchart:this})):null===(r=this._option)||void 0===r||r.onError("init chart fail")}else null===(i=this._option)||void 0===i||i.onError("compiler is not initialized")},e.prototype._releaseData=function(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)},e.prototype._bindViewEvent=function(){var e,i,n=this;this._compiler&&(null===(i=null===(e=this._compiler.getStage())||void 0===e?void 0:e.getTimeline())||void 0===i||i.on("animationEnd",(function(){n._event.emit(t.ChartEvent.animationFinished,{chart:n._chart,vchart:n})})))},e.prototype._bindResizeEvent=function(){var t,e;if(this._autoSize){if(this._onResize=ge(this._doResize,null!==(t=this._option.resizeDelay)&&void 0!==t?t:100),this._container){var i=window.ResizeObserver;i&&(this._observer=new i(this._onResize),null===(e=this._observer)||void 0===e||e.observe(this._container))}window.addEventListener("resize",this._onResize)}},e.prototype._unBindResizeEvent=function(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))},e.prototype.getCurrentSize=function(){var t,e,i,n;return iW(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!==(e=null===(t=this._currentSize)||void 0===t?void 0:t.width)&&void 0!==e?e:wj,height:null!==(n=null===(i=this._currentSize)||void 0===i?void 0:i.height)&&void 0!==n?n:Tj})},e.prototype._initDataSet=function(t){for(var e in this._dataSet=t instanceof uc?t:new uc,BV(this._dataSet,"dataview",Xu),BV(this._dataSet,"array",I),EV(this._dataSet,"copyDataView",jV),ij.transforms)EV(this._dataSet,e,ij.transforms[e]);for(var e in ij.dataParser)BV(this._dataSet,e,ij.dataParser[e])},e.prototype.updateCustomConfigAndRerender=function(t,e,i){if(void 0===i&&(i={}),!this._isReleased&&t)return U(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)},e.prototype._updateCustomConfigAndRecompile=function(t,e){return void 0===e&&(e={}),!!t&&(this._reCompile(t),this._beforeRender(e))},e.prototype._reCompile=function(t,e){var i,n,r,a,o,s,l,u=this;if(t.reMake&&(this._releaseData(),this._initDataSet(),null===(i=this._chart)||void 0===i||i.release(),this._chart=null),t.reTransformSpec&&(this._chartSpecTransformer=null),t.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme(this.getTheme("fontFamily"))):t.changeBackground&&(null===(n=this._compiler)||void 0===n||n.setBackground(this._getBackground())),t.reMake?(null===(r=this._compiler)||void 0===r||r.releaseGrammar(),this._userEvents.forEach((function(t){var e;return null===(e=u._event)||void 0===e?void 0:e.on(t.eType,t.query,t.handler)}))):t.reCompile&&(null===(a=this._compiler)||void 0===a||a.clear({chart:this._chart,vChart:this}),null===(o=this._compiler)||void 0===o||o.compile({chart:this._chart,vChart:this})),t.reSize){var c=this.getCurrentSize(),h=c.width,d=c.height;this._currentSize={width:h,height:d},null===(s=this._chart)||void 0===s||s.onResize(h,d,!1),null===(l=this._compiler)||void 0===l||l.resize(h,d,!1)}},e.prototype._beforeRender=function(t){var e,i,n,r,a,o,s,l;if(void 0===t&&(t={}),this._isReleased)return!1;if(this._chart)return!0;var u=t.transformSpec,c=t.actionSource;return u&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,c),null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeInitializeChart)||void 0===i||i.call(e,this),this._initChart(this._spec),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterInitializeChart)||void 0===r||r.call(n,this),!(!this._chart||!this._compiler)&&(this._chartPluginApply("onAfterInitChart",this._spec,c),null===(o=null===(a=this._option.performanceHook)||void 0===a?void 0:a.beforeCompileToVGrammar)||void 0===o||o.call(a,this),this._compiler.compile({chart:this._chart,vChart:this},t),null===(l=null===(s=this._option.performanceHook)||void 0===s?void 0:s.afterCompileToVGrammar)||void 0===l||l.call(s,this),!0)},e.prototype._afterRender=function(){return!this._isReleased&&(this._event.emit(t.ChartEvent.rendered,{chart:this._chart,vchart:this}),!0)},e.prototype.renderSync=function(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})},e.prototype.renderAsync=function(t){return T(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})]}))}))},e.prototype._renderAsync=function(t){return void 0===t&&(t={}),T(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this._renderSync(t)]}))}))},e.prototype._updateAnimateState=function(t){var e,i;if(this.isAnimationEnable()){var n=function(e){var i,n=null===(i=e.context)||void 0===i?void 0:i.diffState;return t?"exit"===n?HV.none:HV.appear:n};null===(e=this._chart)||void 0===e||e.getAllRegions().forEach((function(t){t.updateAnimateStateCallback(n)})),null===(i=this._chart)||void 0===i||i.getAllComponents().forEach((function(t){t.updateAnimateStateCallback(n)}))}},e.prototype.release=function(){var t,e,i,n;(null===(t=this._onResize)||void 0===t?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null===(e=this._chart)||void 0===e||e.release(),null===(i=this._eventDispatcher)||void 0===i||i.release(),null===(n=this._compiler)||void 0===n||n.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._cachedProcessedTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,mj.unregisterInstance(this)},e.prototype.updateData=function(t,e,i,n){return T(this,void 0,void 0,(function(){return D(this,(function(r){return[2,this.updateDataSync(t,e,i,n)]}))}))},e.prototype._updateDataById=function(t,e,i){var n=this._spec.data.find((function(e){return e.name===t||e.id===t}));n?n.id===t?n.values=e:n.name===t&&n.parse(e,i):Z(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)},e.prototype.updateDataInBatches=function(t){return T(this,void 0,void 0,(function(){var e=this;return D(this,(function(i){return this._chart?(this._chart.updateFullData(t.map((function(t){return{id:t.id,values:t.data,parser:t.options}}))),this._chart.updateGlobalScaleDomain(),this._compiler.render(),[2,this]):(this._spec.data=Dt(this._spec.data),t.forEach((function(t){var i=t.id,n=t.data,r=t.options;e._updateDataById(i,n,r)})),[2,this])}))}))},e.prototype.updateDataSync=function(t,e,i,n){return j(this._dataSet)?this:this._chart?(this._chart.updateData(t,e,!0,i),(null==n?void 0:n.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render(),this):(this._spec.data=Dt(this._spec.data),this._updateDataById(t,e,i),this)},e.prototype.updateFullDataSync=function(t,e,i){var n=this;if(void 0===e&&(e=!0),this._chart)return this._chart.updateFullData(t),e&&((null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()),this;var r=Dt(this._spec.data);return Dt(t).forEach((function(t){var e=t.id,i=t.values,a=t.parser,o=t.fields,s=r.find((function(t){return t.name===e}));if(s)s instanceof cc?(s.setFields(ft(o)),s.parse(i,ft(a))):(s.values=i,W(a)&&(s.parser=a),W(o)&&(s.fields=o));else{var l=WV(t,n._dataSet,r);Z(n._spec.data)&&n._spec.data.push(l)}})),this},e.prototype.updateFullData=function(t,e){return void 0===e&&(e=!0),T(this,void 0,void 0,(function(){return D(this,(function(i){return[2,this.updateFullDataSync(t,e)]}))}))},e.prototype.updateSpec=function(t,e,i,n){return void 0===e&&(e=!1),T(this,void 0,void 0,(function(){var r;return D(this,(function(a){switch(a.label){case 0:return(r=this._updateSpec(t,e,n))?[4,this.updateCustomConfigAndRerender(r,!1,{morphConfig:i,transformSpec:r.reTransformSpec,actionSource:"updateSpec"})]:[2,this];case 1:return a.sent(),[2,this]}}))}))},e.prototype.updateSpecSync=function(t,e,i,n){void 0===e&&(e=!1);var r=this._updateSpec(t,e,n);return r?(this.updateCustomConfigAndRerender(r,!0,{morphConfig:i,transformSpec:r.reTransformSpec,actionSource:"updateSpec"}),this):this},e.prototype.updateSpecAndRecompile=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i={});var n=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(n,M({actionSource:"updateSpecAndRecompile"},i))},e.prototype.updateModelSpec=function(t,e,i,n){return void 0===i&&(i=!1),T(this,void 0,void 0,(function(){return D(this,(function(r){return[2,this.updateModelSpecSync(t,e,i,n)]}))}))},e.prototype.updateModelSpecSync=function(t,e,i,n){if(void 0===i&&(i=!1),!e||!this._spec)return this;if(q(e)&&(e=JSON.parse(e)),U(t)||function(t,e,i,n){Object.keys(t).forEach((function(r){if(G(e))e.type===r&&(Z(t[r])?t[r].length>=e.index&&(t[r][e.index]=n?ej({},t[r][e.index],i):i):t[r]=n?ej({},t[r],i):i);else if(Z(t[r])){var a=t[r].findIndex((function(t){return t.id===e}));a>=0&&(t[r][a]=n?ej({},t[r][a],i):i)}else t.id===e&&(t[r]=n?ej({},t[r],i):i)}))}(this._spec,t,e,i),this._chart){var r=this._chart.getModelInFilter(t);if(r)return this._updateModelSpec(r,e,!0,i,n)}return this},e.prototype._updateModelSpec=function(t,e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),n&&(e=ej({},t.getSpec(),e));var a=t.updateSpec(e);return t.reInit(e),(a.change||a.reCompile||a.reMake||a.reSize||a.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(a,i,{morphConfig:r,transformSpec:!1,actionSource:"updateModelSpec"})},e.prototype.resize=function(t,e){return T(this,void 0,void 0,(function(){return D(this,(function(i){return[2,this.resizeSync(t,e)]}))}))},e.prototype.resizeSync=function(t,e){var i,n;return this._beforeResize(t,e)?(null===(n=(i=this._compiler).resize)||void 0===n||n.call(i,t,e),this._afterResize()):this},e.prototype._beforeResize=function(t,e){var i,n,r,a;if(!this._chart||!this._compiler)return!1;var o=this._chart.getCanvasRect();return(!o||o.width!==t||o.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.beforeResizeWithUpdate)||void 0===n||n.call(i,this),this._chart.onResize(t,e,!1),null===(a=null===(r=this._option.performanceHook)||void 0===r?void 0:r.afterResizeWithUpdate)||void 0===a||a.call(r,this),!0)},e.prototype._afterResize=function(){return this._isReleased||this._event.emit(t.ChartEvent.afterResize,{chart:this._chart}),this},e.prototype.updateViewBox=function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),this._chart&&this._compiler?(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e),this):this},e.prototype.on=function(t,e,i){var n;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null===(n=this._event)||void 0===n||n.on(t,e,i))},e.prototype.off=function(t,e){var i,n=this;if(this._userEvents&&0!==this._userEvents.length)if(e){var r=this._userEvents.findIndex((function(i){return i.eType===t&&i.handler===e}));r>=0&&(this._userEvents.splice(r,1),null===(i=this._event)||void 0===i||i.off(t,e))}else this._userEvents.forEach((function(e){var i;e.eType===t&&(null===(i=n._event)||void 0===i||i.off(t,e.handler))})),this._userEvents=this._userEvents.filter((function(e){return e.eType!==t}))},e.prototype.updateState=function(t,e){this._chart&&this._chart.updateState(t,e)},e.prototype.setSelected=function(t,e,i){this._chart&&this._chart.setSelected(t,e,i)},e.prototype.setHovered=function(t,e,i){this._chart&&this._chart.setHovered(t,e,i)},e.prototype.clearState=function(t){this._chart&&this._chart.clearState(t)},e.prototype.clearAllStates=function(){this._chart&&this._chart.clearAllStates()},e.prototype.clearSelected=function(){this._chart&&this._chart.clearSelected()},e.prototype.clearHovered=function(){this._chart&&this._chart.clearHovered()},e.prototype._updateCurrentTheme=function(t){var e,i,n,r=this._option.theme,a=null===(e=this._spec)||void 0===e?void 0:e.theme,o=null===(i=this._spec)||void 0===i?void 0:i.type;t&&(this._currentThemeName=t);var s,l,u=function(t,e){var i;return(null===(i=e.chart)||void 0===i?void 0:i[t])&&(e=nj({},e,e.chart[t])),e};if(ct(r)&&ct(a))s=bj(this._currentThemeName),this._currentTheme=u(o,s);else if(q(r)&&(!a||q(a))||q(a)&&(!r||q(r))){var c=nj({},bj(this._currentThemeName),bj(r),bj(a));this._currentTheme=u(o,c)}else{c=nj({},bj(this._currentThemeName),bj(r),bj(a));this._currentTheme=u(o,c)}this._cachedProcessedTheme=null,l=this.getTheme("component","poptip"),mt(rR.poptip,nR,l),null===(n=this._compiler)||void 0===n||n.setBackground(this._getBackground())},e.prototype._shouldChartResize=function(t){var e,i,n=!1;j(this._spec.width)?!j(t.width)&&(this._spec.width=t.width):this._spec.width!==t.width&&(n=!0),j(this._spec.height)?!j(t.height)&&(this._spec.height=t.height):this._spec.height!==t.height&&(n=!0);var r=this._autoSize;return this._autoSize=!!GA(this._option.mode)&&(null===(i=null!==(e=this._spec.autoFit)&&void 0!==e?e:this._option.autoFit)||void 0===i||i),this._autoSize!==r&&(n=!0),n},e.prototype._getBackground=function(){return("string"==typeof this._spec.background||G(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this.getTheme("background")||this._option.background},e.prototype.getCurrentTheme=function(){return bj(this._currentThemeName)},e.prototype.getCurrentThemeName=function(){return this._currentThemeName},e.prototype.setCurrentTheme=function(t){return T(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.setCurrentThemeSync(t)]}))}))},e.prototype.setCurrentThemeSync=function(t){if(!_j.themeExist(t))return this;var e=this._setCurrentTheme(t);return this._setFontFamilyTheme(this.getTheme("fontFamily")),this.updateCustomConfigAndRerender(e,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this},e.prototype._setCurrentTheme=function(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null===(e=this._chart)||void 0===e||e.setCurrentTheme(),{change:!0,reMake:!1}},e.prototype._setFontFamilyTheme=function(t){var e;t&&(null===(e=this.getStage())||void 0===e||e.setTheme({text:{fontFamily:t},richtext:{fontFamily:t}}))},e.prototype._getTooltipComponent=function(){var t;return null===(t=this._chart)||void 0===t?void 0:t.getComponentsByType(L.tooltip)[0]},e.prototype.setTooltipHandler=function(t){var e,i;this._context.tooltipHandler=t;var n=this._getTooltipComponent();n&&(null===(i=null===(e=n.tooltipHandler)||void 0===e?void 0:e.release)||void 0===i||i.call(e),n.tooltipHandler=t)},e.prototype.getTooltipHandlerByUser=function(){var t;return null===(t=this._context)||void 0===t?void 0:t.tooltipHandler},e.prototype.getTooltipHandler=function(){var t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler},e.prototype.showTooltip=function(t,e){var i,n=this._getTooltipComponent();return null!==(i=W(t)&&"none"!==(null==n?void 0:n.showTooltip(t,e)))&&void 0!==i&&i},e.prototype.hideTooltip=function(){var t,e=this._getTooltipComponent();return null!==(t=null==e?void 0:e.hideTooltip())&&void 0!==t&&t},e.prototype.getLegendDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]},e.prototype.getLegendDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(L.discreteLegend);return i&&i[t]?i[t].getLegendData():[]},e.prototype.getLegendSelectedDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]},e.prototype.getLegendSelectedDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(L.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]},e.prototype.setLegendSelectedDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.setSelectedData(e)},e.prototype.setLegendSelectedDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(L.discreteLegend);n&&n[t]&&n[t].setSelectedData(e)},e.prototype.getDataURL=function(){var t;return T(this,void 0,void 0,(function(){var e;return D(this,(function(i){switch(i.label){case 0:return e=this.getStage(),this._chart&&e?(e.render(),[4,tW(this._chart.getCanvas(),{onError:this._onError})]):[3,2];case 1:return[2,i.sent()];case 2:return null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined")),[2,null]}}))}))},e.prototype.exportImg=function(t){var e,i;return T(this,void 0,void 0,(function(){var n;return D(this,(function(r){switch(r.label){case 0:return GA(this._option.mode)?[4,this.getDataURL()]:(null===(e=this._option)||void 0===e||e.onError(new TypeError("non-browser environment can not export img")),[2]);case 1:return(n=r.sent())?function(t,e){void 0===t&&(t="vchart");var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download","".concat(t,".png")),i.dispatchEvent(new MouseEvent("click"))}(t,n):null===(i=this._option)||void 0===i||i.onError(new ReferenceError("render is not defined")),[2]}}))}))},e.prototype.exportCanvas=function(){var t,e=this.getStage();if(this._chart&&e)return e.toCanvas();null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined"))},e.prototype.getImageBuffer=function(){var t,e;if("node"===this._option.mode){var i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null===(e=this._option)||void 0===e||e.onError(new ReferenceError("render is not defined")),null)}null===(t=this._option)||void 0===t||t.onError(new TypeError("getImageBuffer() now only support node environment."))},e.prototype.setLayout=function(t){var e;this._option.layout=t,null===(e=this._chart)||void 0===e||e.setLayout(t)},e.prototype.reLayout=function(){var t;this._chart.resetLayoutItemTag(),null===(t=this._chart)||void 0===t||t.setLayoutTag(!0)},e.prototype.getCompiler=function(){return this._compiler},e.prototype.getChart=function(){return this._chart},e.prototype.getStage=function(){return this._compiler.getStage()},e.prototype.getCanvas=function(){var t;return null===(t=this._compiler)||void 0===t?void 0:t.getCanvas()},e.prototype.getContainer=function(){var t,e;return W(this._container)?this._container:(e=q(this._canvas)?tS.getElementById(this._canvas):this._canvas,W(e)?e.parentElement:null===(t=this.getCanvas())||void 0===t?void 0:t.parentElement)},e.prototype.getComponents=function(){return this._chart.getAllComponents()},e.prototype.getScale=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)},e.prototype.setDimensionIndex=function(t,e){var i;return void 0===e&&(e={}),null===(i=this._chart)||void 0===i?void 0:i.setDimensionIndex(t,e)},e.prototype.showCrosshair=function(t){var e;null===(e=this._chart)||void 0===e||e.showCrosshair(t)},e.prototype.stopAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.stopAnimation(!0)},e.prototype.reRunNormalAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.reApplyAnimationState("normal",!0)},e.prototype.pauseAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.pauseAnimation(!0)},e.prototype.resumeAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.resumeAnimation(!0)},e.prototype.convertDatumToPosition=function(t,e,i,n){var r;if(void 0===e&&(e={}),void 0===i&&(i=!1),!this._chart)return null;if(ct(t))return null;var a,o=e.seriesId,s=e.seriesIndex,l=void 0===s?0:s;if(W(o)?a=this._chart.getSeriesInUserId(o):W(l)&&(a=null===(r=this._chart.getSeriesInIndex([l]))||void 0===r?void 0:r[0]),a){var u=Object.keys(t),c=a.getViewData().latestData.find((function(e){return u.every((function(i){return e[i]==t[i]}))})),h=a.getRegion().getLayoutStartPoint(),d=void 0;return(d=c?a.dataToPosition(c,n):a.dataToPosition(t,n))?VU(d,h,i):null}return null},e.prototype.convertValueToPosition=function(t,e,i){var n,r;if(void 0===i&&(i=!1),!this._chart||j(t)||ct(e))return null;if(!Z(t)){var a=e,o=a.axisId,s=a.axisIndex,l=void 0;if(W(o)?l=this._chart.getComponentsByKey("axes").find((function(t){return t.userId===o})):W(s)&&(l=null===(n=this._chart.getComponentsByKey("axes"))||void 0===n?void 0:n[s]),!l)return NA("Please check whether the `axisId` or `axisIndex` is set!"),null;var u=null==l?void 0:l.valueToPosition(t);if(i){var c=l.getLayoutStartPoint(),h=l.getOrient();return u+("bottom"===h||"top"===h?c.x:c.y)}return u}var d,p=e,f=p.seriesId,v=p.seriesIndex;return W(f)?d=this._chart.getSeriesInUserId(f):W(v)&&(d=null===(r=this._chart.getSeriesInIndex([v]))||void 0===r?void 0:r[0]),d?VU(d.valueToPosition(t[0],t[1]),d.getRegion().getLayoutStartPoint(),i):(NA("Please check whether the `seriesId` or `seriesIndex` is set!"),null)},e.prototype.getFunction=function(t){return WW.instance().getFunction(t)},e.prototype.registerFunction=function(t,e){t&&e&&WW.instance().registerFunction(t,e)},e.prototype.unregisterFunction=function(t){t&&WW.instance().unregisterFunction(t)},e.prototype.getFunctionList=function(){return WW.instance().getFunctionNameList()},e.prototype.setRuntimeSpec=function(t){this._spec=t,this._updateSpecInfo()},e.prototype.updateIndicatorDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.updateDatum(e)},e.prototype.updateIndicatorDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(L.indicator);n&&n[t]&&n[t].updateDatum(e)},e.prototype.geoZoomByIndex=function(t,e,i){void 0===t&&(t=0),this._geoZoomByQuery({regionIndex:t},e,i)},e.prototype.geoZoomById=function(t,e,i){this._geoZoomByQuery({regionId:t},e,i)},e.prototype._geoZoomByQuery=function(t,e,i){var n,r,a=null===(n=this._chart)||void 0===n?void 0:n.getRegionsInQuerier(t)[0],o=null===(r=this._chart)||void 0===r?void 0:r.getComponentsByType(L.geoCoordinate),s=null==o?void 0:o.find((function(t){var e;return null===(e=t.getRegions())||void 0===e?void 0:e.includes(a)}));s&&s.dispatchZoom(e,i)},e.prototype._initChartPlugin=function(){var t=ij.getChartPlugins();t.length>0&&(this._chartPlugin=new KW(this),this._chartPlugin.load(t.map((function(t){return new t}))),this._chartPluginApply("onInit",this._spec));var e=ij.getVChartPlugins();e.length>0&&(this._vChartPlugin=new bG(this),this._vChartPlugin.load(e.map((function(t){return new t}))),this._vChartPlugin.onInit())},e.prototype._chartPluginApply=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)},e.prototype._getMode=function(){return this._option.mode||t.RenderModeEnum["desktop-browser"]},e.prototype.isAnimationEnable=function(){return"animation"in this._option?!!this._option.animation:!1!==this._spec.animation},e.prototype._getChartOption=function(t){var e=this;return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:function(){return e._compiler},viewBox:this._viewBox,getTheme:this.getTheme,getSpecInfo:function(){var t;return null!==(t=e._specInfo)&&void 0!==t?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent}},e.InstanceManager=mj,e.ThemeManager=_j,e.globalConfig={uniqueTooltip:!0},e.Utils=VW,e.vglobal=tS,e}();ij.registerRegion("region",vW),ij.registerLayout("base",wW),jW(),uG(),gG(),_G(),pj(ZU.name,ZU);var kG="monotone",SG="linear",AG="bevel";function CG(t,e){return e("component",t)}function MG(t,e,i,n){if(t)return{formatFunc:t,args:[i,n]};var r=ij.getFormatter();return e&&r?{formatFunc:r,args:[i,n,e]}:{}}t.Direction=void 0,function(t){t.vertical="vertical",t.horizontal="horizontal"}(t.Direction||(t.Direction={}));var wG=function(t,e,i,n){if(!j(t[e])){var r=Z(t[e]),a=r?t[e]:[t[e]],o=[];return a.forEach((function(t,a){!t||n&&!n(t)||o.push({spec:t,specPath:r?[e,a]:[e],specInfoPath:["component",e,a],type:i})})),o}},TG=function(t,e){if(!e.from||!e.from())return t;var i,n=e.fields,r=e.key,a=e.values,o=e.default,s=e.as||[n],l=e.from().reduce((function(t,e){return e[n]&&t.set(e[n],e),t}),new Map);if(U(e.set))i=function(t){var i=l.get(t[r]);e.set(t,i)};else if(a){var u=a.length;i=function(t){var e=l.get(t[r]);if(j(e))for(var i=0;i<u;++i)t[s[i]]=o;else for(i=0;i<u;++i)t[s[i]]=e[a[i]]}}else i=function(t){var e=l.get(t[r]);t[s[0]]=W(e)?e:o};return 0===t.length?[]:t.map((function(t){return i(t),t}))},DG=function(t,e){var i=e.beforeCall();return t&&t.forEach((function(t,n){return e.call(t,n,i)})),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t},EG=function(t,e,i,n){var r;if(r=U(t)?t(e,i):X(t)&&W(t.field)?ht(e,t.field):t,n){var a=MG(void 0,n,t,e),o=a.formatFunc,s=a.args;o&&s&&(r=o.apply(void 0,P([],B(s),!1)))}return r},BG=function(t,e,i){return j(t)?t:U(t)?t(e,i):t};var PG=function(t,e){return!e||!1!==e.visible&&((!e[t]||!1!==e[t].visible)&&!(e.activeType&&!(Z(e.activeType)?e.activeType.includes(t):e.activeType===t)))};function RG(t,e,i,n,r,a){var o=function(e){if(e){var o={datum:r},s=j(e.key)&&j(e.value)&&!ct(e)?M(M(M({},n),i),e):M(M({},n),e),l=s.key,u=s.keyFormatter,c=s.keyTimeFormat,h=s.keyTimeFormatMode,d=s.value,p=s.valueFormatter,f=s.valueTimeFormat,v=s.valueTimeFormatMode,g=w(s,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);o.key=FG(EG(l,r,a,u),c,h),o.value=FG(EG(d,r,a,p),f,v),Object.keys(g).forEach((function(t){o[t]=EG(s[t],r,a)})),!1!==o.visible&&(W(o.key)||W(o.value))&&t.push(o)}};Z(e)?e.forEach((function(t){o(t)})):o(e)}function LG(t,e,i,n,r,a,o){U(e)?RG(t,e(r,o),i,n,a,o):e&&RG(t,e,i,n,a,o)}var IG,FG=function(t,e,i){if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;var n=Ea.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?n.timeFormat:n.timeUTCFormat)(e,t)},OG=function(){function t(t){var e=this;this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=function(){var t,i,n,r=e.series,a=r.getSeriesField();return{seriesFields:W(a)?Dt(a):null!==(t=r.getSeriesKeys())&&void 0!==t?t:[],dimensionFields:null!==(i=r.getDimensionField())&&void 0!==i?i:[],measureFields:null!==(n=r.getMeasureField())&&void 0!==n?n:[],type:r.type}},this._getDimensionData=function(t){var i=e._seriesCacheInfo.dimensionFields;return i[0]&&(null==t?void 0:t[i[0]])},this._getMeasureData=function(t){var i=e._seriesCacheInfo.measureFields;return i[0]&&(null==t?void 0:t[i[0]])},this._getSeriesFieldData=function(t){var i=e._seriesCacheInfo,n=i.dimensionFields,r=i.seriesFields;if(W(r[0])&&(null==t?void 0:t[r[0]]))return null==t?void 0:t[r[0]];var a=n[n.length-1];return n.length>1&&(0===r.length||e.series.getSeriesKeys().length),null==t?void 0:t[a]},this._getSeriesStyle=function(t,i,n){var r,a,o;try{for(var s=E(Dt(i)),l=s.next();!l.done;l=s.next()){var u=l.value,c=null===(o=e.series.getSeriesStyle(t))||void 0===o?void 0:o(u);if(W(c))return c}}catch(t){r={error:t}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return n},this.markTooltipKeyCallback=function(t,i){return e._getSeriesFieldData(t)},this.markTooltipValueCallback=function(t,i){return e._getMeasureData(t)},this.shapeTypeCallback=function(t,i){var n;return null!==(n=e._getSeriesStyle(t,"shape",null))&&void 0!==n?n:e._getSeriesStyle(t,"symbolType",e.series.getDefaultShapeType())},this.shapeColorCallback=function(t,i){return e._getSeriesStyle(t,["fill","stroke"])},this.shapeStrokeCallback=function(t,i){return e._getSeriesStyle(t,["stroke","fill"])},this.dimensionTooltipTitleCallback=function(t,i){return e._getDimensionData(t)},this.groupTooltipTitleCallback=function(t,i){return e._getSeriesFieldData(t)},this.groupTooltipKeyCallback=function(t,i){var n=e._seriesCacheInfo.seriesFields,r=e._seriesCacheInfo.dimensionFields;return n[0]&&(r=r.filter((function(t){return t!==n[0]}))),r.map((function(e){return null==t?void 0:t[e]})).join("-")},this.getHasShape=function(t){return!!t},this.series=t,this.updateTooltipSpec()}return t.prototype.updateTooltipSpec=function(){var t,e=null===(t=this.series.getSpec())||void 0===t?void 0:t.tooltip;this.spec=e,this._seriesCacheInfo=this._getSeriesCacheInfo()},t.prototype.getShapeAttrs=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v=e?"content":"title",g=M(M(M(M(M({},null===(n=null==i?void 0:i.style)||void 0===n?void 0:n.shape),null==i?void 0:i[t]),null===(r=null==i?void 0:i[t])||void 0===r?void 0:r[v]),null===(a=this.spec)||void 0===a?void 0:a[t]),null===(s=null===(o=this.spec)||void 0===o?void 0:o[t])||void 0===s?void 0:s[v]);return{shapeType:null!==(l=g.shapeType)&&void 0!==l?l:this.shapeTypeCallback,shapeFill:null!==(c=null!==(u=g.shapeFill)&&void 0!==u?u:g.shapeColor)&&void 0!==c?c:this.shapeColorCallback,shapeStroke:null!==(h=g.shapeStroke)&&void 0!==h?h:this.shapeStrokeCallback,shapeHollow:null!==(d=g.shapeHollow)&&void 0!==d&&d,shapeLineWidth:g.shapeLineWidth,shapeSize:null!==(p=g.shapeSize)&&void 0!==p?p:g.size,hasShape:null!==(f=g.hasShape)&&void 0!==f?f:this.getHasShape(e)}},t.prototype.enableByType=function(t){return!0},t.prototype.getDefaultContentList=function(t){return[this.getDefaultContentPattern(t)]},t.prototype.getContentList=function(t,e,i,n,r,a){var o;return function(t,e,i,n,r,a){if(r&&r.length){var o=[];return r.forEach((function(r){Z(t)?t.forEach((function(t){LG(o,t,e,i,n,r,a)})):U(t)?LG(o,t,e,i,n,r,a):t&&RG(o,t,e,i,r,a)})),o}return null}(null!==(o=null==e?void 0:e.content)&&void 0!==o?o:this.getDefaultContentList(t),this.getDefaultContentPattern(t),i,n,r,a)},t.prototype.getTitleResult=function(t,e,i,n,r){var a=U(e)?e(n,r):e;if(a?j(a.value)&&(a=M(M({},this.getDefaultTitlePattern(t)),a)):a=this.getDefaultTitlePattern(t),a&&!1!==a.visible){var o=function(t){var e,i,n,r,a,o,s,l=(null===(s=t[0])||void 0===s?void 0:s.series)?[{data:t,value:""}]:t;try{for(var u=E(l),c=u.next();!c.done;c=u.next()){var h=c.value.data;try{for(var d=(n=void 0,E(h)),p=d.next();!p.done;p=d.next()){var f=p.value.datum;try{for(var v=(a=void 0,E(null!=f?f:[])),g=v.next();!g.done;g=v.next()){var y=g.value;if(y)return y}}catch(t){a={error:t}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}}(n),s={visible:EG(a.visible,o,r),value:FG(EG(a.value,o,r,a.valueFormatter),a.valueTimeFormat,a.valueTimeFormatMode),valueStyle:EG(a.valueStyle,o,r),hasShape:a.hasShape};return Object.keys(i).forEach((function(t){s[t]=EG(i[t],o,r)})),s}return{hasShape:!1,visible:!1}},t.prototype.getTooltipData=function(t,e,i,n,r){var a,o;if(!(this.enableByType(t)&&PG(t,this.spec)&&("dimension"!==t||n&&n.length)))return null;var s,l=null!==(o=null===(a=this.spec)||void 0===a?void 0:a[t])&&void 0!==o?o:null==e?void 0:e[t],u=this.getShapeAttrs(t,!0,e),c=this.getShapeAttrs(t,!1,e);"dimension"===t?(s=[],this.getContentList(t,l,u,i,n,r).forEach((function(t){s.push(t)}))):s=this.getContentList(t,l,u,i,n,r);return{visible:!0,activeType:t,data:i,title:this.getTitleResult(t,null==l?void 0:l.title,c,i,r),content:s}},t.prototype.getDefaultTitlePattern=function(t){return{key:void 0,value:"group"===t?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}},t.prototype.getDefaultContentPattern=function(t){return{seriesId:this.series.id,key:"group"===t?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}},t}(),zG={min:function(t){return t.length?Pt(t.map((function(t){return 1*t}))):0},max:function(t){return t.length?Bt(t.map((function(t){return 1*t}))):0},"array-min":function(t){return t.length?Pt(t.map((function(t){return 1*t}))):0},"array-max":function(t){return t.length?Bt(t.map((function(t){return 1*t}))):0},values:function(t){var e,i,n={},r=[];try{for(var a=E(t),o=a.next();!o.done;o=a.next()){var s=o.value;n[s]||(r.push(s),n[s]=1)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return r}},HG=function(t,e){var i,n,r=e.fields;if(U(r)&&(r=r()),!(null==r?void 0:r.length)||!(null==t?void 0:t.length))return{};r=Qj([],r);var a="parser"===e.target?"parserData":"latestData",o=t[0][a]?t[0][a]:t||[],s=null===(n=(i=t[0]).getFields)||void 0===n?void 0:n.call(i);return NG(o,r,s)},NG=function(t,e,i){var n={},r=[],a=[];return e.forEach((function(e){var o=e.key;n[o]={};var s=null==i?void 0:i[o],l=e.operations,u=l.some((function(t){return"min"===t||"max"===t||"allValid"===t})),c=!0;r.length=0,t&&t.forEach((function(t){t&&r.push(t[o])}));var h=r.length;if(u){a.length=0,r.forEach((function(t,e){ZA(t)&&a.push(t)}));var d=r;r=a,a=d,c=r.length===h}else r=l.some((function(t){return"array-min"===t||"array-max"===t}))?r.reduce((function(t,e){return e&&e.forEach((function(e){ZA(e)&&t.push(e)})),t}),[]):r.filter((function(t){return void 0!==t}));e.filter&&(r=r.filter(e.filter)),l.forEach((function(t){if(e.customize)n[o][t]=e.customize;else{if(s&&!0===s.lockStatisticsByDomain&&!j(s.domain)){if("values"===t)return void(n[o][t]=s.domain.slice())}else if("allValid"===t)return;n[o][t]=zG[t](r),"array-max"===t&&(n[o].max=n[o][t]),"array-min"===t&&(n[o].min=n[o][t])}})),u&&(n[o].allValid=c)})),n},UG=function(t,e){var i=e.config;if(!i)return t;var n=i(),r=n.invalidType,a=n.checkField;return"zero"!==r||a&&a.length&&t.forEach((function(t){a.forEach((function(e){ZA(t[e])||(t[e]=0)}))})),t},jG="".concat(Mj,"_HIERARCHY_DEPTH"),VG="".concat(Mj,"_HIERARCHY_ROOT"),WG="".concat(Mj,"_HIERARCHY_ROOT_INDEX");function GG(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function YG(t,e,i){t&&(i.needDefaultSeriesField&&(t[Pj]=i.defaultSeriesField),t[Ej]=e,t[Bj]=i.getKey(t,e,i))}function XG(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function KG(t,e,i,n,r,a){void 0===n&&(n=0),void 0===a&&(a=e),YG(t,e,i),t[jG]=n,t[VG]=r||t[i.categoryField],t[WG]=a,t.children&&t.children.length&&t.children.forEach((function(e,n){return KG(e,n,i,t[jG]+1,t[VG],a)}))}var qG=((IG={}).label={name:"label",type:"text"},IG),ZG="".concat(Mj,"_rect_x"),JG="".concat(Mj,"_rect_x1"),QG="".concat(Mj,"_rect_y"),$G="".concat(Mj,"_rect_y1"),tY={data:!0},eY={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},iY=P(P([],B(Object.keys(JW)),!1),["normal"],!1);function nY(t,e,i){void 0===t&&(t={});for(var n={},r=function(r){var a,o=iY[r],s=e?e[o]:void 0;if(!1===s)return"continue";if("normal"===o)return s&&(n.normal=s),"continue";if("state"===o)return!1!==s&&(n.state=null!=s?s:JW.state),"continue";if("update"!==o&&!s&&!t[o])return"continue";if(a=Z(t[o])?t[o]:[M(M({},JW[o]),t[o])],"exit"===o&&a.forEach((function(t){t.controlOptions={stopWhenStateChange:!0}})),!s)return n[o]=a,"continue";var l=void 0;l=Z(s)?s.map((function(t,e){var n,r=t;return lY(r)&&delete r.type,r.oneByOne&&(r=aY(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:oY,null==i?void 0:i.dataCount)),r})):a.map((function(t,e){var n,r=ej({},a[e],s);return lY(r)&&delete r.type,r.oneByOne&&(r=aY(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:oY,null==i?void 0:i.dataCount)),r})),n[o]=l},a=0;a<iY.length;a++)r(a);return n}function rY(t,e,i){var n,r,a,o,s,l,u={};return W(e.animationAppear)&&(u.appear=null!==(n=e.animationAppear[t])&&void 0!==n?n:e.animationAppear),W(e.animationDisappear)&&(u.disappear=null!==(r=e.animationDisappear[t])&&void 0!==r?r:e.animationDisappear),W(e.animationEnter)&&(u.enter=null!==(a=e.animationEnter[t])&&void 0!==a?a:e.animationEnter),W(e.animationExit)&&(u.exit=null!==(o=e.animationExit[t])&&void 0!==o?o:e.animationExit),W(e.animationUpdate)&&(u.update=null!==(s=e.animationUpdate[t])&&void 0!==s?s:e.animationUpdate),W(e.animationState)&&(u.state=null!==(l=e.animationState[t])&&void 0!==l?l:e.animationState),e.animationNormal&&e.animationNormal[t]&&(u.normal=e.animationNormal[t]),function(t,e){if(!t)return t;var i=["custom","customParameters"];return t=ft(t,null,i),uY(t,(function(t){var i;if(U(t)&&(null===(i=t.prototype)||void 0===i?void 0:i.constructor)!==t){var n=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return t.apply(void 0,P(P([],B(i),!1),[e],!1))};return n}return t}),i),t}(u,i)}function aY(t,e,i){var n=t.oneByOne,r=t.duration,a=t.delay,o=t.delayAfter;return t.delay=function(t,i,o){var s=e(t,o),l=U(r)?r(t,i,o):it(r)?r:0,u=U(a)?a(t,i,o):it(a)?a:0,c=U(n)?n(t,i,o):n;return!1===c?u:u+s*(l+(c=!0===c?0:c))},t.delayAfter=function(t,a,s){var l=e(t,s),u=U(r)?r(t,a,s):it(r)?r:0,c=U(o)?o(t,a,s):it(o)?o:0,h=U(n)?n(t,a,s):n;return!1===h?c:c+((i?i():a.parent.count-1)-l)*(u+(h=!0===h?0:h))},delete t.oneByOne,t}function oY(t,e){var i;return null!==(i=null==t?void 0:t[Ej])&&void 0!==i?i:e.context.graphicIndex}function sY(t,e){var i,n,r,a,o;if(!1===t.animation)return!1;if(!1===(null===(i=t.morph)||void 0===i?void 0:i.enable))return!1;var s=!1!==(null!==(r=null===(n=t.animationAppear)||void 0===n?void 0:n[e])&&void 0!==r?r:t.animationAppear),l=!1!==(null!==(o=null===(a=t.animationUpdate)||void 0===a?void 0:a[e])&&void 0!==o?o:t.animationUpdate);return!(!s||!l)}function lY(t){return!function(t){return W(t.timeSlices)}(t)&&W(t.channel)}function uY(t,e,i){if(void 0===i&&(i=[]),Z(t))t.forEach((function(n,r){t[r]=e(t[r],r),uY(t[r],e,i)}));else if(G(t)&&"function"!=typeof t)for(var n in t)i.includes(n)||(t[n]=e(t[n],n),uY(t[n],e,i))}function cY(t){var e,i,n,r,a,o,s=t.getSpec();if(!1===s.animation)return!1;if(!1===(null===(i=null===(e=t.getOption())||void 0===e?void 0:e.globalInstance)||void 0===i?void 0:i.isAnimationEnable()))return!1;var l=null!==(n=s.animationThreshold)&&void 0!==n?n:Number.MAX_SAFE_INTEGER;return null===(r=t.getMarks())||void 0===r||r.forEach((function(t){var e=t.getMarkConfig();e&&(e.large&&e.largeThreshold&&(l=Math.min(l,e.largeThreshold)),e.progressiveThreshold&&(l=Math.min(l,e.progressiveThreshold)))})),!((null===(o=null===(a=t.getRawData())||void 0===a?void 0:a.latestData)||void 0===o?void 0:o.length)>=l)}var hY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markLabelSpec={},e}return C(e,t),e.prototype.getLabelSpec=function(t){return this.markLabelSpec[t]},e.prototype.setLabelSpec=function(t,e){this.markLabelSpec[t]=Dt(e)},e.prototype.addLabelSpec=function(t,e,i){void 0===i&&(i=!1),this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)},e.prototype.getTheme=function(t,e){var i,n,r,a=mU(t),o=null===(i=this._option)||void 0===i?void 0:i.getTheme,s=this._option.type,l=ij.getSeriesMarkMap(s)?function(t,e,i){var n=ij.getSeriesMarkMap(e);if(!n)return t;var r={};return Object.values(n).forEach((function(e){var n=e.type,a=e.name;r[a]=ej({},i("mark",Dt(n)[0]),i("markByName",a),null==t?void 0:t[a])})),M(M({},t),r)}(o("series",s),s,o):{},u=o("series","".concat(s,"_").concat(a));return ej({},l,u,(null!==(r=null!==(n=this.stack)&&void 0!==n?n:null==u?void 0:u.stack)&&void 0!==r?r:null==l?void 0:l.stack)?o("series","".concat(s,"_stack")):void 0)},e.prototype.transformSpec=function(e,i,n){this._transformStack(e);var r=t.prototype.transformSpec.call(this,e,i,n);return this._transformLabelSpec(r.spec),M(M({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})},e.prototype._transformLabelSpec=function(t){},e.prototype._transformStack=function(t){N(t.stack)&&(this.stack=t.stack),N(t.percent)&&(this.stack=t.percent||this.stack),j(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)},e.prototype._addMarkLabelSpec=function(t,e,i,n,r,a){var o=this;(void 0===i&&(i="label"),void 0===n&&(n="initLabelMarkStyle"),void 0===r&&(r=!0),t)&&Dt(t[i]).forEach((function(i){var s,l,u;if(i&&i.visible){var c=i.animation,h=void 0===c||c,d=i.animationUpdate,p=void 0===d||d,f=i.animationEnter,v=void 0===f||f,g=i.animationExit,y=void 0===g||g,m=t,_=m.animationUpdate,b=void 0===_||_,x=m.animationEnter,k=void 0===x||x,S=m.animationExit,A=void 0===S||S,C=!!(null!==(u=null!==(l=null===(s=o._option.globalInstance)||void 0===s?void 0:s.isAnimationEnable())&&void 0!==l?l:t.animation)&&void 0!==u?u:i.animation)&&!!r;o.addLabelSpec(U(e)?e(i):e,M(M({},i),{animation:!!C&&h,animationUpdate:!!(C&&b&&p)&&b,animationEnter:!!(C&&k&&v)&&k,animationExit:!!(C&&k&&y)&&A,getStyleHandler:function(t){var e;return null===(e=t[n])||void 0===e?void 0:e.bind(t)}}),a)}}))},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.outerRadius,a=e.innerRadius,o=e.direction;return W(r)&&(n.outerRadius=r),W(a)&&(n.innerRadius=a),W(o)&&(n.direction=o),Object.keys(n).length>0?n:void 0},e.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){var e=ej({},i,n,t),r=i.label;return r&&G(r)&&Z(e.label)&&(e.label=e.label.map((function(t){return ej({},r,t)}))),e};return Z(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},e}(cW);var dY=function(e){function i(i,n){var r,a=this;return(a=e.call(this,i,n)||this).specKey="series",a.type="series",a.layoutType="absolute",a.modelType="series",a.name=void 0,a.transformerConstructor=hY,a.coordinate="none",a._region=null,a._layoutStartPoint={x:0,y:0},a._layoutRect={width:null,height:null},a.getLayoutRect=function(){var t,e;return{width:null!==(t=a._layoutRect.width)&&void 0!==t?t:a._region.getLayoutRect().width,height:null!==(e=a._layoutRect.height)&&void 0!==e?e:a._region.getLayoutRect().height}},a._rootMark=null,a._seriesMark=null,a._viewDataMap=new Map,a._viewDataFilter=null,a._data=null,a.layoutZIndex=t.LayoutZIndex.SeriesGroup,a._invalidType="break",a._region=n.region,a._dataSet=n.dataSet,(null===(r=a._spec)||void 0===r?void 0:r.name)&&(a.name=a._spec.name),a}return C(i,e),i.prototype.getRegion=function(){return this._region},i.prototype.getLayoutStartPoint=function(){return this._region.getLayoutStartPoint()},i.prototype.getRootMark=function(){return this._rootMark},i.prototype.getSeriesMark=function(){return this._seriesMark},i.prototype.getRawData=function(){return this._rawData},i.prototype.getViewDataFilter=function(){return this._viewDataFilter},i.prototype.getViewData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.getViewDataProductId=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getProductId()},i.prototype.getViewDataStatistics=function(){return this._viewDataStatistics},i.prototype.getViewStackData=function(){return this._viewStackData},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){W(t)&&(this._seriesField=t)},i.prototype.getGroups=function(){return this._groups},i.prototype.getStack=function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.stack},i.prototype.getStackValue=function(){var t;return null!==(t=this._spec.stackValue)&&void 0!==t?t:"".concat(Mj,"_series_").concat(this.type)},i.prototype.getPercent=function(){return this._spec.percent},i.prototype.getStackOffsetSilhouette=function(){return this._spec.stackOffsetSilhouette},Object.defineProperty(i.prototype,"tooltipHelper",{get:function(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper},enumerable:!1,configurable:!0}),i.prototype.getInvalidType=function(){return this._invalidType},i.prototype.setInvalidType=function(t){var e;this._invalidType=t,null===(e=this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},i.prototype.created=function(){e.prototype.created.call(this),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(t.ChartEvent.afterInitData,{model:this}),this.initRootMark(),this.initMark();var i=cY(this);this._initExtensionMark({hasAnimation:i}),this.initMarkStyle(),this.initMarkState(),i&&(this.initAnimation(),this.initStageAnimation()),this.afterInitMark(),this.initEvent(),this.event.emit(t.ChartEvent.afterInitEvent,{model:this})},i.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},seriesColor:function(e){var i;return j(e)&&(e=t.getSeriesKeys()[0]),null===(i=t._option.globalScale.getScale("color"))||void 0===i?void 0:i.scale(e)},getRegion:function(){return t._region}}},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setSeriesField(this._spec.seriesField),W(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)},i.prototype.getInvalidCheckFields=function(){return[this.getStackValueField()]},i.prototype.initInvalidDataTransform=function(){var t,e,i=this;"zero"===this._invalidType&&(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(EV(this._rawData.dataSet,"invalidTravel",UG),null===(e=this._rawData)||void 0===e||e.transform({type:"invalidTravel",options:{config:function(){return{invalidType:i._invalidType,checkField:i.getInvalidCheckFields()}}}},!1))},i.prototype.initData=function(){var t,e,i,n=null!==(t=this._spec.data)&&void 0!==t?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(n&&(this._rawData=WV(n,this._dataSet,this._option.sourceDataList)),null===(i=null===(e=this._rawData)||void 0===e?void 0:e.target)||void 0===i||i.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=VV(this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewDataFilter")}));var r=VV(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewData")});this._data=new IW(this._option,r),this.getStack()&&this._viewDataFilter.target.removeListener("change",r.reRunAllTransform)}this.initInvalidDataTransform()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})},i.prototype.initStatisticalData=function(){this._data&&this._statisticViewData()},i.prototype.getRawDataStatisticsByField=function(t,e){var i,n,r;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&(j(this._rawStatisticsCache[t].min)||j(this._rawStatisticsCache[t].max))||!e&&j(this._rawStatisticsCache[t].values))if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){var a=null===(n=this._rawData.getFields())||void 0===n?void 0:n[t];if(a&&a.lockStatisticsByDomain&&a.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=Pt(a.domain),this._rawStatisticsCache[t].max=Bt(a.domain)):this._rawStatisticsCache[t].values=a.domain;else{var o=NG(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=mt(null!==(r=this._rawStatisticsCache[t])&&void 0!==r?r:{},o)}}return this._rawStatisticsCache[t]},i.prototype._statisticViewData=function(){var t=this;EV(this._dataSet,"dimensionStatistics",HG);var e="".concat(this.type,"_").concat(this.id,"_viewDataStatic");this._viewDataStatistics=new cc(this._dataSet,{name:e}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:function(){var e=t.getStatisticFields();return t._seriesField&&Qj(e,[{key:t._seriesField,operations:["values"]}]),e},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()},i.prototype.createStatisticalData=function(t,e,i){var n=this;EV(this._dataSet,"dimensionStatistics",HG);var r=new cc(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:function(){var t,r=Qj(n.getStatisticFields(),null!==(t=null==i?void 0:i(e.name))&&void 0!==t?t:[]);return n._seriesField&&Qj(r,[{key:n._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r},i.prototype.createdStackData=function(){var t="".concat(this.type,"_").concat(this.id,"_viewStackData");this._viewStackData=new cc(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.generateDefaultDataKey=function(t){var e,i=this;return j(t)?function(t,e,n){if(!1===i._spec.animation){var r=i._noAnimationDataKey(t,e);if(void 0!==r)return r}var a=n.keyMap,o=i._getSeriesDataKey(t);return void 0===a.get(o)?(a.set(o,0),o):(a.set(o,a.get(o)+1),"".concat(o,"_").concat(a.get(o)))}:q(t)?function(e){return e[t]}:Z(t)&&t.every((function(t){return q(t)}))?function(e){return t.map((function(t){return e[t]})).join("-")}:U(t)?function(e,i){return t(e,i)}:(null===(e=this._option)||void 0===e||e.onError("invalid dataKey: ".concat(t)),function(t,e){})},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(EV(this._rawData.dataSet,"addVChartProperty",DG),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:GG.bind(this),call:YG}},!1))},i.prototype.updateRawData=function(t){this._rawData&&this._rawData.updateRawData(t)},i.prototype.rawDataUpdate=function(e){var i;null===(i=this._rawDataStatistics)||void 0===i||i.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(t.ChartEvent.rawDataUpdate,{model:this})},i.prototype.viewDataFilterOver=function(e){this.event.emit(t.ChartEvent.viewDataFilterOver,{model:this})},i.prototype.viewDataUpdate=function(e){var i;this.event.emit(t.ChartEvent.viewDataUpdate,{model:this}),null===(i=this._data)||void 0===i||i.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()},i.prototype.viewDataStatisticsUpdate=function(e){this.event.emit(t.ChartEvent.viewDataStatisticsUpdate,{model:this})},i.prototype.getDatumPositionValue=function(t,e){return!t||j(e)?null:t[e]},i.prototype.getDatumPositionValues=function(t,e){return!t||j(e)?[]:q(e)?[t[e]]:e.map((function(e){return t[e]}))},i.prototype.setValueFieldToStack=function(){},i.prototype.setValueFieldToPercent=function(){},i.prototype.setValueFieldToStackOffsetSilhouette=function(){},i.prototype.initRootMark=function(){var t,e,i;this._rootMark=this._createMark({type:"group",name:"seriesGroup_".concat(this.type,"_").concat(this.id)},{parent:null===(e=(t=this._region).getGroupMark)||void 0===e?void 0:e.call(t),dataView:!1}),this._rootMark.setMarkConfig({zIndex:null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex})},i.prototype._getExtensionMarkNamePrefix=function(){return"".concat(this.type,"_").concat(this.id,"_extensionMark")},i.prototype._initExtensionMark=function(t){var e,i=this;this._spec.extensionMark&&(null===(e=this._spec.extensionMark)||void 0===e||e.forEach((function(e,n){i._createExtensionMark(e,null,i._getExtensionMarkNamePrefix(),n,t)})))},i.prototype._createExtensionMark=function(t,e,i,n,r){var a,o=this,s=this._createMark({type:t.type,name:W(t.name)?"".concat(t.name):"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,componentType:t.componentType,key:t.dataKey});if(s){if(W(t.id)&&s.setUserId(t.id),r.hasAnimation&&!1!==t.animation){var l=nY({},rY(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if("group"===t.type&&(i="".concat(i,"_").concat(n),null===(a=t.children)||void 0===a||a.forEach((function(t,e){o._createExtensionMark(t,s,i,e,r)}))),!j(t.dataId)||!j(t.dataIndex)){var u=this._option.getSeriesData(t.dataId,t.dataIndex);u===this._rawData?s.setData(this._data):(s.setDataView(u),u.target.addListener("change",(function(){s.getData().updateData()})))}}},i.prototype._updateExtensionMarkSpec=function(){var t,e=this;null===(t=this._spec.extensionMark)||void 0===t||t.forEach((function(t,i){var n=e._marks.getMarkWithInfo({name:W(t.name)?"".concat(t.name):"".concat(e._getExtensionMarkNamePrefix(),"_").concat(i)});n&&(e.initMarkStyleWithSpec(n,t),n.commit(!1,!0))}))},i.prototype.getStackData=function(){var t;return null===(t=this._viewStackData)||void 0===t?void 0:t.latestData},i.prototype._parseDefaultInteractionConfig=function(e){if(!(null==e?void 0:e.length))return[];var i,n=(i=this._option.mode)===t.RenderModeEnum["desktop-browser"]||i===t.RenderModeEnum["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:YA(i)||XA(i)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=M({},null==n?void 0:n.hover),a=M({},null==n?void 0:n.select),o=this._spec.hover;N(o)?r.enable=o:G(o)&&(r.enable=!0,r=ej(r,o));var s=this._spec.select;N(s)?a.enable=s:G(s)&&(a.enable=!0,a=ej(a,s));var l,u=[{trigger:{type:"dimension-hover"},marks:e}];r.enable&&((l=cG(r,e)).length&&u.push({trigger:this._defaultHoverConfig(r),marks:l}));a.enable&&((l=cG(a,e)).length&&u.push({trigger:this._defaultSelectConfig(a),marks:l}));return u},i.prototype._defaultHoverConfig=function(e){return{type:"element-highlight",trigger:e.trigger,triggerOff:e.triggerOff,blurState:t.STATE_VALUE_ENUM.STATE_HOVER_REVERSE,highlightState:t.STATE_VALUE_ENUM.STATE_HOVER}},i.prototype._defaultSelectConfig=function(e){var i="multiple"===e.mode,n=W(e.triggerOff)?e.triggerOff:i?["empty"]:["empty",e.trigger];return{type:"element-select",trigger:e.trigger,triggerOff:n,reverseState:t.STATE_VALUE_ENUM.STATE_SELECTED_REVERSE,state:t.STATE_VALUE_ENUM.STATE_SELECTED,isMultiple:i}},i.prototype._parseInteractionConfig=function(t){var e=this,i=this._spec.interactions,n=this._parseDefaultInteractionConfig(t);return i&&i.length&&i.forEach((function(t){var i=cG(t,e.getMarks());i.length&&n.push({trigger:t,marks:i})})),n},i.prototype.getInteractionTriggers=function(){if(!0!==this._option.disableTriggerEvent){var t=this.getMarksWithoutRoot();return this._parseInteractionConfig(t)}return[]},i.prototype.initAnimation=function(){},i.prototype.initStageAnimation=function(){var t=this._option.getCompiler();(null==t?void 0:t.setStageAnimationConfig)&&t.setStageAnimationConfig(nY({},rY("stage",this._spec,this._markAttributeContext),null))},i.prototype.initMarkState=function(){this.initSeriesStyleState()},i.prototype.initSeriesStyleState=function(){var e,i=this,n=this._spec.seriesStyle;if(n&&n.length){var r=null!==(e=this._seriesField)&&void 0!==e?e:Pj;this.getMarksWithoutRoot().forEach((function(e){var a={},o={},s={};n.forEach((function(t){var i,n=null===(i=t[e.name])||void 0===i?void 0:i.style;n&&(a[t.name]=!0,s[t.name]=s[t.name]||{},Object.keys(n).forEach((function(e){o[e]=!0,s[t.name][e]=n[e]})))})),e.state.addStateInfo({stateValue:Rj,level:-1,filter:function(t){return Array.isArray(t)?0!==t.length&&!0===a[t[0][r]]:!0===a[t[r]]}});var l={};Object.keys(o).forEach((function(t){l[t]=function(i){var n,a,o;if(Array.isArray(i)){if(0===i.length)return;o=null===(n=s[i[0][r]])||void 0===n?void 0:n[t]}return o=null===(a=s[i[r]])||void 0===a?void 0:a[t],W(o)?o:e.getAttribute(t,i)}})),i.setMarkStyle(e,l,Rj,t.AttributeLevel.User_SeriesStyle)}))}},i.prototype.afterInitMark=function(){var e=this;this.event.emit(t.ChartEvent.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach((function(i){var n,r;(null===(r=null===(n=i.stateStyle)||void 0===n?void 0:n.normal)||void 0===r?void 0:r.lineWidth)&&i.setAttribute("stroke",e.getColorAttribute(),"normal",t.AttributeLevel.Base_Series)}))},i.prototype.getMarksWithoutRoot=function(){return this.getMarks().filter((function(t){var e;return!(null===(e=t.name)||void 0===e?void 0:e.includes("seriesGroup"))}))},i.prototype.getMarksInType=function(t){return this._marks.getMarksInType(t)},i.prototype.getMarkInName=function(t){return this._marks.get(t)},i.prototype.getMarkInId=function(t){return this.getMarks().find((function(e){return e.id===t}))},i.prototype.initEvent=function(){var t,e,i;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.target.addListener("change",this.viewDataUpdate.bind(this)),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))},i.prototype._releaseEvent=function(){e.prototype._releaseEvent.call(this)},i.prototype.initTooltip=function(){this._tooltipHelper=new OG(this)},i.prototype._compareExtensionMarksSpec=function(t,e,i){t.length!==e.length||e.some((function(e,i){return e.type!==t[i].type||e.id!==t[i].id||e.name!==t[i].name}))?i.reMake=!0:e.some((function(e,i){return e.visible!==t[i].visible}))&&(i.reCompile=!0)},i.prototype._compareLabelSpec=function(t,e,i){t.length!==e.length||e.some((function(e,i){return e.labelLayout!==t[i].labelLayout||e.visible!==t[i].visible}))?i.reMake=!0:!i.reCompile&&e.some((function(e,i){return!St(e,t[i])}))&&(i.reCompile=!0)},i.prototype._compareSpec=function(t,i,n){var r=e.prototype._compareSpec.call(this,t,i),a=Object.keys(i||{}).sort();if(!St(a,Object.keys(t||{}).sort()))return r.reMake=!0,r;var o=M(M(M(M({},tY),eY),n),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec(Dt(t.extensionMark),Dt(i.extensionMark),r),!r.reMake&&this._compareLabelSpec(Dt(t.label),Dt(i.label),r),!r.reMake&&this._compareLabelSpec(Dt(t.totalLabel),Dt(i.totalLabel),r),r.reMake?r:(!r.reCompile&&this._marks.getMarks().some((function(e){var n,r;return o[e.name]=!0,(null===(n=i[e.name])||void 0===n?void 0:n.visible)!==(null===(r=t[e.name])||void 0===r?void 0:r.visible)}))&&(r.reCompile=!0),!r.reCompile&&a.some((function(e){return eY[e]&&!St(t[e],i[e])}))&&(r.reCompile=!0),a.some((function(e){return!o[e]&&!St(t[e],i[e])}))?(r.reMake=!0,r):r)},i.prototype._updateSpecData=function(){!this._rawData||!this._spec.data||this._spec.data instanceof cc||GV(this._rawData,this._spec.data,!0)},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t);var n=this.getMarksWithoutRoot();n.forEach((function(t){i._spec[t.name]&&i.initMarkStyleWithSpec(t,i._spec[t.name])})),this.initMarkStyle(),n.forEach((function(t){t.commit(!1)})),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),cY(this)&&this.initAnimation()},i.prototype.onEvaluateEnd=function(t){this._data.updateData()},i.prototype.release=function(){var t,i;e.prototype.release.call(this),this._viewDataMap.clear();var n=null===(i=null===(t=this._rawData)||void 0===t?void 0:t.transformsArr)||void 0===i?void 0:i.findIndex((function(t){return"addVChartProperty"===t.type}));n>=0&&this._rawData.transformsArr.splice(n,1),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null},i.prototype.setLayoutStartPosition=function(t){it(t.x)&&(this._layoutStartPoint.x=t.x),it(t.y)&&(this._layoutStartPoint.y=t.y)},i.prototype.setLayoutRect=function(t,e){var i=t.width,n=t.height;it(i)&&(this._layoutRect.width=i),it(n)&&(this._layoutRect.height=n)},i.prototype.getSeriesKeys=function(){var t,e;return this._seriesField?null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r;return null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0}},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:e,originalKey:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesInfoInField=function(t){var e,i;return this._getSeriesInfo(t,null!==(i=null===(e=this.getRawDataStatisticsByField(t))||void 0===e?void 0:e.values)&&void 0!==i?i:[])},i.prototype.getSeriesInfoList=function(){var t;return this._getSeriesInfo(null!==(t=this._seriesField)&&void 0!==t?t:Pj,this.getSeriesKeys())},i.prototype._getDefaultColorScale=function(){var t,e,i=this.getDefaultColorDomain(),n=this._getDataScheme();return null===(e=(t=(new DU).domain(i)).range)||void 0===e?void 0:e.call(t,n)},i.prototype._getDataScheme=function(){return xU(this.getColorScheme(),this.type)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesField?null===(e=null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesField])||void 0===e?void 0:e.values:[]},i.prototype.getColorAttribute=function(){var t,e;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(e=this._seriesField)&&void 0!==e?e:Pj}},i.prototype.getDimensionField=function(){return[]},i.prototype.getMeasureField=function(){return[]},i.prototype.onMarkPositionUpdate=function(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())},i.prototype.onMarkTreePositionUpdate=function(t){},i.prototype._createMark=function(t,i,n){var r,a,o,s,l;void 0===i&&(i={}),void 0===n&&(n={});var u=i.key,c=i.groupKey,h=i.skipBeforeLayouted,d=i.themeSpec,p=void 0===d?{}:d,f=i.markSpec,v=i.dataView,g=i.parent,y=i.isSeriesMark,m=i.noSeparateStyle,_=void 0!==m&&m,b=e.prototype._createMark.call(this,t,{key:null!=u?u:this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:i.componentType,noSeparateStyle:_,parent:!1!==g?null!=g?g:this._rootMark:null});if(W(b)){var x=this.getSpec()||{};this._marks.addMark(b,{name:t.name}),y&&(this._seriesMark=b),j(v)?b.setData(this._data):!1!==v&&b.setDataView(v),b.setSkipBeforeLayouted(!1!==h),j(c)||b.setGroupKey(c);var k=M(M({},n),{progressiveStep:x.progressiveStep,progressiveThreshold:x.progressiveThreshold,large:x.large,largeThreshold:x.largeThreshold,morph:null!==(r=n.morph)&&void 0!==r&&r,useSequentialAnimation:x.useSequentialAnimation,support3d:null!==(a=n.support3d)&&void 0!==a?a:x.support3d||!!x.zField,morphKey:(null===(o=x.morph)||void 0===o?void 0:o.morphKey)||"".concat(this.getSpecIndex(),"_").concat(this.getMarks().length),morphElementKey:null!==(l=null===(s=x.morph)||void 0===s?void 0:s.morphElementKey)&&void 0!==l?l:n.morphElementKey});b.setMarkConfig(k),this.initMarkStyleWithSpec(b,ej({},p,f||x[b.name]))}return b},i.prototype._getDataIdKey=function(){var t;return null!==(t=e.prototype._getDataIdKey.call(this))&&void 0!==t?t:Bj},i.prototype._getSeriesDataKey=function(t){var e="";if(!t)return e;var i=this.getDimensionField();e=i.map((function(e){return t[e]})).join("_");var n=this.getSeriesField();return n&&!i.includes(n)&&(e+="_".concat(t[n])),e},i.prototype.addViewDataFilter=function(t){var e,i;null===(i=null!==(e=this._viewDataFilter)&&void 0!==e?e:this.getViewData())||void 0===i||i.transform(t,!1)},i.prototype.reFilterViewData=function(){var t,e;null===(e=null!==(t=this._viewDataFilter)&&void 0!==t?t:this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.reTransformViewData=function(){var t,e;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.reRunAllTransform()},i.prototype.fillData=function(){var t;null===(t=this.getRawData())||void 0===t||t.reRunAllTransform()},i.prototype.compile=function(){this.compileData()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getFieldAlias=function(t){var e;return t!==Fj&&t!==zj&&t!==Ij&&t!==Oj||(t=this.getStackValueField()),null!==(e=tV(this.getRawData(),t))&&void 0!==e?e:t},i.prototype._getInvalidConnectType=function(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"},i.prototype._getInvalidDefined=function(t){var e=this.getInvalidCheckFields();return!e.length||e.every((function(e){return ZA(t[e])}))},i.prototype._getRelatedComponentSpecInfo=function(t){var e,i=this.getSpecIndex(),n=null===(e=this._option.getSpecInfo().component[t])||void 0===e?void 0:e.filter((function(t){return t.seriesIndexes.includes(i)}));return null!=n?n:[]},i.prototype._forEachStackGroup=function(t,e){var i,n,r=this;(e=null!=e?e:null===(i=this._viewStackData)||void 0===i?void 0:i.latestData)&&((null===(n=e.values)||void 0===n?void 0:n.length)?t(e):e.nodes&&Object.values(e.nodes).forEach((function(e){r._forEachStackGroup(t,e)})))},i.prototype.isDatumInViewData=function(t){if(!t)return!1;var e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some((function(e){return Object.keys(t).every((function(i){return t[i]===e[i]}))})))},i.prototype.getSeriesFieldValue=function(t,e){var i;return t[null!==(i=null!=e?e:this.getSeriesField())&&void 0!==i?i:Pj]},i.mark=qG,i.transformerConstructor=hY,i}(hW);function pY(e){return[t.SeriesTypeEnum.rose,t.SeriesTypeEnum.radar,t.SeriesTypeEnum.circularProgress].includes(e)}function fY(t,e,i){var n=t.getScale(0),r="isInverse"in t&&t.isInverse();tO(n.type)?i.sort((function(t,i){return(t[e]-i[e])*(r?-1:1)})):i.sort((function(t,i){return(n.index(t[e])-n.index(i[e]))*(r?-1:1)}))}function vY(t){return{dataIndex:function(e){var i,n,r="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],a=null==e?void 0:e[r],o="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!==(n=null===(i=null==o?void 0:o.domain)||void 0===i?void 0:i.call(o))&&void 0!==n?n:[]).indexOf(a)||0},dataCount:function(){var e,i,n,r="horizontal"===t.direction?t.scaleY:t.scaleX;return null!==(n=(null!==(i=null===(e=null==r?void 0:r.domain)||void 0===e?void 0:e.call(r))&&void 0!==i?i:[]).length)&&void 0!==n?n:0}}}var gY=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.coordinate="cartesian",t._bandPosition=.5,t._scaleConfig={bandPosition:t._bandPosition},t._direction="vertical",t._sortDataByAxis=!1,t._getPositionXEncoder=function(){var e;return null===(e=t._positionXEncoder)||void 0===e?void 0:e.bind(t)},t._setPositionXEncoder=function(e){t._positionXEncoder=e.bind(t)},t._getPositionYEncoder=function(){var e;return null===(e=t._positionYEncoder)||void 0===e?void 0:e.bind(t)},t._setPositionYEncoder=function(e){t._positionYEncoder=e.bind(t)},t}return C(i,e),i.prototype._buildScaleConfig=function(){this._scaleConfig={bandPosition:this._bandPosition}},Object.defineProperty(i.prototype,"fieldX",{get:function(){return this._fieldX},enumerable:!1,configurable:!0}),i.prototype.setFieldX=function(t){this._fieldX=Dt(t)},Object.defineProperty(i.prototype,"fieldY",{get:function(){return this._fieldY},enumerable:!1,configurable:!0}),i.prototype.setFieldY=function(t){this._fieldY=Dt(t)},Object.defineProperty(i.prototype,"fieldZ",{get:function(){return this._fieldZ},enumerable:!1,configurable:!0}),i.prototype.setFieldZ=function(t){this._fieldZ=t&&Dt(t)},Object.defineProperty(i.prototype,"fieldX2",{get:function(){return this._fieldX2},enumerable:!1,configurable:!0}),i.prototype.setFieldX2=function(t){this._fieldX2=t},Object.defineProperty(i.prototype,"fieldY2",{get:function(){return this._fieldY2},enumerable:!1,configurable:!0}),i.prototype.setFieldY2=function(t){this._fieldY2=t},Object.defineProperty(i.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:!1,configurable:!0}),i.prototype.setScaleX=function(t){this._scaleX=t},Object.defineProperty(i.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:!1,configurable:!0}),i.prototype.setScaleY=function(t){this._scaleY=t},Object.defineProperty(i.prototype,"scaleZ",{get:function(){return this._scaleZ},enumerable:!1,configurable:!0}),i.prototype.setScaleZ=function(t){this._scaleZ=t},i.prototype.getXAxisHelper=function(){return this._xAxisHelper},i.prototype.setXAxisHelper=function(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()},i.prototype.getYAxisHelper=function(){return this._yAxisHelper},i.prototype.setYAxisHelper=function(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()},i.prototype.getZAxisHelper=function(){return this._zAxisHelper},i.prototype.setZAxisHelper=function(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()},Object.defineProperty(i.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),i.prototype.getStatisticFields=function(){var t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?P(P([],B(this._fieldX),!1),[this._fieldX2],!1):this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?P(P([],B(this._fieldY),!1),[this._fieldY2],!1):this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach((function(e){e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach((function(i){var n={key:i,operations:[]},r=e.axisHelper.getScale(0);tO(r.type)?(n.operations=["max","min"],"log"===r.type&&(n.filter=function(t){return t>0})):n.operations=["values"],t.push(n)}))})),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t},i.prototype.getGroupFields=function(){return"vertical"===this.direction?this._fieldX:this._fieldY},i.prototype.getStackGroupFields=function(){return this.getGroupFields()},i.prototype.getStackValue=function(){var t,e,i=null===(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())||void 0===t?void 0:t.getAxisId();return null!==(e=this._spec.stackValue)&&void 0!==e?e:"".concat(Mj,"_series_").concat(this.type,"_").concat(i)},i.prototype.getStackValueField=function(){return"horizontal"===this.direction?Dt(this._spec.xField)[0]:Dt(this._spec.yField)[0]},i.prototype.setValueFieldToStack=function(){"horizontal"===this.direction?(this.setFieldX(Fj),this.setFieldX2(Ij)):(this.setFieldY(Fj),this.setFieldY2(Ij))},i.prototype.setValueFieldToPercent=function(){"horizontal"===this.direction?(this.setFieldX(zj),this.setFieldX2(Oj)):(this.setFieldY(zj),this.setFieldY2(Oj))},i.prototype.setValueFieldToStackOffsetSilhouette=function(){"horizontal"===this.direction?(this.setFieldX(Nj),this.setFieldX2(Hj)):(this.setFieldY(Nj),this.setFieldY2(Hj))},i.prototype.onXAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.onYAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.onZAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=Dt(this._spec.xField),this._specYField=Dt(this._spec.yField),W(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null===(t=this._spec)||void 0===t?void 0:t.x2Field),this.setFieldY2(null===(i=this._spec)||void 0===i?void 0:i.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),W(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},i.prototype.dataToPosition=function(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null},i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=function(e){var i,n,r;return void 0===e&&(e=0),null!==(r=null===(n=(i=t.getXAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,e))&&void 0!==r?r:0},this._markAttributeContext.yBandwidth=function(e){var i,n,r;return void 0===e&&(e=0),null!==(r=null===(n=(i=t.getYAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,e))&&void 0!==r?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)},i.prototype.valueToPosition=function(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}},i.prototype._axisPosition=function(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(Dt(e),this._scaleConfig)},i.prototype.valueToPositionX=function(t,e){return this._axisPosition(this._xAxisHelper,t,e)},i.prototype.valueToPositionY=function(t,e){return this._axisPosition(this._yAxisHelper,t,e)},i.prototype._dataToPosition=function(t,e,i,n,r,a){var o=this,s=r();if(s)return s(t);if(!e)return a((function(t){return Number.NaN})),Number.NaN;var l=(e.getFields?e.getFields():i).slice(0,n);return l&&0!==l.length?(e.isContinuous?a((function(t){return o._scaleConfig.datum=t,e.valueToPosition(o.getDatumPositionValue(t,l[0]),o._scaleConfig)})):a((function(t){return o._scaleConfig.datum=t,e.dataToPosition(Dt(o.getDatumPositionValues(t,l)),o._scaleConfig)})),r()(t)):(a((function(t){return null})),null)},i.prototype.dataToPositionX=function(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)},i.prototype.dataToPositionY=function(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)},i.prototype.dataToPositionZ=function(t){return this._zAxisHelper?(0,this._zAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionX1=function(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN},i.prototype.dataToPositionY1=function(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN},i.prototype.positionToData=function(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null},i.prototype.positionToDataX=function(t){return this._scaleX?this._scaleX.invert(t):null},i.prototype.positionToDataY=function(t){return this._scaleY?this._scaleY.invert(t):null},i.prototype.getRegionRectLeft=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[0]:Number.NaN},i.prototype.getRegionRectRight=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[1]:Number.NaN},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()},i.prototype.getDimensionField=function(){return"horizontal"===this._direction?this._specYField:this._specXField},i.prototype.getDimensionContinuousField=function(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]},i.prototype.getMeasureField=function(){return"horizontal"===this._direction?this._specXField:this._specYField},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.sortDataByAxis&&this.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e;return t.model.id===(null===(e="horizontal"===i._direction?i._yAxisHelper:i._xAxisHelper)||void 0===e?void 0:e.getAxisId())}},(function(){i._sortDataInAxisDomain()}))},i.prototype._sortDataInAxisDomain=function(){var t,e,i;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&(fY("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null===(i=this._data)||void 0===i||i.updateData(!0))},i.prototype.getInvalidCheckFields=function(){var t=[];this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==L.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach((function(e){t.push(e)}));this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==L.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach((function(e){t.push(e)}));return t},i.prototype.reInit=function(t){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),e.prototype.reInit.call(this,t)},i}(dY);function yY(t){return"bottom"===t||"top"===t}function mY(t){return"left"===t||"right"===t}function _Y(t){return"z"===t}function bY(t,e){return FU(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function xY(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function kY(t,e){var i,n=null!==(i=t.type)&&void 0!==i?i:function(t,e){return e?yY(t)?"linear":"band":yY(t)?"band":"linear"}(t.orient,e);return{axisType:n,componentName:"".concat(L.cartesianAxis,"-").concat(n)}}var SY,AY,CY=function(t,e,i){var n,r=null!==(n="band"===e?CG("axisBand",i):["linear","log","symlog"].includes(e)?CG("axisLinear",i):{})&&void 0!==n?n:{},a=yY(t)?CG("axisX",i):mY(t)?CG("axisY",i):CG("axisZ",i);return ej({},CG("axis",i),r,a)},MY=function(){function t(t,e){this._eventDispatcher=t,this._mode=e}return Object.defineProperty(t.prototype,"chart",{get:function(){var t,e;return this._chart||(this._chart=null===(e=(t=this._eventDispatcher.globalInstance).getChart)||void 0===e?void 0:e.call(t)),this._chart},enumerable:!1,configurable:!0}),t.prototype.register=function(t,e){var i,n;(null!==(n=null===(i=this.chart)||void 0===i?void 0:i.getOption().onError)&&void 0!==n?n:UA)("Method not implemented.")},t.prototype.unregister=function(){var t,e;(null!==(e=null===(t=this.chart)||void 0===t?void 0:t.getOption().onError)&&void 0!==e?e:UA)("Method not implemented.")},t.prototype.getTargetDimensionInfo=function(t,e){var i,n,r,a=null!==(r=null===(n=(i=this.chart.getModelOption()).getDimensionInfo)||void 0===n?void 0:n.call(i,this.chart,{x:t,y:e}))&&void 0!==r?r:[];return 0===a.length?null:a},t.prototype.dispatch=function(t,e){var i,n,r=null===(i=this.chart)||void 0===i?void 0:i.getAllComponents().filter((function(t){return"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))})),a=r.filter((function(t){return iO(t.getScale().type)})),o=a.length?a:r.filter((function(t){var e=t.getOrient();return yY(e)||"angle"===e})),s=[],l=null===(n=this.chart)||void 0===n?void 0:n.getModelOption().getDimensionInfoByValue;return l&&o.forEach((function(e){var i=l(e,t);i&&s.push(i)})),this._callback.call(null,{action:"enter",dimensionInfo:s}),s},t}(),wY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(t){if(t){var i=t.event.viewX,n=t.event.viewY,r=e.getTargetDimensionInfo(i,n);r&&e._callback.call(null,M(M({},t),{action:"click",dimensionInfo:r.slice()}))}},e}return C(e,t),e.prototype.register=function(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:M(M({},e.query),{source:SV.chart}),callback:this.onClick})},e.prototype.unregister=function(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})},e}(MY),TY=function(t,e){var i,n;return t===e||!j(t)&&!j(e)&&(t.value===e.value&&(null===(i=t.axis)||void 0===i?void 0:i.id)===(null===(n=e.axis)||void 0===n?void 0:n.id))},DY=function(t,e,i,n){var r,a,o,s=e.getScale(),l=iO(s.type),u=[],c=e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes),h=function(r){if(r.coordinate===i){var a=Dt(n(r)),c=null===(o=r.getViewData())||void 0===o?void 0:o.latestData;if(a&&c)if(l){var h=[],d=[];c.forEach((function(e,i){var n;(null===(n=e[a[0]])||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())&&(h.push(e),d.push(i))})),u.push({series:r,datum:h,key:EY(r,d)})}else if(W(a[1])){var p=[],f=[];c.forEach((function(e,i){var n;((null===(n=e[a[0]])||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())||W(e[a[0]])&&W(e[a[1]])&&t>=e[a[0]]&&t<e[a[1]])&&(p.push(e),f.push(i))})),u.push({series:r,datum:p,key:EY(r,f)})}else{var v=function(t,e){var i=t.tooltipFilterRange,n="function"==typeof i?i({scale:e}):i;return it(n)?[-n,n]:n}(e.getSpec(),s),g=[],y=[];if(v)c.forEach((function(e,i){if(W(e[a[0]])){var n=e[a[0]]-t;n>=v[0]&&n<=v[1]&&(g.push(e),y.push(i))}}));else{var m=1/0,_=0;c.forEach((function(e,i){if(W(e[a[0]])){var n=Math.abs(e[a[0]]-t),r=Math.sign(e[a[0]]-t);n<m?(m=n,g=[e],y=[i],_=r):n===m&&r===_&&(g.push(e),y.push(i))}}))}u.push({series:r,datum:g,key:EY(r,y)})}}};try{for(var d=E(c),p=d.next();!p.done;p=d.next()){h(p.value)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}return u},EY=function(t,e){return"".concat(t.id,"_").concat(e.join("_"))},BY=function(t,e,i){var n=t.getAllComponents().filter((function(n){return"axes"===n.specKey&&e(n)&&function(t,e,i){var n=t.getRegionsInIds(Dt(e.layout.layoutBindRegionID));return null==n?void 0:n.some((function(t){var e=t.getLayoutRect(),n=t.getLayoutStartPoint();return function(t,e,i){return t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y}(i,{x:n.x,y:n.y},{x:e.width+n.x,y:e.height+n.y})}))}(t,n,i)}));return n.length?n:null},PY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cacheDimensionInfo=null,e.onMouseMove=function(t){if(t){var i=t.event.viewX,n=t.event.viewY,r=e.getTargetDimensionInfo(i,n);null===r&&null!==e._cacheDimensionInfo?(e._callback.call(null,M(M({},t),{action:"leave",dimensionInfo:e._cacheDimensionInfo.slice()})),e._cacheDimensionInfo=r):null===r||null!==e._cacheDimensionInfo&&r.length===e._cacheDimensionInfo.length&&!r.some((function(t,i){return!TY(t,e._cacheDimensionInfo[i])}))?null!==r&&e._callback.call(null,M(M({},t),{action:"move",dimensionInfo:r.slice()})):(e._callback.call(null,M(M({},t),{action:"enter",dimensionInfo:r.slice()})),e._cacheDimensionInfo=r)}},e.onMouseOut=function(t){t&&(e._callback.call(null,M(M({},t),{action:"leave",dimensionInfo:e._cacheDimensionInfo?e._cacheDimensionInfo.slice():[]})),e._cacheDimensionInfo=null)},e}return C(e,t),e.prototype.register=function(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:M(M({},e.query),{source:SV.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:M(M({},e.query),{source:SV.canvas}),callback:this.onMouseOut}),YA(this._mode)&&this._eventDispatcher.register("pointerdown",{query:M(M({},e.query),{source:SV.chart}),callback:this.onMouseMove})},e.prototype.unregister=function(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),YA(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})},e}(MY);t.DimensionEventEnum=void 0,(SY=t.DimensionEventEnum||(t.DimensionEventEnum={})).dimensionHover="dimensionHover",SY.dimensionClick="dimensionClick";var RY=((AY={}).point={name:"point",type:"symbol"},AY.line={name:"line",type:"line"},AY),LY=function(){function e(){}return e.prototype.addSamplingCompile=function(){if(this._spec.sampling){var t=this._region.getLayoutRect(),e=t.width,i=t.height,n=this._fieldY,r=this._fieldX;this._data&&this._data.setTransform([{type:"dataSampling",size:"horizontal"===this._direction?i:e,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:n[0],groupBy:this._seriesField,mode:this._spec.sampling}])}},e.prototype.addOverlapCompile=function(){var t;if(this._spec.markOverlap){var e=[];e.push({type:"symbolOverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null===(t=this._symbolMark)||void 0===t||t.setTransform(e)}},e.prototype.reCompileSampling=function(){this._spec.sampling&&this.compile()},e.prototype.initLineMark=function(t){return this._lineMark=this._createMark(RY.line,{groupKey:this._seriesField,isSeriesMark:null==t||t},{morphElementKey:this.getDimensionField()[0]}),this._lineMark},e.prototype.initLineMarkStyle=function(e,i){var n,r,a=this,o=this._lineMark;if(o){if(this.setMarkStyle(o,{stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(o,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===a}},(function(){a.encodeDefined(o,"defined")})),"polar"===this.coordinate)this.setMarkStyle(o,{lineJoin:AG,curveType:SG,closePath:!0},"normal",t.AttributeLevel.Series);else{var s=null!=i?i:null===(r=null===(n=this.getSpec().line)||void 0===n?void 0:n.style)||void 0===r?void 0:r.curveType,l=s===kG?"horizontal"===e?"monotoneY":"monotoneX":s;this.setMarkStyle(o,{curveType:l},"normal",t.AttributeLevel.Built_In)}this.setMarkStyle(o,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series)}return o},e.prototype._getEventElement=function(t,e){var i=this,n=[];return t.dimensionInfo.some((function(t){return t.data.some((function(t){return t.series===i&&(n=t.datum,!0)})),!n.length})),n},e.prototype._dimensionTrigger=function(t){var e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}},e.prototype.initSymbolMark=function(t){if(!1!==(this._spec.point||{}).visible&&(this._symbolMark=this._createMark(RY.point,{groupKey:this._seriesField,isSeriesMark:!!t},{morph:sY(this._spec,RY.point.name),morphElementKey:this.getDimensionField()[0]})),!0===this._spec.activePoint){var e=new cc(this._option.dataSet,{name:"".concat(Mj,"_series_").concat(this.id,"_active_point")});e.parse([]),this._symbolActiveMark=this._createMark({name:"active_point_".concat(this.id),type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:e,parent:this._region.getInteractionMark()},{morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark},e.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;if(!e)return this._initSymbolActiveMarkAlone(),e;if(this._initSymbolMark(e),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(var i in this._symbolActiveMark.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(var n in this._symbolActiveMark.stateStyle[i]={},this._symbolMark.stateStyle[i])"visible"!==n&&(this._symbolActiveMark.stateStyle[i][n]={style:null,level:t.AttributeLevel.Series,referer:e});this._symbolActiveMark.state.changeStateInfo({stateValue:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,filter:function(){return!0}})}return e},e.prototype._initSymbolMark=function(e){var i=this;e&&(this.setMarkStyle(e,{fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),this.setMarkStyle(e,{x:function(t){return"zero"===i._invalidType||i._getInvalidDefined(t)?i.dataToPositionX(t):Number.NaN},y:function(t){return"zero"===i._invalidType||i._getInvalidDefined(t)?i.dataToPositionY(t):Number.NaN},z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series))},e.prototype._initSymbolActiveMarkAlone=function(){var e,i,n=this._symbolActiveMark;n&&(this._initSymbolMark(n),n&&(null===(i=null===(e=this._spec[RY.point.name])||void 0===e?void 0:e.state)||void 0===i?void 0:i.dimension_hover)&&(n.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(n,ej({},this._spec[RY.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,filter:function(){return!0}})))},e.prototype.initLabelMarkStyle=function(e){var i,n=this;e&&("symbol"!==(null===(i=e.getTarget())||void 0===i?void 0:i.type)&&e.setRule("line-data"),this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[n.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===n}},(function(){n.encodeDefined(e,"visible")})))},e.prototype.initLineLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){var i;return null!==(i=t[e.getSeriesField()])&&void 0!==i?i:e.getSeriesKeys()[0]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},e.prototype.encodeDefined=function(e,i){var n,r,a,o,s,l;if(e){var u=this._isFieldAllValid();if("zero"===this._invalidType||u){if(!0===(null===(o=null===(a=e.stateStyle.normal)||void 0===a?void 0:a[i])||void 0===o?void 0:o.style))return;this.setMarkStyle(e,((n={})[i]=!0,n),"normal",t.AttributeLevel.Series)}else{if(!0!==(null===(l=null===(s=e.stateStyle.normal)||void 0===s?void 0:s[i])||void 0===l?void 0:l.style))return;this.setMarkStyle(e,((r={})[i]=this._getInvalidDefined.bind(this),r),"normal",t.AttributeLevel.Series)}e.compileEncode()}},e.prototype._isFieldAllValid=function(){var t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&(t.latestData[e]&&t.latestData[e].allValid)},e}(),IY=M(M({},qG),RY),FY=function(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(q(t))return!1;if(Z(t))return t.length===e.length&&t.every((function(t,i){return FY(t,e[i])}));if(t.gradient!==e.gradient)return!1;var i=Object.keys(t),n=Object.keys(e);return i.length===n.length&&i.every((function(i){return"stops"===i?function(t,e){var i,n;if(t===e)return!0;var r=null!==(i=t&&t.length)&&void 0!==i?i:0;return r===(null!==(n=e&&e.length)&&void 0!==n?n:0)&&0!==r&&t.every((function(t,i){return!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset}))}(t[i],e[i]):t[i]===e[i]}))},OY=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"],zY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._segmentStyleKeys=[],e._isValidPointChannel=function(t){return["x","y","defined"].includes(t)},e}return C(e,t),e.prototype._getSegmentAttributes=function(){return OY},e.prototype.initStyleWithSpec=function(e){this._segmentStyleKeys=[],t.prototype.initStyleWithSpec.call(this,e)},e.prototype.setStyle=function(t,e,i){var n=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),!j(t)){void 0===this.stateStyle[e]&&(this.stateStyle[e]={});var r=this._getIgnoreAttributes(),a=this._getSegmentAttributes(),o=this.isUserLevel(i);Object.keys(t).forEach((function(s){var l=t[s];if(!j(l)&&!r.includes(s)){o&&a.includes(s)&&(eO(null==l?void 0:l.type)||(null==l?void 0:l.scale)||U(l))&&(n._segmentStyleKeys.includes(s)||n._segmentStyleKeys.push(s));var u=n._filterAttribute(s,l,e,i,o);n.setAttribute(s,u,e,i)}}))}},e.prototype._getLineSegments=function(t,e){var i=this;if(!this._segmentStyleKeys||!this._segmentStyleKeys.length)return null;var n=[],r=null;return t.forEach((function(t,e){r&&i._segmentStyleKeys.every((function(e){return function(t,e,i){return!(!j(t)||!j(e))||!j(t)&&!j(e)&&("lineDash"===i?function(t,e){return t.length===e.length&&t.join("-")===e.join("-")}(t,e):"stroke"===i||"fill"===i?FY(t,e):t===e)}(r[e],t[e],e)}))||(n.length&&(n[n.length-1].endIndex=e),r=t,n.push({attrs:r,startIndex:e}))})),n.length>=2?n.map((function(t){return M(M({},t.attrs),{points:e.slice(t.startIndex,j(t.endIndex)?e.length:t.endIndex)})})):null},e.prototype._getPrevPoints=function(t){var e=t.attribute,i=e.points,n=e.segments;return null!=i?i:n?n.reduce((function(t,e){return e.points&&e.points.forEach((function(e){t.push(e)})),t}),[]):null},e.prototype._runPointsEncoder=function(t,e,i){var n,r,a,o,s=this,l=e.context.data,u=[],c=[],h={},d=null===(n=this.renderContext)||void 0===n?void 0:n.progressive,p=d&&0===d.currentIndex;return l.forEach((function(e,i){var n;c[i]={},u[i]={},Object.keys(t).forEach((function(n){s._isValidPointChannel(n)?c[i][n]=t[n](e):s._segmentStyleKeys.includes(n)&&!d?u[i][n]=t[n](e):0!==i||d&&!p||(h[n]=t[n](e))})),c[i].context=null!==(n=s._keyGetter(e))&&void 0!==n?n:i})),d?((o=null!==(a=null===(r=e.attribute)||void 0===r?void 0:r.segments)&&void 0!==a?a:[]).push({points:c}),p?M(M({},h),{segments:o}):{segments:o}):this._segmentStyleKeys&&this._segmentStyleKeys.length&&(o=this._getLineSegments(u,c))?M(M(M({},h),u[0]),{segments:o,points:null}):M(M(M({},h),u[0]),{points:c,segments:null})},e.prototype._runEncoderOfGraphic=function(e,i,n){void 0===n&&(n={});var r=i.context.data;return e&&Object.keys(e).some(this._isValidPointChannel)&&r&&r.length?this._runPointsEncoder(e,i,n):t.prototype._runEncoderOfGraphic.call(this,e,i,n)},e.prototype._getDataByKey=function(t){return this._dataByGroup},e.prototype._runProgressiveJoin=function(){var t,e=this,i=this.renderContext.progressive.currentIndex,n=[];this._dataByGroup.keys.forEach((function(t,r){var a=e.renderContext.progressive.groupedData.get(t),o=e.renderContext.progressive.step,s=a.slice(i*o,(i+1)*o);if(0===i){var l={context:M(M({},e._getCommonContext()),{diffState:AW.enter,data:s,uniqueKey:t,key:t,groupKey:t})};n.push(l)}else{(l=e._graphics[r]).context.data=s}}));var r=0===i?n:this._graphics;return{graphicsByGroup:(t={},t[Bj]=r,t),graphics:r,needUpdate:!1}},e.prototype._setCommonAttributesToTheme=function(t){},e.prototype._addProgressiveGraphic=function(t,e){e.incremental=1,t.appendChild(e)},e}(NW),HY=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return C(i,e),i.prototype._getDefaultStyle=function(){return M(M({},e.prototype._getDefaultStyle.call(this)),{lineWidth:1})},i.prototype._getIgnoreAttributes=function(){var e,i;return(null===(e=this.model)||void 0===e?void 0:e.type)===t.SeriesTypeEnum.radar&&"polar"===(null===(i=this.model)||void 0===i?void 0:i.coordinate)?[]:["fill","fillOpacity"]},i.type="line",i}(zY),NY=function(){ij.registerMark(HY.type,HY),cP(),ZB(),Xz(),jz(),oG(),ij.registerGraphicComponent("line",jm)},UY=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})},e.prototype._transformGraphicAttributes=function(e,i,n){var r,a,o,s=t.prototype._transformGraphicAttributes.call(this,e,i,n),l=null!==(a=null!==(r=s.shape)&&void 0!==r?r:s.symbolType)&&void 0!==a?a:null===(o=e.attribute)||void 0===o?void 0:o.symbolType;return j(l)?s.symbolType="circle":s.symbolType=l,s},e.type="symbol",e}(NW),jY=function(){ij.registerMark(UY.type,UY),cP(),dP(),jz(),ij.registerGraphicComponent("symbol",Hm)},VY=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n;!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)},e}(hY);function WY(t){return t.length>=2&&it(t[0])&&it(Et(t))&&Et(t)>=t[0]}function GY(t,e){var i,n=Et(e)-e[0],r=Et(e)*e[0]<0,a=e[0]<=0?0-e[0]:0,o=Et(e)>0?Et(e)-0:0;0===n?e[0]<0?(a=1,o=0):e[0]>0&&(a=0,o=1):(a/=n,o/=n);var s=t.getDomainSpec(),l={total:n,negative:a,positive:o,includeZero:r,domain:e,extendable_min:!it(s.min),extendable_max:!it(s.max)};if(null===(i=t._break)||void 0===i?void 0:i.scope){var u=e.findIndex((function(t){return t>=0})),c=void 0,h=void 0;0===u?(c=t._break.scope[u],h=[e[0],e[1]],l.positive=1,l.negative=0):Et(e)<=0?(l.positive=0,l.negative=1,h=[e[e.length-2],e[e.length-1]]):(c=t._break.scope[u-1],h=[e[u-1],e[u]],l.negative=c[0]+(0-h[0])/(h[1]-h[0])*(c[1]-c[0]),l.positive=1-l.negative),l.break=!0,l.extendable_max=!1,l.extendable_min=!1,l.domain=h}return l}function YY(t,e){var i=t.positive,n=t.negative,r=t.extendable_min,a=t.extendable_max,o=t.domain,s=e.positive,l=e.negative,u=e.extendable_min,c=e.extendable_max,h=e.domain;if(s>0){if(!u)return!1;var d=n/i;a&&(d=n/Math.max(i,s),o[1]=-o[0]/d),h[0]=-h[1]*d}else if(l>0){if(!c)return!1;d=i/n;r&&(d=i/Math.max(n,n),o[0]=-o[1]/d),h[1]=-h[0]*d}return!0}function XY(t,e){var i=t.extendable_min,n=t.extendable_max,r=t.domain,a=e.positive,o=e.negative,s=e.domain;return(0!==a||0!==o)&&(!(a>0&&!n)&&(!(o>0&&!i)&&(r[0]=s[0],r[1]=s[1],!0)))}function KY(t,e){var i=t.positive,n=t.negative,r=t.extendable_max,a=t.domain,o=e.positive,s=e.negative,l=e.extendable_min,u=e.domain;if(r&&l){var c=Math.max(n,s)/Math.max(i,o);a[1]=-a[0]/c,u[0]=-u[1]*c}else if(l){c=n/i;u[0]=-u[1]*c}else{if(!r)return!1;c=s/o;a[1]=-a[0]/c}return!0}function qY(t,e){var i=t.extendable_min,n=t.domain,r=e.extendable_max,a=e.domain;return!(!i||!r)&&(n[0]=-n[1],a[1]=-a[0],!0)}var ZY=function(t,e){var i,n,r,a,o;if(!t)return t;var s=null===(i=null==e?void 0:e.targetAxis)||void 0===i?void 0:i.call(e);if(!s)return t;var l=null===(n=null==e?void 0:e.currentAxis)||void 0===n?void 0:n.call(e);if(!l)return t;var u=null===(r=l.getTickData())||void 0===r?void 0:r.getDataView();if(!u)return t;if(!u.transformsArr.find((function(t){return t.type.includes("ticks")})))return t;var c=l.getScale();if(!c)return t;var h=null===(o=null===(a=s.getTickData())||void 0===a?void 0:a.getDataView())||void 0===o?void 0:o.latestData;if(!(null==h?void 0:h.length))return t;var d=s.getScale();if(!d)return t;var p=d.domain(),f=Et(p)-p[0];if(0===f)return t;var v=c.domain(),g=Et(v)-v[0];if(0===f)return t;var y=h.map((function(t){return function(t,e,i,n,r){var a=xi(t,e),o=Math.max(_i(i),_i(a));return r*(Math.round(a*Math.pow(10,o))/Math.round(i*Math.pow(10,o)))+n}(t.value,p[0],f,v[0],g)}));return qF(y)},JY=function(){function t(t){this.id=qA(),this.name="".concat(t,"_").concat(this.id)}return t.prototype.onAdd=function(t){this.service=t},t.prototype.release=function(){this.service=null},t}(),QY=function(e){function i(){var t=e.call(this,i.type)||this;return t.type="AxisSyncPlugin",t}return C(i,e),i.prototype._checkEnableSync=function(t){if(!tO(t.getScale().type))return!1;var e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e},i.prototype._getTargetAxis=function(t,e){var i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null},i.prototype.onInit=function(e,i){var n=this._checkEnableSync(i);if(n&&n.zeroAlign){var r=this._getTargetAxis(i,n);r&&i.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e=t.model;return e.id===i.id||e.id===r.id}},(function(){!function(t,e){var i,n,r,a,o,s,l=t.getScale(),u=e.getScale();if(l&&u){var c=null!==(r=null===(n=(i=t).getDomainAfterSpec)||void 0===n?void 0:n.call(i))&&void 0!==r?r:[0,1],h=null!==(s=null===(o=(a=e).getDomainAfterSpec)||void 0===o?void 0:o.call(a))&&void 0!==s?s:[0,1];if(c&&h&&WY(c)&&WY(h)){var d=GY(t,c),p=GY(e,h);if(!0!==d.break||!0!==p.break){var f=d.positive,v=d.negative,g=d.extendable_min,y=d.extendable_max,m=d.includeZero,_=p.positive,b=p.negative,x=p.extendable_min,k=p.extendable_max,S=p.includeZero;if(0===f&&0===v){if(!XY(d,p))return}else if(0===_&&0===b){if(!XY(p,d))return}else if(m||S)if(m&&!S){if(!YY(d,p))return}else if(S&&!m){if(!YY(p,d))return}else{if(v===b)return;if(v>b){if(!KY(d,p))return}else if(!KY(p,d))return}else{if(0===v&&0===_){if(!qY(d,p))return}else if(0===b&&0===f&&!qY(p,d))return;if(0===v&&0===b)if(0===c[0]&&h[0]>0){if(!x)return;h[0]=0}else{if(!(0===h[0]&&c[0]>0))return;if(!g)return;c[0]=0}if(0===f&&0===_)if(0===c[1]&&h[1]>0){if(!k)return;h[1]=0}else{if(!(0===h[1]&&c[1]>0))return;if(!y)return;c[1]=0}}l.domain(c),u.domain(h)}}}}(r,i)}))}},i.prototype.onDidCompile=function(t,e){var i,n=this._checkEnableSync(e);if(n){var r=this._getTargetAxis(e,n);if(r&&n.tickAlign){EV(e.getOption().dataSet,"tickAlign",ZY);var a={targetAxis:function(){return r},currentAxis:function(){return e}},o=null===(i=r.getTickData())||void 0===i?void 0:i.getDataView();o&&o.target.addListener("change",(function(){var t,i;null===(i=null===(t=e.getTickData())||void 0===t?void 0:t.getDataView())||void 0===i||i.reRunAllTransform({skipEqual:!0})})),e.addTransformToTickData({type:"tickAlign",options:a,level:Number.MAX_SAFE_INTEGER},!1)}}},i.pluginType="component",i.type="AxisSyncPlugin",i}(JY),$Y={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function tX(t){var e=0;return ht(t,"tick.visible")&&(e+=ht(t,"tick.tickSize")),ht(t,"label.visible")&&(e+=ht(t,"label.space")),e}function eX(t,e){var i,n,r,a,o,s;return{min:null!==(r=null!==(i=t.min)&&void 0!==i?i:null===(n=t.range)||void 0===n?void 0:n.min)&&void 0!==r?r:null==e?void 0:e.min,max:null!==(s=null!==(a=t.max)&&void 0!==a?a:null===(o=t.range)||void 0===o?void 0:o.max)&&void 0!==s?s:null==e?void 0:e.max}}function iX(t){var e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}var nX=function(t){return"band"===t||"ordinal"===t||"point"===t};function rX(t,e){return{id:t,label:t,value:e,rawValue:t}}function aX(t,e,i){return i||!t||t.getAxisId()===e.getAxisId()}var oX=function(t){function e(e){var i=t.call(this)||this;return i.component=e,i}return C(e,t),e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.component=null},e}(XW),sX="".concat(Mj,"_ARC_TRANSFORM_VALUE"),lX="".concat(Mj,"_ARC_RATIO"),uX="".concat(Mj,"_ARC_START_ANGLE"),cX="".concat(Mj,"_ARC_END_ANGLE"),hX="".concat(Mj,"_ARC_K"),dX="".concat(Mj,"_ARC_MIDDLE_ANGLE"),pX="".concat(Mj,"_ARC_QUADRANT"),fX="".concat(Mj,"_ARC_RADIAN"),vX=-Math.PI/2,gX=3*Math.PI/2,yX=.6,mX=function(t,e,i,n){var r=t();if($(r))return r;if(U(r))return r(e(),i());var a=e();if("auto"===r&&a.width>0&&a.height>0){var o=n(),s=o.startAngle,l=void 0===s?0:s,u=o.endAngle,c=void 0===u?2*Math.PI:u;return Oi(a,i(),l,c)}return Math.min(a.width/2,a.height/2)},_X=function(t,e,i){var n,r=null!==(n="band"===e?CG("axisBand",i):"linear"===e?CG("axisLinear",i):{})&&void 0!==n?n:{},a=CG("angle"===t?"axisAngle":"axisRadius",i);return ej({},CG("axis",i),r,a)};function bX(t,e,i,n){switch(t){case L.cartesianBandAxis:return CY(bY(i,["z"]),"band",e);case L.cartesianLinearAxis:return CY(bY(i,["z"]),"linear",e);case L.cartesianLogAxis:return CY(bY(i,["z"]),"log",e);case L.cartesianSymlogAxis:return CY(bY(i,["z"]),"symlog",e);case L.cartesianAxis:case L.cartesianTimeAxis:return CY(bY(i),void 0,e);case L.polarBandAxis:return _X(i.orient,"band",e);case L.polarLinearAxis:return _X(i.orient,"linear",e);case L.polarAxis:return _X(i.orient,void 0,e);case L.cartesianCrosshair:return function(t,e){var i,n,r,a=Dt(null!==(i=e.axes)&&void 0!==i?i:[]),o=null!==(n=CG(L.crosshair,t))&&void 0!==n?n:{},s=o.bandField,l=o.linearField,u=o.xField,c=o.yField,h=o.trigger,d=o.triggerOff,p=a.find((function(t){return yY(t.orient)}));r=W(p)?ej({},nX(p.type)?s:l,u):u;var f=a.find((function(t){return mY(t.orient)}));return{xField:r,yField:W(f)?ej({},iO(f.type)?s:l,c):c,trigger:h,triggerOff:d}}(e,n);case L.polarCrosshair:return function(t,e){var i,n,r,a=Dt(null!==(i=e.axes)&&void 0!==i?i:[]),o=null!==(n=CG(L.crosshair,t))&&void 0!==n?n:{},s=o.bandField,l=o.linearField,u=o.categoryField,c=o.valueField,h=o.trigger,d=o.triggerOff,p=a.find((function(t){return"angle"===t.orient}));r=W(p)?ej({},nX(p.type)?s:l,u):u;var f=a.find((function(t){return"radius"===t.orient}));return{categoryField:r,valueField:W(f)?ej({},iO(f.type)?s:l,c):c,trigger:h,triggerOff:d}}(e,n);case L.colorLegend:case L.sizeLegend:case L.discreteLegend:case L.dataZoom:case L.scrollBar:return SX(i,CG(t,e));default:return CG(t,e)}}var xX,kX,SX=function(t,e){var i,n=ej({},e,e[xY(null!==(i=t.orient)&&void 0!==i?i:e.orient)]);return delete n.horizontal,delete n.vertical,n},AX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.getTheme=function(t,e){return bX(this.type,this._option.getTheme,t,e)},e.prototype._mergeThemeToSpec=function(e,i){var n=t.prototype._mergeThemeToSpec.call(this,e,i),r=n.spec,a=n.theme;return this._adjustPadding(r),{spec:r,theme:a}},e.prototype._adjustPadding=function(t){var e,i=t.padding,n=t.noOuterPadding,r=void 0===n||n,a=t.orient;r&&i&&a&&(t.padding=M(M({},jU(i)),((e={})[a]=0,e)))},e}(cW),CX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="component",e.modelType="component",e.transformerConstructor=AX,e._delegateEvent=function(t,i,n,r,a){var o,s;void 0===r&&(r=null),void 0===a&&(a=null),i instanceof kf||e.event.emit(n,{model:e,node:t,event:i,item:r,datum:a,source:SV.chart,chart:null===(s=null===(o=e._option)||void 0===o?void 0:o.globalInstance)||void 0===s?void 0:s.getChart()},"model")},e}return C(e,t),e.createComponent=function(t,e){var i=t.spec,n=w(t,["spec"]);return new this(i,M(M({},e),n))},e.prototype.getRegions=function(){return this._regions},e.prototype.created=function(){t.prototype.created.call(this),this.initLayout(),this.pluginService=new oX(this)},e.prototype.initLayout=function(){var e;t.prototype.initLayout.call(this),this._regions=null!==(e=this._regions)&&void 0!==e?e:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map((function(t){return null==t?void 0:t.id})))},e.prototype._getNeedClearVRenderComponents=function(){return[]},e.prototype.getVRenderComponents=function(){return this._getNeedClearVRenderComponents()},e.prototype.callPlugin=function(t){this.pluginService&&this.pluginService.getAll().forEach((function(e){return t(e)}))},e.prototype.getContainer=function(){var t;return this._container||(this._container=null===(t=this._option)||void 0===t?void 0:t.globalInstance.getStage().find((function(t){return"root"===t.name}),!0)),this._container},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake||(n.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some((function(t){return!St(null==i?void 0:i[t],e[t])}))),(null==i?void 0:i.visible)!==e.visible&&(n.reCompile=!0),n},e.prototype.release=function(){var e;t.prototype.release.call(this),this.clear(),null===(e=this.pluginService)||void 0===e||e.releaseAll(),this.pluginService=null},e.prototype.clear=function(){var t,e=this,i=this._getNeedClearVRenderComponents();i&&i.length&&i.forEach((function(t){var i;t&&(null===(i=e.getContainer())||void 0===i||i.removeChild(t),t=null)})),this._container=null,null===(t=this.pluginService)||void 0===t||t.clearAll()},e.prototype.compile=function(){this.compileMarks(),this.reAppendComponents()},e.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){i.compile({group:t,context:{model:e}})}))},e.prototype.reAppendComponents=function(){var t=this,e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach((function(e){var i;e&&!e.stage&&(null===(i=t.getContainer())||void 0===i||i.appendChild(e))}))},e.prototype.getBoundsInRect=function(t,e){return{x1:0,x2:0,y1:0,y2:0}},e.prototype.getDatum=function(t){},e.transformerConstructor=AX,e}(pW);!function(t){t.lineAxis="lineAxis",t.circleAxis="circleAxis"}(xX||(xX={})),function(t){t.lineAxisGrid="lineAxisGrid",t.circleAxisGrid="circleAxisGrid"}(kX||(kX={}));var MX=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type="component",n._componentType=i.componentType,n._mode=i.mode,n}return C(e,t),e.prototype._getDefaultStyle=function(){return{}},e.prototype.getComponent=function(){return this._component},e.prototype.clearComponent=function(){this._component&&(this._component.parent&&this._component.parent.removeChild(this._component),this._component=null)},e.prototype._getAttrsFromConfig=function(e){void 0===e&&(e={});var i=t.prototype._getAttrsFromConfig.call(this,e);return j(this._markConfig.interactive)||(i.pickable=this._markConfig.interactive),e},e.prototype.setAttributeTransform=function(t){this._attributesTransform=t},e.prototype.renderInner=function(){var t,e=null!==(t=this._simpleStyle)&&void 0!==t?t:this.getAttributesOfState({}),i=this._getAttrsFromConfig(e);this._attributesTransform&&(i=this._attributesTransform(i)),this._animationConfig&&(i=M(M({},i),{animation:!0,animationAppear:this._animationConfig.appear?Array.isArray(this._animationConfig.appear)?this._animationConfig.appear[0]:this._animationConfig.appear:void 0,animationEnter:this._animationConfig.enter?Array.isArray(this._animationConfig.enter)?this._animationConfig.enter[0]:this._animationConfig.enter:void 0,animationUpdate:this._animationConfig.update?Array.isArray(this._animationConfig.update)?this._animationConfig.update[0]:this._animationConfig.update:void 0,animationExit:this._animationConfig.exit?Array.isArray(this._animationConfig.exit)?this._animationConfig.exit[0]:this._animationConfig.exit:void 0})),this._component?this._component.setAttributes(i):(this._component=ij.createGraphicComponent(this._componentType,i,{mode:this._mode,skipDefault:this._markConfig.skipTheme}),this._component&&this._product.appendChild(this._component)),this._component&&(this._component.context=this._getCommonContext()),this._markConfig.support3d&&this._product&&this._product.setMode("3d"),this.model.event.emit(gV.AFTER_ELEMENT_ENCODE,{mark:this,model:this.model}),this.needClear=!0},e.prototype.release=function(){t.prototype.release.call(this),this.removeProduct()},e.type="component",e}(NW),wX=function(){ij.registerMark(MX.type,MX)},TX=function(t){return t},DX=function(e){function i(t,i){var n,r=this;return(r=e.call(this,t,i)||this).specKey="axes",r._scales=[],r._tickData=[],r._visible=!0,r._tick=void 0,r._onTickDataChange=function(t){r._forceLayout(),null==t||t.updateData()},r._visible=null===(n=t.visible)||void 0===n||n,r._coordinateType="none",r}return C(i,e),i.prototype.getOrient=function(){return this._orient},i.prototype.getScale=function(){return this._scale},i.prototype.getScales=function(){return this._scales},i.prototype.getTickData=function(t){return void 0===t&&(t=0),this._tickData[t]},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),i.prototype.getInverse=function(){return this._inverse},i.prototype.getCoordinateType=function(){return this._coordinateType},i.prototype.getVRenderComponents=function(){var t,e;return[null===(t=this._axisMark)||void 0===t?void 0:t.getProduct(),null===(e=this._gridMark)||void 0===e?void 0:e.getProduct()].filter(W)},i.prototype.created=function(){var i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b;if(e.prototype.created.call(this),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){var x=this._createMark({type:"component",name:"axis-".concat(this.getOrient())},{componentType:"angle"===this.getOrient()?xX.circleAxis:xX.lineAxis,mode:this._spec.mode},{skipTheme:!0});if(this._updateTickDataMarks(x),this._axisMark=x,x.setMarkConfig({zIndex:this.layoutZIndex}),W(this._spec.id)&&x.setUserId(this._spec.id),x.setMarkConfig({interactive:null!==(i=this._spec.interactive)&&void 0!==i?i:this.getDefaultInteractive()}),this._marks.addMark(x),null===(n=this._spec.grid)||void 0===n?void 0:n.visible){var k=this._createMark({type:"component",name:"axis-".concat(this.getOrient(),"-grid")},{componentType:"angle"===this.getOrient()?kX.circleAxisGrid:kX.lineAxisGrid,mode:this._spec.mode},{skipTheme:!0});this._updateTickDataMarks(k),k.setMarkConfig({zIndex:null!==(l=null!==(o=null===(a=null===(r=this._spec.grid)||void 0===r?void 0:r.style)||void 0===a?void 0:a.zIndex)&&void 0!==o?o:null===(s=this._spec.grid)||void 0===s?void 0:s.zIndex)&&void 0!==l?l:t.LayoutZIndex.Axis_Grid,interactive:!1}),this._marks.addMark(k),this._gridMark=k}if((null===(u=this._option.globalInstance)||void 0===u?void 0:u.isAnimationEnable())&&!1!==ht(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){var S=nY(null===(c=ij.getAnimationInKey("axis"))||void 0===c?void 0:c(),{appear:null!==(d=null!==(h=this._spec.animationAppear)&&void 0!==h?h:ht(this._option.getChart().getSpec(),"animationAppear.axis"))&&void 0!==d?d:ht(this._option.getChart().getSpec(),"animationAppear"),disappear:null!==(f=null!==(p=this._spec.animationDisappear)&&void 0!==p?p:ht(this._option.getChart().getSpec(),"animationDisappear.axis"))&&void 0!==f?f:ht(this._option.getChart().getSpec(),"animationDisappear"),enter:null!==(g=null!==(v=this._spec.animationEnter)&&void 0!==v?v:ht(this._option.getChart().getSpec(),"animationEnter.axis"))&&void 0!==g?g:ht(this._option.getChart().getSpec(),"animationEnter"),exit:null!==(m=null!==(y=this._spec.animationExit)&&void 0!==y?y:ht(this._option.getChart().getSpec(),"animationExit.axis"))&&void 0!==m?m:ht(this._option.getChart().getSpec(),"animationExit"),update:null!==(b=null!==(_=this._spec.animationUpdate)&&void 0!==_?_:ht(this._option.getChart().getSpec(),"animationUpdate.axis"))&&void 0!==b?b:ht(this._option.getChart().getSpec(),"animationUpdate")});S.enter&&(S.update[0].customParameters={enter:S.enter[0]}),this._marks.forEach((function(t){return t.setAnimationConfig(S)}))}}},i.prototype._shouldComputeTickData=function(){return this.getVisible()||this._spec.forceInitTick},i.prototype._initData=function(){var t=this,e=this._initTickDataSet(this._tickTransformOption()),i=new IW(this._option,e);this._tickData=[i],e.target.addListener("change",(function(){t._onTickDataChange(i)}))},i.prototype.collectData=function(t,e){var i=this,n=[];return cU(this._regions,(function(r){var a,o=i.collectSeriesField(t,r);if(o=Z(o)?tO(i._scale.type)?o:[o[0]]:[o],t||(i._dataFieldText=r.getFieldAlias(o[0])),o){var s=r.getViewData();if(e)o.forEach((function(t){n.push(r.getRawDataStatisticsByField(t,!!tO(i._scale.type)))}));else if(s&&s.latestData&&s.latestData.length){var l=null===(a=r.getViewDataStatistics)||void 0===a?void 0:a.call(r),u=i.type===L.cartesianLinearAxis&&i._spec.breaks&&i._spec.breaks.length;o.forEach((function(t){var e;(null===(e=null==l?void 0:l.latestData)||void 0===e?void 0:e[t])&&(u?n.push(M(M({},l.latestData[t]),{values:s.latestData.map((function(e){return e[t]}))})):n.push(l.latestData[t]))}))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),n},i.prototype.isSeriesDataEnable=function(){var t=!0;return cU(this._regions,(function(e){var i;Z(null===(i=e.getViewDataStatistics())||void 0===i?void 0:i.latestData)&&(t=!1)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),t},i.prototype.setSeriesAndRegionsFromSpec=function(){var t=this._spec,e=t.seriesId,i=t.seriesIndex,n=t.regionId,r=t.regionIndex;W(e)&&(this._seriesUserId=Dt(e)),W(n)&&(this._regionUserId=Dt(n)),W(i)&&(this._seriesIndex=Dt(i)),W(r)&&(this._regionIndex=Dt(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map((function(t){return t.id}))},i.prototype.getBindSeriesFilter=function(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.scaleUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},this.effect.scaleUpdate.bind(this));var i=hU(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map((function(t){return t.getViewDataStatistics()})).filter((function(t){return!!t}));i.length>1?this._option.dataSet.multipleDataViewAddListener(i,"change",(function(){e.updateScaleDomain()})):1===i.length&&i[0].target.addListener("change",(function(){e.updateScaleDomain()})),cU(this._regions,(function(i){i.event.on(t.ChartEvent.rawDataUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},(function(){e._clearRawDomain()}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.updateScaleDomain=function(){},i.prototype._clearRawDomain=function(){},i.prototype.onLayoutEnd=function(){this.updateScaleRange(),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"range"}),e.prototype.onLayoutEnd.call(this)},i.prototype.computeData=function(t){"force"!==t||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||"force"!==t&&St(this._scale.range(),[0,1])||this._tickData.forEach((function(t){t.getDataView().reRunAllTransform({skipEqual:!0})})):cU(this._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.reRunAllTransform()}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._updateTickDataMarks=function(t){this._tickData&&this._tickData.forEach((function(e){e.addRelatedMark(t)}))},i.prototype.initScales=function(){this._scales=[this._scale];var t=[];if(cU(this._regions,(function(e){var i=e.getGroups();i&&t.push(i)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length)for(var e=Bt(t.map((function(t){return t.fields.length}))),i=1;i<e;i++){var n=this._scale.clone();this._scales.push(n)}},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake?n:(n.reRender=!0,(null==i?void 0:i.type)!==(null==t?void 0:t.type)||(null==i?void 0:i.visible)!==(null==t?void 0:t.visible)?(n.reMake=!0,n):(n.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some((function(e){var n,r;return(null===(n=null==i?void 0:i[e])||void 0===n?void 0:n.visible)!==(null===(r=null==t?void 0:t[e])||void 0===r?void 0:r.visible)})),n))},i.prototype._getAxisAttributes=function(){var t,e=this,i=this._spec,n={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&i.select,hover:!0!==this._option.disableTriggerEvent&&i.hover};if(i.domainLine&&i.domainLine.visible?n.line=((t=dV(t=i.domainLine)).startSymbol=dV(t.startSymbol),t.endSymbol=dV(t.endSymbol),t):n.line={visible:!1},i.label&&i.label.visible){var r=bt(i.label,["style","formatMethod","state"]);n.label=r,i.label.style&&(n.label.style=U(i.label.style)?function(t,n,r,a){var o,s=i.label.style(t.rawValue,n,t,r,a);return vV(ej({},null===(o=e._theme.label)||void 0===o?void 0:o.style,s))}:vV(i.label.style)),(i.label.formatMethod||i.label.formatter)&&(n.label.formatMethod=this._getLabelFormatMethod()),i.label.state&&(n.label.state=function(t){if(ct(t))return null;var e={};return Object.keys(t).forEach((function(i){U(t[i])?e[i]=function(e,n,r,a){return vV(t[i](e.rawValue,n,e,r,a))}:ct(t[i])||(e[i]=vV(t[i]))})),e}(i.label.state)),U(i.label.dataFilter)&&(n.label.dataFilter=function(t,n){return i.label.dataFilter(t,n,{vchart:e._option.globalInstance})})}else n.label={visible:!1};if(i.tick&&i.tick.visible?(n.tick={visible:i.tick.visible,length:i.tick.tickSize,inside:i.tick.inside,alignWithLabel:i.tick.alignWithLabel,dataFilter:U(i.tick.dataFilter)?function(t){return i.tick.dataFilter(t,{vchart:e._option.globalInstance})}:void 0},i.tick.style&&(n.tick.style=U(i.tick.style)?function(t,n,r,a){var o,s=i.tick.style(t,n,r,a);return vV(ej({},null===(o=e._theme.tick)||void 0===o?void 0:o.style,s))}:vV(i.tick.style)),i.tick.state&&(n.tick.state=pV(i.tick.state))):n.tick={visible:!1},i.subTick&&i.subTick.visible?(n.subTick={visible:i.subTick.visible,length:i.subTick.tickSize,inside:i.subTick.inside,count:i.subTick.tickCount},i.subTick.style&&(n.subTick.style=U(i.subTick.style)?function(t,n,r,a){var o,s=i.subTick.style(t,n,r,a);return vV(ej({},null===(o=e._theme.subTick)||void 0===o?void 0:o.style,s))}:vV(i.subTick.style)),i.subTick.state&&(n.subTick.state=pV(i.subTick.state))):n.subTick={visible:!1},i.title&&i.title.visible){var a=i.title,o=a.autoRotate,s=a.angle,l=a.style,u=void 0===l?{}:l,c=a.background,h=a.state,d=a.shape,p=w(a,["autoRotate","angle","style","background","state","shape"]),f=s,v=void 0;"left"!==i.orient&&"right"!==i.orient||o&&j(f)&&(f="left"===i.orient?-90:90,v=$Y[i.orient]),n.title=M(M({},p),{autoRotate:!1,angle:f?Ci(f):null,textStyle:ej({},v,vV(u)),pickable:!1!==u.pickable,childrenPickable:!1!==u.pickable,state:{}}),d&&d.visible?(n.title.shape=M(M({},d),{style:vV(d.style)}),d.state&&(n.title.state.shape=pV(d.state))):n.title.shape={visible:!1},c&&c.visible?(n.title.background=M(M({},c),{style:vV(c.style)}),c.state&&(n.title.state.background=pV(c.state))):n.title.background={visible:!1},h&&(n.title.state.text=pV(h))}else n.title={visible:!1};return i.background&&i.background.visible?(n.panel={visible:!0},i.background.style&&(n.panel.style=vV(i.background.style)),i.background.state&&(n.panel.state=pV(i.background.state))):n.panel={visible:!1},n},i.prototype._getGridAttributes=function(){var t=this,e=this._spec;return{alternateColor:e.grid.alternateColor,alignWithLabel:e.grid.alignWithLabel,style:U(e.grid.style)?function(i,n){var r,a,o=e.grid.style(null===(r=i.datum)||void 0===r?void 0:r.rawValue,n,i.datum);return vV(ej({},null===(a=t._theme.grid)||void 0===a?void 0:a.style,o))}:vV(e.grid.style),subGrid:!1===e.subGrid.visible?{visible:!1}:{type:"line",visible:e.subGrid.visible,alternateColor:e.subGrid.alternateColor,style:vV(e.subGrid.style)}}},i.prototype._getLabelFormatMethod=function(){var t=this._spec.label,e=t.formatMethod,i=t.formatter,n=MG(e,i).formatFunc;return n?function(t,e,r){return n(e.rawValue,e,i)}:null},i.prototype._initTickDataSet=function(t,e){void 0===e&&(e=0),BV(this._option.dataSet,"scale",TX);var i=this.registerTicksTransform();return new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_ticks_").concat(e)}).parse(this._scales[e],{type:"scale"}).transform({type:i,options:t},!1)},i.prototype._tickTransformOption=function(){var t=this._tick||{},e=this._spec.label||{},i=t.tickCount,n=t.forceTickCount,r=t.tickStep,a=t.tickMode,o=e.style,s=e.formatMethod,l=e.minGap;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:n,tickStep:r,tickMode:a,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:o,labelFormatter:s,labelGap:l}},i.prototype.addTransformToTickData=function(t,e){this._tickData.forEach((function(i){var n;null===(n=null==i?void 0:i.getDataView())||void 0===n||n.transform(t,e)}))},i.prototype.dataToPosition=function(t){return this._scale.scale(t)},i.prototype.getDatum=function(t){var e;return t&&t.name===DR.label?t.data:this._axisMark?null===(e=this._axisMark.getComponent())||void 0===e?void 0:e.attribute.items:void 0},i.prototype.scaleRangeFactor=function(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactor(t,e,i)},i.prototype.scaleRangeFactorEnd=function(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorEnd(t,e)},i.prototype.scaleRangeFactorStart=function(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorStart(t,e)},i.specKey="axes",i}(CX),EX=function(){wX(),ij.registerAnimation("axis",(function(){return{appear:{type:"fadeIn"},enter:{type:"fadeIn"},update:{type:"update"},exit:{type:"fadeOut"}}}))},BX=function(t){for(var e=t[0].getLayoutStartPoint(),i=e.x,n=e.y,r=i+t[0].getLayoutRect().width,a=n+t[0].getLayoutRect().height,o=1;o<t.length;o++){var s=t[o],l=s.getLayoutStartPoint(),u=l.x,c=l.y,h=s.getLayoutRect(),d=h.width,p=h.height;i=Math.min(i,u),r=Math.max(r,d+u),n=Math.min(n,c),a=Math.max(a,p+c)}var f=Math.abs(a-n);return{width:Math.abs(r-i),height:f}},PX=[QY],RX=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=L.cartesianAxis,r.name=L.cartesianAxis,r._defaultBandPosition=.5,r._defaultBandInnerPadding=.1,r._defaultBandOuterPadding=.3,r.layoutType="region-relative",r.layoutZIndex=t.LayoutZIndex.Axis,r.layoutLevel=t.LayoutLevel.Axis,r._orient="left",r._autoIndentOnce=!1,r._hasAutoIndent=!1,r._scales=[],r._tick=void 0,r._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},r._innerOffset={top:0,bottom:0,left:0,right:0},r.effect={scaleUpdate:function(t){r.computeData(null==t?void 0:t.value),cU(r._regions,(function(t){var e=r.getOrient();yY(e)?aX(t.getXAxisHelper(),r.axisHelper(),W(r._seriesUserId)||W(r._seriesIndex))&&t.setXAxisHelper(r.axisHelper()):mY(e)?aX(t.getYAxisHelper(),r.axisHelper(),W(r._seriesUserId)||W(r._seriesIndex))&&t.setYAxisHelper(r.axisHelper()):_Y(e)&&aX(t.getZAxisHelper(),r.axisHelper(),W(r._seriesUserId)||W(r._seriesIndex))&&t.setZAxisHelper(r.axisHelper())}),{userId:r._seriesUserId,specIndex:r._seriesIndex})}},r._transformLayoutPosition=function(t){var e=t.x,i=t.y;return it(e)&&(e+=Number("left"===r._orient)*r.getLayoutRect().width),it(i)&&(i+=Number("top"===r._orient)*r.getLayoutRect().height),{x:e,y:i}},r._transformLayoutRect=function(t){if(!r._visible)return t;var e=r._latestBounds.clone().translate(-r.getLayoutStartPoint().x,-r.getLayoutStartPoint().y);switch(r._layout.layoutOrient){case"left":0===r._layout.layoutRectLevelMap.width&&(t.width=e.x1<0?-e.x1:0);break;case"right":0===r._layout.layoutRectLevelMap.width&&(t.width=e.x2>0?e.x2:0);break;case"top":0===r._layout.layoutRectLevelMap.height&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":0===r._layout.layoutRectLevelMap.height&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),r._layout.setRectInSpec(r._layoutCacheProcessing(t))},r._transformLayoutPadding=function(t){return"left"===r.layoutOrient||"right"===r.layoutOrient?(t.top=0,t.bottom=0):"top"!==r.layoutOrient&&"bottom"!==r.layoutOrient||(t.left=0,t.right=0),t},r._updateAxisLayout=function(){var t=r.getLayoutStartPoint(),e=r._getUpdateAttribute(!1),i=e.grid,n=w(e,["grid"]),a=ej({x:t.x,y:t.y},r._axisStyle,n);r._axisMark.setSimpleStyle(a),r._gridMark&&r._gridMark.setSimpleStyle(ej({x:t.x,y:t.y},r._getGridAttributes(),i))},r._fixAxisOnZero=function(){var t=r._spec.domainLine,e=t.onZero,i=t.visible;if(r.visible&&e&&!1!==i){var n=r._spec.domainLine,a=n.onZeroAxisId,o=n.onZeroAxisIndex,s=r._option.getComponentsByKey("axes"),l=yY(r.getOrient()),u=function(t){var e;return(l?!yY(t.getOrient()):yY(t.getOrient()))&&tO(t.getScale().type)&&(t.getTickData()?null===(e=t.getTickData().getLatestData())||void 0===e?void 0:e.find((function(t){return 0===t.value})):t.getScale().domain()[0]<=0&&Et(t.getScale().domain())>=0)},c=s.filter((function(t){return u(t)}));if(c.length){var h=void 0;if(W(a))h=c.find((function(t){return t.id===a}));else if(W(o)){var d=s[o];u(d)&&(h=d)}else h=c[0];if(h){var p=r._axisMark,f=h.valueToPosition(0);l?p.setSimpleStyle(M(M({},p.getSimpleStyle()),{line:M(M({},r._axisStyle.line),{dy:"bottom"===r._orient?-((h.getInverse()?h.getScale().range()[1]:h.getScale().range()[0])-f):f})})):p.setSimpleStyle(M(M({},p.getSimpleStyle()),{line:M(M({},r._axisStyle.line),{dx:"left"===r._orient?f:-((h.getInverse()?h.getScale().range()[0]:h.getScale().range()[1])-f)})}))}}}},r._orient=bY(i,["z"]),_Y(r._orient)&&(r.layoutType="absolute"),r._dataSet=n.dataSet,r._coordinateType="cartesian",r}return C(i,e),i.prototype.getOrient=function(){return this._orient},i.prototype.getDefaultInteractive=function(){return!0},Object.defineProperty(i.prototype,"autoIndentOnce",{set:function(t){this._autoIndentOnce=t},enumerable:!1,configurable:!0}),i.prototype.getScales=function(){return this._scales},i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!i)return null;var n="horizontal"===t.direction;if(!Z(i)){if(!iX(i))return null;var r=kY(i,n),a=r.axisType,o=r.componentName;return i.type=a,[{spec:i,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:o}]}var s=i.filter((function(t){return"z"===t.orient}))[0],l=!0;if(s){var u=i.filter((function(t){return"bottom"===t.orient}))[0],c=i.filter((function(t){return mY(t.orient)}))[0];l=3===i.length&&u&&c}var h=i.map((function(t,e){return{spec:t,index:e}}));l||(h=h.filter((function(t){return"z"!==t.spec.orient})));var d=[];return h.forEach((function(t){var i=t.spec,r=t.index;if(iX(i)){var a=kY(i,n),o=a.axisType,s=a.componentName;i.type=o,d.push({spec:i,specPath:[e.specKey,r],specInfoPath:["component",e.specKey,r],type:s})}})),d},i.createComponent=function(t,e){var i=t.spec,n=w(t,["spec"]),r=ij.getComponentInKey(n.type);return r?new r(i,M(M({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient},i.prototype.getNewScaleRange=function(){var t=this.getLayoutRect(),e=t.width,i=t.height,n=this._innerOffset,r=n.left,a=n.right,o=n.top,s=n.bottom,l=[];return yY(this.getOrient())?it(e)&&(l=this._inverse?[e-a,r]:[r,e-a]):_Y(this.getOrient())?it(e)&&(l=this._inverse?[e-a,r]:[r,e-a],this._scale.range(l)):it(i)&&(l=this._inverse?[o,i-s]:[i-s,o]),l},i.prototype.updateScaleRange=function(){var t=!1,e=this.getNewScaleRange(),i=this._scale.range();return e.length===i.length&&e.every((function(t,e){return t===i[e]}))?t=!1:(t=!0,this._scale.range(e)),t},i.prototype.init=function(t){var i,n=this;e.prototype.init.call(this,t),null===(i=this.pluginService)||void 0===i||i.load(PX.map((function(t){return new t}))),this.callPlugin((function(t){n.pluginService&&t.onInit&&t.onInit(n.pluginService,n)}))},i.prototype.setAttrFromSpec=function(){var t;if(e.prototype.setAttrFromSpec.call(this),this.visible){yY(this.getOrient())?K(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):K(this._spec.maxWidth)&&(this._spec.maxWidth="30%");var i=this._getAxisAttributes();i.label.formatMethod=this._getLabelFormatMethod(),i.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=i}this._tick=this._spec.tick;var n=null===(t=this._option.getChart())||void 0===t?void 0:t.getSpec();this._inverse=function(t,e){var i=t.inverse;return e&&!yY(t.orient)&&(i=!W(t.inverse)||!t.inverse),i}(this._spec,"horizontal"===(null==n?void 0:n.direction))},i.prototype.onLayoutStart=function(t,i){var n=this;if(e.prototype.onLayoutStart.call(this,t,i),!_Y(this.getOrient())&&this._spec.innerOffset){var r=this._spec;mY(this.getOrient())?["top","bottom"].forEach((function(t){n._innerOffset[t]=HU(r.innerOffset[t],i.height,i)})):["left","right"].forEach((function(t){n._innerOffset[t]=HU(r.innerOffset[t],i.width,i)}))}},i.prototype.getSeriesStatisticsField=function(t){var e;return e=yY(this.getOrient())?t.fieldX:_Y(this.getOrient())?t.fieldZ:t.fieldY,tO(this._scale.type)?e:[e[0]]},i.prototype._tickTransformOption=function(){var t,i,n,r;return M(M({},e.prototype._tickTransformOption.call(this)),{noDecimals:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,labelLastVisible:null===(i=this._spec.label)||void 0===i?void 0:i.lastVisible,labelFirstVisible:null===(n=this._spec.label)||void 0===n?void 0:n.firstVisible,labelFlush:null===(r=this._spec.label)||void 0===r?void 0:r.flush})},i.prototype.axisHelper=function(){var t=this;return{isContinuous:tO(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return!0===t._inverse},getSpec:function(){return t._spec}}},i.prototype.afterCompile=function(){var t,e=this;(null===(t=this._axisMark)||void 0===t?void 0:t.getProduct())&&this.event.on(gV.AFTER_ELEMENT_ENCODE,(function(t){if(t.mark===e._axisMark&&!1===e._isLayout&&(yY(e.getOrient())?e.callPlugin((function(t){e.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(e.pluginService,e)})):e.callPlugin((function(t){e.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(e.pluginService,e)})),e._unitText)){var i=e.getLayoutStartPoint(),n=i.x,r=i.y,a=yY(e._orient)?{x:Bt(e._scale.range())+n,y:r}:{x:n,y:Pt(e._scale.range())+r};e._unitText.setAttributes(a)}})),this.callPlugin((function(t){e.pluginService&&t.onDidCompile&&t.onDidCompile(e.pluginService,e)}))},i.prototype.collectScale=function(){var t=this,e=[];return cU(this._regions,(function(i){e.push("left"===t.getOrient()||"right"===t.getOrient()?i.scaleY:i.scaleX)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),e},i.prototype.collectSeriesField=function(t,e){var i,n;return t>0?null===(n=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===n?void 0:n[t]:yY(this.getOrient())?e.getSpec().x2Field?P(P([],B(e.fieldX),!1),[e.fieldX2],!1):e.fieldX:_Y(this.getOrient())?e.fieldZ:e.getSpec().y2Field?P(P([],B(e.fieldY),!1),[e.fieldY2],!1):e.fieldY},i.prototype.updateSeriesScale=function(){var t=this,e=this.getOrient();cU(this._regions,(function(i){yY(e)?aX(i.getXAxisHelper(),t.axisHelper(),W(t._seriesUserId)||W(t._seriesIndex))&&(i.setScaleX(t._scale),i.setXAxisHelper(t.axisHelper())):mY(e)?aX(i.getYAxisHelper(),t.axisHelper(),W(t._seriesUserId)||W(t._seriesIndex))&&(i.setScaleY(t._scale),i.setYAxisHelper(t.axisHelper())):_Y(e)&&aX(i.getZAxisHelper(),t.axisHelper(),W(t._seriesUserId)||W(t._seriesIndex))&&(i.setScaleZ(t._scale),i.setZAxisHelper(t.axisHelper()))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getBoundsInRect=function(t){var e,i=this,n={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return n;this._verticalLimitSize=yY(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&Z(null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData())||this.computeData("range");var r={skipLayout:!1},a=yY(this.getOrient());this.pluginService&&(a?this.callPlugin((function(t){t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(i.pluginService,r,i)})):this.callPlugin((function(t){t.onWillLayoutVertical&&t.onWillLayoutVertical(i.pluginService,r,i)})));this._axisMark.getProduct();var o=this._getUpdateAttribute(!0),s=this._axisMark.getComponent(),l=ej(M({},this.getLayoutStartPoint()),this._axisStyle,o,{line:{visible:!1}}),u=null==s?void 0:s.getBoundsWithoutRender(l);return u&&!u.empty()||(u=(new Fn).set(l.x,l.y,l.x,l.y)),!0,this._latestBounds=u,n=this._appendAxisUnit(u,a)},i.prototype.positionToData=function(t,e){var i=yY(this.getOrient());e&&(t-=i?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(t=i?he(t,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):he(t,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));var n=this._scale.range();return(t-n[0])*(t-Et(n))>0?null:this._scale.invert(t)},i.prototype._getTitleLimit=function(t){var e,i,n,r,a,o=this._spec.title;if(o.visible&&j(null===(e=o.style)||void 0===e?void 0:e.maxLineWidth)){var s=null!==(a=null!==(n=null===(i=this._axisStyle.title)||void 0===i?void 0:i.angle)&&void 0!==n?n:null===(r=o.style)||void 0===r?void 0:r.angle)&&void 0!==a?a:0;if(t){var l=this.getLayoutRect().width,u=Math.abs(Math.cos(s));return u<1e-6?1/0:l/u}var c=this.getLayoutRect().height,h=Math.abs(Math.sin(s));return h<1e-6?1/0:c/h}return null},i.prototype._getUpdateAttribute=function(t){var e=0,i=0;if(!t){var n=BX(this.getRegions());i=n.width,e=n.height}var r=this.getLayoutRect(),a=r.width,o=r.height,s=yY(this._orient),l=mY(this._orient),u={x:0,y:0},c=e,h=a;s?u={x:a,y:0}:l&&(u={x:0,y:o},c=i,h=o);var d=this.getLabelItems(h),p={start:{x:0,y:0},end:u,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(s)},items:d,scale:this._scale.clone()};t||(p.grid={type:"line",start:{x:0,y:0},end:u,items:d[0],verticalFactor:this._axisStyle.verticalFactor,length:c});var f=s?this.layout.minHeight:this.layout.minWidth;return(s&&9===this._layout.layoutRectLevelMap.height||l&&9===this._layout.layoutRectLevelMap.width)&&(f=this._verticalLimitSize),p.verticalLimitSize=this._verticalLimitSize,p.verticalMinSize=f,p.label={overflowLimitLength:this._getLabelOverflowLimit(s)},this._afterUpdateAttribute?this._afterUpdateAttribute(p,t):p},i.prototype.getLabelItems=function(t){var e,i=this,n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return n&&n.length?[n.map((function(e){var n=i._getNormalizedValue([e.value],t);return rX(e.value,n)})).filter((function(t){var e=t.value,n=t.rawValue,r=i._scale.domain();return"log"===i.getSpec().type?e>=0&&e<=1:tO(i._scale.type)?n>=r[0]&&n<=Et(r):r.includes(n)}))]:[]},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.visible&&(this.event.on(t.ChartEvent.layoutEnd,this._updateAxisLayout),this.event.on(t.ChartEvent.layoutEnd,this._fixAxisOnZero),this.event.on(t.ChartEvent.layoutRectUpdate,(function(){i._clearLayoutCache()})))},i.prototype._getNormalizedValue=function(t,e){return 0===e?0:this.dataToPosition(t)/e},i.prototype._layoutCacheProcessing=function(t){var e=this;return["width","height"].forEach((function(i){t[i]<e._layoutCache[i]?t[i]=e._layoutCache[i]:e._layoutCache[i]=t[i]})),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]})):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]<e._layoutCache._lastComputeOutBounds[t]?e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]:e._layoutCache._lastComputeOutBounds[t]=e.layout.getLastComputeOutBounds()[t]}))),t},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._clearLayoutCache()},i.prototype._clearLayoutCache=function(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}},i.prototype.onDataUpdate=function(){this._clearLayoutCache()},i.prototype._appendAxisUnit=function(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){var n=this._spec.unit,r=n.text,a=n.style,o=void 0,s=void 0,l=this.getLayoutStartPoint(),u=l.x,c=l.y;e?(o={x:Bt(this._scale.range())+u,y:c},s={textAlign:"left",textBaseline:"middle"}):(o={x:u,y:Pt(this._scale.range())+c},s={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),s=M(M(M({},s),a),{x:o.x,y:o.y,text:r}),this._unitText?this._unitText.setAttributes(s):(this._unitText=Fm(s),this._unitText.name="axis-unit",null===(i=this.getContainer())||void 0===i||i.add(this._unitText));var h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t},i.prototype._getNeedClearVRenderComponents=function(){return this._unitText?[this._unitText]:[]},i.prototype._getLabelOverflowLimit=function(t){var e,i;if(t&&!1!==(null===(e=this._spec.label)||void 0===e?void 0:e.visible)&&!0===(null===(i=this._spec.label)||void 0===i?void 0:i.autoLimit)){var n=this._option.getComponentsByKey("axes"),r=this.getRegions(),a=n.filter((function(t){var e=t.getOrient();return("left"===e||"right"===e)&&t.getRegions().some((function(t){return r.includes(t)}))})),o=0,s=0,l=this.getLayoutStartPoint().x,u=l+this.getLayoutRect().width;return a.forEach((function(t){var e=t.getLayoutStartPoint().x;if("left"===t.getOrient()&&e===l){var i=t.getLayoutRect().width;o=Math.max(o,i)}else if(e===u){var n=t.getLayoutRect().width;s=Math.max(s,n)}})),{left:o,right:s}}},i.type=L.cartesianAxis,i.specKey="axes",i}(DX),LX=function(t,e,i){return i.reduce((function(t,n,r){return t.push([n,i.length===r+1?e:i[r+1]]),t}),[[t,i[0]]])};function IX(t,e){var i=t[0],n=t[t.length-1],r=e.filter((function(t){return t>i&&t<n}));return 0===r.length?[[i,n]]:LX(i,n,r)}var FX=function(t,e){return t-e},OX=function(t,e){for(var i=[{count:0,sub:[],max:e[0],min:e[0]}],n=0,r=0;n<e.length;)t[r]<=e[n]?(i[n].count+=1,i[n].sub.push(t[r]),r+=1):i[n+=1]={count:0,sub:[],max:e[n],min:e[n]};i.forEach((function(t){t.count&&(t.min=Math.min.apply(null,t.sub))}));var a=t.slice(r);return i[n]={count:a.length,sub:a,min:e[e.length-1],max:Math.max.apply(null,a)},i};function zX(t,e,i){void 0===i&&(i="count");var n=OX(t,e),r="count"===i?t.length:n.reduce((function(t,e,i){return e.count>0?t+e.max-e.min:t}),0),a=[],o=0,s=0;return n.forEach((function(t,e){if(0===r)a.push([0,e/n.length-1]);else{var l="count"===i?t.count:t.max-t.min,u=a[s-1]?a[s-1][1]:0,c=e===n.length-1?1:Math.min((o+l)/r,1);(u!==c||0!==u&&1!==u)&&(s+=1,a.push([u,c]),o+=l)}})),a}var HX=Math.sqrt(50),NX=Math.sqrt(10),UX=Math.sqrt(2),jX=function(){function e(){this._extend={},this._rawDomain=[],this.niceLabelFormatter=null}return e.prototype.getRawDomain=function(){return this._rawDomain},e.prototype.setExtraAttrFromSpec=function(){W(this._spec.nice)&&(this._nice=this._spec.nice),W(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=eX(this._spec)},e.prototype.transformScaleDomain=function(){this.setScaleNice()},e.prototype.setLinearScaleNice=function(){var t;if(!this._nice)return!1;var e=5,i=this._spec.tick||{};if(it(i.forceTickCount))e=i.forceTickCount;else if(U(i.tickCount)){var n=this._scale.range(),r=Math.abs(Et(n)-n[0]);if(1===r&&this._option)r=yY(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height;e=i.tickCount({axisLength:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=it(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));var a=null!==(t=this._domain)&&void 0!==t?t:{},o=a.min,s=a.max;return j(o)&&j(s)&&j(this._softMaxValue)&&j(this._softMinValue)?this._scale.nice(e):(W(o)||W(this._softMinValue))&&j(s)&&j(this._softMaxValue)?this._scale.niceMax(e):!(!j(o)||!j(this._softMinValue)||!W(s)&&!W(this._softMaxValue))&&this._scale.niceMin(e)},e.prototype.setLogScaleNice=function(){var t;if(!this._nice)return!1;var e=null!==(t=this._domain)&&void 0!==t?t:{},i=e.min,n=e.max;return j(i)&&j(n)&&j(this._softMaxValue)&&j(this._softMinValue)?this._scale.nice():(W(i)||W(this._softMinValue))&&j(n)&&j(this._softMaxValue)?this._scale.niceMax():!(!j(i)||!j(this._softMinValue)||!W(n)&&!W(this._softMaxValue))&&this._scale.niceMin()},e.prototype.setScaleNice=function(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()},e.prototype.dataToPosition=function(t,e){return this.valueToPosition(t[0])},e.prototype.valueToPosition=function(t){return this._scale.scale(t)},e.prototype.computeLinearDomain=function(t){var e=[];if(t.length){var i,n,r=this._spec.breaks&&this._spec.breaks.length,a=[];if(t.forEach((function(t){var e=t.min,o=t.max;i=void 0===i?e:Math.min(i,e),n=void 0===n?o:Math.max(n,o),r&&(a=a.concat(t.values))})),r){for(var o=[],s=[],l=j(this._domain.max)?n:this._domain.max,u=0;u<this._spec.breaks.length;u++){var c=this._spec.breaks[u].range;c[0]<=c[1]&&c[1]<=l&&(o.push(c),s.push(this._spec.breaks[u]))}if(o.sort((function(t,e){return t[0]-e[0]})),o.length){var h=function(t,e,i){return t.sort(FX),e.sort(FX),{domain:IX(t,e),scope:zX(t,e,i)}}(a,OA(o),this._spec.breaks[0].scopeType),d=h.domain,p=h.scope;e=OA(d),this._break={domain:d,scope:p,breakDomains:o,breaks:s}}else e=[i,n]}else e=[i,n]}else e[0]=0,e[1]=0;return this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e},e.prototype.expandDomain=function(t){if(this._expand){var e=t[0],i=Et(t);e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),W(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),W(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}},e.prototype.niceDomain=function(t){var e=eX(this._spec),i=e.min,n=e.max;if(W(i)||W(n)||"linear"!==this._spec.type)return t;if(Math.abs(Pt(t)-Bt(t))<=1e-12){var r=t[0],a=r>=0?1:-1;if((r=Math.abs(r))<1)t[0]=0,t[t.length-1]=1;else{var o=r/5,s=Math.floor(Math.log(o)/Math.LN10),l=o/Math.pow(10,s);o=(l>=HX?10:l>=NX?5:l>=UX?2:1)*Math.pow(10,s),t[0]=0,t[t.length-1]=10*o}a<0&&(t.reverse(),t[0]*=-1,t[t.length-1]*=-1)}return t},e.prototype.includeZero=function(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(Et(t),0))},e.prototype.setExtendDomain=function(e,i){if(void 0!==i){this._extend[e]=i;var n=this._scale.domain();if(this.extendDomain(n),this.includeZero(n),this.setDomainMinMax(n),this.niceDomain(n),this._scale.domain(n,this._nice),this._nice)!this.setScaleNice()&&this._scale.rescale();this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})}else delete this._extend[e]},e.prototype.extendDomain=function(t){var e,i=t.length-1,n=t[0]-t[i]>0,r=n?i:0,a=n?0:i;for(var o in this._extend)(e=this._extend[o])>t[a]&&(t[a]=e),e<t[r]&&(t[r]=e)},e.prototype.getDomainSpec=function(){return this._domain},e.prototype.setDomainMinMax=function(t){if(this._domain){var e=this._domain,i=e.min,n=e.max;W(i)&&(t[0]=i),W(n)&&(t[t.length-1]=n)}},e.prototype.setSoftDomainMinMax=function(t){var e=this._spec,i=e.softMin,n=e.softMax;if(W(i)){var r=U(i)?i(t):i;j(r)&&(r=t[0]),r<=t[0]&&(t[0]=r,this._softMinValue=r)}if(W(n)){var a=U(n)?n(t):n;j(a)&&(a=Et(t)),a>=Et(t)&&(t[t.length-1]=a),this._softMaxValue=a}},e.prototype.setZero=function(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())},e.prototype.updateScaleDomain=function(){var t;if(this.isSeriesDataEnable()){!(null===(t=this._rawDomain)||void 0===t?void 0:t.length)&&this._scale&&this._updateRawDomain();var e=this.collectData(),i=this.computeLinearDomain(e);this.updateScaleDomainByModel(i)}},e.prototype.updateScaleDomainByModel=function(e){(e=null!=e?e:this._scale.domain(),this.extendDomain(e),this.includeZero(e),this.setDomainMinMax(e),this.niceDomain(e),this._scale.domain(e,this._nice),this._nice)&&(!this.setScaleNice()&&this._scale.rescale());this._updateNiceLabelFormatter(e),this._domainAfterSpec=this._scale.domain(),this.event.emit(t.ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})},e.prototype.getDomainAfterSpec=function(){return this._domainAfterSpec},e.prototype._updateNiceLabelFormatter=function(t){var e=Math.abs(Et(t)-t[0]),i=Math.max(-Math.floor(Math.log10(e)),0)+2,n=Math.pow(10,i);this.niceLabelFormatter=function(t){return it(+t)?Math.round(+t*n)/n:t}},e.prototype._updateRawDomain=function(){var e=this.collectData(0,!0),i=this.computeLinearDomain(e);this._rawDomain=i,this.event.emit(t.ChartEvent.scaleRawDomainUpdate,{model:this})},e.prototype._clearRawDomain=function(){this._rawDomain=[]},e}(),VX={domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}},WX={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},GX={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},YX={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},XX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.cartesianLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new YO,e}return C(e,t),e.prototype.setAttrFromSpec=function(){var e,i,n=this;t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec();var r=null===(i=null===(e=this._tickData)||void 0===e?void 0:e[0])||void 0===i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===n.registerTicksTransform()}));r&&(r.options=this._tickTransformOption())},e.prototype.initScales=function(){var e,i;t.prototype.initScales.call(this);var n=[0,1];W(null===(e=this._domain)||void 0===e?void 0:e.min)&&(n[0]=this._domain.min),W(null===(i=this._domain)||void 0===i?void 0:i.max)&&(n[1]=this._domain.max),this._scale.domain(n)},e.prototype._tickTransformOption=function(){var e,i=this;return M(M({},t.prototype._tickTransformOption.call(this)),{breakData:(null===(e=this._spec.breaks)||void 0===e?void 0:e.length)?function(){return i._break}:null})},e.prototype._getUpdateAttribute=function(e){var i,n,r=this,a=t.prototype._getUpdateAttribute.call(this,e);if(!_Y(this._orient)&&(null===(n=null===(i=this._break)||void 0===i?void 0:i.breaks)||void 0===n?void 0:n.length)){var o=this.getLayoutRect(),s=o.width,l=o.height,u=yY(this._orient),c=u?s:l;a.breaks=this._break.breaks.map((function(t){var e,i=t.range,n=t.breakSymbol,a=t.gap,o=void 0===a?6:a,s=r.valueToPosition((i[0]+i[1])/2)/c;e=OU(o)?Number(o.substring(0,o.length-1))/100:o/c;var l=it(null==n?void 0:n.angle)?n.angle:u?60:15;return{range:[s-e/2,s+e/2],breakSymbol:M(M({visible:!0},n),{angle:l*Math.PI/180}),rawRange:i}}))}return a},e.prototype.getNewScaleRange=function(){var e,i,n=t.prototype.getNewScaleRange.call(this);return(null===(e=this._spec.breaks)||void 0===e?void 0:e.length)&&(null===(i=this._break)||void 0===i?void 0:i.scope)&&(n=OA(this._break.scope).map((function(t){return n[0]+(Et(n)-n[0])*t}))),n},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e.valueToPosition=this.valueToPosition.bind(this),e},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,nz),t},e.type=L.cartesianLinearAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisLinear:VX,axisX:WX,axisY:GX},e}(RX);Tt(XX,jX);var KX=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),EX(),ij.registerComponent(XX.type,XX)},qX=function(){function e(){this._rawDomainIndex=[],this._rawDomain=[]}return e.prototype._initData=function(){var t,e=this;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(var i=function(i){var r=(null!==(t=n._spec.layers)&&void 0!==t?t:[])[n._scales.length-1-i]||{};if(!1!==r.visible&&0!==r.tickCount&&0!==r.forceTickCount){var a=n._initTickDataSet(M(M({},n._tickTransformOption()),r),i),o=new IW(n._option,a);n._tickData.push(o),a.target.addListener("change",(function(){e._onTickDataChange(o)})),n._tickDataMap||(n._tickDataMap={}),n._tickDataMap[i]=o}},n=this,r=0;r<this._scales.length;r++)i(r);else{var a=this._initTickDataSet(this._tickTransformOption()),o=new IW(this._option,a);a.target.addListener("change",(function(){e._onTickDataChange(o)})),this._tickData=[o],this._tickDataMap={0:o}}},e.prototype._updateData=function(){var t,e,i,n=this,r=this.registerTicksTransform();if(this._spec.showAllGroupLayers&&this._scales.length>1){var a=null!==(t=this._spec.layers)&&void 0!==t?t:[];Object.keys(this._tickDataMap).forEach((function(t){var e=a[n._scales.length-1-+t]||{},i=n._tickDataMap[t],o=null==i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===r}));o&&(o.options=M(M({},n._tickTransformOption()),e))}))}else{var o=null===(i=null===(e=this._tickData)||void 0===e?void 0:e[0])||void 0===i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===r}));o&&(o.options=this._tickTransformOption())}},e.prototype.getRawDomain=function(){return this._rawDomain},e.prototype.dataToPosition=function(t,e){var i,n;if(void 0===e&&(e={}),0===t.length||0===this._scales.length)return 0;var r=this.getPosition(t);return r.position+r.bandScale.bandwidth()*(null!==(n=null!==(i=e.bandPosition)&&void 0!==i?i:this._spec.bandPosition)&&void 0!==n?n:this._defaultBandPosition)},e.prototype.valueToPosition=function(t){return this._scale.scale(t)},e.prototype.updateGroupScaleRange=function(){var t=this._scale;this._scales.forEach((function(e,i){i>0&&(e.range([0,t.bandwidth()]),t=e)}))},e.prototype.getPosition=function(t){var e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{for(var n=Math.min(t.length,this._scales.length),r=0;r<n;r++)e+=this._scales[r].scale(t[r]);i=this._scales[n-1]}return{position:e,bandScale:i}},e.prototype.calcScales=function(t,e){for(var i,n,r=this._spec,a=r.bandPadding,o=r.paddingInner,s=r.paddingOuter,l=Z(a),u=Z(o),c=Z(s),h=0;h<this._scales.length;h++){var d=l?a[h]:a,p=u?o[h]:o,f=c?s[h]:s;this._scales[h].paddingInner(null!==(i=null!=p?p:d)&&void 0!==i?i:t,!0).paddingOuter(null!==(n=null!=f?f:d)&&void 0!==n?n:e,!0)}},e.prototype.computeBandDomain=function(t){if(!t.length)return[];if(1===t.length)return t[0].values;for(var e=new Set,i=0;i<t.length;i++)for(var n=0;n<t[i].values.length;n++)e.add(t[i].values[n]);return Array.from(e)},e.prototype.updateScaleDomain=function(){var e,i=this;if(this.isSeriesDataEnable()){!(null===(e=this._rawDomainIndex)||void 0===e?void 0:e.length)&&this._scales.length&&this._updateRawDomain();for(var n=this._spec.domain,r=function(t){if(n&&n.length&&0===t)a._scales[t].domain(n);else{var e=a.collectData(t),r=a.computeBandDomain(e);a._scales[t].domain(r.sort((function(e,n){return i._rawDomainIndex[t][e]-i._rawDomainIndex[t][n]})))}},a=this,o=0;o<this._scales.length;o++)r(o);this.transformScaleDomain(),this.event.emit(t.ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})}},e.prototype.getLabelItems=function(t){var e=this,i=[],n=[];return(this._spec.showAllGroupLayers?this._scales:[this._scales[0]]).forEach((function(r,a){var o,s=e._tickDataMap[a],l=null===(o=null==s?void 0:s.getLatestData())||void 0===o?void 0:o.length,u=l?s.getLatestData().map((function(t){return t.value})):r.domain();if(u&&u.length)if(n&&n.length){var c=[],h=[];n.forEach((function(i){u.forEach((function(n){var r=Dt(i).concat(n);if(h.push(r),l){var a=rX(n,e._getNormalizedValue(r,t));c.push(a)}}))})),l&&i.push(c.filter((function(t){return t.value>=0&&t.value<=1}))),n=h}else u.forEach((function(t){n.push(t)})),l&&i.push(s.getLatestData().map((function(i){return rX(i.value,e._getNormalizedValue([i.value],t))})).filter((function(t){return t.value>=0&&t.value<=1})))})),i.reverse()},e.prototype._updateRawDomain=function(){var e=this;this._rawDomainIndex=[],this._rawDomain=[];for(var i=this._spec.domain,n=function(t){if(i&&i.length&&0===t)r._scales[t].domain(i);else{var n=r.collectData(t,!0),a=r.computeBandDomain(n);r._rawDomainIndex[t]={},r._rawDomain[t]=a,a.forEach((function(i,n){return e._rawDomainIndex[t][i]=n}))}},r=this,a=0;a<this._scales.length;a++)n(a);this.event.emit(t.ChartEvent.scaleRawDomainUpdate,{model:this})},e.prototype._clearRawDomain=function(){this._rawDomainIndex=[],this._rawDomain=[]},e}(),ZX={domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},JX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.cartesianBandAxis,e._scale=new CO,e}return C(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.axisHelper=function(){var t=this,e=function(e){return void 0===e&&(e=0),t._scales[e]};return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:e,getBandwidth:function(t){return void 0===t&&(t=0),e(t).bandwidth()},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return t._inverse},getSpec:function(){return t._spec}}},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,lz),t},e.prototype.transformScaleDomain=function(){this.updateFixedWholeLength()},e.prototype.updateFixedWholeLength=function(){if(this._scale){var t=this._getOuterBandSizeFromSpec(),e=t.bandSize,i=t.maxBandSize,n=t.minBandSize;if(e&&this._scale.bandwidth(e),i&&this._scale.maxBandwidth(i),n&&this._scale.minBandwidth(n),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(e||i)){var r=gO(this._scale.domain().length,null!=e?e:i,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach((function(t){return t.setMaxWidth(r)})):["left","right"].includes(this._orient)&&this._regions.forEach((function(t){return t.setMaxHeight(r)}))}}},e.prototype._getOuterBandSizeFromSpec=function(){var t,e=this,i=this._spec,n=i.bandSize,r=i.maxBandSize,a=i.minBandSize,o=i.bandSizeLevel,s=void 0===o?0:o,l=null!==(t=this._spec.bandSizeExtend)&&void 0!==t?t:{},u=l.gap,c=l.extend,h=void 0===c?0:c;s=Math.min(s,this._scales.length-1);for(var d=function(t){var i=p._scales[t],o=i.domain(),l=i.paddingInner(),c=i.paddingOuter(),d=function(i){var n=t===s?h:0;return j(u)||t<s?gO(o.length,i,l,c)+n:(i+(q(u)?i*(Number(u.substring(0,u.length-1))/100):u))*o.length/(e._scales[t-1].paddingInner()+1)+n};W(n)&&(n=d(n)),W(r)&&(r=d(r)),W(a)&&(a=d(a))},p=this,f=s;f>0;f--)d(f);return{bandSize:n,maxBandSize:r,minBandSize:a}},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake||(null==i?void 0:i.showAllGroupLayers)===(null==e?void 0:e.showAllGroupLayers)&&St(null==i?void 0:i.layers,null==e?void 0:e.layers)||(n.reMake=!0),n},e.prototype.reInit=function(e){t.prototype.reInit.call(this),null==this||this._updateData()},e.type=L.cartesianBandAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisBand:ZX,axisX:WX,axisY:GX},e}(RX);Tt(JX,qX);var QX=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),EX(),ij.registerComponent(JX.type,JX,!1)},$X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.cartesianTimeAxis,e._zero=!1,e.effect={scaleUpdate:function(t){e.computeData(null==t?void 0:t.value),cU(e._regions,(function(t){yY(e.getOrient())?aX(t.getXAxisHelper(),e.axisHelper(),W(e._seriesUserId)||W(e._seriesIndex))&&t.setXAxisHelper(e.axisHelper()):aX(t.getYAxisHelper(),e.axisHelper(),W(e._seriesUserId)||W(e._seriesIndex))&&t.setYAxisHelper(e.axisHelper())}),{userId:e._seriesUserId,specIndex:e._seriesIndex})}},e}return C(e,t),e.prototype.setAttrFromSpec=function(){var e;t.prototype.setAttrFromSpec.call(this),this._tick=ej({},this._spec.tick,null===(e=this._spec.layers)||void 0===e?void 0:e[0])},e.prototype._initData=function(){var e;if(t.prototype._initData.call(this),null===(e=this._spec.layers)||void 0===e?void 0:e[1]){var i=new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_layer_1_ticks")}).parse(this._scale,{type:"scale"}).transform({type:"".concat(this.type,"-ticks"),options:M(M({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new IW(this._option,i)}},e.prototype.computeData=function(e){t.prototype.computeData.call(this,e),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())},e.prototype.created=function(){t.prototype.created.call(this),this._layerTickData&&(this._axisMark&&this._layerTickData.addRelatedMark(this._axisMark),this._gridMark&&this._layerTickData.addRelatedMark(this._gridMark))},e.prototype._getLabelFormatMethod=function(){var t,e,i,n,r,a,o,s,l=this,u=Ea.getInstance(),c=(null===(e=null===(t=this._spec.layers)||void 0===t?void 0:t[1])||void 0===e?void 0:e.timeFormat)||"%Y%m%d",h="local"===((null===(n=null===(i=this._spec.layers)||void 0===i?void 0:i[1])||void 0===n?void 0:n.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat,d=(null===(a=null===(r=this._spec.layers)||void 0===r?void 0:r[0])||void 0===a?void 0:a.timeFormat)||"%Y%m%d",p="local"===((null===(s=null===(o=this._spec.layers)||void 0===o?void 0:o[0])||void 0===s?void 0:s.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat;return function(t,e,i,n,r){var a,o;return o=0===r?p(d,t):h(c,t),(null===(a=l._spec.label)||void 0===a?void 0:a.formatMethod)?l._spec.label.formatMethod(o,e):o}},e.prototype.getLabelItems=function(t){var e,i,n=this,r=[],a=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();a&&a.length&&r.push(a.map((function(e){return rX(e.value,n._getNormalizedValue([e.value],t))})));var o=null===(i=this._layerTickData)||void 0===i?void 0:i.getLatestData();return o&&o.length&&r.push(o.map((function(e){return rX(e.value,n._getNormalizedValue([e.value],t))}))),r},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,nz),t},e.prototype.transformScaleDomain=function(){},e.type=L.cartesianTimeAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisX:WX,axisY:GX},e}(XX),tK=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),EX(),ij.registerComponent($X.type,$X)},eK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.cartesianLogAxis,e._zero=!1,e._scale=new ZO,e}return C(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.base(null!==(e=this._spec.base)&&void 0!==e?e:10),this._scale.clamp(!0,null,!1)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,nz),t},e.prototype.transformScaleDomain=function(){},e.type=L.cartesianLogAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisLinear:VX,axisX:WX,axisY:GX},e}(XX);Tt(eK,jX);var iK=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),EX(),ij.registerComponent(eK.type,eK)},nK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.cartesianSymlogAxis,e._zero=!1,e._scale=new $O,e}return C(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.constant(null!==(e=this._spec.constant)&&void 0!==e?e:10)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,nz),t},e.prototype.transformScaleDomain=function(){},e.type=L.cartesianSymlogAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisLinear:VX,axisX:WX,axisY:GX},e}(XX);Tt(nK,jX);var rK=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),EX(),ij.registerComponent(nK.type,nK)},aK="".concat(Mj,"_hide_");function oK(t,e){t.context.finalAttrs&&(t.context.finalAttrs.visible=e)}var sK=function(t,e){if(!e||0===e.length)return e;var i=t.direction,n=t.delta,r=t.deltaMul,a=void 0===r?1:r,o=t.groupBy,s=function(e){!function(t){t.forEach((function(t){t[aK]&&(oK(t,!0),t[aK]=!1)}))}(e);var r=t.sort?e.slice().sort((function(t,e){return t.context.finalAttrs.x-e.context.finalAttrs.x})):e;0===i?function(t,e,i){var n=-1/0,r=0,a=j(e),o=e;t.forEach((function(t){if(!1!==t.context.finalAttrs.visible){var e=t.context.finalAttrs.size/2,s=t.context.finalAttrs,l=s.x,u=s.y;a&&(o=(e+r)*i),Math.pow(-1/0-l,2)+Math.pow(n-u,2)<Math.pow(o+r+e,2)?t.context.finalAttrs.forceShow||(t[aK]=!0,oK(t,!1)):n=u,r=e}}))}(r,n,a):1===i?function(t,e,i){var n=-1/0,r=0,a=j(e),o=e;t.forEach((function(t){if(!1!==t.context.finalAttrs.visible){var e=t.context.finalAttrs.size/2,s=t.context.finalAttrs.x;a&&(o=(e+r)*i),Math.abs(s-n)<o+r+e?t.context.finalAttrs.forceShow||(t[aK]=!0,oK(t,!1)):n=s,r=e}}))}(r,n,a):function(t,e,i){var n=-1/0,r=0,a=j(e),o=e;t.forEach((function(t){if(!1!==t.context.finalAttrs.visible){var e=t.context.finalAttrs.size/2,s=t.context.finalAttrs.y;a&&(o=(e+r)*i),Math.abs(s-n)<o+r+e?t.context.finalAttrs.forceShow||(t[aK]=!0,oK(t,!1)):n=s,r=e}}))}(r,n,a)};if(o){var l=e.reduce((function(t,e){var i,n,r=null===(n=null===(i=e.context.data)||void 0===i?void 0:i[0])||void 0===n?void 0:n[o];return t[r]?t[r].push(e):t[r]=[e],t}),{});Object.keys(l).forEach((function(t){s(l[t])}))}else s(e);return e},lK=function(){ij.registerGrammarTransform("symbolOverlap",{transform:sK,runType:"afterEncode"})},uK={min:Pt,max:Bt,average:aU,sum:rU};function cK(t,e,i,n){var r,a,o,s=Math.floor(e.length/t),l=[],u=e.length,c=0,h=0;l[h++]=c;for(var d=1;d<u-1;d+=s){for(var p=Math.min(d+s,u-1),f=Math.min(d+2*s,u),v=(f+p)/2,g=0,y=p;y<f;y++){var m=e[y][n];Number.isNaN(m)||(g+=m)}g/=f-p;var _=d,b=Math.min(d+s,u),x=d-1,k=e[c][n];r=-1,o=_;for(y=_;y<b;y++){m=e[y][n];Number.isNaN(n)||(a=Math.abs((x-v)*(m-k)-(x-y)*(g-k)))>r&&(r=a,o=y)}l[h++]=o,c=o}l[h-1]!==u-1&&(l[h++]=u-1);var S=l.map((function(t){return i?e[t].i:t}));return S}function hK(t,e,i,n,r){var a=Math.floor(e.length/t),o=[],s=e.length,l=0,u=[];o.push(l),e[l][r]=e[l][r];for(var c=1;c<s-1;c+=a){a>s-c&&(a=s-c,u.length=a),u=[];for(var h=0;h<a;h++)u.push(e[c+h][r]);var d=uK[n](u);l=Math.min(Math.round(c+u.length/2)||0,s-1),e[l][r]=d,o.push(l)}var p=o.map((function(t){return i?e[t].i:t}));return p}function dK(t,e,i,n){return hK(t,e,i,"min",n)}function pK(t,e,i,n){return hK(t,e,i,"max",n)}function fK(t,e,i,n){return hK(t,e,i,"average",n)}function vK(t,e,i,n){return hK(t,e,i,"sum",n)}var gK=function(t,e){var i,n,r=U(t.size)?t.size():t.size,a=t.factor||1;if(Array.isArray(r)&&(r=Math.floor(r[1]-r[0])),(r*=a)<=0)return[];if(e.length<=r)return e;if(t.skipfirst)return e.slice(0,1);var o=t.mode,s=t.yfield,l=t.groupBy,u=null!=s?s:"y",c=cK;if("min"===o?c=dK:"max"===o?c=pK:"average"===o?c=fK:"sum"===o&&(c=vK),e.length){var h={};if(l){for(var d=0,p=e.length;d<p;d++){var f=e[d],v=f[l];h[v]?h[v].push(((i={})[u]=f[u],i.i=d,i)):(h[v]=[],h[v].push(((n={})[u]=f[u],n.i=d,n)))}var g=[];return Object.keys(h).forEach((function(t){var i=h[t];if(i.length<=r){var n=i.map((function(t){return t.i}));g=g.concat(n)}else{n=c(r,i,!0,u);g=g.concat(n),i.forEach((function(t){return e[t.i][u]=t[u]}))}})),g.sort((function(t,e){return t-e})),g.map((function(t){return e[t]}))}return c(r,e,!1,u).map((function(t){return e[t]}))}return[]},yK=function(){ij.registerGrammarTransform("dataSampling",{transform:gK})},mK={label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},_K=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.line,i.transformerConstructor=VY,i._sortDataByAxis=!1,i}return C(i,e),i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"line";this.initLineMark("line"===e),this.initSymbolMark("point"===e)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.group,n=t.mark;this._lineMark&&i.add(this._lineMark),this._symbolMark&&(n.add(this._symbolMark),i.add(this._symbolMark))},i.prototype.initMarkStyle=function(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._lineMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("line"))||void 0===i?void 0:i(r,a),rY("line",this._spec,this._markAttributeContext))),this._symbolMark){var o=vY(this);this._symbolMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),rY("point",this._spec,this._markAttributeContext),o))}},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e,i=this,n="point"!==(null===(e=this._spec)||void 0===e?void 0:e.seriesMark);return function(e){var r,a;return n&&"fill"===e&&(e="stroke"),null!==(a=null===(r=i._seriesMark)||void 0===r?void 0:r.getAttribute(e,t))&&void 0!==a?a:void 0}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._lineMark,this._symbolMark]},i.type=t.SeriesTypeEnum.line,i.mark=IY,i.builtInTheme={line:mK},i.transformerConstructor=VY,i}(gY);Tt(_K,LY);var bK,xK=function(){yK(),lK(),NY(),jY(),nG(),tG(),QX(),KX(),ij.registerSeries(_K.type,_K)},kK=function(){function t(t){this._dataArr=[],this._dataSet=t}return Object.defineProperty(t.prototype,"dataList",{get:function(){return this._dataArr},enumerable:!1,configurable:!0}),t.prototype.parseData=function(t){this._dataArr=[];for(var e=Dt(t),i=0;i<e.length;i++)this._dataArr.push(WV(e[i],this._dataSet,this._dataArr))},t.prototype.updateData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);var n=Dt(t);return(!e||n.length===this._dataArr.length)&&(this._dataValueForEach(n,(function(t,e){e.markRunning()})),this._dataValueForEach(n,(function(t,e){GV(e,t,i)})),!0)},t.prototype._dataValueForEach=function(t,e){var i=this;t.forEach((function(t,n){if(!(t instanceof cc)){var r=i.getSeriesData(t.id,n);r&&e(t,r,n)}}))},t.prototype.getSeriesData=function(t,e){if(!this._dataArr.length)return null;if("string"==typeof t){var i=this._dataArr.filter((function(e){return e.name===t}));if(i[0])return i[0];NA("no data matches dataId ".concat(t,"!"))}if("number"==typeof e){if(this._dataArr[e])return this._dataArr[e];NA("no data matches dataIndex ".concat(e,"!"))}return this._dataArr[0]},t}(),SK=function(){function t(t,e){var i=this;this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=function(t){var e=[];return i._scaleSpecMap.forEach((function(i,n){JA(i.domain)&&i.domain.forEach((function(n){n.dataId===t&&n.fields.forEach((function(t){Qj(e,[{key:t,operations:tO(i.type)?["max","min"]:["values"]}])}))}))})),i._markAttributeScaleMap.forEach((function(n,r){var a=i.getScale(r);n.forEach((function(n){i._getSeriesBySeriesId(n.seriesId).getRawData().name===t&&n.field&&Qj(e,[{key:n.field,operations:tO(a.type)?["max","min"]:["values"]}])}))})),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}return t.prototype._createFromSpec=function(t){if(!t.id)return null;var e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?BU("colorOrdinal"):BU(t.type)),e?(Z(t.range)&&e.range(t.range),Z(t.domain)&&(JA(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),t.clamp&&e.clamp&&e.clamp(t.clamp),e):null},t.prototype._setAttrFromSpec=function(){var t,e=this;if(null===(t=this._spec)||void 0===t?void 0:t.length){var i=new Map,n=new Map;this._spec.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._modelScaleSpecMap.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._scaleSpecMap=n,this._scaleMap=i}},t.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(St(t,this._spec))return e;e.change=!0;for(var i=function(i){var r=t[i],a=n._scaleMap.get(r.id);if(!a)return e.reMake=!0,{value:e};var o=n._spec.find((function(t){return t.id===r.id}));return o.id?o.type!==r.type?(e.reMake=!0,{value:e}):St(o.specified,r.specified)?(r.range&&!St(r.range,a.range())&&(a.range(r.range),e.reRender=!0),JA(r.domain)?e.reRender=!0:St(r.domain,a.domain())||(a.domain(r.domain),e.reRender=!0),void n._scaleSpecMap.set(r.id,r)):(e.reMake=!0,{value:e}):(e.reMake=!0,{value:e})},n=this,r=0;r<t.length;r++){var a=i(r);if("object"==typeof a)return a.value}return this._spec=t,e},t.prototype.registerModelScale=function(t){var e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))},t.prototype.removeModelScale=function(t){var e=this;this._modelScaleSpecMap.forEach((function(i){t(i)&&(e._modelScaleSpecMap.delete(i.id),e._scaleSpecMap.delete(i.id),e._scaleMap.delete(i.id))}))},t.prototype.getScale=function(t){return this._scaleMap.get(t)},t.prototype.getScaleSpec=function(t){return this._scaleSpecMap.get(t)},t.prototype._getSeriesByRawDataId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.getRawData().name===t)return n}return null},t.prototype._getSeriesBySeriesId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return null},t.prototype.updateScaleDomain=function(t){var e=this;this._scaleSpecMap.forEach((function(i,n){var r=e._scaleMap.get(n);if(r){if(!JA(i.domain))return i.domain&&0!==i.domain.length||r.domain(t),void e._updateMarkScale(n,r,r.domain().slice());var a;a=tO(i.type)?[null,null]:new Set,i.domain.forEach((function(t){var n=e._getSeriesByRawDataId(t.dataId);if(n){var r=tO(i.type);t.fields.forEach((function(t){var e=n.getRawDataStatisticsByField(t,r);e&&(r?(j(a[0])?a[0]=e.min:a[0]=Math.min(e.min,a[0]),j(a[1])?a[1]=e.max:a[1]=Math.max(e.max,a[1])):e.values.forEach((function(t){a.add(t)})))}))}}));var o=a;tO(i.type)||(a=Array.from(a)),r.domain(a),e._updateMarkScale(n,r,o)}}))},t.prototype._updateMarkScale=function(t,e,i){var n=this,r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach((function(t){if(t.field&&t.markScale&&t.markScale!==e)if(j(t.changeDomain)||"none"===t.changeDomain||j(t.seriesId))tO(e.type)?t.markScale.domain(i):e.domain(Array.from(i));else{var r=n._getSeriesBySeriesId(t.seriesId),a=tO(e.type),o=r.getRawDataStatisticsByField(t.field,a);if(!ct(o))return"expand"===t.changeDomain?(a?(i[0]=Math.min(i[0],o.min),i[1]=Math.max(i[1],o.max)):(o.values.forEach((function(t){i.add(t)})),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(a?t.markScale.domain([o.min,o.max]):t.markScale.domain(o.values)));tO(e.type)?t.markScale.domain(i):e.domain(Array.from(i))}}))},t.prototype.registerMarkAttributeScale=function(t,e){var i=this._scaleMap.get(t.scale),n=this._markAttributeScaleMap.get(t.scale);n||(n=[],this._markAttributeScaleMap.set(t.scale,n));var r=i;return(j(t.field)||!j(t.changeDomain)&&"none"!==t.changeDomain&&!j(e))&&(r=i.clone()),n.push(M(M({},t),{seriesId:e,markScale:r})),r},t}(),AK=function(){function t(){this._stateGraphicsByTrigger=new Map,this._disableTriggerEvent=!1,this._triggerMapByState=new Map}return t.prototype.setDisableActiveEffect=function(t){this._disableTriggerEvent=t},t.prototype.addTrigger=function(t){var e=this;t&&[t.getStartState(),t.getResetState()].forEach((function(i){if(i){var n=e._triggerMapByState.get(i);n?!n.includes(t)&&n.push(t):e._triggerMapByState.set(i,[t])}}))},t.prototype.setStatedGraphics=function(t,e){this._stateGraphicsByTrigger.set(t,e)},t.prototype.getStatedGraphics=function(t){return this._stateGraphicsByTrigger.get(t)},t.prototype.updateStates=function(t,e,i,n,r){return this._disableTriggerEvent?[]:e&&e.length?(n&&r?i&&i.length?(this.toggleReverseStateOfGraphics(t,e,i,r),this.toggleStateOfGraphics(t,e,i,n)):this.addBothStateOfGraphics(t,e,n,r):n&&(i&&i.length?this.toggleStateOfGraphics(t,e,i,n):this.addStateOfGraphics(t,e,n)),e):[]},t.prototype.toggleReverseStateOfGraphics=function(t,e,i,n){var r=t.getMarkIdByState();i.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(n,!0,a)}})),e.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(n,a)}}))},t.prototype.toggleStateOfGraphics=function(t,e,i,n){var r=t.getMarkIdByState();i.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(n,a)}})),e.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(n,!0,a)}}))},t.prototype.addBothStateOfGraphics=function(t,e,i,n){var r=t.getMarks(),a=t.getMarkIdByState();r.forEach((function(t){var r,o=n&&a[n]&&a[n].includes(t.id),s=i&&a[i]&&a[i].includes(t.id);if(o||s){var l=t.hasAnimationByState&&t.hasAnimationByState("state");null===(r=t.getGraphics())||void 0===r||r.forEach((function(t){e&&e.includes(t)?s&&t.addState(i,!0,l):o&&t.addState(n,!0,l)}))}}))},t.prototype.addStateOfGraphics=function(t,e,i){var n=t.getMarks(),r=t.getMarkIdByState();n.forEach((function(t){var n,a=i&&r[i]&&r[i].includes(t.id);if(a){var o=t.hasAnimationByState&&t.hasAnimationByState("state");null===(n=t.getGraphics())||void 0===n||n.forEach((function(t){e&&e.includes(t)&&a&&t.addState(i,!0,o)}))}}))},t.prototype.clearAllStatesOfTrigger=function(t,e,i){if(!this._disableTriggerEvent){var n=this.getStatedGraphics(t);if(n&&n.length){var r=t.getMarks(),a=t.getMarkIdByState();r.forEach((function(t){if(t){var r=t.getGraphics(),o=t.hasAnimationByState&&t.hasAnimationByState("state");r&&r.length&&(i&&a[i]&&a[i].includes(t.id)&&r.forEach((function(t){t.removeState(i,o)})),e&&a[e]&&a[e].includes(t.id)&&r.forEach((function(t){n.includes(t)&&t.removeState(e,o)})))}}))}}},t.prototype.clearAllStates=function(){var t=this;this._disableTriggerEvent||this._triggerMapByState.forEach((function(e,i){e.forEach((function(e){t.clearAllStatesOfTrigger(e,i,e.getResetState())}))}))},t.prototype.clearByState=function(t){var e=this;if(!this._disableTriggerEvent){var i=this._triggerMapByState.get(t);i&&i.length&&i.forEach((function(i){e.clearAllStatesOfTrigger(i,t,i.getResetState()),e.setStatedGraphics(i,[])}))}},t.prototype.updateStateOfGraphics=function(t,e){var i=this;if(!this._disableTriggerEvent){var n=this._triggerMapByState.get(t);n&&n.length&&n.forEach((function(t){var n=e.filter((function(e){return t.getMarks().some((function(t){var i=t&&t.getGraphics();return i&&i.includes(e)}))}));i.updateStates(t,n,i.getStatedGraphics(t),t.getStartState(),t.getResetState()),i.setStatedGraphics(t,n)}))}},t}(),CK=function(e){function i(t,i){var n,r,a,o=this;return(o=e.call(this,i)||this).type="chart",o.id=qA(),o._regions=[],o._series=[],o._components=[],o._layoutRect={x:0,y:0,width:wj,height:Tj},o._viewRect={width:wj,height:Tj},o._viewBox={x1:0,y1:0,x2:wj,y2:Tj},o._layoutTag=!0,o._idMap=new Map,o.state={layoutUpdateRank:1},o.padding={top:0,left:0,right:0,bottom:0},o.getAllSeries=function(){var t;return null!==(t=o._series)&&void 0!==t?t:[]},o.getRegionsInIndex=function(t){return t&&0!==t.length?o._regions.filter((function(e,i){return t.includes(i)})):[o._regions[0]]},o.getAllRegions=function(){return o._regions},o.getRegionsInIds=function(t){return t?o._regions.filter((function(e){return t.includes(e.id)})):[]},o.getRegionsInQuerier=function(t){return t?o._regions.filter((function(e,i){return Dt(t).some((function(t){return W(t.regionId)&&t.regionId===e.userId||t.regionIndex===i}))})):o._regions},o.getRegionsInUserId=function(t){if(t)return o._regions.find((function(e){return e.userId===t}))},o.getRegionsInUserIdOrIndex=function(t,e){return o.getAllRegions().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},o.getComponents=function(){return o._components},o.getSeriesInIndex=function(t){return t&&0!==t.length?o._series.filter((function(e,i){return t.includes(i)})):[o._series[0]]},o.getSeriesInIds=function(t){return t?o._series.filter((function(e){return t.includes(e.id)})):[]},o.getSeriesInUserId=function(t){if(t)return o._series.find((function(e){return e.userId===t}))},o.getSeriesInUserIdOrIndex=function(t,e){return o.getAllSeries().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},o.getComponentByIndex=function(t,e){var i=o._components.filter((function(e){return(e.specKey||e.type)===t}));if(i&&0!==i.length)return i[e]},o.getComponentsByKey=function(t){return o._components.filter((function(e){return(e.specKey||e.type)===t}))},o.getComponentByUserId=function(t){var e=o._components.find((function(e){return e.userId===t}));if(e)return e},o.getComponentsByType=function(t){return o._components.filter((function(e){return e.type===t}))},o._paddingSpec=jU(null!==(n=t.padding)&&void 0!==n?n:i.getTheme("padding")),o._event=new xV(i.eventDispatcher,i.mode),o._dataSet=i.dataSet,o._chartData=new kK(o._dataSet),o._modelOption=M(M({},i),{mode:o._option.mode,map:o._idMap,getChartLayoutRect:function(){return o._layoutRect},getChartViewRect:function(){return o._viewRect},getChart:function(){return o},globalScale:o._globalScale,onError:null===(r=o._option)||void 0===r?void 0:r.onError,disableTriggerEvent:!0===(null===(a=o._option)||void 0===a?void 0:a.disableTriggerEvent),getSeriesData:o._chartData.getSeriesData.bind(o._chartData),dispatchEvent:function(t,e){return o._option.globalInstance.event.emit(t,e)}}),o._setModelOption&&o._setModelOption(),o._spec=t,o}return C(i,e),i.prototype.getSpec=function(){return this._spec},i.prototype.setSpec=function(t){this._spec=t},i.prototype.getOption=function(){return this._option},i.prototype.getLayoutRect=function(){return this._layoutRect},i.prototype.getViewRect=function(){return this._viewRect},i.prototype.getLayoutTag=function(){return this._layoutTag},i.prototype.setLayoutTag=function(t,e,i){void 0===i&&(i=!0),this._layoutTag=t;var n=this.getCompiler();return n&&(n.updateLayoutTag(),t&&i&&n.renderNextTick(e)),this._layoutTag},i.prototype.resetLayoutItemTag=function(){this.getLayoutElements().forEach((function(t){return t.setWillLayoutTag()}))},i.prototype.getModelOption=function(){return this._modelOption},i.prototype.getGlobalScale=function(){return this._globalScale},i.prototype.getEvent=function(){return this._event},Object.defineProperty(i.prototype,"chartData",{get:function(){return this._chartData},enumerable:!1,configurable:!0}),i.prototype._setModelOption=function(){},i.prototype.created=function(t){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),t.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),t.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),t.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())},i.prototype._initInteractions=function(){var t=this;if(!this._option.disableTriggerEvent){this._interaction=new AK;var e=this.getAllSeries(),i=[],n={};e.forEach((function(t){var e=t.getInteractionTriggers();if(e&&e.length){var r=t.getRegion().id;e.forEach((function(t){var e=t.trigger,a=t.marks,o="".concat(r,"-").concat(e.type);n[o]?a.forEach((function(t){n[o].marks.push(t)})):(n[o]=M(M({},e),{marks:a}),i.push(n[o]))}))}})),i.forEach((function(e){var i=ij.createInteractionTrigger(e.type,M(M({},e),{event:t._event,interaction:t._interaction}));i&&(i.init(),t._interaction.addTrigger(i))}))}},i.prototype.init=function(){var t,e,i=this;null===(t=this._beforeInit)||void 0===t||t.call(this),this._regions.forEach((function(t){return t.init({})})),this._series.forEach((function(t){return t.init({})})),this._components.forEach((function(t){return t.init({dataSet:i._dataSet})})),this._initEvent(),null===(e=this._initStack)||void 0===e||e.call(this),this.reDataFlow(),this._initInteractions()},i.prototype.reDataFlow=function(){this._series.forEach((function(t){var e;return null===(e=t.getRawData())||void 0===e?void 0:e.markRunning()})),this._series.forEach((function(t){return t.fillData()})),this.updateGlobalScaleDomain()},i.prototype.onResize=function(t,e,i){void 0===i&&(i=!0);var n={width:t,height:e};this._canvasRect=n,this._updateLayoutRect(this._option.viewBox),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,i)},i.prototype.updateViewBox=function(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,e)},i.prototype._createBackground=function(){var e=this,i=this._spec.background;if(i&&"object"==typeof i&&!W(i.gradient)){var n=bt(i,["x","y","width","height","x1","y1","image"]);n.background=i.image,this._backgroundMark=ij.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(M(M({},n),{x:function(){return e._viewBox.x1},y:function(){return e._viewBox.y1},width:function(){return e._viewBox.x2-e._viewBox.x1},height:function(){return e._viewBox.y2-e._viewBox.y1}})),this._backgroundMark.setMarkConfig({zIndex:t.LayoutZIndex.SeriesGroup-2}),this.getCompiler().addRootMark(this._backgroundMark)}},i.prototype._createRegion=function(t,e){if(t){var i=e.spec,n=w(e,["spec"]),r=new t(i,M(M({},this._modelOption),n));r&&(r.created(),this._regions.push(r))}},i.prototype._createSeries=function(t,e){if(t){var i,n=e.spec,r=w(e,["spec"]);if(W(n.regionId)?i=this.getRegionsInUserId(n.regionId):W(n.regionIndex)&&(i=this.getRegionsInIndex([n.regionIndex])[0]),i||(i=this._regions[0])){var a=new t(n,M(M(M({},this._modelOption),r),{type:n.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));a&&(a.created(),this._series.push(a),i.addSeries(a))}}},i.prototype.getSeriesById=function(t){return this._series.find((function(e){return e.id===t}))},i.prototype._createComponent=function(t,e){var i=t.createComponent(e,M(M({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))},i.prototype.getAllComponents=function(){return this._components},i.prototype.getAllModels=function(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())},i.prototype.getModelInFilter=function(t){if(q(t))return this.getAllModels().find((function(e){return e.userId===t}));if(U(t))return this.getAllModels().find((function(e){return t(e)}));var e=0;return this.getAllModels().find((function(i){var n;if((null!==(n=i.specKey)&&void 0!==n?n:i.type)===t.type){if(e===t.index)return!0;e++}return!1}))},i.prototype._createLayout=function(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()},i.prototype.setLayout=function(t){this._option.layout=t,this._initLayoutFunc()},i.prototype._initLayoutFunc=function(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){var n=ij.getLayoutInKey(null!==(e=null===(t=this._spec.layout)||void 0===t?void 0:t.type)&&void 0!==e?e:"base");if(n){var r=new n(this._spec.layout,{onError:null===(i=this._option)||void 0===i?void 0:i.onError});this._layoutFunc=r.layoutItems.bind(r)}}},i.prototype.layout=function(){var e,i,n,r;if(null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeLayoutWithSceneGraph)||void 0===i||i.call(e,this._option.globalInstance),this.getLayoutTag()){this._event.emit(t.ChartEvent.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart();var a=this.getLayoutElements();this._layoutFunc(this,a,this._layoutRect,this._viewBox),this._event.emit(t.ChartEvent.afterLayout,{elements:a,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(),this._event.emit(t.ChartEvent.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterLayoutWithSceneGraph)||void 0===r||r.call(n,this._option.globalInstance)},i.prototype.onLayoutStart=function(){var t=this;this.getAllModels().forEach((function(e){return e.onLayoutStart(t._layoutRect,t._viewRect)}))},i.prototype.onLayoutEnd=function(){this.getAllModels().forEach((function(t){"series"!==t.modelType&&t.onLayoutEnd()}))},i.prototype.onEvaluateEnd=function(t){P(P(P([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(e){return e.onEvaluateEnd(t)}))},i.prototype.onBeforeRender=function(){P(P(P([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(t){return t.onBeforeRender()}))},i.prototype.getLayoutElements=function(){return this.getAllModels().map((function(t){return t.layout})).filter((function(t){return!!t}))},i.prototype.getModelById=function(t){var e=this._idMap.get(t);if(e&&e instanceof hW)return e},i.prototype.getModelByUserId=function(t){var e=this.getSeriesInUserId(t);if(e)return e;var i=this.getRegionsInUserId(t);if(i)return i;var n=this.getComponentByUserId(t);return n||void 0},i.prototype.getAllMarks=function(){return Array.from(this._idMap.values()).filter((function(t){return t&&t instanceof NW}))},i.prototype.getMarkById=function(t){var e=this._idMap.get(t);if(e&&e instanceof NW)return e},i.prototype.getMarkByUserName=function(t){return this.getAllMarks().filter((function(e){return e.name&&e.name===t}))},i.prototype.updateData=function(t,e,i,n){void 0===i&&(i=!0);var r=this._dataSet.getDataView(t);r&&(r.markRunning(),r.parseNewData(e,n)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.updateFullData=function(t,e){var i=this;void 0===e&&(e=!0),Dt(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&e.markRunning()})),Dt(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&GV(e,t,!0)})),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.setCanvasRect=function(t,e){this._canvasRect={width:t,height:e}},i.prototype.getCanvasRect=function(){return this._canvasRect||(this._canvasRect=iW(this._spec,this._option,{width:wj,height:Tj})),this._canvasRect},i.prototype.getSeriesData=function(t,e){return this._chartData.getSeriesData(t,e)},i.prototype._transformSpecScale=function(){var t,e=this._spec.scales?P([],B(this._spec.scales),!1):[],i=e.find((function(t){return"color"===t.id})),n=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){var r=this._spec.color;if(Z(r))i.range=r;else{var a=r;Object.prototype.hasOwnProperty.call(a,"type")&&(i.type=a.type),Object.prototype.hasOwnProperty.call(a,"domain")&&(i.domain=a.domain),Object.prototype.hasOwnProperty.call(a,"range")&&(i.range=a.range),Object.prototype.hasOwnProperty.call(a,"specified")&&(i.specified=a.specified),Object.prototype.hasOwnProperty.call(a,"clamp")&&(i.clamp=a.clamp)}}return(null===(t=i.range)||void 0===t?void 0:t.length)||(i.range=xU(n),i.rangeTheme=!0),e},i.prototype._createGlobalScale=function(){this._globalScale=new SK(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale},i.prototype.updateGlobalScaleDomain=function(){var t=new Set;this._series.forEach((function(e){var i=e.getSeriesKeys();i&&i.forEach((function(e){return t.add(e)}))}));var e=Array.from(t);this._globalScale.updateScaleDomain(e)},i.prototype.updateGlobalScale=function(t){nW(t,this._globalScale.updateSpec(this._transformSpecScale()))},i.prototype.updateGlobalScaleTheme=function(){var t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=xU(e),this._globalScale.getScale("color").range(t.range))},i.prototype._getSpecKeys=function(t){var e={width:!0,height:!0};return Object.keys(t).filter((function(t){return!e[t]})).sort()},i.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;var i=this._getSpecKeys(this._spec);if(!St(i,this._getSpecKeys(t)))return e.reMake=!0,e;for(var n=0;n<i.length;n++){var r=i[n];if(Z(this._spec[r])&&this._spec[r].length!==Dt(t[r]).length)return e.reMake=!0,e}var a=this._spec;return this._spec=t,this.updateChartConfig(e,a),e.reMake?e:(this.updateGlobalScale(e),e.reMake?e:(this.updateRegionSpec(e),e.reMake?e:(this.updateComponentSpec(e),e.reMake?e:(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()),e))))},i.prototype.updateChartConfig=function(t,e){var i,n;this._paddingSpec=jU(null!==(i=this._spec.padding)&&void 0!==i?i:null===(n=this._option)||void 0===n?void 0:n.getTheme("padding")),this._updateLayoutRect(this._viewBox)},i.prototype.updateDataSpec=function(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)},i.prototype.updateRegionSpec=function(t){var e,i=this;(null===(e=this._spec)||void 0===e?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach((function(e){nW(t,e.updateSpec(i._spec.region[e.getSpecIndex()]))})):t.reMake=!0)},i.prototype.updateComponentSpec=function(t){var e,i=this,n={},r=((e={})[L.title]=!0,e[L.brush]=!0,e[L.indicator]=!0,e);for(var a in this._components.forEach((function(e){var a,o;if(e.type!==L.label&&e.type!==L.totalLabel){r[e.type]&&(r[e.type]=!1);var s=e.specKey||e.type,l=null!==(a=i._spec[s])&&void 0!==a?a:{};Z(l)?(n[s]=n[s]||{specCount:l.length,componentCount:0},n[s].componentCount++,nW(t,e.updateSpec(null!==(o=l[e.getSpecIndex()])&&void 0!==o?o:{},l))):nW(t,e.updateSpec(l))}})),n)if(Object.prototype.hasOwnProperty.call(n,a)){var o=n[a];o.componentCount!==o.specCount&&(t.reMake=!0)}var s=function(t){return t&&!1!==t.visible};Object.keys(r).forEach((function(e){if(r[e]){var n=i._spec[e];(Z(n)?n.some(s):s(n))&&(t.reMake=!0)}}))},i.prototype.updateSeriesSpec=function(t){var e=this;this._spec.series.length===this._series.length?this._series.forEach((function(i){var n=e._spec.series[i.getSpecIndex()];nW(t,i.updateSpec(n))})):t.reMake=!0},i.prototype.getCanvas=function(){var t,e;return null!==(e=null===(t=this.getCompiler())||void 0===t?void 0:t.getCanvas())&&void 0!==e?e:null},i.prototype._updateLayoutRect=function(e){var i=this.getCanvasRect();if(e){this._viewBox=e;var n=e.x1,r=void 0===n?0:n,a=e.y1,o=void 0===a?0:a;i={width:e.x2-r,height:e.y2-o}}else this._viewBox={x1:0,y1:0,x2:i.width,y2:i.height};this._viewRect=i,this.padding=NU(this._paddingSpec,i,i),this._layoutRect.width=i.width-this.padding.left-this.padding.right,this._layoutRect.height=i.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(t.ChartEvent.layoutRectUpdate,{chart:this})},i.prototype.setCurrentTheme=function(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()},i.prototype.reInit=function(){P(P(P([],B(this._regions),!1),B(this._series),!1),B(this._components),!1).forEach((function(t){var e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)}))},i.prototype.clear=function(){this.getAllModels().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},i.prototype.compile=function(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()},i.prototype.afterCompile=function(){this.getAllRegions().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllSeries().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllComponents().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)}))},i.prototype.compileLayout=function(){var t=this.getCanvasRect(),e=t.width,i=t.height;this.getCompiler().setSize(e,i)},i.prototype.compileBackground=function(){this._backgroundMark&&this._backgroundMark.compile()},i.prototype.compileRegions=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeRegionCompile)||void 0===e||e.call(t,this._option.globalInstance),this.getAllRegions().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterRegionCompile)||void 0===n||n.call(i,this._option.globalInstance)},i.prototype.compileSeries=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeSeriesCompile)||void 0===e||e.call(t,this._option.globalInstance),this.getAllSeries().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterSeriesCompile)||void 0===n||n.call(i,this._option.globalInstance)},i.prototype.compileComponents=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeComponentCompile)||void 0===e||e.call(t,this._option.globalInstance),this.getAllComponents().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterComponentCompile)||void 0===n||n.call(i,this._option.globalInstance)},i.prototype.release=function(){P(P(P([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(t){t.beforeRelease()})),e.prototype.release.call(this),this.clear(),P(P(P([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(t){t.release()})),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()},i.prototype.onLayout=function(){this.layout()},i.prototype.updateState=function(t,e){var i=this.getAllSeries(),n=function(n){if(ct(t[n]))return"continue";var r=t[n],a={stateValue:n};a=U(r.filter)?M({filter:r.filter},a):M(M({},r.filter),a),r.level&&(a.level=r.level),i.forEach((function(t){t.getMarks().forEach((function(i){i.stateStyle[n]&&(e&&!e(t,i,n)||(i.state.changeStateInfo(a),i.updateMarkState(n)))}))}))};for(var r in t)n(r)},i.prototype.setSelected=function(e,i,n){this._setStateInDatum(t.STATE_VALUE_ENUM.STATE_SELECTED,e,i,n)},i.prototype.setHovered=function(e,i,n){this._setStateInDatum(t.STATE_VALUE_ENUM.STATE_HOVER,e,i,n)},i.prototype.clearState=function(t){this._interaction.clearByState(t)},i.prototype.clearAllStates=function(){this._interaction.clearAllStates()},i.prototype.clearSelected=function(){this.clearState(t.STATE_VALUE_ENUM.STATE_SELECTED)},i.prototype.clearHovered=function(){this.clearState(t.STATE_VALUE_ENUM.STATE_HOVER)},i.prototype._initEvent=function(){var e=this;[t.ChartEvent.dataZoomChange,t.ChartEvent.scrollBarChange].forEach((function(t){e._event.on(t,(function(t){t.value,e._disableMarkAnimation(["exit","update"]);var i=function(){e._enableMarkAnimation(["exit","update"]),e._event.off(gV.AFTER_MARK_RENDER_END,i)};e._event.on(gV.AFTER_MARK_RENDER_END,i)}))}))},i.prototype._enableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){return e.enableAnimationByState(t)}))},i.prototype._disableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){return e.disableAnimationByState(t)}))},i.prototype.filterGraphicsByDatum=function(t,e){var i;void 0===e&&(e={});var n=(t=t?Dt(t):null)?Object.keys(t[0]):null,r=[],a=null!==(i=e.getDatum)&&void 0!==i?i:mV;return this.getRegionsInQuerier(e.region).forEach((function(i){var o=[];t&&i.getSeries().forEach((function(s){s.getMarks().forEach((function(l){var u=l.getGraphics();if(u&&u.length&&(!e.filter||U(e.filter)&&e.filter(s,l)))if(yV(l.type))u.filter((function(u){var c=a(u,l,s,i),h=c&&t.every((function(t,e){return n.every((function(i){return t[i]==c[e][i]}))}));h&&(o.push(u),r.push(u),e.callback&&e.callback(u,l,s,i))}));else if(t.length>1){var c=t.slice();u.forEach((function(t){var u=a(t,l,s,i),h=u&&c.findIndex((function(t){return n.every((function(e){return t[e]==u[e]}))}));h>=0&&(c.splice(h,1),o.push(t),r.push(t),e.callback&&e.callback(t,l,s,i))}))}else{var h=u.find((function(e){var r=a(e,l,s,i);return r&&n.every((function(e){return t[0][e]==r[e]}))}));h&&(o.push(h),r.push(h),e.callback&&e.callback(h,l,s,i))}}))})),e.regionCallback&&e.regionCallback(o,i)})),r},i.prototype._setStateInDatum=function(t,e,i,n){if(e){var r=this.filterGraphicsByDatum(e,{filter:i,region:n});this._interaction.updateStateOfGraphics(t,r)}else this._interaction.clearByState(t)},i.prototype.setDimensionIndex=function(e,i){var n,r,a=null;Array.from(this._event.getComposedEventMap().values()).forEach((function(n){var r=n.eventType,o=n.event;if(r===t.DimensionEventEnum.dimensionHover||r===t.DimensionEventEnum.dimensionClick){var s=o.dispatch(e,i);(null==s?void 0:s.length)&&(a=s)}}));var o=j(e)||!a||a.every((function(t){return iO(t.axis.getScale().type)&&j(t.index)})),s=o||a.every((function(t){return iO(t.axis.getScale().type)&&t.data.every((function(t){return 0===t.datum.length}))}));if(!1!==i.tooltip){var l=this.getComponentsByType(L.tooltip)[0];if(null==l?void 0:l.getVisible())if(o||s)null===(r=(n=l).hideTooltip)||void 0===r||r.call(n);else{var u={};a.forEach((function(t){var e=t.axis,i=t.value,n=t.data,r="left"===e.getOrient()||"right"===e.getOrient();n.forEach((function(t){var e,n,a,o=r?t.series.fieldY[0]:t.series.fieldX[0];u[o]=null!==(a=null===(n=null===(e=t.datum)||void 0===e?void 0:e[0])||void 0===n?void 0:n[o])&&void 0!==a?a:i}))})),l.showTooltip(u,i.showTooltipOption)}}if(!1!==i.crosshair){var c=this.getComponentsByType(L.cartesianCrosshair)[0];c&&c.clearAxisValue&&c.setAxisValue&&(o?c.hideCrosshair():c.showCrosshair(a))}},i.prototype.showCrosshair=function(t){var e,i=null!==(e=this.getComponentsByType(L.cartesianCrosshair)[0])&&void 0!==e?e:this.getComponentsByType(L.polarCrosshair)[0];if(i){var n=this.getComponentsByKey("axes"),r=[];n.forEach((function(e){var i=t(e);!1!==i&&r.push({axis:e,value:i})})),i.showCrosshair(r)}},i.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t,"colorScheme")},i}(uW),MK=function(t,e){var i,n=t.spec,r=n.regionId,a=n.regionIndex;if(W(r)){var o=Dt(r);return null===(i=e.region)||void 0===i?void 0:i.filter((function(t){var e=t.spec;return o.includes(e.id)}))}if(W(a))return Dt(a).map((function(t){var i;return null===(i=e.region)||void 0===i?void 0:i[t]})).filter(W)},wK=function(){function t(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}return t.prototype.initChartSpec=function(t){return this.transformSpec(t),this.transformModelSpec(t)},t.prototype.transformSpec=function(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),W(t.stackInverse)&&t.region.forEach((function(e){!W(e.stackInverse)&&(e.stackInverse=t.stackInverse)})),W(t.stackSort)&&t.region.forEach((function(e){!W(e.stackSort)&&(e.stackSort=t.stackSort)}))},t.prototype.generateTransform=function(t,e){var i=this;return function(n,r,a){var o=r.spec,s=r.specPath,l=r.specInfoPath,u=r.type,c=new n.transformerConstructor(M(M({},i._option),{type:u})),h=c.transformSpec(o,t,a),d=M(M({},r),h);e?d.theme=c.getTheme(o,t):QU(t,s,h.spec),QU(a,null!=l?l:s,d)}},t.prototype.transformModelSpec=function(t){return this.createSpecInfo(t,this.generateTransform(t,!1))},t.prototype.createSpecInfo=function(t,e){var i,n;e||(e=this.generateTransform(t,!0));var r={};return this.forEachRegionInSpec(t,e,r),this.forEachSeriesInSpec(t,e,r),null===(i=r.series)||void 0===i||i.forEach((function(t,e){var i,n,a=(null!==(n=null!==(i=MK(t,r))&&void 0!==i?i:r.region)&&void 0!==n?n:[])[0];a&&(a.seriesIndexes||(a.seriesIndexes=[]),a.seriesIndexes.push(e),t.regionIndexes=a.regionIndexes.slice())})),this.forEachComponentInSpec(t,e,r),Object.values(null!==(n=r.component)&&void 0!==n?n:{}).forEach((function(t){return t.forEach((function(t,e){var i,n,a;if(t){if(!t.regionIndexes){var o=null!==(n=null!==(i=MK(t,r))&&void 0!==i?i:r.region)&&void 0!==n?n:[];t.regionIndexes=o.map((function(t){return t.regionIndexes[0]}))}if(!t.seriesIndexes){var s=function(t,e){var i,n=t.spec,r=n.seriesId,a=n.seriesIndex;if(W(r)){var o=Dt(r);return null===(i=e.series)||void 0===i?void 0:i.filter((function(t){var e=t.spec;return o.includes(e.id)}))}if(W(a))return Dt(a).map((function(t){var i;return null===(i=e.series)||void 0===i?void 0:i[t]})).filter(W)}(t,r);if(s)t.seriesIndexes=s.map((function(t){return t.seriesIndexes[0]}));else{var l=new Set;(null!==(a=t.regionIndexes)&&void 0!==a?a:[]).forEach((function(t){var e,i,n=null===(e=r.region)||void 0===e?void 0:e[t];null===(i=null==n?void 0:n.seriesIndexes)||void 0===i||i.forEach((function(t){return l.add(t)}))})),t.seriesIndexes=Array.from(l)}}}}))})),r},t.prototype._isValidSeries=function(t){return!0},t.prototype._getDefaultSeriesSpec=function(t,e,i){var n,r,a,o,s,l={dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!==(n=t.animation)&&void 0!==n?n:null===(r=this._option.globalInstance)||void 0===r?void 0:r.isAnimationEnable(),animationThreshold:null!==(a=t.animationThreshold)&&void 0!==a?a:null===(s=(o=this._option).getTheme)||void 0===s?void 0:s.call(o,"animationThreshold"),animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,animationState:t.animationState,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions},u=this.seriesType;return u&&(l.type=u,l[u]=t[u]),e&&e.length&&e.forEach((function(e){l[e]=t[e]})),i&&i.length&&i.forEach((function(e){l[e]=t[e]})),l},t.prototype.forEachRegionInSpec=function(t,e,i){var n;return(null!==(n=t.region)&&void 0!==n?n:[]).map((function(t,n){return e(ij.getRegionInType("region"),{spec:t,specPath:["region",n],type:"region",regionIndexes:[n]},i)}))},t.prototype.forEachSeriesInSpec=function(t,e,i){var n;return(null!==(n=t.series)&&void 0!==n?n:[]).map((function(t,n){return e(ij.getSeriesInType(t.type),{spec:t,specPath:["series",n],type:t.type,seriesIndexes:[n]},i)}))},t.prototype.forEachComponentInSpec=function(t,e,i){for(var n,r,a,o,s,l,u,c=[],h=ij.getComponents(),d=[],p=0;p<h.length;p++){var f=h[p],v=f.cmp,g=f.alwaysCheck;v.type.startsWith(L.cartesianAxis)?o=v:v.type.startsWith(L.polarAxis)?s=v:v.type===L.geoCoordinate?l=v:(g||t[null!==(n=v.specKey)&&void 0!==n?n:v.type])&&(v.type===L.tooltip?u=v:d.push(h[p]))}var y,m=!1;o&&((null==(y=o.getSpecInfo(t,i))?void 0:y.length)>0&&(m=!0,y.forEach((function(t){var n=ij.getComponentInKey(t.type);c.push(e(n,t,i))}))));s&&!m&&((null==(y=s.getSpecInfo(t,i))?void 0:y.length)>0&&(m=!0,y.forEach((function(t){var n=ij.getComponentInKey(t.type);c.push(e(n,t,i))}))));return l&&!m&&(null===(r=l.getSpecInfo(t,i))||void 0===r||r.forEach((function(t){c.push(e(l,t,i))}))),d.sort((function(t,e){return t.createOrder-e.createOrder})),d.forEach((function(n){var r,a=n.cmp;null===(r=a.getSpecInfo?a.getSpecInfo(t,i):wG(t,a.specKey,a.type))||void 0===r||r.forEach((function(t){c.push(e(a,t,i))}))})),u&&(null===(a=wG(t,u.specKey,u.type))||void 0===a||a.forEach((function(t){c.push(e(u,t,i))}))),c},t.prototype.transformSeriesSpec=function(t){var e=this,i=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){e._isValidSeries(t.type)&&Object.keys(i).forEach((function(e){e in t||(t[e]=i[e])}))})):t.series=[i]},t.prototype._findBandAxisBySeries=function(t,e,i){var n="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"];return i.find((function(i){if(!n.includes(i.orient))return!1;if(W(i.seriesId)){if(Dt(i.seriesId).includes(null==t?void 0:t.id))return!0}else if(W(i.seriesIndex)){if(Dt(i.seriesIndex).includes(e))return!0}else if("band"===i.type)return!0;return!0}))},t.prototype._applyAxisBandSize=function(t,e,i){var n=i.barMaxWidth,r=i.barMinWidth,a=i.barWidth,o=i.barGapInGroup,s=!1;$(r)?(t.minBandSize=r,s=!0):$(a)?(t.minBandSize=a,s=!0):$(n)&&(t.minBandSize=n,s=!0),s&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:Z(o)?o[o.length-1]:o})},t}(),TK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.needAxes=function(){return!0},e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype._getDefaultSeriesSpec=function(e,i){return t.prototype._getDefaultSeriesSpec.call(this,e,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],i)},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),t.prototype.transformSeriesSpec.call(this,e),this._transformAxisSpec(e)},e.prototype._setDefaultXAxisSpec=function(t){return{orient:"bottom"}},e.prototype._setDefaultYAxisSpec=function(t){return{orient:"left"}},e.prototype._setDefaultZAxisSpec=function(t){return{orient:"z"}},e.prototype._transformAxisSpec=function(t){var e=this;if(this.needAxes()){t.axes||(t.axes=[]);var i={x:!1,y:!1,z:!1};t.axes.forEach((function(n){var r=n.orient,a=null;"top"!==r&&"bottom"!==r||(i.x=!0,a=e._setDefaultXAxisSpec(t)),"left"!==r&&"right"!==r||(i.y=!0,a=e._setDefaultYAxisSpec(t)),"z"===r&&(i.z=!0,a=e._setDefaultZAxisSpec(t)),a&&Object.keys(a).forEach((function(t){j(n[t])&&(n[t]=a[t])})),ht(n,"trimPadding")&&ej(n,rW(e.type,t))})),i.x||t.axes.push(this._setDefaultXAxisSpec(t)),i.y||t.axes.push(this._setDefaultYAxisSpec(t)),t.zField&&!i.z&&t.axes.push(this._setDefaultZAxisSpec(t))}},e}(wK),DK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return n.seriesMark=null!==(i=e.seriesMark)&&void 0!==i?i:"line",n},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e}(TK),EK=function(t,e){var i={nodes:{}},n=e.fields;if(!(null==n?void 0:n.length))return i;var r,a=n.length-1,o=i;return t.forEach((function(t){t.latestData&&t.latestData.forEach((function(t){o=i;for(var e=0;e<n.length;e++){var s=n[e],l=t[s];if(j(l))break;o.groupField=s,o.nodes[l]||(e===a?o.nodes[l]={values:[]}:(r={nodes:{}},o.nodes[l]=r)),e===a?o.nodes[l].values.push(t):o=o.nodes[l]}}))})),i},BK=function(){function e(t,e){var i=this;this.stackRegion=function(t){var e,n=t.model,r=n.getSeries(),a=r.some((function(t){return t.getStack()}));if(a){var o=r.some((function(t){var e,i,n,r;return!!(null===(i=null===(e=t.getSpec())||void 0===e?void 0:e.totalLabel)||void 0===i?void 0:i.alwayCalculateTotal)||(null===(r=null===(n=t.getSpec())||void 0===n?void 0:n.totalLabel)||void 0===r?void 0:r.visible)})),s=o||r.some((function(t){return t.getPercent()})),l=r.some((function(t){return t.getStackOffsetSilhouette()})),u=eV(n,!0);for(var c in u)for(var h in u[c].nodes)sV(u[c].nodes[h],n.getStackInverse(),s,o);if(l)for(var c in u)for(var h in u[c].nodes)oV(u[c].nodes[h]);o&&n.getSeries().forEach((function(t){var e=t.getStackData(),i=t.getStackValue(),n=t.getStackValueField();e&&n&&nV(u[i],n)})),(null===(e=i._options)||void 0===e?void 0:e.afterStackRegion)&&i._options.afterStackRegion(n,u)}},this._chart=t,this._options=e}return e.prototype.init=function(){var e=this;this._chart.getAllRegions().forEach((function(i){i.event.on(t.ChartEvent.regionSeriesDataFilterOver,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},e.stackRegion)}))},e.prototype.stackAll=function(){var t=this;this._chart.getAllRegions().forEach((function(e){t.stackRegion({model:e})}))},e}(),PK=function(){function t(){}return t.prototype._beforeInit=function(){this._dataSet&&EV(this._dataSet,"stackSplit",EK)},t.prototype._initStack=function(){this._stack=new BK(this),this._stack.init()},t}(),RK={state:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,reverseState:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE,trigger:t.DimensionEventEnum.dimensionHover},LK=function(t){function e(e){var i=t.call(this,e)||this;return i.type="dimension-hover",i._resetType=[],i.resetAll=function(){var t=i.options,e=t.state,n=t.reverseState,r=t.interaction,a=r.getStatedGraphics(i);a&&a.length&&(r.clearAllStatesOfTrigger(i,e,n),i.dispatchEvent("reset",{graphics:a,options:i.options}),r.setStatedGraphics(i,[]))},i.handleStart=function(t){var e=i.options.interaction;switch(t.action){case"enter":var n=i.getStatedGraphics(t);e.updateStates(i,i.getStatedGraphics(t),e.getStatedGraphics(i),i.options.state,i.options.reverseState),e.setStatedGraphics(i,n);break;case"leave":e.clearAllStatesOfTrigger(i,i.options.state,i.options.reverseState),e.setStatedGraphics(i,[])}},i.options=Object.assign({},RK,e),i.updateMarkIdByState([i.options.state,i.options.reverseState]),i}return C(e,t),e.prototype.getStartState=function(){return this.options.state},e.prototype.getResetState=function(){return this.options.reverseState},e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart}]},e.prototype.getStatedGraphics=function(t,e){void 0===e&&(e=!1);var i=this.getMarksByState(e?this.options.reverseState:this.options.state),n=[];return t.dimensionInfo.forEach((function(t){t.data.forEach((function(t){var r=i.filter((function(e){return e.model===t.series&&e.getVisible()}));r.forEach((function(i){var r=i.getGraphics();if(r&&r.length){var a=r.filter((function(i){var n,r=mV(i);return n=Z(r)?r.every((function(e,i){return e===t.datum[i]})):t.datum.some((function(t){return t===r})),e?!n:n}));n.push.apply(n,P([],B(a),!1))}}))}))})),n},e.type="dimension-hover",e.defaultOptions=RK,e}(pG),IK=function(){ij.registerInteractionTrigger(LK.type,LK)},FK=function(){ij.registerComposedEvent(t.DimensionEventEnum.dimensionHover,PY),ij.registerComposedEvent(t.DimensionEventEnum.dimensionClick,wY)},OK=function(t){return t.fieldX[0]},zK=function(t){return t.fieldY[0]},HK=function(t){var e;return[t.fieldX[0],null!==(e=t.fieldX2)&&void 0!==e?e:t.fieldX[1]]},NK=function(t){var e;return[t.fieldY[0],null!==(e=t.fieldY2)&&void 0!==e?e:t.fieldY[1]]},UK=function(t,e){return t?e?OK:HK:e?zK:NK},jK=function(t,e,i){var n,r;if(!t)return null;var a=e.x,o=e.y,s=null!==(n=BY(t,(function(t){return yY(t.getOrient())}),e))&&void 0!==n?n:[],l=null!==(r=BY(t,(function(t){return mY(t.getOrient())}),e))&&void 0!==r?r:[];if(!s.length&&!l.length)return null;var u=new Set,c=new Set,h=new Set;[s,l].forEach((function(t){return t.forEach((function(t){iO(t.getScale().type)?u.add(t):c.add(t),i&&t.getSpec().hasDimensionTooltip&&h.add(t)}))}));var d=[],p=function(t){var e="x"===t,i=e?a:o;(e?s:l).forEach((function(t){if(h.size>0){if(h.has(t))(n=VK(t,i,UK(e,iO(t.getScale().type))))&&d.push(n)}else{var n,r=u.size>0;if((r?u:c).has(t))(n=VK(t,i,UK(e,r)))&&d.push(n)}}))};return"horizontal"===t.getSpec().direction?(p("y"),0===d.length&&p("x")):(p("x"),0===d.length&&p("y")),d.length?d:null},VK=function(t,e,i){var n=t.positionToData(e,!0);return j(n)?null:WK(t,n,i)},WK=function(t,e,i){var n=t.getScale();if(j(e))return null;var r=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===e.toString()}));r<0&&(r=void 0);var a=DY(e,t,"cartesian",null!=i?i:yY(t.getOrient())?OK:zK);return{index:r,value:e,position:n.scale(e),axis:t,data:a}},GK=function(t,e,i,n){return void 0===n&&(n=!1),i||(i={x:0,y:0}),Object.keys(t).forEach((function(r){var a,o,s,l,u,c,h=t[r],d=h.currentValue,p=h.cacheInfo,f=h.labelsComp,v=h.attributes,g=h.coordKey,y=null,m=0,_=null;if(d.size){var b=Array.from(d.values())[0];m=b.axis.getScale().scale(b.datum)+b.axis.getLayoutStartPoint()[g]-i[g],y=b.axis,_=null===(c=null===(u=null===(l=null===(s=null===(o=null===(a=y.getVRenderComponents()[0])||void 0===a?void 0:a.children[0])||void 0===o?void 0:o.children[0])||void 0===s?void 0:s.children[0])||void 0===l?void 0:l.getChildByName("axis-label-container"))||void 0===u?void 0:u.getChildByName("axis-label-container-layer-0"))||void 0===c?void 0:c.children[0]}var x,k=!!d.size&&Number.isFinite(m)&&!Number.isNaN(m),S=n&&!k&&W(p),A=S?p:{coordRange:[0,0],sizeRange:[0,0],coord:m,labelsTextStyle:{},labels:f?Object.keys(f).reduce((function(t,e){return t[e]={visible:!1,text:"",dx:0,dy:0},t}),{}):null,visible:k,axis:y,axisLabel:_};A&&(A._isCache=S);var C=0;if(v&&d.forEach((function(t){var i,n,a,o,s,l,u,c,h,d,p=t.axis,f=t.datum,g=void 0===f?"":f,y=null,b=p.getScale();if(iO(b.type))0===(x=b.bandwidth())&&b.step&&(C=b.step());else if(tO(b.type)){var k="xField"===r?e.fieldX[0]:e.fieldY[0],M="xField"===r?e.fieldX2:e.fieldY2,w=function(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r];if(o){var s=o[i],l=o[n||i];if(s<=e&&l>=e)return o}}return null}(e.getViewData().latestData,+g,k,M);if(w){var T="xField"===r?e.dataToPositionX(w):e.dataToPositionY(w);M?(x=Math.abs(T-("xField"===r?e.dataToPositionX1(w):e.dataToPositionY1(w))),g="".concat(w[k]," ~ ").concat(w[M])):x=1,m=T}y=p.niceLabelFormatter}if(A&&(null===(i=v.label)||void 0===i?void 0:i.visible)&&!S){var D=tX(p.getSpec()),E=p.getOrient(),B=null===(n=v.label)||void 0===n?void 0:n.syncAxisLabelAngle;A.labels[E]&&(A.labels[E].visible=!0,A.labels[E].text=g,"left"===E?(A.labels[E].dx=-D,A.labelsTextStyle[E]={textAlign:B&&_&&null!==(a=_.attribute.textAlign)&&void 0!==a?a:"right",textBaseline:B&&_&&null!==(o=_.attribute.textBaseline)&&void 0!==o?o:"middle"}):"right"===E?(A.labels[E].dx=D,A.labelsTextStyle[E]={textAlign:B&&_&&null!==(s=_.attribute.textAlign)&&void 0!==s?s:"left",textBaseline:B&&_&&null!==(l=_.attribute.textBaseline)&&void 0!==l?l:"middle"}):"top"===E?(A.labels[E].y=0,A.labels[E].dy=-D,A.labelsTextStyle[E]={textAlign:B&&_&&null!==(u=_.attribute.textAlign)&&void 0!==u?u:"center",textBaseline:B&&_&&null!==(c=_.attribute.textBaseline)&&void 0!==c?c:"bottom"}):"bottom"===E&&(A.labels[E].dy=D,A.labelsTextStyle[E]={textAlign:B&&_&&null!==(h=_.attribute.textAlign)&&void 0!==h?h:"center",textBaseline:B&&_&&null!==(d=_.attribute.textBaseline)&&void 0!==d?d:"top"}),A.labels[E].defaultFormatter=y)}})),A&&!S){var M={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};XK(M,d),"xField"===r?(A.coordRange=[M.x1,M.x2],A.sizeRange=[M.y1,M.y2],A.coord=m+i.x,A.labels&&(A.labels.top.y=M.y1,A.labels.bottom.y=M.y2)):(A.coordRange=[M.y1,M.y2],A.sizeRange=[M.x1,M.x2],A.coord=m+i.y,A.labels&&(A.labels.left.x=M.x1,A.labels.right.x=M.x2)),(A.coord<A.coordRange[0]||A.coord>A.coordRange[1])&&(A.visible=!1),v&&v.label&&Object.keys(A.labels).forEach((function(t){A.labels[t].visible&&YK(A.labels[t],t,v.label)}))}t[r].bandSize=null!=x?x:0,t[r].offsetSize=C,t[r].cacheInfo=A})),t},YK=function(t,e,i){var n=MG(i.formatMethod,i.formatter,t.text,{label:t.text,position:e}),r=n.formatFunc,a=n.args;r?t.text=r.apply(void 0,P([],B(a),!1)):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},XK=function(t,e){e.forEach((function(e){e.axis.getRegions().forEach((function(e){var i=e.getLayoutStartPoint(),n=i.x,r=i.y,a=e.getLayoutRect(),o=a.width,s=a.height;t.x1=Math.min(t.x1,n),t.y1=Math.min(t.y1,r),t.x2=Math.max(t.x2,n+o),t.y2=Math.max(t.y2,r+s)}))}))},KK=function(t){var e,i,n,r,a,o=t.cacheInfo,s=t.attributes,l=t.bandSize,u=t.offsetSize,c=t.coordKey,h=t.anotherAxisKey,d=o.coord,p=o.sizeRange,f=s.type;if("line"===f){var v=d+l/2;a={visible:!0,start:(e={},e[c]=v,e[h]=p[0],e),end:(i={},i[c]=v,i[h]=p[1],i)}}else if("rect"===f){var g=B(qK(s,l,u,o.axis),2),y=g[0],m=g[1],_=o.coordRange;a={visible:!0,start:(n={},n[c]=Math.max(d+y,_[0]),n[h]=p[0],n),end:(r={},r[c]=Math.min(d+m,_[1]),r[h]=p[1],r)}}return a},qK=function(t,e,i,n){var r,a,o,s=0===e?i:e,l=s;if(null===(r=t.style)||void 0===r?void 0:r.sizePercent)l=s*t.style.sizePercent;else if("number"==typeof(null===(a=t.style)||void 0===a?void 0:a.size))l=t.style.size;else if("function"==typeof(null===(o=t.style)||void 0===o?void 0:o.size)){var u=n.getLayoutRect();l=t.style.size(u,n)}return 0===e?[-l/2,l/2]:[e/2-l/2,l/2+e/2]},ZK=function(t,e){var i,n=new Map,r=new Map,a=t.series,o=t.datum,s="horizontal"===a.direction,l=(s?a.getYAxisHelper():a.getXAxisHelper()).getAxisId(),u=a.getChart().getComponentsByKey("axes").find((function(t){return t.id===l}));if(u){(s?r:n).set(u.getSpecIndex(),{datum:null===(i=a.getDatumPositionValues(o[0],a.getDimensionField()))||void 0===i?void 0:i[0],axis:u});var c={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:n,attributes:{visible:!!n.size,type:"rect"}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:r,attributes:{visible:!!r.size,type:"rect"}}};return GK(c,a,e),c.xField.cacheInfo?KK(c.xField):c.yField.cacheInfo?KK(c.yField):void 0}},JK=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],QK=function(t,e,i,n,r){var a,o,s,l={activeType:t};switch(t){case"mark":case"group":if(i){var u=null===(a=i.getSpec())||void 0===a?void 0:a.tooltip;return l.visible=!0,(null==u?void 0:u.handler)&&(l.handler=u.handler),(null===(o=l.handler)||void 0===o?void 0:o.showTooltip)?l:((null==u?void 0:u[t])&&JK.forEach((function(e){W(u[t][e])&&(l[e]=u[t][e])})),M(M({},l),i.tooltipHelper.getTooltipData(t,e,n,n[0].datum,r)))}break;case"dimension":if(null==n?void 0:n.length){if($K(n).every((function(t){var e;return!PG("dimension",null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec)}))?l.visible=!1:l.visible=!0,l.handler=e.handler,null===(s=l.handler)||void 0===s?void 0:s.showTooltip)return l;var c=[];return n.forEach((function(i){return i.data.forEach((function(i){var a=i.series.tooltipHelper.getTooltipData(t,e,n,i.datum,r);a&&c.push(a)}))})),function(t){if(!t||!t.length)return null;var e=[];return t.forEach((function(t){var i=t.content;i&&i.forEach((function(t){e.push(t)}))})),e.length?M(M({},t[0]),{content:e}):t[0]}(c)}}return null},$K=function(t){var e=[];return t.forEach((function(t){t.data.forEach((function(t){W(t.series)&&e.push(t.series)}))})),e},tq={dom:"".concat(Mj,"_TOOLTIP_HANDLER_DOM"),canvas:"".concat(Mj,"_TOOLTIP_HANDLER_CANVAS")},eq={key:"其他",value:"..."};!function(t){t.group="group",t.mark="mark",t.dimension="dimension"}(bK||(bK={}));var iq=function(){function e(e){var i=this;this._showTooltipByHandler=function(e,n){var r,a,o;if(j(e))return 1;n.changePositionOnly||i.clearCache(),i._updateViewSpec(e,n);var s=i._cacheActiveSpec;if(j(s)||!1===s.visible)return 1;n.tooltipSpec=i.component.getSpec(),n.activeTooltipSpec=s;var l,u=s.title,c=s.content,h=j(null==u?void 0:u.key)&&j(null==u?void 0:u.value)&&!(null==c?void 0:c.length);return i.component.event.emit(t.ChartEvent.tooltipShow,M(M({},n),{isEmptyTooltip:h,tooltipData:e,activeType:i.activeType,tooltip:i.component})),h?1:((null===(r=s.handler)||void 0===r?void 0:r.showTooltip)?l=s.handler.showTooltip.bind(s.handler):(null===(a=i.component.tooltipHandler)||void 0===a?void 0:a.showTooltip)&&(l=i.component.tooltipHandler.showTooltip.bind(i.component.tooltipHandler)),l?null!==(o=l(i.activeType,e,n))&&void 0!==o?o:0:1)},this.component=e}return e.prototype._preprocessDimensionInfo=function(t){var e=[];if(null==t||t.forEach((function(t){var i=M(M({},t),{data:t.data.filter((function(t){var e,i;return!1!==(null===(i=null===(e=t.series.getSpec())||void 0===e?void 0:e.tooltip)||void 0===i?void 0:i.visible)}))});i.data.length>0&&e.push(i)})),e.length>0)return e},e.prototype._updateViewSpec=function(t,e){var i,n,r,a,o,s,l,u,c,h=e.changePositionOnly,d=e.model;if(!h||!this._cacheActiveSpec){var p=this.component.getSpec();if(this._cacheActiveSpec=QK(this.activeType,this.component.getSpec(),d,t,e),this._cacheActiveSpec){j(this._cacheActiveSpec.handler)&&W(p.handler)&&(this._cacheActiveSpec.handler=p.handler);var f=null!==(i=p[this.activeType])&&void 0!==i?i:{},v=null!==(n=this._cacheActiveSpec.updateTitle)&&void 0!==n?n:f.updateTitle,g=null!==(r=this._cacheActiveSpec.updateContent)&&void 0!==r?r:f.updateContent,y=null!==(o=null!==(a=this._cacheActiveSpec.maxLineCount)&&void 0!==a?a:f.maxLineCount)&&void 0!==o?o:20;if(v&&(this._cacheActiveSpec.title=null!==(s=v(this._cacheActiveSpec.title,t,e))&&void 0!==s?s:this._cacheActiveSpec.title),g)this._cacheActiveSpec.content=null!==(l=g(this._cacheActiveSpec.content,t,e))&&void 0!==l?l:this._cacheActiveSpec.content;else if(y>=1&&(null===(u=this._cacheActiveSpec.content)||void 0===u?void 0:u.length)>y){var m=null!==(c=this._cacheActiveSpec.othersLine)&&void 0!==c?c:f.othersLine,_=m?M(M({},eq),m):eq;this._cacheActiveSpec.content=P(P([],B(this._cacheActiveSpec.content.slice(0,y-1)),!1),[M(M({},this._cacheActiveSpec.content[y-1]),_)],!1)}}}},e.prototype.shouldHandleTooltip=function(t,e){var i,n;return!j(e)&&PG(this.activeType,null===(n=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper)||void 0===n?void 0:n.spec)},e.prototype.clearCache=function(){this._cacheActiveSpec=void 0},e}(),nq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="dimension",e}return C(e,t),e.prototype.showTooltip=function(t,e,i){var n=M(M({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,n)},e.prototype._getDimensionInfo=function(t){var e,i,n,r,a=this.component.getChart(),o=a.getCompiler().getStage().getLayer(void 0),s={x:t.event.viewX,y:t.event.viewY};if(o.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},s),0===(r=null!==(n=null===(i=(e=this.component.getOption()).getDimensionInfo)||void 0===i?void 0:i.call(e,a,s,!0))&&void 0!==n?n:[]).length)r=void 0;else if(r.length>1){var l=r.filter((function(t){var e,i,n,r,a,o,s=t.axis;if(s.getSpec().hasDimensionTooltip)return!0;if(!iO(s.getScale().type))return!1;try{for(var l=E(null!==(a=null==s?void 0:s.getRegions())&&void 0!==a?a:[]),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var h=(n=void 0,E(c.getSeries())),d=h.next();!d.done;d=h.next()){var p=d.value;if("cartesian"===p.coordinate){o=p;break}}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}if(W(o))break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(e)throw e.error}}return W(o)&&o.getDimensionField()[0]===o.fieldY[0]?"left"===s.getOrient()||"right"===s.getOrient():"bottom"===s.getOrient()||"top"===s.getOrient()}));if((r=l.length?l:r.slice(0,1)).length>1){var u=new Set;r.forEach((function(t){t.data=t.data.filter((function(t){var e=t.key;return!u.has(e)&&(u.add(e),!0)}))}))}}return r},e.prototype.getMouseEventData=function(t){return{tooltipInfo:this._getDimensionInfo(t),ignore:!1}},e}(iq),rq=function(){ij.registerTooltipProcessor("dimension",nq)},aq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="mark",e}return C(e,t),e.prototype.showTooltip=function(t,e,i){var n,r,a,o=t.datum,s=t.series,l=this.component.getSpec(),u=[{datum:[o],series:s}],c=s.tooltipHelper,h=null===(n=s.getSpec())||void 0===n?void 0:n.tooltip,d=null===(r=null==h?void 0:h.mark)||void 0===r?void 0:r.checkOverlap,p=!1;if(!0===d||!0===(null===(a=l.mark)||void 0===a?void 0:a.checkOverlap)&&!1!==d){var f=null==c?void 0:c.activeTriggerSet.mark;if(f){p=!0;var v=this.component.getChart().getCompiler().getStage().getLayer(void 0),g={x:e.event.viewX,y:e.event.viewY};v.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},g),f.forEach((function(t){t.getGraphics().forEach((function(t){t!==e.node&&t&&t.containsPoint(g.x,g.y,kh.GLOBAL,t.stage.getPickerService())&&u[0].datum.push(mV(t))}))}))}}var y=M(M({},e),{model:s,changePositionOnly:i,tooltip:this.component});if(i&&p){var m=this._cacheActiveSpec&&this._cacheActiveSpec.data;m&&m[0].series===u[0].series&&m[0].datum.length===u[0].datum.length&&!m[0].datum.some((function(t,e){return t!==u[0].datum[e]}))||(y.changePositionOnly=!1)}return this._showTooltipByHandler(u,y)},e.prototype.getMouseEventData=function(t){var e,i,n,r=null===(e=t.model)||void 0===e?void 0:e.modelType;if("series"===r){var a=null==(u=(p=t.model).tooltipHelper)?void 0:u.activeTriggerSet.mark,o=null==u?void 0:u.ignoreTriggerSet.mark;(null==a?void 0:a.has(t.mark))?i={mark:t.mark,datum:t.datum,series:p}:(null==o?void 0:o.has(t.mark))&&(n=!0)}else if("component"===r){var s=t.model,l=t.node;if("label"===s.name&&l){var u,c=s.getLabelInfoByTextGraphic(l),h=null!=c?c:{},d=h.baseMark,p=h.series,f=h.labelMark;a=null==(u=p.tooltipHelper)?void 0:u.activeTriggerSet.mark,o=null==u?void 0:u.ignoreTriggerSet.mark;(null==a?void 0:a.has(f))?i={mark:d,datum:l.attribute.data,series:p}:(null==o?void 0:o.has(f))&&(n=!0)}}return{tooltipInfo:i,ignore:n}},e}(iq),oq=function(){ij.registerTooltipProcessor("mark",aq)},sq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="group",e}return C(e,t),e.prototype.showTooltip=function(t,e,i){var n=t.datum,r=t.series,a=[{datum:Dt(n),series:r}],o=M(M({},e),{groupDatum:this._getGroupDatum(e),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(a,o)},e.prototype.getMouseEventData=function(t){var e,i,n;if("series"===(null===(e=t.model)||void 0===e?void 0:e.modelType)){var r=t.model,a=r.tooltipHelper,o=null==a?void 0:a.activeTriggerSet.group;if(null==o?void 0:o.has(t.mark)){var s=this.component.getSpec()[this.activeType];((null==s?void 0:s.triggerMark)?Dt(s.triggerMark):[]).includes(null===(i=t.mark)||void 0===i?void 0:i.name)&&(n={mark:t.mark,datum:t.datum,series:r})}}return{tooltipInfo:n,ignore:!1}},e.prototype._getGroupDatum=function(t){var e=t.model,i=t.mark,n=t.datum,r=e;if(["line","area"].includes(i.type))return Dt(n);var a=r.getViewData().latestData,o=r.getSeriesField();if(!o)return a;var s=Dt(n)[0][o];return a.filter((function(t){return t[o]===s}))},e}(iq),lq=function(){ij.registerTooltipProcessor("group",sq)},uq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=DK,i.type="line",i.seriesType=t.SeriesTypeEnum.line,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="line",i.seriesType=t.SeriesTypeEnum.line,i.transformerConstructor=DK,i}(CK);Tt(uq,PK);var cq,hq=function(){rq(),oq(),lq(),FK(),IK(),xK(),ij.registerChart(uq.type,uq)},dq=P(P([],B(OY),!1),["fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"],!1),pq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._isValidPointChannel=function(t){return["x","y","x1","y1","defined"].includes(t)},i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.prototype._getSegmentAttributes=function(){return dq},e.prototype._getIgnoreAttributes=function(){return[]},e.type="area",e}(zY),fq=function(){ij.registerMark(pq.type,pq),cP(),NB(),Xz(),jz(),oG(),ij.registerGraphicComponent("area",g_)},vq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getSeriesStyle=function(t,i,n){var r,a,o,s,l,u;try{for(var c=E(Dt(i)),h=c.next();!h.done;h=c.next()){var d=h.value,p=null===(o=e.series.getSeriesStyle(t))||void 0===o?void 0:o(d);if(!1!==p||"fill"!==d&&"stroke"!==d||(p="fill"===d?null===(l=null===(s=e.series.getSeriesStyle(t))||void 0===s?void 0:s("stroke"))||void 0===l?void 0:l[0]:null===(u=e.series.getSeriesStyle(t))||void 0===u?void 0:u("fill")),W(p))return p}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}return n},e}return C(e,t),e}(OG),gq=M(M(M({},qG),RY),((cq={}).area={name:"area",type:"area"},cq)),yq=function(){ij.registerAnimation("area",iG),nG(),tG()},mq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return C(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n,r=!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible);this._addMarkLabelSpec(t,(function(t){var e="inside-middle"===t.position;return!r||e?"area":"point"})),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,a,o,s,l;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n);var u=e.area,c=void 0===u?{}:u,h=e.line,d=void 0===h?{}:h,p=e.seriesMark,f=!1!==c.visible&&!1!==(null===(r=c.style)||void 0===r?void 0:r.visible),v=!1!==d.visible&&!1!==(null===(a=d.style)||void 0===a?void 0:a.visible);c.support3d=!(!c.support3d&&!d.support3d),c.zIndex=W(c.zIndex)||W(d.zIndex)?Math.max(null!==(o=c.zIndex)&&void 0!==o?o:0,null!==(s=d.zIndex)&&void 0!==s?s:0):void 0,c.style&&delete c.style.stroke,c.state&&Object.keys(c.state).forEach((function(t){"style"in c.state[t]?delete c.state[t].style.stroke:delete c.state[t].stroke}));var g=c,y=d;("line"===p||v&&!f)&&(g=d,y=c),c.style=ej({},y.style,g.style),c.state=ej({},y.state,g.state),!1===c.interactive&&(c.style.fillPickable=!1),!1===d.interactive&&(d.style.strokePickable=!1),c.interactive=!(!c.interactive&&null!==(l=d.interactive)&&void 0!==l&&!l),e.area=c,e.line=d},e}(VY),_q={label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"},bq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.area,i.transformerConstructor=mq,i._sortDataByAxis=!1,i}return C(i,e),i.prototype.initMark=function(){var t,e=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"area",n=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:n&&"point"!==e},{morphElementKey:this.getDimensionField()[0]}),this.initSymbolMark("point"===e)},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()},i.prototype.initAreaMarkStyle=function(){var e,i,n,r,a,o=this,s=null!==(n=null===(i=null===(e=this.getSpec().area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.curveType)&&void 0!==n?n:null===(a=null===(r=this.getSpec().line)||void 0===r?void 0:r.style)||void 0===a?void 0:a.curveType,l=s===kG?"horizontal"===this._direction?"monotoneY":"monotoneX":s,u=this._areaMark;if(u){var c=this._isAreaVisible(),h=this._isLineVisible();c||h?u.setVisible(!0):u.setVisible(!1),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:function(t){var e,i;return RU(o.dataToPositionX1(t),null===(i=null===(e=o._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:function(t){var e,i;return RU(o.dataToPositionY1(t),null===(i=null===(e=o._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{fill:!!c&&this.getColorAttribute(),stroke:!!h&&this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(u,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.getStack()&&this.setMarkStyle(u,{zIndex:function(t){return-t[Fj]}},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{curveType:l},"normal",t.AttributeLevel.Built_In),Object.keys(u.stateStyle).forEach((function(t){u.stateStyle[t].stroke&&u.setPostProcess("stroke",(function(t){return[t,!1,!1,!1]}),t)}))}},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(nY(null===(e=ij.getAnimationInKey("line"))||void 0===e?void 0:e(r,a),rY("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("area"))||void 0===i?void 0:i(r,a),rY("area",this._spec,this._markAttributeContext))),this._symbolMark){var o=vY(this);this._symbolMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),rY("point",this._spec,this._markAttributeContext),o))}},i.prototype._isAreaVisible=function(){var t,e=this._spec.area||{};return!1!==e.visible&&!1!==(null===(t=e.style)||void 0===t?void 0:t.visible)},i.prototype._isLineVisible=function(){var t,e=this._spec.line||{};return!1!==e.visible&&!1!==(null===(t=e.style)||void 0===t?void 0:t.visible)},i.prototype.initTooltip=function(){this._tooltipHelper=new vq(this);var t=this._tooltipHelper.activeTriggerSet,e=t.group,i=t.mark;this._areaMark&&e.add(this._areaMark),this._lineMark&&e.add(this._lineMark),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))},i.prototype.viewDataStatisticsUpdate=function(t){e.prototype.viewDataStatisticsUpdate.call(this,t),this.encodeDefined(this._areaMark,"defined")},i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,a,o,s,l=null!==(n=e._spec.seriesMark)&&void 0!==n?n:"area",u=null!==(a=null===(r=e._seriesMark)||void 0===r?void 0:r.getAttribute(i,t))&&void 0!==a?a:void 0;return"fill"!==i||u&&"line"!==l||(i="stroke",u=null!==(s=null===(o=e._seriesMark)||void 0===o?void 0:o.getAttribute(i,t))&&void 0!==s?s:void 0),"stroke"===i&&Z(u)?u[0]:u}},i.type=t.SeriesTypeEnum.area,i.builtInTheme={area:_q},i.mark=gq,i.transformerConstructor=mq,i}(gY);Tt(bq,LY);var xq=function(){yK(),lK(),NY(),fq(),jY(),yq(),QX(),KX(),ij.registerSeries(bq.type,bq)},kq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel","useSequentialAnimation"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e}(TK),Sq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=kq,i.type="area",i.seriesType=t.SeriesTypeEnum.area,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="area",i.seriesType=t.SeriesTypeEnum.area,i.transformerConstructor=kq,i}(CK);Tt(Sq,PK);var Aq=function(){rq(),oq(),lq(),IK(),xq(),FK(),ij.registerChart(Sq.type,Sq)};function Cq(t,e){return void 0===e&&(e=!0),function(i,n,r){var a="vertical"===t.direction?t.yField:t.xField,o=null==i?void 0:i[a];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:o>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:o>0?"positive":"negative"}}}var Mq=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:Cq(t,e)}},wq=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:Cq(t,e)}},Tq={type:"fadeIn"},Dq={type:"growCenterIn"};function Eq(t,e){if(!1===e)return{};switch(e){case"fadeIn":return Tq;case"scaleIn":return Dq;default:return Mq(t)}}var Bq,Pq=function(){ij.registerAnimation("bar",(function(t,e){return{appear:Eq(t,e),enter:Mq(t,!1),exit:wq(t,!1),disappear:wq(t)}}))},Rq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="rect",e}(NW),Lq=function(){cP(),rP(),zz("rect",Wz),ij.registerMark(Rq.type,Rq),rG(),ij.registerGraphicComponent("rect",Ym)},Iq=M(M({},qG),((Bq={}).bar={name:"bar",type:"rect"},Bq.barBackground={name:"barBackground",type:"rect"},Bq));function Fq(t,e,i){var n,r,a;if(t.values.length>0)if(t.sortDatums.length){var o=t.sortDatums;e&&(o=t.sortDatums.slice().reverse());for(var s=0;s<o.length;s++)a=Oq(o[s].datum,a,o[s].series,i,null===(r=(n=o[s].series[i.axisHelper]).getScale)||void 0===r?void 0:r.call(n,0),0===s)}else{var l=t.series;e&&(l=l.slice().reverse()),l.forEach((function(t,n){for(var r,o,s=t.s,l=t.values,u=null===(o=(r=s[i.axisHelper]).getScale)||void 0===o?void 0:o.call(r,0),c=0;c<l.length;c++){var h=l[e?l.length-1-c:c];a=Oq(h,a,s,i,u,0===c&&0===n)}}))}for(var u in t.nodes)Fq(t.nodes[u],e,i)}function Oq(t,e,i,n,r,a){var o=i.getSpec().barMinHeight,s=i[n.axisHelper].isInverse(),l=RU(i[n.startMethod](t),r),u=RU(i[n.endMethod](t),r);a&&(e=l);var c=Math.abs(l-u);c<=0&&!LU(t[i.getStackValueField()],r)?c=0:c<o&&(c=o);var h=1;return u<l?h=-1:u===l&&(h=n.isVertical?s?1:-1:s?-1:1),u=e+h*c,t[n.start]=e,t[n.end]=u,u}var zq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar")},e}(hY),Hq={label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},Nq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.bar,i._barMarkName="bar",i._barMarkType="rect",i.transformerConstructor=zq,i._bandPosition=0,i._getLinearBarRange=function(t,e){var n=B([t,e].sort((function(t,e){return t-e})),2),r=n[0],a=n[1],o=a-r;if(i._spec.barGap){var s=.5*i._spec.barGap;r=r+s,a=a-s}var l=a-r,u=WU(i._spec.barMinWidth||2,o);if(l<u){var c=(u-l)/2;r-=c,a+=c}return[r,a]},i._getBarXStart=function(t,e,n){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!1),t[ZG]):i._spec.barMinHeight?i._calculateRectPosition(t,!1,n):RU(i._dataToPosX(t),e,n)},i._getBarXEnd=function(t,e,n){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!1),t[JG]):RU(i._dataToPosX1(t),e,n)},i._getLinearBarXRange=function(t,e,n){var r=RU(i._dataToPosX(t),e,n),a=RU(i._dataToPosX1(t),e,n);return i._getLinearBarRange(r,a)},i._getBarYStart=function(t,e){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!0),t[QG]):i._spec.barMinHeight?i._calculateRectPosition(t,!0):RU(i._dataToPosY(t),e)},i._getBarYEnd=function(t,e){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!0),t[$G]):RU(i._dataToPosY1(t),e)},i._getLinearBarYRange=function(t,e,n){var r=RU(i._dataToPosY(t),e,n),a=RU(i._dataToPosY1(t),e,n);return i._getLinearBarRange(r,a)},i._getBarBackgroundXStart=function(t){var e=t.range();return Math.min(e[0],e[e.length-1])},i._getBarBackgroundXEnd=function(t){var e=t.range();return Math.max(e[0],e[e.length-1])},i._getBarBackgroundYStart=function(t){var e=t.range();return Math.min(e[0],e[e.length-1])},i._getBarBackgroundYEnd=function(t){var e=t.range();return Math.max(e[0],e[e.length-1])},i._getBarBackgroundPositionXEncoder=function(){var t;return null===(t=i._barBackgroundPositionXEncoder)||void 0===t?void 0:t.bind(i)},i._setBarBackgroundPositionXEncoder=function(t){i._barBackgroundPositionXEncoder=t.bind(i)},i._getBarBackgroundPositionYEncoder=function(){var t;return null===(t=i._barBackgroundPositionYEncoder)||void 0===t?void 0:t.bind(i)},i._setBarBackgroundPositionYEncoder=function(t){i._barBackgroundPositionYEncoder=t.bind(i)},i}return C(i,e),i.prototype.initMark=function(){this._initBarBackgroundMark(),this._barMark=this._createMark(M(M({},i.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0],morph:sY(this._spec,this._barMarkName)})},i.prototype._initBarBackgroundMark=function(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(i.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId()}))},i.prototype.initMarkStyle=function(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.mark,n=t.group;this._barMark&&(i.add(this._barMark),n.add(this._barMark))},i.prototype._statisticViewData=function(){var t,i,n=this;e.prototype._statisticViewData.call(this);var r=null!==(t=this._spec.barBackground)&&void 0!==t?t:{};if(r.visible){var a,o=this._getRelatedComponentSpecInfo("axes").some((function(t){return t.type===L.cartesianBandAxis}));if(EV(this._option.dataSet,"addVChartProperty",DG),o){var s=function(t,e){for(var i,r,a,o=B(t,1)[0],s=e.scaleDepth,l=[{}],u=n.getDimensionField(),c=j(s)?u.length:Math.min(u.length,s),h=0;h<c;h++){var d=u[h],p=null===(r=o.latestData[d])||void 0===r?void 0:r.values;if(null==p?void 0:p.length){for(var f=[],v=null!==(a=n._spec.dataKey)&&void 0!==a?a:Bj,g=0;g<p.length;g++)for(var y=0;y<l.length;y++)f.push(M(M({},l[y]),((i={})[d]=p[g],i[v]=p[g],i)));l=f}}return l};EV(this._option.dataSet,"dimensionItems",s),a=new cc(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:j(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:GG.bind(this),call:YG}},!1),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",a.reRunAllTransform)}else{s=function(t){B(t,1)[0];var e=[],i=B(n.getDimensionContinuousField(),2),r=i[0],a=i[1],o={};return l.latestData.forEach((function(t){var i,n="".concat(t[r],"-").concat(t[a]);o[n]||(o[n]=((i={})[r]=t[r],i[a]=t[a],i),e.push(o[n]))})),e};EV(this._option.dataSet,"dimensionItems",s);var l=this.getViewData();a=new cc(this._option.dataSet).parse([l],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:GG.bind(this),call:YG}},!1),null==l||l.target.addListener("change",a.reRunAllTransform)}this._barBackgroundViewData=new IW(this._option,a)}},i.prototype.init=function(t){var i,n;e.prototype.init.call(this,t),"vertical"===this.direction?"band"===(null===(i=this._xAxisHelper)||void 0===i?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()},i.prototype._shouldDoPreCalculate=function(){var t=this,e=this.getRegion();return this.getStack()&&e.getSeries().filter((function(e){return e.type===t.type&&e.getSpec().barMinHeight})).length},i.prototype._calculateStackRectPosition=function(t){var e=this,i=this.getRegion();if(!i._bar_series_position_calculated){var n,r,a,o,s;i._bar_series_position_calculated=!0,t?(n=$G,r=QG,a="_dataToPosY1",o="_dataToPosY",s="_yAxisHelper"):(n=JG,r=ZG,a="_dataToPosX1",o="_dataToPosX",s="_xAxisHelper");var l=eV(i,!1,(function(t){return t.type===e.type}));for(var u in l)for(var c in l[u].nodes)Fq(l[u].nodes[c],i.getStackInverse(),{isVertical:t,start:n,end:r,startMethod:a,endMethod:o,axisHelper:s})}},i.prototype._calculateRectPosition=function(t,e,i){var n,r,a,o,s;e?(a="_dataToPosY1",o="_dataToPosY",s="_yAxisHelper"):(a="_dataToPosX1",o="_dataToPosX",s="_xAxisHelper");var l=null===(r=(n=this[s]).getScale)||void 0===r?void 0:r.call(n,0),u=this[s].isInverse(),c=this._spec.barMinHeight,h=RU(this[a](t),l,i),d=RU(this[o](t),l,i),p=Math.abs(h-d);p<=0&&!LU(t[this.getStackValueField()],l)?p=0:p<c&&(p=c);var f=1;return d<h?f=-1:d===h&&(f=e?u?1:-1:u?-1:1),h+f*p},i.prototype._dataToPosX=function(t){return this.dataToPositionX(t)},i.prototype._dataToPosX1=function(t){return this.dataToPositionX1(t)},i.prototype._dataToPosY=function(t){return this.dataToPositionY(t)},i.prototype._dataToPosY1=function(t){return this.dataToPositionY1(t)},i.prototype.initBandRectMarkStyle=function(){var e,i,n,r,a=this,o=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:function(t){return a._getBarXStart(t,o)},x1:function(t){return a._getBarXEnd(t,o)},y:function(t){return a._getPosition(a.direction,t)},height:function(){return a._getBarWidth(a._yAxisHelper)},width:function(){},y1:function(){}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barMark,{y:function(t){return a._getBarYStart(t,s)},y1:function(t){return a._getBarYEnd(t,s)},x:function(t){return a._getPosition(a.direction,t)},width:function(){return a._getBarWidth(a._xAxisHelper)},x1:function(){},height:function(){}},"normal",t.AttributeLevel.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()},i.prototype._initStackBarMarkStyle=function(){var t,e,i,n,r=this;if(this._spec.stackCornerRadius){var a=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),o=null===(n=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0);this._barMark.setMarkConfig({clip:!0,clipPath:function(){var t=[];return r._forEachStackGroup((function(e){var i,n,s=1/0,l=-1/0,u=!1,c=1/0,h=-1/0;e.values.forEach((function(t){var e=t[Ij],i=t[Fj],n=t[Oj],r=t[zj];s=Math.min(s,e,i),l=Math.max(l,e,i),W(n)&&W(r)&&(u=!0,c=Math.min(c,n,r),h=Math.max(h,n,r))}));var d=M(M(M({},e.values[0]),((i={})[Ij]=s,i[Fj]=l,i)),u?((n={})[Oj]=c,n[zj]=h,n):void 0),p="horizontal"===r.direction?{x:r._getBarXStart(d,a),x1:r._getBarXEnd(d,a),y:r._getPosition(r.direction,d),height:r._getBarWidth(r._yAxisHelper)}:{y:r._getBarYStart(d,o),y1:r._getBarYEnd(d,o),x:r._getPosition(r.direction,d),width:r._getBarWidth(r._xAxisHelper)};t.push(Ym(M(M({},p),{cornerRadius:U(r._spec.stackCornerRadius)?r._spec.stackCornerRadius(p,d,r._markAttributeContext):r._spec.stackCornerRadius,fill:!0})))})),t}})}},i.prototype.initLinearRectMarkStyle=function(){var e,i,n,r,a=this,o=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);if("horizontal"===this.direction){var l=W(this._fieldY2)?{y:function(t){return a._getLinearBarYRange(t,s,!0)[0]},y1:function(t){return a._getLinearBarYRange(t,s,!0)[1]}}:{y:function(t){return RU(a._dataToPosY(t)-a._getBarWidth(a._yAxisHelper)/2,s,!0)},height:function(t){return a._getBarWidth(a._yAxisHelper)}};this.setMarkStyle(this._barMark,M({x:function(t){return a._getBarXStart(t,o,!0)},x1:function(t){return a._getBarXEnd(t,o,!0)}},l),"normal",t.AttributeLevel.Series),this.setMarkStyle(this._barBackgroundMark,M({x:function(){return a._getBarBackgroundXStart(o)},x1:function(){return a._getBarBackgroundXEnd(o)}},l),"normal",t.AttributeLevel.Series)}else{var u=W(this._fieldX2)?{x:function(t){return a._getLinearBarXRange(t,o,!0)[0]},x1:function(t){return a._getLinearBarXRange(t,o,!0)[1]}}:{x:function(t){return RU(a._dataToPosX(t)-a._getBarWidth(a._xAxisHelper)/2,o,!0)},width:function(t){return a._getBarWidth(a._xAxisHelper)}};this.setMarkStyle(this._barMark,M(M({},u),{y:function(t){return a._getBarYStart(t,s)},y1:function(t){return a._getBarYEnd(t,s)}}),"normal",t.AttributeLevel.Series),this.setMarkStyle(this._barBackgroundMark,M(M({},u),{y:function(){return a._getBarBackgroundYStart(s)},y1:function(){return a._getBarBackgroundYEnd(s)}}),"normal",t.AttributeLevel.Series)}},i.prototype._initBandBarBackgroundMarkStyle=function(){var e,i,n,r,a,o=this;if(this._barBackgroundMark){var s=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),l=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0),u=null!==(a=this._spec.barBackground)&&void 0!==a?a:{},c=j(u.fieldLevel)?void 0:u.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:function(){return o._getBarBackgroundXStart(s)},x1:function(){return o._getBarBackgroundXEnd(s)},y:function(t){return o._getPosition(o.direction,t,c,"barBackground")},height:function(){return o._getBarWidth(o._yAxisHelper,c)},width:function(){},y1:function(){}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barBackgroundMark,{x:function(t){return o._getPosition(o.direction,t,c,"barBackground")},y:function(){return o._getBarBackgroundYStart(l)},y1:function(){return o._getBarBackgroundYEnd(l)},width:function(){return o._getBarWidth(o._xAxisHelper,c)},x1:function(){},height:function(){}},"normal",t.AttributeLevel.Series)}},i.prototype.initAnimation=function(){var t,e,i=this,n={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:function(){var t,e="horizontal"===i.direction?null===(t=i._xAxisHelper)||void 0===t?void 0:t.getScale(0):i._yAxisHelper.getScale(0);if(e){var n=e.domain(),r=Pt(n),a=Bt(n);return a<0?e.scale(a):r>0?e.scale(r):e.scale(0)}}},r=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset,a=vY(this);this._barMark.setAnimationConfig(nY(null===(e=ij.getAnimationInKey("bar"))||void 0===e?void 0:e(n,r),rY(this._barMarkName,this._spec,this._markAttributeContext),a))},i.prototype._getBarWidth=function(t,e){var i,n,r=this._groups?this._groups.fields.length:1,a=j(e)?r:Math.min(r,e),o=null!==(n=null===(i=t.getBandwidth)||void 0===i?void 0:i.call(t,a-1))&&void 0!==n?n:6,s=W(this._spec.barWidth)&&a===r,l=W(this._spec.barMinWidth),u=W(this._spec.barMaxWidth),c=o;return s&&(c=WU(this._spec.barWidth,o)),l&&(c=Math.max(c,WU(this._spec.barMinWidth,o))),u&&(c=Math.min(c,WU(this._spec.barMaxWidth,o))),c},i.prototype._getPosition=function(t,e,i,n){var r,a,o,s,l,u,c,h;"horizontal"===t?(u=this.getYAxisHelper(),c="height",h="barBackground"===n?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(u=this.getXAxisHelper(),c="width",h="barBackground"===n?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));var d=u.getScale(0),p=this._groups?this._groups.fields.length:1,f=j(i)?p:Math.min(p,i),v=null!==(a=null===(r=u.getBandwidth)||void 0===r?void 0:r.call(u,f-1))&&void 0!==a?a:6,g=f===p?this._barMark.getAttribute(c,e):v;if(f>1&&W(this._spec.barGapInGroup)){for(var y=this._groups.fields,m=Dt(this._spec.barGapInGroup),_=0,b=0,x=y.length-1;x>=1;x--){var k=y[x],S=null!==(s=null===(o=u.getScale(x))||void 0===o?void 0:o.domain())&&void 0!==s?s:[],A=S.length,C=WU(null!==(l=m[x-1])&&void 0!==l?l:Et(m),v),M=S.indexOf(e[k]);x===y.length-1?(_+=A*g+(A-1)*C,b+=M*(g+C)):(b+=M*(_+C),_+=_+(A-1)*C)}return d.scale(e[y[0]])+u.getBandwidth(0)/2-_/2+b}var w=tO(d.type||"band");return h(e,f)+.5*(v-g)+(w?-v/2:0)},i.prototype.dataToBarBackgroundPositionX=function(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)},i.prototype.dataToBarBackgroundPositionY=function(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()},i.prototype.onDataUpdate=function(){e.prototype.onDataUpdate.call(this),this.getRegion()._bar_series_position_calculated=!1},i.prototype.compile=function(){if(e.prototype.compile.call(this),this._spec.sampling){var t=this._region.getLayoutRect(),i=t.width,n=t.height,r=this._fieldY,a=this._fieldX;this._data.setTransform([{type:"sampling",size:"horizontal"===this._direction?n:i,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?a[0]:r[0],groupBy:this._seriesField,mode:this._spec.sampling}])}},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._barMark]},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.compile()},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(i=null===(t=this._barBackgroundViewData)||void 0===t?void 0:t.getDataView())||void 0===i||i.reRunAllTransform()},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._barBackgroundViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._barBackgroundViewData)||void 0===r||r.updateData()},i.prototype.release=function(){var t;e.prototype.release.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.release(),this._barBackgroundViewData=null},i.type=t.SeriesTypeEnum.bar,i.builtInTheme={bar:Hq},i.mark=Iq,i.transformerConstructor=zq,i}(gY),Uq=function(){yK(),Lq(),Pq(),QX(),KX(),ij.registerSeries(Nq.type,Nq)},jq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius","useSequentialAnimation"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e.prototype._transformAxisSpec=function(e){var i,n;if(t.prototype._transformAxisSpec.call(this,e),e.axes){var r=e.series.some((function(t){return"horizontal"===t.direction})),a=null!==(i=e.axes.find((function(t){return"band"===t.type})))&&void 0!==i?i:e.axes.find((function(t){return(r?["left","right"]:["top","bottom"]).includes(t.orient)}));if(a&&!a.bandSize&&!a.maxBandSize&&!a.minBandSize&&e.autoBandSize){var o=G(e.autoBandSize)&&null!==(n=e.autoBandSize.extend)&&void 0!==n?n:0,s=e.series.find((function(t){return"bar"===t.type})),l=s.barMaxWidth,u=s.barMinWidth,c=s.barWidth,h=s.barGapInGroup;this._applyAxisBandSize(a,o,{barMaxWidth:l,barMinWidth:u,barWidth:c,barGapInGroup:h})}}},e}(TK),Vq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=jq,i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i.transformerConstructor=jq,i}(CK);Tt(Vq,PK);var Wq,Gq=function(){rq(),oq(),lq(),IK(),Uq(),FK(),ij.registerChart(Vq.type,Vq)},Yq=[10,20],Xq=KF.Linear,Kq="circle",qq=KF.Ordinal,Zq=["circle","square","triangle","diamond","star"],Jq=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},Qq=M(M({},qG),((Wq={}).point={name:"point",type:"symbol"},Wq)),$q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"point")},e}(hY),tZ={point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},eZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.scatter,i.transformerConstructor=$q,i._invalidType="zero",i}return C(i,e),i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField},i.prototype._getSeriesAttribute=function(t,e,i,n){var r,a,o,s,l=i.defaultScaleType,u=i.defaultRange;if(U(e))return e;if(Z(e)){if(j(t))return null===(r=this._option)||void 0===r||r.onError("".concat(n,"Field is required.")),e;if("ordinal"!==l&&e.length>2)return null===(a=this._option)||void 0===a||a.onError("".concat(n," length is invalid, specify up to 2 ").concat(n,"s.")),e;var c="".concat(Mj,"_series_scatter_").concat(this.id,"_scale_").concat(n);return this._option.globalScale.registerModelScale({id:c,type:l,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:c,field:t}}if(G(e)){if(j(t))return null===(o=this._option)||void 0===o||o.onError("".concat(n,"Field is required.")),e;c="".concat(Mj,"_series_scatter_").concat(this.id,"_scale_").concat(n);var h=M({id:c,type:l,domain:[{dataId:this._rawData.name,fields:[t]}],range:u},e);return this._option.globalScale.registerModelScale(h),{scale:h.id,field:t}}return null===(s=this._option)||void 0===s||s.onError("".concat(n," attribute is invalid.")),e},i.prototype.getSizeAttribute=function(t,e){return j(e)?10:$(e)?e:q(e)&&et(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:Xq,defaultRange:Yq},"size")},i.prototype.getShapeAttribute=function(t,e){return j(e)?Kq:q(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:qq,defaultRange:Zq},"shape")},i.prototype.initMark=function(){this._symbolMark=this._createMark(i.mark.point,{groupKey:this._seriesField,isSeriesMark:!0},{morph:sY(this._spec,i.mark.point.name),morphElementKey:this.getDimensionField()[0]})},i.prototype.initMarkStyle=function(){this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n=vY(this),r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._symbolMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("scatter"))||void 0===i?void 0:i({},r),rY("point",this._spec,this._markAttributeContext),n))},i.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;e&&("zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:$(this._size)||U(this._size)?this._size:10,symbolType:q(this._shape)||U(this._shape)?this._shape:Kq},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),(W(this._sizeField)||W(this._size))&&this.setMarkStyle(e,{size:this.getSizeAttribute(this._sizeField,this._size)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.User_Mark),(W(this._shapeField)||W(this._shape))&&this.setMarkStyle(e,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.User_Mark))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)},i.prototype.viewDataStatisticsUpdate=function(i){var n=this;e.prototype.viewDataStatisticsUpdate.call(this,i);var r=[this.getDimensionField()[0],this.getStackValueField()].every((function(t){var e,i,r;return t&&(null===(r=null===(i=null===(e=n.getViewDataStatistics())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[t])||void 0===r?void 0:r.allValid)}));"zero"===this._invalidType||r?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",t.AttributeLevel.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&(this._labelMark=e,this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[i.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.handleZoom=function(t){var e,i,n=this;this.getMarksWithoutRoot().forEach((function(t){if(t){var e=t.getGraphics();e&&e.length&&e.forEach((function(t,e){var i,r,a=null===(r=null===(i=null==t?void 0:t.context)||void 0===i?void 0:i.data)||void 0===r?void 0:r[0],o=n.dataToPosition(a);o&&t&&t.translateTo(o.x,o.y)}))}}));var r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluate(null,null)},i.prototype.handlePan=function(t){this.handleZoom(t)},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._symbolMark]},i.type=t.SeriesTypeEnum.scatter,i.mark=Qq,i.builtInTheme={scatter:tZ},i.transformerConstructor=$q,i}(gY),iZ=function(){jY(),ij.registerAnimation("scatter",(function(t,e){return M({appear:Jq(0,e)},QW)})),QX(),KX(),ij.registerSeries(eZ.type,eZ)},nZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["point","size","shape","shapeField","sizeField"])},e}(TK),rZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=nZ,i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i.transformerConstructor=nZ,i}(CK);Tt(rZ,PK);var aZ,oZ=function(){rq(),oq(),FK(),IK(),iZ(),ij.registerChart(rZ.type,rZ)},sZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.geo,i.coordinate="geo",i._nameProperty="name",i}return C(i,e),i.prototype.getMapViewData=function(){var t;return null===(t=this._mapViewData)||void 0===t?void 0:t.getDataView()},Object.defineProperty(i.prototype,"nameField",{get:function(){return this._nameField},set:function(t){this._nameField=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueField",{get:function(){return this._valueField},set:function(t){this._valueField=t},enumerable:!1,configurable:!0}),i.prototype.getNameProperty=function(){return this._nameProperty},i.prototype.getCentroidProperty=function(){return this._centroidProperty},i.prototype.getCoordinateHelper=function(){return this._coordinateHelper},i.prototype.setCoordinateHelper=function(t){this._coordinateHelper=t},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t,e){var i,n=null;if(!t)return n;if(e&&!this.isDatumInViewData(t))return n;var r=this._coordinateHelper,a=r.dataToPosition,o=r.latitudeField,s=r.longitudeField;if(null===(n=this.nameToPosition(t))){var l=s?null==t?void 0:t[s]:Number.NaN,u=o?null==t?void 0:t[o]:Number.NaN;n=null!==(i=null==a?void 0:a([l,u]))&&void 0!==i?i:null}return n},i.prototype.nameToPosition=function(t){var e=this.getDatumName(t);return j(e)?null:this.nameValueToPosition(e)},i.prototype.nameValueToPosition=function(t){var e,i,n=this,r=null===(i=null===(e=this.getMapViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.filter((function(e){return n.getDatumName(e)===t}))[0];if(j(r))return null;var a=this._coordinateHelper.dataToPosition,o=this.getDatumCenter(r),s=null==a?void 0:a(o);return j(s)||isNaN(s.x)||isNaN(s.y)?null:s},i.prototype.dataToLatitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.dataToLongitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.valueToPosition=function(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}},i.prototype.positionToData=function(t){},i.prototype.latitudeToData=function(t){},i.prototype.longitudeToData=function(t){},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionZ=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.release=function(){e.prototype.release.call(this),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null},i.prototype.getStackGroupFields=function(){return[this._nameField]},i.prototype.getStackValueField=function(){return this._spec.valueField},i.prototype.compileData=function(){var t;null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initStatisticalData=function(){if(e.prototype.initStatisticalData.call(this),this._mapViewData){var t="".concat(Mj,"_series_").concat(this.id,"_mapViewDataStatic");this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}},i.prototype.getSeriesKeys=function(){var t,e,i,n,r;return this._seriesField?null!==(r=null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:null===(n=null===(i=this._mapViewDataStatistics)||void 0===i?void 0:i.latestData[this._seriesField])||void 0===n?void 0:n.values)&&void 0!==r?r:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(t=this._mapViewData.getDataView())||void 0===t||t.reRunAllTransform(),null===(i=this._mapViewDataStatistics)||void 0===i||i.reRunAllTransform()},i.prototype.getActiveMarks=function(){return[]},i}(dY),lZ="".concat(Mj,"_MAP_LOOK_UP_KEY"),uZ=function(t,e){return t.features&&t.features.forEach((function(t,i){var n;t[Ej]=i;var r=null===(n=t.properties)||void 0===n?void 0:n[e.nameProperty];e.nameMap&&e.nameMap[r]?t[lZ]=e.nameMap[r]:t[lZ]=r})),t.features},cZ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){var i,n=e.series;return null!==(i=e._getDimensionData(t))&&void 0!==i?i:n.getDatumName(t)},e}return C(e,t),e}(OG),hZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0,path:""})},e.type="path",e}(NW),dZ=function(){ij.registerMark(hZ.type,hZ),cP(),QB(),ij.registerGraphicComponent("path",p_)},pZ=M(M({},qG),((aZ={}).area={name:"area",type:"path"},aZ)),fZ=function(){function t(t){this.projection=function(t,e){var i=t.toLowerCase();return arguments.length>1?fc(i,e):dc[i]?(hc[i]||(hc[i]=fc(i,dc[i])),hc[i]):null}(t.type)()}return t.prototype.fit=function(t,e,i){var n={type:"FeatureCollection",features:i};this.projection.fitExtent([t,e],n)},t.prototype.center=function(t){var e,i;null===(i=null===(e=this.projection)||void 0===e?void 0:e.center)||void 0===i||i.call(e,t)},t.prototype.project=function(t){var e;return null===(e=this.projection)||void 0===e?void 0:e.call(this,t)},t.prototype.shape=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.path)||void 0===i?void 0:i.call(e,t)},t.prototype.invert=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.invert)||void 0===i?void 0:i.call(e,t)},t.prototype.scale=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}},t.prototype.translate=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}},t.prototype.evaluate=function(t,e,i){var n=this.projection.copy();return null==n?void 0:n.fitExtent([t,e],{type:"FeatureCollection",features:i})},t}(),vZ=function(){function t(){}return t.prototype.parserScrollEvent=function(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t},t.prototype.parserZoomEvent=function(t){if(!t)return t;var e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t},t.prototype.clearZoom=function(){},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}(),gZ=function(){function t(){this._lastScale=0}return t.prototype.clearZoom=function(){this._lastScale=0},t.prototype.parserZoomEvent=function(t){var e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;var i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t},t.prototype.parserScrollEvent=function(t){return t},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}();function yZ(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:vZ}:YA(e)||XA(e)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside","pointerleave"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:gZ}:null}var mZ={debounce:ve,throttle:ge},_Z=function(){function e(){this._isGestureListener=!1}return e.prototype.initZoomable=function(e,i){void 0===i&&(i=t.RenderModeEnum["desktop-browser"]),this._eventObj=e,this._renderMode=i,this._gestureController=this._option.getCompiler()._gestureController,this._isGestureListener=YA(this._renderMode)||XA(this._renderMode),yZ(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))},e.prototype._getZoomTriggerEvent=function(t){return yZ(this._renderMode)[t]},e.prototype._zoomEventDispatch=function(t,e,i,n){if(this._isGestureListener||t.event){var r=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(r);var a=r,o=a.zoomDelta,s=a.zoomX,l=a.zoomY,u=a.path;if((n||u.some((function(t){return t.name&&t.name.includes("region")})))&&!j(o)&&an({x:s,y:l},this._getRegionOrSeriesLayout(e),!1)){this._clearDragEvent(),this._zoomableTrigger.clearScroll();var c={};i&&(c=i({zoomDelta:o,zoomX:s,zoomY:l},r)),this._eventObj.emit("zoom",M(M({scale:r.zoomDelta,scaleCenter:{x:r.zoomX,y:r.zoomY}},c),{model:this}))}}},e.prototype._getRegionOrSeriesLayout=function(t){"region"!==t.type&&(t=t.getRegion());var e=t.layout.getLayout(),i=e.x,n=e.y;return{x1:i,y1:n,x2:i+e.width,y2:n+e.height}},e.prototype._bindZoomEventAsRegion=function(t,e,i,n){var r,a,o,s,l=this,u=null!==(o=null==n?void 0:n.delayType)&&void 0!==o?o:"throttle",c=null!==(s=null==n?void 0:n.delayTime)&&void 0!==s?s:0,h=this._isGestureListener?this._gestureController:t,d=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:AV.chart,consume:!0}],p=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:AV.chart,consume:!1}];(r=h).on.apply(r,P(P([],B(p),!1),[mZ[u]((function(t){l._zoomableTrigger.clearZoom()}),c)],!1)),(a=h).on.apply(a,P(P([],B(d),!1),[mZ[u]((function(t){var r;l._zoomEventDispatch(t,e,i,null!==(r=null==n?void 0:n.allowComponentZoom)&&void 0!==r&&r)}),c)],!1))},e.prototype.initZoomEventOfSeries=function(t,e,i){this._option.disableTriggerEvent||yZ(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)},e.prototype.initZoomEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindZoomEventAsRegion(t.event,t,i,n)})):r._bindZoomEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._scrollEventDispatch=function(t,e,i){var n=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return n;var r=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(r);var a=r,o=a.scrollX,s=a.scrollY,l=a.canvasX,u=a.canvasY;return j(o)&&j(s)?n:an({x:l,y:u},this._getRegionOrSeriesLayout(e),!1)?(this._clearDragEvent(),this._zoomableTrigger.clearZoom(),i&&(n=i({scrollX:o,scrollY:s},r)),this._eventObj.emit("scroll",{scrollX:o,scrollY:s,model:this}),n):n},e.prototype._bindScrollEventAsRegion=function(t,e,i,n){var r,a,o,s,l=this,u=null!==(o=null==n?void 0:n.delayType)&&void 0!==o?o:"throttle",c=null!==(s=null==n?void 0:n.delayTime)&&void 0!==s?s:0,h=this._isGestureListener?this._gestureController:t,d=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:AV.chart,consume:!0}],p=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:AV.chart,consume:!1}];(r=h).on.apply(r,P(P([],B(p),!1),[mZ[u]((function(t){l._zoomableTrigger.clearScroll()}),c)],!1)),(a=h).on.apply(a,P(P([],B(d),!1),[mZ[u]((function(t){return l._scrollEventDispatch(t,e,i)}),c)],!1))},e.prototype.initScrollEventOfSeries=function(t,e,i){yZ(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)},e.prototype.initScrollEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindScrollEventAsRegion(t.event,t,i,n)})):r._bindScrollEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._bindDragEventAsRegion=function(t,e,i,n){var r=this;t.on(this._getZoomTriggerEvent("start"),{level:AV.chart},(function(t){if(t.event){var a=t.event;an({x:a.canvasX,y:a.canvasY},r._getRegionOrSeriesLayout(e),!1)&&r._handleDrag(t,i,n)}})),t.on("click",{level:AV.chart},(function(){return!r._clickEnable}))},e.prototype.initDragEventOfSeries=function(t,e,i){var n=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:AV.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(t){n._handleDrag(t,e,i)}))},e.prototype.initDragEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&(t.event.on(r._getZoomTriggerEvent("start"),{level:AV.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(t){r._handleDrag(t,i)})),t.event.on("click",{level:AV.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(){return!r._clickEnable})))})):r._bindDragEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._clearDragEvent=function(){var t=this,e=this._getZoomTriggerEvent("move"),i=this._getZoomTriggerEvent("end");this._handleDragMouseMove&&(this._eventObj.off(e,{level:AV.chart,source:SV.chart},this._handleDragMouseMove),this._handleDragMouseMove=void 0),this._handleDragMouseUp&&(i.forEach((function(e){t._eventObj.off(e,{level:AV.chart,source:SV.chart},t._handleDragMouseUp),t._eventObj.allow(e)})),this._handleDragMouseUp=void 0)},e.prototype.isDragEnable=function(t){if(this._isGestureListener&&this._gestureController){var e=this._gestureController.cachedEvents;return!e||e.length<2}return!0},e.prototype._handleDrag=function(t,e,i){var n,r,a,o=this;if(this._clearDragEvent(),!this._option.disableTriggerEvent&&(this._clickEnable=!1,this.isDragEnable(t.event))){this._zoomableTrigger.clearZoom(),this._zoomableTrigger.clearScroll();var s=null!==(n=null==i?void 0:i.delayType)&&void 0!==n?n:"throttle",l=null!==(r=null==i?void 0:i.delayTime)&&void 0!==r?r:0,u=null===(a=null==i?void 0:i.realTime)||void 0===a||a,c=this._getZoomTriggerEvent("move"),h=this._getZoomTriggerEvent("end"),d=t.event,p=d.canvasX,f=d.canvasY,v=d.canvasX,g=d.canvasY;this._handleDragMouseUp=mZ[s]((function(t){o._clickEnable=!0;var i=t.event,n=[i.canvasX-v,i.canvasY-g];v=i.canvasX,g=i.canvasY,!u&&e&&e(n,t.event),o._eventObj.emit("panend",{delta:n,model:o}),o._clearDragEvent()}),l),this._handleDragMouseMove=mZ[s]((function(t){if(o.isDragEnable(t.event)){o._clickEnable=!1,h.forEach((function(t){o._eventObj.prevent(t,{handler:o._handleDragMouseUp,level:AV.chart})}));var i=t.event,n=[i.canvasX-p,i.canvasY-f];p=i.canvasX,f=i.canvasY,u&&e&&e(n,t.event),o._eventObj.emit("panmove",{delta:n,model:o})}}),l),this._eventObj.on(c,{level:AV.chart,source:SV.chart},this._handleDragMouseMove),h.forEach((function(t){o._eventObj.on(t,{level:AV.chart,source:SV.chart},o._handleDragMouseUp)}))}},e}();function bZ(t,e){return"".concat(Mj,"_").concat(e,"_").concat(t)}var xZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=L.geoCoordinate,i.name=L.geoCoordinate,i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.Mark,i._projectionSpec={name:bZ(i.type,i.id),type:"mercator"},i._actualScale=1,i._initialScale=1,i.effect={scaleUpdate:function(){i.coordinateHelper()}},i._handleChartZoom=function(t,e){var n,r,a,o,s,l,u=t.zoomDelta,c=i._actualScale;return i._actualScale*=u,i._actualScale<(null===(n=i._spec.zoomLimit)||void 0===n?void 0:n.min)?(i._actualScale=null===(r=i._spec.zoomLimit)||void 0===r?void 0:r.min,u=(null===(a=i._spec.zoomLimit)||void 0===a?void 0:a.min)/c):i._actualScale>(null===(o=i._spec.zoomLimit)||void 0===o?void 0:o.max)&&(i._actualScale=null===(s=i._spec.zoomLimit)||void 0===s?void 0:s.max,u=(null===(l=i._spec.zoomLimit)||void 0===l?void 0:l.max)/c),i.zoom(u,[t.zoomX,t.zoomY]),{scale:u,totalScale:i._actualScale}},i.pan=function(t){var e,n,r;void 0===t&&(t=[0,0]);var a=null!==(n=null===(e=i._projection)||void 0===e?void 0:e.translate())&&void 0!==n?n:[0,0],o=a[0],s=a[1];o+=t[0],s+=t[1],null===(r=i._projection)||void 0===r||r.translate([o,s])},i}return C(i,e),Object.defineProperty(i.prototype,"longitudeField",{get:function(){return this._longitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"latitudeField",{get:function(){return this._latitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"projectionSpec",{get:function(){return this._projectionSpec},enumerable:!1,configurable:!0}),i.prototype.setProjection=function(t){this._projectionSpec=M(M({},t),{name:this._projectionSpec.name})},i.prototype.getZoom=function(){return this._actualScale},i.getSpecInfo=function(t){if(j(t))return null;var e=[];return t.region.forEach((function(t,i){if("geo"===t.coordinate){var n=M(M({},t),{padding:0});e.push({spec:n,regionIndex:i,type:L.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}})),e},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=ej(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null===(t=this._spec.zoomLimit)||void 0===t?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null===(i=this._spec.zoomLimit)||void 0===i?void 0:i.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!==(n=this._projectionSpec.zoom)&&void 0!==n?n:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()},i.prototype.dispatchZoom=function(t,e){var i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},n=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y}),r=n.scale,a=n.totalScale;1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:a,model:this})},i.prototype.initEvent=function(){var e,i,n,r=this;this.event.on(t.ChartEvent.scaleUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===r.id}},this.effect.scaleUpdate.bind(this));var a=this._spec.roam;if(a){var o=!0,s=!0,l=!1;!0!==a&&(o=null===(e=a.zoom)||void 0===e||e,s=null===(i=a.drag)||void 0===i||i,l=null!==(n=a.blank)&&void 0!==n&&n),o&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),s&&this.initDragEventOfRegions(this._regions,l?null:function(){return!0},this.pan),this._regions.forEach((function(t){t.getSeries().forEach((function(t){t.event.on("zoom",(function(e){return t.handleZoom(e),!0})),t.event.on("panmove",(function(e){return t.handlePan(e),!0}))}))}))}},i.prototype.initProjection=function(){var t;this._projection=new fZ(this._projectionSpec),null!==this._projection.projection||null===(t=this._option)||void 0===t||t.onError("unsupported projection type!")},i.prototype.coordinateHelper=function(){var e=this,i={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:function(){return e.id}};this._regions.forEach((function(n){n.getSeries().forEach((function(n){n.type===t.SeriesTypeEnum.map||n.type===t.SeriesTypeEnum.pictogram?n.setCoordinateHelper(i):(n.setXAxisHelper(M(M({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,a=t[0];if(j(a)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];a=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.x}return e.dataToLongitude(a)},valueToPosition:function(t,i){var r;if(j(t)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.x}return e.dataToLongitude(t)},getFields:function(){return[e._longitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})),n.setYAxisHelper(M(M({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,a=t[0];if(j(a)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];a=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.y}return e.dataToLatitude(a)},valueToPosition:function(t,i){var r;if(j(t)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.y}return e.dataToLatitude(t)},getFields:function(){return[e._latitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})))}))}))},i.prototype.onLayoutEnd=function(){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());var i=this.getLayoutRect(),n=i.width,r=i.height,a=this.evaluateProjection([0,0],[n,r]),o=a.translate,s=a.scale,l=a.center;o&&this._projection.translate(o),s&&this._projection.scale(s),l&&this._projection.center(l),cU(this._regions,(function(e){var i;if(e.type===t.SeriesTypeEnum.map||e.type===t.SeriesTypeEnum.pictogram){null===(i=e.areaPath)||void 0===i||i.clear();var n=e.getRootMark().getProduct();n&&n.attribute.postMatrix&&n.setAttributes({postMatrix:new Hn})}})),this._actualScale=this._initialScale,e.prototype.onLayoutEnd.call(this)},i.prototype.collectFeatures=function(){var e=[];return this._regions.forEach((function(i){i.getSeries().forEach((function(i){var n,r;i.type!==t.SeriesTypeEnum.map&&i.type!==t.SeriesTypeEnum.pictogram||e.push.apply(e,P([],B(null!==(r=null===(n=i.getMapViewData())||void 0===n?void 0:n.latestData)&&void 0!==r?r:[]),!1))}))})),e},i.prototype.dataToPosition=function(t){var e;void 0===t&&(t=[]);var i=null===(e=this._projection)||void 0===e?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}},i.prototype.dataToLatitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([0,t]);return null==i?void 0:i[1]},i.prototype.dataToLongitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([t,0]);return null==i?void 0:i[0]},i.prototype.zoom=function(t,e){var i,n,r,a,o,s;void 0===e&&(e=[0,0]);var l=null!==(n=null===(i=this._projection)||void 0===i?void 0:i.scale())&&void 0!==n?n:0,u=null!==(a=null===(r=this._projection)||void 0===r?void 0:r.translate())&&void 0!==a?a:[0,0],c=u[0],h=u[1];l*=t,c-=(e[0]-c)*(t-1),h-=(e[1]-h)*(t-1),null===(o=this._projection)||void 0===o||o.scale(l),null===(s=this._projection)||void 0===s||s.translate([c,h])},i.prototype.shape=function(t){return this._projection.shape(t)},i.prototype.invert=function(t){return this._projection.invert(t)},i.prototype.evaluateProjection=function(t,e){var i,n=this._projection.evaluate(t,e,this.collectFeatures()),r=n.translate(),a=n.scale()*this._initialScale,o=null!==(i=this._projectionSpec.center)&&void 0!==i?i:n.invert([e[0]/2,e[1]/2]);return o&&(r=[e[0]/2,e[1]/2]),{translate:r,scale:a,center:o}},i.prototype._initCenterCache=function(){var t=this;this._centerCache||(this._centerCache=new Map),this._regions.forEach((function(e){e.getSeries().forEach((function(e){var i,n;"map"===e.type&&(null!==(n=null===(i=e.getMapViewData())||void 0===i?void 0:i.latestData)&&void 0!==n?n:[]).forEach((function(i){void 0===i&&(i={});var n=i[e.getDimensionField()[0]]||i[lZ],r=e.getDatumCenter(i);n&&W(r)&&t._centerCache.set(n,{x:r[0],y:r[1]})}))}))}))},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||(n.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit"].some((function(e){return!St(null==i?void 0:i[e],t[e])}))),n},i.prototype.release=function(){e.prototype.release.call(this),this._centerCache&&this._centerCache.clear(),this._centerCache=null},i.type=L.geoCoordinate,i}(CX);Tt(xZ,_Z);var kZ=function(){ij.registerComponent(xZ.type,xZ)},SZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)},e}(hY),AZ={defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}},CZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.map,i.transformerConstructor=SZ,i._areaCache=new Map,i}return C(i,e),i.prototype.getNameMap=function(){return this._nameMap},Object.defineProperty(i.prototype,"areaPath",{get:function(){return this._areaCache},enumerable:!1,configurable:!0}),i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null===(t=this._option)||void 0===t||t.onError("map type '".concat(this.map,"' is not specified !")),RV.get(this.map)||null===(i=this._option)||void 0===i||i.onError("'".concat(this.map,"' data is not registered !"))},i.prototype.initData=function(){var i,n,r=this;e.prototype.initData.call(this),EV(this._dataSet,"copyDataView",jV),EV(this._dataSet,"map",uZ),EV(this._dataSet,"lookup",TG);var a=RV.get(this.map);a||null===(i=this._option)||void 0===i||i.onError("no valid map data found!");var o=new cc(this._dataSet,{name:"map_".concat(this.id,"_data")});o.parse([a],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:t.TransformLevel.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:function(){var t;return null===(t=r._data)||void 0===t?void 0:t.getLatestData()},key:lZ,fields:this._nameField,set:function(t,e){e&&Object.keys(e).forEach((function(i){i in t||(t[i]=e[i])}))}}}),null===(n=this._data)||void 0===n||n.getDataView().target.addListener("change",o.reRunAllTransform),this._mapViewData=new IW(this._option,o)},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initMark=function(){this._pathMark=this._createMark(i.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0},{morph:sY(this._spec,i.mark.area.name),morphElementKey:this.getDimensionField()[0]}),this._pathMark.setData(this._mapViewData)},i.prototype.initMarkStyle=function(){var e=this,i=this._pathMark;i&&(this.setMarkStyle(i,{fill:function(t){var i,n,r,a;return W(t[null!==(i=e._seriesField)&&void 0!==i?i:Pj])?(null!==(n=e._option.globalScale.getScale("color"))&&void 0!==n?n:e._getDefaultColorScale()).scale(t[null!==(r=e._seriesField)&&void 0!==r?r:Pj]):null===(a=e._spec)||void 0===a?void 0:a.defaultFillColor},path:this.getPath.bind(this)},"normal",t.AttributeLevel.Series),i.setPostProcess("fill",(function(t){return W(t)?t:e._spec.defaultFillColor})),this.setMarkStyle(i,{smoothScale:!0},"normal",t.AttributeLevel.Built_In))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this._labelMark=t,this.setMarkStyle(t,{text:function(t){return e.getDatumName(t)},x:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.x},y:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.y}}))},i.prototype.initAnimation=function(){var t;this._pathMark.setAnimationConfig(nY(null===(t=ij.getAnimationInKey("fadeInOut"))||void 0===t?void 0:t(),rY("area",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new cZ(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)},i.prototype.getPath=function(t){var e,i=this._areaCache.get(t[Ej]);if(i)return i.shape;var n=null===(e=this._coordinateHelper)||void 0===e?void 0:e.shape(t);return this._areaCache.set(t[Ej],{shape:n}),n},i.prototype.onEvaluateEnd=function(){this._mapViewData.updateData()},i.prototype.getDimensionField=function(){return[this.nameField]},i.prototype.getMeasureField=function(){return[this.valueField]},i.prototype.release=function(){e.prototype.release.call(this),this._areaCache.clear(),this._nameMap={},this._mapViewData=null},i.prototype.handleZoom=function(t){var e,i=t.scale,n=t.scaleCenter;if(1!==i){var r=this.getRootMark().getProduct();r&&(r.attribute.postMatrix||r.setAttributes({postMatrix:new Hn}),r.scale(i,i,n));var a=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent();a&&a.renderInner()}},i.prototype.handlePan=function(t){var e,i=t.delta;if(0!==i[0]||0!==i[1]){var n=this.getRootMark().getProduct();n&&(n.attribute.postMatrix||n.setAttributes({postMatrix:new Hn}),n.translate(i[0],i[1]));var r=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent();r&&r.renderInner()}},i.prototype.getDatumCenter=function(t){var e,i,n,r;return this._centroidProperty&&(null===(e=t.properties)||void 0===e?void 0:e[this._centroidProperty])?null===(i=t.properties)||void 0===i?void 0:i[this._centroidProperty]:it(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null===(n=t.properties)||void 0===n?void 0:n.center)?t.properties.center:(null===(r=t.properties)||void 0===r?void 0:r.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]},i.prototype.getDatumName=function(t){var e;if(t[this.nameField])return t[this.nameField];var i=null===(e=t.properties)||void 0===e?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._mapViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._mapViewData)||void 0===r||r.updateData()},i.prototype._getDataIdKey=function(){return Ej},i.prototype.getActiveMarks=function(){return[this._pathMark]},i.type=t.SeriesTypeEnum.map,i.mark=pZ,i.builtInTheme={map:AZ},i.transformerConstructor=SZ,i}(sZ),MZ=function(){kZ(),dZ(),ij.registerSeries(CZ.type,CZ),ij.registerImplement("registerMap",IV),ij.registerImplement("unregisterMap",FV),eG()},wZ="".concat(Mj,"_waterfall_default_seriesField"),TZ=function(t,e){if(!t||0===t.length)return t;var i=e.indexField,n=e.total,r=e.groupData,a=e.calculationMode,o=[],s=r().latestData,l=s.dimensionValues,u=s.dimensionData,c=Array.from(l[i]);"decrease"===a&&(c=c.reverse());var h={start:0,end:0,positive:0,negative:0,lastIndex:null};return c.forEach((function(t,i){var r={start:h.end,end:h.end,lastIndex:h.lastIndex,lastEnd:h.end,index:t,isTotal:!1,positive:h.end,negative:h.end},a=!0===e.stackInverse?u[t].reverse():u[t];if(null==a||a.forEach((function(t,e){e===a.length-1?t[Vj]=!0:delete t[Vj]})),a.length>1){var s=function(t){if(n&&"end"!==n.type){if("field"===n.type||"custom"===n.type){return!!t[n.tagField]}}else if(i===c.length-1)return!0;return!1};if(a.some((function(t){return s(t)})))return h=function(t,e,i,n,r,a,o,s,l){i.isTotal=!0;var u=s.valueField,c=s.startAs,h=s.endAs,d=s.total,p=[],f=[];if(t.forEach((function(t,e){var i;l(t)?f.push(M(M({},t),((i={})._vchart_waterfall_waterfall_temp=e,i))):p.push(t)})),f.length===t.length){var v=DZ([t[0]],e,i,n,r,a,o,s);return f.forEach((function(e){e[c]=t[0][c],e[h]=t[0][h],e[u]=t[0][u]})),v}var g=EZ(f[0],i,n,r,d),y=g.start,m=g.end;i.start=y,i.end=m;var _=y,b=y,x=m-y,k=p.reduce((function(t,e){return xi(t,+e[u])}),x);return f.forEach((function(t){var e,i=((e={})[c]=y,e[h]=m,e[u]=k,e);p.splice(t._vchart_waterfall_waterfall_temp,0,i)})),p.forEach((function(t){var e=+t[u];e>=0?(t[c]=+_,_=bi(_,e)):(t[c]=+b,b=bi(b,e)),t[h]=bi(t[c],e),y=bi(y,e),x=xi(x,e)})),f.forEach((function(e){var i=e._vchart_waterfall_waterfall_temp;e=p[i];var n=t[i];n[c]=e[c],n[h]=e[h],n[u]=e[u]})),M(M({},i),{lastIndex:e})}(a,t,r,o,h,c,i,e,s),void o.push(r)}h=DZ(a,t,r,o,h,c,i,e),o.push(r)})),o};function DZ(t,e,i,n,r,a,o,s){var l=s.valueField,u=s.startAs,c=s.endAs,h=s.total,d=s.seriesField,p=s.seriesFieldName;return t.forEach((function(t){var e=!1;if(h&&"end"!==h.type){if("field"===h.type||"custom"===h.type){if(t[h.tagField]){e=!0;var s=EZ(t,i,n,r,h),f=s.start,v=s.end;t[u]=f,t[c]=v,t[l]=v-f,i.start=f,i.end=v}}}else o===a.length-1&&(i.start=0,t[u]=i.start,t[c]=i.end,e=!0);if(!e){var g=+t[l];g>=0?(t[u]=+i.positive,i.positive=bi(i.positive,g)):(t[u]=+i.negative,i.negative=bi(i.negative,g)),t[c]=bi(t[u],g),i.end=bi(i.end,g)}i.isTotal=e,(j(d)||d===wZ)&&(t[wZ]=e?p.total:+t[l]>=0?p.increase:p.decrease)})),M(M({},i),{lastIndex:e})}function EZ(t,e,i,n,r){return r&&"end"!==r.type?"field"===r.type||"custom"===r.type?"custom"===r.type?function(t,e,i){return i.product(t,e)}(t,n,r):r.collectCountField&&!j(t[r.collectCountField])?function(t,e,i,n){var r=0,a=i.end,o=e.length-+t[n.collectCountField],s=e.length-1;o<0?NA("total.collectCountField error"):r=e[o].start;s<0?NA("total.collectCountField error"):a=e[s].end;return{start:r,end:a}}(t,i,e,r):function(t,e,i){var n=0,r=e.end;i.startField&&!j(t[i.startField])&&(n=+t[i.startField]);i.valueField&&!j(t[i.valueField])&&(r=bi(n,+t[i.valueField]));return{start:n,end:r}}(t,e,r):{start:0,end:0}:function(t){return{start:0,end:t.end}}(e)}var BZ=function(t,e){var i;if(!t)return t;var n=e.indexField,r=e.valueField,a=e.total,o=e.seriesField,s=e.calculationMode,l=((i={})[n]=(null==a?void 0:a.text)||"total",i[r]=t.reduce((function(t,e){return bi(t,+e[r])}),0),i);return o&&(l[o]="total"),"decrease"===s?t.unshift(l):t.push(l),t},PZ={type:"fadeIn"},RZ={type:"growCenterIn"};function LZ(t,e){switch(e){case"fadeIn":return PZ;case"scaleIn":return RZ;default:return Mq(t,!1)}}var IZ,FZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{x1:0,y1:0})},e.prototype._transformGraphicAttributes=function(e,i,n){var r=t.prototype._transformGraphicAttributes.call(this,e,i,n),a=r.x,o=r.x1,s=r.y,l=r.y1,u=w(r,["x","x1","y","y1"]);return M(M({},u),{points:[{x:a,y:s},{x:o,y:l}]})},e.prototype._createGraphic=function(t){return void 0===t&&(t={}),jm(t)},e.type="rule",e}(NW),OZ=function(){ij.registerMark(FZ.type,FZ),cP(),ZB(),ij.registerGraphicComponent("line",jm)},zZ=M(M({},Iq),((IZ={}).leaderLine={name:"leaderLine",type:"rule"},IZ.stackLabel={name:"stackLabel",type:"text"},IZ)),HZ=function(t,e){if(!e.fields)return t;var i={};return{dimensionValues:i,dimensionData:NZ(t.map((function(t){return t.latestData})).flat(),e.fields,i)}};function NZ(t,e,i){if(0===e.length)return t;var n=e[0],r=e.slice(1);i[n]=new Set;var a,o,s=function(t,e,i){var n={};return t.forEach((function(t){var r=t[e];n[r]||(n[r]=[],i.add(r)),n[r].push(t)})),n}(t,n,i[n]);return r.length?(a=s,o=function(t,e){return NZ(t,r,i)},Object.keys(a).reduce((function(t,e){return t[e]=o(a[e],e),t}),{})):s}var UZ=function(){function t(t){this._fields=[],this._fields=t}return Object.defineProperty(t.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groupData",{get:function(){return this._groupData},enumerable:!1,configurable:!0}),t.prototype.initData=function(t,e){var i=t.name,n=new cc(e instanceof uc?e:t.dataSet);n.name=i,n.parse([t],{type:"dataview"}),EV(e,"dimensionTree",HZ),n.transform({type:"dimensionTree",options:{fields:this._fields}},!1),n.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=n},t.prototype.groupDataUpdate=function(){},t.prototype.getGroupValueInField=function(t){var e,i,n,r=null===(n=null===(i=null===(e=this.groupData)||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.dimensionValues)||void 0===n?void 0:n[t];return r?Array.from(r):[]},t}(),jZ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")},e}(zq),VZ={rect:KZ,symbol:XZ,arc:ZZ,point:function(t){var e;e=!1!==t.labelSpec.overlap&&{clampForce:!1,avoidBaseMark:!1};return{position:"center",overlap:e}},"line-data":function(t){var e=XZ(t);N(e.overlap)||(e.overlap.avoidBaseMark=!1,e.overlap.clampForce=!1);return e},stackLabel:JZ,line:QZ,area:QZ,rect3d:KZ,arc3d:ZZ,treemap:function(t){return{customLayoutFunc:function(t,e){return e},overlap:!1}},venn:function(t){return{customLayoutFunc:function(t,e){return e},smartInvert:!0}}};function WZ(e,i){var n,r=i.labelSpec;r.overlap&&!G(r.overlap)&&(r.overlap={});var a=null!==(n=VZ[e])&&void 0!==n?n:VZ.point;return i.series.type===t.SeriesTypeEnum.sankey?function(t){var e,i,n,r,a=t.series,o=t.labelSpec,s=void 0===o?{}:o,l=null!==(e=YZ(s.position))&&void 0!==e?e:"outside",u=a.direction,c=l;q(l)&&("vertical"===u?c="inside-start"===l?function(t){return"inside-left"}:"inside-middle"===l?function(t){return"center"}:"inside-end"===l?function(t){return"inside-right"}:function(t){return"bottom"}:"inside-start"===l?c=function(t){return"inside-left"}:"inside-middle"===l?c=function(t){return"center"}:"inside-end"===l?c=function(t){return"inside-right"}:"outside"===l&&(c=function(t){return"right"}));r=!1!==s.overlap&&((!q(l)||!l.includes("inside"))&&{strategy:null!==(n=null===(i=s.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:$Z(a)});return{position:c,overlap:r,smartInvert:!1,offset:0,syncState:!0}}(i):a(i)}function GZ(e,i,n,r){var a,o,s=e.labelMark,l=e.series,u=l.getMeasureField()[0],c=s.getAttributesOfState(i);if("text"in c||(c.text=null!==(a=c.text)&&void 0!==a?a:i[u]),"textType"in c||(c.textType=null!==(o=e.labelSpec.textType)&&void 0!==o?o:"text"),c.data=i,l.type!==t.SeriesTypeEnum.sankey){var h=MG(n,r,c.text,i),d=h.formatFunc,p=h.args;d&&(c._originText=c.text,c.text=d.apply(void 0,P(P([],B(p),!1),[{series:l}],!1)))}return c}function YZ(t){return U(t)?function(e){return t(e.data)}:t}function XZ(t){var e,i,n,r=t.series,a=t.labelSpec,o="horizontal"===r.direction?"right":"top",s=null!==(e=YZ(a.position))&&void 0!==e?e:o;return{position:s,overlap:!1!==a.overlap&&{strategy:null!==(n=null===(i=a.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:([{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}]),avoidBaseMark:"center"!==s}}}function KZ(t){var e,i,n,r,a,o,s,l,u=t.series,c=t.labelSpec,h=void 0===c?{}:c,d=null!==(e=YZ(h.position))&&void 0!==e?e:"outside",p=null!==(i=u.direction)&&void 0!==i?i:"vertical",f="horizontal"===u.direction?null===(n=u.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=u.getYAxisHelper())||void 0===r?void 0:r.isInverse();s=function(t){var e,i=t.data,n=null!==(e="function"==typeof h.position?h.position(i):h.position)&&void 0!==e?e:"outside";if("outside"===n){var r=u.getMeasureField()[0],a=(null==i?void 0:i[r])>=0&&f||(null==i?void 0:i[r])<0&&!f?1:0;return{vertical:["top","bottom"],horizontal:["right","left"]}[p][a]}return n},l=!1!==h.overlap&&{strategy:null!==(o=null===(a=h.overlap)||void 0===a?void 0:a.strategy)&&void 0!==o?o:qZ(u)};var v=!1;return q(d)&&d.includes("inside")&&(v=!0),{position:s,overlap:l,smartInvert:v}}function qZ(t){var e=[{type:"position",position:function(e){var i,n,r=e.data,a=t.getMeasureField()[0];return("horizontal"===t.direction?null===(i=t.getXAxisHelper())||void 0===i?void 0:i.isInverse():null===(n=t.getYAxisHelper())||void 0===n?void 0:n.isInverse())?(null==r?void 0:r[a])>=0?"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[a])>=0?"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]}}];return e}function ZZ(t){var e,i=t.labelSpec,n=null!==(e=YZ(i.position))&&void 0!==e?e:"outside";return{position:n,smartInvert:i.smartInvert?i.smartInvert:q(n)&&n.includes("inside")}}function JZ(t,e,i){var n=t.series,r=t.labelSpec||{},a=n.getTotalData();return{customLayoutFunc:function(a){return a.map((function(a){var o=r.position||"withChange",s=r.offset||0,l=e?e(a.data):a.data,u=GZ(t,l,r.formatMethod);return u.x=function(t,e,i,n){return"horizontal"===e.direction?"middle"===i?.5*(e.totalPositionX(t,"end")+e.totalPositionY(t,"start")):"max"===i?e.totalPositionX(t,t.end>=t.start?"end":"start")+n:"min"===i?e.totalPositionX(t,t.end>=t.start?"start":"end")-n:e.totalPositionX(t,"end")+(t.end>=t.start?n:-n):e.totalPositionX(t,"index",.5)}(l,n,o,s),u.y=function(t,e,i,n){return"horizontal"===e.direction?e.totalPositionY(t,"index",.5):"middle"===i?.5*(e.totalPositionY(t,"end")+e.totalPositionY(t,"start")):"max"===i?e.totalPositionY(t,t.end>=t.start?"end":"start")-n:"min"===i?e.totalPositionY(t,t.end>=t.start?"start":"end")+n:e.totalPositionY(t,"end")+(t.end>=t.start?-n:n)}(l,n,o,s),"horizontal"===n.direction?u.textAlign="middle"===o?"center":"withChange"===o&&l.end-l.start>=0||"max"===o?"left":"right":u.textBaseline="middle"===o?o:"withChange"===o&&l.end-l.start>=0||"max"===o?"bottom":"top",null==i||i(a,l,u),Fm(M(M({},u),{id:a.id}))}))},dataFilter:function(t){var e=[];return a.forEach((function(i){var r=t.find((function(t){var e;return i.index===(null===(e=t.data)||void 0===e?void 0:e[n.getDimensionField()[0]])}));r&&(r.data=i,e.push(r))})),e},overlap:{strategy:[]}}}function QZ(t){var e,i,n,r,a,o=t.labelSpec,s=t.series,l=null===(r=null===(n=null===(i=s.getViewDataStatistics)||void 0===i?void 0:i.call(s).latestData)||void 0===n?void 0:n[s.getSeriesField()])||void 0===r?void 0:r.values,u=l?l.map((function(t,e){var i;return(i={})[s.getSeriesField()]=t,i.index=e,i})):[(e={index:0},e[Pj]=s.getSeriesKeys()[0],e)];return{position:null!==(a=o.position)&&void 0!==a?a:"end",data:u,overlap:{avoidBaseMark:!1,clampForce:!1}}}function $Z(t){return[{type:"position",position:function(e){return"horizontal"===t.direction?["right","left"]:["bottom","top"]}}]}var tJ,eJ={seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}},iJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.waterfall,i.transformerConstructor=jZ,i._leaderLineMark=null,i._stackLabelMark=null,i._labelMark=null,i._reStackTotal=function(){var t=i.getStackData(),e=i.getStackValueField();t&&nV(t,e)},i}return C(i,e),i.prototype.getTotalData=function(){var t;return null===(t=this._totalData)||void 0===t?void 0:t.getLatestData()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups=new UZ(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],j(this._seriesField)&&(this._seriesField=wZ)},i.prototype.getSeriesKeys=function(){return this._seriesField===wZ?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:e.prototype.getSeriesKeys.call(this)},i.prototype.initData=function(){var t,i,n,r=this;e.prototype.initData.call(this),EV(this._dataSet,"waterfallFillTotal",BZ),EV(this._dataSet,"waterfall",TZ),(j(this._spec.total)||"end"===this._spec.total.type)&&(null===(t=this._rawData)||void 0===t||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total,calculationMode:null!==(i=this._spec.calculationMode)&&void 0!==i?i:"increase",stackInverse:this.getRegion().getStackInverse()}},!1));var a=VV(this.getViewData(),this._dataSet,{name:"".concat(Mj,"_series_").concat(this.id,"_totalData")});this.getViewData().target.removeListener("change",a.reRunAllTransform),this._totalData=new IW(this._option,a),a.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:Ij,endAs:Fj,total:this._spec.total,calculationMode:null!==(n=this._spec.calculationMode)&&void 0!==n?n:"increase",groupData:function(){return r.getGroups().groupData},stackInverse:this.getRegion().getStackInverse()}},!1),a.target.addListener("change",this._reStackTotal)},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._totalData)||void 0===t||t.compile()},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,s=vY(this);this._barMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("waterfall"))||void 0===i?void 0:i(a,o),rY("bar",this._spec,this._markAttributeContext),s)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),rY("leaderLine",this._spec,this._markAttributeContext)))},i.prototype.viewDataUpdate=function(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),e.prototype.viewDataUpdate.call(this,t)},i.prototype.addViewDataFilter=function(t){},i.prototype.reFilterViewData=function(){},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._totalData.updateData()},i.prototype.initMark=function(){e.prototype.initMark.call(this);var t=this._createMark(i.mark.leaderLine,{key:"index"});t&&(this._leaderLineMark=t,t.setData(this._totalData))},i.prototype.initLabelMarkStyle=function(t){var i;if(t)return!this._labelMark&&(null===(i=this._spec.label)||void 0===i?void 0:i.visible)?(e.prototype.initLabelMarkStyle.call(this,t),void(this._labelMark=t)):void 0},i.prototype.initStackLabelMarkStyle=function(t){var e=this;t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setData(this._totalData),this.setMarkStyle(t,{text:function(t){var i;return"absolute"===(null===(i=e._spec.stackLabel)||void 0===i?void 0:i.valueType)?t.end:xi(t.end,t.start)}}))},i.prototype.initTotalLabelMarkStyle=function(t){var e=this;this.setMarkStyle(t,{text:function(t){var i;return"end"in t?"absolute"===(null===(i=e._spec.totalLabel)||void 0===i?void 0:i.valueType)?t.end:xi(t.end,t.start):"horizontal"===e.direction?t[e._fieldX[0]]:t[e._fieldY[0]]}})},i.prototype.getTotalLabelComponentStyle=function(t){var e=this;return JZ(M(M({},t),{series:this,labelSpec:this._spec.totalLabel}),(function(t){var i="vertical"===e.direction?t[e._fieldX[0]]:t[e._fieldY[0]];return e._totalData.getLatestData().find((function(t){return t.index===i}))}))},i.prototype.totalPositionX=function(t,e,i){void 0===i&&(i=.5);var n=this._xAxisHelper,r=n.dataToPosition,a=n.getBandwidth;return"horizontal"===this._direction?RU(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*a(0)-this._barMark.getAttribute("width",t)*(.5-i)},i.prototype.totalPositionY=function(t,e,i){void 0===i&&(i=.5);var n=this._yAxisHelper,r=n.dataToPosition,a=n.getBandwidth;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*a(0)-this._barMark.getAttribute("height",t)*(.5-i):RU(r([t[e]],{bandPosition:this._bandPosition}))},i.prototype.initMarkStyle=function(){var i=this;e.prototype.initMarkStyle.call(this);var n="decrease"===this._spec.calculationMode;this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:function(t){return i.isVisibleLeaderLine(t)},x:function(t){return i.totalPositionX(t,"lastEnd",0)},x1:function(t){return i.totalPositionX(t,t.isTotal?"end":"start",0)},y:function(t){return t.lastIndex?i.totalPositionY(t,"lastIndex",n?0:1):0},y1:function(t){return i.totalPositionY(t,"index",n?1:0)}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._leaderLineMark,{visible:function(t){return i.isVisibleLeaderLine(t)},x:function(t){return t.lastIndex?i.totalPositionX(t,"lastIndex",n?0:1):0},x1:function(t){return i.totalPositionX(t,"index",n?1:0)},y:function(t){return i.totalPositionY(t,"lastEnd",0)},y1:function(t){return i.totalPositionY(t,t.isTotal?"end":"start",0)}},"normal",t.AttributeLevel.Series))},i.prototype.isVisibleLeaderLine=function(t){return!j(t.lastIndex)&&LU([t.lastEnd,t[t.isTotal?"end":"start"]],"horizontal"===this.direction?this._xAxisHelper.getScale(0):this._yAxisHelper.getScale(0))},i.type=t.SeriesTypeEnum.waterfall,i.mark=zZ,i.builtInTheme={waterfall:eJ},i.transformerConstructor=jZ,i}(Nq),nJ=function(){OZ(),Lq(),ij.registerAnimation("waterfall",(function(t,e){return{appear:LZ(t,e),enter:Mq(t,!1),exit:wq(t,!1),disappear:wq(t,!1)}})),eG(),QX(),KX(),ij.registerSeries(iJ.type,iJ)},rJ="".concat(Mj,"_BOX_PLOT_OUTLIER_VALUE");!function(t){t.OUTLIER="outlier",t.MAX="max",t.MIN="min",t.MEDIAN="median",t.Q1="q1",t.Q3="q3",t.SERIES_FIELD="seriesField"}(tJ||(tJ={}));var aJ,oJ=function(t,e){var i=[],n=e.outliersField,r=e.dimensionField;return(t[0].latestData||[]).forEach((function(t){var e=t[n];Z(e)||(e=[e]),i.push.apply(i,P([],B(e.map((function(e){var i,n=((i={})[rJ]=e,i);return r.forEach((function(e){n[e]=t[e]})),n}))),!1))})),i},sJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getContentKey=function(t){return function(i){if(e.isOutlierMark(i))return t===tJ.OUTLIER?e.series.getOutliersField():t===tJ.SERIES_FIELD?e.series.getSeriesField():null;switch(t){case tJ.MIN:return e.series.getMinField();case tJ.MAX:return e.series.getMaxField();case tJ.MEDIAN:return e.series.getMedianField();case tJ.Q1:return e.series.getQ1Field();case tJ.Q3:return e.series.getQ3Field();case tJ.SERIES_FIELD:return e.series.getSeriesField()}return null}},e.getContentValue=function(t){return function(i){if(e.isOutlierMark(i))return t===tJ.OUTLIER?i[rJ]:t===tJ.SERIES_FIELD?i[e.series.getSeriesField()]:null;switch(t){case tJ.MIN:return i[e.series.getMinField()];case tJ.MAX:return i[e.series.getMaxField()];case tJ.MEDIAN:return i[e.series.getMedianField()];case tJ.Q1:return i[e.series.getQ1Field()];case tJ.Q3:return i[e.series.getQ3Field()];case tJ.SERIES_FIELD:return i[e.series.getSeriesField()]}return null}},e.shapeColorCallback=function(t){return"line"===e.series.getShaftShape()?e.series.getMarkInName("boxPlot").getAttribute("stroke",t):e.series.getMarkInName("boxPlot").getAttribute("fill",t)},e.getOutlierFillColor=function(t){var i,n,r=e.series.getOutliersStyle();return null!==(i=null==r?void 0:r.fill)&&void 0!==i?i:null===(n=e.series.getMarkInName("outlier"))||void 0===n?void 0:n.getAttribute("fill",t)},e.isOutlierMark=function(t){return W(t[rJ])},e}return C(e,t),e.prototype.getDefaultContentList=function(t){return[{key:this.getContentKey(tJ.OUTLIER),value:this.getContentValue(tJ.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey(tJ.MAX),value:this.getContentValue(tJ.MAX)},{key:this.getContentKey(tJ.Q3),value:this.getContentValue(tJ.Q3)},{key:this.getContentKey(tJ.MEDIAN),value:this.getContentValue(tJ.MEDIAN)},{key:this.getContentKey(tJ.Q1),value:this.getContentValue(tJ.Q1)},{key:this.getContentKey(tJ.MIN),value:this.getContentValue(tJ.MIN)},{key:this.getContentKey(tJ.SERIES_FIELD),value:this.getContentValue(tJ.SERIES_FIELD)}]},e}(OG),lJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._setStateOfGraphic=function(t){t.clearStates(),t.stateProxy=null,t.context.diffState!==AW.enter&&t.context.diffState!==AW.update||(t.glyphStateProxy=function(i,n){var r,a,o={attributes:M(M({},e._runEncoderOfGraphic(null===(a=e._encoderOfState)||void 0===a?void 0:a[i],t)),t.runtimeStateCache?t.runtimeStateCache[i]:null)};return t.glyphStates?t.glyphStates[i]||(t.glyphStates[i]=o):t.glyphStates=((r={})[i]=o,r),o},t.useStates(t.context.states))},e}return C(e,t),e.prototype.getSubMarks=function(){return this._subMarks},e.prototype.setGlyphConfig=function(t){this._glyphConfig=t},e.prototype.getGlyphConfig=function(){return this._glyphConfig},e.prototype.getPositionChannels=function(){return this._positionChannels},e.prototype._onGlyphAttributeUpdate=function(t){var e=this;return function(i){var n,r,a=e.getPositionChannels(),o=a&&e._positionEncoder&&Object.keys(i).some((function(t){return a.includes(t)}))?e._positionEncoder(i,null===(r=null===(n=null==t?void 0:t.context)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0],t):null;return e._channelEncoder&&Object.keys(e._channelEncoder).forEach((function(t){if(t in i){var n=e._channelEncoder[t](i[t]);o=o?mt(o,n):n}})),o&&t.getSubGraphic().forEach((function(t){t&&o[t.name]&&t.setAttributes(o[t.name])})),i}},e.prototype._createGraphic=function(t){void 0===t&&(t={});var e=Jm(t);e.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(e);var i=this._subMarks;if(i){var n=[];Object.keys(i).forEach((function(t){var e=ij.createGraphicComponent(i[t].type,M({},i[t].defaultAttributes));e&&(n.push(e),e.name=t,e.onBeforeAttributeUpdate=function(t){return t})})),e.setSubGraphic(n)}return e.onBeforeAttributeUpdate(t),e},e.prototype._runProgressiveEncoder=function(t){this._runEncoder(t)},e}(NW),uJ=function(){ij.registerGraphicComponent("glyph",Jm),cP(),WB()},cJ=["x","y","minMaxWidth","minMaxHeight","q1q3Width","q1q3Height","q1","q3","min","max","median","angle"],hJ=["x","y","boxWidth","boxHeight","ruleWidth","ruleHeight","q1","q3","min","max","median","angle"],dJ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._isHorizontal=function(){return this._glyphConfig&&"horizontal"===this._glyphConfig.direction},e.prototype.setGlyphConfig=function(e){var i=this;t.prototype.setGlyphConfig.call(this,e),"bar"===e.shaftShape?(this._subMarks={minMaxBox:{type:"rect",defaultAttributes:{lineWidth:0}},q1q3Box:{type:"rect",defaultAttributes:{lineWidth:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=cJ,this._channelEncoder={minMaxFillOpacity:function(t){return{minMaxBox:{fillOpacity:t}}},lineWidth:function(t){return{minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}},stroke:function(t){return{minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}}}},this._positionEncoder=function(t,e,n){var r,a=t.x,o=void 0===a?n.attribute.x:a,s=t.y,l=void 0===s?n.attribute.y:s,u=t.minMaxWidth,c=void 0===u?n.attribute.minMaxWidth:u,h=t.minMaxHeight,d=void 0===h?n.attribute.minMaxHeight:h,p=t.q1q3Width,f=void 0===p?n.attribute.q1q3Width:p,v=t.q1q3Height,g=void 0===v?n.attribute.q1q3Height:v,y=t.q1,m=void 0===y?n.attribute.q1:y,_=t.q3,b=void 0===_?n.attribute.q3:_,x=t.min,k=void 0===x?n.attribute.min:x,S=t.max,A=void 0===S?n.attribute.max:S,C=t.median,M=void 0===C?n.attribute.median:C,w=t.angle,T=i._isHorizontal(),D={};if(T?(D.minMaxBox={x:k,x1:A,y:l-d/2,y1:l+d/2},D.q1q3Box={x:m,x1:b,y:l-g/2,y1:l+g/2},D.median={points:[{x:M,y:l-g/2},{x:M,y:l+g/2}]}):(D.minMaxBox={y:k,y1:A,x:o-c/2,x1:o+c/2},D.q1q3Box={y:m,y1:b,x:o-f/2,x1:o+f/2},D.median={points:[{y:M,x:o-f/2},{y:M,x:o+f/2}]}),it(w)){var E=null!==(r=t.anchor)&&void 0!==r?r:T?[(k+A)/2,l]:[o,(k+A)/2];Object.keys(D).forEach((function(t){D[t].angle=w,D[t].anchor=E}))}return D}):(this._subMarks={shaft:{type:"line",defaultAttributes:{x:0,y:0}},box:{type:"rect"},max:{type:"line",defaultAttributes:{x:0,y:0}},min:{type:"line",defaultAttributes:{x:0,y:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=hJ,this._channelEncoder=null,this._positionEncoder=function(t,e,n){var r,a=t.x,o=void 0===a?n.attribute.x:a,s=t.y,l=void 0===s?n.attribute.y:s,u=t.boxWidth,c=void 0===u?n.attribute.boxWidth:u,h=t.boxHeight,d=void 0===h?n.attribute.boxHeight:h,p=t.ruleWidth,f=void 0===p?n.attribute.ruleWidth:p,v=t.ruleHeight,g=void 0===v?n.attribute.ruleHeight:v,y=t.q1,m=void 0===y?n.attribute.q1:y,_=t.q3,b=void 0===_?n.attribute.q3:_,x=t.min,k=void 0===x?n.attribute.min:x,S=t.max,A=void 0===S?n.attribute.max:S,C=t.median,M=void 0===C?n.attribute.median:C,w=t.angle,T=i._isHorizontal(),D={};if(T?(D.box={x:m,x1:b,y:l-d/2,y1:l+d/2},D.median={points:[{x:M,y:l-d/2},{x:M,y:l+d/2}]},D.shaft={points:[{x:k,y:l},{x:A,y:l}]},D.max={points:[{x:A,y:l-g/2},{x:A,y:l+g/2}]},D.min={points:[{x:k,y:l-g/2},{x:k,y:l+g/2}]}):(D.box={x:o-c/2,x1:o+c/2,y:m,y1:b},D.median={points:[{x:o-c/2,y:M},{x:o+c/2,y:M}]},D.max={points:[{x:o-f/2,y:A},{x:o+f/2,y:A}]},D.min={points:[{x:o-f/2,y:k},{x:o+f/2,y:k}]},D.shaft={points:[{x:o,y:k},{x:o,y:A}]}),it(w)){var E=null!==(r=t.anchor)&&void 0!==r?r:T?[(k+A)/2,l]:[o,(k+A)/2];Object.keys(D).forEach((function(t){D[t].angle=w,D[t].anchor=E}))}return D})},e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})},e.type="boxPlot",e}(lJ),pJ=M(M({},qG),((aJ={}).boxPlot={name:"boxPlot",type:"boxPlot"},aJ.outlier={name:"outlier",type:"symbol"},aJ)),fJ=function(t){return function(e,i,n){var r,a=e.getFinalAttribute(),o=null!==(r=a.direction)&&void 0!==r?r:"vertical",s=t(e,o,i);if(!it(s))return{};var l=a.x,u=a.y,c=a.min,h=a.max,d=a.q1,p=a.q3,f=a.median,v={from:{x:l,y:u},to:{x:l,y:u}};return it(c)&&(v.from.min=s,v.to.min=c),it(h)&&(v.from.max=s,v.to.max=h),it(d)&&(v.from.q1=s,v.to.q1=d),it(p)&&(v.from.q3=s,v.to.q3=p),it(f)&&(v.from.median=s,v.to.median=f),v}},vJ=function(t){return function(e,i,n){var r,a=e.getFinalAttribute(),o=null!==(r=a.direction)&&void 0!==r?r:"vertical",s=t(e,o,i);if(!it(s))return{};var l=a.x,u=a.y,c=a.min,h=a.max,d=a.q1,p=a.q3,f=a.median,v={from:{x:l,y:u},to:{x:l,y:u}};return it(c)&&(v.to.min=s,v.from.min=c),it(h)&&(v.to.max=s,v.from.max=h),it(d)&&(v.to.q1=s,v.from.q1=d),it(p)&&(v.to.q3=s,v.from.q3=p),it(f)&&(v.to.median=s,v.from.median=f),v}},gJ=function(t,e){return t.getSubGraphic().find((function(t){return t.name===e}))},yJ=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,C,M,w,T,D;if(i&&it(i.center))return i.center;if("horizontal"===e){C=null===(a=null===(r=(null===(n=gJ(t,"median"))||void 0===n?void 0:n.attribute).points)||void 0===r?void 0:r[0])||void 0===a?void 0:a.x,M=null===(u=null===(l=null===(s=null===(o=gJ(t,"max"))||void 0===o?void 0:o.attribute)||void 0===s?void 0:s.points)||void 0===l?void 0:l[0])||void 0===u?void 0:u.x,w=null===(p=null===(d=null===(h=null===(c=gJ(t,"min"))||void 0===c?void 0:c.attribute)||void 0===h?void 0:h.points)||void 0===d?void 0:d[0])||void 0===p?void 0:p.x;var E=gJ(t,"box").attribute.width,B=gJ(t,"box").attribute.x;T=B,D=B+E}else{C=null===(g=null===(v=(null===(f=gJ(t,"median"))||void 0===f?void 0:f.attribute).points)||void 0===v?void 0:v[0])||void 0===g?void 0:g.y,M=null===(b=null===(_=null===(m=null===(y=gJ(t,"max"))||void 0===y?void 0:y.attribute)||void 0===m?void 0:m.points)||void 0===_?void 0:_[0])||void 0===b?void 0:b.y,w=null===(A=null===(S=null===(k=null===(x=gJ(t,"min"))||void 0===x?void 0:x.attribute)||void 0===k?void 0:k.points)||void 0===S?void 0:S[0])||void 0===A?void 0:A.y;var P=gJ(t,"box").attribute.height,R=gJ(t,"box").attribute.y;T=R,D=R+P}return it(C)?C:it(T)&&it(D)?(T+D)/2:it(M)&&it(w)?(M+w)/2:it(w)?w:it(M)?M:NaN},mJ=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x;if(it(null==i?void 0:i.center))return i.center;if("horizontal"===e){y=null===(a=null===(r=(null===(n=gJ(t,"median"))||void 0===n?void 0:n.attribute).points)||void 0===r?void 0:r[0])||void 0===a?void 0:a.x;var k=(null===(o=gJ(t,"minMaxBox"))||void 0===o?void 0:o.attribute).width,S=null===(s=gJ(t,"minMaxBox"))||void 0===s?void 0:s.attribute.x;_=S,m=S+k;var A=(null===(l=gJ(t,"q1q3Box"))||void 0===l?void 0:l.attribute).width,C=null===(u=gJ(t,"q1q3Box"))||void 0===u?void 0:u.attribute.x;b=C,x=C+A}else{y=null===(d=null===(h=(null===(c=gJ(t,"median"))||void 0===c?void 0:c.attribute).points)||void 0===h?void 0:h[0])||void 0===d?void 0:d.y;var M=(null===(p=gJ(t,"minMaxBox"))||void 0===p?void 0:p.attribute).height,w=null===(f=gJ(t,"minMaxBox"))||void 0===f?void 0:f.attribute.y;_=w,m=w+M;var T=(null===(v=gJ(t,"q1q3Box"))||void 0===v?void 0:v.attribute).height,D=null===(g=gJ(t,"q1q3Box"))||void 0===g?void 0:g.attribute.y;b=D,x=D+T}return it(y)?y:it(b)&&it(x)?(b+x)/2:it(m)&&it(_)?(m+_)/2:it(_)?_:it(m)?m:NaN},_J=function(t){function e(e,i,n,r,a){return t.call(this,e,i,n,r,a)||this}return C(e,t),e.prototype.onBind=function(){t.prototype.onBind.call(this);var e=this.target.getFinalAttribute();e&&this.target.setAttributes(e);var i=this.computeAttribute(),n=i.from,r=i.to;this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.animate.reSyncProps(),this.from=n,this.to=r,this.target.setAttributes(this.from)},e.prototype.computeAttribute=function(){return fJ(yJ)(this.target,this.params,this.params.options)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(NL),bJ=function(t){function e(e,i,n,r,a){return t.call(this,e,i,n,r,a)||this}return C(e,t),e.prototype.onBind=function(){var t;(null===(t=this.params)||void 0===t?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var e=this.computeAttribute(),i=e.from,n=e.to;this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.animate.reSyncProps(),this.from=i,this.to=n,this.target.setAttributes(this.from)},e.prototype.computeAttribute=function(){return vJ(yJ)(this.target,this.params,this.params.options)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(NL),xJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.computeAttribute=function(){return fJ(mJ)(this.target,this.params,this.params.options)},e}(_J),kJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.computeAttribute=function(){return vJ(mJ)(this.target,this.params,this.params.options)},e}(bJ),SJ={boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}},AJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.boxPlot,i._bandPosition=0,i}return C(i,e),i.prototype.getMinField=function(){return this._minField},i.prototype.getMaxField=function(){return this._maxField},i.prototype.getQ1Field=function(){return this._q1Field},i.prototype.getMedianField=function(){return this._medianField},i.prototype.getQ3Field=function(){return this._q3Field},i.prototype.getOutliersField=function(){return this._outliersField},i.prototype.getShaftShape=function(){return this._shaftShape},i.prototype.getBoxFillColor=function(){return this._boxFillColor},i.prototype.getStrokeColor=function(){return this._strokeColor},i.prototype.getOutliersStyle=function(){return this._outliersStyle},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o,s;e.prototype.setAttrFromSpec.call(this);var l=null!==(i=null===(t=this._spec.boxPlot)||void 0===t?void 0:t.style)&&void 0!==i?i:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!==(n=l.lineWidth)&&void 0!==n?n:2,this._boxWidth=l.boxWidth,this._shaftShape=null!==(r=l.shaftShape)&&void 0!==r?r:"line",this._shaftWidth=l.shaftWidth,this._boxFillColor=l.boxFill,this._strokeColor=l.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!==(a=l.shaftFillOpacity)&&void 0!==a?a:.5:void 0,this._outliersStyle=null!==(o=this._spec.outliersStyle)&&void 0!==o?o:null===(s=this._spec.outlier)||void 0===s?void 0:s.style},i.prototype.initMark=function(){this._boxPlotMark=this._createMark(i.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0}),this._outliersField&&(this._outlierMark=this._createMark(i.mark.outlier,{key:Ej,groupKey:this._seriesField,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()}))},i.prototype.initMarkStyle=function(){var e,i,n,r,a,o=this,s=this._boxPlotMark;if(s){var l={lineWidth:this._lineWidth,fill:null!==(e=this._boxFillColor)&&void 0!==e?e:"line"!==this._shaftShape?this.getColorAttribute():"#FFF",minMaxFillOpacity:this._shaftFillOpacity,stroke:null!==(i=this._strokeColor)&&void 0!==i?i:"line"!==this._shaftShape?"#000":this.getColorAttribute()};s.setGlyphConfig({direction:this._direction,shaftShape:this._shaftShape});var u="horizontal"===this._direction?{y:function(t){return o._getPosition(o.direction,t)},boxHeight:function(){var t;return WU(null!==(t=o._boxWidth)&&void 0!==t?t:"100%",o._getMarkWidth())},ruleHeight:function(){var t;return WU(null!==(t=o._shaftWidth)&&void 0!==t?t:"100%",o._getMarkWidth())},q1q3Height:function(){var t;return WU(null!==(t=o._boxWidth)&&void 0!==t?t:"100%",o._getMarkWidth())},minMaxHeight:function(){var t;return WU(null!==(t=o._shaftWidth)&&void 0!==t?t:"100%",o._getMarkWidth())}}:{x:function(t){return o._getPosition(o.direction,t)},boxWidth:function(){var t;return WU(null!==(t=o._boxWidth)&&void 0!==t?t:"100%",o._getMarkWidth())},ruleWidth:function(){var t;return WU(null!==(t=o._shaftWidth)&&void 0!==t?t:"100%",o._getMarkWidth())},q1q3Width:function(){var t;return WU(null!==(t=o._boxWidth)&&void 0!==t?t:"100%",o._getMarkWidth())},minMaxWidth:function(){var t;return WU(null!==(t=o._shaftWidth)&&void 0!==t?t:"100%",o._getMarkWidth())}};this.setMarkStyle(s,l,t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this.setMarkStyle(s,u,t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Built_In)}var c=this._outlierMark;c&&this.setMarkStyle(c,{fill:null!==(r=null===(n=this._outliersStyle)||void 0===n?void 0:n.fill)&&void 0!==r?r:this.getColorAttribute(),size:$(null===(a=this._outliersStyle)||void 0===a?void 0:a.size)?this._outliersStyle.size:10},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initBoxPlotMarkStyle=function(){var e,i,n=this,r=this._boxPlotMark,a="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(r&&a){var o=a.dataToPosition,s=null===(e=null==a?void 0:a.getScale)||void 0===e?void 0:e.call(a,0);this.setMarkStyle(r,{min:function(t){return RU(o(n.getDatumPositionValues(t,n._minField),{bandPosition:n._bandPosition}),s)},q1:function(t){return RU(o(n.getDatumPositionValues(t,n._q1Field),{bandPosition:n._bandPosition}),s)},median:function(t){return RU(o(n.getDatumPositionValues(t,n._medianField),{bandPosition:n._bandPosition}),s)},q3:function(t){return RU(o(n.getDatumPositionValues(t,n._q3Field),{bandPosition:n._bandPosition}),s)},max:function(t){return RU(o(n.getDatumPositionValues(t,n._maxField),{bandPosition:n._bandPosition}),s)}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}var l=this._outlierMark;if(l&&a){var u=a.dataToPosition,c=null===(i=null==a?void 0:a.getScale)||void 0===i?void 0:i.call(a,0),h="horizontal"===this._direction?{y:function(t){return n._getPosition(n.direction,t)},x:function(t){return RU(u(n.getDatumPositionValues(t,rJ),{bandPosition:n._bandPosition}),c)}}:{x:function(t){return n._getPosition(n.direction,t)},y:function(t){return RU(u(n.getDatumPositionValues(t,rJ),{bandPosition:n._bandPosition}),c)}};this.setMarkStyle(l,h,t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){EV(this._dataSet,"foldOutlierData",oJ),EV(this._dataSet,"addVChartProperty",DG);var t=new cc(this._dataSet,{name:"".concat(this.type,"_outlier_").concat(this.id,"_data")});t.parse([this.getViewData()],{type:"dataview"}),t.name="".concat(Mj,"_series_").concat(this.id,"_outlierData"),t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:GG.bind(this),call:YG}},!1),this._outlierDataView=new IW(this._option,t)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._outlierDataView)||void 0===t||t.compile()},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initBoxPlotMarkStyle()},i.prototype._getMarkWidth=function(){var t;if(this._autoBoxWidth)return this._autoBoxWidth;var e="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,i=this._groups?this._groups.fields.length:1,n=null===(t=e.getBandwidth)||void 0===t?void 0:t.call(e,i-1),r=n;return W(this._spec.boxWidth)&&(r=WU(this._spec.boxWidth,n)),W(this._spec.boxMinWidth)&&(r=Math.max(r,WU(this._spec.boxMinWidth,n))),W(this._spec.boxMaxWidth)&&(r=Math.min(r,WU(this._spec.boxMaxWidth,n))),this._autoBoxWidth=r,this._autoBoxWidth},i.prototype._getPosition=function(t,e){var i,n,r,a,o,s,l;"horizontal"===t?(o=this.getYAxisHelper(),s="boxHeight",l=this.dataToPositionY.bind(this)):(o=this.getXAxisHelper(),s="boxWidth",l=this.dataToPositionX.bind(this));var u=o.getScale(0),c=this._groups?this._groups.fields.length:1,h=null===(i=o.getBandwidth)||void 0===i?void 0:i.call(o,c-1),d=this._boxPlotMark.getAttribute(s,e);if(c>1&&W(this._spec.boxGapInGroup)){for(var p=this._groups.fields,f=Dt(this._spec.boxGapInGroup),v=0,g=0,y=p.length-1;y>=1;y--){var m=p[y],_=null!==(r=null===(n=o.getScale(y))||void 0===n?void 0:n.domain())&&void 0!==r?r:[],b=_.length,x=WU(null!==(a=f[y-1])&&void 0!==a?a:Et(f),h),k=_.indexOf(e[m]);y===p.length-1?(v+=b*d+(b-1)*x,g+=k*(d+x)):(g+=k*(v+x),v+=v+(b-1)*x)}return u.scale(e[p[0]])+o.getBandwidth(0)/2-v/2+g+d/2}var S=tO(u.type||"band");return l(e)+.5*h+(S?-h/2:0)},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._autoBoxWidth=null},i.prototype._initAnimationSpec=function(t){var e=this;void 0===t&&(t={});var i=mt({},t);return["appear","enter","update","exit","disappear"].forEach((function(t){i[t]&&"scaleIn"===i[t].type?i[t].type="bar"===e._shaftShape?"barBoxplotScaleIn":"boxplotScaleIn":i[t]&&"scaleOut"===i[t].type&&(i[t].type="bar"===e._shaftShape?"barBoxplotScaleOut":"boxplotScaleOut")})),i},i.prototype.initAnimation=function(){var t,e,i,n,r,a,o,s=vY(this);if(this._boxPlotMark){var l=this._initAnimationSpec(null===(t=ij.getAnimationInKey("scaleInOut"))||void 0===t?void 0:t()),u=this._initAnimationSpec(rY("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(nY(l,u,s))}if(this._outlierMark){var c={appear:null===(e=this._spec.animationAppear)||void 0===e?void 0:e.symbol,disappear:null===(i=this._spec.animationDisappear)||void 0===i?void 0:i.symbol,enter:null===(n=this._spec.animationEnter)||void 0===n?void 0:n.symbol,exit:null===(r=this._spec.animationExit)||void 0===r?void 0:r.symbol,update:null===(a=this._spec.animationUpdate)||void 0===a?void 0:a.symbol};this._outlierMark.setAnimationConfig(nY(null===(o=ij.getAnimationInKey("scaleInOut"))||void 0===o?void 0:o(),c,s))}},i.prototype.initTooltip=function(){this._tooltipHelper=new sJ(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)},i.prototype.getStatisticFields=function(){var t=this,i=e.prototype.getStatisticFields.call(this),n=i.find((function(e){return e.key===t._outliersField}));return n&&(n.operations=["array-min","array-max"]),i},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._outlierDataView.updateData()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._boxPlotMark]},i.type=t.SeriesTypeEnum.boxPlot,i.builtInTheme={boxPlot:SJ},i.mark=pJ,i}(gY),CJ=function(){uJ(),ZB(),rP(),ij.registerGraphicComponent("line",(function(t){return jm(t)})),ij.registerGraphicComponent("rect",(function(t){return Ym(t)})),ij.registerMark(dJ.type,dJ),jY(),tG(),QX(),KX(),DL.registerBuiltInAnimate("boxplotScaleIn",_J),DL.registerBuiltInAnimate("boxplotScaleOut",bJ),DL.registerBuiltInAnimate("barBoxplotScaleIn",xJ),DL.registerBuiltInAnimate("barBoxplotScaleOut",kJ),ij.registerSeries(AJ.type,AJ)},MJ=function(t){function e(i,n){var r=t.call(this,i,n)||this;return r.type=e.type,r._textType="text",r}return C(e,t),e.prototype.getTextType=function(){return this._textType},e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})},e.prototype.initStyleWithSpec=function(e){t.prototype.initStyleWithSpec.call(this,e),e.textType&&(this._textType=e.textType)},e.prototype._transformGraphicAttributes=function(e,i,n){var r=t.prototype._transformGraphicAttributes.call(this,e,i,n),a=r.text;return G(a)&&W(a.text)&&("rich"===this._textType||"rich"===a.type)&&(r.textConfig=a.text),r},e.prototype._createGraphic=function(t){void 0===t&&(t={});var e=t.text;return"rich"===this._textType||"rich"===(null==e?void 0:e.type)?c_(t):Fm(t)},e.type="text",e}(NW),wJ=function(){ij.registerMark(MJ.type,MJ),cP(),fP(),lP(),ij.registerGraphicComponent("text",Fm),ij.registerGraphicComponent("richtext",c_)};var TJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getMeasureData=function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},e}return C(e,t),e}(OG),DJ=function(t){return{type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}},EJ={type:"fadeIn"},BJ=function(t){return{type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}};function PJ(t,e){return"fadeIn"===e?EJ:DJ(t)}var RJ,LJ,IJ,FJ=M(M({},Iq),((RJ={}).minLabel={name:"minLabel",type:"text"},RJ.maxLabel={name:"maxLabel",type:"text"},RJ)),OJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return C(e,t),e.prototype._transformLabelSpec=function(t){var e;"bothEnd"!==(null===(e=t.label)||void 0===e?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")},e}(zq),zJ={label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}},HJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeColumn,i._barMarkType="rect",i._barName=t.SeriesTypeEnum.bar,i.transformerConstructor=OJ,i}return C(i,e),i.prototype.initMark=function(){var t,e,n,r,a,o,s,l;this._initBarBackgroundMark();var u=null===(t=this._spec.label)||void 0===t?void 0:t.position;this._barMark=this._createMark(i.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0},{morph:sY(this._spec,i.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),!1!==(null===(e=this._spec.label)||void 0===e?void 0:e.visible)&&"bothEnd"===u&&(!1!==(null===(r=null===(n=this._spec.label)||void 0===n?void 0:n.minLabel)||void 0===r?void 0:r.visible)&&(this._minLabelMark=this._createMark(i.mark.minLabel,{markSpec:null===(a=this._spec.label)||void 0===a?void 0:a.minLabel})),!1!==(null===(s=null===(o=this._spec.label)||void 0===o?void 0:o.maxLabel)||void 0===s?void 0:s.visible)&&(this._maxLabelMark=this._createMark(i.mark.maxLabel,{markSpec:null===(l=this._spec.label)||void 0===l?void 0:l.maxLabel})))},i.prototype.initMarkStyle=function(){var t,i;e.prototype.initMarkStyle.call(this),this._initLabelMarkPos(this._minLabelMark,null===(t=this._spec.label)||void 0===t?void 0:t.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,null===(i=this._spec.label)||void 0===i?void 0:i.maxLabel,1,"start")},i.prototype._initLabelMarkPos=function(e,i,n,r){var a,o,s,l,u=this;e&&(this.setMarkStyle(e,{fill:null!==(o=null===(a=null==i?void 0:i.style)||void 0===a?void 0:a.fill)&&void 0!==o?o:this.getColorAttribute(),text:function(t){var e="horizontal"===u._spec.direction?t[u._spec.xField[n]]:t[u._spec.yField[n]];return(null==i?void 0:i.formatMethod)?i.formatMethod(e,t):e}}),function(e,i,n,r,a,o,s,l,u){e.setMarkStyle(i,{textAlign:function(t){if("vertical"===u())return"center";var e=a(t),i=o(t);if("middle"===n)return"center";if(e>=i){if("start"===n)return"left";if("end"===n)return"right";if("outside"===n)return"left"}else{if("start"===n)return"right";if("end"===n)return"left";if("outside"===n)return"right"}return"center"},textBaseline:function(t){if("horizontal"===u())return"middle";var e=s(t),i=l(t);if("middle"===n)return"middle";if(i>=e){if("start"===n)return"bottom";if("end"===n)return"top";if("outside"===n)return"bottom"}else{if("start"===n)return"top";if("end"===n)return"bottom";if("outside"===n)return"top"}return"middle"}}),e.setMarkStyle(i,{x:function(t){var e=u(),i=a(t),s=o(t);if("vertical"===e)return(i+s)/2;if("middle"===n)return(i+s)/2;if(i>=s){if("start"===n)return s+r;if("end"===n)return i-r;if("outside"===n)return i+r}else{if("start"===n)return s-r;if("end"===n)return i+r;if("outside"===n)return i-r}return(i+s)/2},y:function(t){var e=u(),i=s(t),a=l(t);if("horizontal"===e)return(i+a)/2;if("middle"===n)return(i+a)/2;if(i>=a){if("start"===n)return a+r;if("end"===n)return i-r;if("outside"===n)return i+r}else{if("start"===n)return a-r;if("end"===n)return i+r;if("outside"===n)return i-r}return(i+a)/2}},"normal",t.AttributeLevel.Series)}(this,e,null!==(s=null==i?void 0:i.position)&&void 0!==s?s:r,null!==(l=null==i?void 0:i.offset)&&void 0!==l?l:"vertical"===this._direction?-20:-25,(function(t){return u._barMark.getAttribute("x",t)}),(function(t){return"vertical"===u._direction?u._barMark.getAttribute("x",t)+u._barMark.getAttribute("width",t):u._barMark.getAttribute("x1",t)}),(function(t){return u._barMark.getAttribute("y",t)}),(function(t){return"vertical"===u._direction?u._barMark.getAttribute("y1",t):u._barMark.getAttribute("y",t)+u._barMark.getAttribute("height",t)}),(function(){return u._direction})))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this.setMarkStyle(t,{text:function(t){var i,n;return"horizontal"===e._spec.direction?(i=t[e._spec.xField[0]],n=t[e._spec.xField[1]]):(i=t[e._spec.yField[0]],n=t[e._spec.yField[1]]),i+"-"+n},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)},i.prototype._dataToPosX=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosX1=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY1=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})},i.prototype.initAnimation=function(){var t,e,i,n,r,a=vY(this),o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._barMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("rangeColumn"))||void 0===i?void 0:i({direction:this.direction},o),rY("bar",this._spec,this._markAttributeContext),a)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),rY("label",this._spec,this._markAttributeContext),a)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(nY(null===(r=ij.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),rY("label",this._spec,this._markAttributeContext),a))},i.prototype.initTooltip=function(){this._tooltipHelper=new TJ(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)},i.type=t.SeriesTypeEnum.rangeColumn,i.mark=FJ,i.builtInTheme={rangeColumn:zJ},i.transformerConstructor=OJ,i}(Nq),NJ=function(){Lq(),wJ(),ij.registerAnimation("rangeColumn",(function(t,e){return{appear:PJ(t,e),enter:DJ(t),exit:BJ(t),disappear:BJ(t)}})),eG(),QX(),KX(),ij.registerSeries(HJ.type,HJ)};t.PositionEnum=void 0,(LJ=t.PositionEnum||(t.PositionEnum={})).middle="middle",LJ.start="start",LJ.end="end",LJ.bothEnd="bothEnd",function(t){t.middle="middle",t.start="start",t.end="end"}(IJ||(IJ={}));var UJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getMeasureData=function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},e}return C(e,t),e}(OG),jJ=M({},gq),VJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeArea,i}return C(i,e),i.prototype.initMark=function(){this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0]})},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle()},i.prototype.initAreaMarkStyle=function(){var i=this,n=this._areaMark;n&&(e.prototype.initAreaMarkStyle.call(this),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:function(t){return i._xAxisHelper?(0,i._xAxisHelper.dataToPosition)(i.getDatumPositionValues(t,i._spec.xField[1]),{bandPosition:i._bandPosition}):Number.NaN}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._areaMark,{y1:function(t){return i._yAxisHelper?(0,i._yAxisHelper.dataToPosition)(i.getDatumPositionValues(t,i._spec.yField[1]),{bandPosition:i._bandPosition}):Number.NaN}},"normal",t.AttributeLevel.Series),this.setMarkStyle(n,{stroke:!1},"normal",t.AttributeLevel.Series))},i.prototype.initTooltip=function(){this._tooltipHelper=new UJ(this)},i.prototype._isFieldAllValid=function(){var t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every((function(e){return t.latestData[e]&&t.latestData[e].allValid}))},i.type=t.SeriesTypeEnum.rangeArea,i.mark=jJ,i}(bq),WJ=function(){fq(),QX(),KX(),ij.registerSeries(VJ.type,VJ)},GJ=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.coordinate="polar",t._outerRadius=yX,t._innerRadius=0,t._angleField=[],t._radiusField=[],t._sortDataByAxis=!1,t}return C(i,e),Object.defineProperty(i.prototype,"outerRadius",{get:function(){return this._outerRadius},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"innerRadius",{get:function(){return this._innerRadius},enumerable:!1,configurable:!0}),i.prototype.getAngleField=function(){return this._angleField},i.prototype.setAngleField=function(t){return this._angleField=W(t)?Dt(t):[],this._angleField},i.prototype.getRadiusField=function(){return this._radiusField},i.prototype.setRadiusField=function(t){return this._radiusField=W(t)?Dt(t):[],this._radiusField},Object.defineProperty(i.prototype,"innerRadiusField",{get:function(){return this._innerRadiusField},enumerable:!1,configurable:!0}),i.prototype.setInnerRadiusField=function(t){return this._innerRadiusField=Dt(t),this._innerRadiusField},Object.defineProperty(i.prototype,"radiusScale",{get:function(){return this._radiusScale},enumerable:!1,configurable:!0}),i.prototype.setRadiusScale=function(t){return this._radiusScale=t,t},Object.defineProperty(i.prototype,"angleScale",{get:function(){return this._angleScale},enumerable:!1,configurable:!0}),i.prototype.setAngleScale=function(t){return this._angleScale=t,t},Object.defineProperty(i.prototype,"angleAxisHelper",{get:function(){return this._angleAxisHelper},set:function(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"radiusAxisHelper",{get:function(){return this._radiusAxisHelper},set:function(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=function(){return t.angleAxisHelper.center()},this._markAttributeContext.getLayoutRadius=function(){return t._computeLayoutRadius()}},i.prototype.valueToPosition=function(t,e){if(j(t)||j(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};var i=this.radiusAxisHelper.dataToPosition(Dt(e));if(i<0){if("break"===this._invalidType||"link"===this._invalidType)return{x:Number.NaN,y:Number.NaN};if("zero"===this._invalidType)return this.angleAxisHelper.center()}var n=this.angleAxisHelper.dataToPosition(Dt(t));return this.angleAxisHelper.coordToPoint({angle:n,radius:i})},i.prototype.dataToPosition=function(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null},i.prototype.dataToPositionX=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},i.prototype.dataToPositionY=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y},i.prototype.dataToPositionZ=function(t){return 0},i.prototype.positionToData=function(t){},i.prototype.radiusToData=function(t){},i.prototype.angleToData=function(t){},i.prototype.getStatisticFields=function(){var t,e,i=this,n=[];return(null===(t=this.radiusAxisHelper)||void 0===t?void 0:t.getScale)&&this._radiusField.forEach((function(t){var e={key:t,operations:[]};tO(i.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),(null===(e=this.angleAxisHelper)||void 0===e?void 0:e.getScale)&&this._angleField.forEach((function(t){var e={key:t,operations:[]};tO(i.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),n},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),W(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),W(this._spec.radius)&&(this._outerRadius=this._spec.radius),W(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),W(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},i.prototype.onRadiusAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.onAngleAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype._computeLayoutRadius=function(){var t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();var e=this._region.getLayoutRect(),i=e.width,n=e.height;return Math.min(i/2,n/2)},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.sortDataByAxis&&this.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e;return t.model.id===(null===(e=i._angleAxisHelper)||void 0===e?void 0:e.getAxisId())}},(function(){i._sortDataInAxisDomain()}))},i.prototype._sortDataInAxisDomain=function(){var t,e;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&fY(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)},i.prototype.getInvalidCheckFields=function(){var t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach((function(e){t.push(e)})),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach((function(e){t.push(e)})),t},i}(dY);function YJ(t){return ZA(t)?Number.parseFloat(t):0}var XJ=function(t,e){var i=e.asStartAngle,n=e.asEndAngle,r=e.asMiddleAngle,a=e.asRadian,o=e.asRatio,s=e.asQuadrant,l=e.asK,u=e.showAllZero,c=e.supportNegative,h=e.showEmptyCircle,d=e.angleField(),p=e.startAngle(),f=e.endAngle(),v=e.minAngle(),g=t.map((function(t){return M({},t)}));if(!g||0===g.length)return g;if(!u&&h&&KJ(g,d,c))return[];for(var y=function(t,e,o){t[i]=e,t[n]=e+o,t[r]=e+o/2,t[a]=o,t[s]=zi(e+o/2)},m=0,_=-1/0,b=!0,x=0;x<g.length;x++){var k=c?Math.abs(YJ(g[x][d])):YJ(g[x][d]);m+=k,_=Math.max(k,_),b&&0!==k&&(b=!1),g[x][sX]=k}var S=g.map((function(t){return Number(t[d])})),A=f-p,C=p,w=A,T=0,D=function(t,e){void 0===e&&(e=2);var i=t.reduce((function(t,e){return t+(isNaN(e)?0:e)}),0);if(0===i)return 0;for(var n=Math.pow(10,e),r=t.map((function(t){return(isNaN(t)?0:t)/i*n*100})),a=100*n,o=r.map((function(t){return Math.floor(t)})),s=o.reduce((function(t,e){return t+e}),0),l=r.map((function(t,e){return t-o[e]}));s<a;){for(var u=Number.NEGATIVE_INFINITY,c=null,h=0;h<l.length;h++)l[h]>u&&(u=l[h],c=h);++o[c],l[c]=0,++s}return o.map((function(t){return t/n}))}(S);if(g.forEach((function(t,e){var i=t[sX],n=m?i/m:0,r=n*A;r<v?(r=v,w-=v):T+=i;var a=C,s=C+r;t[o]=n,t[l]=_?i/_:0,t._percent_=D[e],y(t,a,r),C=s})),w<A)if(w<=.001){var E=A/g.length;g.forEach((function(t,e){y(t,p+e*E,E)}))}else{var B=w/T;C=p,g.forEach((function(t){var e=t[a]===v?v:t[sX]*B;y(t,C,e),C+=e}))}if(0!==m&&(g[g.length-1][n]=f),b&&u){var P=A/g.length;g.forEach((function(t,e){y(t,p+e*P,P)}))}return g},KJ=function(t,e,i){return!!j(t)||(0===t.length||(!!t.every((function(t){return 0===YJ(t[e])}))||!i&&0===t.reduce((function(t,i){return t+YJ(i[e])}),0)))};function qJ(t,e,i){return function(n,r,a){return e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(n,r,i)}:{overall:!1}}}var ZJ=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:qJ(t,!0,HV.appear)}},JJ={type:"fadeIn"},QJ=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:qJ(t,!0,HV.enter)}},$J=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:qJ(t,!0,HV.exit)}},tQ=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:qJ(t,!0,HV.exit)}};function eQ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return JJ;case"growRadius":return ZJ(M(M({},t),{growField:"radius"}));default:return ZJ(M(M({},t),{growField:"angle"}))}}var iQ,nQ=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=rQ.type,n._unCompileChannel={centerOffset:!0,radiusOffset:!0},n.computeOuterRadius=function(t,e,i,r){var a;return void 0===i&&(i="normal"),r+(null!==(a=n.getAttribute("radiusOffset",e,i))&&void 0!==a?a:0)},n.computeCenter=function(t,e,i,r){return void 0===i&&(i="normal"),Pi({x:0,y:0},n.getAttribute("centerOffset",e,i),e[dX])[t]+r},n._computeExChannel.x=n.computeCenter,n._computeExChannel.y=n.computeCenter,n._computeExChannel.outerRadius=n.computeOuterRadius,n._extensionChannel.centerOffset=["x","y"],n._extensionChannel.radiusOffset=["outerRadius"],n}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})},e}(NW),rQ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.type="arc",e}(nQ),aQ=function(){cP(),FB(),zz("arc",Zz),aG(),ij.registerGraphicComponent("arc",__),ij.registerMark(rQ.type,rQ)},oQ=M(M({},qG),((iQ={}).pie={name:"pie",type:"arc"},iQ.labelLine={name:"labelLine",type:"path"},iQ)),sQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"pie")},e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=this._getDefaultSpecFromChart(e);r=ej({},this._theme,a,t);var o=function(t,e){return ej({},"inside"===t||"inside-center"===t?i._theme.innerLabel:i._theme.outerLabel,e)};Z(r.label)?r.label=r.label.map((function(t){return o(t.position,t)})):r.label=o(r.label.position,r.label)}return{spec:r,theme:n}},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.centerX,a=e.centerY;return W(r)&&(n.centerX=r),W(a)&&(n.centerY=a),Object.keys(n).length>0?n:void 0},e}(hY),lQ="".concat(Mj,"_LABEL_VISIBLE"),uQ={outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}},cQ=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=sQ,t._pieMarkName="pie",t._pieMarkType="arc",t.getCenter=function(){var e,i,n=t._region.getLayoutRect();return{x:HU(null===(e=t._spec)||void 0===e?void 0:e.centerX,n.width,n,n.width/2),y:HU(null===(i=t._spec)||void 0===i?void 0:i.centerY,n.height,n,n.height/2)}},t._startAngle=vX,t._endAngle=gX,t._pieMark=null,t._labelMark=null,t._labelLineMark=null,t._emptyArcMark=null,t.dataToCentralPosition=function(e){var i=e[dX];if(j(i))return null;var n=t.computeDatumRadius(e),r=t.computeDatumInnerRadius(e);return Pi(t.computeCenter(e),(n+r)/2,i)},t}return C(i,e),i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return t.getCenter().x},y:function(){return t.getCenter().y}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o;e.prototype.setAttrFromSpec.call(this),this._centerOffset=null!==(t=this._spec.centerOffset)&&void 0!==t?t:0,this._cornerRadius=null!==(i=this._spec.cornerRadius)&&void 0!==i?i:0;var s=function(t,e){var i=0,n=2*Math.PI,r=W(t),a=W(e);for(r||a?a?r?(i=t,n=e):(i=e-2*Math.PI,n=e):(i=t,n=t+2*Math.PI):(i=0,n=2*Math.PI);n<=i;)n+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,n-=2*Math.PI;for(;n<0;)i+=2*Math.PI,n+=2*Math.PI;return{startAngle:i,endAngle:n}}(W(this._spec.startAngle)?Ci(this._spec.startAngle):this._startAngle,W(this._spec.endAngle)?Ci(this._spec.endAngle):this._endAngle);this._startAngle=s.startAngle,this._endAngle=s.endAngle,this._padAngle=W(this._spec.padAngle)?Ci(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=null!==(r=null===(n=this._spec.emptyPlaceholder)||void 0===n?void 0:n.showEmptyCircle)&&void 0!==r&&r,this._showAllZero=null!==(a=this._spec.showAllZero)&&void 0!==a&&a,this._supportNegative=null!==(o=this._spec.supportNegative)&&void 0!==o&&o},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getViewData();if(i){EV(this._dataSet,"pie",XJ),i.transform({type:"pie",options:{angleField:function(){return t._angleField[0]},startAngle:function(){return t._startAngle},endAngle:function(){return t._endAngle},minAngle:function(){return W(t._spec.minAngle)?Ci(t._spec.minAngle):0},asStartAngle:uX,asEndAngle:cX,asRatio:lX,asMiddleAngle:dX,asRadian:fX,asQuadrant:pX,asK:hX,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);var n=new cc(this._dataSet,{name:"".concat(Mj,"_series_").concat(this.id,"_viewDataLabel")});n.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new IW(this._option,n)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._viewDataLabel)||void 0===t||t.compile()},i.prototype.initMark=function(){this._pieMark=this._createMark(M(M({},i.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:Bj,groupKey:this._seriesField,isSeriesMark:!0},{morph:sY(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}),this._data.addRelatedMark(this._emptyArcMark))},i.prototype.startAngleScale=function(t){return gU(uX)(t)},i.prototype.endAngleScale=function(t){return gU(cX)(t)},i.prototype._computeLayoutRadius=function(){var t=this;return mX((function(){return t._spec.layoutRadius}),this.getLayoutRect,this.getCenter,(function(){return{startAngle:t._startAngle,endAngle:t._endAngle}}))},i.prototype.initMarkStyle=function(){var e=this,i={x:function(){return e.getCenter().x},y:function(){return e.getCenter().y},fill:this.getColorAttribute(),outerRadius:IU(this._outerRadius)?this._outerRadius:function(){return e._computeLayoutRadius()*e._outerRadius},innerRadius:IU(this._innerRadius)?this._innerRadius:function(){return e._computeLayoutRadius()*e._innerRadius},cornerRadius:function(){return e._computeLayoutRadius()*e._cornerRadius},startAngle:function(t){return e.startAngleScale(t)},endAngle:function(t){return e.endAngleScale(t)},padAngle:this._padAngle,centerOffset:this._centerOffset},n=this._pieMark;n&&this.setMarkStyle(n,i,"normal",t.AttributeLevel.Series);var r=this._emptyArcMark;r&&this.setMarkStyle(r,M(M({},i),{visible:function(){var t=e.getViewData().latestData;return!t||!t.length}}),"normal",t.AttributeLevel.Series)},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)},i.prototype.initMarkStyleWithSpec=function(i,n){if(e.prototype.initMarkStyleWithSpec.call(this,i,n),i.name===this._pieMarkName){var r=this.getSpec()[i.name];if(r)for(var a in r.state||{})this.setMarkStyle(i,this.generateRadiusStyle(r.state[a]),a,t.AttributeLevel.User_Mark)}"emptyCircle"===i.name&&this.setMarkStyle(i,this.generateRadiusStyle(n.style),"normal",t.AttributeLevel.User_Mark)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{visible:gU(lQ).bind(this),text:function(t){return t[e.getDimensionField()[0]]},fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype.initEvent=function(){var t;e.prototype.initEvent.call(this),null===(t=this._viewDataLabel.getDataView())||void 0===t||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))},i.prototype.initGroups=function(){},i.prototype.onLayoutEnd=function(){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),e.prototype.onLayoutEnd.call(this)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return this._specAngleField},i.prototype.viewDataLabelUpdate=function(){this.event.emit(t.ChartEvent.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()},i.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e._computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e._computeLayoutRadius()*t.innerRadius}),t.cornerRadius&&(i.cornerRadius=function(){return e._computeLayoutRadius()*t.cornerRadius}),i}},i.prototype.computeCenter=function(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}},i.prototype.getRadius=function(t){var e,i,n,r,a,o,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.outerRadius:null===(s=null===(o=null===(a=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===a?void 0:a.state)||void 0===o?void 0:o[t])||void 0===s?void 0:s.outerRadius;return null!=l?l:this._outerRadius},i.prototype.getInnerRadius=function(t){var e,i,n,r,a,o,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.innerRadius:null===(s=null===(o=null===(a=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===a?void 0:a.state)||void 0===o?void 0:o[t])||void 0===s?void 0:s.innerRadius;return null!=l?l:this._innerRadius},i.prototype.computeRadius=function(t,e){return this._computeLayoutRadius()*t*(j(e)?1:e)+this._centerOffset},i.prototype.computeDatumRadius=function(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset},i.prototype._compareSpec=function(t,i,n){n=null!=n?n:{data:!0};var r=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];r.forEach((function(t){n[t]=!0}));var a=e.prototype._compareSpec.call(this,t,i,n);return t=null!=t?t:{},r.some((function(e){return t[e]!==i[e]}))&&(a.reRender=!0,a.change=!0),a},i.prototype.computeDatumInnerRadius=function(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset},i.prototype.dataToPosition=function(t,e){var i=t[dX];if(j(i))return null;if(e&&!this.isDatumInViewData(t))return null;var n=this.computeDatumRadius(t);return Pi(this.computeCenter(t),n,i)},i.prototype.initAnimation=function(){var t,e,i,n=this,r={growFrom:function(t,e,i){var r,a;if(i===HV.appear)return n._startAngle;if(i===HV.disappear)return n._endAngle;var o=[HV.disappear,HV.exit],s=n._pieMark.getGraphics(),l=t,u=null==l?void 0:l[Ej];if(void 0===s.find((function(t){var e;return(null===(e=t.context.data[0])||void 0===e?void 0:e[Ej])<u})))return n._startAngle;if(void 0===s.find((function(t){var e;return(null===(e=t.context.data[0])||void 0===e?void 0:e[Ej])>u})))return n._endAngle;var c=P([],B(s),!1).reverse().find((function(t){var e;return(null===(e=t.context.data[0])||void 0===e?void 0:e[Ej])<u}));return o.includes(i)?null===(r=null==c?void 0:c.getFinalAttribute())||void 0===r?void 0:r.endAngle:null===(a=null==c?void 0:c.attribute)||void 0===a?void 0:a.endAngle}},a=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._pieMark&&((o=nY(null===(e=ij.getAnimationInKey("pie"))||void 0===e?void 0:e(r,a),rY("pie",this._spec,this._markAttributeContext))).normal&&o.normal.type&&(o.normal=function(t,e){var i,n,r,a,o=null!==(n=null===(i=e.options)||void 0===i?void 0:i.distance)&&void 0!==n?n:10,s=it(e.duration)?e.duration/2:1e3,l=null!==(r=e.options.easing)&&void 0!==r?r:"cubicOut";return{oneByOne:e.oneByOne,loop:null!==(a=e.loop)&&void 0!==a&&a,timeSlices:[{duration:s,effects:{easing:l,channel:{x:{from:function(e){return t.getAttribute("x",e)},to:function(e){return t.getAttribute("x",e)+Pi({x:0,y:0},o,e[dX]).x}},y:{from:function(e){return t.getAttribute("y",e)},to:function(e){return t.getAttribute("y",e)+Pi({x:0,y:0},o,e[dX]).y}}}}},{duration:s,effects:{easing:l,channel:{x:{to:function(e){return t.getAttribute("x",e)},from:function(e){return t.getAttribute("x",e)+Pi({x:0,y:0},o,e[dX]).x}},y:{to:function(e){return t.getAttribute("y",e)},from:function(e){return t.getAttribute("y",e)+Pi({x:0,y:0},o,e[dX]).y}}}}}]}}(this._pieMark,o.normal)),this._pieMark.setAnimationConfig(o));if(this._emptyArcMark){var o=nY(null===(i=ij.getAnimationInKey("emptyCircle"))||void 0===i?void 0:i(r,null!=a?a:"fadeIn"));this._emptyArcMark.setAnimationConfig(o)}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.getActiveMarks=function(){return[this._pieMark]},i.transformerConstructor=sQ,i.mark=oQ,i.builtInTheme={pie:uQ},i}(GJ),hQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pie,i}return C(i,e),i.type=t.SeriesTypeEnum.pie,i}(cQ),dQ=function(){aQ(),ij.registerAnimation("pie",(function(t,e){return{appear:eQ(t,e),enter:QJ(t),exit:$J(t),disappear:tQ(t)}})),ij.registerAnimation("emptyCircle",(function(t,e){return{appear:eQ(t,e)}})),ij.registerSeries(hQ.type,hQ)};function pQ(t){return"angle"===t?"growAngleIn":"growRadiusIn"}var fQ=function(t){return{type:pQ(t.growField),options:{overall:!0}}},vQ={type:"fadeIn"},gQ=function(t){return{type:pQ(t.growField)}},yQ=function(t){return{type:(e=t.growField,"angle"===e?"growAngleOut":"growRadiusOut")};var e},mQ=yQ;function _Q(t,e){if(!1===e)return{};switch(e){case"fadeIn":return vQ;case"growAngle":return fQ(M(M({},t),{growField:"angle"}));default:return fQ(M(M({},t),{growField:"radius"}))}}var bQ,xQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.getStackGroupFields=function(){return this._angleField},e.prototype.getStackValueField=function(){return Dt(this._spec.valueField)[0]||Dt(this._spec.radiusField)[0]},e.prototype.getGroupFields=function(){return this._angleField},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()},e.prototype.setValueFieldToStack=function(){this.setRadiusField(Fj),this.setInnerRadiusField(Ij)},e.prototype.setValueFieldToPercent=function(){this.setRadiusField(zj),this.setInnerRadiusField(Oj)},e.prototype.getDimensionField=function(){return this._specAngleField},e.prototype.getMeasureField=function(){return this._specRadiusField},e.prototype.getDefaultShapeType=function(){return"square"},e}(GJ),kQ=M(M({},qG),((bQ={}).rose={name:"rose",type:"arc"},bQ)),SQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"rose")},e}(hY),AQ=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=L.polarAxis,r.name=L.polarAxis,r._defaultBandPosition=0,r._defaultBandInnerPadding=0,r._defaultBandOuterPadding=0,r.layoutType="absolute",r.layoutZIndex=t.LayoutZIndex.Axis,r._tick=void 0,r._center=null,r._startAngle=vX,r._endAngle=gX,r._orient="radius",r._groupScales=[],r.effect={scaleUpdate:function(t){r.computeData(null==t?void 0:t.value),cU(r._regions,(function(t){"radius"===r.getOrient()?aX(t.radiusAxisHelper,r.axisHelper(),W(r._seriesUserId)||W(r._seriesIndex))&&(t.radiusAxisHelper=r.axisHelper()):aX(t.angleAxisHelper,r.axisHelper(),W(r._seriesUserId)||W(r._seriesIndex))&&(t.angleAxisHelper=r.axisHelper())}),{userId:r._seriesUserId,specIndex:r._seriesIndex})}},r._transformLayoutPosition=function(t){var e,i=null===(e=r.getRegions())||void 0===e?void 0:e[0];return i?i.getLayoutStartPoint():t},r.getCenter=function(){var t,e,i=r.getRefLayoutRect(),n=i.width,a=i.height;return{x:HU(null===(t=r._center)||void 0===t?void 0:t.x,n,i,n/2),y:HU(null===(e=r._center)||void 0===e?void 0:e.y,a,i,a/2)}},r.getRefLayoutRect=function(){return r.getRegions()[0].getLayoutRect()},r._coordinateType="polar",r}return C(i,e),Object.defineProperty(i.prototype,"center",{get:function(){return this._center},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"startAngle",{get:function(){return this._startAngle},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"endAngle",{get:function(){return this._endAngle},enumerable:!1,configurable:!0}),i.prototype.getOrient=function(){return this._orient},i.prototype.getDefaultInteractive=function(){return"angle"!==this._orient},i.prototype.getGroupScales=function(){return this._groupScales},i.getSpecInfo=function(t){var e=this;if(!t[this.specKey])return null;var i,n,r=Z(t[this.specKey]),a=r?t[this.specKey]:[t[this.specKey]],o=[],s=[],l=[];return a.forEach((function(a,u){if("angle"===(h=null==(c=a)?void 0:c.orient)||"radius"===h){var c,h,d=function(t,e){var i,n,r,a,o,s,l=null!==(i=t.type)&&void 0!==i?i:"angle"===t.orient?"band":"linear",u="".concat(L.polarAxis,"-").concat(l),c=null!==(n=t.startAngle)&&void 0!==n?n:e.startAngle,h=null!==(r=t.endAngle)&&void 0!==r?r:e.endAngle;return{axisType:l,componentName:u,startAngle:null!=c?c:-90,endAngle:null!=h?h:W(c)?c+360:270,center:W(e.center)?e.center:W(null==e?void 0:e.centerX)||W(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!==(s=null!==(o=null!==(a=t.outerRadius)&&void 0!==a?a:t.radius)&&void 0!==o?o:e.outerRadius)&&void 0!==s?s:e.radius,layoutRadius:e.layoutRadius}}(a,t),p=d.axisType,f=d.componentName,v=d.startAngle,g=d.endAngle,y=d.center,m=d.outerRadius,_=d.layoutRadius;a.center=y,a.startAngle=v,a.endAngle=g,a.outerRadius=m,a.type=p,a.layoutRadius=_;var b={spec:a,specPath:r?[e.specKey,u]:[e.specKey],specInfoPath:["component",e.specKey,u],type:f};o.push(b),"radius"===a.orient?(s.push(b),n=u):(l.push(b),i=u)}})),s.forEach((function(t){t.angleAxisIndex=i})),l.forEach((function(t){t.radiusAxisIndex=n})),o},i.createComponent=function(t,e){var i=t.spec,n=w(t,["spec"]),r=ij.getComponentInKey(n.type);return r?new r(i,M(M({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=Ci(this._spec.startAngle),this._endAngle=Ci(this._spec.endAngle),this._inverse=this._spec.inverse},i.prototype._tickTransformOption=function(){var t,i=this;return M(M({},e.prototype._tickTransformOption.call(this)),{noDecimal:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:tX(this._spec),getRadius:function(){return i.getOuterRadius()},inside:this._spec.inside})},i.prototype.updateScaleRange=function(){var t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)},i.prototype.collectSeriesField=function(t,e){var i,n;return t>0?null===(n=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===n?void 0:n[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()},i.prototype.updateSeriesScale=function(){var t=this;cU(this._regions,(function(e){"radius"===t.getOrient()?aX(e.radiusAxisHelper,t.axisHelper(),W(t._seriesUserId)||W(t._seriesIndex))&&(e.setRadiusScale(t._scale),e.radiusAxisHelper=t.axisHelper()):aX(e.angleAxisHelper,t.axisHelper(),W(t._seriesUserId)||W(t._seriesIndex))&&(e.setAngleScale(t._scale),e.angleAxisHelper=t.axisHelper())}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getSeriesStatisticsField=function(t){var e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return tO(this._scale.type)?e:[e[0]]},i.prototype.initGroupScales=function(){},i.prototype.axisHelper=function(){var t=this;return{isContinuous:tO(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisId:function(){return t.id},getSpec:function(){return t._spec}}},i.prototype.positionToData=function(t){var e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)},i.prototype.coordToPoint=function(t){return Pi(this.getCenter(),t.radius,t.angle)},i.prototype.pointToCoord=function(t){return Ri(t,this.getCenter(),this._startAngle,this._endAngle)},i.prototype.getOuterRadius=function(){return this.computeLayoutOuterRadius()},i.prototype.getInnerRadius=function(){return this.computeLayoutInnerRadius()},i.prototype.updateLayoutAttribute=function(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),e.prototype.updateLayoutAttribute.call(this)},i.prototype._getNormalizedValue=function(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e},i.prototype.getLabelItems=function(t){var e,i=this,n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return n&&n.length?[n.map((function(e){return rX(e.value,i._getNormalizedValue([e.value],t))}))]:[]},i.prototype._getStartValue=function(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle},i.prototype._layoutAngleAxis=function(){var t,e,i,n=this.getCenter(),r=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this._endAngle-this._startAngle,s=this.getLabelItems(o),l=M(M({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:n,radius:r,innerRadius:a,startAngle:this._startAngle,endAngle:this._endAngle,sides:(null===(i=null===(e=null===(t=this._getRelatedAxis(this._option.radiusAxisIndex))||void 0===t?void 0:t.getSpec())||void 0===e?void 0:e.grid)||void 0===i?void 0:i.smooth)?void 0:this.getScale().domain().length}),u=M(M({},l),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:s,orient:"angle",scale:this._scale});this._spec.grid.visible&&(u.grid=M({type:"line",smoothLink:!0,items:s[0]},l)),this._update(u)},i.prototype._layoutRadiusAxis=function(){var t,e,i,n=this.getCenter(),r=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this.coordToPoint({angle:this._startAngle,radius:r}),s=this.coordToPoint({angle:this._startAngle,radius:a}),l=Si.distancePP(s,o),u=this.getLabelItems(l),c=M(M({},this.getLayoutStartPoint()),{start:s,end:o,verticalFactor:-1}),h=M(M({},c),{title:{text:this._spec.title.text||this._dataFieldText},items:u,orient:"radius",scale:this._scale.clone()});(null===(t=this._spec.grid)||void 0===t?void 0:t.visible)&&(h.grid=M({items:u[0],type:(null===(e=this._spec.grid)||void 0===e?void 0:e.smooth)?"circle":"polygon",center:n,closed:!0,sides:null===(i=this._getRelatedAxis(this._option.angleAxisIndex))||void 0===i?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},c)),this._update(h)},i.prototype._getRelatedAxis=function(t){if(W(t))return this._option.getComponentByIndex(this.specKey,t)},i.prototype._computeLayoutRadius=function(){var t=this;return mX((function(){return t._spec.layoutRadius}),this.getRefLayoutRect,this.getCenter,(function(){return{startAngle:t._startAngle,endAngle:t._endAngle}}))},i.prototype.computeLayoutOuterRadius=function(){var t,e=null!==(t=this._spec.outerRadius)&&void 0!==t?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*i},i.prototype.computeLayoutInnerRadius=function(){var t,e=null!==(t=this._spec.innerRadius)&&void 0!==t?t:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*e},i.prototype.getRefSeriesRadius=function(){var t=yX,e=0,i=this.getChart().getSpec();return cU(this.getRegions(),(function(n){var r=n;if(pY(r.type)){var a=r.outerRadius,o=void 0===a?i.outerRadius:a,s=r.innerRadius,l=void 0===s?i.innerRadius:s;it(o)&&(t=o),it(l)&&(e=l)}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:t,innerRadius:e}},i.prototype._update=function(t){var e=t.grid,i=w(t,["grid"]);(this._axisMark.getComponent().setAttributes(ej({},this._axisStyle,i)),this._gridMark)&&this._gridMark.getComponent().setAttributes(ej({},this._gridStyle,e))},i.prototype.invert=function(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){var i=this._scale.range(),n=i[i.length-1]-i[0],r=.5===(null!==(e=this.getSpec().bandPosition)&&void 0!==e?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){var a=(t+r+Math.abs(i[0]))%n-Math.abs(i[0]);return this._scale.invert(a)}return this._scale.invert((t+r)%n)}return this._scale.invert(t)},i.type=L.polarAxis,i.specKey="axes",i}(DX),CQ={grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},MQ={grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}},wQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.polarLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new YO,e}return C(e,t),e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec()},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.setScaleNice()},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,nz),t},e.type=L.polarLinearAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisLinear:VX,axisAngle:MQ,axisRadius:CQ},e}(AQ);Tt(wQ,jX);var TQ=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),ij.registerGraphicComponent(xX.circleAxis,(function(t,e){return new XF(t,e)})),ij.registerGraphicComponent(kX.circleAxisGrid,(function(t,e){return new sH(t,e)})),EX(),ij.registerComponent(wQ.type,wQ)},DQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.polarBandAxis,e._scale=new CO,e}return C(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return M(M({},e),{getBandwidth:function(t){return e.getScale(t).bandwidth()}})},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return EV(this._option.dataSet,t,hz),t},e.prototype.transformScaleDomain=function(){},e.type=L.polarBandAxis,e.specKey="axes",e.builtInTheme={axis:YX,axisBand:ZX,axisAngle:MQ,axisRadius:CQ},e}(AQ);Tt(DQ,qX);var EQ=function(){ij.registerGraphicComponent(xX.lineAxis,(function(t,e){return new UF(t,e)})),ij.registerGraphicComponent(kX.lineAxisGrid,(function(t,e){return new iH(t,e)})),ij.registerGraphicComponent(xX.circleAxis,(function(t,e){return new XF(t,e)})),ij.registerGraphicComponent(kX.circleAxisGrid,(function(t,e){return new sH(t,e)})),EX(),ij.registerComponent(DQ.type,DQ)},BQ={rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}},PQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rose,i.transformerConstructor=SQ,i._roseMark=null,i._labelMark=null,i}return C(i,e),i.prototype.initMark=function(){this.initRoseMark()},i.prototype.initMarkStyle=function(){this.initRoseMarkStyle()},i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.initRoseMark=function(){this._roseMark=this._createMark(i.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0},{morph:sY(this._spec,i.mark.rose.name),morphElementKey:this.getDimensionField()[0]})},i.prototype.getRoseAngle=function(){var t,e,i;return null!==(i=null===(e=(t=this.angleAxisHelper).getBandwidth)||void 0===e?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))&&void 0!==i?i:.5},i.prototype.startAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.endAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.initRoseMarkStyle=function(){var t=this,e=this._roseMark;e&&this.setMarkStyle(e,{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y},startAngle:function(e){return t.startAngleScale(e)},endAngle:function(e){return t.endAngleScale(e)},fill:this.getColorAttribute(),outerRadius:function(e){return RU(t.radiusAxisHelper.dataToPosition([e[t._radiusField[0]]]),t.radiusAxisHelper.getScale(0))},innerRadius:function(e){var i;if(!t.getStack())return 0;var n=RU(t.radiusAxisHelper.dataToPosition([e[t._innerRadiusField[0]]]),t.radiusAxisHelper.getScale(0));return n<=Number.MIN_VALUE?t._computeLayoutRadius()*(null!==(i=t._spec.innerRadius)&&void 0!==i?i:0):n}})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{text:function(t){return t[e.getDimensionField()[0]]},fill:this.getColorAttribute(),z:0})},i.prototype.initAnimation=function(){var t,e,i,n=this,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._roseMark){var a={innerRadius:function(){var t;return n._computeLayoutRadius()*(null!==(t=n._spec.innerRadius)&&void 0!==t?t:0)}};this._roseMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("rose"))||void 0===i?void 0:i(a,r),rY("rose",this._spec,this._markAttributeContext)))}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._roseMark]},i.type=t.SeriesTypeEnum.rose,i.mark=kQ,i.builtInTheme={rose:BQ},i.transformerConstructor=SQ,i}(xQ),RQ=function(){ij.registerSeries(PQ.type,PQ),aQ(),ij.registerAnimation("rose",(function(t,e){return{appear:_Q(t,e),enter:gQ(t),exit:yQ(t),disappear:mQ(t)}})),EQ(),TQ()},LQ=function(t){function e(e,i,n,r,a){var o=t.call(this,e,i,n,r,a)||this;return o._center=i.center,o}return C(e,t),e.prototype.getEndProps=function(){return!1===this.valid?{}:Pi(this._center,this._toRadius,this._toAngle)},e.prototype.onBind=function(){this.from=this.target.attribute,this.to=this.target.getFinalAttribute(),this._prevCenter=this.target.attribute.center,this._center&&this._prevCenter||(this.valid=!1);var t=Ri(this.from,this._prevCenter),e=t.angle,i=t.radius,n=Ri(this.to,this._center),r=n.angle,a=n.radius;it(r*a)||(this.valid=!1),this._fromAngle=it(e)?e:r,this._fromRadius=it(i)?i:a,this._toAngle=r,this._toRadius=a,eU(this._fromAngle,this._toAngle)&&eU(this._fromRadius,this._toRadius)&&(this.valid=!1),this.props=this.getEndProps()},e.prototype.onUpdate=function(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);var n=Pi({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*e,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*e},this._fromRadius+(this._toRadius-this._fromRadius)*e,this._fromAngle+(this._toAngle-this._fromAngle)*e),r=n.x,a=n.y;this.target.setAttributes({x:r,y:a}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()},e}(NL),IQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.onBind=function(){t.prototype.onBind.call(this);var e=this.target.attribute.center,i=this.target.getFinalAttribute().center;this._center=i,this._prevCenter=e},e.prototype.onUpdate=function(t,e,i){var n=this;this.points=this.points.map((function(r,a){var o=n.polarPointInterpolation(n.interpolatePoints[a][0],n.interpolatePoints[a][1],e);return t&&(i.center=n._center),o.context=r.context,o})),this.target.attribute.points=this.points,this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()},e.prototype._interpolationSinglePoint=function(t,e,i){if(!uU(t)&&!uU(e))return e;var n=Ri(t,this._prevCenter),r=Ri(e,this._center),a=Ii(n.angle),o=Ii(r.angle);!it(a)&&it(o)&&(a=o),it(a)&&!it(o)&&(o=a);var s=a+(o-a)*i,l=n.radius+(r.radius-n.radius)*i;return Pi({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},l,s)},e.prototype.polarPointInterpolation=function(t,e,i){var n=this._interpolationSinglePoint(t,e,i),r=n.x,a=n.y,o=this._interpolationSinglePoint({x:t.x1,y:t.y1},{x:e.x1,y:e.y1},i),s=o.x,l=o.y,u=new ki(r,a,s,l);return u.defined=e.defined,u},e}(hI),FQ=function(t){return{type:"in"===t?"fadeIn":"fadeOut"}};function OQ(t,e,i){return"fadeIn"===e?FQ(i):function(t,e){return{type:"in"===e?"growPointsIn":"growPointsOut",options:function(){return{center:t.center()}}}}(t,i)}function zQ(t,e,i){return"fadeIn"===e?FQ(i):function(t,e){var i=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.x},n=function(t,e){return e.getGraphicAttribute("x")},r=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.y},a=function(t,e){return e.getGraphicAttribute("y")};return"in"===e?{channel:{x:{from:i,to:n},y:{from:r,to:a}}}:{channel:{x:{from:n,to:i},y:{from:a,to:r}}}}(t,i)}var HQ,NQ=function(t,e){return{custom:uI,customParameters:function(i,n){var r;return{group:n,startAngle:null!==(r=t.startAngle)&&void 0!==r?r:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}},UQ=M(M(M({},qG),RY),((HQ={}).area={name:"area",type:"area"},HQ)),jQ={label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},VQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.radar,i.transformerConstructor=VY,i._sortDataByAxis=!1,i}return C(i,e),i.prototype.initGroups=function(){},i.prototype.compile=function(){e.prototype.compile.call(this),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e,i,n,r=!1!==(null===(t=this._spec.area)||void 0===t?void 0:t.visible)&&!1!==(null===(i=null===(e=this._spec.area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.visible),a=null!==(n=this._spec.seriesMark)&&void 0!==n?n:"area";this.initAreaMark(r&&"area"===a),this.initLineMark("line"===a||"area"===a&&!r),this.initSymbolMark("point"===a)},i.prototype.initMarkStyle=function(){var t=this;this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach((function(e){e&&t.setMarkStyle(e,{center:function(){var e;return null===(e=t.angleAxisHelper)||void 0===e?void 0:e.center()}})}))},i.prototype.initAreaMark=function(t){this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:t})},i.prototype.initAreaMarkStyle=function(){var e=this,i=this._areaMark;i&&(this.setMarkStyle(i,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:function(t){return t&&e.angleAxisHelper&&e.radiusAxisHelper?e.valueToPosition(e.getDatumPositionValues(t,e._angleField),e.getStack()?e.getDatumPositionValues(t,e._innerRadiusField):e.radiusScale.domain()[0]).x:Number.NaN},y1:function(t){return t&&e.angleAxisHelper&&e.radiusAxisHelper?e.valueToPosition(e.getDatumPositionValues(t,e._angleField),e.getStack()?e.getDatumPositionValues(t,e._innerRadiusField):e.radiusScale.domain()[0]).y:Number.NaN},fill:this.getColorAttribute(),curveType:SG,closePath:!0},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(i,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===e}},(function(){e.encodeDefined(i,"defined")})))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.group,n=t.mark;this._lineMark&&i.add(this._lineMark),this._areaMark&&i.add(this._areaMark),this._symbolMark&&(n.add(this._symbolMark),i.add(this._symbolMark))},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={center:function(){var t;return null===(t=r.angleAxisHelper)||void 0===t?void 0:t.center()},radius:function(){var t=r.getLayoutRect();return Math.min(t.width,t.height)},startAngle:W(this._spec.startAngle)?Ci(this._spec.startAngle):vX},o=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===o&&this._rootMark&&this._rootMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("radarGroup"))||void 0===n?void 0:n(a,o),rY("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach((function(t){var e=B(t,2),i=e[0],n=e[1];if(W(i)){var s=ij.getAnimationInKey(n);i.setAnimationConfig(nY(null==s?void 0:s(a,o),rY(i.name,r._spec,r._markAttributeContext)))}}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,a,o,s=null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0;return"fill"!==i||s||(i="stroke",s=null!==(o=null===(a=e._seriesMark)||void 0===a?void 0:a.getAttribute(i,t))&&void 0!==o?o:void 0),"stroke"===i&&Z(s)?s[0]:s}},i.type=t.SeriesTypeEnum.radar,i.mark=UQ,i.builtInTheme={radar:jQ},i.transformerConstructor=VY,i}(xQ);Tt(VQ,LY);var WQ,GQ,YQ,XQ,KQ=function(){ij.registerSeries(VQ.type,VQ),fq(),NY(),jY(),ij.registerAnimation("radar",(function(t,e){return{appear:"clipIn"===e?void 0:OQ(t,e,"in"),enter:OQ(t,e,"in"),exit:OQ(t,e,"out"),disappear:"clipIn"===e?void 0:OQ(t,e,"out"),update:[{channel:["points","center"],custom:IQ,customParameters:t,duration:JW.update.duration,easing:JW.update.easing},{type:"update",options:{excludeChannels:["points","defined","center"]}}]}})),ij.registerAnimation("radarSymbol",(function(t,e){return{appear:"clipIn"===e?void 0:zQ(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:zQ(t,e,"out"),update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:LQ,customParameters:t,duration:JW.update.duration,easing:JW.update.easing}]}})),ij.registerAnimation("radarGroup",(function(t,e){return{appear:NQ(t,"in"),disappear:NQ(t,"out")}})),FB(),EQ(),TQ()},qQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapeTypeCallback=function(){return"square"},e}return C(e,t),e.prototype.enableByType=function(t){return"mark"===t},e.prototype.getDefaultTitlePattern=function(t){return{key:"event info",value:"event info"}},e.prototype.getDefaultContentList=function(){return[{key:function(t){return t.type},value:function(t){return t.id}},{key:"event_time",value:function(t){return Ea.getInstance().timeFormat("%Y%m%d",t.event_time)}},{key:"action_type",value:function(t){return t.action_type}},{key:"children",value:function(t){return t.children}}]},e.prototype.getTooltipData=function(e,i,n,r,a){var o,s,l,u,c=t.prototype.getTooltipData.call(this,e,i,n,r,a),h=null!==(l=null===(s=null===(o=this.spec)||void 0===o?void 0:o[e])||void 0===s?void 0:s.updateContent)&&void 0!==l?l:null===(u=null==i?void 0:i[e])||void 0===u?void 0:u.updateContent;return c&&!h&&(c.updateContent=function(t,e,i){var n=[],r=t.filter((function(t){return"children"===t.key}));return r.length>0&&r[0].value.forEach((function(t){var e=!0;for(var i in t)n.push(M(M({},r[0]),{shapeType:"circle",hasShape:e,key:i,value:t[i]+""})),e=!1})),t.concat(n)}),c},e}(OG),ZQ=function(t,e){var i,n=(null===(i=t[0])||void 0===i?void 0:i.latestData)?t[0].latestData:t||[],r=[],a=0;return n.forEach((function(t){var i,n={};for(var o in t)o===e||o.startsWith(Mj)||(n[o]=t[o],i=W(i)?"".concat(i,"_").concat(t[o]):"".concat(t[o]));var s=t[e];null==s||s.forEach((function(t,e){var o;r.push(Object.assign({},n,t,((o={})[Ej]=a,o[Bj]="".concat(i,"_").concat(e),o))),a++}))})),r},JQ={fill:"#bbb",fillOpacity:.2},QQ=M(M({},qG),((WQ={}).group={name:"group",type:"group"},WQ.grid={name:"grid",type:"rule"},WQ.gridBackground={name:"gridBackground",type:"rect"},WQ.dot={name:"dot",type:"symbol"},WQ.title={name:"title",type:"text"},WQ.subTitle={name:"subTitle",type:"text"},WQ.symbol={name:"symbol",type:"symbol"},WQ)),$Q={dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},t$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.dot,i}return C(i,e),i.prototype.getSeriesGroupField=function(){return this._seriesField},i.prototype.setSeriesGroupField=function(t){W(t)&&(this._seriesGroupField=t)},i.prototype.getTitleField=function(){return this._titleField},i.prototype.setTitleField=function(t){W(t)&&(this._titleField=t)},i.prototype.getSubTitleField=function(){return this._subTitleField},i.prototype.setSubTitleField=function(t){W(t)&&(this._subTitleField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){W(t)&&(this._dotTypeField=t)},i.prototype.getHighLightSeriesGroup=function(){return this._highLightSeriesGroup},i.prototype.setHighLightSeriesGroup=function(t){W(t)&&(this._highLightSeriesGroup=t)},i.prototype.setGridBackground=function(t){W(t)&&(this._gridBackground=t)},i.prototype.initData=function(){var i,n=this;e.prototype.initData.call(this),this._xDimensionStatisticsDomain=this.getRawData().latestData.map((function(t){return t[n._fieldY[0]]})),EV(this._option.dataSet,"objFlat",ZQ),EV(this._option.dataSet,"copyDataView",jV),BV(this._option.dataSet,"dataview",Xu),null===(i=this.getViewData())||void 0===i||i.transform({type:"objFlat",options:"dots",level:t.TransformLevel.dotObjFlat},!1)},i.prototype.getStatisticFields=function(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(ej(JQ,(null===(t=this._spec.grid)||void 0===t?void 0:t.background)||{}))},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(i.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(i.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(i.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(i.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(i.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(i.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})},i.prototype.initMarkStyle=function(){var e,i=this,n=this._clipMark;n&&(this.setMarkStyle(n,{x:-(null!==(e=this._spec.leftAppendPadding)&&void 0!==e?e:0),y:0,width:1e4,height:function(){var t;return null!==(t=i._spec.clipHeight)&&void 0!==t?t:i._region.getLayoutRect().height}},"normal",t.AttributeLevel.Series),n.setMarkConfig({interactive:!1,clip:!0}));var r=this._containerMark;r&&(this.setMarkStyle(r,{x:this._spec.leftAppendPadding},"normal",t.AttributeLevel.Series),r.setMarkConfig({interactive:!1}));var a=this._gridBackgroundMark;a&&this.setMarkStyle(a,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",t.AttributeLevel.Series);var o=this._gridMark;o&&this.setMarkStyle(o,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series);var s=this._dotMark;s&&this.setMarkStyle(s,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),stroke:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",t.AttributeLevel.Series);var l=this._titleMark;l&&this.setMarkStyle(l,{fill:this.getColorAttribute(),text:function(t){return t[i.getTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series);var u=this._subTitleMark;u&&this.setMarkStyle(u,{fill:this.getColorAttribute(),text:function(t){return t[i.getSubTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series);var c=this._symbolMark;c&&this.setMarkStyle(c,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)},i.prototype.dataToGridBackgroundPositionY=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-n(0)/2},i.prototype.dataToGridBackgroundPositionY1=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+n(0)/2},i.prototype.dataToOpacity=function(t){var e,i,n,r;if(!this._xAxisHelper)return Number.NaN;var a=this._xAxisHelper,o=a.dataToPosition,s=a.getScale;return o(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<s(0).range()[0]||o(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>s(0).range()[1]?0:null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.dot)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fillOpacity)&&void 0!==r?r:1},i.prototype.dataToGridBackgroundOpacity=function(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0},i.prototype.onLayoutEnd=function(){var i,n;e.prototype.onLayoutEnd.call(this);var r=null!==(n=null===(i=this._spec)||void 0===i?void 0:i.leftAppendPadding)&&void 0!==n?n:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+r},"normal",t.AttributeLevel.Series)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesGroupField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._seriesGroupField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:Pj}},i.prototype.getDotColorScale=function(){var t,e,i,n=this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null===(i=this.getViewDataStatistics())||void 0===i?void 0:i.latestData[this._seriesField].values:[],r=this._getDataScheme();return(new DU).domain(n).range(r)},i.prototype.getDotColorAttribute=function(){var t,e,i,n;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this.getDotColorScale(),field:null!==(n=null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesGroupField)&&void 0!==i?i:this._seriesField)&&void 0!==n?n:Pj}},i.prototype.initTooltip=function(){this._tooltipHelper=new qQ(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t)},i.prototype.onMarkTreePositionUpdate=function(t){t.forEach((function(t){t.commit(!1,!0)}))},i.prototype.getDotData=function(){var t;return null===(t=this._dotMark)||void 0===t?void 0:t.getData()},i.prototype._getDataIdKey=function(){},i.prototype.getStackValueField=function(){return null},i.prototype.getActiveMarks=function(){return[this._dotMark]},i.type=t.SeriesTypeEnum.dot,i.mark=QQ,i.builtInTheme={dot:$Q},i}(gY),e$=function(){jY(),OZ(),Lq(),wJ(),ij.registerSeries(t$.type,t$)},i$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapeTypeCallback=function(){return"square"},e}return C(e,t),e.prototype.enableByType=function(t){return"mark"===t},e.prototype.getDefaultTitlePattern=function(t){return{key:"link info",value:"link info"}},e.prototype.getDefaultContentList=function(){return[{key:"time",value:function(t){return Ea.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])}},{key:"type",value:function(t){return t.action_type}},{key:"from",value:function(t){return t.from}},{key:"to",value:function(t){return t.to}}]},e}(OG),n$=M(M({},qG),((GQ={}).group={name:"group",type:"group"},GQ.link={name:"link",type:"rule"},GQ.arrow={name:"arrow",type:"symbol"},GQ)),r$=function(t,e){var i=e.infoKey,n=e.fields,r=e.linkData,a=e.dotData,o=n(),s=o.fromField,l=o.toField,u=o.xField,c=o.yField,h=r(),d=a(),p={};return d.forEach((function(t){var e={};for(var n in t)n!==i&&(e[n]=t[n]);var r=t[i];null==r||r.forEach((function(t){p[t.node_name]=Object.assign({},e,t)}))})),h.forEach((function(t){var e,i,n,r;t[s+"_xField"]=null===(e=null==p?void 0:p[t[s]])||void 0===e?void 0:e[u],t[s+"_yField"]=null===(i=null==p?void 0:p[t[s]])||void 0===i?void 0:i[c],t[l+"_xField"]=null===(n=null==p?void 0:p[t[l]])||void 0===n?void 0:n[u],t[l+"_yField"]=null===(r=null==p?void 0:p[t[l]])||void 0===r?void 0:r[c]})),h},a$={arrow:{style:{size:10}}},o$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.link,i}return C(i,e),i.prototype.getFromField=function(){return this._fromField},i.prototype.setFromField=function(t){W(t)&&(this._fromField=t)},i.prototype.getToField=function(){return this._toField},i.prototype.setToField=function(t){W(t)&&(this._toField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){W(t)&&(this._dotTypeField=t)},i.prototype.getDotSeriesSpec=function(){return this._dotSeriesSpec},i.prototype.setDotSeriesSpec=function(t){W(t)&&(this._dotSeriesSpec=t)},i.prototype._getDotData=function(){var t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]},i.prototype.initData=function(){var i,n=this;e.prototype.initData.call(this),EV(this._option.dataSet,"linkDotInfo",r$),null===(i=this.getViewData())||void 0===i||i.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:function(){return{fromField:n._fromField,toField:n._toField,xField:n._dotSeriesSpec.xField,yField:n._dotSeriesSpec.yField}},linkData:function(){return n._rawData.latestData},dotData:function(){return n._getDotData()}},level:t.TransformLevel.linkDotInfo},!1)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(i.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(i.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})},i.prototype.initMarkStyle=function(){var e,i,n,r,a=this,o=this._clipMark;o&&(this.setMarkStyle(o,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",t.AttributeLevel.Series),o.setMarkConfig({interactive:!1,clip:!0}));var s=this._containerMark;s&&(this.setMarkStyle(s,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",t.AttributeLevel.Series),s.setMarkConfig({interactive:!1}));var l=this._linkMark;l&&this.setMarkStyle(l,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",t.AttributeLevel.Series);var u=this._arrowMark;if(u){var c=null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.arrow)||void 0===i?void 0:i.style)||void 0===n?void 0:n.size)&&void 0!==r?r:10;this.setMarkStyle(u,{x:this.dataToPositionXTo.bind(this),y:function(t){return a.dataToPositionArrowYTo(t,c)},fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:c,symbolType:function(t){return a.isPositionYFromHigher(t)?"triangleDown":"triangleUp"}},"normal",t.AttributeLevel.Series)}},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype.dataToPositionXFrom=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYFrom=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_yField")):Number.NaN},i.prototype.dataToPositionXTo=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYTo=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionArrowYTo=function(t,e){if(!this._yAxisHelper)return Number.NaN;var i=this._yAxisHelper.dataToPosition,n=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+n},i.prototype.dataToOpacity=function(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1},i.prototype.isPositionYFromHigher=function(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)},i.prototype.isPositionXOuterRange=function(t,e){if(!this._xAxisHelper)return!1;var i=this._xAxisHelper,n=i.dataToPosition,r=i.getScale;return n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]},i.prototype.getDefaultColorDomain=function(){var t,e;return this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:Pj}},i.prototype.getInteractionTriggers=function(){var t=[];return this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)},i.prototype.initTooltip=function(){this._tooltipHelper=new i$(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)},i.prototype.onMarkTreePositionUpdate=function(t){t.forEach((function(t){t.commit(!1,!0)}))},i.prototype.getDotInfoData=function(){var t,e;return null===(e=null!==(t=this._linkMark)&&void 0!==t?t:this._arrowMark)||void 0===e?void 0:e.getData()},i.prototype.getActiveMarks=function(){return[this._linkMark,this._arrowMark]},i.type=t.SeriesTypeEnum.link,i.mark=n$,i.builtInTheme={link:a$},i}(gY),s$=function(){OZ(),jY(),QX(),KX(),ij.registerSeries(o$.type,o$)},l$=M(M({},qG),((YQ={}).group={name:"group",type:"group"},YQ)),u$=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._arcGroupMark=null,t._getAngleValueStart=function(e){var i=t._getAngleAxis(),n=t._spec.tickMask;if((null==n?void 0:n.forceAlign)&&t._isTickMaskVisible(i)){var r=e[t.getStack()?Ij:qj],a=t._getAngleAxisSubTickData(i),o=a[1].value-a[0].value,s=Ci(n.offsetAngle),l=void 0;if(W(r)){var u=Xt(a,(function(t){return t.value-r})),c=u>=a.length||r>a[u].value-o/2?Math.min(u,a.length-1):u>0?u-1:void 0;void 0!==c&&(l=t.angleAxisHelper.dataToPosition([a[c].value-o/2]))}return j(l)&&(l=t.angleAxisHelper.dataToPosition([a[0].value-o/2])),l+s}return t._getAngleValueStartWithoutMask(e)},t._getAngleValueEnd=function(e){var i=t._getAngleAxis(),n=t._spec.tickMask;if((null==n?void 0:n.forceAlign)&&t._isTickMaskVisible(i)){var r=e[t.getStack()?Fj:t._angleField[0]],a=t._getAngleAxisSubTickData(i),o=a[1].value-a[0].value,s=Ci(n.offsetAngle),l=Xt(a,(function(t){return t.value-r})),u=l>=a.length||r>a[l].value-o/2?Math.min(l,a.length-1):l>0?l-1:void 0;return(void 0!==u?t.angleAxisHelper.dataToPosition([a[u].value+o/2]):t.angleAxisHelper.dataToPosition([a[0].value-o/2]))+s}return t._getAngleValueEndWithoutMask(e)},t}return C(i,e),i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this);var r=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getSpec(),a=null!==(i=this._spec.startAngle)&&void 0!==i?i:null==r?void 0:r.startAngle;this._startAngle=W(a)?Ci(a):vX;var o=null!==(n=this._spec.endAngle)&&void 0!==n?n:null==r?void 0:r.endAngle;this._endAngle=W(o)?Ci(o):gX,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()},i.prototype.getStackGroupFields=function(){return this._radiusField},i.prototype.getStackValueField=function(){var t;return null===(t=this._angleField)||void 0===t?void 0:t[0]},i.prototype.getGroupFields=function(){return this._angleField},i.prototype._convertMarkStyle=function(t){var i=e.prototype._convertMarkStyle.call(this,t),n="fill";if(i[n]){var r=t[n];"conical"!==(null==r?void 0:r.gradient)||W(null==r?void 0:r.startAngle)||W(null==r?void 0:r.endAngle)||(i[n]=M(M({},r),{startAngle:this._startAngle,endAngle:this._endAngle}))}return i},i.prototype._getAngleValueStartWithoutMask=function(t){if(this.getStack()){var e=RU(this.angleAxisHelper.dataToPosition([t[Ij]]),this.angleAxisHelper.getScale(0));if(it(e))return e}return this._startAngle},i.prototype._getAngleValueEndWithoutMask=function(t){if(this.getStack()){var e=RU(this.angleAxisHelper.dataToPosition([t[Fj]]),this.angleAxisHelper.getScale(0));if(it(e))return e}var i=this.angleAxisHelper.dataToPosition([t[this._angleField[0]]]);return this._spec.clamp?RU(i,this.angleAxisHelper.getScale(0)):i},i.prototype.getDimensionField=function(){return this._specRadiusField},i.prototype.getMeasureField=function(){return this._specAngleField},i.prototype.initMark=function(){this._initArcGroupMark()},i.prototype.initMarkStyle=function(){this._initArcGroupMarkStyle()},i.prototype._initArcGroupMark=function(){return this._arcGroupMark=this._createMark(i.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark},i.prototype._initArcGroupMarkStyle=function(){var e=this,i=this._arcGroupMark;i.created(),this.setMarkStyle(i,{x:0,y:0},"normal",t.AttributeLevel.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:function(){var t=e._getAngleAxis(),i=e.angleAxisHelper.center(),n=i.x,r=i.y,a=e._computeLayoutRadius();if(e._isTickMaskVisible(t)){var o=e._spec.tickMask,s=o.angle,l=o.offsetAngle,u=o.style,c=void 0===u?{}:u,h=e._getAngleAxisSubTickData(t),d=c;return h.map((function(t){var i=t.value,o=e.angleAxisHelper.dataToPosition([i])+Ci(l),u=Ci(s)/2;return __(M(M({},d),{x:n,y:r,startAngle:o-u,endAngle:o+u,innerRadius:a*e._innerRadius,outerRadius:a*e._outerRadius,fill:!0}))}))}var p=e.getLayoutRect();return[Ym({width:p.width,height:p.height,fill:!0})]}})},i.prototype._getAngleAxis=function(){if(this.angleAxisHelper){var t=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find((function(e){return e.id===t}))}},i.prototype._getAngleAxisTickData=function(t){var e;return null===(e=null==t?void 0:t.getTickData())||void 0===e?void 0:e.getLatestData()},i.prototype._isTickMaskVisible=function(t){var e=this._getAngleAxisTickData(t),i=this._spec.tickMask;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1},i.prototype._getAngleAxisSubTickData=function(t){var e,i=this._getAngleAxisTickData(t),n=[],r=null!==(e=null==t?void 0:t.getSpec())&&void 0!==e?e:{},a=r.subTick,o=void 0===a?{}:a,s=r.tick,l=void 0===s?{}:s,u=o.tickCount,c=void 0===u?4:u,h=l.alignWithLabel;if((null==i?void 0:i.length)>=2){for(var d=i[1].value-i[0].value,p=0;p<i.length-1;p++){var f=i[p],v=i[p+1];n.push(f);for(var g=0;g<c;g++){var y=(g+1)/(c+1),m=(1-y)*f.value+y*(v?v.value:h?1:f.value+d);n.push({value:m})}}return n.push(i[i.length-1]),n}return i},i.mark=l$,i}(GJ),c$=M(M({},l$),((XQ={}).track={name:"track",type:"arc"},XQ.progress={name:"progress",type:"arc"},XQ)),h$={type:"fadeIn"};function d$(t,e){return"fadeIn"===e?h$:function(t){return{type:"growAngleIn",options:{overall:t.startAngle}}}(t)}var p$=function(){ij.registerAnimation("circularProgress",(function(t,e){return{appear:d$(t,e),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}}))},f$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return C(e,t),e}(hY),v$={outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},g$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circularProgress,i.transformerConstructor=f$,i._progressMark=null,i._trackMark=null,i._getRadiusValueStart=function(t){if(i.getGroupFields().length>1){var e=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()));if(it(e))return e}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])},i._getRadiusValueEnd=function(t){var e,n;if(i.getGroupFields().length>1){var r=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()))+(null===(n=(e=i.radiusAxisHelper).getBandwidth)||void 0===n?void 0:n.call(e,i._groups?i._groups.fields.length-1:0));if(it(r))return r}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])+i.radiusAxisHelper.getScale(0).step()},i}return C(i,e),i.prototype.getStackGroupFields=function(){return this.getGroupFields()},i.prototype.getGroupFields=function(){return this._radiusField},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){return this._progressMark=this._createMark(i.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0},{morph:sY(this._spec,"progress")}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var e,i=this,n=this._progressMark;n&&this.setMarkStyle(n,{x:function(){return i.angleAxisHelper.center().x},y:function(){return i.angleAxisHelper.center().y},startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!==(e=this._spec.roundCap)&&void 0!==e&&e,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",t.AttributeLevel.Series)},i.prototype.getInteractionTriggers=function(){var t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)},i.prototype._initTrackMark=function(){return this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark}),this._trackMark.setMarkConfig({morph:!1,morphKey:null,morphElementKey:null}),this._trackMark},i.prototype._initTrackMarkStyle=function(){var e=this,i=this._trackMark;i&&this.setMarkStyle(i,{visible:function(t){var i=e.angleAxisHelper.getScale(0).range(),n=Math.min(i[0],i[i.length-1]),r=e._getAngleValueStartWithoutMask(t);return Math.abs(r-n)<=1e-14},x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:function(){var t,i=e.getStack()?Ij:e._angleField[0],n=e.angleAxisHelper.getScale(0).domain();return e._getAngleValueStart(((t={})[i]=n[0],t))},endAngle:function(){var t,i=e.getStack()?Fj:e._angleField[0],n=e.angleAxisHelper.getScale(0).domain();return e._getAngleValueEnd(((t={})[i]=n[n.length-1],t))},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i,n,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},r),rY("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),rY("track",this._spec,this._markAttributeContext)))},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.circularProgress,i.mark=c$,i.builtInTheme={circularProgress:v$},i.transformerConstructor=f$,i}(u$),y$=function(){ij.registerSeries(g$.type,g$),aQ(),p$(),eG(),EQ(),TQ()};function m$(t){return function(){return"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}}var _$=function(t){return{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:m$(t)}},b$={type:"fadeIn"};function x$(t,e){return void 0===e&&(e="grow"),!1===e?{}:"fadeIn"===e?b$:function(t){return{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:m$(t)}}(t)}var k$,S$,A$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(OG),C$=M(M({},qG),((k$={}).track={name:"track",type:"rect"},k$.progress={name:"progress",type:"rect"},k$.group={name:"group",type:"group"},k$)),M$={bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}},w$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.linearProgress,i._progressMark=null,i._trackMark=null,i._defaultProgressCustomShape=function(t,e,n){var r,a,o=null===(r=i._spec)||void 0===r?void 0:r.cornerRadius,s=W(e.width)?e.width:e.x1-e.x,l=W(e.height)?e.height:e.y1-e.y,u=Math.min(0,s),c=Math.max(0,s),h=Math.min(0,l),d=Math.max(0,l);if(o>0){var p=o;if("vertical"===(null===(a=i._spec)||void 0===a?void 0:a.direction)){if(2*(p=Math.min(Math.abs(s/2),o))>Math.abs(l)){var f=Math.acos((p-Math.abs(l)/2)/p);return n.moveTo(u+p,h),n.arc(u+p,h+p,p,1.5*Math.PI,1.5*Math.PI-f,!0),n.arc(u+p,d-p,p,f+Math.PI/2,Math.PI/2,!0),n.lineTo(c-o,d),n.arc(c-p,d-p,p,Math.PI/2,Math.PI/2-f,!0),n.arc(c-p,h+p,p,-Math.PI/2+f,-Math.PI/2,!0),n.lineTo(u+p,h),n.closePath(),n}}else if(2*(p=Math.min(Math.abs(l/2),o))>Math.abs(s)){f=Math.acos((p-Math.abs(s)/2)/p);return n.moveTo(u,h+p),n.arc(u+p,h+p,p,Math.PI,Math.PI+f),n.arc(c-p,h+p,p,-f,0),n.lineTo(c,d-p),n.arc(c-p,d-p,p,0,f),n.arc(u+p,d-p,p,Math.PI-f,Math.PI),n.closePath(),n}n.moveTo(u,h+p),n.arc(u+p,h+p,p,Math.PI,1.5*Math.PI),n.lineTo(c-p,h),n.arc(c-p,h+p,p,-Math.PI/2,0),n.lineTo(c,d-p),n.arc(c-p,d-p,p,0,Math.PI/2),n.lineTo(u+p,d),n.arc(u+p,d-p,p,Math.PI/2,Math.PI),n.closePath()}else n.moveTo(u,h),n.lineTo(c,h),n.lineTo(c,d),n.lineTo(u,d),n.closePath();return n},i}return C(i,e),i.prototype.initMark=function(){this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){var t;return this._progressMark=this._createMark(i.mark.progress,{isSeriesMark:!0}),j(null===(t=this._spec.progress)||void 0===t?void 0:t.customShape)&&this._progressMark.setMarkConfig({setCustomizedShape:this._defaultProgressCustomShape}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var e,i,n,r,a=this,o=this._progressMark;if(o)if("vertical"===this._spec.direction){var s=null!==(e=(u=this._spec.progress||{}).leftPadding)&&void 0!==e?e:0,l=null!==(i=u.rightPadding)&&void 0!==i?i:0;this.setMarkStyle(o,{x:function(t){var e,i;return RU(a.dataToPositionX(t),null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),!0)-a._spec.bandWidth/2+s},y1:function(t){var e,i;return RU(a.dataToPositionY(t),null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:function(){var t,e,i,n=null===(t=a._yAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:a._bandPosition});return a._spec.clamp?RU(n,null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0)):n},width:this._spec.bandWidth-s-l,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)}else{var u,c=null!==(n=(u=this._spec.progress||{}).topPadding)&&void 0!==n?n:0,h=null!==(r=u.bottomPadding)&&void 0!==r?r:0;this.setMarkStyle(o,{x1:function(t){var e,i;return RU(a.dataToPositionX(t),null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:function(t){var e,i;return RU(a.dataToPositionY(t),null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),!0)-a._spec.bandWidth/2+c},height:this._spec.bandWidth-c-h,x:function(){var t,e,i,n=null===(t=a._xAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:a._bandPosition});return a._spec.clamp?RU(n,null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0)):n},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)}},i.prototype._initTrackMark=function(){return this._trackMark=this._createMark(i.mark.track),this._trackMark},i.prototype._initTrackMarkStyle=function(){var e=this,i=this._trackMark;i&&("vertical"===this._spec.direction?this.setMarkStyle(i,{x:function(t){var i,n;return RU(e.dataToPositionX(t),null===(n=null===(i=e._xAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),!0)-e._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:function(){return e._scaleY.range()[0]},cornerRadius:this._spec.cornerRadius},"normal",t.AttributeLevel.Series):this.setMarkStyle(i,{x:0,y:function(t){var i,n;return RU(e.dataToPositionY(t),null===(n=null===(i=e._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),!0)-e._spec.bandWidth/2},height:this._spec.bandWidth,width:function(){return e._scaleX.range()[1]},cornerRadius:this._spec.cornerRadius},"normal",t.AttributeLevel.Series))},i.prototype.getInteractionTriggers=function(){var t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("linearProgress"))||void 0===i?void 0:i(r,a),rY("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),rY("track",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new A$(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.linearProgress,i.mark=C$,i.builtInTheme={linearProgress:M$},i}(gY),T$=function(){Lq(),ij.registerAnimation("linearProgress",(function(t,e){return{appear:x$(t,e),enter:x$(t),disappear:_$(t)}})),eG(),ij.registerSeries(w$.type,w$)},D$=[0],E$=[20,40],B$=[200,500],P$={shrink:!1,enlarge:!1,fontSizeLimitMin:0},R$=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],L$="".concat(Mj,"_WORD_CLOUD_TEXT"),I$=M(M({},qG),((S$={}).word={name:"word",type:"text"},S$.fillingWord={name:"fillingWord",type:"text"},S$.wordMask={name:"wordMask",type:"rect"},S$)),F$={word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},O$=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._fontSizeRange=[20,20],t._isWordCloudShape=!1,t._dataChange=!0,t.handleMaskCanvasUpdate=function(e,i){t._maskCanvas=e},t.getWordColor=function(e){return e.isFillingWord?(t._fillingColorCallback&&!t._dataChange||(t._fillingColorCallback=t._wordCloudShapeConfig.fillingColorHexField?function(e){return e[t._wordCloudShapeConfig.fillingColorHexField]}:t.initColorCallback(t._wordCloudShapeConfig.fillingSeriesField,!0)),t._fillingColorCallback(e)):(t._keyWordColorCallback&&!t._dataChange||(t._keyWordColorCallback=t._spec.colorHexField?function(e){return e[t._spec.colorHexField]}:t.initColorCallback(t._seriesField,!1)),t._keyWordColorCallback(e))},t._calculateFontWeight=function(e){var i=t.getRawDataStatisticsByField(t._valueField,!0);return i.min===i.max?t._fontWeightRange[0]:t._fontWeightRange[0]+(t._fontWeightRange[t._fontWeightRange.length-1]-t._fontWeightRange[0])*(e[t._valueField]-i.min)/(i.max-i.min)},t}return C(i,e),i.prototype.setValueField=function(t){W(t)&&(this._valueField=t)},i.prototype.setFontSizeRange=function(t){W(t)?this._fontSizeRange=t:this._fontSizeRange=E$},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=null!==(t=this._spec.colorMode)&&void 0!==t?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!==(i=this._spec.fontWeightRange)&&void 0!==i?i:B$,this._rotateAngles=null!==(n=this._spec.rotateAngles)&&void 0!==n?n:D$,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!==(r=this._spec.maskShape)&&void 0!==r?r:"circle",this._textField=(null===(a=this._spec.word)||void 0===a?void 0:a.formatMethod)?L$:this._nameField;var o=this._spec.wordCloudConfig;this._wordCloudConfig=M({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:P$},this._spec.wordCloudConfig),o&&!j(o.layoutMode)||GA(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=M({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:D$,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!R$.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme("fontFamily")},i.prototype.initData=function(){var t,i,n=this;e.prototype.initData.call(this),null===(i=null===(t=this.getViewData())||void 0===t?void 0:t.target)||void 0===i||i.addListener("change",(function(){n._dataChange=!0,n.compile()}))},i.prototype.initMark=function(){var e;this._wordMark=this._createMark(i.mark.word,{key:Bj,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField}),(null===(e=this._spec.wordMask)||void 0===e?void 0:e.visible)&&(this._maskMark=this._createMark(i.mark.wordMask,{dataView:!1}),this._maskMark.setMarkConfig({zIndex:t.LayoutZIndex.Mark-1}))},i.prototype.initMarkStyle=function(){var e=this;this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:function(){return e._region.getLayoutRect().width},height:function(){return e._region.getLayoutRect().height},background:function(){return e._maskCanvas}},"normal",t.AttributeLevel.Series)},i.prototype.initMarkStyleOfWord=function(e,i,n,r,a){var o,s,l=this;e&&(this.setMarkStyle(e,{text:(null==i?void 0:i.formatMethod)?function(t){return i.formatMethod(t)}:function(t){return t[l._textField]},x:function(t){return t.x},y:function(t){return t.y},fontSize:function(t){return t.fontSize},fontStyle:function(t){return t.fontStyle},angle:function(t){return t.angle},visible:function(t){return t.visible}},"normal",t.AttributeLevel.Series),this.setMarkStyle(e,{fill:null!==(s=null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.fill)&&void 0!==s?s:this.getWordColor,fontWeight:function(t){return t.fontWeight},fontFamily:function(t){return t.fontFamily}},"normal",t.AttributeLevel.User_Mark))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)},i.prototype.initAnimation=function(){var t=this;[this._wordMark].forEach((function(e){var i,n;if(e){var r=null===(n=null===(i=t._spec)||void 0===i?void 0:i.animationAppear)||void 0===n?void 0:n.preset,a={animationConfig:function(){var t,i;return null===(i=null===(t=e.getAnimationConfig())||void 0===t?void 0:t.appear)||void 0===i?void 0:i[0]}};e.setAnimationConfig(nY(ij.getAnimationInKey("wordCloud")(a,r),rY("word",t._spec,t._markAttributeContext)))}}))},i.prototype.getWordOrdinalColorScale=function(t,e){var i,n,r,a,o,s=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,l=t?null===(i=this.getViewData())||void 0===i?void 0:i.latestData.map((function(e){return e[t]})):[],u=null!==(r=null!=s?s:null===(n=this._option.globalScale.getScale("color"))||void 0===n?void 0:n.range())&&void 0!==r?r:this._getDataScheme();return null===(o=(a=(new DU).domain(l)).range)||void 0===o?void 0:o.call(a,u)},i.prototype.initColorCallback=function(t,e){var i,n,r,a,o=this;if("ordinal"===this._colorMode){var s=this.getWordOrdinalColorScale(t,e);return function(e){return s.scale(e[null!=t?t:Pj])}}var l=null!==(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)&&void 0!==i?i:this._option.globalScale.getScale("color").range();if(1===l.length)return function(t){return l[0]};if(this._valueField){var u=this.getRawDataStatisticsByField(this._valueField,!0);if(u.min===u.max)return l[0];var c=(new YO).domain([u.min,u.max]).range(l);return function(t){return c.scale(t[o._valueField])}}var h=(new YO).domain([0,null!==(a=null===(r=null===(n=this.getViewData())||void 0===n?void 0:n.latestData)||void 0===r?void 0:r.length)&&void 0!==a?a:1]).range(l);return function(t){return h.scale(t[Ej])}},i.prototype.compile=function(){e.prototype.compile.call(this);var t=this._region.getLayoutRect(),i=t.width,n=t.height;if(it(i)&&it(n)&&n>0&&i>0){var r=[];this._isWordCloudShape?r.push(M({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):r.push(M({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.setTransform(r)}},i.prototype._getCommonTransformOptions=function(){var e,i,n,r,a,o=this,s=this._region.getLayoutRect(),l=s.width,u=s.height,c=null!==(e=this._spec.word)&&void 0!==e?e:{},h=null!==(i=c.style)&&void 0!==i?i:{};return{size:[l,u],shape:G(this._maskShape)&&"text"===this._maskShape.type&&j(this._maskShape.fontFamily)?M({fontFamily:this._option.getTheme("fontFamily")},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,onLayoutFinished:function(){var e=function(){var i,n,r,a;o._option.globalInstance.getStage().hooks.afterRender.taps=o._option.globalInstance.getStage().hooks.afterRender.taps.filter((function(t){return t.fn!==e})),null===(n=(i=o._option).dispatchEvent)||void 0===n||n.call(i,t.ChartEvent.afterWordcloudShapeDraw,{instance:o._option.globalInstance}),null===(a=null===(r=o._option.globalInstance.getChart().getOption().performanceHook)||void 0===r?void 0:r.afterWordcloudShapeDraw)||void 0===a||a.call(r,o._option.globalInstance)};o._option.globalInstance.getStage().hooks.afterRender.taps.push({type:"sync",name:"afterWordcloudShapeDraw",fn:e})},dataIndexKey:Bj,text:c.formatMethod?function(t){return c.formatMethod(t)}:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:null!==(r=null===(n=this._spec.word)||void 0===n?void 0:n.padding)&&void 0!==r?r:1,fontFamily:W(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:null!==(a=h.fontFamily)&&void 0!==a?a:this._defaultFontFamily,fontWeight:W(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:W(h.fontWeight)?h.fontWeight:W(this._valueField)?this._calculateFontWeight:"normal",fontStyle:W(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:h.fontStyle,createCanvas:tS.createCanvas.bind(tS),getTextBounds:P_}},i.prototype._wordCloudTransformOption=function(){var t,e,i=null!==(t=this._wordCloudConfig)&&void 0!==t?t:{};return M(M(M({},i),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:null===(e=this._spec.random)||void 0===e||e,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})},i.prototype._wordCloudShapeTransformOption=function(){var t,e,i,n,r,a,o=null!==(e=null===(t=this._spec.fillingWord)||void 0===t?void 0:t.style)&&void 0!==e?e:{},s=null!==(i=this._wordCloudShapeConfig)&&void 0!==i?i:{};return M(M(M({},s),this._getCommonTransformOptions()),{createImage:n_,rotateList:this._rotateAngles,fillingRotateList:s.fillingRotateAngles,fillingFontFamily:W(s.fillingFontFamilyField)?{field:s.fillingFontFamilyField}:null!==(n=o.fontFamily)&&void 0!==n?n:this._defaultFontFamily,fillingPadding:null!==(a=null===(r=this._spec.fillingWord)||void 0===r?void 0:r.padding)&&void 0!==a?a:1,fillingFontStyle:W(s.fillingFontStyleField)?{field:s.fillingFontStyleField}:o.fontStyle,fillingFontWeight:W(s.fillingFontWeightField)?{field:s.fillingFontWeightField}:o.fontWeight})},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.dataToPosition=function(t){return null},i.prototype.dataToPositionX=function(t){return null},i.prototype.dataToPositionY=function(t){return null},i.prototype.dataToPositionZ=function(t){return null},i.prototype.valueToPosition=function(t,e){return null},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.compile(),this._dataChange=!1},i.prototype.getActiveMarks=function(){return[this._wordMark]},i.prototype.reInit=function(){e.prototype.reInit.call(this),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)},i.mark=I$,i.builtInTheme={wordCloud:F$},i}(dY);function z$(t,e){return!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:function(t){return{type:"scaleIn",duration:200,delay:function(e,i){var n=t.animationConfig(),r=(null==n?void 0:n.duration)||200,a=(null==n?void 0:n.totalTime)||JW.appear.duration,o=i.context.graphicCount;return i.context.graphicIndex*function(t,e,i){return t*i<e?t+(e-i*t)/(i-1):(e-t)/(i-1)}(r,a,o)}}}(t)}var H$=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"value",s=0,l=null!=n?n:-1,u=i;return t.forEach((function(t,n){var c,h,d={flattenIndex:++l,key:a?a(t):"".concat(null!==(c=null==r?void 0:r.key)&&void 0!==c?c:"","-").concat(n),maxDepth:-1,depth:i,index:n,value:t[o],isLeaf:!0,datum:r?r.datum.concat(t):[t],parentKey:null==r?void 0:r.key};if(null===(h=t.children)||void 0===h?void 0:h.length){d.children=[],d.isLeaf=!1;var p=H$(t.children,d.children,i+1,l,d,a,o);d.value=j(t[o])?p.sum:Math.max(p.sum,Ae(t[o])),l=p.flattenIndex,u=Math.max(p.maxDepth,u)}else d.isLeaf=!0,d.value=Ae(t[o]);s+=Math.abs(d.value),e.push(d)})),{sum:s,maxDepth:u,flattenIndex:l}},N$=function(t,e,i,n){var r=n;return t.forEach((function(t,n){var a;r=e(t,n,i,r),(null===(a=t.children)||void 0===a?void 0:a.length)&&(r=N$(t.children,e,t,r))})),n},U$=function(t,e,i,n){var r=n;return t.forEach((function(t,n){var a;(null===(a=t.children)||void 0===a?void 0:a.length)&&(r=U$(t.children,e,t,r)),r=e(t,n,i,r)})),r},j$=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=(null==i?void 0:i.maxDepth)>=0;return t.forEach((function(t){(!n||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(n&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):j$(t.children,e,i)))})),e};function V$(t,e){var i,n;if(Y$(e,t))return[e];for(i=0;i<t.length;++i)if(W$(e,t[i])&&Y$(K$(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(n=i+1;n<t.length;++n)if(W$(K$(t[i],t[n]),e)&&W$(K$(t[i],e),t[n])&&W$(K$(t[n],e),t[i])&&Y$(q$(t[i],t[n],e),t))return[t[i],t[n],e];Wt.getInstance().error("error when packEncloseRandom")}function W$(t,e){var i=t.radius-e.radius,n=e.x-t.x,r=e.y-t.y;return i<0||i*i<n*n+r*r}function G$(t,e){var i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function Y$(t,e){for(var i=0;i<e.length;++i)if(!G$(t,e[i]))return!1;return!0}function X$(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,radius:t.radius}}(t[0]);case 2:return K$(t[0],t[1]);case 3:return q$(t[0],t[1],t[2])}}function K$(t,e){var i=t.x,n=t.y,r=t.radius,a=e.x,o=e.y,s=e.radius,l=a-i,u=o-n,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(i+a+l/h*c)/2,y:(n+o+u/h*c)/2,radius:(h+r+s)/2}}function q$(t,e,i){var n=t.x,r=t.y,a=t.radius,o=e.x,s=e.y,l=e.radius,u=i.x,c=i.y,h=i.radius,d=n-o,p=n-u,f=r-s,v=r-c,g=l-a,y=h-a,m=n*n+r*r-a*a,_=m-o*o-s*s+l*l,b=m-u*u-c*c+h*h,x=p*f-d*v,k=(f*b-v*_)/(2*x)-n,S=(v*g-f*y)/x,A=(p*_-d*b)/(2*x)-r,C=(d*y-p*g)/x,M=S*S+C*C-1,w=2*(a+k*S+A*C),T=k*k+A*A-a*a,D=-(Math.abs(M)>1e-6?(w+Math.sqrt(w*w-4*M*T))/(2*M):T/w);return{x:n+k+S*D,y:r+A+C*D,radius:D}}function Z$(t,e,i){var n,r,a,o,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(r=e.radius+i.radius,r*=r,o=t.radius+i.radius,r>(o*=o)?(n=(u+o-r)/(2*u),a=Math.sqrt(Math.max(0,o/u-n*n)),i.x=t.x-n*s-a*l,i.y=t.y-n*l+a*s):(n=(u+r-o)/(2*u),a=Math.sqrt(Math.max(0,r/u-n*n)),i.x=e.x+n*s-a*l,i.y=e.y+n*l+a*s)):(i.x=e.x+i.radius,i.y=e.y)}function J$(t,e){var i=t.radius+e.radius-1e-6,n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function Q$(t){var e=t._,i=t.next._,n=e.radius+i.radius,r=(e.x*i.radius+i.x*e.radius)/n,a=(e.y*i.radius+i.y*e.radius)/n;return r*r+a*a}function $$(t){return{_:t,next:null,prev:null}}function t0(t,e){var i=(t=Dt(t)).length;if(!i)return 0;var n=t[0];if(n.x=0,n.y=0,1===i)return n.radius;var r=t[1];if(n.x=-r.radius,r.x=n.radius,r.y=0,2===i)return n.radius+r.radius;var a=t[2];Z$(r,n,a);var o,s,l,u,c,h,d,p=$$(n),f=$$(r),v=$$(a);p.next=f,v.prev=f,f.next=v,p.prev=v,v.next=p,f.prev=p;for(var g=3;g<i;++g){d=!1,a=t[g],Z$(p._,f._,a),v=$$(a),o=f.next,s=p.prev,l=f._.radius,u=p._.radius;do{if(l<=u){if(J$(o._,v._)){f=o,p.next=f,f.prev=p,--g,d=!0;break}l+=o._.radius,o=o.next}else{if(J$(s._,v._)){(p=s).next=f,f.prev=p,--g,d=!0;break}u+=s._.radius,s=s.prev}}while(o!==s.next);if(!d){for(v.prev=p,v.next=f,p.next=f.prev=f=v,c=Q$(p),v=v.next;v!==f;)(h=Q$(v))<c&&(p=v,c=h),v=v.next;f=p.next}}var y=[f._];for(v=f.next;v!==f;)y.push(v._),v=v.next;a=function(t,e){for(var i,n,r=0,a=It(Array.from(t),e),o=a.length,s=[];r<o;)i=a[r],n&&G$(n,i)?++r:(n=X$(s=V$(s,i)),r=0);return n}(y,e);for(var m=0;m<i;++m)(n=t[m]).x-=a.x,n.y-=a.y;return a.radius}function e0(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function i0(t,e,i){return function(n){var r=null==n?void 0:n.children;if(r){var a,o=r.length,s=t(n)*e||0;if(s)for(a=0;a<o;++a)r[a].radius+=s;var l=t0(r,i);if(s)for(a=0;a<o;++a)r[a].radius-=s;n.radius=l+s}}}function n0(t,e){return function(i,n,r){i.radius*=t,i.maxDepth=e,r&&(i.x=r.x+t*i.x,i.y=r.y+t*i.y)}}var r0=function(){function t(e){r(this,t),this.options=e;var i=null==e?void 0:e.nodeKey,n=U(i)?i:i?Re(i):null;this._getNodeKey=n,this._getPadding=$(null==e?void 0:e.padding)?function(t){return e.padding}:Z(null==e?void 0:e.padding)?function(t){var i;return null!==(i=e.padding[t.depth+1])&&void 0!==i?i:0}:function(){return 0},this._maxDepth=-1}return o(t,[{key:"layout",value:function(e,i){var n,r="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};if(!e||!e.length)return[];var a=[],o=H$(e,a,0,-1,null,this._getNodeKey);this._maxDepth=o.maxDepth;var s=De(),l={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:o.sum,datum:null,children:a,x:r.x0+r.width/2,y:r.y0+r.height/2},u=null!==(n=this.options)&&void 0!==n?n:{},c=u.nodeSort,h=u.setRadius,d=u.padding,p=u.includeRoot;if(!1!==c){var f=U(c)?this.options.nodeKey:t.defaultOpionts.nodeSort;N$([l],(function(t){t.children&&t.children.length&&t.children.sort(f)}))}if(h)N$([l],e0(h)),U$([l],i0(this._getPadding,.5,s)),N$([l],n0(1,this._maxDepth));else{var v=Math.min(r.width,r.height);N$([l],e0(t.defaultOpionts.setRadius)),U$([l],i0(Fe,1,s)),d&&U$([l],i0(this._getPadding,l.radius/v,s)),N$([l],n0(v/(2*l.radius),this._maxDepth))}return p?[l]:a}}])}();r0.defaultOpionts={setRadius:function(t){return Math.sqrt(t.value)},padding:0,nodeSort:function(t,e){return e.value-t.value}};var a0=function(t){var e=0;return t.forEach((function(t,i){var n;j(t.value)&&((null===(n=t.children)||void 0===n?void 0:n.length)?t.value=a0(t.children):t.value=0),e+=Math.abs(t.value)})),e};function o0(t,e){var i=[],n=[],r={},a={},o=[];return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;a0(t);var a=function(t,o,s){t.forEach((function(t,l){var u=e?e(t):s?"".concat(s[s.length-1].key,"-").concat(l):"".concat(o,"-").concat(l),c=j(t.value)?0:Ae(t.value);if(n[u])n[u].value=void 0;else{var h={depth:o,datum:t,index:l,key:u,value:c,sourceLinks:[],targetLinks:[]};n[u]=h,i.push(h)}s&&r&&r.push({source:s[s.length-1].key,target:u,value:c,parents:s}),t.children&&t.children.length&&a(t.children,o+1,s?s.concat([n[u]]):[n[u]])}))};a(t,0,null)}(t,e,i,r,o),o.forEach((function(t,e){var i="".concat(t.source,"-").concat(t.target),o=bt(t,["parents"]);if(o.parents=t.parents.map((function(t){return bt(t,["sourceLinks","targetLinks"])})),a[i])return a[i].value+=Ae(t.value),void a[i].datum.push(o);var s={index:e,key:"".concat(t.source,"-").concat(t.target),source:t.source,target:t.target,datum:[o],value:t.value,parents:t.parents.map((function(t){return t.key}))};n.push(s),r[t.source].sourceLinks.push(s),r[t.target].targetLinks.push(s),a[i]=s})),{nodes:i,links:n,nodeMap:r}}function s0(t){return t.depth}function l0(t,e){return e-1-t.endDepth}var u0=function(t,e){return(null==t?void 0:t.y0)-(null==e?void 0:e.y0)},c0=function(t,e){if(j(t.value))return null;var i=(e?t.targetLinks:t.sourceLinks).reduce((function(t,e){return j(e.value)?t.count+=1:t.sum+=e.value,t}),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},h0={left:s0,right:l0,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?Pt(t.sourceLinks.map((function(t){return i[t.target].depth})))-1:0},start:s0,end:l0},d0=pe(0,1),p0=function(){return o((function t(e){var i=this;r(this,t),this._ascendingSourceBreadth=function(t,e){return u0(i._nodeMap[t.source],i._nodeMap[e.source])||t.index-e.index},this._ascendingTargetBreadth=function(t,e){return u0(i._nodeMap[t.target],i._nodeMap[e.target])||t.index-e.index},this.options=Object.assign({},t.defaultOptions,e);var n=this.options.nodeKey,a=U(n)?n:n?Re(n):null;this._getNodeKey=a,this._logger=Wt.getInstance(),this._alignFunc=U(this.options.setNodeLayer)?function(t){return i.options.setNodeLayer(t.datum)}:h0[this.options.nodeAlign]}),[{key:"layout",value:function(t,e){var i=this;if(!t)return null;var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};"vertical"===this.options.direction?this._viewBox={x0:n.y0,x1:n.y1,y0:n.x0,y1:n.x1,width:n.height,height:n.width}:this._viewBox=n;var r=this.computeNodeLinks(t),a=r.nodes,o=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(a),this.computeNodeDepths(a),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(a),this._maxDepth<=0)return null;var s=this.computeNodeBreadths(a);if(this.computeLinkBreadths(a),a.forEach((function(t){t.sourceLinks=t.sourceLinks.filter((function(t){return!j(t.source)&&!j(t.target)})),t.targetLinks=t.targetLinks.filter((function(t){return!j(t.source)&&!j(t.target)}))})),o=o.filter((function(t){return!j(t.source)&&!j(t.target)})),"vertical"===this.options.direction)if(this.options.inverse){var l=this._viewBox.x1;a.forEach((function(t){var e=t.y0,i=t.y1,n=t.x0,r=t.x1;t.y0=l-r,t.y1=l-n,t.x0=e,t.x1=i})),o.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1,n=t.y0,r=t.y1;t.x0=n,t.x1=r,t.y0=l-e,t.y1=l-i}))}else a.forEach((function(t){var e=t.y0,i=t.y1;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i})),o.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i}));else this.options.inverse&&(a.forEach((function(t){var e=t.x0,i=t.x1;t.x0=n.x1-i,t.x1=n.x1-e})),o.forEach((function(t){t.x0=n.x1-t.x0,t.x1=n.x1-t.x1})));return o.forEach((function(t){var e=i._nodeMap[t.source],n=i._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:n.x0,x1:n.x1,y1:n.y1,y0:n.y0}})),{nodes:a,links:o,columns:s}}},{key:"computeHierarchicNodeLinks",value:function(t){return o0(t,this._getNodeKey)}},{key:"computeSourceTargetNodeLinks",value:function(t){var e=this,i=[],n=[],r={};t.nodes&&t.nodes.forEach((function(t,n){var a={depth:-1,datum:t,index:n,key:e._getNodeKey?e._getNodeKey(t):n,value:t.value,sourceLinks:[],targetLinks:[]};r[a.key]=a,i.push(a)}));var a=[];return t.links.forEach((function(o,s){var l=!j(o.source),u=!j(o.target);if(!t.nodes||r[o.source]&&r[o.target]){t.nodes||!l||r[o.source]||(r[o.source]={value:void 0,depth:-1,index:i.length,key:o.source,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[o.source])),t.nodes||!u||r[o.target]||(r[o.target]={value:void 0,depth:-1,index:i.length,key:o.target,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[o.target]));var c={index:s,source:o.source,target:o.target,datum:o,value:o.value};e.options.divideNodeValueToLink&&j(o.value)&&a.push(c),n.push(c),l&&r[o.source].sourceLinks.push(c),u&&r[o.target].targetLinks.push(c)}})),this.options.divideNodeValueToLink&&a.length&&a.forEach((function(t){var e=[c0(r[t.source]),c0(r[t.target],!0)].filter((function(t){return!j(t)}));e.length&&(t.value=Pt(e))})),{nodeMap:r,nodes:i,links:n}}},{key:"computeNodeLinks",value:function(t){var e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));var i=e.nodes,n=e.links;if(this.options.linkSortBy)for(var r=0,a=i.length;r<a;r++)i[r].sourceLinks.sort(this.options.linkSortBy),i[r].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter((function(t){return t.targetLinks.length||t.sourceLinks.length}))),{nodes:i,links:n,nodeMap:e.nodeMap}}},{key:"computeNodeValues",value:function(t){return function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.value=Math.max(j(n.value)?0:Ae(n.value),n.sourceLinks.reduce((function(t,e){var i;return t+(null!==(i=Ae(e.value))&&void 0!==i?i:0)}),0),n.targetLinks.reduce((function(t,e){var i;return t+(null!==(i=Ae(e.value))&&void 0!==i?i:0)}),0))}}(t)}},{key:"computeNodeDepths",value:function(t){for(var e,i,n,r=t.length,a=t,o=0,s=-1,l=U(this.options.setNodeLayer)?this.options.setNodeLayer:null;a.length&&o<r;){i=[],n={};for(var u=0,c=a.length;u<c;u++){var h=a[u];if(h&&(h.depth=l&&null!==(e=l(h.datum))&&void 0!==e?e:o,l&&(s=Math.max(h.depth,s)),h.sourceLinks&&h.sourceLinks.length))for(var d=0,p=h.sourceLinks.length;d<p;d++){var f=h.sourceLinks[d];n[f.target]||(i.push(this._nodeMap[f.target]),n[f.target]=!0)}}a=i,o+=1}o>r&&this._logger.warn("Error: there is a circular link"),this._maxDepth=l?s+1:o}},{key:"computeNodeEndDepths",value:function(t){for(var e,i,n=t.length,r=t,a=0;r.length&&a<n;){e=[],i={};for(var o=0,s=r.length;o<s;o++){var l=r[o];if(l){l.endDepth=a;for(var u=0,c=l.targetLinks.length;u<c;u++){var h=l.targetLinks[u];i[h.source]||(e.push(this._nodeMap[h.source]),i[h.source]=!0)}}}r=e,a+=1}a>n&&this._logger.warn("Error: there is a circular link")}},{key:"computeNodeLayers",value:function(t){var e=this.options.nodeWidth,i=this.options.linkWidth,n=this.options.minStepWidth,r=this._viewBox.width,a=null,o=null,s=!1;if(q(e)){var l=he(parseFloat(e.replace("%",""))/100,0,1),u=r/(this._maxDepth-1+l);n>0&&(u=Math.max(n,u)),a=u*l,o=u*(1-l),s=!0}else if($(e)){if(a=e,$(i))o=i;else if(j(i)){var c=(r-e)/(this._maxDepth-1);n>0&&(c=Math.max(n,c)),o=c-e}s=!0}else U(e)&&$(i)&&(o=i);for(var h=[],d=0,p=t.length;d<p;d++){var f=t[d];f.layer=this._isHierarchic?f.depth:he(Math.floor(this._alignFunc(f,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);var v=f.layer;v===this._maxDepth-1&&(f.isLastLayer=!0),s&&(f.x0=this._viewBox.x0+v*(a+o),f.x1=f.x0+a),h[v]?h[v].push(f):h[v]=[f]}if(this.options.nodeSortBy)for(var g=0,y=h.length;g<y;g++)h[g].sort(this.options.nodeSortBy);if(!s&&U(e))for(var m=this._viewBox.x0,_=0;_<this._maxDepth;_++){for(var b=h[_],x=0,k=0,S=0,A=b&&b.length;S<A;S++){var C=b[S],M=e(C);C.x0=m,C.x1=m+M,x=Math.max(a,M);for(var w=C.sourceLinks,T=0,D=w.length;T<D;T++){var E=w[T],B=U(i)?i(E,this._viewBox):o;k=Math.max(k,B)}}m+=x+k}return h}},{key:"initializeNodeBreadths",value:function(t){var e,i,n,r=this,a=null!==(e=this.options.minLinkHeight)&&void 0!==e?e:0,o=null!==(i=this.options.minNodeHeight)&&void 0!==i?i:0,s=null!==(n=this.options.maxNodeHeight)&&void 0!==n?n:1/0,l=this.options.maxLinkHeight;(j(o)||o<a)&&(o=a),(j(l)||l>s)&&(l=s);var u=0,c=null,h=null;if(U(this.options.nodeGap))c=this.options.nodeGap,u=t.reduce((function(t,e){var i=e.reduce((function(t,e){return t+e.value}),0),n=e.reduce((function(t,e){return t+r.options.nodeGap(e)}),0);return Math.min(t,(r._viewBox.height-n)/i)}),1/0);else{var d=t.reduce((function(t,e){return Math.max(t,e.length)}),0),p=this._viewBox.height/d,f=Math.min(this.options.nodeGap,p);if(o+f>p&&(f=o>=p?p/2:(p-o)/2,o=Math.min(p-f,o)),c=function(){return f},this._gapY=f,this.options.equalNodeHeight)h=this._viewBox.height/d-f;else{var v=o>0?Math.max(f,o):f;u=t.reduce((function(t,e){var i=e.reduce((function(t,e){return t+e.value}),0);return Math.min(t,(r._viewBox.height-((e.length-1)*v+o))/i)}),1/0)}}for(var g="start"===this.options.gapPosition,y=!g&&"end"!==this.options.gapPosition,m=$(this.options.nodeHeight)?function(t){return r.options.nodeHeight}:U(this.options.nodeHeight)?this.options.nodeHeight:h>0?function(t){return h}:function(t){return Math.max(t.value*u,0)},_=$(this.options.linkHeight)?function(){return r.options.linkHeight}:U(this.options.linkHeight)?this.options.linkHeight:function(t,e,i){return Math.min(Math.max(e.value?i*d0(t.value/e.value):0,a,0),l)},b=function(){var e=t[x];if(!e||!e.length)return 1;for(var i=r._viewBox.y0,n=0,a=0,l=0,u=0,h=e.length;u<h;u++){var d=e[u];n=c(d),g&&(i+=n),l=m(d),a=Math.min(Math.max(l,o),s),d.y0=i,d.y1=i+a,i=g?d.y1:d.y1+n;for(var p=0,f=d.sourceLinks.length;p<f;p++){var v=d.sourceLinks[p];v.thickness=_(v,d,l)}}var b=r._viewBox.y1-i+(y?n:0);if(b>0)if("start"===r.options.crossNodeAlign);else if("end"===r.options.crossNodeAlign)for(var k=0,S=e.length;k<S;++k){var A=e[k];A.y0+=b,A.y1+=b}else if("parent"===r.options.crossNodeAlign){var C=e.reduce((function(t,e){return e.targetLinks&&e.targetLinks.length&&e.targetLinks.forEach((function(e){t[e.source]=!0})),t}),{});if(Object.keys(C).length&&t[x-1]&&t[x-1].length){var M=t[x-1].filter((function(t){return C[t.key]}));if(M&&M.length&&M[0].y0!==e[0].y0)for(var w=M[0].y0-e[0].y0,T=0,D=e.length;T<D;++T){var E=e[T];E.y0+=w,E.y1+=w}}}else{b/=e.length+1;for(var B=0,P=e.length;B<P;++B){var R=e[B];R.y0+=b*(B+1),R.y1+=b*(B+1)}}else if(b<0&&e.length>1&&n+(b/=e.length-1)>=0){n+=b,r._gapY=Math.min(n);for(var L=1,I=e.length;L<I;++L){var F=e[L];F.y0+=b*L,F.y1+=b*L}}r.reorderLinks(e)},x=0,k=t.length;x<k;x++)b()}},{key:"computeNodeBreadths",value:function(t){var e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);var i=this.options.iterations;if(!this._isHierarchic&&!U(this.options.setNodeLayer)&&!U(this.options.nodeGap))for(var n=0;n<i;++n){var r=Math.pow(.99,n),a=Math.max(1-r,(n+1)/i);this.relaxRightToLeft(e,r,a),this.relaxLeftToRight(e,r,a)}return e}},{key:"relaxLeftToRight",value:function(t,e,i){for(var n=1,r=t.length;n<r;++n){for(var a=t[n],o=0,s=a.length;o<s;o++){for(var l=a[o],u=0,c=0,h=0,d=l.targetLinks.length;h<d;h++){var p=l.targetLinks[h],f=p.value*(l.layer-this._nodeMap[p.source].layer);u+=this.targetTop(this._nodeMap[p.source],l)*f,c+=f}if(c>0){var v=(u/c-l.y0)*e;l.y0+=v,l.y1+=v,this.reorderNodeLinks(l)}}j(this.options.nodeSortBy)&&a.sort(u0),this.resolveCollisions(a,i)}}},{key:"relaxRightToLeft",value:function(t,e,i){for(var n=t.length-2;n>=0;--n){for(var r=t[n],a=0,o=r.length;a<o;a++){for(var s=r[a],l=0,u=0,c=0,h=s.sourceLinks.length;c<h;c++){var d=s.sourceLinks[c],p=d.value*(this._nodeMap[d.target].layer-s.layer);l+=this.sourceTop(s,this._nodeMap[d.target])*p,u+=p}if(u>0){var f=(l/u-s.y0)*e;s.y0+=f,s.y1+=f,this.reorderNodeLinks(s)}}void 0===this.options.nodeSortBy&&r.sort(u0),this.resolveCollisions(r,i)}}},{key:"resolveCollisions",value:function(t,e){var i=t.length>>1,n=t[i];this.resolveCollisionsBottomToTop(t,n.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,n.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}},{key:"resolveCollisionsTopToBottom",value:function(t,e,i,n){for(;i<t.length;++i){var r=t[i],a=(e-r.y0)*n;a>1e-6&&(r.y0+=a,r.y1+=a),e=r.y1+this._gapY}}},{key:"resolveCollisionsBottomToTop",value:function(t,e,i,n){for(;i>=0;--i){var r=t[i],a=(r.y1-e)*n;a>1e-6&&(r.y0-=a,r.y1-=a),e=r.y0-this._gapY}}},{key:"targetTop",value:function(t,e){var i,n,r,a=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)a+=r.thickness+this._gapY;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)a-=r.thickness;return a}},{key:"sourceTop",value:function(t,e){var i,n,r,a=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)a+=r.thickness+this._gapY;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)a-=r.thickness;return a}},{key:"computeLinkBreadthsNoOverlap",value:function(t){for(var e=0,i=t.length;e<i;e++){for(var n=t[e],r=n.y0,a=!1,o=0,s=n.sourceLinks.length;o<s;o++){var l=n.sourceLinks[o];a||(l.y0=r+l.thickness/2),l.x0=n.x1,r+l.thickness>n.y1||a?(l.y0=n.y1-l.thickness/2,a=!0):r+=l.thickness}var u=n.y0;a=!1;for(var c=0,h=n.targetLinks.length;c<h;c++){var d=n.targetLinks[c];a||(d.y1=u+d.thickness/2),d.x1=n.x0,u+d.thickness>n.y1||a?(d.y1=n.y1-d.thickness/2,a=!0):u+=d.thickness}}}},{key:"computeLinkBreadthsOverlap",value:function(t){for(var e=this.options.linkOverlap,i=0,n=t.length;i<n;i++){for(var r=t[i],a="start"===e?r.y0:"end"===e?r.y1:(r.y0+r.y1)/2,o="start"===e?.5:"end"===e?-.5:0,s=0,l=r.sourceLinks.length;s<l;s++){var u=r.sourceLinks[s];u.y0=a+o*u.thickness,u.x0=r.x1}for(var c=0,h=r.targetLinks.length;c<h;c++){var d=r.targetLinks[c];d.y1=a+o*d.thickness,d.x1=r.x0}}}},{key:"computeLinkBreadths",value:function(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}},{key:"reorderNodeLinks",value:function(t){if(j(this.options.linkSortBy)){for(var e=t.targetLinks,i=t.sourceLinks,n=0,r=e.length;n<r;n++){var a=e[n];this._nodeMap[a.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(var o=0,s=i.length;o<s;o++){var l=i[o];this._nodeMap[l.target].targetLinks.sort(this._ascendingSourceBreadth)}}}},{key:"reorderLinks",value:function(t){if(j(this.options.linkSortBy))for(var e=0,i=t.length;e<i;e++){var n=t[e];n.sourceLinks.sort(this._ascendingTargetBreadth),n.targetLinks.sort(this._ascendingSourceBreadth)}}}])}();p0.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};var f0=function(t){return t.sourceLinks&&t.sourceLinks.length?!j(t.sourceLinks[0].x0):!(!t.targetLinks||!t.targetLinks.length||j(t.targetLinks[0].x0))},v0=function(t,e){var i=new p0(t).layout(Array.isArray(e)?e[0]:e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});return i?[i]:[]};function g0(t,e,i,n,r){for(var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x0:"x0",x1:"x1",y0:"y0",y1:"y1"},s=t.children,l=-1,u=s.length,c=t.value&&(n-e)/t.value;++l<u;)(a=s[l])[o.y0]=i,a[o.y1]=r,a[o.x0]=e,a[o.x1]=e+=a.value*c}var y0={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"},m0=function(){return o((function t(e){var i=this;r(this,t),this._layoutNode=function(t){if(t.maxDepth=i._maxDepth,t.children){var e=i._parsedInnerRadius[t.depth+1],n=i._parsedOutterRadius[t.depth+1];g0(t,t.startAngle,Math.min(e,n),t.endAngle,Math.max(e,n),y0);var r=Z(i.options.label)?i.options.label[t.depth+1]:i.options.label;t.children.forEach((function(t){if(t.x=i._parsedCenter[0],t.y=i._parsedCenter[1],r)return i._layoutLabel(t,N(r)?{align:"center",rotate:"radial"}:r)}))}},this.options=e?Object.assign({},t.defaultOpionts,e):Object.assign({},t.defaultOpionts);var n=this.options.nodeKey,a=U(n)?n:n?Re(n):null;this._getNodeKey=a,this._maxDepth=-1}),[{key:"_parseRadius",value:function(t,e){var i=this,n=t.x0+Ie(this.options.center[0],t.width),r=t.y0+Ie(this.options.center[1],t.height),a=Math.min(t.width/2,t.height/2),o=this.options.innerRadius,s=this.options.outerRadius,l=Z(o),u=l?o.map((function(t){return Ie(t,a)})):Ie(o,a),c=Z(s),h=this.options.gapRadius,d=c?s.map((function(t){return Ie(t,a)})):Ie(s,a),p=Ot(0,e+1);if(l)this._parsedInnerRadius=p.map((function(t,e){var i=u[e];return j(i)?a:i})),this._parsedOutterRadius=p.map((function(t,n){var r,o;return c?null!==(r=d[n])&&void 0!==r?r:a:n<e?i._parsedInnerRadius[n+1]-(Z(h)?null!==(o=h[n])&&void 0!==o?o:0:h):d}));else if(c)this._parsedOutterRadius=p.map((function(t,e){return j(d[e])?a:d[e]})),this._parsedInnerRadius=p.map((function(t,e){var n;return 0===e?u:i._parsedOutterRadius[e-1]-(Z(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}));else{var f=Ie(o,a),v=(d-f)/(e+1);this._parsedInnerRadius=p.map((function(t,e){return f+e*v})),this._parsedOutterRadius=p.map((function(t,e){var n;return i._parsedInnerRadius[e]+v-(Z(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}))}this._parsedCenter=[n,r],this._maxRadius=a}},{key:"layout",value:function(t,e){var i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];var n=[],r=H$(t,n,0,-1,null,this._getNodeKey);return this._parseRadius(i,r.maxDepth),this._maxDepth=r.maxDepth,this._layout(n,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:r.sum,datum:null,children:n,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),n}},{key:"_layout",value:function(t,e){var i=this;this._layoutNode(e),t.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t.children,t):i._layoutNode(t)}))}},{key:"_layoutLabel",value:function(t,e){var i,n=(t.startAngle+t.endAngle)/2,r=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!==(i=e.offset)&&void 0!==i?i:0),a=Pi({x:this._parsedCenter[0],y:this._parsedCenter[1]},r,n);if(t.label={x:a.x,y:a.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=n-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*r;else{var o=n%(2*Math.PI),s=o<0?o+2*Math.PI:o;s>Math.PI/2&&s<1.5*Math.PI?(t.label.angle=s+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=s,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}])}();m0.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};var _0=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=(null==i?void 0:i.maxDepth)>=0;return t.forEach((function(t){(!n||t.depth<=i.maxDepth-1)&&t.children&&t.children.forEach((function(n){var r,a={source:t,target:n,x0:t.x,y0:t.y,x1:n.x,y1:n.y,key:"".concat(t.key,"~").concat(n.key)};e.push((null==i?void 0:i.callback)?i.callback(a):a),(null===(r=n.children)||void 0===r?void 0:r.length)&&_0([n],e,i)}))})),e};function b0(t,e){return t.parentKey===e.parentKey?1:2}function x0(t,e,i,n){var r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:b0,o=0;if(U$([t],(function(t){var e=t.children;e?(t.x=function(t){return t.reduce((function(t,e){return t+e.x}),0)/t.length}(e),t.y=function(t){return 1+t.reduce((function(t,e){return Math.max(t,e.y)}),0)}(e)):(t.x=r?o+=a(t,r):0,t.y=0,r=t)})),$(i)&&$(n))U$([t],(function(r){r.x=e.x0+(r.x-t.x)*i,r.y=e.y0+(t.y-r.y)*n}));else{var s=function(t){for(var e=t.children;e;)e=(t=e[0]).children;return t}(t),l=function(t){for(var e=t.children;e;)e=(t=e[e.length-1]).children;return t}(t),u=s.x-a(s,l)/2,c=l.x+a(l,s)/2,h=$(i)?i:e.width/(c-u);U$([t],(function(i){i.x=e.x0+(i.x-u)*h,i.y=e.y0+(1-(t.y?i.y/t.y:1))*e.height}))}return t}function k0(t,e){return t.parentKey===e.parentKey?1:2}function S0(t){var e=t.children;return e?e[0]:t.t}function A0(t){var e=t.children;return e?e[e.length-1]:t.t}function C0(t,e,i){var n=i/(e.i-t.i);e.c-=n,e.s+=i,t.c+=n,e.z+=i,e.m+=i}function M0(t,e,i){var n,r=null!==(n=t.a)&&void 0!==n?n:t;return r.parent===e.parent?r:i}function w0(t,e){return{_:t,i:e,parent:null,A:null,a:null,z:0,m:0,c:0,s:0,t:null}}function T0(t,e,i,n){var r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:k0,o=function(t){for(var e,i,n,r,a=w0(t,0),o=[a],s=o.pop();s;){if(i=s._.children)for(r=i.length,s.children=new Array(r),n=r-1;n>=0;--n)e=w0(i[n],n),s.children[n]=e,o.push(e),e.parent=s;s=o.pop()}return a.parent=w0(null,0),a.parent.children=[a],a}(t);if(U$([o],(function(t){var e=t.children,i=t.parent.children,n=t.i?i[t.i-1]:null;if(e){!function(t){for(var e,i=0,n=0,r=t.children,a=r.length;--a>=0;)(e=r[a]).z+=i,e.m+=i,i+=e.s+(n+=e.c)}(t);var r=(e[0].z+e[e.length-1].z)/2;n?(t.z=n.z+a(t._,n._),t.m=t.z-r):t.z=r}else n&&(t.z=n.z+a(t._,n._));t.parent.A=function(t,e,i){if(e){var n,r=t,o=t,s=e,l=r.parent.children[0],u=r.m,c=o.m,h=s.m,d=l.m;for(s=A0(s),r=S0(r);s&&r;)l=S0(l),(o=A0(o)).a=t,(n=s.z+h-r.z-u+a(s._,r._))>0&&(C0(M0(s,t,i),t,n),u+=n,c+=n),h+=s.m,u+=r.m,d+=l.m,c+=o.m,s=A0(s),r=S0(r);s&&!A0(o)&&(o.t=s,o.m+=h-c),r&&!S0(l)&&(l.t=r,l.m+=u-d,i=t)}return i}(t,n,t.parent.A||i[0])})),o.parent.m=-o.z,N$([o],(function(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m})),$(n))r=function(t){return t.depth*n};else if(Z(n)&&n.length){var s=n.reduce((function(t,e,i){return t[i]=0===i?e:t[i-1]+e,t}),[]);r=function(t){var e;return null!==(e=s[t.depth])&&void 0!==e?e:s[s.length-1]}}if($(i)&&r)N$([t],(function(t){t.x=e.x0+e.width/2+t.x*i,t.y=e.y0+r(t)}));else{var l=t,u=t,c=t;N$([t],(function(t){t.x<l.x&&(l=t),t.x>u.x&&(u=t),t.depth>c.depth&&(c=t)}));var h=l===u?1:a(l,u)/2,d=h-l.x,p=$(i)?i:e.width/(u.x+h+d),f=e.height/(c.depth||1);N$([t],(function(t){t.x=e.x0+(t.x+d)*p,t.y=e.y0+(r?r(t):t.depth*f)}))}return t}var D0=function(){return o((function t(e){r(this,t),this.options=Object.assign({},t.defaultOpionts,e);var i=null==e?void 0:e.nodeKey,n=U(i)?i:i?Re(i):null;this._getNodeKey=n,this._maxDepth=-1}),[{key:"layout",value:function(t,e){var i=this,n=Dt(t);if(!n.length)return[];var r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},a=[],o=H$(n,a,0,-1,null,this._getNodeKey);this._maxDepth=o.maxDepth;var s=["vertical","TB","BT"].includes(this.options.direction),l="radial"===this.options.layoutType?{x0:0,y0:0,x1:2*Math.PI,y1:Math.min(r.width,r.height)/2,width:2*Math.PI,height:Math.min(r.width,r.height)/2}:s?r:{x0:r.y0,y0:r.x0,x1:r.y1,y1:r.x1,width:r.height,height:r.width};if("leaf"===this.options.alignType?x0(a[0],l,this.options.minNodeGap,this.options.linkWidth):T0(a[0],l,this.options.minNodeGap,this.options.linkWidth),"radial"===this.options.layoutType){var u={x:(r.x0+r.x1)/2,y:(r.y0+r.y1)/2};N$(a,(function(t){var e=t.x,n=t.y,r=Pi(u,n,e);t.x=r.x,t.y=r.y,t.maxDepth=i._maxDepth}))}else["BT","RL"].includes(this.options.direction)?N$(a,(function(t){t.y=l.y0+l.y1-t.y,t.maxDepth=i._maxDepth})):N$(a,(function(t){t.maxDepth=i._maxDepth})),s||N$(a,(function(t){var e=[t.y,t.x];t.x=e[0],t.y=e[1]}));return a}}])}();D0.defaultOpionts={direction:"horizontal",alignType:"depth",layoutType:"orthogonal"};function E0(t,e,i,n,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-i)/t.value;++s<l;)(a=o[s]).x0=e,a.x1=n,a.y0=i,i+=a.value*u,a.y1=i}var B0=function(t){return function(e,i,n,r,a){!function(t,e,i,n,r,a){for(var o,s,l,u,c,h,d,p,f,v,g,y=[],m=e.children,_=0,b=0,x=m.length,k=e.value;_<x;){l=r-i,u=a-n;do{c=m[b++].value}while(!c&&b<x);for(h=c,d=c,g=c*c*(v=Math.max(u/l,l/u)/(k*t)),f=Math.max(d/g,g/h);b<x;++b){if((s=m[b].value)<h&&(h=s),s>d&&(d=s),g=(c+=s)*c*v,(p=Math.max(d/g,g/h))>f){c-=s;break}f=p}o=Object.assign({},e,{value:c,children:m.slice(_,b)}),y.push(o),l<u?g0(o,i,n,r,k?n+=u*c/k:a):E0(o,i,n,k?i+=l*c/k:r,a),k-=c,_=b}}(t,e,i,n,r,a)}},P0={binary:function(t,e,i,n,r){var a=t.children,o=a.length,s=0,l=new Array(o+1);l[0]=0;for(var u=0;u<o;++u)s+=a[u].value,l[u+1]=s;var c=function(t,e,i,n,r,o,s){if(t>=e-1){var u=a[t];return u.x0=n,u.y0=r,u.x1=o,void(u.y1=s)}for(var h=l[t],d=i/2+h,p=t+1,f=e-1;p<f;){var v=p+f>>>1;l[v]<d?p=v+1:f=v}d-l[p-1]<l[p]-d&&t+1<p&&--p;var g=l[p]-h,y=i-g;if(o-n>s-r){var m=i?(n*y+o*g)/i:o;c(t,p,g,n,r,m,s),c(p,e,y,m,r,o,s)}else{var _=i?(r*y+s*g)/i:s;c(t,p,g,n,r,o,_),c(p,e,y,n,_,o,s)}};c(0,o,t.value,e,i,n,r)},dice:g0,slice:E0,sliceDice:function(t,e,i,n,r){(t.depth%2==1?E0:g0)(t,e,i,n,r)}},R0=function(){return o((function t(e){var i,n=this;r(this,t),this._filterByArea=function(t,e){var i,r=n._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null===(i=t.children)||void 0===i?void 0:i.length){var a=t.children.filter((function(t){return n._filterByArea(t,e)}));a.length?a.length!==t.children.length&&(t.children=a):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=function(t){var e;return t<0?0:null!==(e=Z(n.options.minVisibleArea)?n.options.minVisibleArea[t]:n.options.minVisibleArea)&&void 0!==e?e:0},this._getGapWidthByDepth=function(t){var e;return t<0?0:null!==(e=Z(n.options.gapWidth)?n.options.gapWidth[t]:n.options.gapWidth)&&void 0!==e?e:0},this._getPaddingByDepth=function(t){var e;return t<0?0:null!==(e=Z(n.options.padding)?n.options.padding[t]:n.options.padding)&&void 0!==e?e:0},this._getLabelPaddingByDepth=function(t){var e;return t<0?0:null!==(e=Z(n.options.labelPadding)?n.options.labelPadding[t]:n.options.labelPadding)&&void 0!==e?e:0},this._layoutNode=function(t){var e=n._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,a=t.x1,o=t.y1;if(t.maxDepth=n._maxDepth,e>0&&((i+=e/2)>(a-=e/2)&&(a=i=(i+a)/2),(r+=e/2)>(o-=e/2)&&(o=r=(r+o)/2),t.x0=i,t.x1=a,t.y0=r,t.y1=o),t.children){var s=n._getLabelPaddingByDepth(t.depth),l=n._getPaddingByDepth(t.depth);l>0&&l<Math.min(a-i,o-r)/2&&(r+=l,o-=l,i+=l,a-=l),s>0&&("top"===n.options.labelPosition&&r+s<o?(t.labelRect={x0:i,y0:r,x1:a,y1:r+s},r+=s):"bottom"===n.options.labelPosition&&o-s>r?(t.labelRect={x0:i,y0:o-s,x1:a,y1:o},o-=s):"left"===n.options.labelPosition&&i+s<a?(t.labelRect={x0:i,y0:r,x1:i+s,y1:o},i+=s):"right"===n.options.labelPosition&&a-s>i&&(t.labelRect={x0:a-s,y0:r,x1:a,y1:o},a-=s));var u=n._getGapWidthByDepth(t.depth+1);u>0&&(i-=u/2,a+=u/2,r-=u/2,o+=u/2),n._splitNode(t,i,r,a,o)}},this.options=Object.assign({},t.defaultOpionts,e);var a=this.options.nodeKey,o=U(a)?a:a?Re(a):null;this._getNodeKey=o,this._splitNode="squarify"===this.options.splitType?B0(this.options.aspectRatio):null!==(i=P0[this.options.splitType])&&void 0!==i?i:P0.binary,this._maxDepth=-1}),[{key:"layout",value:function(t,e){var i;if(!t||!t.length)return[];var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},r=[],a=H$(t,r,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=a.maxDepth,a.sum<=0)return[];var o={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:a.sum,datum:null,x0:n.x0,x1:n.x1,y0:n.y0,y1:n.y1,children:r},s=n.width*n.height/a.sum;return this._filterByArea(o,s),this._layout(o),null!==(i=o.children)&&void 0!==i?i:[]}},{key:"_filterChildren",value:function(t){var e=this.options.maxDepth;if($(e)&&e>=0&&t.depth>=e)return!1;var i=this.options.minChildrenVisibleArea;if($(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;var n=this.options.minChildrenVisibleSize;return!$(n)||!(Math.abs(t.x1-t.x0)<n||Math.abs(t.y1-t.y0)<n)}},{key:"_layout",value:function(t){var e,i=this;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null===(e=t.children)||void 0===e?void 0:e.length)&&t.children.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t):i._layoutNode(t)}))}}])}();R0.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};function L0(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+ka?Math.abs(t-e):Yt((function(n){return Ma(t,e,n)-i}),0,t+e)}function I0(t,e){var i,n=(e=e||{}).restarts||10,r=[],a={};for(i=0;i<t.length;++i){var o=t[i];1===o.sets.length&&(a[o.sets[0]]=r.length,r.push(o))}var s=function(t,e,i){var n=ja(e.length,e.length),r=ja(e.length,e.length);return t.filter((function(t){return 2===t.sets.length})).map((function(t){var a=i[t.sets[0]],o=i[t.sets[1]],s=L0(Math.sqrt(e[a].size/Math.PI),Math.sqrt(e[o].size/Math.PI),t.size);n[a][o]=n[o][a]=s;var l=0;t.size+1e-10>=Math.min(e[a].size,e[o].size)?l=1:t.size<=1e-10&&(l=-1),r[a][o]=r[o][a]=l})),{distances:n,constraints:r}}(t,r,a),l=s.distances,u=s.constraints,c=Va(l.map(Va))/l.length;l=l.map((function(t){return t.map((function(t){return t/c}))}));var h,d,p=function(t,e){return function(t,e,i,n){var r,a=0;for(r=0;r<e.length;++r)e[r]=0;for(r=0;r<i.length;++r)for(var o=t[2*r],s=t[2*r+1],l=r+1;l<i.length;++l){var u=t[2*l],c=t[2*l+1],h=i[r][l],d=n[r][l],p=(u-o)*(u-o)+(c-s)*(c-s),f=Math.sqrt(p),v=p-h*h;d>0&&f<=h||d<0&&f>=h||(a+=2*v*v,e[2*r]+=4*v*(o-u),e[2*r+1]+=4*v*(s-c),e[2*l]+=4*v*(u-o),e[2*l+1]+=4*v*(c-s))}return a}(t,e,l,u)};for(i=0;i<n;++i){var f=Ua(2*l.length).map((function(t,e){return we(e)}));d=Ka(p,f,e),(!h||d.fx<h.fx)&&(h=d)}var v=h.x,g={};for(i=0;i<r.length;++i){var y=r[i];g[y.sets[0]]={x:v[2*i]*c,y:v[2*i+1]*c,radius:Math.sqrt(y.size/Math.PI)}}if(e.history)for(i=0;i<e.history.length;++i)Wa(e.history[i].x,c);return g}function F0(t,e){for(var i=0,n=0;n<e.length;++n){var r=e[n],a=void 0;if(1!==r.sets.length){if(2===r.sets.length){var o=t[r.sets[0]],s=t[r.sets[1]];a=Ma(o.radius,s.radius,Si.distancePP(o,s))}else a=Sa(r.sets.map((function(e){return t[e]})));i+=(r.hasOwnProperty("weight")?r.weight:1)*(a-r.size)*(a-r.size)}}return i}function O0(t,e){var i=function(t,e){for(var i=e&&e.lossFunction?e.lossFunction:F0,n={},r={},a=0;a<t.length;++a){var o=t[a];if(1===o.sets.length){var s=o.sets[0];n[s]={x:1e10,y:1e10,size:o.size,radius:Math.sqrt(o.size/Math.PI),setId:s},r[s]=[]}}t=t.filter((function(t){return 2===t.sets.length}));for(var l=0;l<t.length;++l){var u=t[l],c=u.hasOwnProperty("weight")?u.weight:1,h=u.sets[0],d=u.sets[1];u.size+ka>=Math.min(n[h].size,n[d].size)&&(c=0),r[h].push({set:d,size:u.size,weight:c}),r[d].push({set:h,size:u.size,weight:c})}var p=[];for(var f in r)if(r.hasOwnProperty(f)){for(var v=0,g=0;g<r[f].length;++g)v+=r[f][g].size*r[f][g].weight;p.push({set:f,size:v})}function y(t,e){return e.size-t.size}p.sort(y);var m={};function _(t){return t.set in m}function b(t,e){n[e].x=t.x,n[e].y=t.y,m[e]=!0}b({x:0,y:0},p[0].set);for(var x=1;x<p.length;++x){var k=p[x].set,S=r[k].filter(_),A=n[k];if(S.sort(y),0===S.length)throw"ERROR: missing pairwise overlap information";for(var C=[],M=0;M<S.length;++M){var w=n[S[M].set],T=L0(A.radius,w.radius,S[M].size);C.push({x:w.x+T,y:w.y}),C.push({x:w.x-T,y:w.y}),C.push({y:w.y+T,x:w.x}),C.push({y:w.y-T,x:w.x});for(var D=M+1;D<S.length;++D)for(var E=n[S[D].set],B=L0(A.radius,E.radius,S[D].size),P=wa({x:w.x,y:w.y,radius:T},{x:E.x,y:E.y,radius:B}),R=0;R<P.length;++R)C.push(P[R])}for(var L=1e50,I=C[0],F=0;F<C.length;++F){n[k].x=C[F].x,n[k].y=C[F].y;var O=i(n,t);O<L&&(L=O,I=C[F])}b(I,k)}return n}(t,e),n=e.lossFunction||F0;if(t.length>=8){var r=I0(t,e);n(r,t)+1e-8<n(i,t)&&(i=r)}return i}function z0(t,e,i){var n;if(null===i?t.sort((function(t,e){return e.radius-t.radius})):t.sort(i),t.length>0){var r=t[0].x,a=t[0].y;for(n=0;n<t.length;++n)t[n].x-=r,t[n].y-=a}if(2===t.length&&Si.distancePP(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){var o,s,l=Math.atan2(t[1].x,t[1].y)-e,u=Math.cos(l),c=Math.sin(l);for(n=0;n<t.length;++n)o=t[n].x,s=t[n].y,t[n].x=u*o-c*s,t[n].y=c*o+u*s}if(t.length>2){for(var h=Math.atan2(t[2].x,t[2].y)-e;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var d=t[1].y/(1e-10+t[1].x);for(n=0;n<t.length;++n){var p=(t[n].x+d*t[n].y)/(1+d*d);t[n].x=2*p-t[n].x,t[n].y=2*p*d-t[n].y}}}}function H0(t){var e=function(e){return{max:Math.max.apply(null,t.map((function(t){return t[e]+t.radius}))),min:Math.min.apply(null,t.map((function(t){return t[e]-t.radius})))}};return{xRange:e("x"),yRange:e("y")}}function N0(t,e,i){null===e&&(e=Math.PI/2);var n=[];for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];n.push({x:a.x,y:a.y,radius:a.radius,setId:r})}for(var o=function(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}t.map((function(t){t.parent=t}));for(var i=0;i<t.length;++i)for(var n=i+1;n<t.length;++n){var r=t[i].radius+t[n].radius;Si.distancePP(t[i],t[n])+1e-10<r&&(a=t[n],o=t[i],s=void 0,l=void 0,s=e(a),l=e(o),s.parent=l)}for(var a,o,s,l,u,c={},h=0;h<t.length;++h)(u=e(t[h]).parent.setId)in c||(c[u]=[]),c[u].push(t[h]);t.map((function(t){delete t.parent}));var d=[];for(u in c)c.hasOwnProperty(u)&&d.push(c[u]);return d}(n),s=0;s<o.length;++s){z0(o[s],e,i);var l=H0(o[s]);o[s].size=(l.xRange.max-l.xRange.min)*(l.yRange.max-l.yRange.min),o[s].bounds=l}o.sort((function(t,e){return e.size-t.size}));var u=(n=o[0]).bounds,c=(u.xRange.max-u.xRange.min)/50;function h(t,e,i){if(t){var r,a,o,s=t.bounds;e?r=u.xRange.max-s.xRange.min+c:(r=u.xRange.max-s.xRange.max,(o=(s.xRange.max-s.xRange.min)/2-(u.xRange.max-u.xRange.min)/2)<0&&(r+=o)),i?a=u.yRange.max-s.yRange.min+c:(a=u.yRange.max-s.yRange.max,(o=(s.yRange.max-s.yRange.min)/2-(u.yRange.max-u.yRange.min)/2)<0&&(a+=o));for(var l=0;l<t.length;++l)t[l].x+=r,t[l].y+=a,n.push(t[l])}}for(var d=1;d<o.length;)h(o[d],!0,!1),h(o[d+1],!1,!0),h(o[d+2],!0,!0),d+=3,u=H0(n);for(var p={},f=0;f<n.length;++f)p[n[f].setId]=n[f];return p}function U0(t,e){for(var i={},n=function(t){var e={},i=[];for(var n in t)i.push(n),e[n]=[];for(var r=0;r<i.length;r++)for(var a=t[i[r]],o=r+1;o<i.length;++o){var s=t[i[o]],l=Si.distancePP(a,s);l+s.radius<=a.radius+1e-10?e[i[o]].push(i[r]):l+a.radius<=s.radius+1e-10&&e[i[r]].push(i[o])}return e}(t),r=0;r<e.length;++r){for(var a=e[r].sets,o={},s={},l=0;l<a.length;++l){o[a[l]]=!0;for(var u=n[a[l]],c=0;c<u.length;++c)s[u[c]]=!0}var h=[],d=[];for(var p in t)p in o?h.push(t[p]):p in s||d.push(t[p]);var f=j0(h,d);i[a.toString()]=f,f.disjoint&&e[r].size>0&&Wt.getInstance().error("Area "+a+" not represented on screen")}return i}function j0(t,e){for(var i=[],n=0;n<t.length;++n){var r=t[n];i.push({x:r.x,y:r.y}),i.push({x:r.x+r.radius/2,y:r.y}),i.push({x:r.x-r.radius/2,y:r.y}),i.push({x:r.x,y:r.y+r.radius/2}),i.push({x:r.x,y:r.y-r.radius/2})}for(var a=i[0],o=V0(i[0],t,e),s=1;s<i.length;++s){var l=V0(i[s],t,e);l>=o&&(a=i[s],o=l)}for(var u=Ya((function(i){return-1*V0({x:i[0],y:i[1]},t,e)}),[a.x,a.y],{maxIterations:500,minErrorDelta:1e-10}).x,c={x:u[0],y:u[1]},h=!0,d=0;d<t.length;++d)if(Si.distancePP(c,t[d])>t[d].radius){h=!1;break}for(var p=0;p<e.length;++p)if(Si.distancePP(c,e[p])<e[p].radius){h=!1;break}if(!h)if(1===t.length)c={x:t[0].x,y:t[0].y};else{var f={};Sa(t,f),c=0===f.arcs.length?{x:0,y:-1e3,disjoint:!0}:1===f.arcs.length?{x:f.arcs[0].circle.x,y:f.arcs[0].circle.y}:e.length?j0(t,[]):Ta(f.arcs.map((function(t){return t.p1})))}return c}function V0(t,e,i){var n,r,a=e[0].radius-Si.distancePP(e[0],t);for(n=1;n<e.length;++n)(r=e[n].radius-Si.distancePP(e[n],t))<=a&&(a=r);for(n=0;n<i.length;++n)(r=Si.distancePP(i[n],t)-i[n].radius)<=a&&(a=r);return a}var W0=function(t){var e={},i=Object.values(t);if(!i.length)return[];Sa(i,e);for(var n=e.arcs.map((function(t){var e=t.p1,i=t.p2,n=t.circle,r=t.width;return{p1:e,p2:i,radius:n.radius,setId:n.setId,largeArcFlag:r>n.radius}})),r=[],a=0,o=n[0],s=function(){var t=o.p2;r.push(o),o=n.find((function(e){return Si.distancePP(e.p1,t)<ka})),a++};a<n.length&&o;)s();return r},G0=function(t){if(!(null==t?void 0:t.length))return"";for(var e=0,i=t[0],n=i.p1,r="M".concat(n.x,",").concat(n.y);i;){var a=i,o=a.p2,s=a.radius,l=a.largeArcFlag;r+="A".concat(s,",").concat(s," 0 ").concat(l?1:0,",0 ").concat(o.x,",").concat(o.y),i=t[++e]}return r+=" Z"},Y0=function(t){var e;return null!==(e=null==t?void 0:t.map((function(t){var e=t.p1,i=t.p2,n=t.radius,r=t.largeArcFlag,a=t.setId,o=e.x,s=e.y,l=i.x,u=i.y,c=Math.pow(Math.pow(l-o,2)+Math.pow(u-s,2),.5),h=(o+l)/2,d=(s+u)/2,p=Math.pow(Math.pow(n,2)-Math.pow(c/2,2),.5),f=h+p*(u-s)/c,v=d-p*(l-o)/c;return(fi([l-o,u-s],[f-o,v-s])>0||r)&&(f=h-p*(u-s)/c,v=d+p*(l-o)/c),{x:f,y:v,radius:n,setId:a}})))&&void 0!==e?e:[]},X0=function(t,e){var i=t.x0,n=t.x1,r=t.y0,a=t.y1,o=t.setField,l=void 0===o?"sets":o,u=t.valueField,c=void 0===u?"size":u,h=t.orientation,d=void 0===h?Math.PI/2:h,p=t.orientationOrder,f=void 0===p?null:p,v=t.emptySetKey,g={},y={},m=e.some((function(t){var e=Dt(t[l]);return!e||0===e.length})),_=m?e.filter((function(t){return!ct(Dt(t[l]))})):e;if(_.length>0){var b=_.map((function(t){return{sets:Dt(t[l]),size:t[c]}})),x=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;var i=e.initialLayout||O0,n=e.lossFunction||F0,r=i(t=function(t){t=t.slice();for(var e=[],i={},n=0;n<t.length;++n){var r=t[n];if(1===r.sets.length)e.push(r.sets[0]);else if(2===r.sets.length){var a=r.sets[0],o=r.sets[1];i[[a,o].toString()]=!0,i[[o,a].toString()]=!0}}e.sort((function(t,e){return+(t>e)}));for(var s=0;s<e.length;++s)for(var l=e[s],u=s+1;u<e.length;++u){var c=e[u];[l,c].toString()in i||t.push({sets:[l,c],size:0})}return t}(t),e),a=[],o=[];for(var s in r)r.hasOwnProperty(s)&&(a.push(r[s].x),a.push(r[s].y),o.push(s));for(var l=Ya((function(e){for(var i={},a=0;a<o.length;++a){var s=o[a];i[s]={x:e[2*a],y:e[2*a+1],radius:r[s].radius}}return n(i,t)}),a,e).x,u=0;u<o.length;++u){var c=o[u];r[c].x=l[2*u],r[c].y=l[2*u+1]}return r}(b,t);x=N0(x,d,f),g=function(t,e,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];e=Math.max(e,1),i=Math.max(i,1);var o=[],l=[];for(var u in t)t.hasOwnProperty(u)&&(l.push(u),o.push(t[u]));var c=H0(o),h=c.xRange,d=c.yRange;if(h.max===h.min||d.max===d.min)return console.log("not scaling solution: zero size detected"),t;var p,f=e/(h.max-h.min),v=i/(d.max-d.min);if(a){var g,y=Math.min(e,i)/2,m=(h.min+h.max)/2,_=(d.min+d.max)/2,b=0,x=s(o);try{for(x.s();!(g=x.n()).done;){var k=g.value,S=Math.sqrt(Math.pow(k.x-m,2)+Math.pow(k.y-_,2))+k.radius;b=Math.max(b,S)}}catch(t){x.e(t)}finally{x.f()}p=y/b}else p=Math.min(v,f);for(var A=(e-(h.max-h.min)*p)/2,C=(i-(d.max-d.min)*p)/2,M={},w=0;w<o.length;++w){var T=o[w];M[l[w]]={radius:p*T.radius,x:n+A+(T.x-h.min)*p,y:r+C+(T.y-d.min)*p,setId:T.setId}}return M}(x,n-i,a-r,i,r,m),y=U0(g,b)}return e.map((function(t){var e=Dt(t[l]);if(!e||0===e.length)return Object.assign(Object.assign({},t),{datum:t,sets:e,key:v||"others",size:t[c],labelX:void 0,labelY:void 0,type:"circle",x:i+(n-i)/2,y:r+(a-r)/2,radius:Math.min(n-i,a-r)/2});var o=e.toString(),s=y[o],u=Object.assign(Object.assign({},t),{datum:t,sets:e,key:o,size:t[c],labelX:null==s?void 0:s.x,labelY:null==s?void 0:s.y}),h=g[o];if(h)return Object.assign(Object.assign({},u),{type:"circle",x:h.x,y:h.y,radius:h.radius});var d=W0(e.map((function(t){return g[t]})));return Object.assign(Object.assign({},u),{type:"overlap",x:0,y:0,path:G0(d),arcs:d})}))},K0=function(t,e){return e.filter((function(e){return e.type===t.datumType}))},q0={triangleForward:function(){return function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:Z0,triangle:Z0,diamond:function(){return function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1+Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function Z0(){return function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function J0(t,e){var i=e[0],n=e[1],r=1,a=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":a[1]=~~(n/2.7*.4),r=Math.floor(Math.min(i/2.3,n/2.6));break;case"triangleForward":r=n/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(n/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":a[1]=~~(n/1.5),r=Math.floor(Math.min(n/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":r=Math.floor(Math.min(i/2,n/2));break;default:r=Math.floor(Math.max(i/2,n/2))}return{maxRadius:r,center:a}}var Q0=function(t){return q0[t]?q0[t]():q0.circle()},$0=function(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"};function t1(t){return U(t)?t:function(){return t}}var e1=function(){return o((function t(e){var i,n,a=this;switch(r(this,t),this.options=mt({},t.defaultOptions,e),U(this.options.shape)?this.shape=this.options.shape:this.shape=Q0(this.options.shape),this.getText=null!==(i=t1(this.options.text))&&void 0!==i?i:function(t){return t},this.getTextFontWeight=t1(this.options.fontWeight),this.getTextFontSize=t1(this.options.fontSize),this.getTextFontStyle=t1(this.options.fontStyle),this.getTextFontFamily=t1(this.options.fontFamily),this.outputCallback=null!==(n=this.options.outputCallback)&&void 0!==n?n:function(t){return t},this.options.color){case"random-dark":this.getTextColor=function(){return $0(10,50)};break;case"random-light":this.getTextColor=function(){return $0(50,90)};break;default:this.getTextColor=t1(this.options.color)}if(j(this.options.rotate))if(this.options.useRandomRotate){var o=Math.abs(this.options.maxRotation-this.options.minRotation),s=Math.abs(Math.floor(this.options.rotationSteps)),l=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=function(){return 0===a.options.rotateRatio||Math.random()>a.options.rotateRatio?0:0===o?l:s>0?l+Math.floor(Math.random()*s)*o/(s-1):l+Math.random()*o}}else this.getTextRotate=function(){return 0};else this.getTextRotate=U(this.options.rotate)?function(t){var e;return Ci(null!==(e=a.options.rotate(t))&&void 0!==e?e:0)}:function(t,e){var i=Dt(a.options.rotate),n=a.options.random?Math.random():we(e);return Ci(i[Math.floor(n*i.length)])}}),[{key:"canRepeat",value:function(){return!1}},{key:"exceedTime",value:function(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!==(t=this.currentStepIndex)&&void 0!==t?t:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}},{key:"progressiveRun",value:function(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!==(t=this.currentStepIndex)&&void 0!==t?t:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];for(var e=this.progressiveIndex,i=0,n=this.options.maxSingleWordTryCount,r=Math.min(this.options.maxFailCount,this.originalData.length);e<this.data.length&&this.failCount<r;){var a=this.layoutWord(e);if(i++,(a||i>n)&&(e++,i=0,this.failCount=a?0:this.failCount+1),this.progressiveIndex=e,this.exceedTime())break;e===this.data.length&&this.failCount<r&&this.options.repeatFill&&this.canRepeat()&&(this.data=[].concat(b(this.data),b(this.originalData.map((function(t){return Object.assign(Object.assign({},t),{isFill:!0})})))),this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}},{key:"initProgressive",value:function(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}},{key:"output",value:function(){return this.result?this.outputCallback(this.result):null}},{key:"progressiveOutput",value:function(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}},{key:"unfinished",value:function(){return this.data&&this.data.length&&!j(this.progressiveIndex)&&this.progressiveIndex<this.data.length}},{key:"release",value:function(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}])}();e1.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};var i1={archimedean:function(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}},rectangular:function(t){var e=4*t[0]/t[1],i=0,n=0;return function(t){var r=t<0?-1:1;switch(Math.sqrt(1+4*r*t)-r&3){case 0:i+=e;break;case 1:n+=4;break;case 2:i-=e;break;default:n-=4}return[i,n]}}};var n1=function(t){function e(t){var i,a;return r(this,e),(i=n(this,e,[mt({},e.defaultOptions,t)])).cw=64,i.ch=2048,i._size=[256,256],i._isBoardExpandCompleted=!1,i._placeStatus=0,i._tTemp=null,i._dtTemp=null,i._dy=0,i.cacheMap=new Map,i.options.minFontSize<=e.defaultOptions.minFontSize&&(i.options.minFontSize=e.defaultOptions.minFontSize),i.spiral=q(i.options.spiral)?null!==(a=i1[i.options.spiral])&&void 0!==a?a:i1.archimedean:i.options.spiral,i.random=i.options.random?Math.random:function(){return 1},i.getTextPadding=t1(i.options.padding),i}return h(e,t),o(e,[{key:"zoomRatio",value:function(){return this._originSize[0]/this._size[0]}},{key:"dy",value:function(){return this._dy}},{key:"layoutWord",value:function(t){var e=this.data[t];if(""===(""+e.text).trim())return!0;var i=J0(this.options.shape,this._size),n=i.maxRadius,r=i.center;if(e.x=r[0],e.y=r[1],function(t,e,i,n,r,a){if(e.sprite)return;var o=t.context,s=t.ratio;o.setTransform(s,0,0,s,0,0),o.clearRect(0,0,(r<<5)/s,a/s);var l,u,c,h,d,p=0,f=0,v=0,g=i.length;for(--n;++n<g;){if(e=i[n],o.save(),o.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/s)+"px "+e.fontFamily,l=o.measureText(e.text+"m").width*s,c=e.fontSize<<1,e.angle){var y=Math.sin(e.angle),m=Math.cos(e.angle),_=l*m,b=l*y,x=c*m,k=c*y;l=Math.max(Math.abs(_+k),Math.abs(_-k))+31>>5<<5,c=~~Math.max(Math.abs(b+x),Math.abs(b-x))}else l=l+31>>5<<5;if(c>v&&(v=c),p+l>=r<<5&&(p=0,f+=v,v=0),f+c>=a)break;o.translate((p+(l>>1))/s,(f+(c>>1))/s),e.angle&&o.rotate(e.angle),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=l,e.height=c,e.xoff=p,e.yoff=f,e.x1=l>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=l}for(var S=o.getImageData(0,0,(r<<5)/s,a/s).data,A=[];--n>=0;)if((e=i[n]).hasText){for(u=(l=e.width)>>5,c=e.y1-e.y0,h=0;h<c*u;h++)A[h]=0;if(null==(p=e.xoff))return;f=e.yoff;var C=0,M=-1;for(d=0;d<c;d++){for(h=0;h<l;h++){var w=u*d+(h>>5),T=S[(f+d)*(r<<5)+(p+h)<<2]?1<<31-h%32:0;A[w]|=T,C|=T}C?M=d:(e.y0++,c--,d--,f++)}e.y1=e.y0+M,e.sprite=A.slice(0,(e.y1-e.y0)*u)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,n))return this.result.push(e),this._bounds?function(t,e){var i=t[0],n=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>n.x&&(n.x=e.x+e.x1),e.y+e.y1>n.y&&(n.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){var a=e.fontSize*this._originSize[0]/this.options.minFontSize,o=Math.max(e.width,e.height);if(o<=a)this._board=this.expandBoard(this._board,this._bounds,o/this._size[0]);else{if(!this.options.clip)return!0;this._board=this.expandBoard(this._board,this._bounds,a/this._size[0])}}else this._placeStatus,this._board=this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}},{key:"layout",value:function(t,e){var i=this;this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=b(this._size);var n=this.getContext(this.options.createCanvas({width:1,height:1}));this.contextAndRatio=n,this._board=new Uint32Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,t.length,this.result=[];var r=t.map((function(t,e){return{text:i.getText(t),fontFamily:i.getTextFontFamily(t),fontStyle:i.getTextFontStyle(t),fontWeight:i.getTextFontWeight(t),angle:i.getTextRotate(t,e),fontSize:~~i.getTextFontSize(t),padding:i.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0}})).sort((function(t,e){return e.fontSize-t.fontSize}));if(this.originalData=r,this.data=r,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){var a=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(a-this._originSize[1]/2)}return this.result}},{key:"formatTagItem",value:function(t){for(var e,i,n=this._size,r=this.zoomRatio(),a=this.dy(),o=n[0]>>1,s=n[1]>>1,l=t.length,u=[],c=0;c<l;++c)e=t[c],(i={}).datum=e.datum,i.x=(e.x+o)*r,i.y=(e.y+s+a)*r,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*r,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,u.push(i);return u}},{key:"output",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}},{key:"progressiveOutput",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}},{key:"updateBoardExpandStatus",value:function(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}},{key:"shouldShrinkContinue",value:function(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}},{key:"shrinkBoard",value:function(t){var e=t[0],i=t[1];if(!(i.x>=this._size[0]||i.y>=this._size[1])){var n=Math.min(e.x,this._size[0]-i.x),r=Math.min(e.y,this._size[1]-i.y),a=2*Math.min(n/this._size[0],r/this._size[1]);this._size=this._size.map((function(t){return t*(1-a)}))}}},{key:"expandBoard",value:function(t,e,i){var n=this._size[0],r=this._size[1],a=n>>5,o=n*(i||1.1)-n>>5,s=2*o>2?o:2;s%2!=0&&s++;var l=Math.ceil(r*(s<<5)/n);l%2!=0&&l++;for(var u=n+(s<<5),c=r+l,h=u>>5,d=s/2,p=l/2,f=new Uint32Array(c*h).fill(0),v=0;v<r;v++){var g=v*a,y=g+a,m=(v+p)*h+d,_=t.slice(g,y);f.set(_,m)}if(this._size=[u,c],e){var b=(s<<5)/2,x=l/2;e[0].x+=b,e[0].y+=x,e[1].x+=b,e[1].y+=x}return f}},{key:"insertZerosToArray",value:function(t,e,i){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(t,e,i);for(var n=Math.floor(i/6e4),r=i%6e4,a=0;a<n;a++)t.splice.apply(t,[e+6e4*a,0].concat(b(new Array(6e4).fill(0))));t.splice.apply(t,[e+6e4*n,0].concat(b(new Array(r).fill(0))))}},{key:"getContext",value:function(t){t.width=1,t.height=1;var e=t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1),i=Math.sqrt(e.data.length>>2);t.width=(this.cw<<5)/i,t.height=this.ch/i;var n=t.getContext("2d",{willReadFrequently:!0});return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:i,canvas:t}}},{key:"place",value:function(t,e,i,n){var r=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;var a=this.random()<.5?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,a))return null;var o,s,l,u,c=e.x,h=e.y,d=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),p=this.spiral(this._size),f=-a;for(this._tTemp=null,this._dtTemp=null;o=p(f+=a);){s=o[0],l=o[1];var v=Math.sqrt(Math.pow(s,2)+Math.pow(l,2)),g=Math.atan(l/s);s<0?g+=Math.PI:l<0&&(g=2*Math.PI+g);var y=this.shape(g);if(Math.min(Math.abs(s),Math.abs(l))>=d)break;if(v>=n)r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);else{if(e.x=c+~~(v*y*Math.cos(-g)),e.y=h+~~(v*y*Math.sin(-g)),u=e,this.options.clip)if(this.shouldShrinkContinue()){if(s1(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}}else{if(o1(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}s1(u,this._size)&&(u=l1(u,this._size))}else if(s1(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}if(r=!0,(!i||a1(u,i))&&(!i||!r1(u,t,this._size))){for(var m=u.sprite,_=u.width>>5,b=this._size[0]>>5,x=u.x-(_<<4),k=127&x,S=32-k,A=u.y1-u.y0,C=void 0,M=(u.y+u.y0)*b+(x>>5),w=0;w<A;w++){C=0;for(var T=0;T<=_;T++)t[M+T]|=C<<S|(T<_?(C=m[w*_+T])>>>k:0);M+=b}return e.sprite=null,u.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),!this.shouldShrinkContinue()&&this.setCache(u,a),!1}},{key:"clearCache",value:function(){this.cacheMap.clear()}},{key:"setCache",value:function(t,e){var i="".concat(t.angle,"-").concat(e),n=t.x1-t.x0,r=t.y1-t.y0;if(this.cacheMap.has(i)){var a=this.cacheMap.get(i),o=a.width,s=a.height;(n<o&&r<s||n<=o&&r<s)&&this.cacheMap.set(i,{width:n,height:r})}else this.cacheMap.set(i,{width:n,height:r})}},{key:"isSizeLargerThanMax",value:function(t,e){var i="".concat(t.angle,"-").concat(e);if(!this.cacheMap.has(i))return!1;var n=this.cacheMap.get(i),r=n.width,a=n.height,o=t.x1-t.x0,s=t.y1-t.y0;return o>=r&&s>=a}}])}(e1);function r1(t,e,i){for(var n,r=i[0]>>5,a=t.sprite,o=t.width>>5,s=t.x-(o<<4),l=127&s,u=32-l,c=t.y1-t.y0,h=(t.y+t.y0)*r+(s>>5),d=0;d<c;d++){n=0;for(var p=0;p<=o;p++)if((n<<u|(p<o?(n=a[d*o+p])>>>l:0))&e[h+p])return!0;h+=r}return!1}function a1(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}n1.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};var o1=function(t,e){return t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0},s1=function(t,e){return t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1]};function l1(t,e){for(var i=t.sprite,n=t.y1-t.y0,r=t.width>>5,a=0,o=[],s=Math.max(-(t.y0+t.y),0),l=Math.min(n+(e[1]-(t.y1+t.y)),n),u=Math.max(-(t.x0+t.x),0)>>5,c=Math.min(r+(e[0]-(t.x1+t.x)>>5)+1,r),h=0;h<n;h++){for(var d=0;d<r;d++)h<s||l<=h||d<u||c<=d||o.push(i[a+d]);a+=r}var p=u<<5,f=r-c<<5,v=s,g=n-l;return Object.assign(Object.assign({},t),{width:t.width-p-f,height:t.height-v-g,x0:t.x0+p,x1:t.x1-f,y0:t.y0+v,y1:t.y1-g,x:t.x+p/2-f/2,sprite:o})}var u1=function(t,e,i){var n=null!=e?e:{},r=n.threshold,a=n.invert,o=void 0!==a&&a;if(!t||"#fff"===t)return function(t,e,i){var n=t.width;if(0===t.data[e*n*4+4*i+3])return!o;var a=t.data[e*n*4+4*i+0],s=t.data[e*n*4+4*i+1],l=t.data[e*n*4+4*i+2];if(255===a&&255===s&&255===l)return!o;if(it(r)){var u=.3*a+.59*s+.11*l;return o?u<=r:u>=r}return!1};var s=i({width:1,height:1}).getContext("2d",{willReadFrequently:!0});s.fillStyle=t,s.fillRect(0,0,1,1);var l=s.getImageData(0,0,1,1).data;return function(t,e,i){var n=t.width;return[0,1,2,3].every((function(r){return o?t.data[4*(e*n+i)+r]!==l[r]:t.data[4*(e*n+i)+r]===l[r]}))}},c1=function(t,e,i,n){var r,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=t.backgroundColor,l=void 0===s?"#fff":s,u=t.fill,c=void 0===u?"#000":u;a&&(l=(r=[c,l])[0],c=r[1]);var h=n||o({width:e,height:i,dpr:1}),d=h.getContext("2d",{willReadFrequently:!0});if(n){var p=n.width,f=n.height;d.clearRect(0,0,p,f),n.style.width="".concat(e,"px"),n.style.height="".concat(i,"px"),n.width=e,n.height=i}return d.fillStyle=l,d.fillRect(0,0,h.width,h.height),"text"===t.type?h1(t,c,h.width,h.height,d):"geometric"===t.type&&g1(t,c,h.width,h.height,d),h},h1=function(t,e,i,n,r){var a=t.fontFamily,o=void 0===a?"sans-serif":a,s=t.fontWeight,l=void 0===s?"normal":s,u=t.fontStyle,c=void 0===u?"normal":u,h=t.fontVariant,d=void 0===h?"normal":h,p=t.text,f=t.hollow,v=12;r.font="".concat(c," ").concat(d," ").concat(l," ").concat(v,"px ").concat(o),r.textAlign="center",r.textBaseline="middle",r.fillStyle=e;var g=r.measureText(p),y="normal"!==c?1.1:1,m=W(g.actualBoundingBoxRight)&&W(g.actualBoundingBoxLeft)?Math.ceil(y*(Math.abs(g.actualBoundingBoxRight)+Math.abs(g.actualBoundingBoxLeft))):0,_=Math.max(Math.ceil(g.width),m,v);if(f&&(r.globalCompositeOperation="xor"),_>i){var b=Math.min(i/_,n/v);r.fillText(p,i/2,n/2),r.scale(b,b)}else v=Math.floor(v*i/_),v=Math.min(v,n),r.font="".concat(c," ").concat(d," ").concat(l," ").concat(v,"px ").concat(o),r.fillText(p,Math.floor(i/2),Math.floor(n/2))},d1=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,r=2*Math.PI/n;return new Array(n).fill(0).map((function(n,a){return Pi(t,e,i+a*r)}))},p1=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,r=2*Math.PI/n,a=Q0("cardioid");return new Array(n).fill(0).map((function(n,o){var s=i+o*r,l=e*a(s);return Pi(t,l,s)}))},f1=function(t,e){t.beginPath(),e.forEach((function(e,i){0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),t.fill()},v1=function(t,e){var i;t.beginPath(),e.forEach((function(e,n){0===n?t.moveTo(e.x,e.y):t.bezierCurveTo(e.x,e.y,i.x,i.y,e.x,e.y),i=e})),t.closePath(),t.fill()},g1=function(t,e,i,n,r){var a=t.hollow,o=J0(t.shape,[i,n]),s=o.center,l=o.maxRadius;r.fillStyle=e,a&&(r.globalCompositeOperation="xor");var u=s[0],c=s[1];if("cardioid"===t.shape)v1(r,p1({x:u,y:c},l,0,100));else if("circle"===t.shape)r.beginPath(),r.arc(u,c,l,0,2*Math.PI,!0),r.fill();else if("diamond"===t.shape)f1(r,d1({x:u,y:c},l,-Math.PI/2,4));else if("square"===t.shape)f1(r,d1({x:u,y:c},l,-Math.PI/4,4));else if("pentagon"===t.shape)f1(r,d1({x:u,y:c},l,Math.PI/2,5));else if("triangle"===t.shape||"triangleUpright"===t.shape)f1(r,d1({x:u,y:c},l,-Math.PI/2,3));else if("triangleForward"===t.shape)f1(r,d1({x:u,y:c},l,0,3));else if("star"===t.shape){for(var h=d1({x:u,y:c},l,-Math.PI/2,5),d=d1({x:u,y:c},l/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),p=[],f=0;f<5;f++)p.push(h[f]),p.push(d[f]);f1(r,p)}else r.fillRect(0,0,i,n)};function y1(t){for(var e=t.size,i=t.maskCanvas,n=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),r=new Array(e[0]*e[1]).fill(0),a=1,o=[[0,1],[1,0],[-1,0],[0,-1]],l=[],u=0;u<e[1];u++)for(var c=0;c<e[0];c++)if(0===r[u*e[0]+c]&&!t.isEmptyPixel(n,u,c)){r[u*e[0]+c]=a,l.push([u,c]);for(var h=0;h<l.length;h++)for(var d=0;d<4;d++){var p=l[h][0]+o[d][0],f=l[h][1]+o[d][1];p=p<0?0:p>=e[1]?e[1]-1:p,f=f<0?0:f>=e[0]?e[0]-1:f,0!==r[p*e[0]+f]||t.isEmptyPixel(n,p,f)||(r[p*e[0]+f]=a,l.push([p,f]))}a++,l=[]}for(var v={},g={},y={},_={},x={},k={},S={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},A=[],C=0;C<e[1];C++)for(var M=0;M<e[0];M++){var w=r[C*e[0]+M];0!==w&&(X(C,M)&&(A.push([C,M]),v[w]=v[w]||[],v[w].push([M,C]),_[w]||(_[w]=[1/0,-1/0,1/0,-1/0]),C<_[w][0]&&(_[w][0]=C),C>_[w][1]&&(_[w][1]=C),M<_[w][2]&&(_[w][2]=M),M>_[w][3]&&(_[w][3]=M),M<S.x1&&(S.x1=M),M>S.x2&&(S.x2=M),C<S.y1&&(S.y1=C),C>S.y2&&(S.y2=C)),g[w]=(g[w]||0)+1)}var T=[];for(var D in v){var E=v[D],B=~~(E.reduce((function(t,e){return t+e[0]}),0)/E.length),P=~~(E.reduce((function(t,e){return t+e[1]}),0)/E.length);y[D]=[B,P],T.push.apply(T,b(E));var R=m(_[D],4),L=R[0],I=R[1],F=R[2],O=R[3];x[D]=~~Math.max(Math.sqrt(Math.pow(B-F,2)+Math.pow(P-L,2)),Math.sqrt(Math.pow(B-O,2)+Math.pow(P-I,2)),Math.sqrt(Math.pow(B-F,2)+Math.pow(P-I,2)),Math.sqrt(Math.pow(B-O,2)+Math.pow(P-L,2))),k[D]=(O-F)/(I-L)}var z=Object.keys(y).map((function(t){return{label:t-1,boundary:v[t],area:g[t],center:y[t],maxPoint:_[t],maxR:x[t],ratio:k[t]}}));S.width=S.x2-S.x1+1,S.height=S.y2-S.y1+1;var H=~~(T.reduce((function(t,e){return t+e[0]}),0)/T.length),N=~~(T.reduce((function(t,e){return t+e[1]}),0)/T.length),U=~~Math.max(Math.sqrt(Math.pow(H-S.x1,2)+Math.pow(N-S.y1,2)),Math.sqrt(Math.pow(H-S.x2,2)+Math.pow(N-S.y2,2)),Math.sqrt(Math.pow(H-S.x1,2)+Math.pow(N-S.y2,2)),Math.sqrt(Math.pow(H-S.x2,2)+Math.pow(N-S.y1,2))),j=S.width/S.height,V=Object.keys(g).reduce((function(t,e){return t+g[e]}),0),W={regions:z,labels:r,labelNumber:a-1};if(t.blur){var G=t.blur,Y=function(t,e,i,n){for(var r=n/3,a=Math.ceil(n/2),o=function(t,e){for(var i=new Array(2*t+1).fill(0),n=t,r=0,a=-t;a<=t;a++){var o=Math.exp(-a*a/(2*e*e));i[a+n]=o,r+=o}for(var s=0;s<i.length;s++)i[s]/=r;return i}(a,r),s=new Array(t.length).fill(0),l=new Array(t.length).fill(0),u=0;u<i;u++)for(var c=0;c<e;c++){for(var h=0,d=-a;d<=a;d++)h+=t[u*e+Math.min(Math.max(c+d,0),e-1)]*o[d+a];s[u*e+c]=h}for(var p=0;p<e;p++)for(var f=0;f<i;f++){for(var v=0,g=-a;g<=a;g++)v+=s[Math.min(Math.max(f+g,0),i-1)*e+p]*o[g+a];l[f*e+p]=Math.max(0,Math.min(1,v))}return l}(r,e[0],e[1],G);(function(t,e,i,n){var r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=new Array(t.length).fill(0),l=s(e);try{for(l.s();!(r=l.n()).done;){var u=m(r.value,2),c=u[0],h=u[1];if(o[c*i+h]=1,a>1)for(var d=1-a;d<=a-1;d++)for(var p=1-a;p<=a-1;p++)if(Math.sqrt(d*d+p*p)<a){var f=c+d,v=h+p;f>=0&&f<n&&v>=0&&v<i&&(o[f*i+v]=1)}}}catch(t){l.e(t)}finally{l.f()}return o})(r,A,e[0],e[1],Math.ceil(G/2)).forEach((function(t,e){1===t&&(r[e]=Y[e])}))}return Object.assign(t,{segmentation:W,shapeBounds:S,shapeMaxR:U,shapeRatio:j,shapeCenter:[H,N],shapeArea:V});function X(t,i){var n=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===i||t===e[1]-1||i===e[0]-1)return!0;for(var a=0;a<4;a++){var o=t+n[a][0],s=i+n[a][1];if(o=o<0?0:o>=e[1]?e[1]-1:o,s=s<0?0:s>=e[0]?e[0]-1:s,0===r[o*e[0]+s])return!0}return!1}}function m1(t,e,i){e.width=t.width,e.height=t.height;var n=e.getContext("2d",{willReadFrequently:!0});n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0);for(var r=e.width,a=n.getImageData(0,0,e.width,e.height),o=0,s=a.height,l=0,u=a.width,c=function(t,e){for(var n=0;n<t;++n)if(!i(a,e,n))return!1;return!0},h=function(t,e,n){for(var r=e;r<n;++r)if(!i(a,r,t))return!1;return!0};o<s&&c(r,o);)++o;for(;s-1>o&&c(r,s-1);)--s;for(;l<u&&h(l,o,s);)++l;for(;u-1>l&&h(u-1,o,s);)--u;var d=n.getImageData(l,o,u-l,s-o);return e.width=d.width,e.height=d.height,n.clearRect(0,0,e.width,e.height),n.putImageData(d,0,0),e}function _1(t,e){var i=t.width,n=t.height,r=e[0]/i;n*r>e[1]&&(r=e[1]/n);var a=Math.floor(r*i),o=Math.floor(r*n);return{x:(e[0]-a)/2,y:(e[1]-o)/2,width:a,height:o,scale:r}}var b1=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[mt({},e.defaultOptions,t)])).fillGridAt=function(t,e){t>=i.ngx||e>=i.ngy||t<0||e<0||(i.grid[t][e]=!1)},i.updateGrid=function(t,e,n,r,a){for(var o=a.occupied,s=o.length;s--;){var l=t+o[s][0],u=e+o[s][1];l>=i.ngx||u>=i.ngy||l<0||u<0||i.fillGridAt(l,u)}},i.gridSize=Math.max(Math.floor(i.options.gridSize),4),i}return h(e,t),o(e,[{key:"getPointsAtRadius",value:function(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];var e=8*t,i=e,n=[];for(0===t&&n.push([this.center[0],this.center[1],0]);i--;){var r=this.shape(i/e*2*Math.PI);n.push([this.center[0]+t*r*Math.cos(-i/e*2*Math.PI),this.center[1]+t*r*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=n,n}},{key:"getTextInfo",value:function(t){var e,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,a=this.options.clip?1:n,o=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(t))*a),this.options.minFontSize),s=this.getText(t)+"";if(this.options.clip&&(s=s.slice(0,Math.ceil(s.length*n))),!s)return null;var l=this.getTextFontWeight(t),u=this.getTextFontStyle(t),c=this.getTextRotate&&null!==(e=this.getTextRotate(t,r))&&void 0!==e?e:0,h=this.getTextFontFamily(t),d=this.options.createCanvas({width:1,height:1}),p=d.getContext("2d",{willReadFrequently:!0});p.font=u+" "+l+" "+o.toString(10)+"px "+h;var f=p.measureText(s).width,v=Math.max(o,p.measureText("m").width,p.measureText("Ｗ").width),g=f+2*v,y=3*v,m=Math.ceil(g/this.gridSize),_=Math.ceil(y/this.gridSize);g=m*this.gridSize,y=_*this.gridSize;var b=-f/2,x=.4*-v,k=Math.ceil((g*Math.abs(Math.sin(c))+y*Math.abs(Math.cos(c)))/this.gridSize),S=Math.ceil((g*Math.abs(Math.cos(c))+y*Math.abs(Math.sin(c)))/this.gridSize),A=S*this.gridSize,C=k*this.gridSize;d.setAttribute("width",""+A),d.setAttribute("height",""+C),p.scale(1,1),p.translate(A/2,C/2),p.rotate(-c),p.font=u+" "+l+" "+o.toString(10)+"px "+h,p.fillStyle="#000",p.textBaseline="middle",p.fillText(s,b,x);var M=p.getImageData(0,0,A,C).data;if(this.exceedTime())return null;for(var w,T=[],D=S,E=[k/2,S/2,k/2,S/2],B=function(t,e,n){for(var r=i.gridSize;r--;)for(var a=i.gridSize;a--;)if(M[4*((e*i.gridSize+r)*A+(t*i.gridSize+a))+3])return n.push([t,e]),t<E[3]&&(E[3]=t),t>E[1]&&(E[1]=t),e<E[0]&&(E[0]=e),void(e>E[2]&&(E[2]=e))};D--;)for(w=k;w--;)B(D,w,T);return{datum:t,occupied:T,bounds:E,gw:S,gh:k,fillTextOffsetX:b,fillTextOffsetY:x,fillTextWidth:f,fillTextHeight:v,fontSize:o,fontStyle:u,fontWeight:l,fontFamily:h,angle:c,text:s}}},{key:"calculateEmptyRate",value:function(){for(var t=this.ngx*this.ngy,e=0,i=0;i<this.ngx;i++)for(var n=0;n<this.ngy;n++)this.grid[i][n]&&e++;return e/t}},{key:"canFitText",value:function(t,e,i,n,r){for(var a=r.length;a--;){var o=t+r[a][0],s=e+r[a][1];if(o>=this.ngx||s>=this.ngy||o<0||s<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[o][s])return!1}return!0}},{key:"layoutWord",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.data[t],r=this.getTextInfo(n,i,t);if(!r)return!1;if(this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){var a=r.bounds;if(a[1]-a[3]+1>this.ngx||a[2]-a[0]+1>this.ngy)return!1}for(var o=this.maxRadius+1,s=function(t){var i=Math.floor(t[0]-r.gw/2),n=Math.floor(t[1]-r.gh/2),a=r.gw,s=r.gh;return!!e.canFitText(i,n,a,s,r.occupied)&&(r.distance=e.maxRadius-o,r.theta=t[2],e.outputText(i,n,r),e.updateGrid(i,n,a,s,r),!0)};o--;){var l=this.getPointsAtRadius(this.maxRadius-o);if(this.options.random&&It(l=[].concat(l)),l.some(s))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*i)}},{key:"outputText",value:function(t,e,i){var n=this.getTextColor(i),r={text:i.text,datum:i.datum,color:n,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(r),this.progressiveResult&&this.progressiveResult.push(r)}},{key:"initGrid",value:function(t){var e=this;this.grid=[];var i=this.options.shape;if(G(i)){var n=c1(i,t.width,t.height,void 0,!1,this.options.createCanvas),r=n.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(n);for(var a=u1(i.backgroundColor,void 0,this.options.createCanvas),o=function(t,i){for(var n=e.gridSize;n--;)for(var o=e.gridSize;o--;)if(!a(r,i*e.gridSize+n,t*e.gridSize+o))return void(e.grid[t][i]=!0);e.grid[t][i]=!1},s=this.ngx;s--;){this.grid[s]=[];for(var l=this.ngy;l--;)o(s,l),!1!==this.grid[s][l]&&(this.grid[s][l]=!0)}r=a=void 0}else for(var u=this.ngx;u--;){this.grid[u]=[];for(var c=this.ngy;c--;)this.grid[u][c]=!0}}},{key:"canRepeat",value:function(){return this.calculateEmptyRate()>.001}},{key:"layout",value:function(t,e){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=t,this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);var i=J0(this.options.shape,[e.width,e.height]),n=i.center,r=i.maxRadius;return this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[n[0]/this.gridSize,n[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e),this.result=[],this.progressiveRun()}}])}(e1);b1.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};var x1=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[mt({},e.defaultOptions,t)])).random=i.options.random?Math.random:function(){return 0},i.aspectRatio=1,i}return h(e,t),o(e,[{key:"fit",value:function(t){for(var e=0,i=this.result.length;e<i;e++)if(k1(t,this.result[e]))return!1;return!0}},{key:"getTextInfo",value:function(t,e){var i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},n=this.options.getTextBounds(i);return i.width=n.width(),i.height=n.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}},{key:"layoutWord",value:function(t){for(var e=this.getTextInfo(this.data[t],t),i=2*Math.PI,n=0,r=e.left,a=e.top,o=e.width,s=e.height,l=1,u=this.fit(e);!u&&n<this.maxRadius;)n+=.5,l=this.shape(n/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),r=this.center[0]-o/2+n*l*Math.cos(i)*this.aspectRatio,a=this.center[1]-s/2+n*l*Math.sin(i),e.left=r,e.top=a,e.x=r+o/2,e.y=a+s/2,u=this.fit(e);return!!u&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}},{key:"layout",value:function(t,e){var i=this;if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((function(t,e){return i.getTextFontSize(e)-i.getTextFontSize(t)}));for(var n=0;n<t.length&&(this.layoutWord(n),n++,this.progressiveIndex=n,!this.exceedTime()););return this.result}}])}(e1);function k1(t,e){return!(t.left+t.width<e.left||t.top+t.height<e.top||t.left>e.left+e.width||t.top>e.top+e.height)}x1.defaultOptions={enlarge:!1};var S1,A1={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},C1=function(t,e){var i,n,r,a,o,s;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return Wt.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];var l=e,u=(null!==(i=t.size)&&void 0!==i?i:[500,500]).slice();u[0]=Math.floor(u[0]),u[1]=Math.floor(u[1]);var c=t.fontFamily?M1(t.fontFamily):"sans-serif",h=t.fontStyle?M1(t.fontStyle):"normal",d=t.fontWeight?M1(t.fontWeight):"normal",p=t.rotate?M1(t.rotate):0,f=M1(t.text),v=null!==(n=t.spiral)&&void 0!==n?n:"archimedean",g=t.padding?M1(t.padding):1,y=null!==(r=t.shape)&&void 0!==r?r:"square",m=null!==(a=t.shrink)&&void 0!==a&&a,_=null!==(o=t.enlarge)&&void 0!==o&&o,b=null!==(s=t.clip)&&void 0!==s&&s,x=t.minFontSize,k=t.randomVisible,S=t.as?Object.assign(Object.assign({},A1),t.as):A1,A=t.depth_3d,C=t.postProjection,M=t.fontSize?M1(t.fontSize):14,w=t.fontSizeRange;if(w&&!$(M)){var T=M,D=T1(D1(T,l),w);M=function(t){return D(T(t))}}var E=n1;"fast"===t.layoutType?E=x1:"grid"===t.layoutType&&(E=b1);var B=new E(Object.assign(Object.assign({},t),{text:f,padding:g,spiral:v,shape:y,rotate:p,fontFamily:c,fontStyle:h,fontWeight:d,fontSize:M,shrink:m,clip:b,enlarge:_,minFontSize:x,random:k,outputCallback:function(e){for(var i,n,r=[],a=0,o=e.length;a<o;a++)(i=(n=e[a]).datum)[S.x]=n.x,i[S.y]=n.y,i[S.fontFamily]=n.fontFamily,i[S.fontSize]=n.fontSize,i[S.fontStyle]=n.fontStyle,i[S.fontWeight]=n.fontWeight,i[S.angle]=n.angle,"StereographicProjection"===C&&E1(u,n,i,S,A),t.dataIndexKey&&(i[t.dataIndexKey]="".concat(a)),r.push(i);return r}}));return B.layout(l,{width:u[0],height:u[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:B}:B.output()},M1=function(t){return q(t)||$(t)||U(t)||Z(t)?t:function(e){return e[t.field]}},w1=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},T1=function(t,e,i){if(t[0]===t[1])return function(t){return e[0]};var n=w1(t[0]),r=w1(t[1]),a=Math.min(n,r),o=Math.max(n,r);return function(t){return(w1(t)-a)/(o-a)*(e[1]-e[0])+e[0]}},D1=function(t,e){for(var i,n=1/0,r=-1/0,a=e.length,o=0;o<a;++o)(i=Ht(t(e[o])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]};function E1(t,e,i,n,r){var a=Math.max(t[0],t[1])/2,o=function(t,e,i,n,r){var a=r.x,o=r.y,s=a/t*Math.PI*2,l=Math.PI-o/e*Math.PI;return l+=(l<Math.PI/2?1:-1)*Math.pow(Math.min(l-Math.PI/2,1),2)/5,{x:i*Math.sin(l)*Math.cos(s)+n.x,y:i*Math.cos(l)+n.y,z:i*Math.sin(l)*Math.sin(s)+n.z}}(t[0],t[1],a,{x:a,y:a,z:null!=r?r:a},e);i[n.x]=o.x,i[n.y]=o.y,i[n.z]=o.z}t.WORDCLOUD_SHAPE_HOOK_EVENT=void 0,(S1=t.WORDCLOUD_SHAPE_HOOK_EVENT||(t.WORDCLOUD_SHAPE_HOOK_EVENT={})).BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",S1.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",S1.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw";var B1=function(t){return/^[\u4e00-\u9fa5]+$/.test(t)},P1=function(t,e){if(j(t))return 0;var i,n=0,r=s(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;B1(a)?n+=1:n+=.53}}catch(t){r.e(t)}finally{r.f()}return n};function R1(t,e,i){var n=e.stepFactor,r=e.importantWordCount,a=e.globalShinkLimit,o=i.size,s=i.segmentation.regions,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,p=l.getContext("2d",{willReadFrequently:!0}),f=z1(i),v=f.slice(0),g=e.fontSizeShrinkFactor,y=null,m=1,_=1,b=r,x=0;t.length>b&&(x=t.sort((function(t,e){return e.weight-t.weight}))[b].weight);for(var k=0;k<s.length;k++){for(var S=s[k],A=S.words,C=S.center,M=S.maxR,w=S.ratio,T=!1,D=0;D<A.length;D++){O1(l,p,t,D);var E=A[D];if(E.x=C[0],E.y=C[1],!E.skip&&E.hasText&&E.sprite&&L1(v,E,M,w,o,u,n))E.hasPlaced=!0;else{if(!E.skip&&E.weight>x&&_>a){var B=E.datum[Symbol.for("vGrammar_id")];B!==y&&(y=B,m=_),_*=g,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*g})),v=f.slice(0),T=!0;break}if(!E.skip&&E.datum[Symbol.for("vGrammar_id")]===y){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/_})),E.skip=!0,_=m,y=null,v=f.slice(0),T=!0;break}}}T&&(k=-1)}for(var P=0;P<e.textLayoutTimes;P++){var R=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===R.length)break;for(var L=0;L<R.length;L++){var I=R[L];O1(l,p,R,L),I.x=c[0],I.y=c[1],I.hasText&&L1(v,I,h,d,o,u,n)&&(I.hasPlaced=!0)}}e.board=v}function L1(t,e,i,n,r,a,o){for(var s,l,u,c=e.x,h=e.y,d=function(t){return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}(n),p=1*o,f=-p;s=d(f+=p);){e.wordSize;var v=e.bounds,g=v.dTop,y=v.dBottom,m=v.dLeft,_=v.dRight;if(l=s[0],u=s[1],Math.min(Math.abs(l),Math.abs(u))>=i)break;if(e.x=~~(c+l),e.y=~~(h+u),!(e.x-m<0||e.x+_>r[0]||e.y-g<0||e.y+y>r[1]||F1(e,t,a)))return I1(e,t,a),!0}return!1}function I1(t,e,i){var n,r=t.wordSize,a=t.sprite,o=r[0]>>5,s=i[0]>>5,l=t.x-(o<<4),u=l%32,c=32-u,h=r[1],d=(t.y-(r[1]>>1))*s+(l>>5);if(0===u)for(var p=0;p<h;p++){for(var f=0;f<o;f++)e[d+f]|=a[p*o+f];d+=s}else for(var v=0;v<h;v++){n=0;for(var g=0;g<=o;g++)e[d+g]|=n<<c|(g<o?(n=a[v*o+g])>>>u:0);d+=s}}function F1(t,e,i){var n,r=t.sprite,a=t.wordSize,o=i[0]>>5,s=a[0]>>5,l=t.x-(s<<4),u=l%32,c=32-u,h=a[1],d=(t.y-(a[1]>>1))*o+(l>>5);if(0===u)for(var p=0;p<h;p++){for(var f=0;f<s;f++)if(e[d+f]&r[p*s+f])return!0;d+=o}else for(var v=0;v<h;v++){n=0;for(var g=0;g<=s;g++)if((n<<c|(g<s?(n=r[v*s+g])>>>u:0))&e[d+g])return!0;d+=o}return!1}function O1(t,e,i,n){if(!i[n].sprite&&0!==i[n].fontSize){var r=2048,a=Math.PI/180,o=i.length;t.width=r,t.height=2048,e.clearRect(0,0,r,2048),e.textAlign="center";var s,l,u=0,c=0,h=0,d=0,p=n;for(--n;++n<o;){var f=i[n],v=Math.max(f.fontSize,2);if(e.save(),e.font=f.fontStyle+" "+f.fontWeight+" "+v+"px "+f.fontFamily,s=e.measureText(f.text+"m").width+2*f.padding,l=2*v+2*f.padding,0!==f.rotate){var g=Math.sin(f.rotate*a),y=Math.cos(f.rotate*a),_=s*y,b=s*g,x=l*y,k=l*g;s=Math.max(Math.abs(_+k),Math.abs(_-k)),l=~~Math.max(Math.abs(b+x),Math.abs(b-x))}if(s=s+31>>5<<5,(l=Math.ceil(l))>h&&(h=l),u+s>=r&&(u=0,c+=h,h=l),c+l>=2048){if(0===c){f.hasText=!1;continue}break}c+l>=d&&(d=c+l),e.translate(u+(s>>1),c+(l>>1)),0!==f.rotate&&e.rotate(f.rotate*a),e.fillText(f.text,0,0),f.padding&&(e.lineWidth=2*f.padding,e.strokeText(f.text,0,0)),e.restore(),f.LT=[u,c],f.wordSize=[s,l],f.hasText=!0,u+=s}if(0!==d)for(var S,A,C=e.getImageData(0,0,r,d).data;--n>=p;){var M=i[n];if(!M.hasText){M.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}var w=M.LT,T=void 0===w?[0,0]:w,D=M.wordSize,E=m(T,2);u=E[0],c=E[1];var B=D[0]>>5,P=new Array(B*D[1]).fill(0),R=1/0,L=-1/0,I=1/0,F=-1/0;for(A=0;A<D[1];A++){var O=void 0;for(S=0;S<D[0];S++)if(C[4*((c+A)*r+(u+S))+3]>0){var z=1<<31-S%32;P[B*A+(S>>5)]|=z,S<I&&(I=S),S>F&&(F=S),O|=z}O&&(A<R&&(R=A),A>L&&(L=A))}M.bounds={dTop:(D[1]>>1)-R,dBottom:L-(D[1]>>1),dLeft:(D[0]>>1)-I,dRight:F-(D[0]>>1)},M.sprite=P,delete M.LT}}}function z1(t){for(var e=t.segmentation.labels,i=t.boardSize,n=t.size,r=i[0]>>5,a=new Array(r*n[1]).fill(0),o=0;o<n[1];o++)for(var s=0;s<n[0];s++)if(0===e[o*n[0]+s]){var l=1<<31-s%32;a[r*o+(s>>5)]|=l}if(i[0]>n[0])for(var u=(1<<i[0]-n[0])-1,c=0;c<n[1];c++)a[r*c+r-1]|=u;return a}function H1(t,e,i){(function(t,e){var i=e.segmentation.regions,n=-1/0,r=0,a=0;i.forEach((function(t,e){var i=t.area;i>n&&(n=i,a=e),r+=i}));var o=0;i.forEach((function(e){var i=e.area,a=Math.ceil(i/r*t.length),s=i/n;e.words=[],e.regionNum=a,e.regionWeight=s,o+=a})),o<t.length&&(i[a].wordsNum+=t.length-o);var s=a,l=i.map((function(t){return t.regionNum}));t.forEach((function(t){var e=0,n=0;t.regionIndex=-1;do{if(l[s]>0&&t.weight<=i[s].regionWeight){t.regionIndex=s,i[s].words.push(t),l[s]--,s=(s+1)%i.length;break}s=(s+1)%i.length,e++,++n>i.length+1&&(i.forEach((function(t){t.regionWeight+=.15})),n=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=a,i[a].words.push(t),l[a]--)})),i.forEach((function(t){t.words.sort((function(t,e){return e.weight-t.weight}))}))})(t,i),"ensureMapping"===e.layoutMode?R1(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){var n=e.size,r=e.stepFactor,a=e.importantWordCount,o=i.segmentation.regions,s=i.tempCanvas,l=i.boardSize,u=i.shapeCenter,c=i.shapeMaxR,h=i.shapeRatio,d=s.getContext("2d",{willReadFrequently:!0}),p=z1(i),f=p.slice(0),v=e.fontSizeEnlargeFactor,g=Math.min(a,t.length),y=0;t.length>g&&(y=t.sort((function(t,e){return e.weight-t.weight}))[g-1].weight);for(var m=0,_=1,b=!1,x=0;x<o.length;x++){for(var k=o[x],S=k.words,A=k.center,C=k.maxR,M=k.ratio,w=!1,T=0;T<S.length;T++){O1(s,d,t,T);var D=S[T];if(D.x=A[0],D.y=A[1],D.hasText&&D.sprite&&L1(f,D,C,M,n,l,r)){if(D.hasPlaced=!0,D.weight>=y&&m++,m>=g&&!b){_*=v,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*v})),f=p.slice(0),w=!0,m=0;break}}else{if(D.weight>=y&&_>1){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/v})),_/=v,b=!0,f=p.slice(0),w=!0;break}if(D.weight>=y)return R1(t,e,i)}}w&&(x=-1)}for(var E=0;E<e.textLayoutTimes;E++){var B=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===B.length)break;for(var P=0;P<B.length;P++){var R=B[P];O1(s,d,B,P),R.x=u[0],R.y=u[1],R.hasText&&L1(f,R,c,h,n,l,r)&&(R.hasPlaced=!0)}}e.board=f}(t,e,i):function(t,e,i){var n,r=e.size,a=e.stepFactor,o=i.segmentation.regions,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,p=z1(i),f=l.getContext("2d",{willReadFrequently:!0}),v=s(o);try{for(v.s();!(n=v.n()).done;)for(var g=n.value,y=g.words,m=g.center,_=g.maxR,b=g.ratio,x=0;x<y.length;x++){O1(l,f,t,x);var k=y[x];k.x=m[0],k.y=m[1],k.hasText&&k.sprite&&L1(p,k,_,b,r,u,a)&&(k.hasPlaced=!0)}}catch(t){v.e(t)}finally{v.f()}for(var S=0;S<e.textLayoutTimes;S++){var A=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===A.length)break;for(var C=0;C<A.length;C++){var M=A[C];O1(l,f,A,C),M.x=c[0],M.y=c[1],M.hasText&&L1(p,M,h,d,r,u,a)&&(M.hasPlaced=!0)}}e.board=p}(t,e,i);for(var n=function(t,e,i){for(var n=e.size,r=e.fillingTimes,a=e.fillingXStep,o=e.fillingYStep,s=e.getFillingFontStyle,l=e.getFillingFontWeight,u=e.getFillingFontFamily,c=e.fillingInitialFontSize,h=e.fillingDeltaFontSize,d=e.fillingInitialOpacity,p=e.fillingDeltaOpacity,f=e.fillingRotateList,v=e.getFillingPadding,g=e.random,y=e.board,m=e.minFillFontSize,_=i.boardSize,b=i.shapeBounds,x=i.tempCanvas,k=i.randomGenerator,S=x.getContext("2d",{willReadFrequently:!0}),A=c,C=d,M=[],w=0;w<r;w++)T(A,C),A=Math.max(A>h?A-h:h,m),C=C>p?C-p:p;return M;function T(e,i){var r=t.map((function(t){var n=t.text,r=t.color,a=t.fillingColor,o=t.hasPlaced,c=t.datum;return{x:0,y:0,weight:0,text:n,fontFamily:u(c),fontStyle:s(c),fontWeight:l(c),fontSize:e,rotate:f[~~(k()*f.length)],padding:v(c),opacity:i,visible:!0,color:r,fillingColor:a,hasPlaced:o,datum:c}}));D(r);for(var c=0,h=b.x1,d=b.y1,p=b.x2,m=b.y2,A=h+~~(k()*a*2),C=d+~~(k()*o*2);C<=m;C+=o)for(var w=A;w<=p;w+=a){O1(x,S,r,c);var T=r[c];T.x=w,T.y=C,T.wordSize;var E=T.bounds;if(T.hasPlaced&&E){var B=E.dTop,P=E.dBottom,R=E.dLeft,L=E.dRight;T.x-R<0||T.x+L>n[0]||T.y-B<0||T.y+P>n[1]||T.hasText&&T.sprite&&!F1(T,y,_)&&(I1(T,y,_),M.push(Object.assign({},T)),++c===r.length&&(c=0,g&&D(r)))}else++c===r.length&&(c=0,g&&D(r))}}function D(t){return t.sort((function(){return k()-.5}))}}(t,e,i),r=[],a=[],o=0;o<t.length;o++)t[o].hasPlaced?a.push(t[o]):r.push(t[o]);return r.forEach((function(t){return t.visible=!1})),{fillingWords:n,successedWords:a,failedWords:r}}function N1(t,e){return t&&(nt(t)||at(t)||t.startsWith("<svg"))?new Promise((function(i,n){var r,a=e({image:t}),o=null===(r=a.resources)||void 0===r?void 0:r.get(t);o&&"success"===o.state&&o.data?i(o.data):(a.successCallback=function(){var e;if(a){var r=null===(e=a.resources)||void 0===e?void 0:e.get(t);r&&"success"===r.state&&r.data?i(r.data):n(new Error("image load failed: "+t))}else n(new Error("image load failed: "+t))},a.failCallback=function(){n(new Error("image load failed: "+t))})})):null}function U1(t,e){return Promise.allSettled(t.map((function(t){return N1(t,e)})))}var j1={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"},V1=function(){return o((function t(e){r(this,t),this.progressiveResult=[],this.options=e}),[{key:"layout",value:function(t){var e=this;this.data=t;var i=this.options,n={shapeUrl:i.shape,size:i.size,ratio:i.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},r=this.options.createCanvas({width:i.size[0],height:i.size[1]}),a=r.getContext("2d",{willReadFrequently:!0});a.textAlign="center",a.textBaseline="middle",n.tempCanvas=r;var o=i.size[0]+31>>5<<5;if(n.boardSize=[o,i.size[1]],n.random?n.randomGenerator=Math.random:n.randomGenerator=Ee(),this.segmentationInput=n,q(n.shapeUrl)){n.isEmptyPixel=u1(void 0,void 0,this.options.createCanvas);var s=N1(n.shapeUrl,this.options.createImage);s?(this.isImageFinished=!1,this.isLayoutFinished=!1,s.then((function(t){e.isImageFinished=!0;var r=e.options.createCanvas({width:i.size[0],height:i.size[1],dpr:1});n.maskCanvas=r;var a=r.getContext("2d");i.removeWhiteBorder&&m1(t,r,n.isEmptyPixel);var o=_1(t,i.size);a.clearRect(0,0,i.size[0],i.size[1]),a.drawImage(t,o.x,o.y,o.width,o.height),e.options.onUpdateMaskCanvas&&e.options.onUpdateMaskCanvas(n.maskCanvas)})).catch((function(t){e.isImageFinished=!0}))):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(n.shapeUrl&&("text"===n.shapeUrl.type||"geometric"===n.shapeUrl.type)){n.isEmptyPixel=u1(n.shapeUrl.backgroundColor,void 0,this.options.createCanvas);var l=c1(n.shapeUrl,i.size[0],i.size[1],void 0,!1,this.options.createCanvas);n.maskCanvas=l,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(l),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}},{key:"canAnimate",value:function(){return!0}},{key:"unfinished",value:function(){return!this.isLayoutFinished}},{key:"output",value:function(){return this.progressiveResult}},{key:"progressiveRun",value:function(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}},{key:"progressiveOutput",value:function(){return this.progressiveResult}},{key:"doLayout",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x=this.segmentationInput,k=y1(x);if(k.segmentation.regions.length){var S=this.options,A=this.data,C=S.colorMode||"ordinal",M={getText:Le(S.text),getFontSize:Le(S.fontSize),fontSizeRange:S.fontSizeRange,colorMode:C,getColor:S.colorField?Le(S.colorField):Le(S.text),getFillingColor:Le(S.fillingColorField),colorList:S.colorList||("ordinal"===C?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:Le(S.colorHexField),getFontFamily:Le(S.fontFamily||"sans-serif"),rotateList:S.rotateList||[0],getPadding:Le(S.padding||1),getFontStyle:Le(S.fontStyle||"normal"),getFontWeight:Le(S.fontWeight||"normal"),getFontOpacity:S.fontOpacity?Le(S.fontOpacity):function(){return 1}};G1(A,M,k);var w={size:S.size,ratio:S.ratio||.8,shapeUrl:S.shape,random:void 0===S.random||S.random,textLayoutTimes:null!==(t=S.textLayoutTimes)&&void 0!==t?t:3,removeWhiteBorder:S.removeWhiteBorder,layoutMode:null!==(e=S.layoutMode)&&void 0!==e?e:"default",fontSizeShrinkFactor:null!==(i=S.fontSizeShrinkFactor)&&void 0!==i?i:.8,stepFactor:null!==(n=S.stepFactor)&&void 0!==n?n:1,importantWordCount:null!==(r=S.importantWordCount)&&void 0!==r?r:10,globalShinkLimit:S.globalShinkLimit||.2,fontSizeEnlargeFactor:null!==(a=S.fontSizeEnlargeFactor)&&void 0!==a?a:1.5,fillingRatio:null!==(o=S.fillingRatio)&&void 0!==o?o:.7,fillingTimes:null!==(s=S.fillingTimes)&&void 0!==s?s:4,fillingXStep:S.fillingXRatioStep?Math.max(Math.floor(S.size[0]*S.fillingXRatioStep),1):null!==(l=S.fillingXStep)&&void 0!==l?l:4,fillingYStep:S.fillingYRatioStep?Math.max(Math.floor(S.size[1]*S.fillingYRatioStep),1):null!==(u=S.fillingYStep)&&void 0!==u?u:4,fillingInitialFontSize:S.fillingInitialFontSize,fillingDeltaFontSize:S.fillingDeltaFontSize,fillingInitialOpacity:null!==(c=S.fillingInitialOpacity)&&void 0!==c?c:.8,fillingDeltaOpacity:null!==(h=S.fillingDeltaOpacity)&&void 0!==h?h:.05,getFillingFontFamily:Le(S.fillingFontFamily||"sans-serif"),getFillingFontStyle:Le(S.fillingFontStyle||"normal"),getFillingFontWeight:Le(S.fillingFontWeight||"normal"),getFillingPadding:Le(null!==(d=S.fillingPadding)&&void 0!==d?d:.4),fillingRotateList:null!==(p=S.fillingRotateList)&&void 0!==p?p:[0,90],fillingDeltaFontSizeFactor:null!==(f=S.fillingDeltaFontSizeFactor)&&void 0!==f?f:.2,fillingColorList:S.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:null!==(v=S.minInitFontSize)&&void 0!==v?v:10,minFontSize:null!==(g=S.minFontSize)&&void 0!==g?g:4,minFillFontSize:null!==(y=S.minFillFontSize)&&void 0!==y?y:2},T=function(t,e){if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(M.colorList,w.fillingColorList);w.sameColorList=T,W1(A,M,w,S),function(t,e,i,n){var r=e.getText,a=i.fillingInitialFontSize,o=i.fillingDeltaFontSize,s=i.fillingRatio,l=Math.ceil(Math.sqrt(n.shapeArea)/4);if(!a||!o){var u,c=s/100,h=t.reduce((function(t,e){var i=P1(r(e));return i>l?t:t+i}),0)/t.length;if(0===h)u=8;else{var d=.2*n.shapeArea;u=Math.sqrt(c*(d/h))}a=~~u,o=u*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:a,fillingDeltaFontSize:o})}}(A,M,w,k);var D=M.getText,E=M.getFontFamily,B=M.getFontStyle,P=M.getFontWeight,R=M.getPadding,L=M.getColor,I=M.getFillingColor,F=M.getColorHex,O=M.fontSizeScale,z=M.colorScale,H=M.fillingColorScale,N=M.getFontOpacity,U=M.rotateList,j=A.map((function(t){var e,i;return{x:0,y:0,weight:0,text:D(t),fontFamily:E(t),fontWeight:P(t),fontStyle:B(t),rotate:U[~~(x.randomGenerator()*U.length)],fontSize:Math.max(w.minInitFontSize,~~O(t)),opacity:N(t),padding:R(t),color:F&&F(t)||z&&z(L(t))||"black",fillingColor:!I||(null===(e=S.colorField)||void 0===e?void 0:e.field)===(null===(i=S.fillingColorField)||void 0===i?void 0:i.field)&&T?void 0:F&&F(t)||H&&H(I(t))||"black",datum:t,visible:!0,hasPlaced:!1}})),V=Bt(j.map((function(t){return t.fontSize})));j.forEach((function(t){return t.weight=t.fontSize/V})),j.sort((function(t,e){return e.weight-t.weight}));for(var W,G,Y=H1(j,w,k),X=Y.fillingWords,K=Y.successedWords,q=Y.failedWords,Z=null!==(_=null===(m=S.text)||void 0===m?void 0:m.field)&&void 0!==_?_:"textKey",J=null!==(b=S.dataIndexKey)&&void 0!==b?b:"defaultDataIndexKey",Q=S.as?Object.assign(Object.assign({},j1),S.as):j1,$=[],tt=0;tt<j.length;++tt)(G=(W=j[tt]).datum)[Q.x]=W.x,G[Q.y]=W.y,G[Q.fontFamily]=W.fontFamily,G[Q.fontSize]=W.fontSize,G[Q.fontStyle]=W.fontStyle,G[Q.fontWeight]=W.fontWeight,G[Q.angle]=Ci(W.rotate),G[Q.opacity]=W.opacity,G[Q.visible]=W.visible,G[Q.isFillingWord]=!1,G[Q.color]=W.color,G[J]="".concat(W.text,"_").concat(tt,"_keyword"),$.push(G);var et=[];X.forEach((function(t,e){var i,n,r=Object.assign({},t.datum);r[Q.x]=t.x,r[Q.y]=t.y,r[Q.fontFamily]=t.fontFamily,r[Q.fontSize]=t.fontSize,r[Q.fontStyle]=t.fontStyle,r[Q.fontWeight]=t.fontWeight,r[Q.angle]=Ci(t.rotate),r[Q.opacity]=t.opacity,r[Q.visible]=t.visible,r[Q.isFillingWord]=!0,r[Q.color]=I?(null===(i=S.colorField)||void 0===i?void 0:i.field)===(null===(n=S.fillingColorField)||void 0===n?void 0:n.field)&&T?t.color:t.fillingColor:w.fillingColorList[~~(x.randomGenerator()*w.fillingColorList.length)],r[Z]=t.text,r[J]="".concat(t.text,"_").concat(e,"_fillingWords"),et.push(r)})),this.options.onLayoutFinished&&this.options.onLayoutFinished({successedWords:K,failedWords:q}),this.progressiveResult=$.concat(et)}}},{key:"release",value:function(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}])}(),W1=function(t,e,i,n){var r,a,o,s,l,u,c=e.colorMode,h=e.getColor,d=e.getFillingColor,p=i.sameColorList,f=e.colorList,v=i.fillingColorList;if("ordinal"===c){var g=t.map((function(t){return h(t)}));if(l=function(t){return(new kO).domain(g).range(f).scale(t)},d&&((null===(r=n.colorField)||void 0===r?void 0:r.field)!==(null===(a=n.fillingColorField)||void 0===a?void 0:a.field)||!p)){var y=t.map((function(t){return d(t)}));u=function(t){return(new kO).domain(y).range(v).scale(t)}}}else{1===f.length&&(f=[f[0],f[0]]);var m=(new YO).domain(K1(h,t)).range(f);if(l=function(t){return m.scale(t)},d&&((null===(o=n.colorField)||void 0===o?void 0:o.field)!==(null===(s=n.fillingColorField)||void 0===s?void 0:s.field)||!p)){1===v.length&&(v=[v[0],v[0]]);var _=(new YO).domain(K1(d,t)).range(v);u=function(t){return _.scale(t)}}}Object.assign(e,{colorScale:l,fillingColorScale:u})},G1=function(t,e,i){var n,r,a=e.fontSizeRange,o=e.getFontSize,s=e.getText;if(o){if(o&&a){var l=(new QO).domain(K1(o,t)).range(a);n=function(t){return l.scale(o(t))}}else if(o&&U(o)&&!a){var u=m(K1(o,t),2),c=u[0],h=u[1],d=t.map((function(t){return{text:s(t),value:o(t),weight:h===c?1:(o(t)-c)/(h-c)}})),p=Y1(d,i,!0);a=[~~(.5*p),~~p];var f=(new QO).domain(K1(o,t)).range(a);n=function(t){return f.scale(o(t))}}}else{var v=t.map((function(t){return{text:s(t)}})),g=Y1(v,i,!1);n="function"==typeof(r=g)?r:function(){return r}}Object.assign(e,{getFontSize:o,fontSizeRange:a,fontSizeScale:n})},Y1=function(t,e,i){var n=e.shapeArea,r=e.ratio,a=e.segmentation.regions,o=Math.ceil(Math.sqrt(n)/12),s=t.reduce((function(t,e){var n=P1(e.text);return n<o?t+n*(i?Math.pow(.5+.5*e.weight,2):1):t}),0);if(0===s)return 12;var l=20;if(1===a.length)l=Math.sqrt(r*(n/(1.7*s)));else{for(var u=[],c=0;c<a.length;c++){var h=a[c].area,d=a[c].ratio,p=h/n;if(!(p<.1)){var f=p*(s*(d<1?2.7-d:1.7)),v=Math.sqrt(r*(h/f));u.push(v)}}l=u.length?Math.min.apply(Math,u):Math.sqrt(r*(n/(1.7*s)))}return l};var X1,K1=function(t,e){for(var i,n=1/0,r=-1/0,a=e.length,o=0;o<a;++o)(i=Ht(t(e[o])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]},q1=function(t,e,i){if(!t.size||j(t.size[0])||j(t.size[1])||t.size[0]<=0||t.size[1]<=0)return Wt.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||Wt.getInstance().error("WordcloudShape shape must be specified."),t.text||Wt.getInstance().error("WordcloudShape text must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];var n=new V1(t);return n.layout(e),n.unfinished()?{progressive:n}:n.output()};function Z1(t,e){t.aspectRatio>1?(t.width=e,t.height=~~(e/t.aspectRatio)):(t.height=e,t.width=~~(e*t.aspectRatio))}!function(t){t.BEFORE_IMAGECLOUD_LAYOUT="beforeImagecloudLayout",t.AFTER_IMAGECLOUD_LAYOUT="afterImagecloudLayout",t.AFTER_IMAGECLOUD_DRAW="afterImagecloudDraw"}(X1||(X1={}));var J1=function(){return o((function t(e){r(this,t),this.progressiveResult=[],this.imageCollageList=[],this.options=e}),[{key:"preProcess",value:function(){var t=this,e=this.options,i=e.imageConfig,n=void 0===i?{}:i,r=e.weight,a=n.padding,o=void 0===a?0:a,s=this.imageCollageList;return s.forEach((function(e,i){!1===e.valid?(e.x=-10,e.y=-10,e.width=0,e.height=0,e.opacity=0):(e.padding=o,e.weight=Le(r)(t.data[i]),e.datum=t.data[i])})),s=s.filter((function(t){return!1!==t.valid})).sort((function(t,e){return e.weight-t.weight})),s}},{key:"onImageCollageInputReady",value:function(t){var e=this;t.forEach((function(t,i){if("fulfilled"===t.status){var n=t.value,r=n.width,a=n.height;e.imageCollageList.push(Object.assign({},e.data[i],{aspectRatio:r/a}))}else e.imageCollageList.push(Object.assign({},e.data[i],{valid:!1}))}))}},{key:"layout",value:function(t){this.data=t,this.loadSegmentationInput(),this.loadImageCollageInput()}},{key:"loadSegmentationInput",value:function(){var t,e,i,n,r,a,o=this,s=this.options,l=s.size,u={shapeUrl:null!==(t=s.mask)&&void 0!==t?t:{type:"geometric",shape:"rect"},size:l,ratio:s.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0,blur:null===(e=s.maskConfig)||void 0===e?void 0:e.edgeBlur},c=this.options.createCanvas({width:l[0],height:l[1]}),h=c.getContext("2d",{willReadFrequently:!0});h.textAlign="center",h.textBaseline="middle",u.tempCanvas=c;var d=l[0]+31>>5<<5;if(u.boardSize=[d,l[1]],u.random?u.randomGenerator=Math.random:u.randomGenerator=Ee(),this.segmentationInput=u,q(u.shapeUrl)){u.isEmptyPixel=u1(void 0,{threshold:null!==(n=null===(i=s.maskConfig)||void 0===i?void 0:i.threshold)&&void 0!==n?n:200,invert:null===(r=s.maskConfig)||void 0===r?void 0:r.invert},this.options.createCanvas);var p=N1(u.shapeUrl,this.options.createImage);p?(this.isMaskImageFinished=!1,this.isLayoutFinished=!1,p.then((function(t){var e,i;o.isMaskImageFinished=!0;var n=s.size,r=o.options.createCanvas({width:n[0],height:n[1],dpr:1});u.maskCanvas=r;var a=r.getContext("2d");(null===(e=s.maskConfig)||void 0===e?void 0:e.removeWhiteBorder)&&m1(t,r,u.isEmptyPixel);var l,c=_1(t,n);a.clearRect(0,0,n[0],n[1]),a.drawImage(t,c.x,c.y,c.width,c.height),o.segmentationOutput=y1(o.segmentationInput),"masked"===(null===(i=o.options.layoutConfig)||void 0===i?void 0:i.placement)&&(l=o.generateTransparentMaskCanvas(t,n)),o.segmentationOutput.transparentMaskCanvas=l,o.options.onUpdateMaskCanvas&&o.options.onUpdateMaskCanvas(r,l)})).catch((function(t){o.isMaskImageFinished=!0}))):(this.isMaskImageFinished=!0,this.isLayoutFinished=!0)}else if(u.shapeUrl&&("text"===u.shapeUrl.type||"geometric"===u.shapeUrl.type)){u.isEmptyPixel=u1(u.shapeUrl.backgroundColor,void 0,this.options.createCanvas),"text"!==u.shapeUrl.type&&"geometric"!==u.shapeUrl.type||u.shapeUrl.backgroundColor||(u.shapeUrl.backgroundColor="rgba(255,255,255,255)");var f=c1(u.shapeUrl,l[0],l[1],void 0,null===(a=s.maskConfig)||void 0===a?void 0:a.invert,this.options.createCanvas);u.maskCanvas=f,this.segmentationOutput=y1(this.segmentationInput),this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(f,f),this.isMaskImageFinished=!0}}},{key:"loadImageCollageInput",value:function(){var t=this,e=U1(this.data.map((function(e){return Le(t.options.image)(e)})),this.options.createImage);e?e.then((function(e){t.onImageCollageInputReady(e),t.isImagesFinished=!0})).catch((function(e){t.isImagesFinished=!0,t.isLayoutFinished=!0,Wt.getInstance().error("image load failed",e)})):(this.isImagesFinished=!0,this.isLayoutFinished=!0)}},{key:"canAnimate",value:function(){return!0}},{key:"unfinished",value:function(){return!this.isLayoutFinished}},{key:"output",value:function(){return this.progressiveResult}},{key:"progressiveRun",value:function(){if(this.isImagesFinished&&this.isMaskImageFinished&&!this.isLayoutFinished){var t=this.preProcess(),e=this.doLayout(t);this.options&&this.options.onLayoutEnd&&this.options.onLayoutEnd(e),this.progressiveResult=this.processOutput(e),this.isLayoutFinished=!0}}},{key:"progressiveOutput",value:function(){return this.progressiveResult}},{key:"release",value:function(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}},{key:"calculateImageSize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.45,n=e.imageSizeRange,r=e.padding,a=void 0===r?0:r,o=$(e.imageSize)?e.imageSize:Re(e.imageSize),s=this.options.size;if(o||n)if(o&&!U(o))t.forEach((function(t){return Z1(t,o)}));else if(n){var l=(new QO).domain(Oe(t,(function(t){return t.weight}))).range(n);t.forEach((function(t){return Z1(t,~~l.scale(t.weight))}))}else if(o&&U(o)&&!n){var u=.5,c=m(Oe(t,(function(t){return t.weight})),2),h=c[0],d=c[1],p=t.reduce((function(t,e){var i=e.aspectRatio,n=(e.weight-h)/(d-h);return t+(i>1?1/i:i)*Math.pow(u+.5*n,2)}),0),f=~~Math.sqrt(i*s[0]*s[1]/p),v=[~~(u*f)-2*a<0?1:~~(u*f)-2*a,~~f-2*a<0?1:~~f-2*a],g=(new QO).domain(Oe(t,(function(t){return t.weight}))).range(v);t.forEach((function(t){return Z1(t,~~g.scale(t.weight))}))}else console.warn("image cloud imageSize error");else{var y=t.reduce((function(t,e){var i=e.aspectRatio;return t+(i>1?1/i:i)}),0),_=~~Math.sqrt(i*s[0]*s[1]/y);_=_-2*a<0?1:_-2*a,t.forEach((function(t){return Z1(t,_)}))}return t}},{key:"generateTransparentMaskCanvas",value:function(t,e){var i,n=this.options.createCanvas({width:e[0],height:e[1],dpr:1}),r=n.getContext("2d");this.segmentationOutput.transparentMaskCanvas=n,(null===(i=this.options.maskConfig)||void 0===i?void 0:i.removeWhiteBorder)&&m1(t,n,this.segmentationInput.isEmptyPixel);for(var a=r.createImageData(e[0],e[1]),o=this.segmentationOutput.segmentation.labels,s=0;s<o.length;s++){var l=0===o[s]?255:0,u=255*o[s],c=4*s;a.data[c]=l,a.data[c+1]=l,a.data[c+2]=l,a.data[c+3]=u}return r.clearRect(0,0,e[0],e[1]),r.fillStyle="rgba(255,255,255,0)",r.fillRect(0,0,e[0],e[1]),r.putImageData(a,0,0),n}},{key:"processOutput",value:function(t){var e,i=null===(e=this.options)||void 0===e?void 0:e.as;return i&&Object.keys(i).forEach((function(e){t.forEach((function(t){t[i[e]]=t[e],delete t[e]}))})),t}}])}(),Q1=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"preProcess",value:function(){var t=_(e,"preProcess",this,3)([]),i=this.options,n=i.imageConfig,r=void 0===n?{}:n,a=i.ratio,o=void 0===a?.45:a;return this.calculateImageSize(t,r,o)}},{key:"tryPlaceImage",value:function(t,e,i,n,r){for(var a,o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=m(e,2),u=l[0],c=l[1],h=u/2,d=c/2,p=Math.sqrt(Math.pow(h,2)+Math.pow(d,2)),f=i1[i](e),v=-s,g=n.segmentation.labels;a=(_=m(y=f(v+=s),2))[0],o=_[1],y&&!(Math.min(Math.abs(a),Math.abs(o))>=p);){var y,_;if(a-=t.width/2,o-=t.height/2,t.visible=!0,t.x=~~(h+a),t.y=~~(d+o),t._left=t.x+t.padding,t._top=t.y+t.padding,t._leftWithoutPadding=t.x,t._topWithoutPadding=t.y,$1(t,r)){for(var b=t.x,x=t.y,k=t.width,S=t.height,A=!1,C=0;C<k;C++){for(var M=0;M<S&&x+C<=c;M++)if(!(b+M>u||g[(x+C)*u+(b+M)])){A=!0;break}if(A)break}if(!A){for(var w=!0,T=0,D=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x,y:t.y+t.height},{x:t.x+t.width,y:t.y+t.height}];T<D.length;T++){var E=D[T];if(!g[E.y*u+E.x]){w=!1;break}}if(!w)continue;return!0}}}return!1}},{key:"doLayout",value:function(t){var e,i,n=this.segmentationOutput,r=this.options.layoutConfig,a=void 0===r?{}:r,o=this.options.size,l=a.spiralType,u=void 0===l?"archimedean":l,c=a.fillingTimes,h=void 0===c?4:c,d=a.minFillingImageSize,p=void 0===d?10:d,f=[],v=Object.keys(t[0]).find((function(t){return t.includes("VGRAMMAR")})),g=s(t);try{for(g.s();!(i=g.n()).done;){var y=i.value;y._widthWithPadding=y.width+2*y.padding,y._heightWithPadding=y.height+2*y.padding,y.frequency=1,this.tryPlaceImage(y,o,u,n,f)&&f.push(y)}}catch(t){g.e(t)}finally{g.f()}for(var m=Pt(f,(function(t,e){return t.width-e.width})).width,_=Pt(f,(function(t,e){return t.height-e.height})).height,b=[],x=0;x<h;x++){var k,S=.5*m-1*x,A=.5*_-1*x,C=s(t);try{for(C.s();!(k=C.n()).done;){var M=k.value,w=Object.assign({},M,{visible:!0});Z1(w,Math.max(p,w.aspectRatio>1?S:A)),w._widthWithPadding=w.width+2*w.padding,w._heightWithPadding=w.height+2*w.padding,this.tryPlaceImage(w,o,u,n,[].concat(b,f),.5)&&(M._tempFrequency=(null!==(e=M._tempFrequency)&&void 0!==e?e:M.frequency)+1,w.frequency=M._tempFrequency,w.distance=Math.sqrt(Math.pow(w.x-o[0]/2,2)+Math.pow(w.y-o[1]/2,2)),w[v]="".concat(w[v],"_").concat(w.frequency),b.push(w))}}catch(t){C.e(t)}finally{C.f()}}return[].concat(f,b).filter((function(t){return t.visible}))}}])}(J1);function $1(t,e){for(var i=0;i<e.length;i++)if(t2(t,e[i]))return!1;return!0}function t2(t,e){return!(t._leftWithoutPadding+t._widthWithPadding<e._leftWithoutPadding||t._topWithoutPadding+t._heightWithPadding<e._topWithoutPadding||t._leftWithoutPadding>e._leftWithoutPadding+e._widthWithPadding||t._topWithoutPadding>e._topWithoutPadding+e._heightWithPadding)}function e2(t){var e,i=t.imageConfig,n=void 0===i?{}:i,r=t.size,a=t.ratio,o=void 0===a?.1:a,s=t.layoutConfig,l=void 0===s?{}:s,u=n.padding,c=void 0===u?0:u,h=n.imageSize,d=m(r,2),p=d[0],f=d[1];(e=h||Math.min(p,f)*o-2*c)<0&&(e=1);var v,g,y=l.rectAspectRatio,_=void 0===y?1:y;_>1?(v=e,g=e/_):(g=e,v=e*_);for(var b=Math.ceil(f/(g+c)),x=Math.ceil(p/(v+c)),k=p/2,S=f/2,A=new Array(x*b),C=0;C<b;C++)for(var M=0;M<x;M++){var w=M*(v+c)+v/2,T=C*(g+c)+g/2;A[C*x+M]={centerX:w,centerY:T,x:w-v/2,y:T-g/2,row:C,col:M,distance:Math.sqrt(Math.pow(w-k,2)+Math.pow(T-S,2))}}return{context:Object.assign({},l,{cellWidth:v,cellHeight:g,cellInfo:A,cellCount:A.length,cellType:"rect",cellPixelCount:v*g,eachPixel:function(t,e){for(var i=t.x,n=t.y,r=0;r<v;r++)for(var a=0;a<g&&n+r<=f;a++)i+a>p||e((~~n+r)*p+(~~i+a))},clipPath:"M".concat(-v/2," ").concat(-g/2," L").concat(v/2," ").concat(-g/2," L").concat(v/2," ").concat(g/2," L").concat(-v/2," ").concat(g/2," Z")}),imageLength:e}}var i2,n2,r2={rect:e2,circle:function(t){var e=t.imageConfig,i=void 0===e?{}:e,n=t.size,r=t.ratio,a=void 0===r?.1:r,o=t.layoutConfig,s=void 0===o?{}:o,l=i.padding,u=void 0===l?0:l,c=i.imageSize,h=void 0===c?0:c,d=m(n,2),p=d[0],f=d[1],v=p/2,g=f/2,y=0;(y=h?h/2:Math.min(p,f)*a/2)-u<=0&&(y=u+1);for(var _=2*y,b=Math.sqrt(3)/2*_+u,x=[],k=0,S=0;S*b-y<f;S++)for(var A=S*b,C=S%2==0?0:y,M=-1;M*(_+u)+C-y<p;M++){var w=M*(_+u)+C+y;x[k++]={centerX:w,centerY:A,x:w-y,y:A-y,row:S,col:M,distance:Math.sqrt(Math.pow(w-v,2)+Math.pow(A-g,2))}}for(var T=0,D=y*y,E=0;E<_;E++)for(var B=0;B<_;B++){var P=E-y,R=B-y;P*P+R*R<=D&&T++}return{context:Object.assign({},s,{cellWidth:_,cellHeight:_,cellInfo:x,cellCount:x.length,cellType:"circle",cellPixelCount:T,eachPixel:function(t,e){for(var i=t.x,n=t.y,r=0;r<_;r++)for(var a=0;a<_;a++)if(!(r+i<0||r+i>p||a+n>f||a+n<0)){var o=r-y,s=a-y;o*o+s*s<=D&&e((~~n+r)*p+(~~i+a))}},clipPath:"M 1 0 A 1 1 0 1 0 -1 0 A 1 1 0 1 0 1 0 Z"}),imageLength:_}},hexagonal:function(t){var e,i=t.imageConfig,n=void 0===i?{}:i,r=t.size,a=t.ratio,o=void 0===a?.1:a,s=t.layoutConfig,l=void 0===s?{}:s,u=n.padding,c=void 0===u?0:u,h=n.imageSize,d=m(r,2),p=d[0],f=d[1],v=p/2,g=f/2;(e=h?h/2:Math.min(p,f)*o/2)-c<=0&&(e=c+1);for(var y=[],_=2*Math.PI/6,b=0;b<6;b++){var x=_*b;y.push({x:(e-c/2)*Math.cos(x),y:(e-c/2)*Math.sin(x)})}for(var k=2*e,S=Math.sin(Math.PI/6)*k,A=Math.sqrt(3)*S,C=k-S/2,M=Math.cos(Math.PI/6)*k,w=M/2,T=Math.floor(f/A),D=Math.floor(p/S),E=[],B=-1;B<=T+1;B++)for(var P=-1;P<=D;P++){var R=P*C,L=B*M+(P%2?w:0);E.push({centerX:R,centerY:L,x:R-S,y:L-S,row:B,col:P,distance:Math.sqrt(Math.pow(R-v,2)+Math.pow(L-g,2))})}for(var I=0,F=[],O=0;O<=A;O++)for(var z=0;z<=2*S;z++){var H=z-S,N=O-A/2,U=Math.abs(H),j=Math.abs(N);U<=S&&j<=A/2&&2*j+U*Math.sqrt(3)<=A?(I++,F.push(!0)):F.push(!1)}return{context:Object.assign({},l,{cellHexSideLength:S,cellHexPoints:y,cellHeight:A,cellWidth:2*S,cellInfo:E,cellCount:E.length,cellType:"hexagonal",cellPixelCount:I,eachPixel:function(t,e){for(var i=t.x,n=t.y,r=0,a=0;a<=A;a++)for(var o=0;o<=2*S;o++)F[r++]&&e((~~n+a)*p+(~~i+o))},clipPath:"M 1 0 L 0.5 0.866 L -0.5 0.866 L -1 0 L -0.5 -0.866 L 0.5 -0.866 Z"}),imageLength:k-c}}},a2=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"preProcess",value:function(){var t,i=_(e,"preProcess",this,3)([]),n=this.options.layoutConfig,r=(void 0===n?{}:n).cellType,a=(null!==(t=r2[void 0===r?"rect":r])&&void 0!==t?t:r2.rect)(this.options),o=a.context,s=a.imageLength;return i.forEach((function(t){return function(t,e){t.aspectRatio>1?(t.height=e,t.width=~~(e*t.aspectRatio)):(t.width=e,t.height=~~(e/t.aspectRatio))}(t,s)})),o.cellInfo.sort((function(t,e){return t.distance-e.distance})),this.layoutContext=o,i}},{key:"doLayout",value:function(t){var e=this.layoutContext,i=e.cellWidth,n=e.cellHeight,r=e.cellInfo,a=e.cellCount,o=e.clipPath,s=e.eachPixel,l=e.cellPixelCount;if(0!==t.length&&0!==a&&0!==i&&0!==n&&0!==r.length){var u=this.segmentationOutput,c=this.options.layoutConfig,h=(void 0===c?{}:c).placement,d=void 0===h?"default":h;if("edge"===d||"default"===d){var p=u.segmentation.labels;r.forEach((function(t){var e=0;s(t,(function(t){p[t]&&e++})),t.intersectPixels=e}))}for(var f=t.length,v=function(t){var e=t.intersectPixels;return"default"===d?e>=.45*l:"edge"!==d||e>.1*l&&e<l},g=0;g<f;g++){var y=t[g],m=r[g];m&&(y.x=m.centerX-y.width/2,y.y=m.centerY-y.height/2,y.clipConfig={shape:o},y.frequency=1,y.visible=v(m),y.cell=bt(m,["image"]),y.distance=m.distance,m.image=y)}var _=Object.keys(t[0]).find((function(t){return t.includes("VGRAMMAR")}));if(f<a)for(var b=f;b<a;b++){var x=t[b-f],k=r[b];if(k){var S=Object.assign({},x);S.x=k.centerX-S.width/2,S.y=k.centerY-S.height/2,S.frequency+=1,S[_]="".concat(S[_],"_").concat(S.frequency),S.visible=v(k),S.distance=k.distance,S.cell=bt(k,["image"]),k.image=S,t.push(S)}}return t.filter((function(t){return t.visible}))}this.isLayoutFinished=!0}}])}(J1),o2=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"preProcess",value:function(){var t=_(e,"preProcess",this,3)([]),i=this.options,n=i.imageConfig,r=void 0===n?{}:n,a=i.ratio,o=void 0===a?.1:a,s=e2;return this.layoutContext=s(Object.assign({},this.options,{imageConfig:{imageSize:null}})).context,this.layoutContext.cellInfo.sort((function(t,e){return t.distance-e.distance})),this.calculateImageSize(t,r,o)}},{key:"doLayout",value:function(t){var e=this.segmentationOutput,i=this.layoutContext,n=i.cellWidth,r=i.cellHeight,a=i.cellInfo,o=i.cellCount,s=i.eachPixel,l=i.cellPixelCount;if(0!==t.length&&0!==o&&0!==n&&0!==r&&0!==a.length){var u=this.options.layoutConfig,c=void 0===u?{}:u,h=this.options.size,d=c.placement,p=void 0===d?"default":d,f=c.maxAngle,v=void 0===f?Math.PI/180*45:f;if("edge"===p||"default"===p){var g=e.segmentation.labels;a.forEach((function(t){var e=0;s(t,(function(t){g[t]&&e++})),t.intersectPixels=e}))}for(var y=t.length,m=Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)),_=function(t){var e=t.intersectPixels;return"default"===p?e>.5*l:"edge"!==p||e>.1*l&&e<l},b=0;b<y;b++){var x=t[b],k=a[b];k&&(x.x=k.centerX-x.width/2,x.y=k.centerY-x.height/2,x.visible=_(k),x.cell="".concat(k.row,"_").concat(k.col),x.angle=Math.random()*(2*v)-v,x.anchor=[x.x+x.width/2,x.y+x.height/2],x.zIndex=m-k.distance,x.distance=k.distance,x.frequency=1,k.image=x)}var S=Object.keys(t[0]).find((function(t){return t.includes("VGRAMMAR")}));if(y<o)for(var A=y;A<o;A++){var C=t[A-y],M=a[A];if(M){var w=Object.assign({},C);w.x=M.centerX-w.width/2,w.y=M.centerY-w.height/2,w.anchor=[w.x+w.width/2,w.y+w.height/2],w.angle=Math.random()*(2*v)-v,w.frequency+=1,w[S]="".concat(w[S],"_").concat(w.frequency),w.visible=_(M),w.cell="".concat(M.row,"_").concat(M.col),w.distance=M.distance,w.zIndex=m-M.distance,M.image=w,t.push(w)}}return t.filter((function(t){return t.visible}))}this.isLayoutFinished=!0}}])}(J1),s2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.wordCloud,i}return C(i,e),i.type=t.SeriesTypeEnum.wordCloud,i}(O$),l2=function(){ij.registerGrammarTransform("wordcloud",{transform:C1}),wJ(),ij.registerAnimation("wordCloud",(function(t,e){return{appear:z$(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),ij.registerSeries(s2.type,s2)},u2=function(t,e){var i,n,r=t.map((function(t){return M({},t)}));if(!r||0===r.length)return r;var a=e.valueField,o=e.asTransformRatio,s=e.asReachRatio,l=e.asHeightRatio,u=e.asValueRatio,c=e.asNextValueRatio,h=e.asLastValueRatio,d=e.asLastValue,p=e.asCurrentValue,f=e.asNextValue,v=e.heightVisual,g=void 0!==v&&v,y=e.isCone,m=void 0===y||y,_=e.range,b=r.reduce((function(t,e){return Math.max(t,Number.parseFloat(e[a])||-1/0)}),-1/0),x=r.reduce((function(t,e){return Math.min(t,Number.parseFloat(e[a])||1/0)}),1/0),k=[null!==(i=null==_?void 0:_.min)&&void 0!==i?i:x,null!==(n=null==_?void 0:_.max)&&void 0!==n?n:b];return r.forEach((function(t,e){var i,n,v=Number.parseFloat(t[a]),y=Number.parseFloat(null===(i=r[e-1])||void 0===i?void 0:i[a]),_=Number.parseFloat(null===(n=r[e+1])||void 0===n?void 0:n[a]),b=it(_*v)&&0!==v?_/v:0,x=it(v*y)&&0!==y?v/y:0;d&&(t[d]=y),f&&(t[f]=_),o&&(t[o]=b),s&&(t[s]=0===e?1:x),l&&(t[l]=!0===g?b:1/r.length),u&&(t[u]=v/k[1]),c&&(t[c]=e===r.length-1?m?0:t[u]:_/k[1]),h&&(t[h]=0===e?1:y/k[1]),p&&(t[p]=v)})),r},c2=function(t,e){var i,n,r=null===(n=null===(i=t[0])||void 0===i?void 0:i.latestData)||void 0===n?void 0:n.map((function(t){return M({},t)}));return r&&0!==r.length?(r.shift(),r.forEach((function(t){t[e.asIsTransformLevel]=!0})),r):r},h2="".concat(Mj,"_FUNNEL_TRANSFORM_RATIO"),d2="".concat(Mj,"_FUNNEL_REACH_RATIO"),p2="".concat(Mj,"_FUNNEL_HEIGHT_RATIO"),f2="".concat(Mj,"_FUNNEL_VALUE_RATIO"),v2="".concat(Mj,"_FUNNEL_LAST_VALUE_RATIO"),g2="".concat(Mj,"_FUNNEL_NEXT_VALUE_RATIO"),y2="".concat(Mj,"_FUNNEL_LAST_VALUE"),m2="".concat(Mj,"_FUNNEL_CURRENT_VALUE"),_2="".concat(Mj,"_FUNNEL_NEXT_VALUE"),b2="".concat(Mj,"_FUNNEL_TRANSFORM_LEVEL"),x2=function(t){function e(e){var i,n,r=this;return(r=t.call(this,e)||this).dimensionTooltipTitleCallback=function(t,e){var i,n,a,o=r.series;return"transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)?r._transformRatioText:null!==(n=r._getDimensionData(t))&&void 0!==n?n:null===(a=t.properties)||void 0===a?void 0:a["".concat(o.getCategoryField())]},r.markTooltipValueCallback=function(t,e){var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)){var n=null==t?void 0:t[d2];return"".concat((100*n).toFixed(1),"%")}return r._getMeasureData(t)},r.markTooltipKeyCallback=function(t,e){var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name))return r._transformRatioText;var n=r._seriesCacheInfo,a=n.dimensionFields,o=n.seriesFields,s=a[a.length-1];return W(o[0])?null==t?void 0:t[o[0]]:null==t?void 0:t[s]},r._transformRatioText=null!==(n=null===(i=e.getSpec())||void 0===i?void 0:i.transformRatioText)&&void 0!==n?n:"转化率",r}return C(e,t),e}(OG),k2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{points:[]})},e}(NW),S2=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.type="polygon",e}(k2),A2=function(){ij.registerMark(S2.type,S2),cP(),tP(),sG(),ij.registerGraphicComponent("polygon",A_)},C2=M(M({},qG),((i2={}).funnel={name:"funnel",type:"polygon"},i2.transform={name:"transform",type:"polygon"},i2.transformLabel={name:"transformLabel",type:"text"},i2.outerLabel={name:"outerLabel",type:"text"},i2.outerLabelLine={name:"outerLabelLine",type:"rule"},i2)),M2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")},e}(hY),w2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.funnel,i._funnelMarkName="funnel",i._funnelMarkType="polygon",i._transformMarkName="transform",i._transformMarkType="polygon",i.transformerConstructor=M2,i._funnelMark=null,i._funnelTransformMark=null,i._labelMark=null,i._transformLabelMark=null,i._funnelOuterLabelMark={},i}return C(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!==(t=this._spec.funnelOrient)&&void 0!==t?t:"top",this._shape=null!==(i=this._spec.shape)&&void 0!==i?i:"trapezoid",this._minLabelLineWidth=null!==(a=null===(r=null===(n=this._spec.outerLabel)||void 0===n?void 0:n.line)||void 0===r?void 0:r.minLength)&&void 0!==a?a:20,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){EV(this._dataSet,"funnel",u2),EV(this._dataSet,"funnelTransform",c2);var t=new cc(this._dataSet,{name:"".concat(Mj,"_series_").concat(this.id,"_viewDataTransform")});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new IW(this._option,t)}},i.prototype.compile=function(){var t,i;e.prototype.compile.call(this),this._funnelOuterLabelMark&&(null===(t=this._funnelOuterLabelMark.label)||void 0===t||t.compile({group:this._rootMark.getProduct()}),null===(i=this._funnelOuterLabelMark.line)||void 0===i||i.compile({group:this._rootMark.getProduct()}))},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._viewDataTransform)||void 0===t||t.compile()},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype._statisticViewData=function(){var t,i,n,r,a,o,s,l,u;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:m2,asTransformRatio:h2,asReachRatio:d2,asHeightRatio:p2,asValueRatio:f2,asNextValueRatio:g2,asLastValueRatio:v2,asLastValue:y2,asNextValue:_2,range:{min:null!==(i=null===(t=this._spec.range)||void 0===t?void 0:t.min)&&void 0!==i?i:null===(r=null===(n=this.getViewDataStatistics().latestData)||void 0===n?void 0:n[this.getValueField()])||void 0===r?void 0:r.min,max:null!==(o=null===(a=this._spec.range)||void 0===a?void 0:a.max)&&void 0!==o?o:null===(l=null===(s=this.getViewDataStatistics().latestData)||void 0===s?void 0:s[this.getValueField()])||void 0===l?void 0:l.max}}}),null===(u=this._viewDataTransform.getDataView())||void 0===u||u.transform({type:"funnelTransform",options:{asIsTransformLevel:b2}})},i.prototype.initMark=function(){var t,e,n,r,a,o,s,l;if(this._funnelMark=this._createMark(M(M({},i.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel,groupKey:this._seriesField,isSeriesMark:!0,noSeparateStyle:!0},{morph:sY(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(M(M({},i.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(e=this._theme)||void 0===e?void 0:e.transform,noSeparateStyle:!0}),this._funnelTransformMark&&this._funnelTransformMark.setData(this._viewDataTransform)),null===(r=null===(n=this._spec)||void 0===n?void 0:n.outerLabel)||void 0===r?void 0:r.visible){var u=(null!==(a=this._spec.outerLabel)&&void 0!==a?a:{}).line,c=(null!==(s=null===(o=this._theme)||void 0===o?void 0:o.outerLabel)&&void 0!==s?s:{}).line;this._funnelOuterLabelMark.label=this._createMark(i.mark.outerLabel,{themeSpec:null===(l=this._theme)||void 0===l?void 0:l.outerLabel,markSpec:this._spec.outerLabel,noSeparateStyle:!0,parent:!1}),this._funnelOuterLabelMark.line=this._createMark(i.mark.outerLabelLine,{themeSpec:c,markSpec:u,noSeparateStyle:!0,parent:!1})}},i.prototype.initTooltip=function(){this._tooltipHelper=new x2(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getGroupFields=function(){return null},i.prototype.initMarkStyle=function(){var e,i,n,r,a=this,o=this._funnelMark;o&&this.setMarkStyle(o,{points:function(t){return a.getPoints(t)},visible:function(t){return W(t[a._valueField])},fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series);var s=this._funnelTransformMark;s&&this.setMarkStyle(s,{points:function(t){return a.getPoints(t)}},"normal",t.AttributeLevel.Series);var l=this._funnelOuterLabelMark.label;l&&(this.setMarkStyle(l,{text:function(t){return"".concat(t[a.getCategoryField()])},x:function(t){return a._computeOuterLabelPosition(t).x},y:function(t){return a._computeOuterLabelPosition(t).y},textAlign:function(t){return a._computeOuterLabelPosition(t).align},textBaseline:function(t){return a._computeOuterLabelPosition(t).textBaseline},maxLineWidth:function(t){return a._computeOuterLabelLimit(t)},width:0,height:0},"normal",t.AttributeLevel.Series),U(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(l,{text:function(t){return a._spec.outerLabel.formatMethod("".concat(t[a.getCategoryField()]),t)}},"normal",t.AttributeLevel.User_Mark));var u=this._funnelOuterLabelMark.line;if(u&&l){this.setMarkStyle(u,{x:function(t){return a._computeOuterLabelLinePosition(t).x1},y:function(t){return a._computeOuterLabelLinePosition(t).y1},x1:function(t){return a._computeOuterLabelLinePosition(t).x2},y1:function(t){return a._computeOuterLabelLinePosition(t).y2}},"normal",t.AttributeLevel.Series);var c=null!==(n=null===(i=null===(e=this._spec.outerLabel)||void 0===e?void 0:e.line)||void 0===i?void 0:i.visible)&&void 0!==n?n:null===(r=this._spec.outerLabel)||void 0===r?void 0:r.visible;W(c)&&u.setVisible(c)}},i.prototype.initLabelMarkStyle=function(e){var i,n=this;if(e){var r=e.getTarget(),a=e.getComponent();if(r===this._funnelMark){this._labelMark=e,this.setMarkStyle(e,{text:function(t){return"".concat(t[n.getCategoryField()]," ").concat(t[n.getValueField()])},x:function(t){return n._computeLabelPosition(t).x},y:function(t){return n._computeLabelPosition(t).y},maxLineWidth:function(t){return n._computeLabelLimit(t,n._spec.label)},stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series);var o=this.getCompiler().getRootMarks();this._funnelOuterLabelMark.label&&zA(o,this._funnelOuterLabelMark.label,a),this._funnelOuterLabelMark.line&&zA(o,this._funnelOuterLabelMark.line,null!==(i=this._funnelOuterLabelMark.label)&&void 0!==i?i:a)}else this._funnelTransformMark&&r===this._funnelTransformMark&&(this._transformLabelMark=e,this.setMarkStyle(e,{text:function(t){var e=gU(d2).bind(n)(t);return"".concat((100*e).toFixed(1),"%")},x:function(t){return n._computeLabelPosition(t).x},y:function(t){return n._computeLabelPosition(t).y},maxLineWidth:function(t){return n._computeLabelLimit(t,n._spec.transformLabel)}},"normal",t.AttributeLevel.Series))}},i.prototype.initAnimation=function(){var t,e,i,n,r,a,o,s=this,l=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===l&&this._rootMark&&this._rootMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("cartesianGroupClip"))||void 0===n?void 0:n({direction:function(){return s._isHorizontal()?"x":"y"},width:function(){var t=s.getRootMark().getProduct();if(t){var e=t.AABBBounds,i=e.x1,n=e.x2;return Math.max(i,n)}return s.getLayoutRect().width},height:function(){var t=s.getRootMark().getProduct();if(t){var e=t.AABBBounds,i=e.y1,n=e.y2;return Math.max(i,n)}return s.getLayoutRect().height},orient:function(){return s._isReverse()?"negative":"positive"}},l),rY("group",this._spec,this._markAttributeContext))),[null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.label].forEach((function(t){t&&t.setAnimationConfig(nY(ij.getAnimationInKey("fadeInOut")(),rY(t.name,s._spec,s._markAttributeContext)))})),[this._funnelMark,this._funnelTransformMark].forEach((function(t){t&&t.setAnimationConfig(nY(ij.getAnimationInKey("funnel")({},l),rY(t.name,s._spec,s._markAttributeContext)))})),(null===(a=this._funnelOuterLabelMark)||void 0===a?void 0:a.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(nY(null===(o=ij.getAnimationInKey("fadeInOut"))||void 0===o?void 0:o(),rY("outerLabelLine",this._spec,this._markAttributeContext)))},i.prototype.initGroups=function(){},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype.initEvent=function(){var t,i=this;e.prototype.initEvent.call(this),null===(t=this._viewDataTransform.getDataView())||void 0===t||t.target.addListener("change",(function(t){i._viewDataTransform.updateData()}))},i.prototype.getPoints=function(t){var e,i,n=this.isTransformLevel(t),r=this._getMainAxisLength(n)/2;n?(e="rect"===this._shape?this._getSecondaryAxisLength(t[v2])/2:this._getSecondaryAxisLength(t[f2])/2,i=this._getSecondaryAxisLength(t[f2])/2):(e=this._getSecondaryAxisLength(t[f2])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[g2])/2);var a=this._getPositionByData(t),o=a.x,s=a.y,l=this._getPolygonPoints([o,s],e,i,e,i,r);return"center"!==this._funnelAlign&&this._adjustPoints(l),l},i.prototype.isTransformLevel=function(t){return!!(null==t?void 0:t[b2])},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)},i.prototype.valueToPosition=function(t){var e,i,n,r=this,a=null===(n=null===(i=null===(e=this.getViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.find)||void 0===n?void 0:n.call(i,(function(e){return e[r._categoryField]===t}));return W(a)?this._getPolygonCenter(this.getPoints(a)):null},i.prototype.dataToPosition=function(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])},i.prototype.dataToPositionX=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},i.prototype.dataToPositionY=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y},i.prototype.dataToPositionZ=function(t){return 0},i.prototype._getMainAxisLength=function(t){var e;void 0===t&&(t=!1);var i=this.getViewData().latestData.length,n=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,r=!!this._spec.isTransform,a=r?0:null!==(e=this._spec.gap)&&void 0!==e?e:0,o=r?Math.max(0,i-1):0,s=this._spec.heightRatio||.5,l=(n-a*Math.max(0,i-1))/(i+s*o);return t?r?l*s:0:l},i.prototype._getSecondaryAxisLength=function(t){var e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),n=this._computeMinSize();return n+(i-n)*e},i.prototype._getPositionByData=function(t){var e,i=this,n=null===(e=this.getViewData().latestData)||void 0===e?void 0:e.findIndex((function(e){return e[i._categoryField]===t[i._categoryField]&&e[Bj]===t[Bj]}));if(!W(n)||n<0)return{};var r=this.isTransformLevel(t),a=this._isHorizontal(),o=a?this.getLayoutRect().height:this.getLayoutRect().width,s=a?this.getLayoutRect().width:this.getLayoutRect().height,l=o/2,u=0,c=this._getMainAxisLength(),h=this._getMainAxisLength(!0);return u+=n*(c+h),u+=r?-h/2:c/2,!this._spec.isTransform&&this._spec.gap&&(u+=this._spec.gap*n),this._isReverse()&&(u=s-u),this._isHorizontal()?{x:u,y:l}:{x:l,y:u}},i.prototype._getPolygonPoints=function(t,e,i,n,r,a){var o=t[0],s=t[1];switch(this._funnelOrient){case"left":return[{x:o-a,y:s+e},{x:o-a,y:s-n},{x:o+a,y:s-r},{x:o+a,y:s+i}];case"right":return[{x:o+a,y:s-n},{x:o+a,y:s+n},{x:o-a,y:s+i},{x:o-a,y:s-i}];case"bottom":return[{x:o+e,y:s+a},{x:o-n,y:s+a},{x:o-r,y:s-a},{x:o+i,y:s-a}];default:return[{x:o-e,y:s-a},{x:o+n,y:s-a},{x:o+r,y:s+a},{x:o-i,y:s+a}]}},i.prototype._getPolygonCenter=function(t){if(this._isHorizontal()){var e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}var n=(t[0].x+t[3].x)/2,r=(t[0].y+t[3].y)/2;return{x:(n+(t[1].x+t[2].x)/2)/2,y:(r+(t[1].y+t[2].y)/2)/2}},i.prototype._adjustPoints=function(t){var e,i,n;return this._isHorizontal()?(n="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(n="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][n]-=e,t[1][n]-=e,t[2][n]-=i,t[3][n]-=i,t},i.prototype._computeLabelPosition=function(t){var e=this.getPoints(t);return this._getPolygonCenter(e)},i.prototype._computeLabelLimit=function(t,e){var i=null==e?void 0:e.limit;if($(i))return i;var n=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(n[3].x-n[0].x):(Math.abs(n[0].x-n[1].x)+Math.abs(n[2].x-n[3].x))/2:this._isHorizontal()?Math.abs(n[3].x-n[0].x):void 0},i.prototype._computeOuterLabelPosition=function(t){var e,i,n,r,a,o=null===(i=this._spec.outerLabel)||void 0===i?void 0:i.position,s="center",l="middle";if(o=this._isHorizontal()?["top","bottom"].includes(o)?o:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(o)?o:"left"===this._funnelAlign?"right":"left",!1!==(null===(n=this._spec.outerLabel)||void 0===n?void 0:n.alignLabel))r=(e=this._getPositionByData(t)).x,a=e.y,"left"===o?(r=0,s="left"):"right"===o?(r=this.getLayoutRect().width,s="right"):"top"===o?(a=0,l="top"):"bottom"===o&&(a=this.getLayoutRect().height,l="bottom");else{var u=this._computeOuterLabelLinePosition(t);r=u.x2,a=u.y2,"left"===o?(r-=5,s="right"):"right"===o?(r+=5,s="left"):"top"===o?(a-=5,l="bottom"):"bottom"===o&&(a+=5,l="top")}return{x:r,y:a,align:s,textBaseline:l}},i.prototype._computeOuterLabelLimit=function(t){var e,i,n,r,a,o;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));var s=this.getPoints(t),l=(Math.abs(s[0].x-s[1].x)+Math.abs(s[2].x-s[3].x))/2,u=this.getCategoryField(),c=null===(r=null===(n=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getComponent())||void 0===n?void 0:n.find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[u])===t[u]}),!0))||void 0===r?void 0:r.AABBBounds,h=c?c.x2-c.x1:0,d=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0,p=this.getLayoutRect().width-Math.max(l,h);return"center"===this._funnelAlign&&(p/=2),p-d-(null!==(o=null===(a=this._spec.outerLabel)||void 0===a?void 0:a.spaceWidth)&&void 0!==o?o:5)},i.prototype._computeOuterLabelLinePosition=function(t){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v=this.getCategoryField(),g=null===(r=null===(n=null===(i=null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)||void 0===i?void 0:i.getGraphics())||void 0===n?void 0:n.find((function(e){var i;return(null===(i=e.context.data[0])||void 0===i?void 0:i[v])===t[v]})))||void 0===r?void 0:r.AABBBounds,y=null===(o=null===(a=this._labelMark)||void 0===a?void 0:a.getComponent())||void 0===o?void 0:o.getComponent(),m=null===(s=null==y?void 0:y.find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[v])===t[v]}),!0))||void 0===s?void 0:s.AABBBounds,_=null!==(l=this._spec.outerLabel)&&void 0!==l?l:{};if(this._isHorizontal()){var b=null!==(u=_.spaceWidth)&&void 0!==u?u:5,x=this.getPoints(t),k=(Math.abs(x[0].y-x[1].y)+Math.abs(x[2].y-x[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(p=this._getPolygonCenter(x).y-k/2-b,f=!1!==_.alignLabel?(null==g?void 0:g.y2)+b:p-b,h=this._getPolygonCenter(x).x,p-f<this._minLabelLineWidth&&(f=p-this._minLabelLineWidth),d=h):(p=this._getPolygonCenter(x).y+k/2+b,f=!1!==_.alignLabel?(null==g?void 0:g.y1)-b:p+b,h=this._getPolygonCenter(x).x,f-p<this._minLabelLineWidth&&(f=p+this._minLabelLineWidth),d=h),{x1:h,x2:d,y1:p,y2:f}}var S=this.getPoints(t),A=(Math.abs(S[0].x-S[1].x)+Math.abs(S[2].x-S[3].x))/2,C=(null==m?void 0:m.x2)-(null==m?void 0:m.x1)||0,M=null!==(c=_.spaceWidth)&&void 0!==c?c:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(h=this._getPolygonCenter(S).x+Math.max(C/2,A/2)+M,d=!1!==_.alignLabel?(null==g?void 0:g.x1)-M:h+M,p=this._getPolygonCenter(S).y,d-h<this._minLabelLineWidth&&(d=h+this._minLabelLineWidth),f=p):(h=this._getPolygonCenter(S).x-Math.max(C/2,A/2)-M,d=!1!==_.alignLabel?(null==g?void 0:g.x2)+M:h-M,p=this._getPolygonCenter(S).y,h-d<this._minLabelLineWidth&&(d=h-this._minLabelLineWidth),f=p),{x1:h,x2:d,y1:p,y2:f}},i.prototype._computeMaxSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return HU(null!==(t=this._spec.maxSize)&&void 0!==t?t:"80%",e)},i.prototype._computeMinSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return HU(null!==(t=this._spec.minSize)&&void 0!==t?t:0,e)},i.prototype._isHorizontal=function(){return"left"===this._funnelOrient||"right"===this._funnelOrient},i.prototype._isReverse=function(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._funnelMark]},i.type=t.SeriesTypeEnum.funnel,i.mark=C2,i.builtInTheme={funnel:sj},i.transformerConstructor=M2,i}(dY),T2=function(){A2(),wJ(),OZ(),ij.registerSeries(w2.type,w2),ij.registerAnimation("funnel",(function(t,e){return M({appear:"clipIn"===e?void 0:{type:"fadeIn"}},$W)})),ij.registerAnimation("cartesianGroupClip",(function(t){return{appear:{custom:cI,customParameters:function(e,i){return{animationType:"in",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}},disappear:{custom:cI,customParameters:function(e,i){return{animationType:"out",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}}}})),eG()},D2=function(t,e){var i=(t-e[0])/(e[1]-e[0]||1);return Math.max(0,Math.min(1,i))},E2=function(t){var e=t.filter((function(t){return t.context.diffState===AW.update})),i=Pt(e.map((function(t){var e,i;return null===(i=null===(e=null==t?void 0:t.context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0].depth})));return e.filter((function(t){var e,n;return(null===(n=null===(e=null==t?void 0:t.context)||void 0===e?void 0:e.data)||void 0===n?void 0:n[0].depth)===i}))},B2=function(t,e,i){if(ct(t))return[e,i];var n=Pt(t.map((function(t){return 1*t.getFinalAttribute().startAngle}))),r=Bt(t.map((function(t){return 1*t.getFinalAttribute().endAngle})));return[n,r]},P2=function(t){return{channel:{startAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=E2(i.parent.children),s=B2(o,r,a);return D2(i.getFinalAttribute().startAngle,s)*(a-r)+r},to:function(t,e){return e.getFinalAttribute().startAngle}},endAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=E2(i.parent.children),s=B2(o,r,a);return D2(i.getFinalAttribute().endAngle,s)*(a-r)+r},to:function(t,e){return e.getFinalAttribute().endAngle}},outerRadius:{from:function(t,e){return e.getFinalAttribute().innerRadius},to:function(t,e){return e.getFinalAttribute().outerRadius}},innerRadius:{from:function(t,e){return e.getFinalAttribute().innerRadius},to:function(t,e){return e.getFinalAttribute().innerRadius}}}}},R2=function(t){var e=Pt(t.map((function(t){return 1*t.getFinalAttribute().startAngle}))),i=Bt(t.map((function(t){return 1*t.getFinalAttribute().endAngle})));return[e,i]},L2=function(t){return{channel:{startAngle:{from:function(t,e){return e.getFinalAttribute().startAngle},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=E2(i.parent.children),s=R2(o);return D2(i.getFinalAttribute().startAngle,s)*(a-r)+r}},endAngle:{from:function(t,e){return e.getFinalAttribute().endAngle},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=E2(i.parent.children),s=R2(o);return D2(i.getFinalAttribute().endAngle,s)*(a-r)+r}},outerRadius:{from:function(t,e){return e.getFinalAttribute().outerRadius},to:function(){return t.animationInfo().innerRadius}},innerRadius:{from:function(t,e){return e.getFinalAttribute().innerRadius},to:function(){return t.animationInfo().innerRadius}}}}},I2=function(t,e){switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},F2=function(t,e){if(void 0===e&&(e={}),!t)return[];var i=[];return j$(t,i,e),i},O2=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return new m0(i).layout(t,{width:n,height:r})},z2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return C(e,t),e}(OG);!function(t){t.DrillDown="drillDown",t.DrillUp="drillUp"}(n2||(n2={}));var H2,N2=function(t,e){var i,n=e.info(),r=e.keyField(),a=null==n?void 0:n.key;if(j(a))return t;if(n.type===n2.DrillDown)return Dt(i=uV(t,a,r,"children"));if(n.type===n2.DrillUp&&(i=cV(t,a,r,"children")))return Dt(i);return t},U2=function(){function e(){}return e.prototype._getDrillTriggerEvent=function(t){var e;return null===(e=yZ(this._drillParams.mode))||void 0===e?void 0:e[t]},e.prototype._hideTooltip=function(){var t=this.getChart().getComponentsByType(L.tooltip)[0];t&&t.hideTooltip()},e.prototype.initDrillable=function(t){this._drillParams=t},e.prototype.initDrillableData=function(t){var e=this,i=this._drillParams.getRawData;EV(t,"drillFilter",N2),i().transform({type:"drillFilter",options:{info:function(){return e._drillInfo},keyField:function(){return e._drillParams.drillField()}}})},e.prototype.bindDrillEvent=function(){var t=this,e=this._drillParams,i=e.event,n=e.getRawData,r=(0,e.drillField)();this._getDrillTriggerEvent("start")&&i.on(this._getDrillTriggerEvent("start"),(function(e){var i,a,o;if(j(e.datum)||j(null===(i=e.datum)||void 0===i?void 0:i[r]))t.drillUp();else{t._hideTooltip();var s=e.datum[r],l=null!==(o=null===(a=t._drillInfo)||void 0===a?void 0:a.path)&&void 0!==o?o:[],u=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");var r=[],a=function(t,o){var s,l;try{for(var u=E(t),c=u.next();!c.done;c=u.next()){var h=c.value;if(h[i]===e)return r.push.apply(r,P(P([],B(o),!1),[h[i].toString()],!1)),!0;if(h[n]){var d=a(h[n],P(P([],B(o),!1),[h[i]],!1));if(!0===d)return d}}}catch(t){s={error:t}}finally{try{c&&!c.done&&(l=u.return)&&l.call(u)}finally{if(s)throw s.error}}return!1};return a(t,[]),r}(n().rawData,s,r,"children");l[l.length-1]===u[u.length-1]?t.drillUp():t.drillDown(u)}}))},e.prototype.drillDown=function(e){void 0===e&&(e=[]);var i=this._drillParams,n=i.getRawData,r=i.event;if(!Z(e)||ct(e))return e;var a=e[e.length-1];return this._drillInfo={key:a,path:e,type:n2.DrillDown},n().reRunAllTransform(),r.emit(t.ChartEvent.drill,{value:{path:e,type:n2.DrillDown},model:this}),e},e.prototype.drillUp=function(){var e,i,n=this._drillParams,r=n.getRawData,a=n.event,o=null!==(i=null===(e=this._drillInfo)||void 0===e?void 0:e.path)&&void 0!==i?i:[];if(!Z(o)||ct(o))return o;var s=o.pop();return this._drillInfo={key:s,path:o,type:n2.DrillUp},r().reRunAllTransform(),a.emit(t.ChartEvent.drill,{value:{path:o,type:n2.DrillUp},model:this}),o},e}(),j2=M(M({},qG),((H2={}).sunburst={name:"sunburst",type:"arc"},H2)),V2=function(t,e,i){return t.push({key:e,operations:["values"]}),t.push({key:i,operations:["max","min"]}),t.push({key:jG,operations:["max","min","values"]}),t.push({key:VG,operations:["values"]}),t},W2={innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},G2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sunburst,i}return C(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:VG),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:Bj},getRawData:function(){return i.getRawData()}}),this._startAngle=Ci(this._spec.startAngle),this._endAngle=Ci(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();i&&(this._spec.drill&&this.initDrillableData(this._dataSet),EV(this._dataSet,"sunburstLayout",O2),EV(this._dataSet,"flatten",F2),i.transform({type:"sunburstLayout",options:function(){var e=t._computeLevel(),i=e.innerRadius,n=e.outerRadius,r=e.gap,a=e.label;return{nodeKey:t._categoryField,width:t.getLayoutRect().width,height:t.getLayoutRect().height,center:[W(t._centerX)?t._centerX:t.getLayoutRect().width/2,W(t._centerY)?t._centerY:t.getLayoutRect().height/2],startAngle:t._startAngle,endAngle:t._endAngle,innerRadius:i,outerRadius:n,gapRadius:r,label:a}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return M(M({},t),e)}return t}}}))},i.prototype.getStatisticFields=function(){return V2(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();j(null==t?void 0:t.dataSet)||(EV(t.dataSet,"addVChartProperty",DG),t.transform({type:"addVChartProperty",options:{beforeCall:XG.bind(this),call:KG}}))},i.prototype.initMark=function(){this._initArcMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initArcMarkStyle(),this._initLabelMarkStyle()},i.prototype._initArcMark=function(){if(!1!==this._sunburst.visible){var t=this._createMark(i.mark.sunburst,{isSeriesMark:!0});this._sunburstMark=t}},i.prototype._initArcMarkStyle=function(){var e=this;j(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:function(t){return t.x+(W(e._offsetX)?e._offsetX:0)},y:function(t){return t.y+(W(e._offsetY)?e._offsetY:0)},outerRadius:function(t){return t.outerRadius},innerRadius:function(t){return t.innerRadius},startAngle:function(t){return t.startAngle},endAngle:function(t){return t.endAngle},fill:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initLabelMark=function(){if(!0===this._label.visible){var t=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=t}},i.prototype._initLabelMarkStyle=function(){var e=this;j(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:function(t){var i,n=e._labelAutoVisible;return G(n)&&!0===n.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!==(i=null==n?void 0:n.circumference)&&void 0!==i?i:10):e._spec.label.visible},x:function(t){var i;return(null===(i=t.label)||void 0===i?void 0:i.x)+(W(e._offsetX)?e._offsetX:0)},y:function(t){var i;return(null===(i=t.label)||void 0===i?void 0:i.y)+(W(e._offsetY)?e._offsetY:0)},textBaseline:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textBaseline},textAlign:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textAlign},angle:function(t){var e,i;return null!==(i=null===(e=t.label)||void 0===e?void 0:e.angle)&&void 0!==i?i:0},fontSize:10,text:function(t){return t.name}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new z2(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e,i=this,n={animationInfo:function(){return{innerRadius:i._computeRadius(Dt(i.__innerRadius))[0],outerRadius:i._computeRadius(Dt(i.__outerRadius))[0],startAngle:Dt(i._startAngle)[0],endAngle:Dt(i._endAngle)[0]}}},r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this.getMarksInType("arc").forEach((function(t){var e;t.setAnimationConfig(nY(null===(e=ij.getAnimationInKey("sunburst"))||void 0===e?void 0:e(n,r),rY(t.name,i._spec,i._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var e;t.setAnimationConfig(nY(null===(e=ij.getAnimationInKey("fadeInOut"))||void 0===e?void 0:e(),rY(t.name,i._spec,i._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._rawData.reRunAllTransform()},i.prototype._computeRadius=function(t){var e=this;return Z(t)?t.map((function(t){return e._computeLayoutRadius()*t})):this._computeLayoutRadius()*t},i.prototype._computeLevel=function(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._sunburstMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.sunburst,i.mark=j2,i.builtInTheme={sunburst:W2},i}(GJ);Tt(G2,U2);var Y2,X2=function(){ij.registerSeries(G2.type,G2),aQ(),wJ(),eG(),ij.registerAnimation("sunburst",(function(t,e){return{appear:I2(0,e),enter:P2(t),exit:L2(t),disappear:L2(t)}}))},K2=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return 0===n||0===r?t:new r0(i).layout(t,{width:n,height:r})},q2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return C(e,t),e}(OG),Z2=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"}},J2=M(M({},qG),((Y2={}).circlePacking={name:"circlePacking",type:"arc"},Y2)),Q2={layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},$2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circlePacking,i}return C(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:VG),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:Bj},getRawData:function(){return i.getRawData()}}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();j(i)||(this._spec.drill&&this.initDrillableData(this._dataSet),EV(this._dataSet,"circlePackingLayout",K2),EV(this._dataSet,"flatten",F2),i.transform({type:"circlePackingLayout",options:function(){return{nodeKey:t._categoryField,padding:t._layoutPadding,includeRoot:!1,width:t.getLayoutRect().width||1,height:t.getLayoutRect().height||1}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return M(M({},t),e)}return t}}}))},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();j(null==t?void 0:t.dataSet)||(EV(t.dataSet,"addVChartProperty",DG),t.transform({type:"addVChartProperty",options:{beforeCall:XG.bind(this),call:KG}}))},i.prototype.initMark=function(){this._initCirclePackingMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()},i.prototype._initCirclePackingMark=function(){var t;if(!1!==(null===(t=this._circlePacking)||void 0===t?void 0:t.visible)){var e=this._createMark(i.mark.circlePacking,{isSeriesMark:!0});this._circlePackingMark=e}},i.prototype._initCirclePackingMarkStyle=function(){j(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:function(t){return t.x},y:function(t){return t.y},outerRadius:function(t){return t.radius},innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:function(t){return t.depth}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initLabelMark=function(){var t;if(!1!==(null===(t=this._label)||void 0===t?void 0:t.visible)){var e=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=e}},i.prototype._initLabelMarkStyle=function(){j(this._labelMark)||this.setMarkStyle(this._labelMark,{x:function(t){return t.x},y:function(t){return t.y},text:function(t){return t.key},cursor:"pointer"},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.getStatisticFields=function(){return V2(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype.initTooltip=function(){this._tooltipHelper=new q2(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e=this,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this.getMarksInType("arc").forEach((function(t){var n;t.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("circlePacking"))||void 0===n?void 0:n(void 0,i),rY(t.name,e._spec,e._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var i;t.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("scaleInOut"))||void 0===i?void 0:i(),rY(t.name,e._spec,e._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._rawData.reRunAllTransform()},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._circlePackingMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.circlePacking,i.mark=J2,i.builtInTheme={circlePacking:Q2},i}(gY);Tt($2,U2);var t3=function(){ij.registerSeries($2.type,$2),aQ(),wJ(),tG(),ij.registerAnimation("circlePacking",(function(t,e){return{appear:Z2(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}}))},e3=function(t,e,i){e.forEach((function(e){j(e[i])||t.add(e[i]),e.children&&e.children.length>0&&e3(t,e.children,i)}))},i3=function(t){var e;if(!t||!Z(t))return[];if(t.length>1){var i={links:[],nodes:[]};return t.forEach((function(t){"links"!==t.id&&"nodes"!==t.id||(i[t.id]=t.values)})),[i]}return(null===(e=t[0])||void 0===e?void 0:e.latestData)?t[0].latestData:t},n3=function(t,e){if(!t||!(null==e?void 0:e.view)||!t.length)return[];var i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];var n=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&n.links){var r=[];n.links.forEach((function(t){var i={};for(var n in t)n===e.sourceField?i.source=t[e.sourceField]:n===e.targetField?i.target=t[e.targetField]:n===e.valueField?i.value=t[e.valueField]:i[n]=t[n];r.push(i)})),n.links=r}var a=new p0(e),o=[];return o.push(a.layout(n,i)),o},r3=function(t){var e,i;return t&&Z(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].nodes)&&void 0!==i?i:[]},a3=function(t){var e,i;return t&&Z(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].links)&&void 0!==i?i:[]},o3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getDimensionData=function(t){if(t.source){if($(t.source)){var i=e.series.getSeriesKeys();return i[t.source]+" => "+i[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[e.series.getSpec().categoryField]:t.key},e.markTooltipValueCallback=function(t){return t.value},e}return C(e,t),e}(OG),s3=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}},l3=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:s3(t)},u3=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"}},c3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.onBind=function(){var e,i,n;t.prototype.onBind.call(this),(null===(e=this.params)||void 0===e?void 0:e.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var r,a,o=(r=this.target,this.params.options,this.params,a={x0:r.getFinalAttribute().x0,x1:r.getFinalAttribute().x1,y0:r.getFinalAttribute().y0,y1:r.getFinalAttribute().y1,thickness:r.getFinalAttribute().thickness},{from:Object.assign({},a,{x1:a.x0,y1:a.y0}),to:a}),s=o.from,l=o.to,u=null!==(n=null===(i=this.target.context)||void 0===i?void 0:i.lastAttrs)&&void 0!==n?n:s,c=this.target.getFinalAttribute();c&&Object.assign(this.target.attribute,c),this.props=l,this.propKeys=Object.keys(l).filter((function(t){return null!=l[t]})),this.animate.reSyncProps(),this.from=u,this.to=l,this.target.setAttributes(u)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(NL),h3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.onBind=function(){var e,i,n;t.prototype.onBind.call(this),(null===(e=this.params)||void 0===e?void 0:e.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var r,a,o=(r=this.target,this.params.options,this.params,{from:a={x0:r.getFinalAttribute().x0,x1:r.getFinalAttribute().x1,y0:r.getFinalAttribute().y0,y1:r.getFinalAttribute().y1,thickness:r.getFinalAttribute().thickness},to:Object.assign({},a,{x1:a.x0,y1:a.y0})}),s=o.from,l=o.to,u=null!==(n=null===(i=this.target.context)||void 0===i?void 0:i.lastAttrs)&&void 0!==n?n:s;this.props=l,this.propKeys=Object.keys(l).filter((function(t){return null!=l[t]})),this.animate.reSyncProps(),this.from=u,this.to=l,this.target.setAttributes(u)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(NL);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}C(e,t),e.prototype.onBind=function(){var t,e,i;(null===(t=this.params)||void 0===t?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var n=function(t,e,i){var n,r=t.getFinalAttribute();n={x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1};var a=t.attribute;return{from:n,to:{x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1}}}(this.target,this.params.options,this.params),r=n.from,a=n.to,o=null!==(i=null===(e=this.target.context)||void 0===e?void 0:e.lastAttrs)&&void 0!==i?i:r;this.props=a,this.propKeys=Object.keys(a).filter((function(t){return null!=a[t]})),this.animate.reSyncProps(),this.from=o,this.to=a,this.target.setAttributes(o)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)}}(NL);var d3,p3,f3=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,a=t.x0,o=t.x1,s=t.y0,l=t.y1,u=a+n*(o-a),c=o+n*(a-o),h=function(t){return t};!1!==t.round&&(a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round),"line"===t.pathType?"M".concat(a,",").concat(s,"L").concat(o,",").concat(l):"polyline"===t.pathType?"M".concat(a,",").concat(s,"L").concat(u,",").concat(s,"L").concat(u,",").concat(l,"L").concat(o,",").concat(l):"M".concat(a,",").concat(s,"C").concat(u,",").concat(s,",").concat(c,",").concat(l,",").concat(o,",").concat(l),"center"===t.align?(s=h(t.y0-r/2),l=h(t.y1-r/2)):"end"===t.align?(s=h(t.y0+t.thickness/2-r),l=h(t.y1+t.thickness/2-r)):(s=h(t.y0-t.thickness/2),l=h(t.y1-t.thickness/2));var d=h(s+r),p=h(l+r),f=Math.abs(o-a)>1e-6,v=t.endArrow&&f?"L".concat(o,",").concat(h(l-r/2),"L").concat(h(o+r),",").concat(h((l+p)/2),"L").concat(o,",").concat(h(p+r/2)):"",g=t.startArrow&&f?"L".concat(a,",").concat(h(d+r/2),"L").concat(h(a-r),",").concat(h((s+d)/2),"L").concat(a,",").concat(h(s-r/2)):"";return"line"===t.pathType?"M".concat(a,",").concat(s,"L").concat(o,",").concat(l).concat(v,"L").concat(o,",").concat(p,"L").concat(a,",").concat(d).concat(g,"Z"):"polyline"===t.pathType?"M".concat(a,",").concat(s,"L").concat(u,",").concat(s,"L").concat(u,",").concat(l,"L").concat(o,",").concat(l,"\n    ").concat(v,"L").concat(o,",").concat(p,"L").concat(u,",").concat(p,"L").concat(u,",").concat(d,"L").concat(a,",").concat(d).concat(g,"Z"):"M".concat(a,",").concat(s,"C").concat(u,",").concat(s,",").concat(c,",").concat(l,",").concat(o,",").concat(l,"\n  ").concat(v,"L").concat(o,",").concat(p,"C").concat(c,",").concat(p,",").concat(u,",").concat(d,",").concat(a,",").concat(d).concat(g,"Z")},v3=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,a=t.y0,o=t.y1,s=t.x0,l=t.x1,u=a+n*(o-a),c=o+n*(a-o),h=function(t){return t};!1!==t.round&&(h=Math.round,a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c)),"line"===t.pathType?"M".concat(s,",").concat(a,"L").concat(l,",").concat(o):"polyline"===t.pathType?"M".concat(s,",").concat(a,"L").concat(s,",").concat(u,"L").concat(l,",").concat(u,"L").concat(l,",").concat(o):"M".concat(s,",").concat(a,"C").concat(s,",").concat(u,",").concat(l,",").concat(c,",").concat(l,",").concat(o),"center"===t.align?(s=h(t.x0-r/2),l=h(t.x1-r/2)):"end"===t.align?(s=h(t.x0+t.thickness/2-r),l=h(t.x1+t.thickness/2-r)):(s=h(t.x0-t.thickness/2),l=h(t.x1-t.thickness/2));var d=h(s+r),p=h(l+r),f=Math.abs(o-a)>1e-6,v=t.endArrow&&f?"L".concat(h(l-r/2),",").concat(o,"L").concat(h((l+p)/2),",").concat(h(o+r),"L").concat(h(p+r/2),",").concat(o):"",g=t.startArrow&&f?"L".concat(h(d+r/2),",").concat(a,"L").concat(h((d+s)/2),",").concat(h(a-r),"L").concat(h(s-r/2),",").concat(a):"";return"line"===t.pathType?"M".concat(s,",").concat(a,"L").concat(l,",").concat(o).concat(v,"L").concat(p,",").concat(o,"L").concat(d,",").concat(a).concat(g,"Z"):"polyline"===t.pathType?"M".concat(s,",").concat(a,"L").concat(s,",").concat(u,"L").concat(l,",").concat(u,"L").concat(l,",").concat(o,"\n    ").concat(v,"L").concat(p,",").concat(o,"L").concat(p,",").concat(u,"L").concat(d,",").concat(u,"L").concat(d,",").concat(a).concat(g,"Z"):"M".concat(s,",").concat(a,"C").concat(s,",").concat(u,",").concat(l,",").concat(c,",").concat(l,",").concat(o,"\n  ").concat(v,"L").concat(p,",").concat(o,"C").concat(p,",").concat(c,",").concat(d,",").concat(u,",").concat(d,",").concat(a).concat(g,"Z")},g3=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._subMarks={back:{type:"path",defaultAttributes:{zIndex:0}},front:{type:"path",defaultAttributes:{zIndex:1}}},i._positionChannels=["x0","y0","x1","y1","thickness","round","curvature","ratio","pathType","align","endArrow","startArrow","ratio"],i._channelEncoder={backgroundStyle:function(t){return{back:t}}},i._positionEncoder=function(t,e,n){var r,a,o=M(M({},n.attribute),t),s=null!==(r=o.direction)&&void 0!==r?r:null===(a=i._glyphConfig)||void 0===a?void 0:a.direction,l=["vertical","TB","BT"].includes(s)?v3:f3,u="number"==typeof o.ratio&&o.ratio>=0&&o.ratio<=1;return{back:{path:u?l(o,1):""},front:{path:l(o,u?o.ratio:1)}}},i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})},e.type="linkPath",e}(lJ),y3=M(M({},qG),((d3={}).node={name:"node",type:"rect"},d3.link={name:"link",type:"linkPath"},d3)),m3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"node")},e}(hY),_3=function(t,e,i,n,r){void 0===n&&(n=!0),t.runtimeStateCache||(t.runtimeStateCache={}),t.runtimeStateCache[e]=i,t.hasState(e)&&t.removeState(e),t.addState(e,n,r)},b3={link:{style:{fillOpacity:.15,round:!0}}},x3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sankey,i.transformerConstructor=m3,i._nodeLayoutZIndex=t.LayoutZIndex.Node,i._labelLayoutZIndex=t.LayoutZIndex.Label,i._viewBox=new Fn,i._fillByNode=function(t){var e,n,r,a,o;if(t&&t.sourceRect&&t.targetRect)return i._fillByLink(t);var s=null===(n=null===(e=i._spec.node)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(W(s))return s;if(W(i._spec.seriesField)){var l=null===(a=null===(r=i._option)||void 0===r?void 0:r.globalScale)||void 0===a?void 0:a.getScale("color"),u=(null==t?void 0:t.datum)?t.datum:t;return null==l?void 0:l.scale(null==u?void 0:u[i._spec.seriesField])}return null===(o=i._colorScale)||void 0===o?void 0:o.scale(i._getNodeNameFromData(t))},i._fillByLink=function(t){var e,n,r,a,o,s,l=null===(n=null===(e=i._spec.link)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(l)return l;if(W(i._spec.seriesField)){var u=null===(r=i._nodesSeriesData.latestData)||void 0===r?void 0:r.find((function(e){return t.source===e.key})),c=null==u?void 0:u.datum,h=null===(o=null===(a=i._option)||void 0===a?void 0:a.globalScale)||void 0===o?void 0:o.getScale("color");return null==h?void 0:h.scale(null==c?void 0:c[i._spec.seriesField])}var d=$(t.source)?i.getNodeList()[t.source]:t.source;return null===(s=i._colorScale)||void 0===s?void 0:s.scale(d)},i._handleEmphasisElement=function(t){var e,n=null!==(e=i._spec.emphasis)&&void 0!==e?e:{},r=t.item;"adjacency"===n.effect?r&&t.mark===i._nodeMark?i._handleNodeAdjacencyClick(r):r&&t.mark===i._linkMark?i._handleLinkAdjacencyClick(r):i._handleClearEmpty():"related"===n.effect&&(r&&t.mark===i._nodeMark?i._handleNodeRelatedClick(r):r&&t.mark===i._linkMark?i._handleLinkRelatedClick(r):i._handleClearEmpty())},i._handleClearEmpty=function(){var e,n;if(i._needClear){var r=null===(e=i._nodeMark)||void 0===e?void 0:e.getGraphics();if(r&&r.length){var a=null===(n=i._linkMark)||void 0===n?void 0:n.getGraphics();a&&a.length&&(r.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})),a.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})),i._needClear=!1)}}},i._handleNodeAdjacencyClick=function(e){var n=mV(e),r=[n.key];if(i._linkMark){var a=i._linkMark.getGraphics();if(!a||!a.length)return;a.forEach((function(e,i){var a=mV(e);a.source===n.key?(r.includes(a.target)||r.push(a.target),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0)):a.target===n.key?(r.includes(a.source)||r.push(a.source),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0)):(e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),r),i._needClear=!0},i._handleLinkAdjacencyClick=function(e){var n=mV(e),r=[n.source,n.target];if(i._linkMark){var a=i._linkMark.getGraphics();if(!a||!a.length)return;a.forEach((function(i){i===e?(i.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),_3(i,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:1})):(i.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),i.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),r),i._needClear=!0},i._handleNodeRelatedClick=function(e){var n,r=mV(e),a=i._nodeMark.getGraphics();if(a&&a.length){var o=i._linkMark.getGraphics();if(o&&o.length){var s=(null===(n=mV(o[0]))||void 0===n?void 0:n.parents)?"parents":"source";if("source"===s){var l=[r.key],u=[];if(o.forEach((function(t,e){var i,n,o,s,c=mV(t),h=(null==c?void 0:c.parents)?"parents":"source";if(Dt(c[h]).includes(r.key)){if(u.includes(null!==(i=c.key)&&void 0!==i?i:c.index)||u.push(null!==(n=c.key)&&void 0!==n?n:c.index),l.includes(c.source)||l.push(c.source),!l.includes(c.target)){l.push(c.target);for(var d=a.find((function(t){return t.data[0].key===c.target})).data[0].sourceLinks,p=function(){var t=[];return d.forEach((function(e){var i,n;if(!u.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(u.push(null!==(n=e.key)&&void 0!==n?n:e.index),!l.includes(e.target))){l.push(e.target);var r=a.find((function(t){return t.data[0].key===e.target}));t.push(r.data[0].targetLinks)}})),d=t,{value:void 0}};(null==d?void 0:d.length)>0;){var f=p();if("object"==typeof f)return f.value}}}else if(c.target===r.key&&(u.includes(null!==(o=c.key)&&void 0!==o?o:c.index)||u.push(null!==(s=c.key)&&void 0!==s?s:c.index),!l.includes(c.source))){l.push(c.source);for(var v=a.find((function(t){return t.data[0].key===c.source})).data[0].targetLinks,g=function(){var t=[];return v.forEach((function(e){var i,n;if(!u.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(u.push(null!==(n=e.key)&&void 0!==n?n:e.index),!l.includes(e.source))){l.push(e.source);var r=a.find((function(t){return t.data[0].key===e.source}));t.push(r.data[0].targetLinks)}})),v=t,{value:void 0}};(null==v?void 0:v.length)>0;){var y=g();if("object"==typeof y)return y.value}}})),i._linkMark){var c=i._linkMark.getGraphics();if(!c||!c.length)return;c.forEach((function(e,i){var n,r=mV(e);u.includes(null!==(n=r.key)&&void 0!==n?n:r.index)?(e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0)):(e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),l)}else{var h=[r.key],d=r.targetLinks.reduce((function(t,e){return Dt(e.datum).forEach((function(e){for(var i=e.parents,n=i.length,a=function(n){var a=i[n].key,o=i[n+1]?i[n+1].key:r.key,s=e.value,l=t.find((function(t){return t.source===a&&t.target===o}));l?l.value+=s:t.push({source:a,target:o,value:s})},o=0;o<n;o++)a(o)})),t}),[]);o.forEach((function(e,i){var n=mV(e),a=n.datum,o=a?a.filter((function(t){return t[s].some((function(t){return t.key===r.key}))})):null,l=d.find((function(t){return t.source===n.source&&t.target===n.target}));if(o&&o.length){h.includes(n.source)||h.push(n.source),h.includes(n.target)||h.push(n.target);var u=o.reduce((function(t,e){return t+e.value}),0),c=u/n.value;return e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void _3(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:c})}if(l)return h.includes(n.source)||h.push(n.source),h.includes(n.target)||h.push(n.target),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void _3(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:l.value/n.value});e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0)})),i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),h)}i._needClear=!0}}},i._handleLinkRelatedClick=function(e){var n=i._nodeMark.getGraphics();if(n&&n.length){var r=i._linkMark.getGraphics();if(r&&r.length){if("source"===(mV(e)?"parents":"source"))i._linkMark&&r.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})),i._nodeMark&&n.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)}));else{var a=mV(e),o=[a.source,a.target],s=[];Dt(a.datum).forEach((function(t){for(var e=t.parents,i=e.length,n=function(i){var n=e[i].key,r=e[i+1].key,a=t.value,o=s.find((function(t){return t.source===n&&t.target===r}));s.push({source:e[i].key,target:e[i+1].key,value:t.value}),o?o.value+=a:s.push({source:n,target:r,value:a})},r=0;r<i-1;r++)n(r)})),r.forEach((function(e){var i=mV(e),n=i.datum;if(i.source===a.source&&i.target===a.target)return e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void _3(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:1});var r=n?n.filter((function(t){var e=t.parents.map((function(t){return t.key}));return e.includes(a.source)&&e.includes(a.target)})):null;if(r&&r.length){o.includes(i.source)||o.push(i.source),o.includes(i.target)||o.push(i.target);var l=r.filter((function(t){return t.parents.some((function(e,i){var n;return e.key===a.source&&(null===(n=t.parents[i+1])||void 0===n?void 0:n.key)===a.target}))})).reduce((function(t,e){return t+e.value}),0),u=l/i.value;return e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void _3(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:u})}var c=s.find((function(t){return t.source===i.source&&t.target===i.target}));if(c)return o.includes(i.source)||o.push(i.source),o.includes(i.target)||o.push(i.target),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void _3(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:c.value/i.value});e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0)})),i._highLightElements(n,o)}i._needClear=!0}}},i}return C(i,e),Object.defineProperty(i.prototype,"direction",{get:function(){var t;return null!==(t=this._spec.direction)&&void 0!==t?t:"horizontal"},enumerable:!1,configurable:!0}),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:this._spec.categoryField)},i.prototype.initData=function(){var i,n,r,a,o=this;e.prototype.initData.call(this);var s=this.getViewData(),l=this.getRawData();if(l&&s){EV(this._dataSet,"sankeyLayout",n3),EV(this._dataSet,"sankeyFormat",i3),l.transform({type:"sankeyFormat"},!1),s.transform({type:"sankeyLayout",options:{view:function(){return{x0:o._viewBox.x1,x1:o._viewBox.x2,y0:o._viewBox.y1,y1:o._viewBox.y2}},sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:null!==(i=this._spec.nodeAlign)&&void 0!==i?i:"justify",nodeGap:null!==(n=this._spec.nodeGap)&&void 0!==n?n:8,nodeWidth:null!==(r=this._spec.nodeWidth)&&void 0!==r?r:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!==(a=this._spec.minNodeHeight)&&void 0!==a?a:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:t.TransformLevel.sankeyLayout});var u=this._option.dataSet;EV(u,"sankeyNodes",r3),EV(u,"flatten",F2);var c=new cc(u,{name:"sankey-node-".concat(this.id,"-data")});c.parse([this.getViewData()],{type:"dataview"}),c.transform({type:"sankeyNodes"}),c.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return M(M({},t),e)}return t}}},!1),c.transform({type:"addVChartProperty",options:{beforeCall:GG.bind(this),call:YG}},!1),this._nodesSeriesData=c,EV(u,"sankeyLinks",a3);var h=new cc(u,{name:"sankey-link-".concat(this.id,"-data")});h.parse([this.getViewData()],{type:"dataview"}),h.transform({type:"sankeyLinks"}),h.transform({type:"addVChartProperty",options:{beforeCall:GG.bind(this),call:YG}},!1),this._linksSeriesData=h}},i.prototype.compileData=function(){var t,i;e.prototype.compileData.call(this),null===(t=this._linkMark)||void 0===t||t.compileData(),null===(i=this._nodeMark)||void 0===i||i.compileData()},i.prototype.initMark=function(){this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});var t=this._createMark(i.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData});t&&(t.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=t);var e=this._createMark(i.mark.link,{dataView:this._linksSeriesData});e&&(this._linkMark=e)},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)},i.prototype.valueToNode=function(t){var e=this._nodesSeriesData.latestData,i=Dt(t)[0];return e&&e.find((function(t){return t.key===i}))},i.prototype.valueToLink=function(t){var e=this._linksSeriesData.latestData,i=Dt(t);return e&&e.find((function(t){return t&&t.source===i[0]&&t.target===i[1]}))},i.prototype.valueToPositionX=function(t){var e=this.valueToNode(t);return null==e?void 0:e.x0},i.prototype.valueToPositionY=function(t){var e=this.valueToNode(t);return null==e?void 0:e.y0},i.prototype.initMarkStyle=function(){this._initNodeMarkStyle(),this._initLinkMarkStyle()},i.prototype._initNodeMarkStyle=function(){var e,i,n=this._nodeMark;n&&(this.setMarkStyle(n,{x:function(t){return t.x0},x1:function(t){return t.x1},y:function(t){return t.y0},y1:function(t){return t.y1}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Mark),this.setMarkStyle(n,{fill:null!==(i=null===(e=this._spec.node.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this._fillByNode},"normal",t.AttributeLevel.User_Mark))},i.prototype._initLinkMarkStyle=function(){var e,i,n=this._linkMark;n&&(n.setGlyphConfig({direction:this.direction}),this.setMarkStyle(n,{x0:function(t){return t.x0},x1:function(t){return t.x1},y0:function(t){return t.y0},y1:function(t){return t.y1},thickness:function(t){return t.thickness}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this.setMarkStyle(n,{fill:null!==(i=null===(e=this._spec.link.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this._fillByLink},"normal",t.AttributeLevel.User_Mark))},i.prototype.initLabelMarkStyle=function(t,e){var i=this;if(t){var n=e.position;n&&n.includes("inside")?this.setMarkStyle(t,{fill:"#ffffff",text:function(t){return i._createText(t,e)},maxLineWidth:function(t){var i;return null!==(i=e.limit)&&void 0!==i?i:t.x1-t.x0}}):this.setMarkStyle(t,{fill:this._fillByNode,text:function(t){return i._createText(t,e)},maxLineWidth:e.limit}),t.setMarkConfig({zIndex:this._labelLayoutZIndex})}},i.prototype._createText=function(t,e){if(j(t)||j(t.datum))return"";var i=t.datum[this._spec.categoryField]||"",n=e||{},r=MG(n.formatMethod,n.formatter,i,t.datum),a=r.formatFunc,o=r.args;return a&&(i=a.apply(void 0,P(P([],B(o),!1),[{series:this}],!1))),i},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("sankeyNode"))||void 0===i?void 0:i(a,o),rY("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("sankeyLinkPath"))||void 0===n?void 0:n(a,o),rY("link",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var t,i,n;e.prototype.initEvent.call(this),null===(t=this._nodesSeriesData)||void 0===t||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null===(i=this._linksSeriesData)||void 0===i||i.target.addListener("change",this.linksSeriesDataUpdate.bind(this));var r=null!==(n=this._spec.emphasis)&&void 0!==n?n:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){var a="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(a,{level:AV.chart},this._handleEmphasisElement)}},i.prototype.nodesSeriesDataUpdate=function(){this._nodeMark.getData().updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()},i.prototype.linksSeriesDataUpdate=function(){this._linkMark.getData().updateData()},i.prototype._highLightElements=function(e,i){e&&e.length&&e.forEach((function(e){e.removeState([t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS]),i.includes(mV(e).key)?e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0):e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0)}))},i.prototype.initTooltip=function(){this._tooltipHelper=new o3(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)},i.prototype._setNodeOrdinalColorScale=function(){var t,e,i,n,r,a=null===(e=null===(t=this._option)||void 0===t?void 0:t.globalScale)||void 0===e?void 0:e.getScale("color");if(null==a?void 0:a._specified)this._colorScale=a;else{var o,s;a&&(o=a.domain(),s=a.range()),s||(s=this._getDataScheme()),o&&!j(o[0])||(o=this.getNodeList())&&o.length>10&&(s=null===(i=this._getDataScheme()[1])||void 0===i?void 0:i.scheme);var l=new DU;null===(r=(n=l.domain(o)).range)||void 0===r||r.call(n,s),this._colorScale=l}},i.prototype.getNodeList=function(){var t,e,i=this;if(this._nodeList)return this._nodeList;var n=this._rawData.latestData[0],r=(null==n?void 0:n.nodes)?(null===(t=n.nodes[0])||void 0===t?void 0:t.children)?Array.from(this.extractNamesFromTree(n.nodes,this._spec.categoryField)):n.nodes.map((function(t,e){return t[i._spec.categoryField]})):(null==n?void 0:n.links)?Array.from(this.extractNamesFromLink(n.links)):null===(e=null==n?void 0:n.values)||void 0===e?void 0:e.map((function(t,e){return t[i._spec.categoryField]}));return this._nodeList=r,r},i.prototype._getNodeNameFromData=function(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!==(e=t.key)&&void 0!==e?e:t[this._spec.categoryField]},i.prototype.extractNamesFromTree=function(t,e){var i=this,n=new Set;return t.forEach((function(t){(n.add(t[e]),t.children)&&i.extractNamesFromTree(t.children,e).forEach((function(t){return n.add(t)}))})),n},i.prototype.extractNamesFromLink=function(t){var e=new Set,i=this._spec,n=i.sourceField,r=i.targetField;return t.forEach((function(t){W(t[n])&&e.add(t[n]),W(t[r])&&e.add(t[r])})),e},i.prototype.getDimensionField=function(){return[this._spec.categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getRawDataStatisticsByField=function(t,e){var i;(this._rawStatisticsCache||(this._rawStatisticsCache={}),this._rawStatisticsCache[t])||(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)}));return this._rawStatisticsCache[t]},i.prototype._collectByField=function(t){var e,i,n,r=this,a=[],o=null===(i=null===(e=this.getRawData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[0];if(!o)return[];if(o.links)(null===(n=o.nodes)||void 0===n?void 0:n.length)&&o.nodes.forEach((function(t){t[r._seriesField]&&a.push(t[r._seriesField])}));else if(o.nodes){var s=new Set;return e3(s,o.nodes,this._seriesField),Array.from(s)}return a},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._nodeMark,this._linkMark]},i.prototype.getMarkData=function(t){return t.datum?Z(t.datum)?t.datum[t.datum.length-1]:t.datum:t},i.type=t.SeriesTypeEnum.sankey,i.transformerConstructor=m3,i.mark=y3,i.builtInTheme={sankey:b3},i}(gY),k3=function(){Lq(),uJ(),QB(),ij.registerGraphicComponent("path",(function(t){return p_(t)})),ij.registerMark(g3.type,g3),wJ(),ij.registerAnimation("sankeyNode",(function(t,e){return M({appear:l3(t,e)},$W)})),ij.registerAnimation("sankeyLinkPath",(function(t,e){return{appear:u3(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}}})),DL.registerBuiltInAnimate("linkPathGrowOut",h3),DL.registerBuiltInAnimate("linkPathGrowIn",c3),eG(),ij.registerSeries(x3.type,x3)},S3=function(t,e){var i={},n=e.fields;if(U(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return i;if(!t[0].latestData)return i;var r=t[0].latestData,a=F2(r);return i=HG([{latestData:a}],e)},A3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){var i,n;return null===(n=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t))||void 0===n?void 0:n[e.series.getDimensionField()[0]]},e.markTooltipValueCallback=function(t){var i,n,r=e._seriesCacheInfo.measureFields,a=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t);if(r[0]&&a)return null!==(n=a[r[0]])&&void 0!==n?n:t.value},e.dimensionTooltipTitleCallback=function(t){var i,n=e._seriesCacheInfo.dimensionFields,r=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t);if(n[0]&&r)return r[n[0]]},e}return C(e,t),Object.defineProperty(e.prototype,"defaultShapeType",{get:function(){return"square"},enumerable:!1,configurable:!0}),e}(OG),C3=M(M({},qG),((p3={}).nonLeaf={name:"nonLeaf",type:"rect"},p3.leaf={name:"leaf",type:"rect"},p3.nonLeafLabel={name:"nonLeafLabel",type:"text"},p3)),M3=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"}},w3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")},e}(hY),T3=function(){ij.registerGrammarTransform("filter",{transform:function(t,e){return null==e?void 0:e.filter(t.callback)}})},D3=function(){ij.registerGrammarTransform("map",{transform:function(t,e){return null==e||e.forEach((function(e,i){t.callback(e)})),e}})},E3=function(t,e){if(e.getViewBox()){var i=new R0(e).layout(t,e.getViewBox()),n=[];return j$(i,n,{maxDepth:null==e?void 0:e.maxDepth}),n.forEach((function(t,i){t&&[VG,"name"].forEach((function(i){t[i]=t.datum[t.depth][e.nameField]}))})),n}return[]},B3={gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}},P3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.treemap,i.transformerConstructor=w3,i._categoryField="name",i._valueField="value",i._viewBox=new Fn,i._enableAnimationHook=i.enableMarkAnimation.bind(i),i.isHierarchyData=function(){return!0},i}return C(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:VG),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new Hn),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t,e;return null!==(e=null!==(t=i._spec.drillField)&&void 0!==t?t:i._categoryField)&&void 0!==e?e:Bj},getRawData:function(){return i.getRawData()}}),it(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)},i.prototype.initData=function(){var t,i,n,r,a,o=this;e.prototype.initData.call(this),EV(this._dataSet,"treemap",E3),null===(t=this._data.getDataView())||void 0===t||t.transform({type:"treemap",options:{nameField:this._categoryField,valueField:this._valueField,getViewBox:function(){return o._viewBox.empty()?null:{x0:o._viewBox.x1,x1:o._viewBox.x2,y0:o._viewBox.y1,y1:o._viewBox.y2}},maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null===(i=this._spec.nonLeafLabel)||void 0===i?void 0:i.visible)?null===(n=this._spec.nonLeafLabel)||void 0===n?void 0:n.padding:0,labelPosition:null===(r=this._spec.nonLeafLabel)||void 0===r?void 0:r.position,minVisibleArea:null!==(a=this._spec.minVisibleArea)&&void 0!==a?a:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize}}),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)},i.prototype._runTreemapTransform=function(t){void 0===t&&(t=!1),this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(EV(this._rawData.dataSet,"addVChartProperty",DG),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:XG.bind(this),call:KG}}))},i.prototype.getRawDataStatisticsByField=function(t,e){var i;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&this._rawData){var n=S3([this._rawData],{fields:[{key:t,operations:e?["min","max"]:["values"]}]})[t];this._rawStatisticsCache[t]=mt(null!==(i=this._rawStatisticsCache[t])&&void 0!==i?i:{},n)}return this._rawStatisticsCache[t]},i.prototype._createHierarchyDataStatistics=function(t,e){var i=this;EV(this._dataSet,"hierarchyDimensionStatistics",S3),EV(this._dataSet,"flatten",F2);var n=new cc(this._dataSet,{name:t});return n.parse(e,{type:"dataview"}),n.transform({type:"hierarchyDimensionStatistics",options:{fields:function(){var t=i.getStatisticFields();return i._seriesField&&i._seriesField!==i._categoryField&&t.push({key:i._seriesField,operations:["values"]}),t}}},!1),n},i.prototype.getStatisticFields=function(){return V2(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype.initMark=function(){var t=this,e=this._createMark(i.mark.nonLeaf,{isSeriesMark:!0});e&&(e.setTransform([{type:"filter",callback:function(e){return!t._shouldFilterElement(e,"nonLeaf")}}]),this._nonLeafMark=e);var n=this._createMark(i.mark.leaf,{isSeriesMark:!0});n&&(n.setTransform([{type:"filter",callback:function(e){return!t._shouldFilterElement(e,"leaf")}}]),this._leafMark=n)},i.prototype.initMarkStyle=function(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()},i.prototype._initLeafMarkStyle=function(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initNonLeafMarkStyle=function(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initRichStyleOfLabelMark=function(e){"rich"===e.getTextType()&&this.setMarkStyle(e,{maxWidth:function(t){return Math.abs(t.x0-t.x1)},maxHeight:function(t){return Math.abs(t.y0-t.y1)},ellipsis:!0},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&(this._labelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return(t.y0+t.y1)/2},text:function(t){var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[i.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this._initRichStyleOfLabelMark(e))},i.prototype.initNonLeafLabelMarkStyle=function(e){var i=this;e&&(this._nonLeafLabelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:function(t){return t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2},y:function(t){return t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2},text:function(t){var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[i.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this._initRichStyleOfLabelMark(e))},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("rect").forEach((function(e){var i;e.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("treemap"))||void 0===i?void 0:i(),rY(e.name,t._spec,t._markAttributeContext)))}))},i.prototype.initEvent=function(){var t=this;e.prototype.initEvent.call(this),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",(function(e){t.handlePan(e)})),this.initZoomEventOfSeries(this),this.event.on("zoom",(function(e){t.handleZoom(e)}))),this._spec.drill&&this.bindDrillEvent()},i.prototype._getDataIdKey=function(){return"key"},i.prototype.initTooltip=function(){this._tooltipHelper=new A3(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)},i.prototype._shouldFilterElement=function(t,e){var i=t.isLeaf;return"leaf"===e?!i:i},i.prototype.handlePan=function(t){var e=t.delta;if(0!==e[0]||0!==e[1]){this._matrix.reset(),this._matrix.translate(e[0],e[1]);var i=this._matrix,n=i.a,r=i.b,a=i.c,o=i.d,s=i.e,l=i.f;this._matrix.multiply(n,r,a,o,s,l),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}},i.prototype.handleZoom=function(t){var e=t.scale,i=t.scaleCenter;if(1!==e){this._matrix.reset();var n=i.x,r=i.y;this._matrix.translate(n,r),this._matrix.scale(e,e),this._matrix.translate(-n,-r);var a=this._matrix,o=a.a,s=a.b,l=a.c,u=a.d,c=a.e,h=a.f;this._matrix.multiply(o,s,l,u,c,h),this.disableMarkAnimation(),this.event.on(gV.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()},i.prototype.enableMarkAnimation=function(){this.getMarks().forEach((function(t){})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().enableAnimation()})),this.event.off(gV.AFTER_DO_RENDER,this._enableAnimationHook)},i.prototype.disableMarkAnimation=function(){this.getMarks().forEach((function(t){})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().disableAnimation()}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._nonLeafMark,this._leafMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.treemap,i.mark=C3,i.builtInTheme={treemap:B3},i.transformerConstructor=w3,i}(gY);Tt(P3,U2),Tt(P3,_Z);var R3,L3,I3=function(){T3(),D3(),Lq(),wJ(),ij.registerAnimation("treemap",(function(t,e){return{appear:M3(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}})),eG(),ij.registerSeries(P3.type,P3)},F3=M(M({},l$),((R3={}).segment={name:"segment",type:"arc"},R3.track={name:"track",type:"arc"},R3)),O3=M(M({},qG),((L3={}).pin={name:"pin",type:"path"},L3.pinBackground={name:"pinBackground",type:"path"},L3.pointer={name:"pointer",type:["path","rect"]},L3)),z3={type:"fadeIn"};function H3(t,e){return"fadeIn"===e?z3:function(t){return{channel:{angle:{from:t.startAngle+Math.PI/2}}}}(t)}var N3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return C(e,t),e}(hY),U3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(OG),j3="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z",V3={pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:j3,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:j3,fill:"#ddd"}}},W3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gaugePointer,i.transformerConstructor=N3,i._pinMark=null,i._pointerMark=null,i._pinBackgroundMark=null,i}return C(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null===(t=this._spec.pointer)||void 0===t?void 0:t.type)?"rect":"path"},i.prototype.initMark=function(){this._pinBackgroundMark=this._createMark(i.mark.pinBackground),this._pointerMark=this._createMark(M(M({},i.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(i.mark.pin)},i.prototype.initMarkStyle=function(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()},i.prototype.initGroups=function(){},i.prototype.initPointerMarkStyle=function(){var t=this,e=this._pointerMark,i=this._spec.pointer;e&&(this.setMarkStyle(e,{x:function(e){var n,r;return t._getPointerAnchor(e,i).x-t._getPointerWidth()*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[0])&&void 0!==r?r:0)},y:function(e){var n,r;return t._getPointerAnchor(e,i).y-t._getPointerHeight(e)*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0)},anchor:function(e){var n=t._getPointerAnchor(e,i);return[n.x,n.y]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(e,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)+Math.PI/2}}):this.setMarkStyle(e,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)-Math.PI/2}}))},i.prototype.initTooltip=function(){this._tooltipHelper=new U3(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)},i.prototype._getPointerAnchor=function(t,e){var i;return null===(i=e.isOnCenter)||void 0===i||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})},i.prototype._getPointerWidth=function(){return this._spec.pointer.width*this._computeLayoutRadius()},i.prototype._getPointerHeight=function(t){var e,i,n=this._spec.pointer,r=this._radiusField[0];return W(this.radiusAxisHelper)&&W(r)?this.radiusAxisHelper.dataToPosition([t[r]])-(null!==(e=null==n?void 0:n.innerPadding)&&void 0!==e?e:0)-(null!==(i=null==n?void 0:n.outerPadding)&&void 0!==i?i:10):n.height*this._computeLayoutRadius()},i.prototype._getPointerAngle=function(t){var e=this.angleAxisHelper.getScale().domain(),i=Bt(e),n=Pt(e),r=he(t[this._angleField[0]],n,i);return this.angleAxisHelper.dataToPosition([r])},i.prototype._getRotatedPointerCenterOffset=function(t){var e,i,n,r,a=this._spec.pointer,o=this._getPointerWidth()*(null!==(i=null===(e=null==a?void 0:a.center)||void 0===e?void 0:e[0])&&void 0!==i?i:0),s=-this._getPointerHeight(t)*(null!==(r=null===(n=null==a?void 0:a.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0),l=this._getPointerAngle(t)-Math.PI/2,u=Math.cos(l),c=Math.sin(l);return{x:o*u+s*c,y:-(s*u-o*c)}},i.prototype.initPinBackgroundMarkStyle=function(){var t=this,e=this._pinBackgroundMark,i=this._spec.pinBackground;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:100})},i.prototype.initPinMarkStyle=function(){var t=this,e=this._pinMark,i=this._spec.pin;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:300})},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._pointerMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("gaugePointer"))||void 0===i?void 0:i({startAngle:this._startAngle},n),rY("pointer",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gaugePointer,i.mark=O3,i.builtInTheme={gaugePointer:V3},i.transformerConstructor=N3,i}(u$),G3=function(){ij.registerSeries(W3.type,W3),dZ(),Lq(),ij.registerAnimation("gaugePointer",(function(t,e){var i=H3(t,e);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})),EQ(),TQ()},Y3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"segment")},e}(hY),X3={outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},K3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gauge,i.transformerConstructor=Y3,i._segmentMark=null,i._trackMark=null,i._padAngle=0,i}return C(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._padAngle=Ci(null!==(t=this._spec.padAngle)&&void 0!==t?t:0)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this);EV(this._option.dataSet,"spiltSegment",(function(t,e){var n=t.slice();return n.sort((function(t,e){return t[i._angleField[0]]-e[i._angleField[0]]})),n.forEach((function(t,e){t[Zj]=t[i._angleField[0]],t[qj]=e>0?n[e-1][Zj]:void 0})),n})),null===(t=this.getViewData())||void 0===t||t.transform({type:"spiltSegment"},!1)},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(i.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this.initTrackMarkStyle(),this.initSegmentMarkStyle()},i.prototype.initSegmentMarkStyle=function(){var t,e=this,i=this._segmentMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})},i.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e._computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e._computeLayoutRadius()*t.innerRadius}),i}},i.prototype.initMarkStyleWithSpec=function(i,n){if(e.prototype.initMarkStyleWithSpec.call(this,i,n),i&&"segment"===i.name){var r=this.getSpec().segment;if(r)for(var a in r.state||{})this.setMarkStyle(i,this.generateRadiusStyle(r.state[a]),a,t.AttributeLevel.User_Mark)}},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)},i.prototype.initTrackMarkStyle=function(){var t,e=this,i=this._trackMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})},i.prototype._getAngleValueStartWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),n=pe(e,(e+i)/2)(e+(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?RU(n,this.angleAxisHelper.getScale(0)):n},i.prototype._getAngleValueEndWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),n=pe(i,(e+i)/2)(i-(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?RU(n,this.angleAxisHelper.getScale(0)):n},i.prototype._getAngleValueStartWithoutPadAngle=function(t){return W(t[qj])?this.angleAxisHelper.dataToPosition([t[qj]]):this._startAngle},i.prototype._getAngleValueEndWithoutPadAngle=function(t){return this.angleAxisHelper.dataToPosition([t[Zj]])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._segmentMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},n),rY("segment",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gauge,i.mark=F3,i.builtInTheme={gauge:X3},i.transformerConstructor=Y3,i}(u$),q3=function(){ij.registerSeries(K3.type,K3),aQ(),p$(),TQ()},Z3=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{fill:void 0,lineWidth:0,padding:0})},e.prototype._createGraphic=function(t){return void 0===t&&(t={}),Hm(t)},e.prototype._transformGraphicAttributes=function(e,i,n){var r,a,o,s=t.prototype._transformGraphicAttributes.call(this,e,i,n),l=null!==(a=null!==(r=s.shape)&&void 0!==r?r:s.symbolType)&&void 0!==a?a:null===(o=e.attribute)||void 0===o?void 0:o.symbolType;return j(l)?s.symbolType="rect":s.symbolType=l,s},e.type="cell",e}(NW);function J3(t){return!1===t?{}:{type:"fadeIn"}}var Q3,$3,t5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(OG),e5=M(M({},qG),((Q3={}).cell={name:"cell",type:"cell"},Q3.cellBackground={name:"cellBackground",type:"cell"},Q3)),i5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"cell")},e}(hY),n5={cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}},r5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.heatmap,i.transformerConstructor=i5,i}return C(i,e),i.prototype.getFieldValue=function(){return this._fieldValue},i.prototype.setFieldValue=function(t){this._fieldValue=Dt(t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFieldValue(this._spec.valueField)},i.prototype.initMark=function(){this._cellMark=this._createMark(i.mark.cell,{isSeriesMark:!0},{morph:sY(this._spec,i.mark.cell.name),morphElementKey:this.getDimensionField()[0]}),this._backgroundMark=this._createMark(i.mark.cellBackground)},i.prototype.initMarkStyle=function(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getMeasureField()[0]]}})},i.prototype.initCellMarkStyle=function(){var e=this;this.setMarkStyle(this._cellMark,{x:function(t){return e.dataToPositionX(t)},y:function(t){return e.dataToPositionY(t)},size:function(){return[e.getCellSize(e._xAxisHelper),e.getCellSize(e._yAxisHelper)]},fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)},i.prototype.initCellBackgroundMarkStyle=function(){var e,i,n,r=this,a=rr(null!==(n=null===(i=null===(e=this._spec.cellBackground)||void 0===e?void 0:e.style)||void 0===i?void 0:i.padding)&&void 0!==n?n:0);this.setMarkStyle(this._backgroundMark,{x:function(t){var e=r.getCellSize(r._xAxisHelper);return r.dataToPositionX(t)-e/2+a[3]},y:function(t){var e=r.getCellSize(r._yAxisHelper);return r.dataToPositionY(t)-e/2+a[0]},width:function(){return r.getCellSize(r._xAxisHelper)-a[1]-a[3]},height:function(){return r.getCellSize(r._yAxisHelper)-a[0]-a[2]}},"normal",t.AttributeLevel.Series)},i.prototype.getColorAttribute=function(){var t;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,r=vY(this);this._cellMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("heatmap"))||void 0===i?void 0:i(n),rY("cell",this._spec,this._markAttributeContext),r))},i.prototype.getCellSize=function(t){var e,i;return null!==(i=null===(e=t.getBandwidth)||void 0===e?void 0:e.call(t,0))&&void 0!==i?i:6},i.prototype.initTooltip=function(){this._tooltipHelper=new t5(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getDimensionField=function(){return[].concat(this.fieldX,this.fieldY)},i.prototype.getMeasureField=function(){return this.getFieldValue()},i.prototype.getActiveMarks=function(){return[this._cellMark]},i.type=t.SeriesTypeEnum.heatmap,i.mark=e5,i.builtInTheme={heatmap:n5},i.transformerConstructor=i5,i}(gY),a5=function(){wJ(),ij.registerMark(Z3.type,Z3),ij.registerGraphicComponent("symbol",Hm),cP(),dP(),jz(),ij.registerAnimation("heatmap",(function(t,e){return M(M({},$W),{appear:J3(e)})})),QX(),KX(),ij.registerSeries(r5.type,r5)},o5=M(M({},qG),(($3={}).nodePoint={name:"nodePoint",type:"symbol"},$3.ripplePoint={name:"ripplePoint",type:"ripple"},$3.centerPoint={name:"centerPoint",type:"symbol"},$3.centerLabel={name:"centerLabel",type:"text"},$3)),s5="".concat(Mj,"_CORRELATION_X"),l5="".concat(Mj,"_CORRELATION_Y"),u5="".concat(Mj,"_CORRELATION_SIZE"),c5=function(t,e){var i,n,r,a,o,s,l,u,c,h,d,p,f,v,g;if(!t||!(null==e?void 0:e.view)||!Z(t))return t;var y=e.view();if(y.x1-y.x0==0||y.y1-y.y0==0||y.x1-y.x0==-1/0||y.x1-y.x0==1/0||y.y1-y.y0==-1/0||y.y1-y.y0==1/0)return t;var m=Ci(null!==(i=e.startAngle)&&void 0!==i?i:-90),_=Ci(null!==(n=e.endAngle)&&void 0!==n?n:270),b=Math.max((y.x1-y.x0)/2,(y.y1-y.y0)/2),x=Ie(null!==(r=e.innerRadius)&&void 0!==r?r:0,b),k=Ie(e.outerRadius,b),S=[$(null===(a=e.center)||void 0===a?void 0:a[0])?e.center[0]:y.x0+Ie(null!==(s=null===(o=e.center)||void 0===o?void 0:o[0])&&void 0!==s?s:"50%",y.x1-y.x0),$(null===(l=e.center)||void 0===l?void 0:l[1])?e.center[1]:y.y0+Ie(null!==(c=null===(u=e.center)||void 0===u?void 0:u[1])&&void 0!==c?c:"50%",y.y1-y.y0)],A=Re(e.field),C=t.map(A),w=B(Oe(C),2),T=w[0],D=w[1],E=T===D?function(t){return(x+k)/2}:function(t){return x+(k-x)*(t-T)/(D-T)},P=j(e.radiusField)?A:Re(e.radiusField),R=null!==(d=null===(h=null==e?void 0:e.radiusRange)||void 0===h?void 0:h[1])&&void 0!==d?d:5,L=function(t){return R};if(P){var I=B(P!==A?Oe(t.map(P)):[T,D],2),F=I[0],O=I[1],z=null!==(f=null===(p=e.radiusRange)||void 0===p?void 0:p[0])&&void 0!==f?f:5,H=null!==(g=null===(v=e.radiusRange)||void 0===v?void 0:v[1])&&void 0!==g?g:5;F!==O&&(L=function(t){return z+(H-z)*(P(t)-F)/(O-F)})}var N=Math.min(m,_),U=Math.max(m,_),V=h5(N,U,t.length),W=[],G=(U-N)/60;return t.forEach((function(t,e){for(var i,n,r,a=E(C[e]),o=L(t),s=V[e],l=0;l<60&&(n=S[0]+a*Math.cos(s),r=S[1]+a*Math.sin(s),d5({x:n,y:r,size:o},W)||n-o<y.x0||n+o>y.x1||r-o<y.y0||r+o>y.y1);l++)l<59&&((s+=G)>U?s=N:s<N&&(s=U));W.push(M(((i={})[s5]=n,i[l5]=r,i[u5]=o,i),t))})),W},h5=function(t,e,i){for(var n=0,r=Math.max(Math.ceil(2*(e-t)/Math.PI),2),a=(e-t)/r,o=0,s=1,l=0,u=0,c=[],h=t;l<i;)u<r&&(c.push(h+(u%2?Math.floor(u/2)+Math.floor(r/2):u/2)*a*s),u++),l++,u===r&&(u=0,0===n?n=a/2:n/=2,h=-1===(s*=-1)?e-n:t+n,(o+=1)>=2&&(a/=2,r*=2));return c},d5=function(t,e){return!(!e||!e.length)&&e.some((function(e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)}))},p5=function(t,e){var i;if(!t||!Z(t))return[];var n=e.keyword,r=e.categoryField,a=t[0].latestData[0];return(i={})[r]=n,i[Ej]=null==a?void 0:a[Ej],i[Pj]=null==a?void 0:a[Pj],i},f5=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._subMarks={ripple0:{type:"symbol",defaultAttributes:{fillOpacity:.75}},ripple1:{type:"symbol",defaultAttributes:{fillOpacity:.5}},ripple2:{type:"symbol",defaultAttributes:{fillOpacity:.25}}},i._positionChannels=["ripple","size"],i._positionEncoder=function(t,e,i){var n=t.ripple,r=void 0===n?i.attribute.ripple:n,a=t.size,o=void 0===a?i.attribute.size:a,s=he(r,0,1),l=.5*o;return{ripple0:{size:o+l*s,fillOpacity:.75-.25*s},ripple1:{size:o+l*(1+s),fillOpacity:.5-.25*s},ripple2:{size:o+l*(2+s),fillOpacity:.25-.25*s}}},i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,ripple:0})},e.type="ripple",e}(lJ),v5=function(){uJ(),dP(),ij.registerMark(f5.type,f5),ij.registerGraphicComponent("symbol",(function(t){return Hm(t)}))},g5=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},y5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")},e}(hY),m5={centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}},_5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.correlation,i.transformerConstructor=y5,i._viewBox=new Fn,i}return C(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){W(t)&&(this._seriesField=t)},i.prototype.getSizeField=function(){return this._sizeField},i.prototype.setSizeField=function(t){W(t)&&(this._sizeField=t)},i.prototype.getSizeRange=function(){return this._sizeRange},i.prototype.setSizeRange=function(t){W(t)&&(this._sizeRange=t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)},i.prototype.initData=function(){var t,i,n;if(e.prototype.initData.call(this),this._data){EV(this._dataSet,"correlation",c5);var r=new uc;BV(r,"dataview",Xu),EV(r,"correlationCenter",p5);var a=new cc(r,{name:"".concat(this.type,"_").concat(this.id,"_center")});a.parse([this.getViewData()],{type:"dataview"}),a.transform({type:"correlationCenter",options:{keyword:null!==(n=null===(i=null===(t=this._spec.centerLabel)||void 0===t?void 0:t.style)||void 0===i?void 0:i.text)&&void 0!==n?n:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new IW(this._option,a)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._centerSeriesData)||void 0===t||t.compile()},i.prototype._statisticViewData=function(){var t=this;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"correlation",options:{view:function(){return{x0:t._viewBox.x1,x1:t._viewBox.x2,y0:t._viewBox.y1,y1:t._viewBox.y2}},field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})},i.prototype.initMark=function(){var e=this._createMark(i.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:Ej});e&&(e.setMarkConfig({zIndex:t.LayoutZIndex.Node}),this._nodePointMark=e);var n=this._createMark(i.mark.ripplePoint,{key:Ej,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});n&&(this._ripplePointMark=n);var r=this._createMark(i.mark.centerPoint,{key:Ej,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});r&&(r.setMarkConfig({zIndex:t.LayoutZIndex.Node}),this._centerPointMark=r)},i.prototype.initMarkStyle=function(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()},i.prototype._initNodePointMarkStyle=function(){var e,i,n,r,a=this._nodePointMark;if(a){var o=null!==(i=null===(e=this._spec.nodePoint)||void 0===e?void 0:e.style)&&void 0!==i?i:{};this.setMarkStyle(a,{x:function(t){return t[s5]},y:function(t){return t[l5]},size:function(t){return t[u5]},fill:null!==(n=o.fill)&&void 0!==n?n:this.getColorAttribute(),fillOpacity:null!==(r=o.fillOpacity)&&void 0!==r?r:1,lineWidth:0},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype._initRipplePointMarkStyle=function(){var e,i,n,r,a,o=this,s=this._ripplePointMark;if(s){var l=null!==(i=null===(e=this._spec.ripplePoint)||void 0===e?void 0:e.style)&&void 0!==i?i:{};this.setMarkStyle(s,{x:function(){var t;return null!==(t=o._spec.centerX)&&void 0!==t?t:(o._viewBox.x1+o._viewBox.x2)/2},y:function(){var t;return null!==(t=o._spec.centerY)&&void 0!==t?t:(o._viewBox.y1+o._viewBox.y2)/2},size:function(){return Math.max(o._viewBox.x2-o._viewBox.x1,o._viewBox.y2-o._viewBox.y1)/2},fill:null!==(n=l.fill)&&void 0!==n?n:this.getColorAttribute(),opacity:null!==(r=l.fillOpacity)&&void 0!==r?r:.2,ripple:null!==(a=l.ripple)&&void 0!==a?a:0},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype._initCenterPointMarkStyle=function(){var e,i,n,r,a,o,s=this,l=this._centerPointMark;l&&this.setMarkStyle(l,{x:function(){var t;return null!==(t=s._spec.centerX)&&void 0!==t?t:(s._viewBox.x1+s._viewBox.x2)/2},y:function(){var t;return null!==(t=s._spec.centerY)&&void 0!==t?t:(s._viewBox.y1+s._viewBox.y2)/2},size:function(){return.2*Math.max(s._viewBox.x2-s._viewBox.x1,s._viewBox.y2-s._viewBox.y1)/2},fill:null!==(n=null===(i=null===(e=this._spec.centerPoint)||void 0===e?void 0:e.style)||void 0===i?void 0:i.fill)&&void 0!==n?n:this.getColorAttribute(),fillOpacity:null!==(o=null===(a=null===(r=this._spec.centerPoint)||void 0===r?void 0:r.style)||void 0===a?void 0:a.fillOpacity)&&void 0!==o?o:1},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[i._categoryField]},z:this.dataToPositionZ.bind(this)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._nodePointMark.setAnimationConfig(nY(null===(e=ij.getAnimationInKey("correlation"))||void 0===e?void 0:e({},i),rY("nodePoint",this._spec,this._markAttributeContext)))},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._nodePointMark,this._centerPointMark]},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()},i.type=t.SeriesTypeEnum.correlation,i.mark=o5,i.builtInTheme={correlation:m5},i.transformerConstructor=y5,i}(GJ),b5=function(){jY(),v5(),ij.registerSeries(_5.type,_5),ij.registerAnimation("correlation",(function(t,e){return M({appear:g5(0,e)},QW)}))},x5={duration:2e3,loop:!0,channel:{wave:{from:0,to:1}}},k5=function(t){return{duration:2e3,channel:{wave:{from:0,to:1},height:t.height,dy:t.dy}}},S5=k5;function A5(t,e){switch(e){case"wave":default:return x5;case"grow":return k5(t);case"waveGrow":return S5(t)}}function C5(t,e){switch(e){case"wave":default:return x5;case"grow":case"waveGrow":return function(t){return{duration:2e3,channel:{dy:t.dy}}}(t)}}var M5,w5=M(M({},qG),((M5={}).liquidGroup={name:"liquidGroup",type:"group"},M5.liquid={name:"liquid",type:"liquid"},M5.liquidBackground={name:"liquidBackground",type:"group"},M5.liquidOutline={name:"liquidOutline",type:"group"},M5)),T5=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._subMarks={wave0:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:1}},wave1:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.66}},wave2:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.33}}},i._positionChannels=["wave","y","height"],i._positionEncoder=function(t,e,i){for(var n=t.wave,r=void 0===n?i.attribute.wave:n,a=t.y,o=void 0===a?i.attribute.y:a,s=t.height,l=void 0===s?i.attribute.height:s,u=[],c=[],h=[],d=0;d<21;d++){var p=50*d-500,f=o+(d%2==0?20:0),v=o+l;u.push({x:p+100*r,y:f,y1:v}),c.push({x:p+200*r-40,y:f,y1:v}),h.push({x:p+300*r-20,y:f,y1:v})}return{wave0:{x:0,y:0,points:u},wave1:{x:0,y:0,points:c},wave2:{x:0,y:0,points:h}}},i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{wave:0})},e.type="liquid",e}(lJ),D5=function(t,e){return"drop"===t?function(t,e,i){var n=4*i/3,r=Math.max(n,2*i),a=n/2,o=t,s=a+e-r/2,l=Math.asin(a/(.85*(r-a))),u=Math.sin(l)*a,c=Math.cos(l)*a,h=o-c,d=s+u,p=t,f=s+a/Math.sin(l);return"\n      M ".concat(h," ").concat(d,"\n      A ").concat(a," ").concat(a," 0 1 1 ").concat(h+2*c," ").concat(d,"\n      Q ").concat(p," ").concat(f," ").concat(t," ").concat(e+r/2,"\n      Q ").concat(p," ").concat(f," ").concat(h," ").concat(d,"\n      Z \n    ")}(0,0,e):t};var E5,B5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return e.series.getValueField()},e.markTooltipValueCallback=function(t){return t[e.series.getValueField()]},e.shapeStrokeCallback=function(t){return e.series.getMarkInName("liquid").getAttribute("fill",t)},e}return C(e,t),e}(OG),P5={outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}},R5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.liquid,i.transformerConstructor=VY,i._liquidBackgroundMark=null,i._liquidOutlineMark=null,i._getLiquidPosY=function(){var t=i._getLiquidBackPosAndSize(),e=t.height,n=t.startY;return(i._reverse?e*i._heightRatio:e*(1-i._heightRatio))+n},i._getLiquidHeight=function(){return i._getLiquidBackPosAndSize().height*i._heightRatio},i._getLiquidBackPosAndSize=function(t){var e,n;void 0===t&&(t=!1);var r=i._marginSpec,a=r.top,o=void 0===a?0:a,s=r.bottom,l=void 0===s?0:s,u=r.left,c=void 0===u?0:u,h=r.right,d=void 0===h?0:h,p=t?{}:i._paddingSpec,f=p.top,v=void 0===f?0:f,g=p.bottom,y=void 0===g?0:g,m=p.left,_=void 0===m?0:m,b=p.right,x=void 0===b?0:b;"triangle"===i._maskShape&&(l/=Math.sqrt(3),o=o/Math.sqrt(3)*2,y/=Math.sqrt(3),v=v/Math.sqrt(3)*2);var k=null!==(n=null===(e=i._region)||void 0===e?void 0:e.getLayoutRect())&&void 0!==n?n:{width:0,height:0},S=k.width,A=k.height,C=S/2+(c+_-(d+x))/2,M=A/2+(o+v-(l+y))/2,w=S-(c+d+_+x),T=A-(o+l+v+y),D=Math.min(w,T);return"rect"!==i._maskShape&&(w=D,T=D),{x:C,y:M,size:D,width:w,height:T,startX:C-w/2,startY:M-T/2,endX:C+w/2,endY:M+T/2}},i._getLiquidBackPath=function(t){var e,n;if(void 0===t&&(t=!1),"rect"===i._maskShape){var r=i._getLiquidBackPosAndSize(t),a=r.x,o=r.y,s=r.width,l=r.height;n=Ym({x:a-s/2,y:o-l/2,width:s,height:l,fill:!0})}else{var u=i._getLiquidBackPosAndSize(t),c=(a=u.x,o=u.y,u.size);n=Hm({x:a,y:o,size:c,symbolType:D5(null!==(e=i._spec.maskShape)&&void 0!==e?e:"circle",c),fill:!0})}return[n]},i}return C(i,e),i.prototype.setValueField=function(t){W(t)&&(this._valueField=t)},i.prototype.getValueField=function(){return this._valueField},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this._marginSpec=jU(this._spec.outlineMargin),this._paddingSpec=jU(this._spec.outlinePadding),this.setValueField(this._spec.valueField),this._reverse=null!==(t=this._spec.reverse)&&void 0!==t&&t,this._maskShape=null!==(i=this._spec.maskShape)&&void 0!==i?i:"circle"},i.prototype.viewDataUpdate=function(t){var i=this;e.prototype.viewDataUpdate.call(this,t),this._heightRatio=ai.apply(void 0,P([],B(this._data.getLatestData().map((function(t){return t[i._valueField]}))),!1))},i.prototype.initMark=function(){this._initLiquidOutlineMark(),this._initLiquidBackgroundMark(),this._initLiquidMark()},i.prototype.initMarkStyle=function(){this._initLiquidOutlineMarkStyle(),this._initLiquidBackgroundMarkStyle(),this._initLiquidMarkStyle()},i.prototype._initLiquidOutlineMark=function(){return this._liquidOutlineMark=this._createMark(i.mark.liquidOutline,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidOutlineMark},i.prototype._initLiquidBackgroundMark=function(){return this._liquidBackgroundMark=this._createMark(i.mark.liquidBackground,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidBackgroundMark},i.prototype._initLiquidMark=function(){return this._liquidGroupMark=this._createMark(i.mark.liquidGroup,{parent:this._liquidBackgroundMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark=this._createMark(i.mark.liquid,{parent:this._liquidGroupMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getLiquidBackPosAndSize=this._getLiquidBackPosAndSize,this._markAttributeContext.getLiquidPosY=this._getLiquidPosY,this._markAttributeContext.getLiquidHeight=this._getLiquidHeight},i.prototype._initLiquidOutlineMarkStyle=function(){var e=this,i=this._liquidOutlineMark;i.created(),this.setMarkStyle(i,{stroke:this.getColorAttribute(),width:function(){return e._region.getLayoutRect().width},height:function(){return e._region.getLayoutRect().height},path:function(){return e._getLiquidBackPath(!0)}},"normal",t.AttributeLevel.Series),this._liquidOutlineMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex})},i.prototype._initLiquidBackgroundMarkStyle=function(){var e=this,i=this._liquidBackgroundMark;i.created(),this.setMarkStyle(i,{width:function(){return e._region.getLayoutRect().width},height:function(){return e._region.getLayoutRect().height},path:function(){return e._getLiquidBackPath()}},"normal",t.AttributeLevel.Series),this._liquidBackgroundMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0})},i.prototype._initLiquidMarkStyle=function(){var e=this,i=this._liquidMark,n=this._liquidGroupMark;n&&this.setMarkStyle(n,{x:function(){return e._region.getLayoutStartPoint().x+e._region.getLayoutRect().width/2},angle:this._reverse?-Math.PI:0,y:0,dy:this._getLiquidPosY}),i&&this.setMarkStyle(i,{y:0,dy:0,height:this._getLiquidHeight,fill:this.getColorAttribute(),wave:0},"normal",t.AttributeLevel.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new B5(this),this._liquidMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._liquidMark)},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._liquidMark?[this._liquidMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={height:{from:0,to:function(){return r._getLiquidHeight()}},dy:{from:function(){var t=r._getLiquidBackPosAndSize(),e=t.height,i=t.startY;return(r._reverse?0:e)+i}}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._liquidMark.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("liquid"))||void 0===i?void 0:i(a,o),rY("liquid",this._spec,this._markAttributeContext))),this._liquidGroupMark.setAnimationConfig(nY(null===(n=ij.getAnimationInKey("liquidGroup"))||void 0===n?void 0:n(a,o),rY("liquidGroup",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this._spec.indicatorSmartInvert&&this._option.getChart().getComponentsByKey("indicator")&&this.event.on(t.ChartEvent.renderFinished,(function(){i._option.getChart().getComponentsByKey("indicator").forEach((function(t){var e,n,r,a=null===(e=i._liquidMark.getGraphics()[0].getSubGraphic())||void 0===e?void 0:e[0],o=a.globalAABBBounds,s=o.y1,l=o.y2;s+=i._region.getLayoutStartPoint().y,l+=i._region.getLayoutStartPoint().y,null===(r=null===(n=null==t?void 0:t.getIndicatorComponent())||void 0===n?void 0:n.getChildren()[0])||void 0===r||r.getChildren().forEach((function(t){var e=t.globalAABBBounds,i=e.y1,n=e.y2;if(s<i&&l>n){var r=OP(t.attribute.fill,a.attribute.fill);t.setAttribute("fill",r)}}))}))}))},i.prototype.dataToPosition=function(t){return null},i.prototype.dataToPositionX=function(t){return null},i.prototype.dataToPositionY=function(t){return null},i.prototype.valueToPosition=function(t,e){return null},i.prototype.getStatisticFields=function(){return[]},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._liquidMark]},i.type=t.SeriesTypeEnum.liquid,i.mark=w5,i.builtInTheme={liquid:P5},i.transformerConstructor=VY,i}(dY),L5=function(){uJ(),NB(),ij.registerMark(T5.type,T5),ij.registerGraphicComponent("area",(function(t){return g_(t)})),jW(),ij.registerAnimation("liquid",(function(t,e){return{appear:A5(t,e),enter:A5(t,e),exit:A5(t,e)}})),ij.registerAnimation("liquidGroup",(function(t,e){return{appear:C5(t,e),enter:C5(t,e),exit:C5(t,e)}})),ij.registerSeries(R5.type,R5)},I5=function(t){return Dt(t).join(",")},F5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){return I5(null==t?void 0:t[e.series.getDimensionField()[0]])},e.markTooltipKeyCallback=function(t){return I5(null==t?void 0:t[e.series.getDimensionField()[0]])},e}return C(e,t),e}(OG),O5=M(M({},qG),((E5={}).circle={name:"circle",type:"arc"},E5.overlap={name:"overlap",type:"path"},E5.overlapLabel={name:"overlapLabel",type:"text"},E5)),z5=function(t){switch(t){case"fadeIn":default:return{type:"fadeIn"};case"growIn":return{type:"growRadiusIn"};case"scaleIn":return{type:"scaleIn"}}},H5=function(t){switch(t){case"fadeIn":default:return{type:"fadeIn"};case"scaleIn":return{type:"scaleIn"}}},N5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.onBind=function(){var t,e,i=this;this.fromCircles={},null===(t=Y0(this.target.attribute.arcs))||void 0===t||t.forEach((function(t){i.fromCircles[t.setId]=t})),this.toCircles={},null===(e=Y0(this.target.getFinalAttribute().arcs))||void 0===e||e.forEach((function(t){i.toCircles[t.setId]=t}))},e.prototype.onUpdate=function(t,e,i){var n=this,r=[];Object.keys(this.fromCircles).forEach((function(t){var i=n.fromCircles[t],a=n.toCircles[t];i&&a&&r.push({radius:i.radius+(a.radius-i.radius)*e,x:i.x+(a.x-i.x)*e,y:i.y+(a.y-i.y)*e,setId:t})}));var a=W0(r);this.target.setAttributes({arcs:a,path:G0(a)})},e}(NL),U5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"circle"),this._addMarkLabelSpec(t,"overlap","overlapLabel","initOverlapLabelMarkStyle")},e}(hY),j5=function(t,e){var i=e.getViewBox();return i&&(null==t?void 0:t.length)?X0(M({setField:e.setField,valueField:e.valueField},i),t):[]},V5={circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},W5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.venn,i.transformerConstructor=U5,i._viewBox=new Fn,i}return C(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(null!==(t=this._spec.categoryField)&&void 0!==t?t:"sets"),this.setValueField(null!==(i=this._spec.valueField)&&void 0!==i?i:"size"),this.setSeriesField(null!==(n=this._spec.seriesField)&&void 0!==n?n:Bj)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),EV(this._dataSet,"venn",j5),null===(t=this._data.getDataView())||void 0===t||t.transform({type:"venn",options:{getViewBox:function(){return i._viewBox.empty()?null:{x0:i._viewBox.x1,x1:i._viewBox.x2,y0:i._viewBox.y1,y1:i._viewBox.y2}},setField:this._categoryField,valueField:this._valueField}})},i.prototype.compile=function(){e.prototype.compile.call(this),this._runVennTransform()},i.prototype._runVennTransform=function(t){void 0===t&&(t=!1),this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()},i.prototype.initMark=function(){var t=this._createMark(i.mark.circle,{isSeriesMark:!0});t&&(t.setTransform([{type:"vennMark",datumType:"circle"}]),this._circleMark=t);var e=this._createMark(i.mark.overlap,{isSeriesMark:!0});e&&(e.setTransform([{type:"vennMark",datumType:"overlap"}]),this._overlapMark=e)},i.prototype.initMarkStyle=function(){this._initCircleMarkStyle(),this._initOverlapMarkStyle()},i.prototype._initCircleMarkStyle=function(){this._circleMark&&this.setMarkStyle(this._circleMark,{x:function(t){return t.x},y:function(t){return t.y},innerRadius:0,outerRadius:function(t){return t.radius},startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),stroke:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initOverlapMarkStyle=function(){this._overlapMark&&(this.setMarkStyle(this._overlapMark,{x:function(t){return t.x},y:function(t){return t.y},path:function(t){return t.path},arcs:function(t){return t.arcs},fill:this.getColorAttribute(),stroke:this.getColorAttribute(),zIndex:function(t){return 100*t.sets.length}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this.setMarkStyle(this._overlapMark,{zIndex:function(t){return 100*t.sets.length+1}},t.STATE_VALUE_ENUM.STATE_HOVER,t.AttributeLevel.Series))},i.prototype.initLabelMarkStyle=function(e){e&&(this._labelMark=e,e.setRule("venn"),this.setMarkStyle(e,{x:function(t){return t.labelX},y:function(t){return t.labelY},text:function(t){return I5(t.sets)},maxLineWidth:function(t){var e=t,i=e.x,n=e.radius,r=e.labelX,a=i-n,o=i+n;return Math.min(r-a,o-r)}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.initOverlapLabelMarkStyle=function(e){e&&(this._labelMark=e,e.setRule("venn"),this.setMarkStyle(e,{x:function(t){return t.labelX},y:function(t){return t.labelY},text:function(t){return I5(t.sets)}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.initTooltip=function(){this._tooltipHelper=new F5(this),this._circleMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circleMark),this._overlapMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._overlapMark)},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runVennTransform()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._circleMark,this._overlapMark]},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t,e){return{x:t.x,y:t.y}},i.prototype.dataToPositionX=function(t){return t.x},i.prototype.dataToPositionY=function(t){return t.y},i.prototype.valueToPosition=function(t,e){throw new Error("Method not implemented.")},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:I5(e),originalKey:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesFieldValue=function(t,i){var n=e.prototype.getSeriesFieldValue.call(this,t,i);return I5(n)},i.prototype.legendSelectedFilter=function(t,e){if(t.type===L.discreteLegend){var i=t.getLegendDefaultData(!0);if(0===e.length&&i.length)return[];if(e.length===i.length)return e;var n={};e.forEach((function(t){n[t]=!0}));var r=i.filter((function(t){return!n[I5(t)]})),a=i.filter((function(t){return!r.includes(t)&&r.some((function(e){return Dt(e).every((function(e){return t.includes(e)}))}))}));e=e.slice(),a.forEach((function(t){e.splice(e.indexOf(I5(t)),1)}))}return e},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("arc").forEach((function(e){var i;e.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("vennCircle"))||void 0===i?void 0:i(),rY(e.name,t._spec,t._markAttributeContext)))})),this.getMarksInType("path").forEach((function(e){var i;e.setAnimationConfig(nY(null===(i=ij.getAnimationInKey("vennOverlap"))||void 0===i?void 0:i(),rY(e.name,t._spec,t._markAttributeContext)))}))},i.type=t.SeriesTypeEnum.venn,i.mark=O5,i.builtInTheme={venn:V5},i.transformerConstructor=U5,i}(dY),G5=function(){aQ(),dZ(),ij.registerAnimation("vennCircle",(function(t,e){return{appear:z5(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}})),ij.registerAnimation("vennOverlap",(function(t,e){return{appear:H5(e),update:{custom:N5},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),eG(),ij.registerGrammarTransform("vennMark",{transform:K0}),ij.registerSeries(W5.type,W5)},Y5={label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}},X5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.mosaic,i.transformerConstructor=zq,i}return C(i,e),Object.defineProperty(i.prototype,"bandWidthField",{get:function(){return this._bandWidthField},enumerable:!1,configurable:!0}),i.prototype.getStack=function(){return!0},i.prototype.getPercent=function(){return this._spec.percent},i.prototype.getGroupFields=function(){return"vertical"===this.direction?this._specXField:this._specYField},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this);var t=this.getPercent();"horizontal"===this.direction?(t&&(this.setFieldX(Yj),this.setFieldX2(Gj)),this.setFieldY(Kj),this.setFieldY2(Xj)):(t&&(this.setFieldY(Yj),this.setFieldY2(Gj)),this.setFieldX(Kj),this.setFieldX2(Xj)),this._spec.bandWidthField&&(this._bandWidthField=this._spec.bandWidthField)},i.prototype.parseLabelStyle=function(t,e){if((null==e?void 0:e.filterByGroup)&&j(t.dataFilter)){var i=this.getGroupFields(),n=e.filterByGroup,r=n.field,a=n.type,o=void 0===a?"max":a,s=n.filter;delete t.filterField;var l=i.indexOf(r);if(l<0)return;var u=!!(l%2)?"min"===o?"horizontal"===this.direction?this._fieldY2:this._fieldX2:"horizontal"===this.direction?this._fieldY:this._fieldX:"min"===o?"horizontal"===this.direction?this._fieldX2:this._fieldY2:"horizontal"===this.direction?this._fieldX:this._fieldY,c="min"===o?function(t,e){var i,n;return(null===(i=t.data)||void 0===i?void 0:i[u])<(null===(n=e.data)||void 0===n?void 0:n[u])}:function(t,e){var i,n;return(null===(i=t.data)||void 0===i?void 0:i[u])>(null===(n=e.data)||void 0===n?void 0:n[u])};t.dataFilter=function(t){var e={};return t.forEach((function(t){var i=t.data,n=null==i?void 0:i[r];j(n)||s&&!s(t)||e[n]&&!c(t,e[n])||(e[n]=t)})),t.filter((function(t){var i,n=null===(i=t.data)||void 0===i?void 0:i[r];return e[n]&&e[n]===t}))}}return t},i.type=t.SeriesTypeEnum.mosaic,i.builtInTheme={mosaic:Y5},i.transformerConstructor=zq,i}(Nq),K5=function(){Lq(),wJ(),eG(),KX(),ij.registerSeries(X5.type,X5)},q5=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return C(i,e),i.prototype._isValidSeries=function(e){return e===t.SeriesTypeEnum.map},i.prototype._getDefaultSeriesSpec=function(t){return e.prototype._getDefaultSeriesSpec.call(this,t,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])},i.prototype.transformSpec=function(t){e.prototype.transformSpec.call(this,t),t.region.forEach((function(t){t.coordinate="geo"})),e.prototype.transformSeriesSpec.call(this,t)},i}(wK),Z5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=q5,i.type="map",i.seriesType=t.SeriesTypeEnum.map,i}return C(i,e),i.type="map",i.seriesType=t.SeriesTypeEnum.map,i.transformerConstructor=q5,i}(CK),J5=function(){oq(),MZ(),ij.registerChart(Z5.type,Z5)},Q5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype.getIndicatorSpec=function(t){var e,i,n,r=Dt(t.indicator),a=null!==(e=t.innerRadius)&&void 0!==e?e:null===(n=null===(i=t.series)||void 0===i?void 0:i[0])||void 0===n?void 0:n.innerRadius;return W(a)&&r.forEach((function(t){j(t.limitRatio)&&(t.limitRatio=a)})),r},e.prototype._getDefaultSeriesSpec=function(e,i){return t.prototype._getDefaultSeriesSpec.call(this,e,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],i)},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),Z(e.dataZoom)&&e.dataZoom.length>0&&e.dataZoom.forEach((function(t){"axis"===t.filterMode&&(t.filterMode="filter")})),this.transformSeriesSpec(e),W(e.indicator)&&(e.indicator=this.getIndicatorSpec(e))},e}(wK),$5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e,["startAngle","endAngle","centerX","centerY"]);return i.categoryField=e.categoryField||e.radiusField,i.valueField=e.valueField||e.angleField,i},e.prototype._transformProgressAxisSpec=function(t,e,i,n,r){var a,o;t.axes||(t.axes=[]);var s=(null!==(a=t.axes)&&void 0!==a?a:[]).find((function(t){return"radius"===t.orient})),l=(null!==(o=t.axes)&&void 0!==o?o:[]).find((function(t){return"angle"===t.orient}));l||(l=e,t.axes.push(l)),s||(s=i,t.axes.push(s)),j(l.type)&&(l.type="linear"),j(s.type)&&(s.type="band");var u=eX(l,{min:0,max:1});j(l.min)&&(l.min=u.min),j(l.max)&&(l.max=u.max),n&&Object.assign(l,ej({},n,l)),r&&Object.assign(s,ej({},r,s))},e}(Q5),t4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.needAxes=function(){return!0},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.categoryField=e.categoryField||e.angleField,i.valueField=e.valueField||e.radiusField,i},e.prototype.transformSpec=function(e){var i;if(t.prototype.transformSpec.call(this,e),this.needAxes()){e.axes||(e.axes=[]);var n={radius:!1,angle:!1};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=!0),"angle"===e&&(n.angle=!0)})),n.angle||e.axes.push({orient:"angle"}),n.radius||e.axes.push({orient:"radius"})}},e}(Q5),e4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","useSequentialAnimation","layoutRadius"]);return n.categoryField=e.categoryField||e.seriesField,n.valueField=e.valueField||e.angleField,n.emptyCircle=null===(i=e.emptyPlaceholder)||void 0===i?void 0:i.emptyCircle,n},e}(Q5),i4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=e4,e}return C(e,t),e.transformerConstructor=e4,e}(CK),n4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=e4,i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i}return C(i,e),i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i.transformerConstructor=e4,i}(i4),r4=function(){oq(),dQ(),ij.registerChart(n4.type,n4)},a4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r,a=t.prototype._getDefaultSeriesSpec.call(this,e);return a.radius=null!==(i=e.radius)&&void 0!==i?i:yX,a.outerRadius=null!==(n=e.outerRadius)&&void 0!==n?n:yX,a.innerRadius=null!==(r=e.innerRadius)&&void 0!==r?r:0,a.stack=e.stack,a.percent=e.percent,a},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){["domainLine","grid","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),"angle"===t.orient&&j(t.bandPosition)&&(t.bandPosition=.5)})),e.crosshair=Dt(e.crosshair||{}).map((function(t){return ej({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t)}))},e}(t4),o4=function(t,e){if(!t)return null;var i=BY(t,(function(t){return"angle"===t.getOrient()}),e),n=BY(t,(function(t){return"radius"===t.getOrient()}),e);if(!(i&&i.length||n&&n.length))return null;var r=[],a=function(t){return t.getDimensionField()[0]},o=e.x,s=e.y;return i&&i.forEach((function(t){var e,i=t.getScale();if(i&&iO(i.type)){var l=i.domain(),u=i.range(),c=t.getCenter(),h={x:o-t.getLayoutStartPoint().x-c.x,y:s-t.getLayoutStartPoint().y-c.y},d=sU({x:1,y:0},h);d=function(t,e){var i=2*Math.PI,n=Pt(e),r=Bt(e);return t<n?t+=Math.ceil((n-t)/i)*i:t>r&&(t-=Math.ceil((t-r)/i)*i),t}(d,u);var p=lU(h),f=null===(e=n[0])||void 0===e?void 0:e.getScale(),v=null==f?void 0:f.range();if((d-(null==u?void 0:u[0]))*(d-(null==u?void 0:u[1]))>0||(p-(null==v?void 0:v[0]))*(p-(null==v?void 0:v[1]))>0)return;var g=t.invert(d);if(j(g))return;var y=l.findIndex((function(t){return(null==t?void 0:t.toString())===g.toString()}));y<0&&(y=void 0);var m=DY(g,t,"polar",a);r.push({index:y,value:g,position:i.scale(g),axis:t,data:m})}})),n&&n.forEach((function(t){var e,n=t.getScale(),l=null==n?void 0:n.range();if(n&&iO(n.type)){var u=t.getCenter(),c={x:o-t.getLayoutStartPoint().x-u.x,y:s-t.getLayoutStartPoint().y-u.y},h=sU({x:1,y:0},c);h<-Math.PI/2&&(h=2*Math.PI+h);var d=lU(c),p=null===(e=i[0])||void 0===e?void 0:e.getScale(),f=null==p?void 0:p.range();if((h-(null==f?void 0:f[0]))*(h-(null==f?void 0:f[1]))>0||(d-(null==l?void 0:l[0]))*(d-(null==l?void 0:l[1]))>0)return;var v=n.invert(d);if(j(v))return;var g=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===v.toString()}));g<0&&(g=void 0);var y=DY(v,t,"polar",a);r.push({index:g,value:v,position:n.scale(v),axis:t,data:y})}})),r.length?r:null},s4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=a4,i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=o4},i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i.transformerConstructor=a4,i}(CK);Tt(s4,PK);var l4=function(){rq(),oq(),FK(),IK(),RQ(),ij.registerChart(s4.type,s4)},u4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e);return n.line=e.line,n.point=e.point,n.stack=e.stack,n.percent=e.percent,n.area=ej({visible:!1},e.area),n.seriesMark=null!==(i=e.seriesMark)&&void 0!==i?i:"area",n.activePoint=e.activePoint,n.pointDis=e.pointDis,n.pointDisMul=e.pointDisMul,n.markOverlap=e.markOverlap,n},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){"radius"===t.orient&&(["domainLine","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),t.grid||(t.grid={visible:!0}))})),e.crosshair=Dt(e.crosshair||{}).map((function(t){return ej({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t)}))},e}(t4),c4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=u4,i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=o4},i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i.transformerConstructor=u4,i}(CK);Tt(c4,PK);var h4=function(){rq(),oq(),lq(),FK(),IK(),KQ(),ij.registerChart(c4.type,c4)},d4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return delete i.data,i},e.prototype._transformAxisSpec=function(t){var e=this;t.axes&&t.autoBandSize&&t.series.forEach((function(i,n){var r;if("bar"===i.type){var a=e._findBandAxisBySeries(i,n,t.axes);if(a&&!a.bandSize&&!a.maxBandSize&&!a.minBandSize){var o=G(i.autoBandSize)&&null!==(r=i.autoBandSize.extend)&&void 0!==r?r:0,s=i.barMaxWidth,l=i.barMinWidth,u=i.barWidth,c=i.barGapInGroup;e._applyAxisBandSize(a,o,{barMaxWidth:s,barMinWidth:l,barWidth:u,barGapInGroup:c})}}}))},e.prototype.transformSpec=function(e){var i=this;if(t.prototype.transformSpec.call(this,e),e.series&&e.series.length){var n=this._getDefaultSeriesSpec(e);e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))}))}e.axes&&e.axes.length&&e.axes.forEach((function(t){ht(t,"trimPadding")&&ej(t,rW(i.type,e))})),this._transformAxisSpec(e)},e}(wK),p4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=d4,e.type="common",e}return C(e,t),e.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=function(t,e,i){var n,r;return P(P([],B(null!==(n=jK(t,e,i))&&void 0!==n?n:[]),!1),B(null!==(r=o4(t,e))&&void 0!==r?r:[]),!1)},this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},e.type="common",e.transformerConstructor=d4,e}(CK);Tt(p4,PK);var f4=function(){rq(),oq(),lq(),FK(),ij.registerChart(p4.type,p4),IK()},v4=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return C(i,e),i.prototype._getSeriesDataLength=function(t,e){var i,n;if(e.data){var r=Dt(e.data)[0];return r instanceof cc?null===(i=r.latestData)||void 0===i?void 0:i.length:null===(n=r.values)||void 0===n?void 0:n.length}var a=Dt(t.data).find((function(t,i){return e.dataId?t instanceof cc?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i}));return a?a instanceof cc?a.latestData.length:a.values.length:0},i.prototype.addAttrToComponentSpec=function(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t},i.prototype.addPaddingRow=function(t,e,i){t.push({index:e,size:i})},i.prototype.addOrientAxes=function(t,e,i,n){t.push({id:"regionAxesRow".concat(i)}),e.push({modelId:"axesRow".concat(i),col:1,row:i}),n.axes[0].id="axesRow".concat(i),n.axes[0].regionIndex=Array.from(Array(n.series.length),(function(t,e){return"top"===n.axes[0].orient?e+1:e}))},i.prototype.transformSpec=function(i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m=this;e.prototype.transformSpec.call(this,i);var _=0,b=[],x=[],k=[],S=[],A=[],C=this._option.getCompiler().getStage(),w=(C.viewWidth,C.viewHeight),T=0;if(null==i?void 0:i.legends){b.push({modelId:"legendRow".concat(_),col:1,row:_}),this.addAttrToComponentSpec(i.legends,"id","legendRow".concat(_));var D=Dt(i.legends),E=null!==(n=D[0].height)&&void 0!==n?n:40;if(D[0].padding){var R=jU(D[0].padding);E+=Number(null!==(r=null==R?void 0:R.bottom)&&void 0!==r?r:0),E+=Number(null!==(a=null==R?void 0:R.top)&&void 0!==a?a:0),D[0].offsetY=Number(null!==(s=null===(o=D[0])||void 0===o?void 0:o.offsetY)&&void 0!==s?s:0)+Number(null!==(l=null==R?void 0:R.top)&&void 0!==l?l:0)}A.push({index:_,size:E}),T+=E,_++}(null==i?void 0:i.dataZoom)&&(b.push({modelId:"dataZoomRow".concat(_),col:1,row:_}),this.addAttrToComponentSpec(i.dataZoom,"id","dataZoomRow".concat(_)),T+=60,_++,this.addPaddingRow(A,_,10),T+=10,_++),T+=60,null!==i.axes&&"top"!==(null===(c=null===(u=null==i?void 0:i.axes)||void 0===u?void 0:u[0])||void 0===c?void 0:c.orient)||(this.addOrientAxes(x,b,_,i),_++);var L=i.series.filter((function(e){return e.type!==t.SeriesTypeEnum.link})).length,I=(w-T-20*L)/L,F=(null===(h=null==i?void 0:i.appendPadding)||void 0===h?void 0:h.left)||0,O=(null===(d=null==i?void 0:i.appendPadding)||void 0===d?void 0:d.right)||0;null===(p=null==i?void 0:i.series)||void 0===p||p.forEach((function(e){var n,r;if([t.SeriesTypeEnum.bar,t.SeriesTypeEnum.line,t.SeriesTypeEnum.area,t.SeriesTypeEnum.dot].includes(e.type)){if(b.push({modelId:"".concat(e.type,"Row").concat(_),col:1,row:_}),b.push({modelId:"axesLeftRow".concat(_),col:0,row:_}),x.push({id:"".concat(e.type,"Row").concat(_),clip:!1}),A.push({index:_,size:(null==e?void 0:e.height)||I}),k.push({orient:"left",id:"axesLeftRow".concat(_),type:e.type===t.SeriesTypeEnum.dot?"band":"linear",visible:e.type!==t.SeriesTypeEnum.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.visible)||(null===(r=null==e?void 0:e.grid)||void 0===r?void 0:r.visible),style:function(t,i){var n,r,a,o,s,l=0;if(0===i){var u=null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.style;l=null!==(a=null!==(r=null==u?void 0:u.lineWidth)&&void 0!==r?r:null==u?void 0:u.strokeWidth)&&void 0!==a?a:1}return{lineWidth:l,stroke:(null===(s=null===(o=null==e?void 0:e.grid)||void 0===o?void 0:o.style)||void 0===s?void 0:s.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:x.length-1}),e.type===t.SeriesTypeEnum.dot){b.push({modelId:"scrollBarRightRow".concat(_),col:2,row:_});var a=m._getSeriesDataLength(i,e),o=0;a&&(o=((null==e?void 0:e.height)||I)/(30*a)),S.push(M({orient:"right",visible:e.type===t.SeriesTypeEnum.dot&&o<1,id:"scrollBarRightRow".concat(_),start:0,end:Math.min(o,1),filterMode:"axis",regionIndex:x.length-1,axisId:"axesLeftRow".concat(_)},Dt(null==i?void 0:i.scrollBar)[0]))}e.regionIndex=x.length-1,_++,m.addPaddingRow(A,_,(null==e?void 0:e.padding)||20),_++,e.leftAppendPadding=F,e.type===t.SeriesTypeEnum.dot&&(e.title.style.dx=-F,e.subTitle.style.dx=-F)}})),this.addPaddingRow(A,_,20),_++,null===(f=null==i?void 0:i.series)||void 0===f||f.forEach((function(e){if(e.type===t.SeriesTypeEnum.link){var n=e.dotSeriesIndex+1;b.push({modelId:"".concat(e.type,"Row").concat(n),col:1,row:n-1}),e.regionIndex=i.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=F,e.height=i.series[e.dotSeriesIndex].height,e.clipHeight=i.series[e.dotSeriesIndex].clipHeight}})),(null==i?void 0:i.legends)&&this.addAttrToComponentSpec(i.legends,"regionIndex",[x.length-1]),"bottom"===(null===(g=null===(v=null==i?void 0:i.axes)||void 0===v?void 0:v[0])||void 0===g?void 0:g.orient)&&(this.addOrientAxes(x,b,_,i),_++);var z={type:"grid",col:4,row:_,colWidth:[{index:0,size:F},{index:2,size:12},{index:3,size:O}],rowHeight:A,elements:b};i.layout=z,i.region=x,null===(y=i.axes)||void 0===y||y.push.apply(y,P([],B(k),!1)),i.scrollBar=S},i}(wK),g4=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=v4,t.type="sequence",t}return C(i,e),i.prototype._createSeries=function(e,i){if(e){var n,r=i.spec,a=w(i,["spec"]);if(r.type===t.SeriesTypeEnum.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(n=this.getRegionsInUserId(r.regionId)),n||(n=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),n){var o=new e(r,M(M(M({},this._modelOption),a),{region:n,specKey:"series",globalScale:this._globalScale}));o&&(o.created(),this._series.push(o),n.addSeries(o))}}},i.type="sequence",i.transformerConstructor=v4,i}(CK),y4=function(){rq(),oq(),e$(),s$(),QX(),KX(),ij.registerChart(g4.type,g4)},m4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes.forEach((function(t){return t.type="linear"}))},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["x2Field","y2Field","barMinHeight","barBackground","barGap"])},e}(TK),_4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=m4,e}return C(e,t),e.transformerConstructor=m4,e}(CK);Tt(_4,PK);var b4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e}(m4),x4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=b4,i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i.transformerConstructor=b4,i}(_4),k4=function(){rq(),oq(),lq(),FK(),IK(),Uq(),ij.registerTransform("bin",du),ij.registerChart(x4.type,x4)},S4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return r.progress=e.progress,r.track=e.track,r.tickMask=e.tickMask,r.cornerRadius=null!==(i=e.cornerRadius)&&void 0!==i?i:0,r.roundCap=null!==(n=e.roundCap)&&void 0!==n&&n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this._transformProgressAxisSpec(e,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:e.tickMask&&!1!==e.tickMask.visible})},e}($5),A4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=S4,i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=o4},i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i.transformerConstructor=S4,i}(CK);Tt(A4,PK);var C4=function(){rq(),oq(),FK(),IK(),y$(),ij.registerChart(A4.type,A4)},M4=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return C(i,e),i.prototype._getDefaultSeriesSpec=function(t){var i=e.prototype._getDefaultSeriesSpec.call(this,t);return i.radiusField=t.radiusField,i.pin=t.pin,i.pinBackground=t.pinBackground,i.pointer=t.pointer,i},i.prototype._getDefaultCircularProgressSeriesSpec=function(i){var n=e.prototype._getDefaultSeriesSpec.call(this,i);return n.type=t.SeriesTypeEnum.circularProgress,n},i.prototype.transformSpec=function(i){var n,r,a,o,s;e.prototype.transformSpec.call(this,i);var l=null===(n=i.series)||void 0===n?void 0:n.find((function(e){return e.type===t.SeriesTypeEnum.gauge||e.type===t.SeriesTypeEnum.circularProgress}));j(l)&&("circularProgress"===(l=null!==(r=i.gauge)&&void 0!==r?r:this._getDefaultCircularProgressSeriesSpec(i)).type&&(j(l.radiusField)&&j(l.categoryField)&&(l.radiusField=null!==(o=null!==(a=i.radiusField)&&void 0!==a?a:i.categoryField)&&void 0!==o?o:i.seriesField),j(l.valueField)&&j(l.angleField)&&(l.valueField=null!==(s=i.valueField)&&void 0!==s?s:i.angleField)),1===i.series.length?i.series.push(l):i.series.forEach((function(t){t.type===l.type&&Object.keys(l).forEach((function(e){e in t||(t[e]=l[e])}))}))),l.type===t.SeriesTypeEnum.circularProgress?this._transformProgressAxisSpec(i,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:t.LayoutZIndex.Region+50}):this._transformGaugeAxisSpec(i)},i.prototype._transformGaugeAxisSpec=function(e){var i;e.axes||(e.axes=[]);var n={radius:null,angle:null};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=t),"angle"===e&&(n.angle=t)})),n.angle||(n.angle={orient:"angle",visible:!0},e.axes.push(n.angle)),n.radius||(n.radius={orient:"radius",visible:!1},e.axes.push(n.radius)),j(n.angle.type)&&(n.angle.type="linear"),j(n.radius.type)&&(n.radius.type="linear"),j(n.angle.zIndex)&&(n.angle.zIndex=t.LayoutZIndex.Region+50)},i}($5),w4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=M4,i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i}return C(i,e),i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i.transformerConstructor=M4,i}(CK),T4=function(){oq(),G3(),q3(),y$(),ij.registerChart(w4.type,w4)},D4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])},e}(wK),E4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=D4,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return C(i,e),i.transformerConstructor=D4,i}(CK),B4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=D4,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return C(i,e),i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i.transformerConstructor=D4,i}(E4),P4=function(){oq(),l2(),ij.registerChart(B4.type,B4)},R4=function(){ij.registerGrammarTransform("wordcloudShape",{transform:q1}),l2(),P4()},L4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range","transformRatioText"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),t.prototype.transformSeriesSpec.call(this,e)},e}(wK),I4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=L4,i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i}return C(i,e),i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i.transformerConstructor=L4,i}(CK),F4=function(){oq(),T2(),ij.registerChart(I4.type,I4)},O4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["bandWidth","progress","track","clamp"]);return r.direction=null!==(i=e.direction)&&void 0!==i?i:"horizontal",r.cornerRadius=null!==(n=e.cornerRadius)&&void 0!==n?n:0,r},e.prototype.transformSpec=function(e){var i,n;if(t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[]),"vertical"===e.direction){var r=null,a=null;(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"left"===e&&(r=t),"bottom"===e&&(a=t)})),r||(r={orient:"left",visible:!1},e.axes.push(r)),a||(a={orient:"bottom",visible:!1},e.axes.push(a)),j(a.type)&&(a.type="band"),j(r.type)&&(r.type="linear");var o=eX(r,{min:0,max:1});j(r.min)&&(r.min=o.min),j(r.max)&&(r.max=o.max)}else{var s=null,l=null;(null!==(n=e.axes)&&void 0!==n?n:[]).forEach((function(t){var e=t.orient;"left"===e&&(s=t),"bottom"===e&&(l=t)})),s||(s={type:"band",orient:"left",visible:!1},e.axes.push(s)),l||(l={orient:"bottom",visible:!1},e.axes.push(l)),j(l.type)&&(l.type="linear"),j(s.type)&&(s.type="band");o=eX(l,{min:0,max:1});j(l.min)&&(l.min=o.min),j(l.max)&&(l.max=o.max)}},e}(TK),z4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=O4,i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i.transformerConstructor=O4,i}(CK);Tt(z4,PK);var H4=function(){rq(),oq(),FK(),IK(),T$(),ij.registerChart(z4.type,z4)},N4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e}(TK),U4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=N4,i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i.transformerConstructor=N4,i}(CK),j4=function(){rq(),oq(),FK(),IK(),NJ(),ij.registerChart(U4.type,U4)},V4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=W(e.startAngle)?e.startAngle:-90,n=W(e.endAngle)?e.endAngle:i+Mi(2*Math.PI),r=t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return r.startAngle=i,r.endAngle=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),W4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=V4,i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i}return C(i,e),i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i.transformerConstructor=V4,i}(CK),G4=function(){oq(),X2(),ij.registerChart(W4.type,W4)},Y4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),X4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Y4,i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i}return C(i,e),i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i.transformerConstructor=Y4,i}(CK),K4=function(){oq(),t3(),ij.registerChart(X4.type,X4)},q4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),Z4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=q4,i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i}return C(i,e),i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i.transformerConstructor=q4,i}(CK),J4=function(){oq(),I3(),ij.registerChart(Z4.type,Z4)},Q4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.legends&&Dt(e.legends).forEach((function(t){t.select=!1,t.hover=!1,t.filter=!1})),eW(e)},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.bar=e.bar,i.stackLabel=e.stackLabel,i.leaderLine=e.leaderLine,i.total=e.total,i.calculationMode=e.calculationMode,i},e}(jq),$4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Q4,i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i.transformerConstructor=Q4,i}(Vq),t8=function(){rq(),oq(),lq(),FK(),IK(),nJ(),ij.registerChart($4.type,$4)},e8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=[e.maxField,e.medianField,e.q1Field,e.q3Field,e.minField,e.outliersField],r=t.prototype._getDefaultSeriesSpec.call(this,e,["boxPlot","outlier","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle","boxWidth","boxMaxWidth","boxMinWidth","boxGapInGroup"]);return r.direction=null!==(i=e.direction)&&void 0!==i?i:"vertical",r["horizontal"===r.direction?"xField":"yField"]=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[{orient:"bottom"},{orient:"left"}]),eW(e)},e}(TK),i8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=e8,i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i.transformerConstructor=e8,i}(CK),n8=function(){rq(),oq(),FK(),IK(),CJ(),ij.registerTransform("boxplot",pu),ij.registerChart(i8.type,i8)},r8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),a8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=r8,i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i}return C(i,e),i.prototype._setStateInDatum=function(t,e,i,n){var r=Z(e)?e[0]:e;if(r){var a=null;this.filterGraphicsByDatum(r,{filter:function(t,e){return"text"!==e.type&&e.getProduct()&&(!i||i(t,e))},region:n,getDatum:function(t){var e,i=null===(e=mV(t))||void 0===e?void 0:e.datum;return Z(i)&&(i=i[0]),i},callback:function(t,e,i,n){var r,a,o=e.getProductId();o&&(o.includes("node")||o.includes("link"))&&(null===(a=(r=i)._handleEmphasisElement)||void 0===a||a.call(r,{item:t,mark:e}))},regionCallback:function(t,e){r&&t.length&&(a=t[0])}}),a&&this._interaction.updateStateOfGraphics(t,[a])}else this._interaction.clearByState(t)},i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i.transformerConstructor=r8,i}(CK),o8=function(){oq(),rh.load(EP),k3(),ij.registerChart(a8.type,a8)},s8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return r.area=e.area,r.point=e.point,r.line=e.line,"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r.stack=!1,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e}(TK),l8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=s8,i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i}return C(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i.transformerConstructor=s8,i}(CK),u8=function(){rq(),oq(),lq(),FK(),IK(),WJ(),ij.registerChart(l8.type,l8)},c8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["valueField","cell"])},e}(TK),h8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=c8,i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i}return C(i,e),i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i.transformerConstructor=c8,i}(CK),d8=function(){oq(),a5(),ij.registerChart(h8.type,h8)},p8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),f8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=p8,i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i}return C(i,e),i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i.transformerConstructor=p8,i}(CK),v8=function(){oq(),b5(),ij.registerChart(f8.type,f8)};function g8(t){var e,i,n=M({},t);return ct(t.style)||(n.textStyle=vV(t.style)),ct(t.textStyle)||ej(n.textStyle,vV(t.textStyle)),(null===(e=t.shape)||void 0===e?void 0:e.style)&&vV(n.shape.style),(null===(i=t.background)||void 0===i?void 0:i.style)&&vV(n.background.style),n}var y8=function(t,e){var i=[],n={},r=e.series,a=e.seriesField;return r().forEach((function(t){var e=a(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach((function(t){n[t.key]||(n[t.key]=!0,i.push(t))}))})),i},m8=function(t,e){var i,n,r,a=e.series,o=e.selected,s=e.field,l=e.data,u=e.customFilter,c=o(),h=l();if(0===c.length&&h.length)return[];if(c.length===h.length)return t;var d={};c.forEach((function(t){d[t]=!0}));var p=null!==(i=s())&&void 0!==i?i:Pj;return u?u(t,c,p):(Z(t)&&(null===(n=t[0])||void 0===n?void 0:n.nodes)?(t[0].nodes=t[0].nodes.filter((function(t){return!0===d[t.key]})),(null===(r=t[0])||void 0===r?void 0:r.links)&&(t[0].links=t[0].links.filter((function(t){return!0===d[t.source]&&!0===d[t.target]})))):W(p)&&(t=t.filter((function(t){return!0===d[a.getSeriesFieldValue(t,p)]}))),t)},_8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutType="normal",i.layoutZIndex=t.LayoutZIndex.Legend,i.layoutLevel=t.LayoutLevel.Legend,i.specKey="legends",i._orient="left",i._visible=!0,i._position="middle",i._preSelectedData=[],i._selectedData=[],i.effect={onSelectedDataChange:function(){cU(i._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:i._seriesUserId,specIndex:i._seriesIndex}),cU(i._regions,(function(t){t.reFilterViewData()}),{userId:i._seriesUserId,specIndex:i._seriesIndex})}},i}return C(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),i.prototype.getLegendData=function(){return this._legendData.getLatestData()},i.prototype.getSelectedData=function(){return this._selectedData},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._orient=FU(this._spec.orient)?this._spec.orient:"left",this._position=null!==(t=this._spec.position)&&void 0!==t?t:"middle",this._visible=!1!==this._spec.visible;var i=this._spec,n=i.regionId,r=i.regionIndex,a=i.seriesId,o=i.seriesIndex;W(a)&&(this._seriesUserId=Dt(a)),W(n)&&(this._regionUserId=Dt(n)),W(o)&&(this._seriesIndex=Dt(o)),W(r)&&(this._regionUserIndex=Dt(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)},i.prototype.created=function(){e.prototype.created.call(this),this.initData()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,(null==t?void 0:t.orient)!==(null==i?void 0:i.orient)?(n.reMake=!0,n):(St(i,t)||(n.reCompile=!0),n)},i.prototype._bindLegendDataChange=function(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData(),this._forceLayout()},i.prototype.initData=function(){var e=this,i=this._initLegendData();i.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new IW(this._option,i),this._initSelectedData(),cU(this._regions,(function(i){i.event.on(t.ChartEvent.rawDataUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},(function(){e._legendData.getDataView().reRunAllTransform({skipEqual:!0})}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.setSelectedData=function(e){var i,n,r,a=this,o=this._selectedData;j(e)||JSON.stringify(o)===JSON.stringify(e)||(cU(this._regions,(function(t){t.legendSelectedFilter&&(e=t.legendSelectedFilter(a,e))}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=P([],B(e),!1),null===(n=(i=this.effect).onSelectedDataChange)||void 0===n||n.call(i),this.event.emit(t.ChartEvent.legendSelectedDataChange,{model:this}),null===(r=this._legendComponent)||void 0===r||r.setSelected(this._selectedData))},i.prototype.afterSetLayoutStartPoint=function(t){if(e.prototype.afterSetLayoutStartPoint.call(this,t),this._legendComponent){var i=t.x,n=t.y;it(i*n)&&this._legendComponent.setAttributes({x:i,y:n})}},i.prototype.getBoundsInRect=function(t,e){var i=this;if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};var n={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)St(r,this._cacheAttrs)||this._legendComponent.setAttributes(ej({},r,{defaultSelected:this._selectedData}));else{var a=new(this._getLegendConstructor())(ej({},r,{defaultSelected:this._selectedData}));a.name="legend",this._legendComponent=a,this.getContainer().add(a),this._option.disableTriggerEvent||this._initEvent(),a.on("*",(function(t,e){return i._delegateEvent(i._legendComponent,t,e)}))}this._cacheAttrs=r;var o=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,s=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){var l="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",u=this._position,c=e.width,h=e.height,d=0,p=0;"horizontal"===l?"middle"===u?d=(c-o)/2:"end"===u&&(d=c-o):"middle"===u?p=(h-s)/2:"end"===u&&(p=h-s),this._legendComponent.setAttributes({dx:d,dy:p})}return n.x2=n.x1+o,n.y2=n.y1+s,n},i.prototype.onDataUpdate=function(){var e,i;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){var n=this._getLegendAttributes(this.getLayoutRect());St(n,this._cacheAttrs)||this._legendComponent.setAttributes(ej({},n,{defaultSelected:this._selectedData}))}null===(i=(e=this.effect).onSelectedDataChange)||void 0===i||i.call(e),this.event.emit(t.ChartEvent.legendSelectedDataChange,{model:this})}},i.prototype._getNeedClearVRenderComponents=function(){return[this._legendComponent]},i.prototype.clear=function(){e.prototype.clear.call(this),this._cacheAttrs=null,this._preSelectedData=null},i.specKey="legends",i}(CX),b8={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1},x8=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=L.discreteLegend,t.name=L.discreteLegend,t}return C(i,e),i.getSpecInfo=function(t){return wG(t,this.specKey,this.type,(function(t){return!t.type||"discrete"===t.type}))},i.prototype.init=function(i){var n=this;e.prototype.init.call(this,i),cU(this._regions,(function(e){e.addViewDataFilter({type:"discreteLegendFilter",options:{series:e,selected:function(){return n._selectedData},field:function(){return n._getSeriesLegendField(e)},data:function(){return n.getLegendDefaultData()},customFilter:n._spec.customFilter},level:t.TransformLevel.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._initLegendData=function(){var t=this;EV(this._option.dataSet,"discreteLegendFilter",m8),EV(this._option.dataSet,"discreteLegendDataMake",y8);var e=new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"discreteLegendDataMake",options:{series:function(){var e=[];return cU(t._regions,(function(t){e.push(t)}),{specIndex:t._spec.seriesIndex,userId:t._spec.seriesId}),e},seriesField:function(e){return t._getSeriesLegendField(e)}}}),e},i.prototype._getSeriesLegendField=function(t){var e,i,n,r=t.getSeriesField(),a=null!==(e=this._spec.scaleName)&&void 0!==e?e:this._spec.scale;if(j(a))return r;if(!t.getRawData())return r;var o=this._option.globalScale.getScaleSpec(a);if(!o)return r;if(this._spec.field)return this._spec.field;if(!JA(o.domain))return r;var s=o.domain.find((function(e){return e.dataId===t.getRawData().name}));return s&&null!==(n=null===(i=s.fields)||void 0===i?void 0:i[0])&&void 0!==n?n:r},i.prototype._initSelectedData=function(){var t=this,e=this.getLegendDefaultData();if(this._unselectedData){var i=[],n=[];e.forEach((function(e){t._unselectedData.includes(e)?n.push(e):i.push(e)})),this._selectedData=i,this._unselectedData=n}else this._spec.defaultSelected?this._selectedData=P([],B(this._spec.defaultSelected),!1):this._selectedData=e},i.prototype.getLegendDefaultData=function(t){return U(this._spec.data)?this._getLegendItems().map((function(t){return t.label})):this._legendData.getLatestData().map(t?function(t){return t.originalKey}:function(t){return t.key})},i.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&j(t.title.text)&&j(null===(i=t.title.style)||void 0===i?void 0:i.text)){var a=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!a)return;t.title.text=tV(a.getRawData(),a.getSeriesField())}},i.prototype._getLegendAttributes=function(t){var e="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=M(M({layout:e,items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){t.title,t.item,t.pager,t.background,t.type,t.id,t.visible,t.orient,t.position,t.data,t.filter,t.regionId,t.regionIndex,t.seriesIndex,t.seriesId,t.padding;var i=w(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]),n=t.title,r=void 0===n?{}:n,a=t.item,o=void 0===a?{}:a,s=t.pager,l=void 0===s?{}:s,u=t.background,c=void 0===u?{}:u;r=ft(r),o=ft(o),l=ft(l),c=ft(c);var h=i;return r.visible?h.title=g8(r):h.title={visible:!1},ct(o.focusIconStyle)||vV(o.focusIconStyle),o.shape&&(o.shape=dV(o.shape)),o.label&&(o.label=dV(o.label)),o.value&&(o.value=dV(o.value)),o.background&&(o.background=dV(o.background)),OU(o.maxWidth)&&(o.maxWidth=Number(o.maxWidth.substring(0,o.maxWidth.length-1))*e.width/100),OU(o.width)&&(o.width=Number(o.width.substring(0,o.width.length-1))*e.width/100),OU(o.height)&&(o.height=Number(o.height.substring(0,o.height.length-1))*e.width/100),h.item=o,"scrollbar"===l.type?(ct(l.railStyle)||vV(l.railStyle),ct(l.sliderStyle)||vV(l.sliderStyle)):(ct(l.textStyle)||vV(l.textStyle),l.handler&&dV(l.handler)),h.pager=l,c.visible&&!ct(c.style)&&(ej(h,c.style),W(c.padding)&&(h.padding=c.padding)),h}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(i),this._addLegendItemFormatMethods(i),i},i.prototype._getLegendConstructor=function(){return bN},i.prototype.setSelectedData=function(t){t&&(this._unselectedData=this.getLegendDefaultData().filter((function(e){return!t.includes(e)}))),e.prototype.setSelectedData.call(this,t)},i.prototype._initEvent=function(){var e=this;if(this._legendComponent){var i=!1!==this._spec.filter;this._legendComponent.addEventListener(dN.legendItemClick,(function(n){var r=ht(n,"detail.currentSelected");i&&e.setSelectedData(r),e.event.emit(t.ChartEvent.legendItemClick,{model:e,value:r,event:n})})),this._legendComponent.addEventListener(dN.legendItemHover,(function(i){var n=ht(i,"detail");e.event.emit(t.ChartEvent.legendItemHover,{model:e,value:n,event:i})})),this._legendComponent.addEventListener(dN.legendItemUnHover,(function(i){var n=ht(i,"detail");e.event.emit(t.ChartEvent.legendItemUnHover,{model:e,value:n,event:i})}))}},i.prototype._getLegendItems=function(){var t=(this._legendData.getLatestData()||[]).map((function(t){var e,i,n=t.style("fillOpacity"),r=t.style("strokeOpacity"),a=t.style("opacity"),o=t.style("texture");return{label:t.key,shape:{symbolType:null!==(i=null!==(e=t.style("symbolType"))&&void 0!==e?e:t.shapeType)&&void 0!==i?i:"circle",fillOpacity:it(n)?n:1,strokeOpacity:it(r)?r:1,opacity:it(a)?a:1,texturePadding:o?1:null,textureSize:o?4:null,texture:o,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}}));return U(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t},i.prototype._addLegendItemFormatMethods=function(t){var e,i,n,r,a=null!==(i=null===(e=this._spec.item)||void 0===e?void 0:e.label)&&void 0!==i?i:{},o=a.formatMethod,s=a.formatter,l=null!==(r=null===(n=this._spec.item)||void 0===n?void 0:n.value)&&void 0!==r?r:{},u=l.formatMethod,c=l.formatter,h=MG(o,s).formatFunc;s&&!o&&h&&(t.item.label.formatMethod=function(t,e){return h(t,e,s)});var d=MG(u,c).formatFunc;c&&!u&&d&&(t.item.value.formatMethod=function(t,e){return d(c,t,e,s)})},i.specKey="legends",i.builtInTheme={discreteLegend:b8},i.type=L.discreteLegend,i}(_8),k8=function(){ij.registerComponent(x8.type,x8)},S8=function(t,e){var i=e.series,n=e.field,r=e.scale,a=n();if(n&&a){var o=1/0,s=-1/0;return i().forEach((function(t){var e=t.getRawDataStatisticsByField(a,!0),i=null==e?void 0:e.min,n=null==e?void 0:e.max;it(i)&&(o=Math.min(i,o)),it(n)&&(s=Math.max(n,s))})),[o,s]}if(r){var l=r();return l?l.domain():[]}return[]},A8=function(t,e){var i=e.selected,n=e.field,r=e.data,a=e.isHierarchyData,o=e.customFilter,s=i(),l=n(),u=a||function(t){return t&&t.some((function(t){return t&&(void 0===i&&(i="children"),!!G(e=t)&&!!e.hasOwnProperty(i)&&Array.isArray(e[i]));var e,i}))};if(s===r())return t;if(l&&!ct(s)){var c=B(s,2),h=c[0],d=c[1];return o?o(t,s,l):u(t)?hV(t,+h,+d,l):t.filter((function(t){return t[l]>=h&&t[l]<=d}))}return t};var C8={color:AN,size:MN},M8={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},w8=function(t){var e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=8):(e.width=8,e.height=200),M(M({},M8),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},T8={horizontal:w8(!0),vertical:w8(!1)},D8=function(t){var e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=4):(e.height=200,e.width=4),M(M({},M8),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},E8={horizontal:D8(!0),vertical:D8(!1)},B8=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],P8=[2,10],R8=function(e){function i(t,i){var n=e.call(this,t,i)||this;n.type=L.colorLegend,n.name=L.colorLegend;var r="color"===n._spec.type?L.colorLegend:L.sizeLegend;return n.type=r,n.name=r,n}return C(i,e),i.getSpecInfo=function(t){var e=wG(t,this.specKey,this.type,(function(t){return function(t){return"color"===t||"size"===t}(t.type)}));return e&&e.forEach((function(t){t.type="color"===t.spec.type?L.colorLegend:L.sizeLegend})),e},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._field=this._spec.field,this._legendType=this._spec.type},i.prototype.init=function(i){var n=this;e.prototype.init.call(this,i),cU(this._regions,(function(e){e.addViewDataFilter({type:"continuousLegendFilter",options:{selected:function(){return n._selectedData},field:function(){return n._field},data:function(){return n._legendData.getLatestData()},isHierarchyData:e.isHierarchyData,customFilter:n._spec.customFilter},level:t.TransformLevel.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._getScaleInGlobal=function(){var t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)},i.prototype._initLegendData=function(){var t=this;EV(this._option.dataSet,"continuousLegendFilter",A8),EV(this._option.dataSet,"continuousLegendDataMake",S8);var e=new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"continuousLegendDataMake",options:{series:function(){return hU(t._regions,{userId:t._seriesUserId,specIndex:t._seriesIndex})},field:function(){return t._field},scale:this._getScaleInGlobal.bind(this)}}),e},i.prototype._initSelectedData=function(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()},i.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&j(t.title.text)&&j(null===(i=t.title.style)||void 0===i?void 0:i.text)){var a=this._field;if(a){var o=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!o)return;return void(t.title.text=tV(o.getRawData(),a))}var s=this._spec.scale;s||(s=this._legendType);var l=this._option.globalScale.getScaleSpec(s);if(!JA(null==l?void 0:l.domain))return;var u=l.domain[0];if(0===u.fields.length)return;t.title.text=tV(this._option.dataSet.getDataView(u.dataId),u.fields[0])}else;},i.prototype._getLegendAttributes=function(t){var e,i,n,r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",a="horizontal"===r?"bottom":this.layoutOrient,o=[],s=this._getScaleInGlobal();s&&"linear"===s.type&&(o=s.range()),ct(o)&&(o="color"===this._legendType?B8:P8);var l=null!==(i=this._legendData.getLatestData()[0])&&void 0!==i?i:0,u=null!==(n=this._legendData.getLatestData()[1])&&void 0!==n?n:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(l=Math.min(0,this._legendData.getLatestData()[0]),u=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));var c=M(((e={layout:r,align:a,zIndex:this.layoutZIndex,min:l,max:u,value:this._spec.defaultSelected})["color"===this._legendType?"colors":"sizeRange"]=o,e),function(t){var e=ej({},t),i=e.title,n=void 0===i?{}:i,r=e.handler,a=void 0===r?{}:r,o=e.rail,s=void 0===o?{}:o,l=e.track,u=void 0===l?{}:l,c=e.startText,h=e.endText,d=e.handlerText,p=e.sizeBackground,f=e.background,v=void 0===f?{}:f;e.type,e.id,e.visible,e.orient,e.position,e.data,e.defaultSelected,e.field,e.filter,e.regionId,e.regionIndex,e.seriesIndex,e.seriesId,e.padding;var g=w(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible?g.title=g8(n):g.title={visible:!1},g.showHandler=!1!==a.visible,ct(a.style)||(g.handlerStyle=vV(a.style)),W(s.width)&&(g.railWidth=s.width),W(s.height)&&(g.railHeight=s.height),ct(s.style)||(g.railStyle=vV(s.style)),ct(u.style)||(g.trackStyle=vV(u.style)),g.startText=dV(c),g.endText=dV(h),g.handlerText=dV(d),ct(p)||(g.sizeBackground=vV(p)),v.visible&&!ct(v.style)&&(ej(g,v.style),W(v.padding)&&(g.padding=v.padding)),g}(this._spec));return this._addDefaultTitleText(c),c},i.prototype._getLegendConstructor=function(){return C8[this._legendType]},i.prototype._initEvent=function(){var e=this;if(this._legendComponent){var i=!1!==this._spec.filter;this._legendComponent.addEventListener("change",ve((function(n){var r=ht(n,"detail.value");i&&e.setSelectedData(r),e.event.emit(t.ChartEvent.legendFilter,{model:e,value:r,event:n})}),30))}},i.specKey="legends",i.builtInTheme={colorLegend:T8,sizeLegend:E8},i.type=L.continuousLegend,i}(_8),L8=function(){ij.registerComponent(R8.type,R8)},I8=function(t,e){return W(e)?t.map((function(t){return e[t]})):void 0},F8=function(t,e){return function(i){return t.every((function(t,n){return i[t]===(null==e?void 0:e[n])}))}},O8=function(t){return!j(t)&&(Z(t)?t.length>0&&t.every(W):Object.keys(t).length>0)};function z8(t,e,i){var n,r,a,o,s,l,u=M({regionIndex:0},e),c=i.getOption(),h=c.getRegionsInUserIdOrIndex(W(u.regionId)?[u.regionId]:void 0,W(u.regionIndex)?[u.regionIndex]:void 0)[0];if(!h)return"none";var d=U8(t,h),p=null!==(n=u.activeType)&&void 0!==n?n:d.length>1?"dimension":"mark",f=h.getLayoutStartPoint(),v=h.getLayoutRect(),g=c.globalInstance.getContainer(),y=M({x:0,y:0},g?ha(g):{}),m=function(t){var e,i=t.data,n=i.dimensionFields,r=i.dimensionData,a=i.measureFields,o=i.measureData,s=i.groupField,l=i.groupData,u=null===(e=t.series.getViewData())||void 0===e?void 0:e.latestData.find((function(t){return F8(n,r)(t)&&F8(a,o)(t)&&(j(s)||F8([s],[l])(t))}));return u},_=function(t){var e,i,n=function(t){return{x:Math.min(Math.max(t.x,0),v.width),y:Math.min(Math.max(t.y,0),v.height)}}(t),r=null!==(e=u.x)&&void 0!==e?e:f.x+n.x,a=null!==(i=u.y)&&void 0!==i?i:f.y+n.y;return{canvasX:r,canvasY:a,clientX:y.x+r,clientY:y.y+a}};if("dimension"===p){var b=d[0];if(!b)return"none";var x=new Map;d.forEach((function(t){var e;x.has(t.series)||x.set(t.series,[]),null===(e=x.get(t.series))||void 0===e||e.push(t)}));var k=[{value:t[b.data.dimensionFields[0]],data:P([],B(x.keys()),!1).map((function(t){var e,i;return{series:t,datum:null!==(i=null===(e=x.get(t))||void 0===e?void 0:e.map((function(t){return m(t)})))&&void 0!==i?i:[]}}))}];W(b.dimType)&&(k[0].position=b.pos[b.dimType],k[0].dimType=b.dimType);var S={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:k,chart:null!==(r=c.globalInstance.getChart())&&void 0!==r?r:void 0,datum:void 0,model:void 0,source:SV.chart,event:_({x:d.reduce((function(t,e){return t+e.pos.x}),0)/d.length,y:d.reduce((function(t,e){return t+e.pos.y}),0)/d.length}),item:void 0};null===(s=null===(o=null===(a=i.processor)||void 0===a?void 0:a.dimension)||void 0===o?void 0:o.showTooltip)||void 0===s||s.call(o,k,S,!1);var A=c.globalInstance;return xG.globalConfig.uniqueTooltip&&xG.hideTooltip(A.id),p}if("mark"===p){var C=d[0];if(!C)return"none";var w=M(M({},m(C)),t),T=[{datum:[w],series:C.series}];S={changePositionOnly:!1,tooltip:null,dimensionInfo:k=[{value:w[C.data.dimensionFields[0]],data:T}],chart:null!==(l=c.globalInstance.getChart())&&void 0!==l?l:void 0,datum:w,model:C.series,source:SV.chart,event:_(C.pos),item:void 0};i.processor.mark.showTooltip({datum:w,mark:null,series:C.series},S,!1);A=c.globalInstance;return xG.globalConfig.uniqueTooltip&&xG.hideTooltip(A.id),p}return"none"}var H8,N8,U8=function(e,i){var n=i.getSeries(),r=[];return n.forEach((function(i){var n,a,o,s,l,u,c,h=i.getDimensionField(),d=i.getMeasureField(),p=i.getSeriesField(),f=W(p)?e[p]:void 0,v=W(p)&&null!==(s=null===(o=null===(a=null===(n=i.getViewDataStatistics)||void 0===n?void 0:n.call(i))||void 0===a?void 0:a.latestData[p])||void 0===o?void 0:o.values)&&void 0!==s?s:[],g=I8(h,e),y=I8(d,e),m=O8(y),_=!m&&W(p)&&j(f)&&v.length>0,b=function(){var e,n=null===(e=i.getViewData())||void 0===e?void 0:e.latestData.find(F8(h,g));if(m||(y=I8(d,n),O8(y))){var a=i.type===t.SeriesTypeEnum.pie?i.dataToCentralPosition(n):i.dataToPosition(n);j(a)||isNaN(a.x)||isNaN(a.y)||r.push({pos:a,data:{dimensionFields:h,dimensionData:g,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:f},series:i})}};if("cartesian"===i.coordinate){var x=i,k=iO(null===(u=null===(l=i.getYAxisHelper())||void 0===l?void 0:l.getScale(0))||void 0===u?void 0:u.type)?"y":"x",S=h.map((function(t,e){return[t,e]})).filter((function(t){var e=B(t,2)[1];return j(null==g?void 0:g[e])})),A=[null!=g?g:[]];S.length>0&&S.forEach((function(t){var e,n,r,a,o=B(t,2),s=o[0],l=o[1],u=null!==(a=null===(r=null===(n=null===(e=i.getViewDataStatistics)||void 0===e?void 0:e.call(i))||void 0===n?void 0:n.latestData[s])||void 0===r?void 0:r.values)&&void 0!==a?a:[],c=[];A.forEach((function(t){u.forEach((function(e){var i,n=null!==(i=null==t?void 0:t.slice())&&void 0!==i?i:[];n[l]=e,c.push(n)}))})),A=c})),A.forEach((function(t){var e,n;if(_){var a=null===(e=x.getViewData())||void 0===e?void 0:e.latestData.filter(F8(h,t));v.forEach((function(e){var n=a.find((function(t){return t[p]===e}));if(y=I8(d,n),O8(y)){var o=x.dataToPosition(n);j(o)||isNaN(o.x)||isNaN(o.y)||r.push({pos:o,data:{dimensionFields:h,dimensionData:t,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:e},series:i,dimType:k})}}))}else{var o=null===(n=x.getViewData())||void 0===n?void 0:n.latestData.find(F8(h,t));if(!m&&(y=I8(d,o),!O8(y)))return;var s=x.dataToPosition(o);if(j(s)||isNaN(s.x)||isNaN(s.y))return;r.push({pos:s,data:{dimensionFields:h,dimensionData:t,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:f},dimType:k,series:i})}}))}else if("polar"===i.coordinate)if(i.type===t.SeriesTypeEnum.pie)b();else{var C=i;if(_){var M=(null===(c=C.getViewData())||void 0===c?void 0:c.latestData.filter(F8(h,g))).find((function(t){return t[p]===f}));v.forEach((function(t){if(y=I8(d,M),O8(y)){var e=C.dataToPosition(M);j(e)||isNaN(e.x)||isNaN(e.y)||r.push({pos:e,data:{dimensionFields:h,dimensionData:g,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:t},series:i})}}))}else b()}else"geo"===i.coordinate&&b()})),r},j8=function(t){return W(t)&&!Z(t)},V8=function(t){return W(t)&&Z(t)},W8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._shouldMergeThemeToSpec=function(){return!1},e.prototype._initTheme=function(e,i){var n,r,a,o=t.prototype._initTheme.call(this,e,i),s=o.spec,l=o.theme;return s.style=ej({},this._theme,s.style),s.offset=ej({},l.offset,e.offset),s.transitionDuration=null!==(n=e.transitionDuration)&&void 0!==n?n:l.transitionDuration,s.trigger=null!==(r=e.trigger)&&void 0!==r?r:l.trigger,s.triggerOff=null!==(a=e.triggerOff)&&void 0!==a?a:l.triggerOff,{spec:s,theme:l}},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,a,o,s,l,u,c;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n),e.visible=null===(r=e.visible)||void 0===r||r,e.activeType=function(t){var e,i,n;if(!1===(null==t?void 0:t.visible))return[];var r={mark:!1!==(null===(e=null==t?void 0:t.mark)||void 0===e?void 0:e.visible),dimension:!1!==(null===(i=null==t?void 0:t.dimension)||void 0===i?void 0:i.visible),group:!1!==(null===(n=null==t?void 0:t.group)||void 0===n?void 0:n.visible)};return W(null==t?void 0:t.activeType)&&Object.keys(r).forEach((function(e){var i;r[e]=null===(i=null==t?void 0:t.activeType)||void 0===i?void 0:i.includes(e)})),Object.keys(r).filter((function(t){return r[t]}))}(e),e.renderMode=null!==(a=e.renderMode)&&void 0!==a?a:XA(this._option.mode)||!GA(this._option.mode)?"canvas":"html",e.trigger=null!==(o=e.trigger)&&void 0!==o?o:"hover",e.className=null!==(s=e.className)&&void 0!==s?s:"vchart-tooltip-element",e.enterable=null!==(l=e.enterable)&&void 0!==l&&l,e.transitionDuration=null!==(u=e.transitionDuration)&&void 0!==u?u:150,e.confine=null!==(c=e.confine)&&void 0!==c?c:"canvas"===e.renderMode,W(e.parentElement)?q(e.parentElement)&&(e.parentElement=tS.getElementById(e.parentElement)):GA(this._option.mode)&&(e.parentElement=null==WA?void 0:WA.body)},e}(AX),G8={offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}},Y8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutZIndex=1,i.type=L.tooltip,i.name=L.tooltip,i.transformerConstructor=W8,i.specKey="tooltip",i.layoutType="none",i._isReleased=!1,i._alwaysShow=!1,i._eventList=[],i._isTooltipShown=!1,i._clickLock=!1,i._mountEvent=function(t,e,n){i.event.on(t,e,n),i._eventList.push({eventType:t,handler:n})},i._handleClickToLock=function(t){var e,n;if(i._clickLock)i._handleChartMouseOut(t),i._clickLock=!1;else{if(!i._isTooltipShown&&!(null===(n=null===(e=i.tooltipHandler)||void 0===e?void 0:e.isTooltipShown)||void 0===n?void 0:n.call(e)))return;i._clickLock=!0}},i._getMouseOutHandler=function(t){return function(e){var n,r,a,o,s;if(!i._isReleased&&!i._alwaysShow&&!i._clickLock&&(i._isTooltipShown||(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))){var l=GA(null===(a=i._option)||void 0===a?void 0:a.mode),u=e.event,c=u.clientX,h=u.clientY;l&&t&&i._isPointerInChart({x:c,y:h})||(i._enterable?i._outTimer=setTimeout((function(){i._handleChartMouseOut(e)}),null!==(s=null===(o=i._spec)||void 0===o?void 0:o.showDelay)&&void 0!==s?s:50):i._handleChartMouseOut(e))}}},i._handleChartMouseOut=function(t){i._alwaysShow||i._isReleased||i._isEnterTooltip||"none"!==i._spec.triggerOff&&(i._hideTooltipByHandler(M(M({},t),{tooltip:i})),i._handleMouseMove&&i._handleMouseMove.cancel&&i._handleMouseMove.cancel(),i._cacheEnterableRect=null,i._cacheInfo=void 0,i._cacheParams=void 0,i._cacheActiveType=void 0)},i._getMouseMoveHandler=function(t){return function(e){var n,r,a,o;i._isReleased||i._isEnterTooltip||(i._outTimer&&(clearTimeout(i._outTimer),i._outTimer=null),i.tooltipHandler||i._initHandler(),i.processor||i._initProcessor(),i._alwaysShow||(i._clickLock?t&&(i._handleChartMouseOut(e),i._clickLock=!1):!t&&i._enterable&&(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n))?(i._showTimer&&clearTimeout(i._showTimer),i._showTimer=setTimeout((function(){i._handleChartMouseMove(e,t)}),null!==(o=null===(a=i._spec)||void 0===a?void 0:a.showDelay)&&void 0!==o?o:50)):i._handleChartMouseMove(e,t)))}},i._handleChartMouseMove=function(t,e){if(!i._isReleased){for(var n=i._getMouseEventData(t),r=n.tooltipInfo.dimension,a=n.ignore.mark,o={mark:!1,dimension:!1,group:!1},s=["group","mark","dimension"],l=0,u=s.length;l<u;l++){var c=s[l];if(!!i.processor[c]&&i._showTooltipByMouseEvent(c,n,t,e)){o[c]=!0;break}}Object.values(o).every((function(t){return!t}))&&!function(t){return j(t.mark)&&j(t.model)&&j(t.datum)}(t)&&(a&&j8(i._cacheInfo)?o.mark=i._showTooltipByMouseEvent("mark",n,t,e,!0):W(r)&&(o.dimension=i._showTooltipByMouseEvent("dimension",n,t,e))),o.mark||o.group||o.dimension&&!j(r)?i._initEventOfTooltipContent():i._handleChartMouseOut(t)}},i._showTooltipByMouseEvent=function(t,e,n,r,a){var o,s,l=i.processor[t];if(!l.shouldHandleTooltip(n,e.tooltipInfo[t]))return!1;if(i._hideTimer&&clearTimeout(i._hideTimer),a)s=!l.showTooltip(i._cacheInfo,n,!0);else{var u=e.tooltipInfo[t],c=i._isSameAsCache(u,n,t);(s=!l.showTooltip(u,n,c))&&(i._cacheInfo=u,i._cacheParams=n,i._cacheActiveType=t)}s&&(i._isTooltipShown=!0,r&&i._spec.lockAfterClick&&!i._clickLock?i._clickLock=!0:Number.isFinite(i._spec.hideTimer)&&(i._hideTimer=setTimeout((function(){i._handleChartMouseOut()}),i._spec.hideTimer)));var h=null===(o=i._option)||void 0===o?void 0:o.globalInstance;return s&&xG.globalConfig.uniqueTooltip&&h&&xG.hideTooltip(h.id),s},i._getMouseEventData=function(t){var e={tooltipInfo:{},ignore:{}};return Object.keys(i.processor).forEach((function(n){var r=i.processor[n].getMouseEventData(t),a=r.tooltipInfo,o=r.ignore;e.tooltipInfo[n]=a,e.ignore[n]=o})),e},i._hideTooltipByHandler=function(e){var n,r,a;if(!i._isTooltipShown&&!(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))return 0;i.event.emit(t.ChartEvent.tooltipHide,M(M({},e),{source:SV.chart,tooltip:i})),Object.values(i.processor).forEach((function(t){t.clearCache()}));var o=null!==(a=i._spec.handler)&&void 0!==a?a:i.tooltipHandler;if(o.hideTooltip){var s=o.hideTooltip.call(o,e);return s||(i._isTooltipShown=!1),s}return 1},i.hideTooltip=function(){if(i._isReleased)return!1;var t={changePositionOnly:!1,tooltip:i,item:void 0,datum:void 0,source:SV.chart};return i._alwaysShow=!1,!i._hideTooltipByHandler(t)},i}return C(i,e),i.prototype.isTooltipShown=function(){return this._isTooltipShown},i.prototype._registerEvent=function(){},i.prototype._releaseEvent=function(){},i.prototype.onLayoutEnd=function(){},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getAllRegions(),this._initEvent()},i.prototype.release=function(){var t,i,n=this;e.prototype.release.call(this),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach((function(t){var e=t.eventType,i=t.handler;n.event.off(e,i)})),this._eventList=[],null===(i=null===(t=this.tooltipHandler)||void 0===t?void 0:t.release)||void 0===i||i.call(t),this._isTooltipShown=!1},i.prototype.beforeRelease=function(){this.event.emit(t.ChartEvent.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(t.ChartEvent.tooltipRelease,{tooltip:this,chart:this.getChart()})},i.prototype._initHandler=function(){var t,e,i,n=null!==(t=this._spec.renderMode)&&void 0!==t?t:"html",r=this._option.globalInstance.getTooltipHandlerByUser();if(r)this.tooltipHandler=r,this._enterable=!1;else{var a="canvas"===n?tq.canvas:tq.dom,o=ij.getComponentPluginInType(a);o||UA("Can not find tooltip handler: "+a);var s=new o;s.name="".concat(this._spec.className,"-").concat(null!==(e=this._option.globalInstance.id)&&void 0!==e?e:0,"-").concat(this.getSpecIndex()),null===(i=this.pluginService)||void 0===i||i.load([s]),this.tooltipHandler=s,this._spec.enterable&&"html"===n&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}},i.prototype._initEventOfTooltipContent=function(){var t,e,i=this;if(this._needInitEventOfTooltip){var n=null===(e=(t=this.tooltipHandler).getRootDom)||void 0===e?void 0:e.call(t);n&&(n.addEventListener("pointerenter",(function(){var t;if(i._enterable){i._isEnterTooltip=!0;var e=null===(t=n.getBoundingClientRect)||void 0===t?void 0:t.call(n);e&&(i._cacheEnterableRect={width:e.width,height:e.height}),i._outTimer&&(clearTimeout(i._outTimer),i._outTimer=null),i._showTimer&&(clearTimeout(i._showTimer),i._showTimer=null)}})),n.addEventListener("pointerleave",(function(){var t,e,r;if(i._enterable&&(i._isEnterTooltip=!1,"none"!==i._spec.triggerOff&&i._cacheEnterableRect)){var a=null===(t=n.getBoundingClientRect)||void 0===t?void 0:t.call(n);a&&Object.keys(i._cacheEnterableRect).every((function(t){return i._cacheEnterableRect[t]===a[t]}))&&(i._cacheEnterableRect=null,i._outTimer=setTimeout(i.hideTooltip,null!==(r=null===(e=i._spec)||void 0===e?void 0:e.showDelay)&&void 0!==r?r:50))}})),this._needInitEventOfTooltip=!1)}},i.prototype._initProcessor=function(){var t=this,e=this._spec.activeType;this.processor={},e.forEach((function(e){var i=ij.createTooltipProcessor(e,t);i&&(t.processor[e]=i)}))},i.prototype._initEvent=function(){var t,e=this;if(!this._option.disableTriggerEvent){var i=Dt(null!==(t=this._spec.trigger)&&void 0!==t?t:"hover"),n=Dt(this._spec.triggerOff),r=this._option.mode;i.forEach((function(t){var i;"hover"===t?(e._handleMouseMove=e._throttle(e._getMouseMoveHandler(!1)),e._mountEvent("pointermove",{source:"chart"},e._handleMouseMove),(YA(r)||XA(r))&&(e._mountEvent("pointerdown",{source:"chart"},e._getMouseMoveHandler(!1)),e._mountEvent("pointerup",{source:"window"},e._getMouseOutHandler(!0))),e._mountEvent("pointerleave",{source:"chart"},e._getMouseOutHandler(!1))):"click"===t?(e._mountEvent("pointertap",{source:"chart"},e._getMouseMoveHandler(!0)),e._mountEvent("pointerup",{source:"window"},e._getMouseOutHandler(!0))):G(t)&&e._mountEvent(t.eventType,{source:null!==(i=t.source)&&void 0!==i?i:"chart",consume:t.consume},e._getMouseMoveHandler(!0))})),n.filter((function(t){return G(t)})).forEach((function(t){var i,n;e._mountEvent(t.eventType,{source:null!==(i=t.source)&&void 0!==i?i:"chart",consume:t.consume},e._getMouseOutHandler(null!==(n=t.checkOutside)&&void 0!==n&&n))})),!i.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}},i.prototype._throttle=function(t){return ge(t,$(this._spec.throttleInterval)?this._spec.throttleInterval:"html"===this._spec.renderMode&&this._spec.transitionDuration?50:10)},i.prototype.reInit=function(t){var i,n,r;if(e.prototype.reInit.call(this,t),this.tooltipHandler){var a=null!==(i=this._spec.renderMode)&&void 0!==i?i:"html",o=this._spec.enterable&&"html"===a;o&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=o,null===(r=(n=this.tooltipHandler).reInit)||void 0===r||r.call(n)}else this._initHandler()},i.prototype.showTooltip=function(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null===(i=this.tooltipHandler)||void 0===i?void 0:i.showTooltip))return!1;var n=z8(t,e,this);return"none"!==n&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),n},i.prototype._isSameAsCache=function(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if(j(this._cacheInfo)||j(t))return!1;if(V8(t)){if(j8(this._cacheInfo))return!1;var n=this._cacheInfo,r=n.length===t.length&&t.every((function(t,e){return TY(t,n[e])}));return r}if(V8(this._cacheInfo))return!1;var a=this._cacheInfo;if(!((null==t?void 0:t.datum)===a.datum&&(null==t?void 0:t.mark)===a.mark&&(null==t?void 0:t.series)===a.series))return!1;var o=this._cacheParams;return!j(o)&&!j(e)&&(o.mark===e.mark&&o.model===e.model&&o.datum===e.datum)},i.prototype._isPointerInChart=function(t){var e,i=null===(e=this._option)||void 0===e?void 0:e.globalInstance;if(!i)return!1;if(!i.getChart())return!1;var n=t.x,r=t.y,a=i.getCanvas().getBoundingClientRect(),o=a.x,s=a.y,l=a.width,u=a.height;return n>=o&&n<=o+l&&r>=s&&r<=s+u},i.prototype.getVisible=function(){return!1!==this._spec.visible},i.type=L.tooltip,i.transformerConstructor=W8,i.builtInTheme={tooltip:G8},i.specKey="tooltip",i}(CX),X8=function(){ij.registerComponent(Y8.type,Y8)};t.TooltipResult=void 0,(H8=t.TooltipResult||(t.TooltipResult={}))[H8.success=0]="success",H8[H8.failed=1]="failed",function(t){t[t.ALL=3]="ALL",t[t.HORIZONTAL=2]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(N8||(N8={}));var K8={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]},q8=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.specKey="crosshair",r.layoutType="none",r.gridZIndex=t.LayoutZIndex.CrossHair_Grid,r.labelZIndex=t.LayoutZIndex.CrossHair,r.trigger="hover",r._handleIn=function(t){if(r._option){var e=r.calculateTriggerPoint(t),i=e.x,n=e.y;r.showDefault=!1,r._layoutCrosshair(i,n);var a=r._getNeedClearVRenderComponents();r._hasActive=a.some((function(t){return t&&!1!==t.attribute.visible}))}},r._handleClickInEvent=function(t){if(!r._hasActive||!r._spec.lockAfterClick||r._clickLock)return r._clickLock?(r._clickLock=!1,void r._handleOutEvent()):void(r._onlyLockClick||(r._handleIn(t),$(r.triggerOff)&&(r._timer&&clearTimeout(r._timer),r._timer=setTimeout((function(){r._handleOutEvent()}),r.triggerOff))));r._clickLock=!0},r._handleHoverInEvent=ge((function(t){r._clickLock||r._handleIn(t)}),10),r._handleOutEvent=function(){r.enableRemain||r._clickLock||!r._hasActive||(r.clearOutEvent(),r.hideCrosshair())},r._handleTooltipShow=function(t){var e=t.tooltipData;if(!t.isEmptyTooltip&&e&&e.length)if(G(r._spec.followTooltip)&&!1===r._spec.followTooltip[t.activeType])r._handleTooltipHideOrRelease();else{var i=r.calculateTriggerPoint(t),n=i.x,a=i.y;r.showDefault=!1,r._layoutCrosshair(n,a,e,t.activeType);var o=r._getNeedClearVRenderComponents();r._hasActive=o.some((function(t){return t&&!1!==t.attribute.visible}))}else r._handleTooltipHideOrRelease()},r._handleTooltipHideOrRelease=function(){r.clearOutEvent(),r.hideCrosshair()},r.enable=!0,r.showDefault=!0,r}return C(i,e),Object.defineProperty(i.prototype,"enableRemain",{get:function(){return"none"===this.triggerOff},enumerable:!1,configurable:!0}),i.prototype._setAllAxisValues=function(t,e,i){var n=this,r=!1;if(t.forEach((function(t){iO(t.axis.getScale().type)&&(r?n.enable=!1:r=!0)})),!this.enable)return!1;var a=this._stateByField[i].currentValue;return t.forEach((function(t,i){var r=t.axis;a.set(i,{datum:n._getDatumAtPoint(r,e),axis:r})})),!0},i.prototype.clearAxisValue=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){t._stateByField[e].currentValue.clear()}))},i.prototype.hideCrosshair=function(){this.clearAxisValue(),this.hide()},i.prototype.showCrosshair=function(t){var e=this;t&&t.length&&(this.showDefault=!1,this.clearAxisValue(),t.forEach((function(t){var i=t.axis,n=t.value;e.setAxisValue(n,i)})),this.layoutByValue(!1))},i.prototype._getLimitBounds=function(){var t,e;if(!this._limitBounds){var i=null!==(e=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getViewRect())&&void 0!==e?e:{width:0,height:0},n=i.width,r=i.height;this._limitBounds={x1:0,y1:0,x2:n,y2:r}}return this._limitBounds},i.prototype._showDefaultCrosshairBySpec=function(){var t=this,e=!1;return Object.keys(this._stateByField).forEach((function(i){var n=t._spec[i];if(n&&n.visible&&n.defaultSelect){var r=n.defaultSelect,a=r.axisIndex,o=void 0===a?0:a,s=r.datum,l=t._option.getComponentsByKey("axes").find((function(t){return t.getSpecIndex()===o}));l&&(e=!0,t._stateByField[i].currentValue.clear(),t._stateByField[i].currentValue.set(o,{axis:l,datum:s}))}})),e},i.prototype._updateVisibleCrosshair=function(){var t=this,e=!1;Object.keys(this._stateByField).forEach((function(i){var n=t._spec[i];n&&n.visible&&t._stateByField[i].currentValue.size?e=!0:t._hideByField(i)})),e&&this.layoutByValue(!1)},i.prototype._showDefaultCrosshair=function(){this.showDefault?this._showDefaultCrosshairBySpec()&&this.layoutByValue(!1):this._updateVisibleCrosshair()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._parseCrosshairSpec()},i.prototype.created=function(){e.prototype.created.call(this),this._initEvent()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||St(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype._initEvent=function(){var t=this;if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{var e=this._getTriggerEvent();e&&e.forEach((function(e){t._registerEvent(e.in,!1,e.click),e.out&&t._registerEvent(e.out,!0)}))}},i.prototype._registerEvent=function(t,e,i){var n=this,r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,a=e?{level:AV.chart}:{source:SV.chart};Z(t)?t.forEach((function(t){n.event.on(t,a,r)})):this.event.on(t,a,r)},i.prototype._eventOff=function(t,e,i){var n=this,r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;Z(t)?t.forEach((function(t){n.event.off(t,r)})):this.event.off(t,r)},i.prototype.onBeforeRender=function(){this._limitBounds=null,this._showDefaultCrosshair()},i.prototype.calculateTriggerPoint=function(t){var e=t.event,i=this._option.getCompiler().getStage().getLayer(void 0),n={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},n),{x:n.x-this.getLayoutStartPoint().x,y:n.y-this.getLayoutStartPoint().y}},i.prototype._getTriggerEvent=function(){var e=this,i=this._option.mode,n=function(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:YA(e)||XA(e)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null}(void 0===i?t.RenderModeEnum["desktop-browser"]:i);if(n){var r=Dt(this.trigger||"hover");this._spec.lockAfterClick&&!r.includes("click")?(r.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;var a=[];return r.forEach((function(t){var i;a.push({click:"click"===t,in:n[t],out:(i=t,"click"===i?"none"===e.triggerOff?null:n.clickOut:n.hoverOut)})})),a}return null},i.prototype._registerTooltipEvent=function(){this.event.on(t.ChartEvent.tooltipHide,{source:SV.chart},this._handleTooltipHideOrRelease),this.event.on(t.ChartEvent.tooltipShow,{source:SV.chart},this._handleTooltipShow),this.event.on(t.ChartEvent.tooltipRelease,{source:SV.chart},this._handleTooltipHideOrRelease)},i.prototype._getAxisInfoByField=function(t){var e,i,n=null===(i=(e=this._option).getComponentsByKey)||void 0===i?void 0:i.call(e,"axes");if(!(null==n?void 0:n.length))return null;var r=ht(this._spec,"".concat(t,"Field.bindingAxesIndex"));if(r||(r=[],n.forEach((function(e,i){K8[t].includes(e.getOrient())&&r.push(i)}))),!r.length)return null;var a=new Map,o=1/0,s=1/0,l=-1/0,u=-1/0,c=this.getLayoutStartPoint(),h=c.x,d=c.y;return r.forEach((function(t){o=1/0,s=1/0,l=-1/0,u=-1/0;var e=n.find((function(e){return e.getSpecIndex()===t}));e&&(e.getRegions().forEach((function(t){var e=t.getLayoutStartPoint(),i=e.x,n=e.y;o=Math.min(o,i-h),s=Math.min(s,n-d),l=Math.max(l,i+t.getLayoutRect().width-h),u=Math.max(u,n+t.getLayoutRect().height-d)})),a.set(t,{x1:o,y1:s,x2:l,y2:u,axis:e}))})),a},i.prototype.onLayoutEnd=function(){var t=this._regions[0];this.setLayoutRect(t.getLayoutRect()),this.setLayoutStartPosition(t.getLayoutStartPoint()),e.prototype.onLayoutEnd.call(this)},i.prototype._releaseEvent=function(){var t=this;this.clearOutEvent();var e=this._getTriggerEvent();e&&e.forEach((function(e){t._eventOff(e.in,!1,e.click),e.out&&t._eventOff(e.out,!0)}))},i.prototype._parseFieldInfo=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){var i,n=t._spec[e],r=t._stateByField[e].crosshairComp;if(n&&n.visible){if(t._stateByField[e].attributes=t._parseField(n,e),r){var a=t._stateByField[e].attributes,o=a.style,s="rect"===a.type?"rectStyle":"lineStyle";r.setAttributes(((i={})[s]=o,i))}}else r&&r.parent&&r.parent.removeChild(r)}))},i.prototype._parseCrosshairSpec=function(){this._parseFieldInfo();var t=this._spec,e=t.trigger,i=t.triggerOff,n=t.labelZIndex,r=t.gridZIndex;e&&(this.trigger=e),("none"===i||$(i)&&i>0)&&(this.triggerOff=i),void 0!==n&&(this.labelZIndex=n),void 0!==r&&(this.gridZIndex=r)},i.prototype._parseField=function(t,e){var i,n,r,a={},o=t.line,s=void 0===o?{}:o,l=t.label,u=void 0===l?{}:l,c=t.visible;if(a.visible=c,a.type=s.type||"line",!1===s.visible)a.style={visible:!1};else{var h=s.style||{},d=h,p=d.stroke,f=d.fill,v=d.lineWidth,g=h,y=g.strokeOpacity,m=g.fillOpacity,_=g.opacity,b=w(g,["strokeOpacity","fillOpacity","opacity"]),x="line"===a.type,k=x?y:m;if($(_)&&(k=(null!=k?k:1)*_),a.style=M({opacity:k,pickable:!1,visible:!0},b),x)a.style.stroke=p||f,a.style.lineWidth=ht(s,"width",v||2);else{a.style.fill=f||p,(null===(n=null===(i=null==t?void 0:t.line)||void 0===i?void 0:i.style)||void 0===n?void 0:n.stroke)&&(a.style.stroke=t.line.style.stroke);var S=ht(s,"width");if("string"==typeof S){var A=parseInt(S.substring(0,S.length-1),10)/100;a.style.sizePercent=A}else"number"!=typeof S&&"function"!=typeof S||(a.style.size=S)}}if(u.visible){var C=u.labelBackground||{},T=null!==(r=u.syncAxisLabelAngle)&&void 0!==r&&r,D=u.style||{},E=C.style||{},B=E.fill,P=void 0===B?"rgba(47, 59, 82, 0.9)":B,R=E.stroke,L=E.outerBorder,I=w(E,["fill","stroke","outerBorder"]);a.label={visible:!0,formatMethod:u.formatMethod,formatter:u.formatter,minWidth:C.minWidth,maxWidth:C.maxWidth,padding:C.padding,syncAxisLabelAngle:T,textStyle:M(M({fontSize:14,pickable:!1},D),{fill:D.fill||"#fff",stroke:ht(D,"stroke")}),panel:(N(C.visible)?C.visible:C)?M({visible:!0,pickable:!1,fill:P,stroke:R,outerBorder:M({stroke:P,distance:0,lineWidth:3},L)},I):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else a.label={visible:!1};return a},i.prototype._filterAxisByPoint=function(t,e,i){return t&&t.forEach((function(n){var r,a,o,s=n.axis;if(a=e,o=i,((r=n).x1>a||r.x2<a||r.y1>o||r.y2<o)&&t.delete(s.getSpecIndex()),s.type.startsWith("polarAxis")){var l=s.getCenter(),u=s.getInnerRadius(),c=s.getOuterRadius(),h=Si.distancePP({x:e,y:i},l);(h>c||h<u)&&t.delete(s.getSpecIndex())}})),t},i.prototype._updateCrosshairLabel=function(t,e,i){var n=this.getContainer();t?t.setAttributes(e):(t=new iR(e),null==n||n.add(t),i(t)),function(t,e){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=t.AABBBounds,s=o.x1,l=o.y1,u=o.x2,c=o.y2,h=t.attribute,d=h.dx,p=void 0===d?0:d,f=h.dy,v=void 0===f?0:f,g=0,y=0;s<i&&(g=i-s),l<n&&(y=n-l),u>r&&(g=r-u),c>a&&(y=a-c),g&&t.setAttribute("dx",g+p),y&&t.setAttribute("dy",y+v)}(t,this._getLimitBounds())},i.prototype.clearOutEvent=function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)},i.prototype._hideByField=function(t){var e=this._stateByField[t],i=e.crosshairComp,n=e.labelsComp;i&&i.hideAll(),n&&Object.keys(n).forEach((function(t){n[t]&&n[t].hideAll()}))},i.prototype.hide=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){t._hideByField(e)}))},i.prototype._getNeedClearVRenderComponents=function(){var t=this;return Object.keys(this._stateByField).reduce((function(e,i){var n=t._stateByField[i],r=n.crosshairComp,a=n.labelsComp;return r&&e.push(r),a&&Object.keys(a).forEach((function(t){a[t]&&e.push(a[t])})),e}),[])},i.specKey="crosshair",i}(CX),Z8={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}},J8=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=L.cartesianCrosshair,n.name=L.cartesianCrosshair,n._stateByField={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:new Map,labelsComp:{top:null,bottom:null}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:new Map,labelsComp:{left:null,right:null}}},n}return C(e,t),e.getSpecInfo=function(t){return wG(t,this.specKey,this.type,(function(t){return t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible}))},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("x"),n=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getDatumAtPoint=function(t,e){var i=yY(t.getOrient())?"x":"y",n=e[i]-(t.getLayoutStartPoint()[i]-this.getLayoutStartPoint()[i]);return t.getScale().invert(n)},e.prototype.setAxisValue=function(t,e){yY(e.getOrient())?this._stateByField.xField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.yField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})},e.prototype._layoutCrosshair=function(t,e,i,n){var r,a=t,o=e;if(i&&i.length)if("dimension"===n){var s=i[0],l=s.data.findIndex((function(t){return t.datum.length>0})),u=void 0;if(l>-1)u=(c=s.data[l]).series.dataToPosition(c.datum[0]);(W(s.dimType)?"y"===s.dimType:mY(null===(r=null==s?void 0:s.axis)||void 0===r?void 0:r.getOrient()))?o=null==u?void 0:u.y:a=null==u?void 0:u.x}else if("mark"===n){var c;a=null==(u=(c=i[0]).series.dataToPosition(c.datum[0]))?void 0:u.x,o=null==u?void 0:u.y}this.clearAxisValue();var h=this._findAllAxisContains(a,o),d=h.xAxisMap,p=h.yAxisMap;if(d&&0===d.size||p&&0===p.size){if(this.enableRemain)return;this.hide()}else d&&d.size&&this._setAllAxisValues(d,{x:a,y:o},"xField"),p&&p.size&&this._setAllAxisValues(p,{x:a,y:o},"yField"),this.layoutByValue()},e.prototype.layoutByValue=function(t){var e=this;if(this.enable){var i=vU(this._regions,"cartesian");i&&(GK(this._stateByField,i,this.getLayoutStartPoint(),null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach((function(t){e._layoutByField(t)})))}},e.prototype._layoutByField=function(t){var e=this,i=this._stateByField[t],n=i.cacheInfo,r=i.attributes,a=i.labelsComp,o=i.bandSize,s=i.coordKey;if(r&&n&&(!n._isCache||!this.enableRemain)){var l=n.coord,u=n.labels,c=n.visible,h=n.labelsTextStyle;if(c){var d=KK(this._stateByField[t]);this._updateCrosshairByField(t,d),Object.keys(u).forEach((function(i){var c,d,p,f;if(u[i].visible){var v=M(M(M(((c={})[s]=l+o/2,c),u[i]),r.label),{angle:r.label.syncAxisLabelAngle&&null!==(p=null===(d=n.axisLabel)||void 0===d?void 0:d.attribute.angle)&&void 0!==p?p:0,textStyle:M(M({},null===(f=r.label)||void 0===f?void 0:f.textStyle),h[i]),zIndex:e.labelZIndex,visible:!0});e._updateCrosshairLabel(a[i],v,(function(e){e.name="crosshair-".concat(t.replace("Field",""),"-").concat(i,"-label"),a[i]=e}))}else a[i]&&a[i].hideAll()}))}else this._hideByField(t)}},e.prototype._updateCrosshairByField=function(t,e){var i=this.getContainer(),n=this._stateByField[t].attributes,r=this._stateByField[t].crosshairComp;if(r)r.setAttributes(e);else{var a=n.style;"line"===n.type?r=new xR(M(M({},e),{lineStyle:a,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===n.type&&(r=new kR(M(M({},e),{rectStyle:a,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==i||i.add(r),this._stateByField[t].crosshairComp=r}},e.specKey="crosshair",e.builtInTheme={crosshair:Z8},e.type=L.cartesianCrosshair,e}(q8),Q8=function(){ij.registerComponent(J8.type,J8)},$8=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=L.polarCrosshair,n.name=L.polarCrosshair,n._stateByField={categoryField:{coordKey:"angle",anotherAxisKey:"radius",currentValue:new Map,labelsComp:{all:null}},valueField:{coordKey:"radius",anotherAxisKey:"angle",currentValue:new Map,labelsComp:{all:null}}},n}return C(e,t),e.getSpecInfo=function(t){return wG(t,this.specKey,this.type,(function(t){return t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible}))},e.prototype.setAxisValue=function(t,e){"radius"===e.getOrient()?this._stateByField.valueField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.categoryField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("category"),n=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getDatumAtPoint=function(t,e){var i=t.getLayoutStartPoint(),n=i.x,r=i.y,a=this.getLayoutStartPoint(),o=a.x,s=a.y;return t.positionToData({x:e.x-(n-o),y:e.y-(r-s)})},e.prototype._layoutCrosshair=function(t,e,i,n){var r=t,a=e;if(i&&i.length)if("dimension"===n){var o=i[0];if(o.axis){var s=o.axis.pointToCoord({x:r,y:a}),l="radius"===o.axis.getOrient()?{radius:o.position,angle:s.angle}:{radius:s.radius,angle:o.position},u=o.axis.coordToPoint(l);r=u.x,a=u.y}}else if("mark"===n){var c=i[0],h=c.series.dataToPosition(c.datum[0]);r=h.x,a=h.y}this.clearAxisValue();var d=this._findAllAxisContains(r,a),p=d.angleAxisMap,f=d.radiusAxisMap;if(0!==p.size||0!==f.size)p&&this._setAllAxisValues(p,{x:r,y:a},"categoryField"),f&&this._setAllAxisValues(f,{x:r,y:a},"valueField"),this.layoutByValue();else{if(this.enableRemain)return;this.hide()}},e.prototype.layoutByValue=function(t){var e=this;if(this.enable){var i=vU(this._regions,"polar");i&&(!function(t,e,i){void 0===i&&(i=!1),Object.keys(t).forEach((function(n){var r=t[n],a=r.attributes,o=r.currentValue,s=r.cacheInfo,l=r.coordKey;if(a){var u=!!o.size,c=i&&!u&&W(s),h=c?s:{coord:0,axis:null,visible:u,coordRange:[0,0],sizeRange:[0,0],labels:{all:{visible:!1,text:"",offset:0}}};if(s&&(s._isCache=c),"valueField"===n&&(h.sides=e.angleAxisHelper.getScale(0).domain().length),o.forEach((function(t){var i,r=t.axis,o=t.datum,s=void 0===o?"":o,l=r.niceLabelFormatter;if((null===(i=a.label)||void 0===i?void 0:i.visible)&&(h.labels.all.visible=!0,h.labels.all.defaultFormatter=l,h.labels.all.text=s,h.labels.all.offset=tX(r.getSpec())),"categoryField"===n){var u=e.angleAxisHelper.dataToPosition([s]),c=e.angleAxisHelper.getBandwidth(0),d=r.getOuterRadius();h.coord=u,h.coordRange=[u-c/2,u+c/2],h.sizeRange=[d,d]}else u=r.startAngle,d=e.radiusAxisHelper.dataToPosition([s]),h.coord=d,h.coordRange=[d,d],h.sizeRange=[u,u];h.axis=r})),h&&!c&&h.labels.all.visible&&a&&a.label){var d=h.labels.all,p=a.label,f=MG(p.formatMethod,p.formatter,d.text,{label:d.text,orient:l}),v=f.formatFunc,g=f.args;v?d.text=v.apply(void 0,P([],B(g),!1)):d.defaultFormatter&&(d.text=d.defaultFormatter(d.text))}t[n].cacheInfo=h}}))}(this._stateByField,i,null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach((function(t){e._layoutByField(t)})))}},e.prototype._layoutByField=function(t){var e,i,n,r=this._stateByField[t],a=r.cacheInfo,o=r.attributes,s=r.crosshairComp,l=r.labelsComp,u=r.coordKey;if(!(!a||a._isCache&&this.enableRemain)){var c=this.getContainer(),h=a.visible,d=a.labels,p=a.coord,f=a.sizeRange,v=a.axis;if(h){var g=this.getLayoutStartPoint(),y=null===(i=null===(e=this._spec.valueField)||void 0===e?void 0:e.line)||void 0===i?void 0:i.smooth,m=function(t,e,i){var n=t.cacheInfo,r=t.coordKey,a=t.attributes,o=n.axis,s=n.coord,l=n.sizeRange,u=n.coordRange,c=o.getCenter(),h={x:c.x+e.x,y:c.y+e.y};if("angle"===r)return"sector"==("rect"===a.type?"sector":"line")?{center:h,innerRadius:o.getInnerRadius(),radius:o.getOuterRadius(),startAngle:u[0],endAngle:u[1]}:{start:Pi(h,o.getInnerRadius(),s),end:Pi(h,o.getOuterRadius(),s)};var d=o.startAngle,p=o.endAngle,f=n.sides,v=s;if(!i){var g=o.getCenter(),y=o.coordToPoint({angle:l[0],radius:s}),m=Li(g,y),_=(p-d)/f,b=Math.floor((m-d)/_),x=b*_+d,k=Math.min((b+1)*_+d,p),S=Pi(g,s,x),A=Pi(g,s,k),C=Ui([A.x,A.y],[S.x,S.y],[g.x,g.y],[y.x,y.y]);C&&(v=he(Si.distancePN(y,C[0],C[1])+s,o.getInnerRadius(),o.getOuterRadius()))}return{center:h,startAngle:d,endAngle:p,radius:v,sides:f}}(this._stateByField[t],g,y);if(s)s.setAttributes(m);else{var _,b;if("angle"===u)"line"===(b="rect"===o.type?"sector":"line")?_=new xR(M(M({},m),{lineStyle:o.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===b&&(_=new AR(M(M({},m),{sectorStyle:o.style,zIndex:this.gridZIndex,pickable:!1})));else _="polygon"===(b=y?"circle":"polygon")?new CR(M(M({},m),{lineStyle:o.style,zIndex:this.gridZIndex+1})):new SR(M(M({},m),{lineStyle:o.style,zIndex:this.gridZIndex}));this._stateByField[t].crosshairComp=_,c.add(_)}var x=d.all;if(x.visible){var k=v.getCenter(),S={x:k.x+g.x,y:k.y+g.y},A="angle"===u?function(t){return{align:(t=Ii(t))>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"left":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"right":"center",baseline:t>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"bottom":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"top":"middle"}}(p):function(t){return{align:(t=Ii(t))>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"right":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"left":"center",baseline:t>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"bottom":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"top":"middle"}}(v.startAngle),C="angle"===u?Pi(S,f[1]+x.offset,p):Pi(S,m.radius,v.startAngle),w=M(M(M(M({},C),o.label),x),{textStyle:M(M({},null===(n=o.label)||void 0===n?void 0:n.textStyle),{textAlign:A.align,textBaseline:A.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(l.all,w,(function(t){t.name="crosshair-".concat(u,"-label"),l.all=t}))}else l.all&&l.all.hideAll()}}},e.specKey="crosshair",e.builtInTheme={crosshair:Z8},e.type=L.polarCrosshair,e}(q8),t6=function(){ij.registerComponent($8.type,$8)},e6=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=e.field,a=e.originalFields,o=r(),s=i();if(j(s)||j(o))return t;var l=a(),u=Z(o)?o[0]:o;return t[u]&&l&&l[u]&&l[u].lockStatisticsByDomain&&!n()&&(t[u].values=s),t},i6=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=(0,e.field)(),a=i();if(j(a)||j(r))return t;if(0===a.length)return[];var o={};a.forEach((function(t){o[t]||(o[t]=1)}));var s=null;return s=n()?function(t){var e=!1;return Dt(r).every((function(i){t[i]>=a[0]&&t[i]<=Et(a)&&(e=!0)})),e}:function(t){var e=!1;return Dt(r).every((function(i){(o[t[i]+""]||o[t[i]])&&(e=!0)})),e},t.filter(s)},n6=function(t,e){var i=e.input,n=i.stateFields,r=i.valueFields,a=i.dataCollection,o=i.isCategoryState,s=i.seriesCollection,l=e.output,u=l.stateField,c=l.valueField,h={},d=[],p=[],f=[],v=!1,g=!1;a.forEach((function(t,e){var i;if(!j(n[e])){var a=s[e];if(a){var o=a.getRawDataStatisticsByField(n[e]);W(null==o?void 0:o.max)&&W(null==o?void 0:o.min)&&(g=!0)}var l=null===(i=t.getFields())||void 0===i?void 0:i[n[e]];l&&l.lockStatisticsByDomain&&(v=!0,l.domain.forEach((function(t){j(h[t])&&(f.push(t),h[t]=0,d.push(t))}))),t.latestData.forEach((function(t){Dt(n[e]).forEach((function(i){j(t[i])||(j(h[t[i]])&&(f.push(t[i]),h[t[i]]=0,d.push(t[i])),j(r[e])||(h[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))}))}))}}));var y=v?f:!1===o||g?f.sort((function(t,e){return t-e})):d;return y.forEach((function(t){var e,i=((e={})[u]=t,e);c&&(i[c]=h[t]),p.push(i)})),p},r6=function(t,e,i){var n=e.domain();if(tO(e.type))return i?n[0]+(Et(n)-n[0])*(1-t):n[0]+(Et(n)-n[0])*t;var r=e.range();i&&(r=r.slice().reverse());var a=r[0]+(Et(r)-r[0])*t;return e.invert(a)},a6=function(t,e,i){var n=e.scale(t),r=e.range();return!i&&tO(e.type)&&(r=r.slice().reverse()),Math.max(0,Math.min(1,(n-r[0])/(Et(r)-r[0])))},o6=function(t,e){var i=t;if(!i)return!1;var n=i.getScale();return n.range()[0]>n.range()[1]&&(!i.getInverse()||e)},s6=function(t){var e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,n=null==t?void 0:t.minBandSize;if(e||n||i)return{bandSize:e,maxBandSize:i,minBandSize:n}},l6=function(t,e,i){return"start"===t?"percent"===e&&W(i.start)||"value"===e&&W(i.startValue):"percent"===e&&W(i.end)||"value"===e&&W(i.endValue)},u6=function(t,e,i){if(tO(i.type))return[Math.min(e,t),Math.max(e,t)];var n=i.domain(),r=n.indexOf(t),a=n.indexOf(e);return n.slice(Math.min(r,a),Math.max(r,a)+1)},c6=function(){function t(t,e,i,n,r,a,o,s){var l=this;this._activeRoam=!0,this._zoomAttr={enable:!0,rate:1,focus:!0},this._dragAttr={enable:!0,rate:1,reverse:!0},this._scrollAttr={enable:!0,rate:1,reverse:!0},this.initZoomEvent=function(){var t,e,i,n,r,a,o,s={delayType:null!==(e=null===(t=l._spec)||void 0===t?void 0:t.delayType)&&void 0!==e?e:"throttle",delayTime:W(null===(i=l._spec)||void 0===i?void 0:i.delayType)?null!==(r=null===(n=l._spec)||void 0===n?void 0:n.delayTime)&&void 0!==r?r:30:0,realTime:null===(o=null===(a=l._spec)||void 0===a?void 0:a.realTime)||void 0===o||o,allowComponentZoom:!0};l._zoomAttr.enable&&l.initZoomEventOfRegions(l.getRegions(),null,l.handleChartZoom,s),l._scrollAttr.enable&&l.initScrollEventOfRegions(l.getRegions(),null,l.handleChartScroll,s),l._dragAttr.enable&&l.initDragEventOfRegions(l.getRegions(),null,l.handleChartDrag,s)},this.handleChartZoom=function(t,e){var i,n;if(l._activeRoam&&(!l._zoomAttr.filter||l._zoomAttr.filter(t,e))){var r=t.zoomDelta,a=t.zoomX,o=t.zoomY,s=l.getRegions()[0].getLayoutStartPoint(),u=s.x,c=s.y,h=l.getRegions()[0].getLayoutRect(),d=h.width,p=h.height,f=Math.abs(l.getState().start-l.getState().end),v=null!==(n=null===(i=l._spec.roamZoom)||void 0===i?void 0:i.rate)&&void 0!==n?n:1;if(!(f>=1&&r<1||f<=.01&&r>1)){var g=l._isHorizontal?a:o,y=f*(r-1)*v,m=y/2,_=y/2;if(g){var b=l._isHorizontal?u:c,x=l._isHorizontal?d:p;m=Math.abs(b-g)/Math.abs(x-b)*y,_=Math.abs(x-g)/Math.abs(x-b)*y}var k=he(l.getState().start+m,0,1),S=he(l.getState().end-_,0,1);l._handleChange(Math.min(k,S),Math.max(k,S),!0)}}},this.handleChartScroll=function(t,e){var i;if(!l._activeRoam||l._scrollAttr.filter&&!l._scrollAttr.filter(t,e))return!1;var n=t.scrollX,r=t.scrollY,a=l._isHorizontal?n:r,o=l._isHorizontal?ii(n/r)>=.5:ii(r/n)>=.5;l._scrollAttr.reverse||(a=-a),o&&l.handleChartMove(a,null!==(i=l._scrollAttr.rate)&&void 0!==i?i:1);var s=0!==l.getState().start&&1!==l.getState().end;return o&&s},this.handleChartDrag=function(t,e){var i;if(l._activeRoam&&(!l._dragAttr.filter||l._dragAttr.filter(t,e))){var n=B(t,2),r=n[0],a=n[1],o=l._isHorizontal?r:a;l._dragAttr.reverse&&(o=-o),l.handleChartMove(o,null!==(i=l._dragAttr.rate)&&void 0!==i?i:1)}},this.handleChartMove=function(t,e){var i=l._isHorizontal?l.getLayoutRect().width:l.getLayoutRect().height;if(Math.abs(t)>=1e-6)if(t>0&&l.getState().end<1){var n=Math.min(1-l.getState().end,t/i)*e;l._handleChange(l.getState().start+n,l.getState().end+n,!0)}else if(t<0&&l.getState().start>0){n=Math.max(-l.getState().start,t/i)*e;l._handleChange(l.getState().start+n,l.getState().end+n,!0)}return!1},this._type=t,this._spec=e,this._handleChange=i,this.getLayoutRect=n,this.getState=r,this.getRegions=a,this._regions=a(),this.getOption=o,this._option=o(),this.getEvent=s,this._isHorizontal="horizontal"===xY(bY(e))}return t.prototype.enableInteraction=function(){this._activeRoam=!0},t.prototype.disableInteraction=function(){this._activeRoam=!1},t.prototype.zoomIn=function(t){this.handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},t.prototype.zoomOut=function(t){this.handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},t.prototype.setEventAttrFromSpec=function(){!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=mt({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=mt({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=mt({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,N(this._spec.roam)&&(this._zoomAttr.enable="scrollBar"!==this._type&&this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.getEvent(),this._option.mode)},t}();Tt(c6,_Z);var h6=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.layoutType="none",n._orient="left",n._cacheVisibility=void 0,n._dataUpdating=!1,n._hasInitStateScale=!1,n._shouldChange=!0,n._stateField="x",n._handleStateChange=function(t,e,i){var r,a;return n._startValue=t,n._endValue=e,n._newDomain=u6(n._startValue,n._endValue,n._stateScale),null===(a=(r=n.effect).onZoomChange)||void 0===a||a.call(r,i),!0},n.effect={onZoomChange:function(t){var e,i,r=n._relatedAxisComponent;if(r&&"axis"===n._filterMode){var a=r.getScale(),o=r.getSpec();n._auto&&s6(o)&&n._spec.ignoreBandSize&&(a.bandwidth("auto"),a.maxBandwidth("auto"),a.minBandwidth("auto")),n._updateRangeFactor(t),n._auto&&(null===(i=null===(e=n._component)||void 0===e?void 0:e.setStartAndEnd)||void 0===i||i.call(e,n._start,n._end)),r.effect.scaleUpdate({value:"force"})}else cU(n._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:n._seriesUserId,specIndex:n._seriesIndex}),cU(n._regions,(function(t){t.reFilterViewData()}),{userId:n._seriesUserId,specIndex:n._seriesIndex})}},n._visible=!0,n._orient=bY(t),n._isHorizontal="horizontal"===xY(n._orient),n._dataFilterEvent=new c6(n.type,n._spec,n._handleChange.bind(n),n.getLayoutRect.bind(n),(function(){return{start:n._start,end:n._end}}),(function(){return n._regions}),function(){return n._option}.bind(n),(function(){return n.event})),n}return C(i,e),Object.defineProperty(i.prototype,"isHorizontal",{get:function(){return this._isHorizontal},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stateScale",{get:function(){return this._stateScale},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"relatedAxisComponent",{get:function(){return this._relatedAxisComponent},enumerable:!1,configurable:!0}),i.prototype.setStartAndEnd=function(t,e,i){void 0===i&&(i=["percent","percent"]);var n=B(i,2),r=n[0],a=void 0===r?"percent":r,o=n[1],s=void 0===o?"percent":o,l="percent"===a?t:a6(t,this._stateScale,this._isHorizontal),u="percent"===s?e:a6(e,this._stateScale,this._isHorizontal);this._handleChange(l,u,!0)},i.prototype.enableInteraction=function(){this._dataFilterEvent.enableInteraction()},i.prototype.disableInteraction=function(){this._dataFilterEvent.disableInteraction()},i.prototype.zoomIn=function(t){this._dataFilterEvent.zoomIn(t)},i.prototype.zoomOut=function(t){this._dataFilterEvent.zoomOut(t)},i.prototype._initEvent=function(){var e;this._dataFilterEvent.initZoomEvent(),null===(e=this._relatedAxisComponent)||void 0===e||e.event.on(t.ChartEvent.scaleRawDomainUpdate,(function(t){var e=t.model;console.log("scaleRawDomainUpdate",e.getRawDomain())}))},i.prototype._handleChange=function(t,e,i){var n,r;null!==(r=null===(n=this._spec)||void 0===n?void 0:n.zoomLock)&&void 0!==r&&r||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)},i.prototype._updateRangeFactor=function(t){var e=this._relatedAxisComponent,i=e.getScale(),n=o6(e,this._isHorizontal),r=n?[1-this._end,1-this._start]:[this._start,this._end];if(n)switch(t){case"startHandler":e.scaleRangeFactorEnd(r[1]);break;case"endHandler":e.scaleRangeFactorStart(r[0]);break;default:e.scaleRangeFactorStart(r[0],!0),e.scaleRangeFactorEnd(r[1])}else switch(t){case"startHandler":e.scaleRangeFactorStart(r[0]);break;case"endHandler":e.scaleRangeFactorEnd(r[1]);break;default:e.scaleRangeFactorEnd(r[1],!0),e.scaleRangeFactorStart(r[0])}var a=i.rangeFactor();a?(this._start=n?1-a[1]:a[0],this._end=n?1-a[0]:a[1]):(this._start=0,this._end=1)},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),i.prototype.created=function(){e.prototype.created.call(this),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()},i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},i.prototype.init=function(t){e.prototype.init.call(this,t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||St(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t),this._marks.forEach((function(t){t.getMarks().forEach((function(t){i.initMarkStyleWithSpec(t,i._spec[t.name])}))}))},i.prototype.onLayoutStart=function(t,i){e.prototype.onLayoutStart.call(this,t,i);var n=this._autoUpdate(t);this._autoVisible(n),this._dataUpdating=!1},i.prototype.updateLayoutAttribute=function(){this._visible&&this._createOrUpdateComponent(),this._hasInitStateScale||(0===this._start&&1===this._end||(this._newDomain=function(t,e,i,n,r){if(tO(r.type)){var a=r.domain(),o=a[0],s=Et(a)-o,l=W(t)?o+s*t:+e,u=W(i)?o+s*i:+n;return[Math.min(u,l),Math.max(u,l)]}var c=r.domain(),h=r.range(),d=h[h.length-1]-h[0],p=W(t)?c.indexOf(r.invert(d*t+h[0])):c.indexOf(e),f=W(i)?c.indexOf(r.invert(d*i+h[0])):c.indexOf(n);return c.slice(Math.min(p,f),Math.max(p,f)+1)}(this._spec.start,this._startValue,this._spec.end,this._endValue,this._stateScale),this.effect.onZoomChange()),this._hasInitStateScale=!0)},i.prototype._initAfterLayout=function(){this._stateScale=null,this._initStateScale(),this._updateScaleRange(),this._setStateFromAxis()},i.prototype._beforeLayoutEnd=function(){this._hasInitStateScale?this._updateScaleRange():this._initAfterLayout()},i.prototype.onLayoutEnd=function(){var t;this._beforeLayoutEnd();var i=!(0===this._start&&1===this._end);this._autoVisible(i),e.prototype.onLayoutEnd.call(this),null===(t=this._relatedAxisComponent)||void 0===t||t.updateScaleRange()},i.prototype.getBoundsInRect=function(t){var e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._dataFilterEvent.setEventAttrFromSpec(),this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null===(t=this._spec.visible)||void 0===t||t},i.prototype._setAxisFromSpec=function(){var t=this;if(W(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):W(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),j(this._spec.field)&&!this._relatedAxisComponent){var e=this._option.getComponentsByKey("axes"),i=e.find((function(e){return xY(e._orient)===xY(t._orient)}));if(i)this._relatedAxisComponent=i;else{var n=e.find((function(t){return!tO(t.getScale().type)}));this._relatedAxisComponent=n}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)},i.prototype._setRegionsFromSpec=function(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();var i=this._relatedAxisComponent?null===(e=(t=this._relatedAxisComponent).getBindSeriesFilter)||void 0===e?void 0:e.call(t):null;if(W(i)&&(W(i.userId)&&(this._seriesUserId=Dt(i.userId)),W(i.specIndex)&&(this._seriesIndex=Dt(i.specIndex))),W(this._spec.seriesId)){var n=Dt(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter((function(t){return n.includes(t)})):this._seriesUserId=n}if(W(this._spec.seriesIndex)){var r=Dt(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter((function(t){return r.includes(t)})):this._seriesIndex=r}if(W(this._spec.regionIndex)){var a=this._option.getRegionsInIndex(Dt(this._spec.regionIndex));this._regions=this._regions.filter((function(t){return a.includes(t)}))}else if(W(this._spec.regionId)){var o=Dt(this._spec.regionId);this._regions=o.length?this._regions.filter((function(t){return o.includes(t.id)})):[]}else;},i.prototype._initData=function(){var t,e=this,i=[],n=[],r=[],a=[];if(this._relatedAxisComponent){var o={};cU(this._regions,(function(n){var s,l,u="cartesian"===n.coordinate?n.getXAxisHelper():"polar"===n.coordinate?n.angleAxisHelper:null,c="cartesian"===n.coordinate?n.getYAxisHelper():"polar"===n.coordinate?n.radiusAxisHelper:null;if(u&&c){var h=u.getAxisId()===e._relatedAxisComponent.id?u:c.getAxisId()===e._relatedAxisComponent.id?c:e._isHorizontal?u:c,d=h===u?c:u,p=tO(d.getScale(0).type),f=tO(h.getScale(0).type);i.push(n.getRawData());var v=n.getSpec(),g="cartesian"===n.coordinate?Dt(v.xField):Dt(null!==(s=v.angleField)&&void 0!==s?s:v.categoryField),y="cartesian"===n.coordinate?Dt(v.yField):Dt(null!==(l=v.radiusField)&&void 0!==l?l:v.valueField);if(o[n.id]="link"===n.type?["from_xField"]:h===u?g:y,f?(t=!1,r.push(o[n.id])):(t=!0,r.push(o[n.id][0])),e._valueField){var m="link"===n.type?["from_yField"]:d===u?g:y;p&&a.push.apply(a,P([],B(m),!1))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=o}else cU(this._regions,(function(t){i.push(t.getRawData()),n.push(t),r.push(e._field),e._valueField&&a.push(e._spec.valueField)}),{userId:this._seriesUserId,specIndex:this._seriesIndex});var s=this._option.dataSet;BV(s,"dataview",Xu),EV(s,"dataFilterComputeDomain",n6);var l=new cc(s,{name:"".concat(this.type,"_").concat(this.id,"_data")});l.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:i,seriesCollection:n,stateFields:r,valueFields:a,isCategoryState:t},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new IW(this._option,l),l.reRunAllTransform(),s.multipleDataViewAddListener(i,"change",this._handleDataCollectionChange.bind(this))},i.prototype._addTransformToSeries=function(){var e=this;this._relatedAxisComponent&&"axis"===this._filterMode||(EV(this._option.dataSet,"dataFilterWithNewDomain",i6),EV(this._option.dataSet,"lockStatisticsFilter",e6),cU(this._regions,(function(i){i.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:function(){return i.getViewDataStatistics().getFields()},getNewDomain:function(){return e._newDomain},field:function(){var t;return null!==(t=e._field)&&void 0!==t?t:e._parseFieldOfSeries(i)},isContinuous:function(){return tO(e._stateScale.type)}},level:1},!1),i.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:function(){return e._newDomain},field:function(){var t;return null!==(t=e._field)&&void 0!==t?t:e._parseFieldOfSeries(i)},isContinuous:function(){return tO(e._stateScale.type)}},level:t.TransformLevel.dataZoomFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex}))},i.prototype.onDataUpdate=function(){var t,e=this._computeDomainOfStateScale(tO(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!St(this._domainCache,e)&&(this._domainCache=e,this._dataUpdating=!0,null===(t=this.getChart())||void 0===t||t.setLayoutTag(!0,null,!1))},i.prototype._parseFieldOfSeries=function(t){var e;return null===(e=this._originalStateFields)||void 0===e?void 0:e[t.id]},i.prototype._setStateFromSpec=function(){var t,e;if(this._auto=!!this._spec.auto,this._spec.rangeMode){var i=B(this._spec.rangeMode,2),n=i[0],r=i[1];l6("start",n,this._spec)&&l6("end",r,this._spec)&&(t="percent"===n?this._spec.start:a6(this._spec.startValue,this._stateScale,this._isHorizontal),e="percent"===r?this._spec.end:a6(this._spec.endValue,this._stateScale,this._isHorizontal))}else t=this._spec.start?this._spec.start:this._spec.startValue?a6(this._spec.startValue,this._stateScale,this._isHorizontal):0,e=this._spec.end?this._spec.end:this._spec.endValue?a6(this._spec.endValue,this._stateScale,this._isHorizontal):1;this._start=Math.max(0,Math.min(1,t)),this._end=Math.max(0,Math.min(1,e))},i.prototype._setStateFromAxis=function(){var t,e;this._setStateFromSpec();var i=this._relatedAxisComponent;this._startValue=r6(this._start,this._stateScale,o6(i,this._isHorizontal)),this._endValue=r6(this._end,this._stateScale,o6(i,this._isHorizontal)),this._minSpan=null!==(t=this._spec.minSpan)&&void 0!==t?t:0,this._maxSpan=null!==(e=this._spec.maxSpan)&&void 0!==e?e:1,tO(this._stateScale.type)&&this._stateScale.domain()[0]!==Et(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(Et(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(Et(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),i&&(i&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=u6(this._startValue,this._endValue,this._stateScale)))},i.prototype._initStateScale=function(){var t,e,i,n,r,a,o=this,s=[0,1];if(this._relatedAxisComponent){var l=this._relatedAxisComponent.getScale().clone();this._stateScale=l,null===(e=(t=l).maxBandwidth)||void 0===e||e.call(t,"auto",!0),null===(n=(i=l).minBandwidth)||void 0===n||n.call(i,"auto",!0),null===(a=(r=l).bandwidth)||void 0===a||a.call(r,"auto",!0),l.rangeFactor(s,!0).range(s)}else{var u=!0;this._field&&cU(this._regions,(function(t){var e=t.getRawDataStatisticsByField(o._field);it(null==e?void 0:e.min)&&it(null==e?void 0:e.max)||(u=!1)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._stateScale=u?new YO:new CO,this._stateScale.domain(this._computeDomainOfStateScale(u),!0).range(s)}},i.prototype._computeDomainOfStateScale=function(t){var e=this;if(this._spec.customDomain)return this._spec.customDomain;var i=this._data.getLatestData().map((function(t){return t[e._stateField]}));if(t){var n=i.map((function(t){return 1*t}));return i.length?[Pt(n),Bt(n)]:[-1/0,1/0]}return i},i.prototype._autoVisible=function(e){var i,n;if(this._auto){e?this.show():this.hide();var r=this._isHorizontal?"height":"width";this.layout.setLayoutRect(((i={})[r]=e?this["_".concat(r)]:0,i),((n={})[r]=t.AttributeLevel.Built_In,n))}},i.prototype.hide=function(){var t;null===(t=this._component)||void 0===t||t.hideAll()},i.prototype.show=function(){var t;null===(t=this._component)||void 0===t||t.showAll()},i.prototype._autoUpdate=function(t){var e,i,n,r,a,o;if(!this._auto)return this._cacheVisibility=void 0,!0;var s=this._relatedAxisComponent,l=null==s?void 0:s.getSpec(),u=null==s?void 0:s.getScale(),c=s6(l);if(!this._dataUpdating&&iO(u.type)&&(null==t?void 0:t.height)===(null===(e=this._cacheRect)||void 0===e?void 0:e.height)&&(null==t?void 0:t.width)===(null===(i=this._cacheRect)||void 0===i?void 0:i.width)&&this._fixedBandSize===(null==c?void 0:c.bandSize))return this._cacheVisibility;var h=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null===(n=this._cacheRect)||void 0===n?void 0:n.width)?u.range(s.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null===(r=this._cacheRect)||void 0===r?void 0:r.height)&&u.range(s.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==c?void 0:c.bandSize,iO(u.type)){c&&(this._start||this._end)&&(this.type===L.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());var d=B(null!==(a=u.rangeFactor())&&void 0!==a?a:[],2),p=d[0],f=d[1];h=(!j(p)||!j(f))&&!(0===p&&1===f)}else{var v=B(null!==(o=u.rangeFactor())&&void 0!==o?o:[this._start,this._end],2);p=v[0],f=v[1];h=!(0===p&&1===f)}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=h,h},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i}(CX);Tt(h6,_Z);var d6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=function(t){var e=ej({selectedBackgroundChart:{line:{},area:{}}},i._theme,t),n=t.selectedBackgroundChart,r=void 0===n?{}:n,a=r.line,o=r.area;return a&&!1!==a.visible&&(e.selectedBackgroundChart.line.style=M(M({},e.selectedBackgroundChart.line.style),{visible:!0})),o&&!1!==o.visible&&(e.selectedBackgroundChart.area.style=M(M({},e.selectedBackgroundChart.area.style),{visible:!0})),e},o=t;r=Z(o)?o.map((function(t){return a(t)})):a(o)}return this._adjustPadding(r),{spec:r,theme:n}},e}(AX),p6=function(t){return{area:{style:{visible:t,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:t,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}},f6={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:p6(!1),startHandler:{style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},endHandler:{style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:p6(!0)},v6=function(e){function i(i,n){var r,a=this;return(a=e.call(this,i,n)||this).type=L.dataZoom,a.name=L.dataZoom,a.transformerConstructor=d6,a.specKey="dataZoom",a.layoutZIndex=t.LayoutZIndex.DataZoom,a.layoutLevel=t.LayoutLevel.DataZoom,a.layoutType="region-relative",a._isReverseCache=!1,a._dataToPositionX=function(t){var e=a._isHorizontal?0:a._middleHandlerSize,i=a._isHorizontal?a._startHandlerSize/2:0,n=a._isHorizontal?a._stateScale:a._valueScale,r=a._isHorizontal?a._stateField:a._valueField;return n.scale(t[r])+a.getLayoutStartPoint().x+e+i},a._dataToPositionX2=function(t){var e=a._isHorizontal?0:a._middleHandlerSize,i=a._isHorizontal?a._startHandlerSize/2:0,n=a._isHorizontal?a._stateScale:a._valueScale,r=n.domain()[0];return n.scale(r)+a.getLayoutStartPoint().x+e+i},a._dataToPositionY=function(t){var e=a._isHorizontal?a._middleHandlerSize:0,i=a._isHorizontal?0:a._startHandlerSize/2,n=a._isHorizontal?a._valueScale:a._getPreviewStateScale(),r=a._isHorizontal?a._valueField:a._stateField;return n.scale(t[r])+a.getLayoutStartPoint().y+e+i},a._dataToPositionY2=function(t){var e=a._isHorizontal?a._middleHandlerSize:0,i=a._isHorizontal?0:a._startHandlerSize/2,n=a._isHorizontal?a._valueScale:a._getPreviewStateScale(),r=n.domain()[0];return n.scale(r)+a.getLayoutStartPoint().y+e+i},a._valueField="y",a._filterMode=null!==(r=i.filterMode)&&void 0!==r?r:"filter",a}return C(i,e),i.prototype._handleChange=function(i,n,r,a){if(e.prototype._handleChange.call(this,i,n,r),this._shouldChange)if(r&&this._component)this._component.setStartAndEnd(i,n);else{var o=this._relatedAxisComponent,s=r6(i,this._stateScale,o6(o,this._isHorizontal)),l=r6(n,this._stateScale,o6(o,this._isHorizontal));if(!W(s)||!W(l))return;this._start=i,this._end=n,(U(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(i,n,s,l):this._handleStateChange(s,l,a))&&this.event.emit(t.ChartEvent.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:i,end:n,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}},i.prototype._handleDataCollectionChange=function(){this._data.getDataView().reRunAllTransform();var t=this._computeDomainOfValueScale();t&&(this._valueScale||(this._valueScale=new YO),this._valueScale.domain(t),this._updateValueScaleRange(),this._component&&this._createOrUpdateComponent(!0))},i.prototype.created=function(){e.prototype.created.call(this),this._initValueScale()},i.prototype.updateLayoutAttribute=function(){!1!==this._cacheVisibility&&e.prototype.updateLayoutAttribute.call(this)},i.prototype._beforeLayoutEnd=function(){e.prototype._beforeLayoutEnd.call(this);var t=this._relatedAxisComponent;(o6(t,this._isHorizontal)&&!this._isReverseCache||this._auto)&&(this._isReverseCache=o6(t,this._isHorizontal),this.effect.onZoomChange())},i.prototype.clear=function(){if(this._component){var t=this.getContainer();this._component.removeAllChild(),t&&t.removeChild(this._component),this._component=null}e.prototype.clear.call(this)},i.prototype.getBoundsInRect=function(t){var e,i,n,r,a={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},o=this._startHandlerSize*(null!==(e=this._spec.startHandler.style.scaleX)&&void 0!==e?e:1),s=this._startHandlerSize*(null!==(i=this._spec.startHandler.style.scaleY)&&void 0!==i?i:1),l=this._endHandlerSize*(null!==(n=this._spec.endHandler.style.scaleX)&&void 0!==n?n:1),u=this._endHandlerSize*(null!==(r=this._spec.endHandler.style.scaleY)&&void 0!==r?r:1),c=this._visible?this._isHorizontal?(o-this._startHandlerSize)/2+(l-this._endHandlerSize)/2:(Math.max(o,l)-this._width)/2:0,h=this._visible?this._isHorizontal?(Math.max(s,u)-this._height)/2:(s-this._startHandlerSize)/2+(u-this._endHandlerSize)/2:0;return this._isHorizontal?(a.y2=a.y1+this._height+h,a.x2=a.x1+t.width+c):(a.x2=a.x1+this._width+c,a.y2=a.y1+t.height+h),a},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o,s,l,u,c;e.prototype.setAttrFromSpec.call(this);var h=this._isHorizontal?Number(this._spec.height):Number(this._spec.width);this._backgroundSize=null!==(i=null===(t=this._spec.background)||void 0===t?void 0:t.size)&&void 0!==i?i:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),j(null===(a=null===(r=null===(n=this._spec)||void 0===n?void 0:n.startHandler)||void 0===r?void 0:r.style)||void 0===a?void 0:a.size)&&(this._spec.startHandler.style.size=isNaN(h)?this._backgroundSize:h-this._middleHandlerSize),j(null===(l=null===(s=null===(o=this._spec)||void 0===o?void 0:o.endHandler)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)&&(this._spec.endHandler.style.size=isNaN(h)?this._backgroundSize:h-this._middleHandlerSize);var d=null===(u=this._spec.startHandler.style.visible)||void 0===u||u,p=null===(c=this._spec.endHandler.style.visible)||void 0===c||c;this._startHandlerSize=d?this._spec.startHandler.style.size:0,this._endHandlerSize=p?this._spec.endHandler.style.size:0,this._width=this._computeWidth(),this._height=this._computeHeight()},i.prototype._initValueScale=function(){var t=this._computeDomainOfValueScale();if(t){var e=new YO;e.domain(t),this._valueScale=e}},i.prototype._updateScaleRange=function(){this._updateStateScaleRange(),this._updateValueScaleRange()},i.prototype._updateStateScaleRange=function(){var t,e,i,n=this._startHandlerSize+this._endHandlerSize;if(this._stateScale){var r,a=this._isHorizontal?this.getLayoutRect().width-n:this.getLayoutRect().height-n,o=null!==(e=null===(t=this._relatedAxisComponent)||void 0===t?void 0:t.getScale().range())&&void 0!==e?e:[this._startHandlerSize/2,a+this._startHandlerSize/2],s=this._computeWidth(),l=this._computeHeight();r=this._isHorizontal?this._visible?[this._startHandlerSize/2,s-n+this._startHandlerSize/2]:o:this._visible?[this._startHandlerSize/2,l-n+this._startHandlerSize/2]:o,this._stateScale.range(r),null===(i=this._previewStateScale)||void 0===i||i.range(o6(this._relatedAxisComponent,this._isHorizontal)?r.reverse():r)}},i.prototype._updateValueScaleRange=function(){if(this._valueScale){var t=this._computeWidth(),e=this._computeHeight();this._isHorizontal?this._valueScale.range([e-this._middleHandlerSize,0]):"left"===this.layoutOrient?this._valueScale.range([t-this._middleHandlerSize,0]):this._valueScale.range([0,t-this._middleHandlerSize])}},i.prototype._computeDomainOfValueScale=function(){var t=this,e=this._data.getLatestData().map((function(e){return e[t._valueField]})),i=e.map((function(t){return 1*t}));return e.length?[Pt(i),Bt(i)]:null},i.prototype._isScaleValid=function(t){if(!t||!t.domain())return!1;var e=t.domain();return(!tO(t.type)||e[0]!==Et(e))&&(!iO(t.type)||1!==Lt(e).length)},i.prototype._getXScale=function(){return this._relatedAxisComponent.getScale().type===this.stateScale.type&&this._isHorizontal?this.stateScale:this._isHorizontal?this._stateScale:this._valueScale},i.prototype._getYScale=function(){return this._isHorizontal?this._valueScale:this._stateScale},i.prototype._computeMiddleHandlerSize=function(){var t,e,i,n,r=0;if(null===(e=null===(t=this._spec)||void 0===t?void 0:t.middleHandler)||void 0===e?void 0:e.visible){var a=null!==(i=this._spec.middleHandler.icon.style.size)&&void 0!==i?i:8,o=null!==(n=this._spec.middleHandler.background.size)&&void 0!==n?n:40;r+=Math.max(a,o)}return r},i.prototype._computeWidth=function(){return!1===this._visible?0:$(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:Math.max(this._startHandlerSize||0,this._endHandlerSize||0,this._backgroundSize||0)+this._middleHandlerSize},i.prototype._computeHeight=function(){return!1===this._visible?0:$(this._spec.height)?this._spec.height:this._isHorizontal?Math.max(this._startHandlerSize||0,this._endHandlerSize||0,this._backgroundSize||0)+this._middleHandlerSize:this.getLayoutRect().height},i.prototype._getAttrs=function(t){var e,i,n,r,a,o=null!==(e=this._spec)&&void 0!==e?e:{};return M({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:o.showDetail,brushSelect:null!==(i=o.brushSelect)&&void 0!==i&&i,zoomLock:null!==(n=o.zoomLock)&&void 0!==n&&n,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:o.delayType,delayTime:W(o.delayType)?null!==(r=o.delayTime)&&void 0!==r?r:30:0,realTime:null===(a=o.realTime)||void 0===a||a,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance,isReverse:o6(this._relatedAxisComponent,this._isHorizontal)},this._getComponentAttrs(t))},i.prototype._getLayoutAttrs=function(){return{position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},size:{width:this._computeWidth(),height:this._computeHeight()}}},i.prototype._createOrUpdateComponent=function(t){var e=this;if(this._visible){var i=this._isHorizontal?this._stateScale:this._valueScale,n=this._isHorizontal?this._valueScale:this._stateScale,r=this._isScaleValid(i)&&this._isScaleValid(n)&&!1!==this._spec.showBackgroundChart,a=this._getAttrs(r),o=this._relatedAxisComponent;if(this._component)this._component.setAttributes(a),t&&(this._component.setPreviewData(this._data.getDataView().latestData),r&&(this._isHorizontal?this._component.setPreviewPointsY1(this._dataToPositionY2):this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData((function(t){return r6(t,e._stateScale,o6(o,e._isHorizontal))}))));else{var s=this.getContainer();this._component=new bH(a),this._component.setPreviewData(this._data.getDataView().latestData),this._isHorizontal?r&&this._component.setPreviewPointsY1(this._dataToPositionY2):r&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData((function(t){return r6(t,e._stateScale,o6(o,e._isHorizontal))})),this._component.addEventListener("dataZoomChange",(function(t){var i=t.detail,n=i.start,r=i.end,a=i.tag;e._handleChange(n,r,void 0,a)})),s.add(this._component)}}},i.prototype._getComponentAttrs=function(t){var e,i,n,r,a,o,s,l,u,c,h,d=this._spec,p=d.middleHandler,f=void 0===p?{}:p,v=d.startText,g=void 0===v?{}:v,y=d.endText,m=void 0===y?{}:y,_=d.backgroundChart,b=void 0===_?{}:_,x=d.selectedBackgroundChart,k=void 0===x?{}:x;return{backgroundStyle:vV(null===(e=this._spec.background)||void 0===e?void 0:e.style),startHandlerStyle:vV(null===(i=this._spec.startHandler)||void 0===i?void 0:i.style),middleHandlerStyle:f.visible?{visible:!0,icon:vV(null===(n=f.icon)||void 0===n?void 0:n.style),background:{size:null===(r=f.background)||void 0===r?void 0:r.size,style:vV(null===(a=f.background)||void 0===a?void 0:a.style)}}:{visible:!1},endHandlerStyle:vV(null===(o=this._spec.endHandler)||void 0===o?void 0:o.style),startTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:vV(g.style)},endTextStyle:{padding:m.padding,formatMethod:this._getHandlerTextFormatMethod(m),textStyle:vV(m.style)},selectedBackgroundStyle:vV(this._spec.selectedBackground.style),dragMaskStyle:vV(null===(s=this._spec.dragMask)||void 0===s?void 0:s.style),backgroundChartStyle:t?{line:ej(vV(null===(l=b.line)||void 0===l?void 0:l.style),{fill:!1}),area:M({curveType:"basis",visible:!0},vV(null===(u=b.area)||void 0===u?void 0:u.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:ej(vV(null===(c=k.line)||void 0===c?void 0:c.style),{fill:!1}),area:M({curveType:"basis",visible:!0},vV(null===(h=k.area)||void 0===h?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}},i.prototype._getHandlerTextFormatMethod=function(t){var e=t.formatMethod,i=t.formatter,n=MG(e,i).formatFunc;return n?function(t){return n(t,{label:t},i)}:void 0},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.prototype.onDataUpdate=function(){e.prototype.onDataUpdate.call(this),this._previewStateScale!==this._stateScale&&(this._previewStateScale=null)},i.prototype._getPreviewStateScale=function(){return this._previewStateScale||(o6(this._relatedAxisComponent,this._isHorizontal)?(this._previewStateScale=this._stateScale.clone(),this._previewStateScale.range(this._stateScale.range().reverse())):this._previewStateScale=this._stateScale),this._previewStateScale},i.type=L.dataZoom,i.transformerConstructor=d6,i.builtInTheme={dataZoom:f6},i.specKey="dataZoom",i}(h6),g6=function(){ij.registerComponent(v6.type,v6)},y6={horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}},m6=function(e){function i(i,n){var r,a=this;return(a=e.call(this,i,n)||this).type=L.scrollBar,a.name=L.scrollBar,a.specKey="scrollBar",a.layoutZIndex=t.LayoutZIndex.DataZoom,a.layoutLevel=t.LayoutLevel.DataZoom,a.layoutType="region-relative",a._filterMode=null!==(r=i.filterMode)&&void 0!==r?r:"axis",a}return C(i,e),i.prototype._handleChange=function(i,n,r){e.prototype._handleChange.call(this,i,n,r);var a=eU(this._start,i)&&eU(this._end,n);if(this._shouldChange&&(!a||!1===this._spec.realTime)){r&&this._component&&this._component.setAttribute("range",[i,n]),this._start=i,this._end=n;var o=r6(i,this._stateScale,!1),s=r6(n,this._stateScale,!1);(U(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(i,n,o,s):this._handleStateChange(o,s))&&this.event.emit(t.ChartEvent.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}},i.prototype._handleDataCollectionChange=function(){this._spec.auto&&this._data.getDataView().reRunAllTransform()},i.prototype._beforeLayoutEnd=function(){var t,i;e.prototype._beforeLayoutEnd.call(this),null===(i=(t=this.effect).onZoomChange)||void 0===i||i.call(t)},i.prototype.onLayoutEnd=function(){this._updateComponentBounds(),e.prototype.onLayoutEnd.call(this)},i.prototype._updateScaleRange=function(){},i.prototype._updateComponentBounds=function(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})},i.prototype._computeWidth=function(){return!1===this._visible?0:$(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12},i.prototype._computeHeight=function(){return!1===this._visible?0:$(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height},i.prototype._getAttrs=function(){var t,e,i,n,r,a;return M({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null===(t=this._spec)||void 0===t?void 0:t.delayType,delayTime:W(null===(e=this._spec)||void 0===e?void 0:e.delayType)?null!==(n=null===(i=this._spec)||void 0===i?void 0:i.delayTime)&&void 0!==n?n:30:0,realTime:null===(a=null===(r=this._spec)||void 0===r?void 0:r.realTime)||void 0===a||a},this._getComponentAttrs())},i.prototype._createOrUpdateComponent=function(){var t=this,e=this._getAttrs();if(this._component)this._component.setAttributes(e);else{var i=this.getContainer();this._component=new MP(e),this._component.addEventListener("scrollDrag",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),this._component.addEventListener("scrollUp",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),i.add(this._component)}},i.prototype._getComponentAttrs=function(){var t=this._spec,e=t.rail,i=t.slider,n=t.innerPadding,r={};return j(n)||(r.padding=n),ct(null==e?void 0:e.style)||(r.railStyle=vV(e.style)),ct(null==i?void 0:i.style)||(r.sliderStyle=vV(i.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.type=L.scrollBar,i.builtInTheme={scrollBar:y6},i.specKey="scrollBar",i}(h6),_6=function(){ij.registerComponent(m6.type,m6)},b6=function(t,e){var i=e.datum,n=e.title,r=e.content,a=[],o=i.call(null);return n.visible&&a.push({type:"title",index:0,datum:o,spec:n}),Dt(r).forEach((function(t,e){t.visible&&a.push({type:"content",index:e,datum:o,spec:t})})),a},x6=function(t,e){return{fontSize:{type:"token",key:t},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},k6={title:{visible:!0,autoLimit:!1,autoFit:!1,style:x6("l1FontSize","primaryFontColor")},content:{visible:!0,style:x6("l2FontSize","tertiaryFontColor")}},S6=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=L.indicator,i.name=L.indicator,i.specKey="indicator",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.Indicator,i.layoutLevel=t.LayoutLevel.Indicator,i._gap=0,i._activeDatum=null,i}return C(i,e),i.getSpecInfo=function(t){return wG(t,this.specKey,this.type,(function(t){return t&&!1!==t.visible}))},i.prototype.created=function(){e.prototype.created.call(this),this.initData(),this.initEvent()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=Dt(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(Dt(this._spec.regionId),Dt(this._spec.regionIndex))},i.prototype.initEvent=function(){var t=this;this._option.disableTriggerEvent||"none"!==this._spec.trigger&&("hover"===this._spec.trigger?(this.event.on("element-highlight:start",(function(e){var i=e.graphics[0];t.isRelativeModel(i)&&t.updateDatum(mV(i))})),this.event.on("element-highlight:reset",(function(e){t._activeDatum&&t.updateDatum(null)}))):(this.event.on("element-select:start",(function(e){var i=e.graphics[0];t.isRelativeModel(i)&&t.updateDatum(mV(i))})),this.event.on("element-select:reset",(function(e){t._activeDatum&&t.updateDatum(null)}))))},i.prototype.updateDatum=function(t){this._activeDatum=t,this._displayData.updateData();var e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)},i.prototype.initData=function(){var t=this;EV(this._option.dataSet,"indicatorFilter",b6);var e=new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});e.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:function(){return t._activeDatum}}}),e.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new IW(this._option,e)},i.prototype.updateLayoutAttribute=function(){var t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),e.prototype.updateLayoutAttribute.call(this)},i.prototype._getIndicatorAttrs=function(){var t=this;if(!1===this._spec.visible||!1===this._spec.fixed&&null===this._activeDatum)return{visible:!1};var e=this._regions[0],i=e.getLayoutRect(),n=i.width,r=i.height,a=e.getLayoutStartPoint(),o=a.x,s=a.y,l=this._spec,u=l.content,c=l.offsetX,h=l.offsetY,d=l.limitRatio,p=l.title,f=w(l,["content","offsetX","offsetY","limitRatio","title"]),v=[];return Dt(u).forEach((function(e){var i=ej({},t._theme.content,e);v.push({visible:!1!==i.visible&&(!i.field||null!==t._activeDatum),space:i.space||t._gap,autoLimit:i.autoLimit,autoFit:i.autoFit,fitPercent:i.fitPercent,fitStrategy:i.fitStrategy,style:M(M({},fV(bt(i.style,["text"]),t._activeDatum)),{text:t._createText(i.field,i.style.text)})})})),M({visible:!0,size:{width:n,height:r},zIndex:this.layoutZIndex,x:o,y:s,dx:c?WU(c,this._computeLayoutRadius()):0,dy:h?WU(h,this._computeLayoutRadius()):0,limitRatio:d||1/0,title:{visible:!1!==p.visible&&(!W(p.field)||null!==this._activeDatum),space:p.space||this._gap,autoLimit:p.autoLimit,autoFit:p.autoFit,fitPercent:p.fitPercent,fitStrategy:p.fitStrategy,style:M(M({},fV(bt(p.style,["text"]),this._activeDatum)),{text:this._createText(p.field,p.style.text)})},content:v},f)},i.prototype._createOrUpdateIndicatorComponent=function(t){var e=this;if(!1===t.visible)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)St(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{var i=this.getContainer(),n=new BN(t);n.name="indicator",i.add(n),this._indicatorComponent=n,this._indicatorComponent.on("*",(function(t,i){return e._delegateEvent(e._indicatorComponent,t,i)}))}this._cacheAttrs=t},i.prototype._createText=function(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":U(e)?null!==(i=e(this._activeDatum,void 0))&&void 0!==i?i:"":null!=e?e:""},i.prototype._computeLayoutRadius=function(){var t=this._regions[0].getLayoutRect(),e=t.width,i=t.height;return Math.min(e/2,i/2)},i.prototype.isRelativeModel=function(t){return this._regions.some((function(e){return!!e.getSeriesInId(t.context.modelId)}))},i.prototype._getNeedClearVRenderComponents=function(){return[this._indicatorComponent]},i.prototype.clear=function(){this._cacheAttrs=null,e.prototype.clear.call(this)},i.prototype.getIndicatorComponent=function(){return this._indicatorComponent},i.type=L.indicator,i.builtInTheme={indicator:k6},i.specKey="indicator",i}(CX),A6=function(){ij.registerComponent(S6.type,S6)},C6=["sum","average","min","max","variance","standardDeviation","median"];function M6(t,e,i){if(!i)return!1;var n=t.map((function(t){return 1*t})),r=Pt(n),a=Bt(n);return e<r||e>a}function w6(t,e,i,n,r,a){var o,s,l=n.relativeSeries;return $(t.x)&&M6(e,t.x,i)&&(null===(s=null==l?void 0:(o=l.getXAxisHelper()).setExtendDomain)||void 0===s||s.call(o,"marker_xAxis_extend",t.x)),OU(t.x)?B6(t.x,r)+a.x:P6(l.getXAxisHelper(),[t.x])+a.x}function T6(t,e,i,n,r,a){var o,s,l=n.relativeSeries;return $(t.y)&&M6(e,t.y,i)&&(null===(s=null===(o=l.getYAxisHelper())||void 0===o?void 0:o.setExtendDomain)||void 0===s||s.call(o,"marker_yAxis_extend",t.y)),OU(t.y)?B6(t.y,r)+a.y:P6(l.getYAxisHelper(),[t.y])+a.y}function D6(t,e,i,n){var r,a,o=n.relativeSeries;return $(t.angle)&&M6(e,t.angle,i)&&(null===(a=null===(r=o.angleAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_angleAxis_extend",t.angle)),P6(o.angleAxisHelper,[t.angle])}function E6(t,e,i,n){var r,a,o=n.relativeSeries;return $(t.radius)&&M6(e,t.radius,i)&&(null===(a=null===(r=o.radiusAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_radiusAxis_extend",t.radius)),P6(o.radiusAxisHelper,[t.radius])}function B6(t,e){return Number(t.substring(0,t.length-1))*e/100}function P6(t,e){var i=t.getScale(0);return tO(i.type)&&i.domain()[0]===i.domain()[1]&&e[0]!==i.domain()[0]?NaN:t.dataToPosition(e)}function R6(t){return C6.includes(t)}function L6(t,e,i,n,r,a){void 0===a&&(a=!1);var o=e.getRegion(),s=o.getLayoutStartPoint(),l=i.getRegion(),u=l.getLayoutStartPoint(),c=Math.abs(Math.min(s.x,u.x)-Math.max(s.x+o.getLayoutRect().width,u.x+l.getLayoutRect().width)),h=Math.abs(Math.min(s.y,u.y)-Math.max(s.y+o.getLayoutRect().height,u.y+l.getLayoutRect().height)),d={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},p=[],f=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,v=n.getXAxisHelper(),g=n.getYAxisHelper(),y=v.getScale(0).domain(),m=g.getScale(0).domain(),_=a&&!v.isContinuous&&!!v.getBandwidth,b=a&&!g.isContinuous&&!!g.getBandwidth,x={min:null,max:null},k={min:null,max:null};return f.forEach((function(t){var e,i,n=W(t.x),a=W(t.y);if(n&&a)e=w6(t,y,r,d,c,s),i=T6(t,m,r,d,h,s),I6(e,_,x,p.length),I6(i,b,k,p.length),p.push([{x:e,y:i}]);else if(n){e=w6(t,y,r,d,c,s),i=Math.max(s.y+o.getLayoutRect().height,u.y+l.getLayoutRect().height);var f=Math.min(s.y,u.y);I6(e,_,x,p.length),p.push([{x:e,y:i},{x:e,y:f}])}else if(a){e=Math.min(s.x,u.x),i=T6(t,m,r,d,h,s);var v=Math.max(s.x+o.getLayoutRect().width,u.x+l.getLayoutRect().width);I6(i,b,k,p.length),p.push([{x:e,y:i},{x:v,y:i}])}})),function(t,e,i,n,r){if(n.min||n.max){var a=e.getBandwidth(0)*(1+e.getScale(0).paddingInner());n.min&&t[n.min.index].forEach((function(t){return t.x-=a/2})),n.max&&t[n.max.index].forEach((function(t){return t.x+=a/2}))}if(r.min||r.max){var o=i.getBandwidth(0)*(1+i.getScale(0).paddingInner());r.min&&t[r.min.index].forEach((function(t){return t.y-=o/2})),r.max&&t[r.max.index].forEach((function(t){return t.y+=o/2}))}}(p,v,g,x,k),p}function I6(t,e,i,n){return e&&((null===i.min||i.min.value>t)&&(i.min={value:t,index:n}),(null===i.max||i.max.value<t)&&(i.max={value:t,index:n})),t}function F6(t,e,i,n,r){var a={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},o=[],s=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,l=n.angleAxisHelper.getScale(0).domain(),u=n.radiusAxisHelper.getScale(0).domain(),c=Math.min(n.getRegion().getLayoutRect().width/2,n.getRegion().getLayoutRect().height/2);return s.forEach((function(t){var e=W(t.angle),i=W(t.radius);if(e&&i){var n=D6(t,l,r,a),s=E6(t,u,r,a);o.push([{angle:n,radius:s}])}else if(e){n=D6(t,l,r,a);o.push([{angle:n,radius:-c},{angle:n,radius:c}])}else if(i){s=E6(t,u,r,a);o.push([{radius:s,angle:0},{radius:s,angle:2*Math.PI}])}})),o}function O6(t,e,i,n){var r=[],a=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,o=Z(n);return a.forEach((function(t,a){var s,l,u,c,h=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,d=h.getRegion(),p=d.getLayoutStartPoint(),f=d.getLayoutRect(),v=f.width,g=f.height,y=0,m=0;if(n){var _=o?n[a]:n,b=_.x,x=_.y;b&&(y=OU(b)?Number(b.substring(0,b.length-1))*v/100:b),x&&(m=OU(x)?Number(x.substring(0,x.length-1))*g/100:x)}var k=h.getXAxisHelper().getScale(0).domain(),S=h.getYAxisHelper().getScale(0).domain(),A=Dt(t.x),C=Dt(t.y);1===A.length&&$(A[0])&&M6(k,A[0],i)&&(null===(l=null===(s=h.getXAxisHelper())||void 0===s?void 0:s.setExtendDomain)||void 0===l||l.call(s,"marker_xAxis_extend",A[0])),1===C.length&&$(C[0])&&M6(S,C[0],i)&&(null===(c=null===(u=h.getYAxisHelper())||void 0===u?void 0:u.setExtendDomain)||void 0===c||c.call(u,"marker_yAxis_extend",C[0])),r.push({x:P6(h.getXAxisHelper(),A)+p.x+y,y:P6(h.getYAxisHelper(),C)+p.y+m})})),r}function z6(t,e,i){var n=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach((function(t){var r,a,o,s,l=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,u=l.angleAxisHelper.getScale(0).domain(),c=l.radiusAxisHelper.getScale(0).domain(),h=Dt(t.angle),d=Dt(t.radius);1===h.length&&$(h[0])&&M6(u,h[0],i)&&(null===(a=null===(r=l.angleAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_xAxis_extend",h[0])),1===d.length&&$(d[0])&&M6(c,d[0],i)&&(null===(s=null===(o=l.radiusAxisHelper)||void 0===o?void 0:o.setExtendDomain)||void 0===s||s.call(o,"marker_yAxis_extend",d[0])),n.push({angle:P6(l.angleAxisHelper,h),radius:P6(l.radiusAxisHelper,d)})})),n}function H6(t,e,i){var n=t.x,r=t.y;return OU(n)&&(n=B6(n,e)),OU(r)&&(r=B6(r,i)),{x:n,y:r}}function N6(t,e,i){var n;if(n=U(t)?Dt(t(e.getData().getLatestData(),e)):Dt(t),i){var r=e.getRegion(),a=r.getLayoutStartPoint(),o=a.x,s=a.y,l=r.getLayoutRect(),u=l.width,c=l.height;return n.map((function(t){var e=H6(t,u,c),i=e.x,n=e.y;return{x:i+=o,y:n+=s}}))}var h=e.getOption().getChart().getViewRect(),d=h.width,p=h.height;return n.map((function(t){return H6(t,d,p)}))}function U6(t){var e=1/0,i=-1/0,n=1/0,r=-1/0;return t.forEach((function(t){var a=t.getLayoutStartPoint(),o=t.getLayoutRect();a.x<e&&(e=a.x),a.x+o.width>i&&(i=a.x+o.width),a.y<n&&(n=a.y),a.y+o.height>r&&(r=a.y+o.height)})),{minX:e,maxX:i,minY:n,maxY:r}}function j6(t,e,i){var n=t.labelBackground,r=void 0===n?{}:n,a=t.style,o=t.shape,s=w(t,["labelBackground","style","shape"]);if(!1!==t.visible){var l=s;return(null==o?void 0:o.visible)?l.shape=M({visible:!0},vV(o.style)):l.shape={visible:!1},!1!==r.visible?(l.panel=M({visible:!0,customShape:r.customShape},W6(vV(r.style),e,i)),W(r.padding)&&(l.padding=rr(r.padding))):(l.panel={visible:!1},l.padding=0),a&&(l.textStyle=W6(vV(a),e,i)),l}return{visible:!1}}function V6(t,e,i){for(var n in t)U(t[n])&&(t[n]=t[n](e,i));return t}function W6(t,e,i){return U(t)?t(e,i):t}function G6(t,e){return U(t)?t(e):t}function Y6(t,e,i){return W(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function X6(t){return{isXProcess:W(t.x),isYProcess:W(t.y),isX1Process:W(t.x1),isY1Process:W(t.y1),isAngleProcess:W(t.angle),isRadiusProcess:W(t.radius),isAngle1Process:W(t.angle1),isRadius1Process:W(t.radius1),isCoordinatesProcess:W(t.coordinates),isValidProcess:W(t.process)}}function K6(t){var e=X6(t),i=e.isXProcess,n=e.isYProcess,r=e.isX1Process,a=e.isY1Process,o=e.isAngleProcess,s=e.isRadiusProcess,l=e.isAngle1Process,u=e.isRadius1Process,c=e.isCoordinatesProcess,h=e.isValidProcess;return{doXProcess:i&&!n&&!a,doXYY1Process:i&&n&&a,doYProcess:n&&!i&&!r,doYXX1Process:n&&i&&r,doXYProcess:i&&n&&r&&a,doAngleProcess:o&&!l&&!s&&!u,doRadiusProcess:s&&!u&&!o&&!l,doAngRadRad1Process:o&&!l&&s&&u,doRadAngAng1Process:s&&o&&l&&!u,doRadAngProcess:o&&s&&l&&u,doCoordinatesProcess:c&&(!h||"process"in t&&"xy"in t.process)}}function q6(t){var e=X6(t),i=e.isXProcess,n=e.isYProcess,r=e.isX1Process,a=e.isY1Process,o=e.isAngleProcess,s=e.isRadiusProcess,l=e.isAngle1Process,u=e.isRadius1Process;return{doXProcess:i&&r&&!n&&!a,doYProcess:n&&a&&!i&&!r,doXYProcess:i&&r&&n&&a,doAngleProcess:o&&l&&!s&&!u,doRadiusProcess:s&&u&&!o&&!l,doRadAngProcess:o&&s&&l&&u,doCoordinatesProcess:e.isCoordinatesProcess}}function Z6(t){return{doXYProcess:W(t.x)&&W(t.y),doPolarProcess:W(t.angle)&&W(t.radius),doGeoProcess:W(t.areaName)}}function J6(t,e){var i;if(e.coordinates){var n,r=e,a=r.coordinates,o=r.coordinateType,s=r.getSeriesByIdOrIndex,l=w(r,["coordinates","coordinateType","getSeriesByIdOrIndex"]),u=void 0;if(U(a)){var c=e.getRelativeSeries();u=a(c.getData().getLatestData(),c)}else u=a;i=(u=Dt(u)).map((function(t){var e=s(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===o){var i=e.getSpec(),r=i.xField,a=i.yField,u=t.xFieldDim,c=t.xFieldIndex,h=t.yFieldDim,d=t.yFieldIndex,p=r;W(c)&&(p=Dt(r)[c]),u&&Dt(r).includes(u)&&(p=u);var f=a;W(d)&&(f=Dt(a)[d]),h&&Dt(a).includes(h)&&(f=h),n=M({x:void 0,y:void 0},l),q(t[p])&&R6(t[p])?n.x={field:p,aggrType:t[p]}:n.x=Dt(p).map((function(e){return t[e]})),q(t[f])&&R6(t[f])?n.y={field:f,aggrType:t[f]}:n.y=Dt(f).map((function(e){return t[e]}))}else if("polar"===o){var v=e.getSpec(),g=v.valueField,y=v.categoryField,m=t.angleFieldDim,_=t.angleFieldIndex,b=y;W(_)&&(b=Dt(y)[_]),m&&Dt(y).includes(m)&&(b=m);var x=g;n=M({angle:void 0,radius:void 0},l),q(t[b])&&R6(t[b])?n.angle={field:b,aggrType:t[b]}:n.angle=Dt(b).map((function(e){return t[e]})),q(t[x])&&R6(t[x])?n.radius={field:x,aggrType:t[x]}:n.radius=Dt(x).map((function(e){return t[e]}))}return n.getRefRelativeSeries=function(){return e},n}))}else i=e;var h=[];return i.forEach((function(e){var i={x:null,y:null,angle:null,radius:null,areaName:null};if(W(e.x)){var n=e.x;Z(n)?i.x=n.map((function(i){return $6(i,t,e)})):i.x=$6(n,t,e)}if(W(e.y)){var r=e.y;Z(r)?i.y=r.map((function(i){return $6(i,t,e)})):i.y=$6(r,t,e)}if(W(e.angle)){var a=e.angle;Z(a)?i.angle=a.map((function(i){return $6(i,t,e)})):i.angle=$6(a,t,e)}if(W(e.radius)){var o=e.radius;Z(o)?i.radius=o.map((function(i){return $6(i,t,e)})):i.radius=$6(o,t,e)}if(W(e.areaName)){var s=e.areaName;i.areaName=$6(s,t,e)}e.getRefRelativeSeries&&(i.getRefRelativeSeries=e.getRefRelativeSeries),h.push(i)})),h}var Q6={min:function(t,e){return iU(t[0].latestData,e.field)},max:function(t,e){return nU(t[0].latestData,e.field)},sum:function(t,e){return rU(t[0].latestData,e.field)},average:function(t,e){return aU(t[0].latestData,e.field)},variance:function(t,e){return oU(t[0].latestData,e.field)},standardDeviation:function(t,e){return function(t,e){return Math.sqrt(oU(t,e))}(t[0].latestData,e.field)},median:function(t,e){return function(t,e){return Zt(t.map((function(t){return t[e]})))}(t[0].latestData,e.field)}};function $6(t,e,i){var n=i.getRelativeSeries(),r=i.getStartRelativeSeries(),a=i.getEndRelativeSeries(),o=n.getData().getLatestData(),s=r.getData().getLatestData(),l=a.getData().getLatestData();if(U(t))return t(o,s,l,n,r,a);if(X(t)){var u=t,c=u.aggrType,h=u.field;return Q6[c](e,{field:h})}return t}function t7(t,e){if(e&&e.getRelativeSeries){var i=e.getRelativeSeries();if(i){var n=i.getViewData();return n&&n.latestData&&n.latestData.length?t:[]}}return t}var e7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="none",e._layoutOffsetX=0,e._layoutOffsetY=0,e}return C(e,t),e.prototype.getRelativeSeries=function(){return this._relativeSeries},e.prototype.getMarkerData=function(){return this._markerData},e._getMarkerCoordinateType=function(t){return"cartesian"},e.getSpecInfo=function(t){var e=this;return wG(t,this.specKey,this.type,(function(t){return!1!==t.visible&&e._getMarkerCoordinateType(t)===e.coordinateType}))},e.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},e.prototype._buildMarkerAttributeContext=function(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}},e.prototype.created=function(){t.prototype.created.call(this),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()},e.prototype._getAllRelativeSeries=function(){var t=this;return{getRelativeSeries:function(){return t._relativeSeries},getStartRelativeSeries:function(){return t._startRelativeSeries},getEndRelativeSeries:function(){return t._endRelativeSeries}}},e.prototype._getFieldInfoFromSpec=function(t,e,i){return q(e)&&R6(e)?{field:i.getSpec()[{x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"}[t]],aggrType:e}:e},e.prototype._processSpecByDims=function(t){var e=this,i=this._relativeSeries,n={};return t.forEach((function(t){return n[t.dim]=e._getFieldInfoFromSpec(t.dim,t.specValue,i)})),M(M({},n),this._getAllRelativeSeries())},e.prototype._processSpecCoo=function(t){var e=this;return M(M({coordinates:t.coordinates||t.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:function(t,i){return e._getSeriesByIdOrIndex(t,i)},coordinateType:this.coordinateType})},e.prototype._getRelativeDataView=function(){if(this._specifiedDataSeries){var t=[];Dt(this._specifiedDataSeries).forEach((function(e){t=t.concat(e.getViewData().latestData)}));var e=new uc;return e.registerParser("array",I),new cc(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()},e.prototype.updateLayoutAttribute=function(){var e,i,n,r=this;if(null===(e=this._spec.visible)||void 0===e||e){if(!this._markerComponent){var a=this._createMarkerComponent();a.name=null!==(i=this._spec.name)&&void 0!==i?i:this.type,a.id=null!==(n=this._spec.id)&&void 0!==n?n:"".concat(this.type,"-").concat(this.id),this._markerComponent=a,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(function(t,e){r._delegateEvent(r._markerComponent,t,e,null,r.getMarkerData.bind(r))}))}this._markerLayout()}t.prototype.updateLayoutAttribute.call(this)},e.prototype._getSeriesByIdOrIndex=function(t,e){var i,n,r;return(r=null===(i=this._option.getSeriesInUserIdOrIndex(W(t)?[t]:[],[e]))||void 0===i?void 0:i[0])||(r=null!==(n=this._relativeSeries)&&void 0!==n?n:this._getFirstSeries()),r},e.prototype._bindSeries=function(){var t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))},e.prototype.initEvent=function(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))},e.prototype.clear=function(){t.prototype.clear.call(this),this._firstSeries=null},e.prototype._getFirstSeries=function(){var t;if(this._firstSeries)return this._firstSeries;var e=vU(this._regions);return e?(this._firstSeries=e,e):(null===(t=this._option)||void 0===t||t.onError("need at least one series"),null)},e.prototype._getNeedClearVRenderComponents=function(){return[this._markerComponent]},e.prototype.onLayoutStart=function(e,i){j(this._spec.offsetX)||(this._layoutOffsetX=HU(this._spec.offsetX,i.width,i)),j(this._spec.offsetY)||(this._layoutOffsetY=HU(this._spec.offsetY,i.height,i)),t.prototype.onLayoutStart.call(this,e,i)},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return St(i,e)||(n.reRender=!0,n.reMake=!0,n.change=!0),n},e.prototype._initCommonDataView=function(){var t=this,e=this._computeOptions().options,i=this._getRelativeDataView();EV(this._option.dataSet,"markerAggregation",J6),EV(this._option.dataSet,"markerFilter",t7);var n=new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});n.parse([i],{type:"dataview"}),n.transform({type:"markerAggregation",options:e}),n.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),n.target.on("change",(function(){t._markerLayout()})),this._markerData=n},e}(CX);function i7(t,e){return function(t,e,i){var n,r,a=We(t,(function(t){return t[e]}),(function(t){return t[i]})).predict,o=iU(t,e),s=nU(t,e),l=a(o),u=a(s);return[(n={},n[e]=o,n[i]=l,n),(r={},r[e]=s,r[i]=u,r)]}(t[0].latestData,e.fieldX,e.fieldY)}var n7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.specKey="markLine",i.layoutZIndex=t.LayoutZIndex.MarkLine,i}return C(i,e),i._getMarkerCoordinateType=function(t){var e=K6(t),i=e.doAngleProcess,n=e.doRadiusProcess,r=e.doAngRadRad1Process,a=e.doRadAngAng1Process,o=e.doRadAngProcess;return"polar"===t.coordinateType||i||n||r||a||o?"polar":"cartesian"},i.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p=this,f=this._spec,v=f.startSymbol,g=void 0===v?{}:v,y=f.endSymbol,m=void 0===y?{}:y,_=Dt(null!==(t=this._spec.label)&&void 0!==t?t:{}),b={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(n=this._spec.interactive)||void 0===n||n,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:W6(vV(null===(r=this._spec.line)||void 0===r?void 0:r.style),this._markerData,this._markAttributeContext),clipInRange:null!==(a=this._spec.clip)&&void 0!==a&&a,label:_.map((function(t){return j6(t,p._markerData,p._markAttributeContext)})),state:{line:V6(null!==(s=null===(o=this._spec.line)||void 0===o?void 0:o.state)&&void 0!==s?s:{},this._markerData,this._markAttributeContext),lineStartSymbol:V6(null!==(u=null===(l=this._spec.startSymbol)||void 0===l?void 0:l.state)&&void 0!==u?u:{},this._markerData,this._markAttributeContext),lineEndSymbol:V6(null!==(h=null===(c=this._spec.endSymbol)||void 0===c?void 0:c.state)&&void 0!==h?h:{},this._markerData,this._markAttributeContext),label:_.map((function(t){var e;return V6(null!==(e=t.state)&&void 0!==e?e:{},p._markerData,p._markAttributeContext)})),labelBackground:_.map((function(t){var e,i;return V6(null!==(i=null===(e=t.labelBackground)||void 0===e?void 0:e.state)&&void 0!==i?i:{},p._markerData,p._markAttributeContext)}))},animation:null!==(d=this._spec.animation)&&void 0!==d&&d,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return g.visible?b.startSymbol=M(M({},g),{visible:!0,style:W6(vV(g.style),this._markerData,this._markAttributeContext)}):b.startSymbol={visible:!1},m.visible?b.endSymbol=M(M({},m),{visible:!0,style:W6(vV(m.style),this._markerData,this._markAttributeContext)}):b.endSymbol={visible:!1},this._newMarkLineComponent(b)},i.prototype._getUpdateMarkerAttrs=function(){var t,e,i,n=this._spec,r=this._markerData,a=this._startRelativeSeries,o=this._endRelativeSeries,s=this._relativeSeries,l=this._computePointsAttr(),u=s.getViewData().latestData,c=r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData;if(n.clip||Dt(n.label).some((function(t){return null==t?void 0:t.confine}))){var h=U6([a.getRegion(),o.getRegion(),s.getRegion()]),d=h.minX,p=h.maxX,f=h.minY;i={x:d,y:f,width:p-d,height:h.maxY-f}}var v=Dt((null!==(e=null===(t=this._markerComponent)||void 0===t?void 0:t.attribute)&&void 0!==e?e:{}).label),g=Dt(this._spec.label),y=v.map((function(t,e){var i=g[e]||{};return M(M({},t),{text:i.formatMethod?i.formatMethod(c,u):null==t?void 0:t.text})}));return M(M({},l),{label:y,limitRect:i,dx:this._layoutOffsetX,dy:this._layoutOffsetY})},i.prototype._markerLayout=function(){var t,e=this._getUpdateMarkerAttrs();null===(t=this._markerComponent)||void 0===t||t.setAttributes(e)},i.prototype._initDataView=function(){var t=this,e=this._spec,i="coordinates"in e,n=K6(e),r=n.doXProcess,a=n.doYProcess,o=n.doXYY1Process,s=n.doYXX1Process,l=n.doXYProcess,u=n.doAngleProcess,c=n.doRadiusProcess,h=n.doAngRadRad1Process,d=n.doRadAngAng1Process,p=n.doRadAngProcess;if(this._markerData=this._getRelativeDataView(),r||a||o||s||l||u||c||h||d||p||i){EV(this._option.dataSet,"markerAggregation",J6),EV(this._option.dataSet,"markerRegression",i7),EV(this._option.dataSet,"markerFilter",t7);var f=this._computeOptions(),v=f.options,g=f.needAggr,y=f.needRegr,m=f.processData,_=new cc(this._option.dataSet);_.parse([m],{type:"dataview"}),g&&_.transform({type:"markerAggregation",options:v}),y&&_.transform({type:"markerRegression",options:v}),_.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),_.target.on("change",(function(){t._markerLayout()})),this._markerData=_}},i.specKey="markLine",i}(e7),r7=function(t){return{visible:t,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}},a7={style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}},refY:5},o7={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:r7(!1),endSymbol:r7(!0),label:a7},s7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.markLine,e.name=L.markLine,e.coordinateType="cartesian",e}return C(e,t),e.prototype._newMarkLineComponent=function(t){return new eN(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=W(e.coordinates),s=W(e.process),l=s&&W(e.process.x),u=s&&W(e.process.y),c=W(e.positions),h=null!==(t=e.autoRange)&&void 0!==t&&t,d=K6(e),p=d.doXProcess,f=d.doYProcess,v=d.doXYY1Process,g=d.doYXX1Process,y=d.doXYProcess,m=d.doCoordinatesProcess,_=[];if(p||v||f||g||y||o&&l||o&&u){var b=L6(i,n,r,a,h);_=1===b.length?b[0]:b.map((function(t){return t[0]}))}else m?_=O6(i,a,h,e.coordinatesOffset):c&&(_=N6(e.positions,a,e.regionRelative));return{points:_}},e.prototype._markerLayout=function(){var t,e,i,n,r,a=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){var o=this._startRelativeSeries,s=this._endRelativeSeries,l=this._spec.line||{},u=l.multiSegment,c=l.mainSegmentIndex,h=this._spec,d=h.connectDirection,p=h.expandDistance,f=void 0===p?0:p,v=void 0;if(OU(f)){var g=o.getRegion(),y=g.getLayoutStartPoint(),m=s.getRegion(),_=m.getLayoutStartPoint();if("bottom"===d||"top"===d){var b=Math.abs(Math.min(y.y,_.y)-Math.max(y.y+g.getLayoutRect().height,_.y+m.getLayoutRect().height));v=Number(f.substring(0,f.length-1))*b/100}else{var x=Math.abs(Math.min(y.x,_.x)-Math.max(y.x+g.getLayoutRect().width,_.x+m.getLayoutRect().width));v=Number(f.substring(0,f.length-1))*x/100}}else v=f;var k=a.points,S=a.limitRect;if(!k||k.length<2)return void(null===(t=this._markerComponent)||void 0===t||t.setAttributes(a));var A,C=function(t,e,i,n){void 0===n&&(n=0);var r=[],a=t.y-e.y,o=t.x-e.x;switch(i){case"top":r.push(t),r.push({x:t.x,y:a>0?t.y-n-Math.abs(a):t.y-n}),r.push({x:e.x,y:a>0?e.y-n:e.y-n-Math.abs(a)}),r.push(e);break;case"bottom":r.push(t),r.push({x:t.x,y:a<0?t.y+n+Math.abs(a):t.y+n}),r.push({x:e.x,y:a<0?e.y+n:e.y+n+Math.abs(a)}),r.push(e);break;case"left":r.push(t),r.push({x:o>0?t.x-n-Math.abs(o):t.x-n,y:t.y}),r.push({x:o>0?e.x-n:e.x-n-Math.abs(o),y:e.y}),r.push(e);break;case"right":r.push(t),r.push({x:o>0?t.x+n:t.x+n+Math.abs(o),y:t.y}),r.push({x:o>0?e.x+n+Math.abs(o):e.x+n,y:e.y}),r.push(e)}return r}(k[0],k[1],d,v);A=u&&W(c)?{position:"middle",autoRotate:!1}:M({position:"start",autoRotate:!1},function(t,e,i,n){void 0===n&&(n=0);var r=t.y-e.y,a=t.x-e.x;return"bottom"===i?{dx:a>0?-a/2:Math.abs(a/2),dy:r>0?n:Math.abs(r)+n}:"top"===i?{dx:a>0?-Math.abs(a/2):+Math.abs(a/2),dy:r>0?-(Math.abs(r)+n):-n}:"left"===i?{dx:a>0?-a-n:-n,dy:r>0?-r/2:Math.abs(r/2)}:"right"===i?{dx:a>0?n:Math.abs(a)+n,dy:r>0?-r/2:Math.abs(r/2)}:{}}(k[0],k[1],d,v));var w=Dt((null!==(i=null===(e=this._markerComponent)||void 0===e?void 0:e.attribute)&&void 0!==i?i:{}).label),T=Dt(a.label),D=Dt(this._spec.label);null===(n=this._markerComponent)||void 0===n||n.setAttributes({points:u?[[C[0],C[1]],[C[1],C[2]],[C[2],C[3]]]:C,label:T.map((function(t,e){var i,n,r,a,o=0,s=0,l=null!==(i=A.dx)&&void 0!==i?i:0,u=null!==(n=A.dy)&&void 0!==n?n:0,c=null!==(r=D[e])&&void 0!==r?r:D[0];return it(null==c?void 0:c.refX)&&(o+=c.refX),it(null==c?void 0:c.refY)&&(s+=c.refY),it(null==c?void 0:c.dx)&&(l+=c.dx),it(null==c?void 0:c.dy)&&(u+=c.dy),M(M(M({},t),A),{refX:o,refY:s,dx:l,dy:u,textStyle:M(M({},null===(a=w[e])||void 0===a?void 0:a.textStyle),{textAlign:"center",textBaseline:"middle"})})})),limitRect:S,multiSegment:u,mainSegmentIndex:c,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null===(r=this._markerComponent)||void 0===r||r.setAttributes(a)},e.prototype._computeOptions=function(){var t,e=this._getRelativeDataView(),i=!0,n=!1,r=this._spec,a=this._relativeSeries,o=K6(r),s=o.doXProcess,l=o.doYProcess,u=o.doXYY1Process,c=o.doYXX1Process,h=o.doXYProcess,d=o.doCoordinatesProcess;if(h)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x1},{dim:"y",specValue:r.y1}])];else if(s)t=[this._processSpecByDims([{dim:"x",specValue:r.x}])];else if(l)t=[this._processSpecByDims([{dim:"y",specValue:r.y}])];else if(u)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y1}])];else if(c)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x1},{dim:"y",specValue:r.y}])];else if(d){if(t=this._processSpecCoo(r),i=!1,e=new cc(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")}).parse([a.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),r.process&&W(r.process.x)&&(t=[this._processSpecByDims([{dim:"x",specValue:r.process.x}])],i=!0),r.process&&W(r.process.y)&&(t=t=[this._processSpecByDims([{dim:"y",specValue:r.process.y}])],i=!0),r.process&&W(r.process.xy)){var p=a.getSpec();t={fieldX:p.xField,fieldY:p.yField},n=!0}}else i=!1;return{options:t,needAggr:i,needRegr:n,processData:e}},e.type=L.markLine,e.coordinateType="cartesian",e.builtInTheme={markLine:o7},e}(n7),l7=function(){ij.registerComponent(s7.type,s7),tN()},u7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.polarMarkLine,e.name=L.polarMarkLine,e.coordinateType="polar",e}return C(e,t),e.prototype._newMarkLineComponent=function(t){var e=K6(this._spec),i=e.doRadiusProcess,n=e.doRadAngAng1Process;return i||n?new rN(t):new eN(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=null!==(t=e.autoRange)&&void 0!==t&&t,s=K6(e),l=s.doAngleProcess,u=s.doRadiusProcess,c=s.doAngRadRad1Process,h=s.doRadAngAng1Process,d=s.doRadAngProcess,p=s.doCoordinatesProcess,f=[],v={},g={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(l||u||c||h||d){var y=F6(i,n,r,a,o);f=1===y.length?y[0]:y.map((function(t){return t[0]})),v=f[0].radius===f[1].radius?{radius:f[0].radius,startAngle:f[0].angle,endAngle:f[1].angle,center:g}:{points:f.map((function(t){return Pi(g,t.radius,t.angle)}))}}else p&&(v={points:(f=z6(i,a,o)).map((function(t){return Pi(g,t.radius,t.angle)}))});return v},e.prototype._computeOptions=function(){var t,e=this._spec,i=K6(e),n=i.doAngleProcess,r=i.doRadiusProcess,a=i.doAngRadRad1Process,o=i.doRadAngAng1Process,s=i.doRadAngProcess,l=i.doCoordinatesProcess,u=this._getRelativeDataView();return s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:o?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:l&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:u}},e.type=L.polarMarkLine,e.coordinateType="polar",e.builtInTheme={polarMarkLine:o7},e}(n7),c7=function(){ij.registerComponent(u7.type,u7),rN._animate=IH,tN()},h7={padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}},d7=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=L.title,r.specKey=L.title,r.layoutType="normal",r.layoutZIndex=t.LayoutZIndex.Title,r.layoutLevel=t.LayoutLevel.Title,r._orient="top",r._orient=FU(i.orient)?i.orient:"top",r}return C(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},i.getSpecInfo=function(t){return wG(t,this.specKey,L.title,(function(t){return!1!==t.visible}))},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return(null==i?void 0:i.orient)===(null==t?void 0:t.orient)&&(null==i?void 0:i.visible)===t.visible||(n.reMake=!0),n.change=!0,n.reRender=!0,n},i.prototype.afterSetLayoutStartPoint=function(t){it(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),it(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),e.prototype.afterSetLayoutStartPoint.call(this,t)},i.prototype.getBoundsInRect=function(t){var e;this.setLayoutRect(t);var i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();var n=this.getLayoutStartPoint(),r=n.x,a=n.y;return{x1:r,y1:a,x2:r+e.width,y2:a+e.height}},i.prototype._getTitleLayoutRect=function(){var t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:it(t.width())?t.width():0,height:this._spec.height?this._spec.height:it(t.height())?t.height():0}},i.prototype._getTitleAttrs=function(){var t,e,i,n,r,a,o,s;if(!1===this._spec.visible)return{visible:!1};var l=this.getLayoutRect(),u=HU(this._spec.width,l.width,null,l.width),c=HU(this._spec.maxWidth,l.width,null,l.width),h=Math.max(Math.min(u,c,l.width),0),d=M(M({},bt(this._spec,["padding"])),{textType:null!==(t=this._spec.textType)&&void 0!==t?t:"text",text:null!==(e=this._spec.text)&&void 0!==e?e:"",subtextType:null!==(i=this._spec.subtextType)&&void 0!==i?i:"text",subtext:null!==(n=this._spec.subtext)&&void 0!==n?n:"",x:null!==(r=this._spec.x)&&void 0!==r?r:0,y:null!==(a=this._spec.y)&&void 0!==a?a:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:h,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!==(o=this._spec.align)&&void 0!==o?o:"left",verticalAlign:null!==(s=this._spec.verticalAlign)&&void 0!==s?s:"top",textStyle:M({width:h,maxLineWidth:h},this._spec.textStyle),subtextStyle:M({maxLineWidth:h},this._spec.subtextStyle)});return W(this._spec.width)&&(d.textStyle.width=Math.max(u,l.width),d.subtextStyle.width=d.textStyle.width),d},i.prototype._createOrUpdateTitleComponent=function(t){var e=this;if(this._titleComponent)St(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{var i=this.getContainer(),n=new wN(t);n.name="title",i.add(n),this._titleComponent=n,n.on("*",(function(t,i){return e._delegateEvent(n,t,i)}))}return this._cacheAttrs=t,this._titleComponent},i.prototype._getNeedClearVRenderComponents=function(){return[this._titleComponent]},i.prototype.clear=function(){e.prototype.clear.call(this),this._cacheAttrs=null},i.type=L.title,i.specKey=L.title,i.builtInTheme={title:h7},i}(CX),p7=function(){ij.registerComponent(d7.type,d7)},f7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.specKey="markArea",i.layoutZIndex=t.LayoutZIndex.MarkArea,i}return C(i,e),i._getMarkerCoordinateType=function(t){var e=q6(t),i=e.doAngleProcess,n=e.doRadiusProcess,r=e.doRadAngProcess;return"polar"===t.coordinateType||i||n||r?"polar":"cartesian"},i.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l=this,u=Dt(null!==(t=this._spec.label)&&void 0!==t?t:{}),c={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(n=this._spec.interactive)||void 0===n||n,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:W6(vV(null===(r=this._spec.area)||void 0===r?void 0:r.style),this._markerData,this._markAttributeContext),clipInRange:null!==(a=this._spec.clip)&&void 0!==a&&a,label:u.map((function(t){return j6(t,l._markerData,l._markAttributeContext)})),state:{area:V6(null===(o=this._spec.area)||void 0===o?void 0:o.state,this._markerData,this._markAttributeContext),label:u.map((function(t){return V6(t.state,l._markerData,l._markAttributeContext)})),labelBackground:u.map((function(t){var e;return V6(null===(e=t.labelBackground)||void 0===e?void 0:e.state,l._markerData,l._markAttributeContext)}))},animation:null!==(s=this._spec.animation)&&void 0!==s&&s,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(c)},i.prototype._markerLayout=function(){var t,e,i=this._spec,n=this._markerData,r=this._startRelativeSeries,a=this._endRelativeSeries,o=this._relativeSeries,s=this._computePointsAttr(),l=this._getRelativeDataView().latestData,u=n?n.latestData[0]&&n.latestData[0].latestData?n.latestData[0].latestData:n.latestData:l;if(i.clip||Dt(i.label).some((function(t){return null==t?void 0:t.confine}))){var c=U6([r.getRegion(),a.getRegion(),o.getRegion()]),h=c.minX,d=c.maxX,p=c.minY;e={x:h,y:p,width:d-h,height:c.maxY-p}}if(this._markerComponent){var f=Dt(null===(t=this._markerComponent.attribute)||void 0===t?void 0:t.label),v=Dt(this._spec.label);this._markerComponent.setAttributes(M(M({},s),{label:f.map((function(t,e){var i=v[e]||{};return M(M({},t),{text:i.formatMethod?i.formatMethod(u,l):null==t?void 0:t.text})})),limitRect:e,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}},i.prototype._initDataView=function(){var t=q6(this._spec),e=t.doXProcess,i=t.doYProcess,n=t.doXYProcess,r=t.doAngleProcess,a=t.doRadiusProcess,o=t.doRadAngProcess,s=t.doCoordinatesProcess;if(!(e||i||n||r||a||o||s))return null;this._initCommonDataView()},i.specKey="markArea",i}(e7),v7={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},g7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.markArea,e.name=L.markArea,e.coordinateType="cartesian",e}return C(e,t),e.prototype._newMarkAreaComponent=function(t){return new nN(t)},e.prototype._computePointsAttr=function(){var t,e,i=this._spec,n=this._markerData,r=this._startRelativeSeries,a=this._endRelativeSeries,o=this._relativeSeries,s=q6(i),l=s.doXProcess,u=s.doYProcess,c=s.doXYProcess,h=s.doCoordinatesProcess,d=W(i.positions),p=null!==(t=i.autoRange)&&void 0!==t&&t,f=null!==(e=i.includeFullBand)&&void 0!==e&&e,v=[];if(c){var g=B(L6(n,r,a,o,p,f),2),y=g[0],m=g[1];y&&y.length&&m&&m.length&&(v=[{x:y[0].x,y:m[0].y},y[0],{x:m[0].x,y:y[0].y},m[0]])}else if(l||u){var _=B(L6(n,r,a,o,p,f),2);y=_[0],m=_[1];y&&y.length&&m&&m.length&&(v=P(P([],B(y),!1),[m[1],m[0]],!1))}else h?v=O6(n,o,p,i.coordinatesOffset):d&&(v=N6(i.positions,o,i.regionRelative));return{points:v}},e.prototype._computeOptions=function(){var t,e=this._spec,i=q6(e),n=i.doXProcess,r=i.doYProcess,a=i.doXYProcess,o=i.doCoordinatesProcess;return a?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:n?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:o&&(t=this._processSpecCoo(e)),{options:t}},e.type=L.markArea,e.coordinateType="cartesian",e.builtInTheme={markArea:v7},e}(f7),y7=function(){ij.registerComponent(g7.type,g7),iN()},m7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.polarMarkArea,e.name=L.polarMarkArea,e.coordinateType="polar",e}return C(e,t),e.prototype._newMarkAreaComponent=function(t){var e=q6(this._spec),i=e.doRadiusProcess,n=e.doAngleProcess,r=e.doRadAngProcess;return n||i||r?new aN(t):new nN(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=q6(e),s=o.doAngleProcess,l=o.doRadiusProcess,u=o.doRadAngProcess,c=o.doCoordinatesProcess,h=null!==(t=e.autoRange)&&void 0!==t&&t,d={},p={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(s||l||u){var f=F6(i,n,r,a,h);u?d={innerRadius:f[0][0].radius,outerRadius:f[1][0].radius,startAngle:f[0][0].angle,endAngle:f[1][0].angle,center:p}:s?d={innerRadius:0,outerRadius:Math.abs(f[0][0].radius),startAngle:f[0][1].angle,endAngle:f[1][1].angle,center:p}:l&&(d={innerRadius:f[0][0].radius,outerRadius:f[1][0].radius,startAngle:f[0][0].angle,endAngle:f[1][1].angle,center:p})}else c&&(d={points:z6(i,a,h).map((function(t){return Pi(p,t.radius,t.angle)}))});return d},e.prototype._computeOptions=function(){var t,e=this._spec,i=q6(e),n=i.doAngleProcess,r=i.doRadiusProcess,a=i.doRadAngProcess,o=i.doCoordinatesProcess;return a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:o&&(t=this._processSpecCoo(e)),{options:t}},e.type=L.polarMarkArea,e.coordinateType="polar",e.builtInTheme={polarMarkArea:v7},e}(f7),_7=function(){ij.registerComponent(m7.type,m7),aN._animate=OH,iN()},b7=function(t){return vV(M({},t))},x7=function(t){return M(M({},t),{style:M({},vV(t.style))})},k7=function(t){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y=b7(null!==(i=null===(e=null==t?void 0:t.slider)||void 0===e?void 0:e.trackStyle)&&void 0!==i?i:{}),m=b7(null!==(r=null===(n=null==t?void 0:t.slider)||void 0===n?void 0:n.railStyle)&&void 0!==r?r:{}),_=(g=null!==(o=null===(a=null==t?void 0:t.slider)||void 0===a?void 0:a.handlerStyle)&&void 0!==o?o:{},vV(M({},g))),b=x7(null!==(l=null===(s=null==t?void 0:t.controller)||void 0===s?void 0:s.start)&&void 0!==l?l:{}),x=x7(null!==(c=null===(u=null==t?void 0:t.controller)||void 0===u?void 0:u.pause)&&void 0!==c?c:{}),k=x7(null!==(d=null===(h=null==t?void 0:t.controller)||void 0===h?void 0:h.backward)&&void 0!==d?d:{}),S=x7(null!==(f=null===(p=null==t?void 0:t.controller)||void 0===p?void 0:p.forward)&&void 0!==f?f:{}),A=M(M({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!==(v=t.orient)&&void 0!==v?v:"bottom",slider:M(M({},t.slider),{trackStyle:y,railStyle:m,handlerStyle:_}),controller:M(M({},t.controller),{start:b,pause:x,backward:k,forward:S})});return t.visible||(A.controller.visible=!1,A.slider.visible=!1),A},S7=function(t){return"left"===t||"right"===t},A7=function(t){return"top"===t||"bottom"===t},C7={visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}},M7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutZIndex=t.LayoutZIndex.Player,i.layoutLevel=t.LayoutLevel.Player,i.specKey="player",i.type=L.player,i._orient="bottom",i._getPlayerAttrs=function(){var t,e,n,r,a,o,s,l,u=i._spec.type,c={size:{width:i._width,height:i._height},dx:null!==(t=i._spec.dx)&&void 0!==t?t:0+i._dx,dy:null!==(e=i._spec.dy)&&void 0!==e?e:0+i._dy};return"discrete"===u?M(M(M({},(s=i._spec,l=i._specs,M(M({},k7(s)),{data:l,type:"discrete"}))),c),{disableTriggerEvent:i._option.disableTriggerEvent,loop:null===(r=null===(n=i._spec)||void 0===n?void 0:n.loop)||void 0===r||r}):M(M(M({},function(t,e){return M(M({},k7(t)),{data:e,type:"continuous"})}(i._spec,i._specs)),c),{disableTriggerEvent:i._option.disableTriggerEvent,loop:null===(o=null===(a=i._spec)||void 0===a?void 0:a.loop)||void 0===o||o})},i._createOrUpdatePlayerComponent=function(){var t=M({},i._getPlayerAttrs()),e=i.getContainer();i._playerComponent?St(t,i._cacheAttrs)||(i._cacheAttrs=t,i._playerComponent.setAttributes(t),i._playerComponent._initAttributes(),i._playerComponent.render()):("discrete"===t.type?i._playerComponent=new VN(t):i._playerComponent=new YN(t),i._cacheAttrs=t,i._playerComponent.name="player",e.add(i._playerComponent),i._initEvent())},i._maxSize=function(){var t,e,n,r,a,o,s,l,u;return Math.max.apply(Math,P(P(P(P(P([],B(Dt(null===(e=null===(t=i._spec.controller.start)||void 0===t?void 0:t.style)||void 0===e?void 0:e.size)),!1),B(Dt(null===(r=null===(n=i._spec.controller.pause)||void 0===n?void 0:n.style)||void 0===r?void 0:r.size)),!1),B(Dt(null===(o=null===(a=i._spec.controller.backward)||void 0===a?void 0:a.style)||void 0===o?void 0:o.size)),!1),B(Dt(null===(l=null===(s=i._spec.controller.forward)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)),!1),[null!==(u=S7(i._orient)?i._spec.slider.railStyle.width:i._spec.slider.railStyle.height)&&void 0!==u?u:10],!1))},i._sliderExceededSize=function(){var t,e,n,r,a,o,s,l,u,c=null!==(t=S7(i._orient)?i._spec.slider.railStyle.width:i._spec.slider.railStyle.height)&&void 0!==t?t:10,h=Math.max.apply(Math,P(P(P(P([],B(Dt(null===(n=null===(e=i._spec.controller.start)||void 0===e?void 0:e.style)||void 0===n?void 0:n.size)),!1),B(Dt(null===(a=null===(r=i._spec.controller.pause)||void 0===r?void 0:r.style)||void 0===a?void 0:a.size)),!1),B(Dt(null===(s=null===(o=i._spec.controller.backward)||void 0===o?void 0:o.style)||void 0===s?void 0:s.size)),!1),B(Dt(null===(u=null===(l=i._spec.controller.forward)||void 0===l?void 0:l.style)||void 0===u?void 0:u.size)),!1));return c>=h?c-h:0},i._initEvent=function(){i._option.disableTriggerEvent||(i._option.globalInstance.on(t.ChartEvent.rendered,(function(){var t;(null===(t=i._spec)||void 0===t?void 0:t.auto)&&(i._playerComponent.pause(),i._playerComponent.play())})),i._playerComponent.addEventListener(IN.end,(function(){var e;i.event.emit(t.ChartEvent.playerEnd,{model:i}),i._alternate&&"discrete"===i._spec.type&&(i._direction="default"===i._direction?"reverse":"default",i._playerComponent.setAttributes({direction:i._direction,dataIndex:"reverse"===i._direction?i._specs.length-2:1})),(null===(e=i._spec)||void 0===e?void 0:e.loop)&&i._playerComponent.play()})),i._playerComponent.addEventListener(IN.change,(function(t){var e=t.detail.index;i.changePlayerIndex(e)})),i._playerComponent.addEventListener(IN.backward,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerBackward,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(IN.forward,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerForward,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(IN.play,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerPlay,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(IN.pause,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerPause,{model:i,value:{spec:r,index:n,specs:i._specs}})})))},i}return C(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"layoutOrient",{set:function(t){this._orient=t},enumerable:!1,configurable:!0}),i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o,s,l;e.prototype.setAttrFromSpec.call(this),this._orient=null!==(t=this._spec.orient)&&void 0!==t?t:"bottom",this._specs=null!==(i=this._spec.specs)&&void 0!==i?i:[],this._direction=null!==(n=this._spec.direction)&&void 0!==n?n:"default",this._alternate=null!==(r=this._spec.alternate)&&void 0!==r&&r,this._dx=null!==(a=this._spec.dx)&&void 0!==a?a:0,this._dy=null!==(o=this._spec.dy)&&void 0!==o?o:0,this._position=null!==(s=this._spec.position)&&void 0!==s?s:"middle",this._visible=null===(l=this._spec.visible)||void 0===l||l},i.prototype.afterSetLayoutStartPoint=function(t){if(e.prototype.afterSetLayoutStartPoint.call(this,t),it(t.x)){var i=S7(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",i)}if(it(t.y)){var n=A7(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",n)}},i.prototype.getBoundsInRect=function(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);var i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i},i.prototype._getNeedClearVRenderComponents=function(){return[this._playerComponent]},i.prototype._computeLayoutRect=function(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}},i.prototype._computeWidth=function(t){return $(this._spec.width)?Math.min(t.width,Number(this._spec.width)):S7(this._orient)?this._maxSize():t.width},i.prototype._computeHeight=function(t){return $(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):A7(this._orient)?this._maxSize():t.height},i.prototype._computeDx=function(t){return S7(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width},i.prototype._computeDy=function(t){return A7(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height},i.prototype.changePlayerIndex=function(e){var i=this._specs[e];this._option.globalInstance.updateFullData(i.data),this.event.emit(t.ChartEvent.playerChange,{model:this,value:{spec:i,index:e,specs:this._specs}})},i.builtInTheme={player:C7},i.specKey="player",i.type=L.player,i}(CX),w7=function(){ij.registerComponent(M7.type,M7)},T7=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=L.label,r.name=L.label,r.layoutType="none",r.layoutZIndex=t.LayoutZIndex.Label,r._regions=n.getRegionsInIndex(n.regionIndexes),r}return C(i,e),i.prototype._interactiveConfig=function(t){var e=t.interactive,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;var n=this._option.getChart().getSpec(),r=n.hover,a=n.select;return!1===r&&!1===r.enable||(i.hover=!0),!1===a&&!1===a.enable||(i.select=!0),i},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,St(i,t)||(n.reMake=!0),n},i.prototype._getDataLabelType=function(t,e){var i=t.type;return"line"===i||"area"===i?null!=e?e:"line-data":"rect"===i?"rect":"arc"===i?"arc":"symbol"===i||"cell"===i?"symbol":t.setDataLabelType?t.setDataLabelType():""},i.prototype._setTransformOfComponent=function(t,e){var i=this;t.setAttributeTransform((function(t){var n=t.labelStyle,r=t.size,a=t.itemEncoder,o=r(),s=AU({type:"palette",key:"secondaryFontColor"},i.getColorScheme()),l=Dt(e).map((function(t,e){var r=n(e),l=[],u=t.getGraphics();if(u)return r.data&&r.data.length?r.data.forEach((function(t,i){if(u[i]){var n=a(t,{labelIndex:e});j(n.fill)&&(n.fill=s),j(n.data)&&(n.data=t),l.push(n)}})):u.forEach((function(t){var i=t.context,n=i.data;i.diffState!==AW.exit&&n.forEach((function(t,i){var n=a(t,{labelIndex:e});j(n.fill)&&(n.fill=s),j(n.data)&&(n.data=t),l.push(n)}))})),X(r.overlap)&&j(r.overlap.size)&&(r.overlap.size=M({},o)),M(M({smartInvert:!1,baseMarkGroupName:t.getProductId(),getBaseMarks:function(){return u}},r),{type:i._getDataLabelType(t,r.type),data:l})}));return{dataLabels:l,size:o}}))},i.prototype.getVRenderComponents=function(){var t=[];return this.getMarks().forEach((function(e){var i=e.getComponent();i&&t.push(i)})),t},i.prototype.clear=function(){e.prototype.clear.call(this),this.getMarks().forEach((function(t){t&&t.clearComponent()}))},i.type=L.label,i}(CX),D7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skipEncode=!1,e}return C(e,t),e.prototype.getRule=function(){return this._rule},e.prototype.setRule=function(t){this._rule=t},e.prototype.getTarget=function(){return this._target},e.prototype.setTarget=function(t){this._target=t,this._rule||this.setRule(t.type)},e.prototype.getComponent=function(){return this._component},e.prototype.setComponent=function(t){this._component=t},e.prototype.render=function(){},e.type="text",e.constructorType="label",e}(MJ),E7=function(){wJ(),ij.registerMark(D7.constructorType,D7)},B7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(AX),P7=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=L.label,r.name=L.label,r.specKey="label",r.transformerConstructor=B7,r.layoutZIndex=t.LayoutZIndex.Label,r._layoutRule=i.labelLayout||"series",r}return C(i,e),i.getSpecInfo=function(t,e){var i=this,n=[],r=(null==e?void 0:e.region)||[];return r.forEach((function(r,a){var o=(r.seriesIndexes||[]).some((function(t){var i=e.series[t].markLabelSpec,n=void 0===i?{}:i;return Object.values(n).some((function(t){return Array.isArray(t)&&function(t){return t.some((function(t){return t.visible}))}(t)}))}));o&&n.push({spec:t,type:L.label,specInfoPath:["component",i.specKey,a],regionIndexes:[a]})})),n},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._labelInfoMap&&(this._labelInfoMap.forEach((function(t){t.forEach((function(t){t.labelMark.release()}))})),this._labelInfoMap.clear()),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.dataZoomChange,(function(){e._labelComponentMap.forEach((function(t,e){var i=e.getComponent();i&&i.disableAnimation()})),e.event.on(gV.AFTER_MARK_RENDER_END,i)}));var i=function(){e._labelComponentMap.forEach((function(t,e){var i=e.getComponent();i&&i.enableAnimation()})),e.event.off(gV.AFTER_MARK_RENDER_END,i)}},i.prototype._initTextMark=function(){var t=this;this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),cU(this._regions,(function(e){var i=e.getSpecInfo().markLabelSpec,n=void 0===i?{}:i,r=Object.keys(n),a=e.getRegion();t._labelInfoMap.get(a)||t._labelInfoMap.set(a,[]);for(var o=function(i){var o=r[i],s=e.getMarkInName(o);if(!s)return"continue";n[o].forEach((function(i,n){var r,l,u;if(i.visible){var c=t._labelInfoMap.get(a),h=t._createMark({type:"label",name:"".concat(null!==(r=e.userId)&&void 0!==r?r:e.id,"-").concat(o,"-label-").concat(n)},{attributeContext:e.getMarkAttributeContext()});i.showRelatedMarkTooltip&&(null===(u=null===(l=e.tooltipHelper)||void 0===l?void 0:l.activeTriggerSet.mark)||void 0===u||u.add(h)),h.setTarget(s),c.push({labelMark:h,baseMark:s,series:e,labelSpec:i})}}))},s=0;s<r.length;s++)o(s)}))},i.prototype._initLabelComponent=function(){var t=this,e={};this._labelComponentMap.forEach((function(t,i){e[i.name]=i})),this._labelInfoMap.forEach((function(i,n){if("region"===t._layoutRule){var r=!1,a="".concat(n.getGroupMark().name,"-label-component"),o=e[a];o||(r=!0,o=t._createMark({type:"component",name:a},{componentType:"label"},{support3d:t._spec.support3d})),o&&(r&&(o.setSkipBeforeLayouted(!0),t._marks.addMark(o),i.forEach((function(t){var e;null===(e=t.baseMark.getData())||void 0===e||e.addRelatedMark(o)}))),i[0]&&W(i[0].labelSpec.zIndex)&&o.setMarkConfig({zIndex:i[0].labelSpec.zIndex}),t._labelComponentMap.set(o,(function(){return t._labelInfoMap.get(n)})),e[a]=null)}else i.forEach((function(i,r){var a,o=!1,s="".concat(i.labelMark.name,"-component"),l=e[s];l||(o=!0,l=t._createMark({type:"component",name:s},{componentType:"label",noSeparateStyle:!0},{support3d:i.baseMark.getMarkConfig().support3d})),l&&(W(i.labelSpec.zIndex)&&l.setMarkConfig({zIndex:i.labelSpec.zIndex}),o&&(l.setSkipBeforeLayouted(!0),t._marks.addMark(l),null===(a=i.baseMark.getData())||void 0===a||a.addRelatedMark(l)),t._labelComponentMap.set(l,(function(){return t._labelInfoMap.get(n)[r]})),e[s]=null)}))})),Object.keys(e).forEach((function(i){var n=e[i];n&&(n.release(),t._labelComponentMap.delete(n))}))},i.prototype._initTextMarkStyle=function(){var e=this;this._labelComponentMap.forEach((function(t,e){Dt(t()).forEach((function(t){t.labelMark.setComponent(e)}))})),this._labelInfoMap.forEach((function(i){i.forEach((function(i){var n,r,a=i.labelMark,o=i.labelSpec,s=i.series;if(e.initMarkStyleWithSpec(a,o),U(null==o?void 0:o.getStyleHandler)){var l=o.getStyleHandler(s);null==l||l.call(s,a,o)}(null===(r=null===(n=a.stateStyle)||void 0===n?void 0:n.normal)||void 0===r?void 0:r.lineWidth)&&a.setAttribute("stroke",s.getColorAttribute(),"normal",t.AttributeLevel.Base_Series)}))}))},i.prototype.updateLayoutAttribute=function(){var t=this;e.prototype.updateLayoutAttribute.call(this),this._labelComponentMap.forEach((function(e,i){var n=e();Z(n)?t._updateMultiLabelAttribute(n,i):t._updateSingleLabelAttribute(n,i)}))},i.prototype._updateMultiLabelAttribute=function(t,e){this._updateLabelComponentAttribute(e,t.map((function(t){return t.baseMark})),t)},i.prototype._updateSingleLabelAttribute=function(t,e){var i=t.baseMark;this._updateLabelComponentAttribute(e,i,[t])},i.prototype._updateLabelComponentAttribute=function(t,e,i){var n=this,r=this._option.getComponentsByType("totalLabel");t.setMarkConfig({interactive:!1}),t.setSimpleStyle({labelStyle:function(t){var e,a,o=i[t],s=o.labelSpec,l=o.labelMark,u=o.series,c=l.getRule(),h=n._interactiveConfig(s),d=null!==(a=null===(e=n._spec)||void 0===e?void 0:e.centerOffset)&&void 0!==a?a:0,p=ej({textStyle:M({pickable:!0===s.interactive},s.style),overlap:{avoidMarks:r.map((function(t){return t.getMarks()[0].getProductId()}))}},WZ(c,o),M(M(M({},bt(s,["position","style","state","type","stackDataFilterType","getStyleHandler"])),h),{centerOffset:d}),s.stackDataFilterType?{dataFilter:"min"===s.stackDataFilterType?function(t){return t.filter((function(t){return t.data[Wj]}))}:function(t){return t.filter((function(t){return t.data[Vj]}))}}:{});return u&&u.parseLabelStyle&&(p=u.parseLabelStyle(p,s,l)),"line"!==c&&"area"!==c||(p.type=c),p},size:function(){var t;return M({padding:null===(t=i[0].labelSpec.overlap)||void 0===t?void 0:t.padding},i[0].series.getRegion().getLayoutRect())},itemEncoder:function(t,e){var n=e.labelIndex;return i[n]&&!i[n].labelMark.skipEncode?GZ(i[n],t,i[n].labelSpec.formatMethod,i[n].labelSpec.formatter):{data:t}}}),this._setTransformOfComponent(t,e)},i.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i,n=t._labelComponentMap.get(e)();i=Z(n)?n[0].series.getRegion().getGroupMark().getProduct():n.series.getRegion().getGroupMark().getProduct(),e.compile({group:i})}))},i.prototype.getLabelInfoByTextGraphic=function(t){var e,i=null==t?void 0:t.parent,n=null==i?void 0:i.parent;if(n){var r=n.getChildren().indexOf(i);this._labelComponentMap.forEach((function(t,i){i.getComponent()===n&&(e=Dt(t())[r])}))}return e},i.type=L.label,i.specKey="label",i.transformerConstructor=B7,i}(T7),R7=function(){ij.registerGraphicComponent(P7.type,(function(t){return new Qz(t)})),E7(),wX(),ij.registerComponent(P7.type,P7,!0,1/0)},L7={visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}},I7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=L.totalLabel,i.name=L.totalLabel,i.specKey="totalLabel",i.layoutZIndex=t.LayoutZIndex.Label,i}return C(i,e),i.getSpecInfo=function(t,e){var i,n=this,r=[];return null===(i=null==e?void 0:e.region)||void 0===i||i.forEach((function(t,i){var a;null===(a=t.seriesIndexes)||void 0===a||a.forEach((function(t){var a=e.series[t].spec[n.specKey];(null==a?void 0:a.visible)&&r.push({spec:a,type:L.totalLabel,specPath:["series",t,n.specKey],specInfoPath:["component",n.specKey,t],regionIndexes:[i],seriesIndexes:[t]})}))})),r},i.prototype.init=function(t){e.prototype.init.call(this,t),this._initTextMark(),this._initLabelComponent()},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._initTextMark()},i.prototype._initTextMark=function(){var t,e=this._getSeries();if(null===(t=e.getSpec().totalLabel)||void 0===t?void 0:t.visible){var i=e.getSeriesMark();if(i){var n=this._createMark({type:"label",name:"".concat(i.name,"-total-label")});this._baseMark=i,this._textMark=n,this._initTextMarkStyle()}}},i.prototype._initTextMarkStyle=function(){var i;e.prototype.initMarkStyleWithSpec.call(this,this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:function(t){return t[Uj]}},"normal",t.AttributeLevel.Default);var n=this._getSeries();null===(i=n.initTotalLabelMarkStyle)||void 0===i||i.call(n,this._textMark)},i.prototype._initLabelComponent=function(){var t,e=this._getSeries(),i=this._createMark({type:"component",name:"".concat(null!==(t=e.name)&&void 0!==t?t:e.type,"-total-label-component")},{componentType:"label"},{support3d:this._spec.support3d});i&&(this._marks.addMark(i),e.getData().addRelatedMark(i))},i.prototype.updateLayoutAttribute=function(){var t=this;e.prototype.updateLayoutAttribute.call(this);var i=this._getSeries();this._marks.forEach((function(e,n){e.setMarkConfig({interactive:!1}),e.setSimpleStyle({labelStyle:function(){var e,n;if(t._baseMark){var r=t._spec,a=r.offset,o=r.animation,s=r.overlap,l=r.position,u=void 0===l?"top":l,c=t._interactiveConfig(t._spec);return ej({textStyle:{pickable:!0===t._spec.interactive},position:F7(i,t._baseMark.type,u),x:0,y:0},null!==(n=null===(e=i.getTotalLabelComponentStyle)||void 0===e?void 0:e.call(i,{baseMark:t._baseMark,labelMark:t._textMark}))&&void 0!==n?n:{},M({offset:a,animation:o,overlap:s,dataFilter:function(t){return t.filter((function(t){return"bottom"===u?t.data[Wj]:t.data[Vj]}))}},c))}},size:function(){var e;return M({padding:null===(e=t._spec.overlap)||void 0===e?void 0:e.padding},t._regions[0].getLayoutRect())},itemEncoder:function(e){return GZ({baseMark:t._baseMark,labelMark:t._textMark,series:i,labelSpec:i.getSpec().totalLabel},e,t._spec.formatMethod)}}),t._setTransformOfComponent(e,t._baseMark)}))},i.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i=t._regions[0].getGroupMark().getProduct();e.compile({group:i,context:{model:t}})}))},i.prototype._getSeries=function(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]},i.type=L.totalLabel,i.builtInTheme={totalLabel:L7},i.specKey="totalLabel",i}(T7);function F7(t,e,i){var n,r,a;void 0===i&&(i="top");var o,s=t.direction;o="bottom"===i?{vertical:["bottom","top"],horizontal:["left","right"]}:{vertical:["top","bottom"],horizontal:["right","left"]};var l=("horizontal"===s?null===(n=t.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=t.getYAxisHelper())||void 0===r?void 0:r.isInverse())?1:0;switch(e){case"rect":case"symbol":a=o[s][l];break;default:a="top"}return a}var O7=function(){ij.registerGraphicComponent(I7.type,(function(t){return new Qz(t)})),E7(),wX(),ij.registerComponent(I7.type,I7,!0)},z7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.specKey="markPoint",i.layoutZIndex=t.LayoutZIndex.MarkPoint,i}return C(i,e),i._getMarkerCoordinateType=function(t){var e=Z6(t),i=e.doPolarProcess,n=e.doGeoProcess;return"polar"===t.coordinateType||i?"polar":"geo"===t.coordinateType||n?"geo":"cartesian"},i.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,C,T,D,E,B,P,R,L=this._spec,I=L.itemContent,F=void 0===I?{}:I,O=L.itemLine,z=void 0===O?{}:O,H=L.targetSymbol,N=void 0===H?{}:H,U=F,j=U.type,V=void 0===j?"text":j,W=U.text,G=U.symbol,Y=U.image,X=U.richText,K=U.customMark,q=U.textStyle,Z=U.symbolStyle,J=U.imageStyle,Q=U.richTextStyle,$=U.customMarkStyle,tt=U.style,et=void 0===tt?{}:tt,it=U.state,nt=void 0===it?{}:it,rt=w(U,["type","text","symbol","image","richText","customMark","textStyle","symbolStyle","imageStyle","richTextStyle","customMarkStyle","style","state"]),at=null,ot=null;"text"===V?(at=null!==(t=null==W?void 0:W.state)&&void 0!==t?t:nt,ot=j6(mt({dx:0,dy:0},null!==(e=null!=W?W:q)&&void 0!==e?e:et),this._markerData,this._markAttributeContext)):"richText"===V?(at=null!==(i=null==X?void 0:X.state)&&void 0!==i?i:nt,ot=W6(mt({width:100,height:100},null!==(r=null!==(n=null==X?void 0:X.style)&&void 0!==n?n:Q)&&void 0!==r?r:et),this._markerData,this._markAttributeContext)):"symbol"===V?(at=null!==(a=null==G?void 0:G.state)&&void 0!==a?a:nt,ot=vV(W6(mt({symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},null!==(s=null!==(o=null==G?void 0:G.style)&&void 0!==o?o:Z)&&void 0!==s?s:et),this._markerData,this._markAttributeContext))):"image"===V?(at=null!==(l=null==Y?void 0:Y.state)&&void 0!==l?l:nt,ot=W6(mt({width:80,height:80},null!==(c=null!==(u=null==Y?void 0:Y.style)&&void 0!==u?u:J)&&void 0!==c?c:et),this._markerData,this._markAttributeContext)):"custom"===V&&(at=null!==(h=null==K?void 0:K.state)&&void 0!==h?h:nt,ot=W6(null!==(p=null!==(d=null==K?void 0:K.style)&&void 0!==d?d:$)&&void 0!==p?p:et,this._markerData,this._markAttributeContext));var st={zIndex:this.layoutZIndex,interactive:null===(f=this._spec.interactive)||void 0===f||f,hover:null===(v=this._spec.interactive)||void 0===v||v,select:null===(g=this._spec.interactive)||void 0===g||g,position:{x:0,y:0},clipInRange:null!==(y=this._spec.clip)&&void 0!==y&&y,itemContent:M(M({type:V,offsetX:G6(F.offsetX,this._relativeSeries.getRegion()),offsetY:G6(F.offsetX,this._relativeSeries.getRegion())},rt),{style:W6(ot,this._markerData,this._markAttributeContext)}),targetSymbol:{offset:null!==(m=N.offset)&&void 0!==m?m:0,visible:null!==(_=N.visible)&&void 0!==_&&_,size:null!==(b=N.size)&&void 0!==b?b:20,style:W6(N.style,this._markerData,this._markAttributeContext)},state:{line:V6(null!==(k=null===(x=this._spec.itemLine.line)||void 0===x?void 0:x.state)&&void 0!==k?k:{},this._markerData,this._markAttributeContext),lineStartSymbol:V6(null!==(A=null===(S=this._spec.itemLine.startSymbol)||void 0===S?void 0:S.state)&&void 0!==A?A:{},this._markerData,this._markAttributeContext),lineEndSymbol:V6(null!==(T=null===(C=this._spec.itemLine.endSymbol)||void 0===C?void 0:C.state)&&void 0!==T?T:{},this._markerData,this._markAttributeContext),itemContent:V6(at,this._markerData,this._markAttributeContext),textBackground:V6(null===(E=null===(D=this._spec.itemContent.text)||void 0===D?void 0:D.labelBackground)||void 0===E?void 0:E.state,this._markerData,this._markAttributeContext),targetItem:V6(null!==(P=null===(B=this._spec.targetSymbol)||void 0===B?void 0:B.state)&&void 0!==P?P:{},this._markerData,this._markAttributeContext)},animation:null!==(R=this._spec.animation)&&void 0!==R&&R,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate},lt=z.visible,ut=z.line,ct=void 0===ut?{}:ut,ht=w(z,["visible","line"]);return st.itemLine=!1!==lt?M(M({},ht),{visible:!0,lineStyle:vV(ct.style)}):{visible:!1},new sN(st)},i.prototype._markerLayout=function(){var t,e,i,n,r,a,o=this._spec,s=this._markerData,l=this._relativeSeries,u=this._computePointsAttr().point,c=this._getRelativeDataView().latestData,h=s?s.latestData[0]&&s.latestData[0].latestData?s.latestData[0].latestData:s.latestData:c;if(o.clip||(null===(t=o.itemContent)||void 0===t?void 0:t.confine)){var d=U6([l.getRegion()]),p=d.minX,f=d.maxX,v=d.minY;a={x:p,y:v,width:f-p,height:d.maxY-v}}if(this._markerComponent){var g=null!==(e=this._markerComponent.attribute)&&void 0!==e?e:{},y=null!==(n=null===(i=g.itemContent)||void 0===i?void 0:i.textStyle)&&void 0!==n?n:{};this._markerComponent.setAttributes({position:void 0===u?{x:null,y:null}:u,itemContent:M(M({},g.itemContent),{textStyle:M(M({},y),{text:(null===(r=this._spec.itemContent.text)||void 0===r?void 0:r.formatMethod)?this._spec.itemContent.text.formatMethod(h,c):y.text}),offsetX:Y6(u,g.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:Y6(u,g.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:a,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}},i.prototype._initDataView=function(){var t=this._spec,e=Z6(t),i=e.doXYProcess,n=e.doPolarProcess,r=e.doGeoProcess;(W(t.coordinate)||i||n||r)&&this._initCommonDataView()},i.specKey="markPoint",i}(e7),H7={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}},N7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.markPoint,e.name=L.markPoint,e.coordinateType="cartesian",e}return C(e,t),e.prototype._computePointsAttr=function(){var t,e,i,n,r=this._spec,a=this._markerData,o=this._relativeSeries,s=W(r.x)&&W(r.y),l=W(r.coordinate),u=W(r.position),c=null!==(t=null==r?void 0:r.autoRange)&&void 0!==t&&t;return s?n=null===(i=null===(e=L6(a,o,o,o,c))||void 0===e?void 0:e[0])||void 0===i?void 0:i[0]:l?n=O6(a,o,c,r.coordinatesOffset)[0]:u&&(n=N6(r.position,o,r.regionRelative)[0]),{point:n}},e.prototype._computeOptions=function(){var t,e=this._spec,i=Z6(e).doXYProcess,n=W(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:n&&(t=this._processSpecCoo(e)),{options:t}},e.type=L.markPoint,e.coordinateType="cartesian",e.builtInTheme={markPoint:H7},e}(z7),U7=function(){ij.registerComponent(N7.type,N7),oN()},j7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.polarMarkPoint,e.name=L.polarMarkPoint,e.coordinateType="polar",e}return C(e,t),e.prototype._computePointsAttr=function(){var t,e,i=this._markerData,n=this._relativeSeries,r=F6(i,n,n,n,null!==(e=null===(t=this._spec)||void 0===t?void 0:t.autoRange)&&void 0!==e&&e)[0][0];return{point:Pi({x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y},r.radius,r.angle)}},e.prototype._computeOptions=function(){var t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}},e.type=L.polarMarkPoint,e.coordinateType="polar",e.builtInTheme={polarMarkPoint:H7},e}(z7),V7=function(){ij.registerComponent(j7.type,j7),oN()},W7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=L.geoMarkPoint,e.name=L.geoMarkPoint,e.coordinateType="geo",e}return C(e,t),e.prototype._computePointsAttr=function(){var t=function(t,e){var i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach((function(t){W(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])})),i}(this._markerData,this._relativeSeries)[0][0];return{point:t}},e.prototype._computeOptions=function(){var t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}},e.type=L.geoMarkPoint,e.coordinateType="geo",e.builtInTheme={geoMarkPoint:H7},e}(z7),G7=function(){ij.registerComponent(W7.type,W7),oN()},Y7={style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0},X7="inBrush",K7="outOfBrush",q7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutType="none",i.type=L.brush,i.name=L.brush,i.specKey="brush",i.layoutZIndex=t.LayoutZIndex.Brush,i._linkedSeries=[],i._itemMap={},i._linkedItemMap={},i._inBrushElementsMap={},i._outOfBrushElementsMap={},i._linkedInBrushElementsMap={},i._linkedOutOfBrushElementsMap={},i._cacheInteractiveRangeAttrs=[],i._releatedAxes=[],i._regionAxisMap={},i._axisDataZoomMap={},i._zoomRecord=[],i}return C(i,e),i.getSpecInfo=function(t){return wG(t,this.specKey,this.type,(function(t){return!1!==t.visible}))},i.prototype.init=function(){var e=this._transformBrushedMarkAttr(this._spec.inBrush),i=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach((function(n){n.getActiveMarks().forEach((function(r){r&&(n.setMarkStyle(r,M({},e),X7,t.AttributeLevel.Series),n.setMarkStyle(r,M({},i),K7,t.AttributeLevel.Series))}))}))},i.prototype._initNeedOperatedItem=function(){var t=this,e=this._spec.seriesId,i=this._spec.seriesIndex;this._relativeRegions.forEach((function(n){var r=[];n.getSeries().forEach((function(a){(e&&Dt(e).includes(a.userId.toString())||i&&Dt(i).includes(a.getSpecIndex())||!i&&!e)&&r.push.apply(r,P([],B(a.getMarksWithoutRoot()),!1)),t._itemMap[n.id]=r}))})),this._linkedSeries.forEach((function(e){t._linkedItemMap[e.id]=e.getMarksWithoutRoot()}))},i.prototype.created=function(){e.prototype.created.call(this),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()},i.prototype._bindRegions=function(){W(this._spec.regionId)||W(this._spec.regionIndex)?this._relativeRegions=this._option.getRegionsInUserIdOrIndex(Dt(this._spec.regionId),Dt(this._spec.regionIndex)):this._relativeRegions=this._option.getAllRegions()},i.prototype._bindLinkedSeries=function(){(W(this._spec.brushLinkSeriesId)||W(this._spec.brushLinkSeriesIndex))&&(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(Dt(this._spec.brushLinkSeriesId),Dt(this._spec.brushLinkSeriesIndex)))},i.prototype._initRegionAxisMap=function(){var t=this;W(this._spec.axisId)?Dt(this._spec.axisId).forEach((function(e){t._releatedAxes.push(t._option.getComponentByUserId(e))})):W(this._spec.axisIndex)?Dt(this._spec.axisIndex).forEach((function(e){t._releatedAxes.push(t._option.getComponentByIndex("axes",e))})):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach((function(e){null==e||e.getRegions().forEach((function(i){t._regionAxisMap["region_"+i.id]?t._regionAxisMap["region_"+i.id].push(e):t._regionAxisMap["region_"+i.id]=[e]}))}))},i.prototype._initAxisDataZoomMap=function(){var t=this;this._option.getComponentsByKey("dataZoom").forEach((function(e){e.relatedAxisComponent&&(t._axisDataZoomMap[e.relatedAxisComponent.id]=e)}))},i.prototype.initEvent=function(){},i.prototype._compareSpec=function(t,i){var n=this;this._brushComponents&&this._relativeRegions.forEach((function(t,e){n._updateBrushComponent(t,e)}));var r=e.prototype._compareSpec.call(this,t,i);return St(i,t)||(r.reRender=!0,r.reMake=!0),r},i.prototype.onLayoutEnd=function(){var t,i=this;(e.prototype.onLayoutEnd.call(this),this._option.disableTriggerEvent)||(null===(t=this._spec.visible)||void 0===t||t)&&(this._brushComponents?this._relativeRegions.forEach((function(t,e){i._updateBrushComponent(t,e)})):(this._brushComponents=[],this._relativeRegions.forEach((function(t,e){i._createBrushComponent(t,e)}))))},i.prototype._updateBrushComponent=function(t,e){var i=this._getBrushInteractiveAttr(t),n=this._brushComponents[e];n.setAttributes(i),this._initMarkBrushState(e,""),n.children[0].removeAllChild()},i.prototype._createBrushComponent=function(e,i){var n,r,a=this,o=this._getBrushInteractiveAttr(e),s=new qN(M(M(M({zIndex:this.layoutZIndex,brushStyle:vV(null===(n=this._spec)||void 0===n?void 0:n.style)},o),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));s.id=null!==(r=this._spec.id)&&void 0!==r?r:"brush-".concat(this.id),this.getContainer().add(s),this._brushComponents.push(s),this._cacheInteractiveRangeAttrs.push(o),s.addEventListener(GN.brushActive,(function(n){a._initMarkBrushState(i,K7),a._emitEvent(t.ChartEvent.brushActive,e)})),s.addEventListener(GN.drawStart,(function(i){a._setRegionMarkPickable(e,!0),a._emitEvent(t.ChartEvent.brushStart,e)})),s.addEventListener(GN.moveStart,(function(i){a._setRegionMarkPickable(e,!0),a._emitEvent(t.ChartEvent.brushStart,e)})),s.addEventListener(GN.drawing,(function(i){a._setRegionMarkPickable(e,!1),a._handleBrushChange(e,i),a._emitEvent(t.ChartEvent.brushChange,e)})),s.addEventListener(GN.moving,(function(i){a._setRegionMarkPickable(e,!1),a._handleBrushChange(e,i),a._emitEvent(t.ChartEvent.brushChange,e)})),s.addEventListener(GN.brushClear,(function(n){a._setRegionMarkPickable(e,!0),a._initMarkBrushState(i,""),a._emitEvent(t.ChartEvent.brushClear,e)})),s.addEventListener(GN.drawEnd,(function(n){var r;a._setRegionMarkPickable(e,!0);var o=n.detail.operateMask,s=a._spec.updateElementsState,l=void 0===s||s;if(null===(r=a._spec)||void 0===r?void 0:r.onBrushEnd)!0===a._spec.onBrushEnd(n)?(a.clearGraphic(),a._initMarkBrushState(i,""),a._emitEvent(t.ChartEvent.brushClear,e)):(a._spec.onBrushEnd(n),a._emitEvent(t.ChartEvent.brushEnd,e));else{var u=a._extendDataInBrush(a._inBrushElementsMap);(!a._spec.zoomWhenEmpty&&u.length>0||!l)&&a._setAxisAndDataZoom(o,e),a._emitEvent(t.ChartEvent.brushEnd,e)}})),s.addEventListener(GN.moveEnd,(function(i){a._setRegionMarkPickable(e,!0);var n=i.detail.operateMask,r=a._spec.updateElementsState,o=void 0===r||r,s=a._extendDataInBrush(a._inBrushElementsMap);(!a._spec.zoomWhenEmpty&&s.length>0||o)&&a._setAxisAndDataZoom(n,e),a._emitEvent(t.ChartEvent.brushEnd,e)}))},i.prototype._getBrushInteractiveAttr=function(t){var e=t.getLayoutStartPoint(),i=t.getLayoutRect(),n=e.x,r=n+i.width,a=e.y,o=a+i.height;return{interactiveRange:{minY:a,maxY:o,minX:n,maxX:r},xRange:[n,r],yRange:[a,o]}},i.prototype._transformBrushedMarkAttr=function(t){var e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),M(M({},vV(t)),e)},i.prototype._handleBrushChange=function(t,e){var i=e.detail.operateMask,n=this._spec.updateElementsState;(void 0===n||n)&&(this._reconfigItem(i,t),this._reconfigLinkedItem(i,t))},i.prototype._extendDataInBrush=function(t){var e,i,n=[];for(var r in t)for(var a in t[r])n.push(M({},null===(i=null===(e=t[r][a].context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]));return n},i.prototype._extendDatumOutOfBrush=function(t){var e,i,n=[];for(var r in t)n.push(null===(i=null===(e=t[r].context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]);return n},i.prototype._emitEvent=function(t,e){var i;this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord},vchart:null===(i=this._option)||void 0===i?void 0:i.globalInstance})},i.prototype._reconfigItem=function(t,e){var i,n,r,a=this;if((null==t?void 0:t.globalTransMatrix)&&(null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)){var o=null!==(r=null===(n=null==t?void 0:t.attribute)||void 0===n?void 0:n.points)&&void 0!==r?r:[],s=t.globalTransMatrix,l=s.a,u=s.b,c=s.c,h=s.d,d=s.e,p=s.f,f=o.map((function(t){return{x:l*t.x+c*t.y+d,y:u*t.x+h*t.y+p}})),v=this._spec.markTypeFilter,g=void 0===v?[]:v;this._itemMap[e.id].forEach((function(e){if(!g.includes(e.type)){var i=e.getGraphics();i&&i.length&&i.forEach((function(i){var n,r,o,s=e.id+"_"+i.context.key,l=a._isBrushContainItem(t.globalAABBBounds,f,i);(null===(n=a._outOfBrushElementsMap)||void 0===n?void 0:n[s])&&l?(i.addState(X7,!0),a._inBrushElementsMap[null==t?void 0:t.name]||(a._inBrushElementsMap[null==t?void 0:t.name]={}),a._inBrushElementsMap[null==t?void 0:t.name][s]=i,delete a._outOfBrushElementsMap[s]):(null===(o=null===(r=a._inBrushElementsMap)||void 0===r?void 0:r[null==t?void 0:t.name])||void 0===o?void 0:o[s])&&!l&&(i.removeState(X7),i.addState(K7,!0),a._outOfBrushElementsMap[s]=i,delete a._inBrushElementsMap[t.name][s])}))}}))}},i.prototype._reconfigLinkedItem=function(t,e){var i,n=this;if((null==t?void 0:t.globalTransMatrix)&&(null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)){var r=e.getLayoutStartPoint(),a=e.getSeries().map((function(t){return t.id}));this._linkedSeries.forEach((function(e){var i,o;if(!a.includes(e.id)){var s=e.getRegion().getLayoutStartPoint(),l=s.x-r.x,u=s.y-r.y,c=null!==(o=null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)&&void 0!==o?o:[],h=t.globalTransMatrix,d=h.a,p=h.b,f=h.c,v=h.d,g=h.e,y=h.f,m=l||0,_=u||0,b=c.map((function(t){return{x:d*t.x+f*t.y+g+m,y:p*t.x+v*t.y+y+_}}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+m,t.globalAABBBounds.y1+_,t.globalAABBBounds.x2+m,t.globalAABBBounds.y2+_);var x=n._spec.markTypeFilter,k=void 0===x?[]:x;n._linkedItemMap[e.id].forEach((function(e){if(!k.includes(e.type)){var i=e.getGraphics();i&&i.length&&i.forEach((function(i){var r,a,o;i.context.key;var s=e.id+"_"+i.context.key;(null===(r=n._linkedOutOfBrushElementsMap)||void 0===r?void 0:r[s])&&n._isBrushContainItem(t.globalAABBBounds,b,i)?(i.addState(X7,!0),n._linkedInBrushElementsMap[null==t?void 0:t.name]||(n._linkedInBrushElementsMap[null==t?void 0:t.name]={}),n._linkedInBrushElementsMap[null==t?void 0:t.name][s]=i,delete n._linkedOutOfBrushElementsMap[s]):(null===(o=null===(a=n._linkedInBrushElementsMap)||void 0===a?void 0:a[null==t?void 0:t.name])||void 0===o?void 0:o[s])&&!n._isBrushContainItem(t.globalAABBBounds,b,i)&&(i.removeState(X7),i.addState(K7,!0),n._linkedOutOfBrushElementsMap[s]=i)}))}}))}}))}},i.prototype._isBrushContainItem=function(t,e,i){if(["symbol","rect"].includes(i.type)){var n=null==i?void 0:i.globalAABBBounds,r=n.x1,a=n.x2,o=n.y1,s=n.y2;return Cn(e,[{x:r,y:o},{x:a,y:o},{x:a,y:s},{x:r,y:s}])}return t.intersects(i.globalAABBBounds)},i.prototype._initItemMap=function(t,e,i){var n=this._spec.markTypeFilter,r=void 0===n?[]:n;Object.entries(t).forEach((function(t){var n=B(t,2);n[0],n[1].forEach((function(t){if(!r.includes(t.type)){var n=t.getGraphics();n&&n.length&&n.forEach((function(n){var r=t.id+"_"+n.context.key;n.removeState(X7),n.removeState(K7),i&&n.addState(i,!0),e[r]=n}))}}))}))},i.prototype._initMarkBrushState=function(t,e){this._brushComponents.forEach((function(e,i){i!==t&&e.children[0].removeAllChild()})),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._initItemMap(this._itemMap,this._outOfBrushElementsMap,e),this._initItemMap(this._linkedItemMap,this._linkedOutOfBrushElementsMap,e)},i.prototype._setRegionMarkPickable=function(t,e){t.getGroupMark().getGraphics().forEach((function(t){return t.setAttribute("childrenPickable",e)}))},i.prototype._stateClamp=function(t){return Math.min(Math.max(0,t),1)},i.prototype._setAxisAndDataZoom=function(t,e){var i,n=this;if(this._zoomRecord=[],this._spec.zoomAfterBrush){var r=t.AABBBounds;null===(i=this._regionAxisMap["region_"+e.id])||void 0===i||i.forEach((function(t){var i,a,o="bottom"===t.layoutOrient||"top"===t.layoutOrient,s=null!==(i=n._spec.axisRangeExpand)&&void 0!==i?i:0,l=r.x1,u=r.x2,c=r.y1,h=r.y2,d=o?"x":"y",p=o?"width":"height",f=o?l:c,v=o?u:h;if(n._axisDataZoomMap[t.id]){var g=n._axisDataZoomMap[t.id],y=(f-e.getLayoutStartPoint()[d])/e.getLayoutRect()[p],m=(v-e.getLayoutStartPoint()[d])/e.getLayoutRect()[p],_=n._stateClamp(y-s),b=n._stateClamp(m+s);g.setStartAndEnd(Math.min(_,b),Math.max(_,b),["percent","percent"]),n._zoomRecord.push({operateComponent:g,start:_,end:b,startValue:r6(_,g.stateScale,o6(g.relatedAxisComponent,g.isHorizontal)),endValue:r6(b,g.stateScale,o6(g.relatedAxisComponent,g.isHorizontal))})}else{var x=t.getScale().range(),k=null!==(a=t.scaleRangeFactor())&&void 0!==a?a:[0,1],S=Et(x)<x[0],A=f-e.getLayoutStartPoint()[d],C=v-e.getLayoutStartPoint()[d],M=S?Math.min(A,C):Math.max(A,C),w=S?Math.max(A,C):Math.min(A,C),T=(w-x[0])/(Et(x)-x[0])*(k[1]-k[0])+k[0],D=(M-x[0])/(Et(x)-x[0])*(k[1]-k[0])+k[0],E=n._stateClamp(T-s),B=n._stateClamp(D+s);t.scaleRangeFactor([E,B]),t.effect.scaleUpdate(),n._zoomRecord.push({operateComponent:t,start:E,end:B,startValue:t.getScale().invert(w),endValue:t.getScale().invert(M)})}}))}},i.prototype._getNeedClearVRenderComponents=function(){return this._brushComponents},i.prototype.clearGraphic=function(){this._brushComponents&&this._brushComponents.forEach((function(t){t._container.incrementalClearChild()}))},i.prototype.clear=function(){var t=this;if(this._brushComponents){var e=this.getContainer();this._brushComponents.forEach((function(i,n){t._initMarkBrushState(n,""),i.removeAllChild(),i.releaseBrushEvents(),e&&e.removeChild(i)})),this._brushComponents=null}},i.type=L.brush,i.builtInTheme={brush:Y7},i.specKey="brush",i}(CX),Z7=function(){ij.registerComponent(q7.type,q7)},J7=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=L.customMark,i.specKey="customMark",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.CustomMark,i.layoutLevel=t.LayoutLevel.CustomMark,i}return C(i,e),i.prototype.created=function(){e.prototype.created.call(this),this.initMarks(),this.initEvent()},i.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},i.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)}}},i.prototype.initMarks=function(){var t=this;if(this._spec){var e=null;if(this._spec.parent){var i=this.getChart().getAllMarks().find((function(e){return e.getUserId()===t._spec.parent}));"group"===i.type&&(e=i)}this._createExtensionMark(this._spec,e,"".concat(Mj,"_series_").concat(this.id,"_extensionMark"),0)}},i.prototype._createExtensionMark=function(t,e,i,n){var r,a,o=this;void 0===n&&(n=0);var s=this._createMark({type:t.type,name:W(t.name)?"".concat(t.name):"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(s){if(W(t.id)&&s.setUserId(t.id),(null===(r=this._option.globalInstance)||void 0===r?void 0:r.isAnimationEnable())&&t.animation){var l=nY({},rY(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if(j(e)?this._marks.addMark(s):e&&e.addMark(s),this.initMarkStyleWithSpec(s,t),"group"===t.type&&(i="".concat(i,"_").concat(n),null===(a=t.children)||void 0===a||a.forEach((function(t,e){o._createExtensionMark(t,s,i,e)}))),W(t.dataId)||it(t.dataIndex)){var u=this.getChart().getSeriesData(t.dataId,t.dataIndex);u&&(s.setDataView(u),u.target.addListener("change",(function(){s.getData().updateData()})))}}},i.prototype.initEvent=function(){},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return St(i,t)||(n.reMake=!0),n.change=!0,n.reRender=!0,n},i.prototype._getMarkAttributeContext=function(){var t=this;return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},getLayoutBounds:function(){var e=t.getLayoutStartPoint(),i=e.x,n=e.y,r=t.getLayoutRect(),a=r.width,o=r.height;return(new Fn).set(i,n,i+a,n+o)}}},i.prototype._getLayoutRect=function(){var t=new Fn;return this.getMarks().forEach((function(e){var i=e.getProduct();i&&t.union(i.AABBBounds)})),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}},i.prototype.getBoundsInRect=function(t){this.setLayoutRect(t);var e=this._getLayoutRect(),i=this.getLayoutStartPoint(),n=i.x,r=i.y;return{x1:n,y1:r,x2:n+e.width,y2:r+e.height}},i.prototype.getVRenderComponents=function(){var t=[],e=function(i){if(i&&"group"===i.type)i.getMarks().forEach((function(t){e(t)}));else if("component"===i.type){var n=null==i?void 0:i.getComponent();n&&t.push(n)}};return this.getMarks().forEach((function(t){e(t)})),t},i.type=L.customMark,i.specKey="customMark",i}(CX),Q7=function(){ij.registerComponent(J7.type,J7)},$7=function(){function t(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=new Array(this._col).fill(null),this._rowSize=new Array(this._row).fill(null),this._colElements=new Array(this._col).fill([]),this._rowElements=new Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}return t.prototype.standardizationSpec=function(t){var e,i,n;t.col=null!==(e=t.col)&&void 0!==e?e:1,t.row=null!==(i=t.row)&&void 0!==i?i:1,t.elements=null!==(n=t.elements)&&void 0!==n?n:[]},t.prototype.initUserSetting=function(){var t=this;this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((function(e,i){e||(t._colSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})})),this._rowSize.forEach((function(e,i){e||(t._rowSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})}))},t.prototype.setSizeFromUserSetting=function(t,e,i,n){t.forEach((function(t){t.index<0&&t.index>=i||(it(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:U(t.size)&&(e[t.index]={value:t.size(n),isUserSetting:!0,isLayoutSetting:!1}))}))},t.prototype.clearLayoutSize=function(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})),this._rowSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}))},t.prototype.getItemGridInfo=function(t){var e,i,n=this._elementMap.get(t);return n||((i=null===(e=this._gridInfo.elements)||void 0===e?void 0:e.find((function(e){var i;if("modelId"in e&&W(e.modelId)){if(W(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&W(e.modelKey)&&"modelIndex"in e&&W(e.modelIndex)){if((null!==(i=t.model.specKey)&&void 0!==i?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0}return!1})))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)},t.prototype.getSizeFromGrid=function(t,e){for(var i,n="col"===e?this._colSize:this._rowSize,r=0,a=t[e];a<t[e]+(null!==(i=t["".concat(e,"Span")])&&void 0!==i?i:1);a++)r+=n[a].value;return r},t.prototype.getSizeFromUser=function(t,e){var i,n,r="col"===e?this._colSize:this._rowSize;if(null===(i=r[t[e]])||void 0===i?void 0:i.isUserSetting){for(var a=0,o=t[e];o<t[e]+(null!==(n=t["".concat(e,"Span")])&&void 0!==n?n:1);o++){if(!r[o].isUserSetting)return;a+=r[o].value}return a}},t.prototype.setItemLayoutSizeToGrid=function(t,e){if(t9(t)){if(e.colSpan&&e.colSpan>1)return;if(this._colSize[e.col].isUserSetting)return;this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0}else{if(e.rowSpan&&e.rowSpan>1)return;if(this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}},t.prototype.layoutGrid=function(t){var e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,n=[];e.forEach((function(t){t.isUserSetting||t.isLayoutSetting?i-=t.value:n.push(t)})),i<0&&console.warn("layout content ".concat(t," size bigger than chart")),n.forEach((function(t){return t.value=i/n.length}))},t.prototype.getItemPosition=function(t){for(var e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y},n=0;n<e.col;n++)i.x+=this._colSize[n].value;for(var r=0;r<e.row;r++)i.y+=this._rowSize[r].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i},t.prototype.getItemLayoutRect=function(t){var e,i,n=this.getItemGridInfo(t);return{width:(null!==(e=this.getSizeFromGrid(n,"col"))&&void 0!==e?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(i=this.getSizeFromGrid(n,"row"))&&void 0!==i?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype.layoutItems=function(t,e,i,n){var r=this;this._chartLayoutRect=i,this._chartViewBox=n,this.clearLayoutSize(),e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}));var a=e.filter((function(t){return"normal"===t.layoutType&&!1!==t.getModelVisible()})),o=a.filter((function(t){return t9(t)})),s=a.filter((function(t){return!t9(t)}));a.forEach((function(t){r.layoutOneItem(t,"user",!1)}));var l=e.filter((function(t){return"region-relative"===t.layoutType})),u=l.filter((function(t){return t9(t)})),c=l.filter((function(t){return!t9(t)}));u.forEach((function(t){return r.layoutOneItem(t,"user",!1)})),this.layoutGrid("col"),s.forEach((function(t){return r.layoutOneItem(t,"colGrid",!1)})),c.forEach((function(t){r.layoutOneItem(t,"colGrid",!1)})),this.layoutGrid("row"),c.forEach((function(t){r.layoutOneItem(t,"grid",!1)})),o.forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),u.forEach((function(t){r.layoutOneItem(t,"grid",!0)})),this.layoutGrid("col"),e.filter((function(t){return"region"===t.layoutType})).forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType}))),e.filter((function(t){return"absolute"!==t.layoutType})).forEach((function(t){t.setLayoutStartPosition(r.getItemPosition(t))}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.layoutOneItem=function(t,e,i){var n,r,a="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),o="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),s=this.getItemGridInfo(t),l={width:(null!==(n=o(s,"col"))&&void 0!==n?n:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(r=a(s,"row"))&&void 0!==r?r:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},u=t.computeBoundsInRect(l);it(u.width)||(u.width=l.width),it(u.height)||(u.height=l.height),t.setLayoutRect("grid"!==e?u:l),this.setItemLayoutSizeToGrid(t,s)},t.type="grid",t}();function t9(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}var e9=function(){ij.registerLayout($7.type,$7)},i9=function(){rh.load(_R)},n9="vchart-tooltip",r9="".concat(n9,"-container"),a9="".concat(n9,"-title"),o9="".concat(n9,"-content-box"),s9={offsetX:10,offsetY:10},l9="99999999999999";function u9(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}var c9=function(t,e){return t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:t.offsetHeight>0?e.height/t.offsetHeight:1):1},h9=function(t){return q(t)&&""!==(null==t?void 0:t.trim())||$(t)?u9(t):""},d9=function(t,e){var i;if(W(t))if($(t))i=t;else if(U(t)){var n=t(e);$(n)&&(i=n)}return i},p9={left:[-2,0],right:[2,0],top:[0,-2],bottom:[0,2],insideTop:[0,-1.5],insideBottom:[0,1.5],insideLeft:[-1.5,0],insideRight:[1.5,0],insideTopLeft:[-1.5,-1.5],insideTopRight:[1.5,-1.5],insideBottomLeft:[-1.5,1.5],insideBottomRight:[1.5,1.5],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},f9=function(t,e,i){var n,r;return void 0===i&&(i=2),null!==(r=null===(n=p9[t])||void 0===n?void 0:n["x"===e?0:1])&&void 0!==r?r:i},v9=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._visible=!0,e._isReleased=!1,e.showTooltip=function(t,i,n){return n.changePositionOnly?e.changeTooltipPosition(n,i):e.changeTooltip(!0,n,i)},e.changeTooltip=function(t,i,n){return e._isReleased?1:t?e.changeTooltipPosition(i,n):(e._updateTooltip(!1,i),0)},e.changeTooltipPosition=function(t,i){var n,r,a,o,s;if(e._isReleased)return 1;var l=t.event,u=t.tooltipSpec,c=t.activeTooltipSpec,h=t.changePositionOnly;if(!c)return 1;var d=c.activeType;if(c.handler)return null!==(a=null===(r=(n=c.handler).showTooltip)||void 0===r?void 0:r.call(n,d,i,t))&&void 0!==a?a:0;var p=c,f=e._getActualTooltipPosition(c,t,e._getTooltipBoxSize(c,h));c.position=f;var v=null!==(o=c.updatePosition)&&void 0!==o?o:null===(s=u[d])||void 0===s?void 0:s.updatePosition;v&&(c.position=v(c.position,i,t));var g=!1!==(null==p?void 0:p.visible);return i&&"pointerout"!==l.type&&c.visible&&(c.title||c.content)||(g=!1),e._updateTooltip(g,M(M({},t),{changePositionOnly:h})),0},e._getActualTooltipPosition=function(t,i,n){var r,a,o,s,l,u,c,h,d,p=e._chartOption.getRectByDimensionData,f=i.tooltipSpec,v={x:1/0,y:1/0};if(!f)return v;var g,y=i.event,m=t.activeType,_=t.data,b="dimension"===m?null===(a=null===(r=_[0])||void 0===r?void 0:r.data)||void 0===a?void 0:a[0]:null==_?void 0:_[0],x=e._option,k=x.offsetX,S=x.offsetY,A=f[m],C=BG(null==A?void 0:A.position,_,i),M=null!==(o=BG(null==A?void 0:A.positionMode,_,i))&&void 0!==o?o:"mark"===m?"mark":"pointer",w=null!=n?n:{},T=w.width,D=void 0===T?0:T,E=w.height,B=void 0===E?0:E,P="canvas"===f.renderMode,R=null===(s=null==i?void 0:i.chart)||void 0===s?void 0:s.getCanvasRect(),L=null!==(l=null==R?void 0:R.width)&&void 0!==l?l:wj,I=null!==(u=null==R?void 0:R.height)&&void 0!==u?u:Tj,F=!1,O={width:0,height:0},z={x:0,y:0},H={x:0,y:0},N=1,j=1,V=GA(e._env);if(V&&!f.confine?(O.width=window.innerWidth,O.height=window.innerHeight):(O.width=L,O.height=I),V&&!P){var Y=e._getParentElement(f);H=null!==(h=null===(c=null==Y?void 0:Y.getBoundingClientRect)||void 0===c?void 0:c.call(Y))&&void 0!==h?h:v;var X=null!==(d=e._compiler.getCanvas())&&void 0!==d?d:e._chartContainer;g=null==X?void 0:X.getBoundingClientRect(),z={x:g.x-H.x,y:g.y-H.y},N=c9(X,g),j=c9(Y,H)}var K,q=j/N,Z={},J={x:C,y:C},Q={x:["left","right"],y:["top","bottom"]},tt=function(t,e){var n,r,a,o=t.orient,s=t.mode,l=t.offset,u=i.model,c=null==u?void 0:u.getLayoutStartPoint(),h=null!=l?l:"x"===e?k:S;if("mark"===s){F=!0;var d=i.item,f=null==d?void 0:d.AABBBounds;f&&c&&(r=("x"===e?f.x1:f.y1)+c[e],a=("x"===e?f.x2:f.y2)+c[e])}else if(p&&"crosshair"===s&&"cartesian"===(null===(n=null==b?void 0:b.series)||void 0===n?void 0:n.coordinate)&&b.datum&&b.datum.length){F=!0;var v=p(b,c);v&&(r=v.start[e],a=v.end[e])}else J[e]=o;if(F){var g=Q[e][0],y="x"===e?D:B;switch(f9(o,e)){case-2:Z[g]=r-y*q-h;break;case-1.5:Z[g]=r+h;break;case 0:Z[g]=(r+a)/2-y*q/2;break;case-1:Z[g]=(r+a)/2-y*q-h;break;case 1:Z[g]=(r+a)/2+h;break;case 1.5:Z[g]=a-y*q-h;break;case 2:Z[g]=a+h}}},et=["x","y"];if(G(C))if(G(K=C)&&(W(K.left)||W(K.right)||W(K.top)||W(K.bottom))){var nt=C,rt=nt.left,at=nt.right,ot=nt.top,st=nt.bottom;Z.left=d9(rt,y),Z.top=d9(ot,y),Z.right=d9(at,y),Z.bottom=d9(st,y)}else(function(t){return G(t)&&(W(t.x)||W(t.y))})(C)&&et.forEach((function(t){var e=C[t];$(e)||U(e)?Z[Q[t][0]]=d9(e,y):tt(e,t)}));else W(C)&&(tt({orient:C,mode:M},"x"),tt({orient:C,mode:M},"y"));var lt={x:null,y:null};return et.forEach((function(t){var e,i="x"===t?D:B,n="x"===t?L:I,r="x"===t?k:S,a=f9(J[t],t);if(it(Z[Q[t][0]]))lt[t]=Z[Q[t][0]];else if(it(Z[Q[t][1]]))lt[t]=n-i*q-Z[Q[t][1]];else{var o="x"===t?y.canvasX:y.canvasY;lt[t]=a>0?o+r:0===a?o-i*q/2:o-i*q-r}lt[t]*=N,V&&(lt[t]+=z[t]),lt[t]/=j;var s="x"===t?O.width:O.height,l=f.confine?-(H[t]-(null!==(e=null==g?void 0:g[t])&&void 0!==e?e:0)/N)/j:-H[t]/j,u=s/j+l-i;2!==a&&lt[t]<l?F?lt[t]=l:(lt[t]+=0===a?r+i/2:2*r+i,lt[t]>u&&(lt[t]=u)):-2!==a&&lt[t]>u&&(F?lt[t]=u:(lt[t]-=0===a?r+i/2:2*r+i,lt[t]<l&&(lt[t]=l)))})),lt},e}return C(e,t),Object.defineProperty(e.prototype,"env",{get:function(){return this._env},enumerable:!1,configurable:!0}),e.prototype.onAdd=function(e){t.prototype.onAdd.call(this,e);var i=e.component;this._component=i,this._chartOption=i.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=i.getCompiler(),this._initFromSpec()},e.prototype.hideTooltip=function(t){return this.changeTooltip(!1,t)},e.prototype.release=function(){var t,e,i,n,r=null!==(e=null===(t=this._component)||void 0===t?void 0:t.getSpec())&&void 0!==e?e:{};r.handler?null===(n=(i=r.handler).release)||void 0===n||n.call(i):(this._removeTooltip(),this._isReleased=!0,this._chartOption=null,this._component=null)},e.prototype._getDefaultOption=function(){var t,e,i=this._component.getSpec().offset;return i?{offsetX:null!==(t=i.x)&&void 0!==t?t:s9.offsetX,offsetY:null!==(e=i.y)&&void 0!==e?e:s9.offsetY}:s9},e.prototype._getParentElement=function(t){return t.parentElement},e.prototype.getTooltipContainer=function(){return this._container},e.prototype._initFromSpec=function(){this._option=this._getDefaultOption()},e.prototype.reInit=function(){this._initFromSpec()},e.specKey="tooltip",e}(JY),g9=function(t,e){return W(t)?Z(t)?t.map((function(t){return"".concat(t,"px")})).join(" "):"".concat(t,"px"):null!=e?e:"initial"},y9=function(t,e){var i,n;void 0===t&&(t={}),void 0===e&&(e={}),W(t.fontFamily)&&(e.fontFamily=t.fontFamily);var r=null!==(i=t.fill)&&void 0!==i?i:t.fontColor;return W(r)&&(e.color=r),W(t.fontWeight)&&(e.fontWeight=t.fontWeight),W(t.textAlign)&&(e.textAlign=t.textAlign),W(t.fontSize)&&(e.fontSize=g9(t.fontSize)),W(t.maxWidth)&&(e.maxWidth=g9(t.maxWidth)),t.multiLine||W(t.maxWidth)&&!1!==t.multiLine?(e.whiteSpace="initial",e.wordBreak=null!==(n=t.wordBreak)&&void 0!==n?n:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},m9=function(t){void 0===t&&(t={});var e=t.lineHeight;return t.fontSize?HU(e,t.fontSize):0},_9=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,a=t.padding,o={borderWidth:"".concat(null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,"px")},s=null;(null==n?void 0:n.color)&&(o.borderColor=n.color),i&&(o.backgroundColor=i),o.boxShadow=r?"".concat(r.x,"px ").concat(r.y,"px ").concat(r.blur,"px ").concat(r.spread,"px ").concat(r.color):"initial";var l=(null!=n?n:{}).radius;return W(l)&&(o.borderRadius=it(l)?"".concat(l,"px"):"".concat(l)),a&&(s=rr(a),o.padding=g9(s)),{panelStyle:o,panelPadding:s}};function b9(t,e){t&&t.style&&e&&Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var x9=function(t){ij.registerComponentPlugin(t.type,t)};var k9=function(t){function e(){var i=t.call(this,e.type)||this;return i.type=tq.dom,i._tooltipContainer=null==WA?void 0:WA.body,i}return C(e,t),e.prototype.getVisibility=function(){return!!this._rootDom&&"visible"===this._rootDom.style.visibility},e.prototype.setVisibility=function(t){t!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=t?"visible":"hidden")},e.prototype.getRootDom=function(){return this._rootDom},e.prototype.onAdd=function(e){t.prototype.onAdd.call(this,e),this._initStyle(),this.initEl()},e.prototype.initEl=function(){var t=this._component.getSpec().parentElement;if(WA&&t&&t.children&&t.children.length){for(var e=0;e<t.children.length;e++)if(t.children[e].classList.contains(r9)){this._container=t.children[e];break}this._container||(this._container=WA.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=l9,this._container.classList.add(r9),t.appendChild(this._container))}},e.prototype.initRootDom=function(){var t,e=this._component.getSpec(),i=document.createElement("div"),n=null===(t=this._chartOption)||void 0===t?void 0:t.getTheme("fontFamily");b9(i,M({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:l9,fontFamily:null!=n?n:KU.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),i.classList.add(e.className),i.setAttribute("vchart-tooltip-id","".concat(this.id)),this._container.appendChild(i),this._rootDom=i},e.prototype._getTooltipBoxSize=function(t,e){var i;this._rootDom||this.initRootDom(),e||this._updateDomStringByCol(t),this._updateDomStyle("height",e);var n=null===(i=this._rootDom)||void 0===i?void 0:i.getBoundingClientRect();return{width:null==n?void 0:n.width,height:null==n?void 0:n.height}},e.prototype._removeTooltip=function(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null},e.prototype._updateTooltip=function(t,e){var i,n;if(t&&this._rootDom){var r=e.tooltipSpec,a=e.activeTooltipSpec;e.changePositionOnly||(this._tooltipActual=a);var o=this._rootDom;if(o){var s=null!==(i=a.position)&&void 0!==i?i:{},l=s.x,u=void 0===l?0:l,c=s.y,h=void 0===c?0:c,d={x:u,y:h},p=this.getVisibility();r.updateElement&&(this._updatePosition(null!==(n=this._cacheCustomTooltipPosition)&&void 0!==n?n:{x:u,y:h}),r.updateElement(o,a,e),d=this._getActualTooltipPosition(a,e,{width:o.offsetWidth,height:o.offsetHeight}),this._cacheCustomTooltipPosition=d),!p&&t&&(this._rootDom.style.transition="none",this._updatePosition(d,!1),this._rootDom.getBoundingClientRect()),this._updatePosition(d)}this.setVisibility(t)}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0},e.prototype._initStyle=function(){var t=this._component.getSpec();this._domStyle=function(t){var e,i,n,r;void 0===t&&(t={});var a=t.style,o=void 0===a?{}:a,s=t.enterable,l=t.transitionDuration,u=o.panel,c=void 0===u?{}:u,h=o.titleLabel,d=o.shape,p=o.keyLabel,f=o.valueLabel,v=o.spaceRow,g=o.align,y=_9(c),m=y.panelStyle,_=y.panelPadding,b={marginTop:"0px",marginBottom:"0px"};m.pointerEvents=s?"auto":"none",l&&(m.transitionDuration=l?"".concat(l,"ms"):"initial",m.transitionProperty=l?"transform":"initial",m.transitionTimingFunction=l?"ease-out":"initial"),it(v)&&(b.marginBottom="".concat(v,"px"));var x={width:g9(null!==(e=null==d?void 0:d.size)&&void 0!==e?e:8)},k=y9(h),S=y9(p),A=y9(f),C="right"===g?"marginLeft":"marginRight";"right"===g&&(m.direction="rtl"),j(k.textAlign)&&(k.textAlign="right"===g?"right":"left"),j(S.textAlign)&&(S.textAlign="right"===g?"right":"left"),j(A.textAlign)&&(A.textAlign="right"===g?"left":"right"),x[C]=g9(null!==(i=d.spacing)&&void 0!==i?i:8),S[C]=g9(null!==(n=p.spacing)&&void 0!==n?n:26),A[C]=g9(null!==(r=f.spacing)&&void 0!==r?r:0);var M=Math.max(m9(f),m9(p));return b.lineHeight=M>0?"".concat(M,"px"):"20px",{panelPadding:_,row:b,panel:m,title:k,shape:x,key:S,value:A}}(t)},e.prototype._updateDomStringByCol=function(t){var e,i=this,n=t.title,r=void 0===n?{}:n,a=t.content,o=a&&a.length,s=this._domStyle.row,l=P([],B(this._rootDom.children),!1),u=l.find((function(t){return t.className.includes(a9)})),c=l.find((function(t){return t.className.includes(o9)}));if(!u&&!1!==r.visible){u=document.createElement("h2");var h=document.createElement("span");u.appendChild(h),u.classList.add(a9),this._rootDom.firstChild?this._rootDom.insertBefore(u,this._rootDom.firstChild):this._rootDom.appendChild(u)}u&&!1!==r.visible?(b9(u,M(M(M({},this._domStyle.title),o?s:{marginBottom:"0px"}),{marginTop:"0px"})),u.firstChild.innerHTML="".concat(null!==(e=r.value)&&void 0!==e?e:"")):u&&!1===r.visible&&u.parentNode.removeChild(u);var d=["shape","key","value"];if(!c&&o&&(c=document.createElement("div"),d.forEach((function(t){var e=document.createElement("div");e.classList.add("".concat(n9,"-column")),e.classList.add("".concat(n9,"-").concat(t,"-column")),e.setAttribute("data-col",t),c.appendChild(e)})),c.classList.add(o9),this._rootDom.appendChild(c)),c&&o){var p=P([],B(c.children),!1);b9(c,{whiteSpace:"nowrap"}),p.forEach((function(t,e){var n=t.getAttribute("data-col");if(n&&d.includes(n)){var r="shape"===n&&a.every((function(t){return!t.hasShape||!t.shapeType}));b9(t,M(M({},i._domStyle[n]),{display:r?"none":"inline-block",verticalAlign:"top"}));var o=P([],B(t.children),!1);o.slice(a.length).forEach((function(t){t.parentNode.removeChild(t)})),a.forEach((function(e,r){var l=o[r];l||((l=document.createElement("div")).classList.add("".concat(n9,"-").concat(n)),t.appendChild(l));var u=M({},s);r===a.length-1&&(u.marginBottom="0px"),u.display=!1===e.visible?"none":"block",u.height="initial","key"===n?(l.innerHTML=h9(e.key),e.keyStyle&&y9(e.keyStyle,u)):"value"===n?(l.innerHTML=h9(e.value),e.valueStyle&&y9(e.valueStyle,u)):"shape"===n&&(l.innerHTML=function(t,e){var i,n,r,a,o,s;if(!t||!t.hasShape||!t.shapeType)return"";var l,u,c='style="display:inline-block;vertical-align:middle;"',h=t.shapeType,d=t.shapeStroke,p=t.shapeHollow,f=void 0!==p&&p,v=t.shapeFill,g=null!==(i=t.shapeSize)&&void 0!==i?i:8,y=t.shapeLineWidth?u9(t.shapeLineWidth)+"px":"0px",m="currentColor",_=function(){return d?u9(d):m},b=g,x=function(t){return new zm({symbolType:t,size:b,fill:!0})},k=x(h),S=k.getParsedPath();if(!S.path&&S.pathStr&&(k=x(S.pathStr)),k.getParsedPath().path){var A=k.getParsedPath().path;u=A.toString(),l=A.bounds}else S.isSvg&&S.svgCache&&(u=S.svgCache.map((function(t){return t.path.toString()})).join(),l=S.svgCache.reduce((function(t,e){return t.union(e.path.bounds)}),new Fn));var C="".concat(l.x1," ").concat(l.y1," ").concat(l.width()," ").concat(l.height());if("0px"!==y){var M=B(C.split(" ").map((function(t){return Number(t)})),4),w=M[0],T=M[1],D=M[2],E=M[3],P=Number(y.slice(0,-2));C="".concat(w-P/2," ").concat(T-P/2," ").concat(D+P," ").concat(E+P)}var R=$d.IsGradientStr(v);if(!v||q(v)&&!R||f)return m=f?"none":v?u9(v):"currentColor","\n    <svg ".concat(c,' width="').concat(g,'" height="').concat(g,'" viewBox="').concat(C,'">\n      <path\n        d="').concat(u,'"\n        style="fill: ').concat(m,"; stroke: ").concat(_(),"; stroke-width: ").concat(y,'"\n      >\n      </path>\n    </svg>');var L=R?$d.Parse(v):G(v)?v:null;if(L){m="gradientColor"+(null!=e?e:"");var I="",F=(null!==(n=L.stops)&&void 0!==n?n:[]).map((function(t){return'<stop offset="'.concat(u9(t.offset.toString()),'" stop-color="').concat(u9(t.color),'"/>')})).join("");return"radial"===L.gradient?I='<radialGradient id="'.concat(m,'" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">\n      ').concat(F,"\n      </radialGradient>"):"linear"===L.gradient&&(I='<linearGradient id="'.concat(m,'" x1="').concat(100*(null!==(r=L.x0)&&void 0!==r?r:0),'%" y1="').concat(100*(null!==(a=L.y0)&&void 0!==a?a:0),'%" x2="').concat(100*(null!==(o=L.x1)&&void 0!==o?o:0),'%" y2="').concat(100*(null!==(s=L.y1)&&void 0!==s?s:0),'%">\n      ').concat(F,"\n      </linearGradient>")),"\n    <svg ".concat(c,' width="').concat(g,'" height="').concat(g,'" viewBox="-0.5 -0.5 1 1">\n      ').concat(I,'\n      <path\n        d="').concat(u,'"\n        style="fill: url(#').concat(m,"); stroke: ").concat(_(),"; stroke-width: ").concat(y,'"\n      >\n      </path>\n    </svg>')}return""}(e,"".concat(i.id,"_").concat(r))),b9(l,u)}))}}))}else c&&!o&&c.parentNode.removeChild(c)},e.prototype._updateDomStyle=function(t,e){var i,n,r,a,o;void 0===t&&(t="width");var s=this._rootDom,l=P([],B(s.children),!1).find((function(t){return t.className.includes(o9)})),u=P([],B(s.children),!1).find((function(t){return t.className.includes(a9)}));if(l){var c=this._component.getSpec(),h={},d=null===(i=c.style)||void 0===i?void 0:i.titleLabel;if(d&&d.autoWidth&&!1!==d.multiLine&&u){var p=P([],B(l.children),!1).reduce((function(e,i){return"height"===t?e+i.getBoundingClientRect().width:Math.max(e,i.getBoundingClientRect().width)}),0);p>0&&(u.style.maxWidth="".concat(p,"px"),u.style.maxWidth="".concat(Math.ceil(l.getBoundingClientRect().width),"px"))}if(W(null===(n=null==c?void 0:c.style)||void 0===n?void 0:n.maxContentHeight)){var f=u&&u.className.includes(a9)?u.getBoundingClientRect().height+(null!==(r=c.style.spaceRow)&&void 0!==r?r:0):0,v=this._chartOption.getChartViewRect(),g=HU(c.style.maxContentHeight,Math.min(v.height,document.body.clientHeight)-f-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));g>0&&(h.maxHeight="".concat(g,"px"),h.overflowY="auto",h.width="calc(100% + ".concat(this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px",")"),b9(l,h))}var y=l.children,m=[];if(y){for(var _=0;_<y.length;_++)for(var b=null!==(a=y[_].children)&&void 0!==a?a:[],x=0;x<b.length;x++){e&&(b[x].style[t]="initial");var k=b[x].getBoundingClientRect()[t];(void 0===m[x]||m[x]<k)&&(m[x]=k)}for(_=0;_<y.length;_++)for(b=null!==(o=y[_].children)&&void 0!==o?o:[],x=0;x<b.length;x++)b[x].style[t]="".concat(m[x],"px")}}},e.prototype._getParentElement=function(e){var i;return null!==(i=this._container)&&void 0!==i?i:t.prototype._getParentElement.call(this,e)},e.prototype.isTooltipShown=function(){return this.getVisibility()},e.prototype.reInit=function(){t.prototype.reInit.call(this),this._initStyle(),this._rootDom&&b9(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height",!1))},e.prototype._updatePosition=function(t,e){var i=t.x,n=t.y;void 0===e&&(e=!0),this._rootDom&&(this._rootDom.style.transform="translate3d(".concat(i,"px, ").concat(n,"px, 0)"),e&&""!==this._rootDom.style.transition&&(this._rootDom.style.transition="",Object.assign(this._rootDom.style,this._domStyle.panel)))},e.type=tq.dom,e}(v9),S9=function(){x9(k9)},A9={fontFamily:KU.fontFamily,spacing:10,wordBreak:"break-word"},C9=function(t,e){var i,n,r;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),n=e.multiLine?(n=t.split("\n")).map((function(t,e){return e<n.length-1?t+"\n":t})):[t],r=n.map((function(t){return M(M({},e),{text:t})}))):(r=t.text,n=t);var a,o=(a={wordBreak:null!==(i=e.wordBreak)&&void 0!==i?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:r},E_||(E_=B_.CreateGraphic("richtext",{})),E_.setAttributes(a),E_.AABBBounds);return{width:o.width(),height:o.height(),text:n}};function M9(t,e,i){var n,r;return void 0===t&&(t={}),M(M({},null!=i?i:A9),{fill:null!==(n=t.fill)&&void 0!==n?n:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!==(r=t.fontFamily)&&void 0!==r?r:e,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:W(t.maxWidth)?!1!==t.multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}var w9=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,a={lineWidth:null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,shadow:!!r};(null==n?void 0:n.color)&&(a.stroke=n.color),i&&(a.fill=i),r&&(a.shadowColor=r.color,a.shadowBlur=r.blur,a.shadowOffsetX=r.x,a.shadowOffsetY=r.y,a.shadowSpread=r.spread);var o=(null!=n?n:{}).radius;return W(o)&&(a.cornerRadius=[o,o,o,o]),a},T9=function(t){function e(){var i=t.call(this,e.type)||this;return i.type=tq.canvas,i._attributes=null,i}return C(e,t),e.prototype.onAdd=function(e){var i;t.prototype.onAdd.call(this,e),this._tooltipCanvasId=null===(i=this._chartOption.modeParams)||void 0===i?void 0:i.tooltipCanvasId},e.prototype._initTooltipComponent=function(t){var e=this._getLayer(t);this._tooltipComponent=new tU({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)},e.prototype._getLayer=function(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);var e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer},e.prototype._getTooltipBoxSize=function(t,e){var i,n;if(!e||j(this._attributes)){var r=null===(i=this._chartOption)||void 0===i?void 0:i.getTheme("fontFamily");this._attributes=function(t,e,i){var n,r,a,o,s,l=e.style,u=void 0===l?{}:l,c=e.enterable,h=e.transitionDuration,d=u.panel,p=void 0===d?{}:d,f=u.titleLabel,v=u.shape,g=u.keyLabel,y=u.valueLabel,m=u.spaceRow,_=u.align,b=rr(p.padding),x=jU(p.padding),k=M9(M({textAlign:"right"===_?"right":"left"},f),i),S=M9(M({textAlign:"right"===_?"right":"left"},g),i),A=M9(y,i),C={fill:!0,size:null!==(n=null==v?void 0:v.size)&&void 0!==n?n:8,spacing:null!==(r=null==v?void 0:v.spacing)&&void 0!==r?r:6},w={panel:w9(p),padding:b,title:{},content:[],titleStyle:{value:k,spaceRow:m},contentStyle:{shape:C,key:S,value:A,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:c,transitionDuration:h,align:_},T=t.title,D=void 0===T?{}:T,E=t.content,B=void 0===E?[]:E,P=x.left+x.right,R=x.top+x.bottom,L=0,I=!!B.length,F=0,O=0,z=0,H=0;if(I){var N=[],U=[],j=[],V=[],G=0;w.content=B.map((function(t,e){var i=0,n=t.hasShape,r=t.key,a=t.shapeType,o=void 0===a?"":a,s=t.shapeFill,l=t.shapeStroke,u=t.shapeLineWidth,c=t.shapeSize,h=t.value,d=t.isKeyAdaptive,p=t.spaceRow,f=t.keyStyle,v=t.valueStyle,g=t.shapeHollow,y={height:0,spaceRow:null!=p?p:m};if(W(r)){var _=ej({},S,M9(f,void 0,{})),b=C9(r,_),x=b.width,k=b.height,w=b.text;y.key=M(M({width:x,height:k},_),{text:w}),d?U.push(x):N.push(x),i=Math.max(i,k)}if(W(h)){var T=ej({},A,M9(v,void 0,{})),D=C9(h,T);x=D.width,k=D.height,w=D.text,y.value=M(M({width:x,height:k},T),{text:w}),j.push(x),i=Math.max(i,k)}if(n){var E={visible:!0,symbolType:o};g?E.stroke=s:E.fill=s,E.stroke=null!=l?l:s,E.lineWidth=u,y.shape=E;var P=null!=c?c:C.size;i=Math.max(P,i),V.push(P)}else y.shape={visible:!1};return y.height=i,G+=i,e<B.length-1&&(G+=y.spaceRow),y})),R+=G,F=N.length?Bt(N):0,O=U.length?Bt(U):0,z=j.length?Bt(j):0,H=V.length?Bt(V)+C.spacing:0,L=Math.max(H+F+S.spacing+z+A.spacing,H+O,L),w.hasContentShape=!!V.length,w.keyWidth=F,w.valueWidth=z}var Y=0,X=0,K=0,q=D.visible,Z=void 0===q||q,J=D.value,Q=void 0===J?"":J,$=D.valueStyle,tt=D.spaceRow;w.title.visible=Z,w.title.spaceRow=null!=tt?tt:m;var et={},it=function(){return et.autoWidth&&!1!==et.multiLine};if(Z){et=ej({},k,M9($,void 0,{})),it()&&(et.multiLine=null===(a=et.multiLine)||void 0===a||a,et.maxWidth=null!==(o=et.maxWidth)&&void 0!==o?o:I?Math.ceil(L):void 0);var nt=C9(Q,et),rt=nt.text,at=nt.width,ot=nt.height;w.title.value=M(M({width:it()?Math.min(at,null!==(s=et.maxWidth)&&void 0!==s?s:Number.MAX_VALUE):at,height:ot},et),{text:rt}),Y=w.title.value.width,K=(X=w.title.value.height)+(I?w.title.spaceRow:0)}return R+=K,w.title.width=Y,w.title.height=X,it()?P+=L||Y:P+=Math.max(Y,L),I&&w.content.forEach((function(t){var e,i=t.value;i&&(null===(e=i.autoWidth)||void 0===e||e)&&(i.width=P-x.left-x.right-H-F-S.spacing-A.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),w.valueWidth=Math.max(w.valueWidth,i.width))})),w.panel.width=P,w.panel.height=R,w}(t,this._component.getSpec(),r)}var a=(null!==(n=this._attributes)&&void 0!==n?n:{}).panel;return{width:a.width+a.lineWidth,height:a.height+a.lineWidth}},e.prototype._removeTooltip=function(){this._layer&&this._layer.removeAllChild(),this._attributes=null},e.prototype._updateTooltip=function(t,e){this._visible=t;var i=this._compiler.getStage();if(i)if(t){this._tooltipComponent||this._initTooltipComponent(i);var n=e.activeTooltipSpec.position;e.changePositionOnly?W(n)&&this._tooltipComponent.setAttributes(n):this._tooltipComponent.setAttributes(M(M({},this._attributes),n)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}else this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1}))},e.prototype.isTooltipShown=function(){var t;return null===(t=this._tooltipComponent)||void 0===t?void 0:t.attribute.visibleAll},e.prototype.release=function(){var e;t.prototype.release.call(this),null===(e=this._layer)||void 0===e||e.release()},e.type=tq.canvas,e}(v9),D9=function(){x9(T9)},E9=function(t){ij.registerChartPlugin(t.type,t)},B9=/\{([^}]+)\}/,P9=/\{([^}]+)\}/g,R9=/:/,L9=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="formatterPlugin",i._timeModeFormat={utc:Ea.getInstance().timeUTCFormat,local:Ea.getInstance().timeFormat},i._formatter=i._format,i._timeFormatter=i._timeModeFormat.local,i._numericFormatter=Oa.getInstance().format,i._numericSpecifier=Oa.getInstance().formatter,i._numericFormatterCache=new Map,i._isNumericFormatterCache=new Map,i}return C(e,t),e.prototype.onInit=function(t,i){var n;if(t.globalInstance){this._spec=null!==(n=null==i?void 0:i[e.specKey])&&void 0!==n?n:{};var r=this._spec,a=r.timeMode,o=r.customFormatter,s=r.numericFormatter,l=r.timeFormatter;U(o)?this._formatter=o:(this._formatter=this._format.bind(this),U(l)?this._timeFormatter=l:a&&this._timeModeFormat[a]&&(this._timeFormatter=this._timeModeFormat[a]),s&&(this._numericFormatter=s,this._numericSpecifier=null,this._numericFormatterCache=null)),ij.registerFormatter(this._formatter)}},e.prototype._format=function(t,e,i){var n=this;return Z(t)?t.map((function(t,r){var a=Z(i)?i[r]:i;return a?n._formatSingleLine(t,e,a):t})):Z(i)?i.map((function(i){return n._formatSingleLine(t,e,i)})):this._formatSingleLine(t,e,i)},e.prototype._formatSingleLine=function(t,e,i){var n,r=this;if(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?n=this._isNumericFormatterCache.get(i):(n=B9.test(i),this._isNumericFormatterCache.set(i,n))),n){var a=i.replace(P9,(function(t,i){if(!R9.test(i)){var n=e[i.trim()];return void 0!==n?n:t}var a=i.split(":"),o=e[a.shift()],s=a.join(":");return r._formatSingleText(o,s)}));return a}return this._formatSingleText(t,i)},e.prototype._formatSingleText=function(t,e){if(La.test(e)&&this._numericFormatter){var i=void 0;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):e.startsWith("calc(")?this._calcFormatter(e,t):t},e.prototype._calcFormatter=function(t,e){try{var i=t.slice(5,-1).replace(/v/g,String(e));return this._calculateMathExpression(i,e)}catch(t){return e}},e.prototype._calculateMathExpression=function(t,e){var i=t.replace(/\s+/g,"");if(!this._isValidMathExpression(i))return e;try{var n=new Function("return ("+i+")")();if("number"!=typeof n||isNaN(n)||!isFinite(n))throw new Error("Invalid calculation result");return n}catch(t){return e}},e.prototype._isValidMathExpression=function(t){return/^[0-9+\-*/().]+$/.test(t)},e.prototype.release=function(){t.prototype.release.call(this),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null},e.pluginType="chart",e.specKey="formatter",e.type="formatterPlugin",e}(JY),I9=function(){E9(L9)},F9={state:t.STATE_VALUE_ENUM.STATE_ACTIVE,trigger:"pointerover",triggerOff:"pointerout"},O9=function(t){function e(e){var i=t.call(this,e)||this;return i.type="element-active",i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){i.reset(t.item)},i.options=Object.assign({},F9,e),i.updateMarkIdByState([i.options.state]),i}return C(e,t),e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]},e.prototype.getStartState=function(){return this.options.state},e.prototype.start=function(t){if(t){var e=this.options,i=e.state,n=e.interaction;this.isGraphicInStateMark(t,i)&&(t.addState(i,!0),n.setStatedGraphics(this,[t]))}},e.prototype.reset=function(t){var e=this.options,i=e.interaction,n=e.state,r=i.getStatedGraphics(this),a=null!=t?t:null==r?void 0:r[0];a&&r.includes(a)&&(a.removeState(n),i.setStatedGraphics(this,r.filter((function(t){return t!==a}))))},e.type="element-active",e.defaultOptions=F9,e}(pG),z9=function(){ij.registerInteractionTrigger(O9.type,O9)},H9="element-active-by-legend",N9={state:t.STATE_VALUE_ENUM.STATE_ACTIVE,filterType:"groupKey"},U9=function(e){function i(t){var i=e.call(this,t)||this;return i.type=H9,i.handleStart=function(t){var e,n,r=t.event;r&&i.start(null===(n=null===(e=r.detail)||void 0===e?void 0:e.data)||void 0===n?void 0:n.id)},i.handleReset=function(t){i.resetAll()},i.options=Object.assign({},N9,t),i.updateMarkIdByState([i.options.state]),i}return C(i,e),i.prototype.getEvents=function(){return[{type:t.ChartEvent.legendItemHover,handler:this.handleStart},{type:t.ChartEvent.legendItemUnHover,handler:this.handleReset}]},i.prototype.getStartState=function(){return this.options.state},i.prototype.start=function(t){if(!j(t)){var e=this.options,i=e.interaction,n=e.state,r=hG(this.options),a=i.getStatedGraphics(this),o=[];this.getMarks().forEach((function(e){var i;null===(i=e.getGraphics())||void 0===i||i.forEach((function(e){r(e)===t&&o.push(e)}))})),i.updateStates(this,o,a,n),i.setStatedGraphics(this,o)}},i.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.state;e.clearAllStatesOfTrigger(this,i),e.setStatedGraphics(this,[])},i.prototype.reset=function(t){var e=this.options,i=e.state,n=e.interaction;if(t){var r=n.getStatedGraphics(this);r&&r.includes(t)&&(t.removeState(i),n.setStatedGraphics(this,r.filter((function(e){return e!==t}))))}else this.resetAll()},i.type=H9,i.defaultOptions=N9,i}(pG),j9=function(){ij.registerInteractionTrigger(H9,U9)},V9="element-highlight-by-group",W9=function(t){function e(e){var i=t.call(this,e)||this;return i.type=V9,i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){var e=t.item;e&&i.isGraphicInMark(e)&&i.resetAll()},i.options=Object.assign({},dG,e),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return C(e,t),e.prototype.getStartState=function(){return this.options.highlightState},e.prototype.getResetState=function(){return this.options.blurState},e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]},e.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.highlightState,n=t.blurState;e.clearAllStatesOfTrigger(this,i,n),e.setStatedGraphics(this,[])},e.prototype._getHightlightKey=function(t){var e;return null===(e=t.context)||void 0===e?void 0:e.groupKey},e.prototype.start=function(t){var e=this;if(t&&this.isGraphicInMark(t)){var i=this._getHightlightKey(t);if(j(i))return;var n=this.options,r=n.interaction,a=n.highlightState,o=n.blurState,s=r.getStatedGraphics(this),l=[];this.getMarks().forEach((function(t){var n;null===(n=t.getGraphics())||void 0===n||n.forEach((function(t){e._getHightlightKey(t)===i&&l.push(t)}))})),r.updateStates(this,l,s,a,o),r.setStatedGraphics(this,l)}},e.prototype.reset=function(t){if(t){if(this.isGraphicInMark(t)){var e=this.options.interaction,i=e.getStatedGraphics(this);t.removeState([this.options.highlightState,this.options.blurState]),e.setStatedGraphics(this,i.filter((function(e){return e!==t})))}}else this.resetAll()},e.type=V9,e.defaultOptions=dG,e}(pG),G9=function(){ij.registerInteractionTrigger(V9,W9)},Y9="element-highlight-by-key",X9=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Y9,e}return C(e,t),e.prototype._getHightlightKey=function(t){var e;return null===(e=t.context)||void 0===e?void 0:e.key},e.type=Y9,e}(W9),K9=function(){ij.registerInteractionTrigger(Y9,X9)},q9="element-highlight-by-legend",Z9={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,filterType:"groupKey"},J9=function(e){function i(t){var i=e.call(this,t)||this;return i.type=q9,i.handleStart=function(t){var e,n,r=t.event;r&&i.start(null===(n=null===(e=r.detail)||void 0===e?void 0:e.data)||void 0===n?void 0:n.id)},i.handleReset=function(t){i.resetAll()},i.options=Object.assign({},Z9,t),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return C(i,e),i.prototype.getStartState=function(){return this.options.highlightState},i.prototype.getResetState=function(){return this.options.blurState},i.prototype.getEvents=function(){return[{type:t.ChartEvent.legendItemHover,handler:this.handleStart},{type:t.ChartEvent.legendItemUnHover,handler:this.handleReset}]},i.prototype.start=function(t){if(t){var e=hG(this.options),i=this.options,n=i.interaction,r=i.highlightState,a=i.blurState,o=n.getStatedGraphics(this),s=[];this.getMarks().forEach((function(i){var n;null===(n=i.getGraphics())||void 0===n||n.forEach((function(i){e(i)===t&&s.push(i)}))})),n.updateStates(this,s,o,r,a),n.setStatedGraphics(this,s)}},i.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.highlightState,n=t.blurState;e.clearAllStatesOfTrigger(this,i,n),e.setStatedGraphics(this,[])},i.prototype.reset=function(t){var e=this.options,i=e.highlightState,n=e.blurState,r=e.interaction;if(t){var a=r.getStatedGraphics(this);a&&a.includes(t)&&(t.removeState([i,n]),r.setStatedGraphics(this,a.filter((function(e){return e!==t}))))}else this.resetAll()},i.type=q9,i.defaultOptions=Z9,i}(pG),Q9=function(){ij.registerInteractionTrigger(q9,J9)},$9="element-highlight-by-name",ttt={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,filterType:"groupKey"},ett=function(t){function e(e){var i=t.call(this,e)||this;return i.type=$9,i.handleStart=function(t){if(i.options.shouldStart?i.options.shouldStart(t):i._filterByName(t)){var e=i._parseTargetKey(t);i.start(e)}},i.handleReset=function(t){(i.options.shouldReset?i.options.shouldReset(t):i._filterByName(t))&&i.resetAll()},i.options=Object.assign({},ttt,e),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return C(e,t),e.prototype.getStartState=function(){return this.options.highlightState},e.prototype.getResetState=function(){return this.options.blurState},e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]},e.prototype._filterByName=function(t){var e,i=Dt(this.options.graphicName);return(null===(e=null==t?void 0:t.node)||void 0===e?void 0:e.name)&&i.includes(t.node.name)},e.prototype._parseTargetKey=function(t){return this.options.parseData?this.options.parseData(t):"text"===t.node.type?t.node.attribute.text:null},e.prototype.start=function(t){if(t){var e=hG(this.options),i=this.options,n=i.interaction,r=i.highlightState,a=i.blurState,o=n.getStatedGraphics(this),s=[];this.getMarks().forEach((function(i){var n;null===(n=i.getGraphics())||void 0===n||n.forEach((function(i){e(i)===t&&s.push(i)}))})),n.updateStates(this,s,o,r,a),n.setStatedGraphics(this,s)}},e.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.highlightState,n=t.blurState;e.clearAllStatesOfTrigger(this,i,n),e.setStatedGraphics(this,[])},e.prototype.reset=function(t){var e=this.options,i=e.highlightState,n=e.blurState,r=e.interaction;if(t){var a=r.getStatedGraphics(this);a&&a.includes(t)&&(t.removeState([i,n]),r.setStatedGraphics(this,a.filter((function(e){return e!==t}))))}else this.resetAll()},e.type=$9,e.defaultOptions=ttt,e}(pG),itt=function(){ij.registerInteractionTrigger($9,ett)},ntt=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return C(e,t),e.prototype._getDefaultStyle=function(){return M(M({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="image",e}(NW),rtt=function(){ij.registerMark(ntt.type,ntt),cP(),KB(),ij.registerGraphicComponent("image",n_)},att=function(){jW(),NY(),jY(),OZ(),wJ(),fq(),Lq(),dZ(),aQ(),A2(),rtt(),v5(),wX()};xG.useRegisters([hq,Aq,Gq,oZ,r4,l4,h4,k4,J5,T4,P4,R4,F4,t8,n8,C4,H4,j4,u8,G4,K4,J4,o8,d8,y4,v8,f4,KX,QX,tK,iK,rK,EQ,TQ,k8,L8,X8,Q8,t6,g6,_6,A6,kZ,l7,y7,U7,c7,_7,V7,G7,p7,w7,R7,O7,Z7,Q7,i9,e9,att,S9,D9,I9,z9,j9,Q9,itt,G9,K9,lG,IA,RA]);var ott=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["valueField","maskShape","reverse","outlineMargin","outlinePadding","indicatorSmartInvert","liquidBackground","liquidOutline"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),stt=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=ott,i.type="liquid",i.seriesType=t.SeriesTypeEnum.liquid,i}return C(i,e),i.type="liquid",i.seriesType=t.SeriesTypeEnum.liquid,i.transformerConstructor=ott,i}(CK),ltt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","circle","overlap","overlapLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(wK),utt=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=ltt,i.type="venn",i.seriesType=t.SeriesTypeEnum.venn,i}return C(i,e),i.type="venn",i.seriesType=t.SeriesTypeEnum.venn,i.transformerConstructor=ltt,i}(CK),ctt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar","bandWidthField"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),eW(e)},e.prototype._setDefaultXAxisSpec=function(t){return{orient:"bottom",type:"linear",label:{visible:!1}}},e.prototype._setDefaultYAxisSpec=function(t){return{orient:"left",type:"linear"}},e}(TK),htt=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=ctt,i.type="mosaic",i.seriesType=t.SeriesTypeEnum.mosaic,i.handleAfterStackRegion=function(t,e){t.getSeries().forEach((function(t){var i=t.getStackData(),n=t.getStackValue(),r=t.getStackValueField();i&&r&&(rV(e[n],r),aV(t,e[n]))}))},i}return C(i,e),i.prototype._beforeInit=function(){this._dataSet&&EV(this._dataSet,"stackSplit",EK)},i.prototype._initStack=function(){this._stack=new BK(this,{afterStackRegion:this.handleAfterStackRegion}),this._stack.init()},i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=jK,this._modelOption.getDimensionInfoByValue=WK,this._modelOption.getRectByDimensionData=ZK},i.type="mosaic",i.seriesType=t.SeriesTypeEnum.mosaic,i.transformerConstructor=ctt,i}(CK),dtt=function(e,i,n){var r,a,o,s,l,u,c,h,d,p,f;void 0===e&&(e="chart");var v={modelInfo:[]};if("chart"===e)v.isChart=!0,v.modelInfo.push({spec:i,type:"chart"});else if("region"===e)v.modelType="region",v.specKey="region",null===(r=i.region)||void 0===r||r.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["region",e],type:"region"})}));else if("series"===e)v.modelType="series",v.specKey="series",null===(a=i.series)||void 0===a||a.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["series",e],type:t.type})}));else if(Object.values(t.SeriesTypeEnum).includes(e))v.modelType="series",v.specKey="series",v.type=e,null===(o=i.series)||void 0===o||o.forEach((function(t,i){t.type===e&&v.modelInfo.push({spec:t,specPath:["series",i],type:e})}));else if(Object.values(L).includes(e)){v.modelType="component",v.type=e,v.specKey=null===(s=ij.getComponentInKey(e))||void 0===s?void 0:s.specKey;var g=v.specKey,y=Dt(null!==(u=null===(l=n.component)||void 0===l?void 0:l[g])&&void 0!==u?u:[]);null===(h=Dt(null!==(c=i[g])&&void 0!==c?c:[]))||void 0===h||h.forEach((function(t,i){var n=y[i];n&&n.type===e?v.modelInfo.push(M(M({},n),{spec:t})):t&&!1===t.visible&&v.modelInfo.push({type:e,spec:t})}))}else{var m=ij.getComponents().filter((function(t){return t.cmp.specKey===e})).map((function(t){return t.cmp.type}));if(m.length>0){v.modelType="component";g=e;v.specKey=g;var _=Dt(null!==(p=null===(d=n.component)||void 0===d?void 0:d[g])&&void 0!==p?p:[]);Dt(null!==(f=i[g])&&void 0!==f?f:[]).forEach((function(t,e){var i=_[e];i&&m.includes(i.type)&&v.modelInfo.push(M(M({},i),{spec:t}))}))}}return v},ptt=function(t,e,i,n){var r,a,o=t.spec,s=t.filter,l=t.filterType,u=t.forceAppend,c=function(t,e,i,n,r,a){void 0===t&&(t="chart");var o=dtt(t,r,a);return M(M({},o),{modelInfo:o.modelInfo.filter((function(t){return!!j(e)||Dt(e).some((function(e){return U(e)?e(t,i,n):JU(t.spec,e)}))}))})}(l,s,t,e,i,n),h=c.isChart,d=c.modelType,p=c.specKey,f=c.type,v=c.modelInfo;if(0===v.length&&!u)return{chartSpec:i,hasChanged:!1};var g=ej({},i),y=U(o)?o(v,t,e):o;try{for(var m=E(v),_=m.next();!_.done;_=m.next()){var b=_.value,x=b.spec,k=b.specPath;if(h)return{chartSpec:ej(g,y),hasChanged:!0};var S=ej({},x,y);QU(g,k,S)}}catch(t){r={error:t}}finally{try{_&&!_.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}if(0===v.length&&u){var A=M({type:f},y);Z(g[p])?g[p].push(A):j(g[p])?g[p]="component"===d?A:[A]:g[p]=[g[p],A]}return{chartSpec:g,hasChanged:!0}},ftt=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="MediaQueryPlugin",i._currentMediaInfo={},i.currentActiveItems=new Set,i._initialized=!1,i}return C(e,t),e.prototype.onInit=function(t,i){if(null==i?void 0:i[e.specKey]){var n=t.globalInstance;this._option={globalInstance:t.globalInstance,updateSpec:function(t,e,i){i?n.updateSpecSync(t):e?n.updateSpecAndRecompile(t,!1,{transformSpec:!0}):n.setRuntimeSpec(t)}},this._spec=i[e.specKey],this._initialized=!0}},e.prototype.onBeforeResize=function(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)},e.prototype.onAfterChartSpecTransform=function(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)},e.prototype.onAfterModelSpecTransform=function(t,e,i,n){this._initialized&&"updateSpec"===n&&this.onBeforeInitChart(t,e,"setCurrentTheme")},e.prototype.onBeforeInitChart=function(t,e,i){if(this._initialized){var n,r;switch(i){case"render":case"updateModelSpec":n=!1,r=!0;break;case"setCurrentTheme":n=!0,r=!1;break;case"updateSpecAndRecompile":n=!1,r=!1}if(n&&this.release(),this._initialized||this.onInit(t,e),n||r){var a=this._option.globalInstance.getCurrentSize(),o=a.width,s=a.height;this._changeSize(o,s,!1,!1)}}},e.prototype._changeSize=function(t,e,i,n){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,n))},e.prototype._applyQueries=function(t,i){var n,r,a=this,o=[],s=[];if(this._spec.forEach((function(t){var e=a._check(t),i=e.hasChanged,n=e.isActive;i&&(n?o.push(t):s.push(t))})),!o.length&&!s.length)return!1;this._baseChartSpec||(this._baseChartSpec=tj(this._option.globalInstance.getSpec(),["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());var l=!1;return s.length>0?(n=tj(this._baseChartSpec,["data",e.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach((function(t){if(s.includes(t))a.currentActiveItems.delete(t);else{var e=a._apply(t,n,r);n=e.chartSpec}})),l=!0):(n=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),o.forEach((function(t){a.currentActiveItems.add(t);var e=a._apply(t,n,r);n=e.chartSpec,l||(l=e.hasChanged)})),l&&this._option.updateSpec(n,t,i),!0},e.prototype._check=function(t){var e=this._option.globalInstance,i=function(t,e,i){for(var n in t)switch(n){case"maxHeight":if(W(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if(W(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if(W(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if(W(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if(W(t.onResize)&&!t.onResize(e,i))return!1}return!0}(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}},e.prototype._apply=function(t,e,i){var n=t.query,r=t.action,a=!1;return Dt(r).forEach((function(t){var r=ptt(t,n,e,i);e=r.chartSpec,a||(a=r.hasChanged)})),{chartSpec:e,hasChanged:a}},e.prototype._reInit=function(t,i){var n=this,r=this._option.globalInstance.getSpec();this._baseChartSpec=tj(r,["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();var a=!1;this.currentActiveItems.forEach((function(t){var e=n._apply(t,r,n._baseChartSpecInfo);r=e.chartSpec,a||(a=e.hasChanged)})),a&&this._option.updateSpec(r,t,i)},e.prototype.release=function(){t.prototype.release.call(this),this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()},e.pluginType="chart",e.specKey="media",e.type="MediaQueryPlugin",e}(JY),vtt=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="ChartResizeZoomPlugin",i._zoom=1,i._onWheel=function(t){t.preventDefault(),t.stopImmediatePropagation();var e=Math.pow(1.005,-t.deltaY*Math.pow(16,t.deltaMode)*.2*i._rate),n={x:t.offsetX,y:t.offsetY};i.zoom(e,n)},i}return C(e,t),e.prototype.onAfterInitChart=function(t,i){var n,r,a,o,s,l=t.globalInstance,u=null!==(r=null===(n=l.getSpec())||void 0===n?void 0:n[e.specKey])&&void 0!==r?r:{enabled:!1};!0===u.enabled&&(this._minZoom=null!==(a=u.min)&&void 0!==a?a:.1,this._maxZoom=null!==(o=u.max)&&void 0!==o?o:10,this._rate=null!==(s=u.rate)&&void 0!==s?s:.1,this._container=l.getContainer(),this._triggerEvent=yZ(t.globalInstance.getChart().getOption().mode).zoom,this._container&&this._triggerEvent&&this._container.addEventListener(this._triggerEvent,this._onWheel))},e.prototype.zoom=function(t,e){var i=this.service.globalInstance;if(i){var n=this._zoom,r=this._zoom*t;if(r<=this._minZoom&&t<1||r>=this._maxZoom&&t>1)if(r<=this._minZoom&&this._zoom>this._minZoom)r=this._minZoom;else{if(!(r>=this._maxZoom&&this._zoom<this._maxZoom))return;r=this._maxZoom}if(r!==n){var a=r/n;if(this._zoom=r,i.resize(i.getCurrentSize().width*this._zoom,i.getCurrentSize().height*this._zoom),e&&this._container){var o=this._container,s=o.scrollLeft,l=o.scrollTop;this._container.scrollLeft=s+e.x*(a-1),this._container.scrollTop=l+e.y*(a-1)}}}},e.prototype.release=function(){this._container&&this._triggerEvent&&this._container.removeEventListener(this._triggerEvent,this._onWheel)},e.specKey="resizeZoom",e.type="ChartResizeZoomPlugin",e}(JY);var gtt=function(){function t(t,e,i,n,r){this.state=t,this.graphics=e,this.config=i||[],this.beforeExecute=n,this.afterExecute=r}return t.prototype.execute=function(t,e){var i=this;if(this.graphics.length&&this.config.length){this.beforeExecute&&this.beforeExecute(this.graphics);var n=0,r=this.graphics.length,a=function(){++n>=r&&(i.afterExecute&&i.afterExecute(i.graphics),null==e||e())};this.graphics.forEach((function(t){if(t){"exit"===i.state&&(t.isExiting=!0);var e=i.config.length>1?i.config.map((function(e){return{name:i.state,animation:M(M({},e),{customParameters:t.context})}})):{name:i.state,animation:M(M({},i.config[0]),{customParameters:t.context})};t.applyAnimationState([i.state],[e],a)}else n++}))}else null==e||e()},t.prototype.executeOnGroup=function(t,e){var i=this;if(this.graphics.length&&this.config.length&&t){this.beforeExecute&&this.beforeExecute(this.graphics);var n=this.config[0],r=[{name:this.state,animation:M({},n)}];r.forEach((function(t){t.animation.customParameters=function(t,e){return e.context}})),t.applyAnimationState([this.state],r,(function(){i.afterExecute&&i.afterExecute(i.graphics),null==e||e()}))}else null==e||e()},t}(),ytt=function(){function t(){this.name="verticalBarSplit"}return t.prototype.shouldApply=function(t,e){var i,n,r="rect"===t.type,a="vertical"===(null===(i=t.model)||void 0===i?void 0:i.direction),o=(null===(n=e.context)||void 0===n?void 0:n.diffAttrs)||{};return r&&a&&("x"in o||"width"in o||"x1"in o)&&("y"in o||"height"in o||"y1"in o)},t.prototype.split=function(t,e){var i,n=(null===(i=e.context)||void 0===i?void 0:i.diffAttrs)||{},r={},a={};Object.entries(n).forEach((function(t){var e=B(t,2),i=e[0],n=e[1];"x"===i||"width"===i||"x1"===i?r[i]=n:"y"===i||"height"===i||"y1"===i?a[i]=n:r[i]=n}));var o=e.context,s=o.fieldX,l=o.originalFieldX,u=Array.isArray(s)&&s.length>1,c=(l?!(Array.isArray(l)&&l.length>1):!u)&&u;return[{attrs:r,order:c?1:2},{attrs:a,order:c?2:1}]},t}(),mtt=function(){function t(){this.name="horizontalBarSplit"}return t.prototype.shouldApply=function(t,e){var i,n,r="rect"===t.type,a="horizontal"===(null===(i=t.model)||void 0===i?void 0:i.direction),o=(null===(n=e.context)||void 0===n?void 0:n.diffAttrs)||{};return r&&a&&("y"in o||"height"in o||"y1"in o)&&("x"in o||"width"in o||"x1"in o)},t.prototype.split=function(t,e){var i,n=(null===(i=e.context)||void 0===i?void 0:i.diffAttrs)||{},r={},a={};Object.entries(n).forEach((function(t){var e=B(t,2),i=e[0],n=e[1];"y"===i||"height"===i||"y1"===i?r[i]=n:"x"===i||"width"===i||"x1"===i?a[i]=n:r[i]=n}));var o=e.context,s=o.fieldY,l=o.originalFieldY,u=Array.isArray(s)&&s.length>1,c=!(l?!(Array.isArray(l)&&l.length>1):!u)&&!u;return[{attrs:r,order:c?2:1},{attrs:a,order:c?1:2}]},t}(),_tt=function(){function t(t){this.splitStrategies=[],this.mark=t,"rect"===t.type&&(this.registerStrategy(new ytt),this.registerStrategy(new mtt))}return t.prototype.registerStrategy=function(t){this.splitStrategies.push(t)},t.prototype.detect=function(t,e){var i=[],n=[],r=[],a=[],o=this.mark.model.fieldX,s=this.mark.model.fieldY;return t.forEach((function(t){var e=t.context;switch(e.fieldX&&(e.originalFieldX=e.fieldX),e.fieldY&&(e.originalFieldY=e.fieldY),e.fieldX=o,e.fieldY=s,t.context.animationState){case"update":n.push(t);break;case"enter":r.push(t);break;case"appear":a.push(t);break;default:t.context.diffState===AW.exit?i.push(t):t.context.diffState===AW.enter?r.push(t):n.push(t)}})),e.size>t.length&&e.forEach((function(t,e){t.context.diffState!==AW.exit||t.isExiting||i.push(t)})),{hasExit:i.length>0,hasUpdate:n.length>0,hasEnter:r.length>0,hasAppear:a.length>0,exitGraphics:i,updateGraphics:n,enterGraphics:r,appearGraphics:a}},t.prototype.createPlanners=function(t,e){var i=this,n=[];if(t.hasExit&&e.exit&&n.push(new gtt("exit",t.exitGraphics,e.exit)),t.hasUpdate&&e.update){var r=new Map,a=[];t.updateGraphics.forEach((function(t){var e,n,o=!1,s=function(e){if(e.shouldApply(i.mark,t)){var n=e.split(i.mark,t),a={graphic:t,steps:n};return n.forEach((function(t){var e=t.order;r.has(e)||r.set(e,[]),r.get(e).push(a)})),o=!0,"break"}};try{for(var l=E(i.splitStrategies),u=l.next();!u.done;u=l.next()){if("break"===s(u.value))break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}o||a.push(t)})),a.length>0&&n.push(new gtt("update",a,e.update));var o=Array.from(r.keys()).sort((function(t,e){return t-e}));o.forEach((function(t){var i=r.get(t);if(i&&i.length>0){var a=i.map((function(e){var i=e.graphic,n=e.steps.find((function(e){return e.order===t}));return{graphic:i,attrs:(null==n?void 0:n.attrs)||{}}}));n.push(new gtt("update",a.map((function(t){return t.graphic})),e.update,(function(t){t.forEach((function(t,e){var i=a[e].attrs,n=t.context;n._originalDiffAttrs||(n._originalDiffAttrs=t.context.diffAttrs),t.context.diffAttrs=i}))}),(function(e){t===o[o.length-1]&&e.forEach((function(t){var e=t.context;e._originalDiffAttrs&&(t.context.diffAttrs=e._originalDiffAttrs,delete e._originalDiffAttrs)}))})))}}))}return t.hasEnter&&e.enter&&n.push(new gtt("enter",t.enterGraphics,e.enter)),t.hasAppear&&e.appear&&n.push(new gtt("appear",t.appearGraphics,e.appear)),n},t}(),btt=function(){function t(){}return t.prototype.registerAnimationSplitStrategy=function(t){this._grammarDetector||(this._grammarDetector=new _tt(this)),this._grammarDetector.registerStrategy(t)},t.prototype.getGrammarDetector=function(){return this.initGrammarDetector(),this._grammarDetector},t.prototype.initGrammarDetector=function(){this._grammarDetector||(this._grammarDetector=new _tt(this))},t.prototype._runSequentialAnimations=function(t){this.initGrammarDetector();var e=this.getAnimationConfig(),i=this._grammarDetector.detect(t,this._graphicMap),n=this._grammarDetector.createPlanners(i,e);this._executePlanners(n,0)},t.prototype._executePlanners=function(t,e){var i=this;if(!(e>=t.length)){var n=t[e];n.execute(this._product,(function(){i._executePlanners(t,e+1),"exit"===n.state&&n.graphics.forEach((function(t){t.isExiting&&(i._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release&&t.release())}))}))}},t}();t.AABBBounds=On,t.ACustomAnimate=NL,t.AbstractComponent=$A,t.AnimateExecutor=DL,t.ArcMark=rQ,t.AreaChart=Sq,t.AreaMark=pq,t.AreaSeries=bq,t.AxisSyncPlugin=QY,t.BandAxisMixin=qX,t.BarChart=Vq,t.BarChartSpecTransformer=jq,t.BarSeries=Nq,t.BarSeriesSpecTransformer=zq,t.BaseArcMark=nQ,t.BaseChart=CK,t.BaseChartSpecTransformer=wK,t.BaseComponent=CX,t.BaseComponentSpecTransformer=AX,t.BaseHistogramChart=_4,t.BaseMark=NW,t.BasePieChart=i4,t.BasePieChartSpecTransformer=e4,t.BasePieSeries=cQ,t.BasePlugin=JY,t.BasePolygonMark=k2,t.BaseSeries=dY,t.BaseSeriesSpecTransformer=hY,t.BaseSeriesTooltipHelper=OG,t.BaseWordCloudChart=E4,t.BaseWordCloudChartSpecTransformer=D4,t.BaseWordCloudSeries=O$,t.Bounds=Fn,t.BoxPlotChart=i8,t.BoxPlotSeries=AJ,t.Brush=q7,t.CanvasTooltipHandler=T9,t.CartesianAxis=RX,t.CartesianBandAxis=JX,t.CartesianChartSpecTransformer=TK,t.CartesianCrossHair=J8,t.CartesianLinearAxis=XX,t.CartesianLogAxis=eK,t.CartesianMarkArea=g7,t.CartesianMarkLine=s7,t.CartesianMarkPoint=N7,t.CartesianSeries=gY,t.CartesianSymlogAxis=nK,t.CartesianTimeAxis=$X,t.ChartResizeZoomPlugin=vtt,t.CirclePackingChart=X4,t.CirclePackingLayout=r0,t.CirclePackingSeries=$2,t.CircularProgressChart=A4,t.CircularProgressSeries=g$,t.Color=Qn,t.ColorUtil=nr,t.CommonChart=p4,t.CommonChartSpecTransformer=d4,t.CompilableData=IW,t.ComponentMark=MX,t.ContinuousLegend=R8,t.CorrelationChart=f8,t.CorrelationSeries=_5,t.CustomMark=J7,t.DAY=pr,t.DEFAULT_ANIMATION_CONFIG=JW,t.DEFAULT_CHART_HEIGHT=Tj,t.DEFAULT_CHART_WIDTH=wj,t.DEFAULT_CLOSE_STROKE_JOIN=AG,t.DEFAULT_COLORS=Yn,t.DEFAULT_DATA_INDEX=Ej,t.DEFAULT_DATA_KEY=Bj,t.DEFAULT_DATA_SERIES_FIELD=Pj,t.DEFAULT_KEY=Jj,t.DEFAULT_LAYOUT_RECT_LEVEL=0,t.DEFAULT_LAYOUT_RECT_LEVEL_MIN=-1,t.DEFAULT_LINEAR_INTERPOLATE=SG,t.DEFAULT_MEASURE_CANVAS_ID=Dj,t.DEFAULT_SERIES_STYLE_NAME=Rj,t.DEFAULT_SMOOTH_INTERPOLATE=kG,t.DataSet=uc,t.DataView=cc,t.DataZoom=v6,t.DimensionClickEvent=wY,t.DimensionHoverEvent=PY,t.DiscreteLegend=x8,t.DomTooltipHandler=k9,t.DotSeries=t$,t.ElementHighlight=vG,t.ElementSelect=mG,t.Event=xV,t.EventEmitter=z,t.Factory=ij,t.FormatSpecifier=Ra,t.FormatterPlugin=L9,t.FunnelChart=I4,t.FunnelChartSpecTransformer=L4,t.FunnelSeries=w2,t.FunnelSeriesSpecTransformer=M2,t.GaugeChart=w4,t.GaugePointerSeries=W3,t.GaugeSeries=K3,t.GeoCoordinate=xZ,t.GeoMarkPoint=W7,t.GeoSeries=sZ,t.GlyphMark=lJ,t.GraphicUtil=_n,t.GridLayout=$7,t.GroupMark=UW,t.HOUR=dr,t.HashTable=Ze,t.HashValue=qe,t.HeatmapChart=h8,t.HeatmapSeries=r5,t.HistogramChart=x4,t.HistogramChartSpecTransformer=b4,t.ImageCloudGridLayout=a2,t.ImageCloudSpiralLayout=Q1,t.ImageCloudStackLayout=o2,t.ImageMark=ntt,t.Indicator=S6,t.LRU=Un,t.Label=P7,t.Layout=wW,t.LineChart=uq,t.LineMark=HY,t.LineSeries=_K,t.LinearAxisMixin=jX,t.LinearProgressChart=z4,t.LinearProgressSeries=w$,t.LinkSeries=o$,t.LiquidChart=stt,t.LiquidSeries=R5,t.Logger=Wt,t.MINUTE=6e4,t.MONTH=26784e5,t.MOSAIC_CAT_END_PERCENT=Kj,t.MOSAIC_CAT_START_PERCENT=Xj,t.MOSAIC_VALUE_END_PERCENT=Yj,t.MOSAIC_VALUE_START_PERCENT=Gj,t.ManualTicker=wL,t.MapChart=Z5,t.MapSeries=CZ,t.MarkPoint=sN,t.Matrix=Hn,t.MediaQuery=ftt,t.MosaicChart=htt,t.MosaicSeries=X5,t.NEWTON_ITERATIONS=4,t.NEWTON_MIN_SLOPE=.001,t.NumberUtil=Oa,t.OBBBounds=zn,t.PREFIX=Mj,t.PathMark=hZ,t.PieChart=n4,t.PieSeries=hQ,t.PieSeriesSpecTransformer=sQ,t.Player=M7,t.Point=ki,t.PointService=Si,t.PolarAxis=AQ,t.PolarBandAxis=DQ,t.PolarCrossHair=$8,t.PolarLinearAxis=wQ,t.PolarMarkArea=m7,t.PolarMarkLine=u7,t.PolarMarkPoint=j7,t.PolarPoint=Ai,t.PolarSeries=GJ,t.PolygonMark=S2,t.ProgressLikeSeries=u$,t.RGB=$n,t.RadarChart=c4,t.RadarSeries=VQ,t.RangeAreaChart=l8,t.RangeAreaSeries=VJ,t.RangeColumnChart=U4,t.RangeColumnSeries=HJ,t.RangeColumnSeriesSpecTransformer=OJ,t.RectMark=Rq,t.RippleMark=f5,t.RoseChart=s4,t.RoseLikeSeries=xQ,t.RoseSeries=PQ,t.RotateBySphereAnimate=fI,t.RuleMark=FZ,t.SECOND=1e3,t.SEGMENT_FIELD_END=Zj,t.SEGMENT_FIELD_START=qj,t.SMALL=ka,t.STACK_FIELD_END=Fj,t.STACK_FIELD_END_OffsetSilhouette=Nj,t.STACK_FIELD_END_PERCENT=zj,t.STACK_FIELD_KEY=Lj,t.STACK_FIELD_START=Ij,t.STACK_FIELD_START_OffsetSilhouette=Hj,t.STACK_FIELD_START_PERCENT=Oj,t.STACK_FIELD_TOTAL=Uj,t.STACK_FIELD_TOTAL_BOTTOM=Wj,t.STACK_FIELD_TOTAL_PERCENT=jj,t.STACK_FIELD_TOTAL_TOP=Vj,t.SUBDIVISION_MAX_ITERATIONS=10,t.SUBDIVISION_PRECISION=1e-7,t.SankeyChart=a8,t.SankeyLayout=p0,t.SankeySeries=x3,t.ScatterChart=rZ,t.ScatterSeries=eZ,t.ScrollBar=m6,t.Segment=TR,t.SequenceChart=g4,t.Stack=BK,t.StackChartMixin=PK,t.StreamLight=AF,t.SunburstChart=W4,t.SunburstLayout=m0,t.SunburstSeries=G2,t.SymbolMark=UY,t.TextMark=MJ,t.TextMeasure=Bn,t.ThemeManager=_j,t.TimeUtil=Ea,t.Title=d7,t.Tooltip=Y8,t.TotalLabel=I7,t.TreeLayout=D0,t.TreemapChart=Z4,t.TreemapLayout=R0,t.TreemapSeries=P3,t.USER_LAYOUT_RECT_LEVEL=9,t.VChart=xG,t.VennChart=utt,t.VennSeries=W5,t.WaterfallChart=$4,t.WaterfallSeries=iJ,t.WordCloudChart=B4,t.WordCloudSeries=s2,t.WordcloudCloudLayout=n1,t.WordcloudFastLayout=x1,t.WordcloudGridLayout=b1,t.YEAR=31536e6,t.aabbSeparation=Rn,t.abs=ii,t.acos=ci,t.alternatingWave=function(t,e,i,n,r,a,o){var s=e/n,l=i/r,u=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)*Math.sin(2*a*Math.PI-2*l*Math.PI)+1)/2;return Math.min(1,Math.max(0,u))},t.animationConfig=nY,t.array=Dt,t.arrayEqual=Rt,t.ascending=zt,t.asin=hi,t.atan2=ni,t.barGrowIn=Mq,t.barGrowOut=wq,t.barPresetAnimation=Eq,t.baseMerge=vt,t.baseSeriesMark=qG,t.binaryFuzzySearch=Xt,t.binaryFuzzySearchInNumberRange=Kt,t.bisect=Gt,t.boundsInRect=UU,t.builtinThemes=lj,t.calcLayoutNumber=HU,t.calcPadding=NU,t.calculateAnchorOfArc=function(t,e){var i=t.startAngle,n=t.endAngle,r=t.innerRadius,a=t.outerRadius,o=(i+n)/2,s=(r+a)/2;switch(e){case"inner-start":o=i,s=r;break;case"outer-start":o=i,s=a;break;case"inner-end":o=n,s=r;break;case"outer-end":o=n,s=a;break;case"inner-middle":s=r;break;case"outer-middle":s=a}return{angle:o,radius:s}},t.calculateAnchorOfBounds=Pn,t.calculateMaxRadius=Oi,t.calculateNodeValue=H$,t.cartesianToPolar=Ri,t.centerToCorner=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=1-Math.min(h,1),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.circleArea=Ca,t.circleCircleIntersection=wa,t.circleOverlap=Ma,t.circlePackingTransform=function(t,e){var i=new r0(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){var n=[];return j$(i,n,{maxDepth:null==t?void 0:t.maxDepth}),n}return i},t.clamp=he,t.clampAngleByDegree=Bi,t.clampAngleByRadian=Di,t.clampDegree=Ei,t.clampRadian=Ti,t.clampRange=de,t.clamper=pe,t.clone=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r=[],a=[];return void 0===e&&(e=!0),void 0===i&&(i=1/0),function t(i,o){if(null===i)return null;if(0===o)return i;var s,l,u;if("object"!=k(i))return i;if(Z(i)?s=[]:rt(i)?(s=new RegExp(i.source,(u="",(l=i).global&&(u+="g"),l.ignoreCase&&(u+="i"),l.multiline&&(u+="m"),u)),i.lastIndex&&(s.lastIndex=i.lastIndex)):s=Q(i)?new Date(i.getTime()):void 0===n?Object.create(Object.getPrototypeOf(i)):Object.create(n),e){var c=r.indexOf(i);if(-1!==c)return a[c];r.push(i),a.push(s)}for(var h in i)s[h]=t(i[h],o-1);return s}(t,i)},t.cloneDeep=ft,t.columnCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=r/2,c=Math.abs(i-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.columnEdgeToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=r/2,c=1-Math.abs(i-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.columnLeftToRight=function(t,e,i,n,r,a,o){var s=i/r,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.columnRightToLeft=function(t,e,i,n,r,a,o){var s=(r-1-i)/r,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.computeActualDataScheme=kU,t.computeQuadrant=zi,t.conjugateGradient=Ka,t.constant=ae,t.containedInCircles=Aa,t.convertPoint=VU,t.cornerToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=Math.min(h,1),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.cos=ri,t.createArc=__,t.createArc3d=x_,t.createArea=g_,t.createGroup=Vy,t.createImage=n_,t.createLine=jm,t.createPath=p_,t.createPyramid3d=M_,t.createRect=Ym,t.createRect3d=qm,t.createRichText=c_,t.createScale=BU,t.createScaleWithSpec=PU,t.createSymbol=Hm,t.createText=Fm,t.crossProduct=fi,t.crossProductPoint=vi,t.darkTheme=ZU,t.dataScheme=GU,t.dateGetterName=sr,t.dateSetterName=function(t){return t?"setUTCDate":"setDate"},t.dayCount=Pr,t.dayField=Rr,t.dayFloor=Er,t.dayOffset=Br,t.debounce=ve,t.default=xG,t.defaultThemeName=uj,t.defaults=wt,t.degreeToRadian=Ci,t.destination=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=Ci(t[0]),a=Ci(t[1]),o=Ci(i),s=function(t,e){void 0===e&&(e="kilometers");var i=_a[e];if(!i)throw new Error(e+" units is invalid");return t/i}(e,n.units),l=Math.asin(Math.sin(a)*Math.cos(s)+Math.cos(a)*Math.sin(s)*Math.cos(o));return{x:Mi(r+Math.atan2(Math.sin(o)*Math.sin(s)*Math.cos(a),Math.cos(s)-Math.sin(a)*Math.sin(l))),y:Mi(l)}},t.deviation=function(t,e){var i=qt(t,e);return i?Math.sqrt(i):i},t.diagonalCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/n,2)+Math.pow((i-c)/r,2)),d=s+l*(Math.sin(2*a*Math.PI-2*h*Math.PI)+1)/2;return Math.min(1,Math.max(0,d))},t.diagonalTopLeftToBottomRight=function(t,e,i,n,r,a,o){var s=(e/n+i/r)/2,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.dotProduct=gi,t.drawCardioid=v1,t.drawRegularPolygon=f1,t.eachAfter=U$,t.eachBefore=N$,t.eastAsianCharacterInfo=Tn,t.ecdf=function(t){var e=t.length,i=t.slice().sort((function(t,e){return t-e}));function n(t){if(0===e)return 0;for(var n=0,r=e;n<r;){var a=n+r>>>1;i[a]<=t?n=a+1:r=a}return n/e}return{evaluate:function(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(n(t[i]));return e}return n(t)},evaluateGrid:function(t){var r=[];if(t<=0)return r;if(0===e)return r;var a=i[0],o=i[e-1];if(a===o){for(var s=0;s<t;s++)r.push({x:a,y:1});return r}for(var l=(o-a)/(t-1),u=0;u<t;u++){var c=u===t-1?o:a+l*u;r.push({x:c,y:n(c)})}return r},n:e}},t.epanechnikov=function(t){return Math.abs(t)<=1?.75*(1-t*t):0},t.epsilon=Je,t.exponent=Ha,t.extent=Oe,t.fakeRandom=Ee,t.field=Re,t.findBoundaryAngles=Fi,t.findMarkGraphic=_V,t.findZeroOfFunction=Yt,t.fixPrecision=mi,t.flattenArray=Ft,t.flattenNodes=j$,t.flattenTreeLinks=_0,t.formatLinkPath=function(t){var e,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return j(null===(e=null==t?void 0:t[0])||void 0===e?void 0:e.vertical)?t.map((function(t){var e=t.thickness/2,n=t.x0,r=t.x1,a=(n+r)/2,o=t.y0-e,s=t.y0+e,l=t.y1-e,u=t.y1+e;return i&&(n=Math.round(n),r=Math.round(r),a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u)),Object.assign({},t,{path:"\n          M".concat(n,",").concat(o,"\n          C").concat(a,",").concat(o,",").concat(a,",").concat(l,",").concat(r,",").concat(l,"\n          L").concat(r,",").concat(u,"\n          C").concat(a,",").concat(u,",").concat(a,",").concat(s,",").concat(n,",").concat(s,"\n          Z")})})):t.map((function(t){var e=t.thickness/2,n=t.y0,r=t.y1,a=(n+r)/2,o=t.x0-e,s=t.x0+e,l=t.x1-e,u=t.x1+e;return i&&(n=Math.round(n),r=Math.round(r),a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u)),Object.assign({},t,{path:"\n            M".concat(o,",").concat(n,"\n            C").concat(o,",").concat(a,",").concat(l,",").concat(a,",").concat(l,",").concat(r,"\n            L").concat(u,",").concat(r,"\n            C").concat(u,",").concat(a,",").concat(s,",").concat(a,",").concat(s,",").concat(n,"\n            Z\n            ")})}))},t.formatLinkPolygon=function(t){var e;return j(null===(e=null==t?void 0:t[0])||void 0===e?void 0:e.vertical)?t.map((function(t){var e=t.thickness/2,i=[{x:t.x0,y:t.y0-e},{x:t.x1,y:t.y1-e},{x:t.x1,y:t.y1+e},{x:t.x0,y:t.y0+e}];return Object.assign({},t,{points:i})})):t.map((function(t){var e=t.thickness/2,i=[{x:t.x0-e,y:t.y0},{x:t.x1-e,y:t.y1},{x:t.x1+e,y:t.y1},{x:t.x0+e,y:t.y0}];return Object.assign({},t,{points:i})}))},t.formatNodeRect=function(t){return t.map((function(t){return Object.assign({},t,{x:t.x0,y:t.y0,width:t.x1-t.x0,height:t.y1-t.y0})}))},t.formatNumerals=Na,t.formatSpecifier=Ia,t.formatTypes=za,t.fullYearGetterName=ar,t.fullYearSetterName=function(t){return t?"setUTCFullYear":"setFullYear"},t.functionTransform=Aj,t.fuzzyEqualNumber=function(t,e){return ii(t-e)<1e-12},t.fuzzyEqualVec=yi,t.gaussian=Ye,t.gemv=function(t,e,i){for(var n=0;n<t.length;++n)t[n]=gi(e[n],i)},t.generateCardioidPoints=p1,t.generateCeil=la,t.generateCount=ua,t.generateIsEmptyPixel=u1,t.generateMaskCanvas=c1,t.generatePoints=d1,t.generateStepInterval=function(t,e){var i=e.floor,n=e.offset,r=e.field,a=e.count,o=Math.floor(t);if(!Number.isFinite(o)||o<=0)return null;if(o<=1)return{floor:i,offset:n,ceil:la(i,n)};var s=ua(i,a),l=r?function(t){return r(t)%o==0}:function(t){return s(0,t)%o==0},u=function(t){if(!Number.isNaN(+t))for(i(t);!l(t);)t.setTime(+t-1),i(t);return t},c=function(t,e){if(!Number.isNaN(+t))if(o<0)for(;++e<=0;)for(n(t,-1);!l(t);)n(t,-1);else for(;--e>=0;)for(n(t,1);!l(t);)n(t,1);return t};return{floor:u,offset:c,ceil:la(u,c)}},t.get=ht,t.getAABBFromPoints=function(t){return Vi=1/0,Wi=1/0,Gi=-1/0,Yi=-1/0,t.forEach((function(t){Vi>t.x&&(Vi=t.x),Gi<t.x&&(Gi=t.x),Wi>t.y&&(Wi=t.y),Yi<t.y&&(Yi=t.y)})),{x1:Vi,y1:Wi,x2:Gi,y2:Yi}},t.getActualColor=AU,t.getActualNumValue=WU,t.getAlignEndTexts=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return f0(t[0])?t.map((function(t){return{y:t.y1-e,x:(t.x0+t.x1)/2,datum:t.datum,key:t.key}})):t.map((function(t){return{x:t.x0-e,y:(t.y0+t.y1)/2,datum:t.datum,key:t.key}}))},t.getAlignStartTexts=function(t){return f0(t[0])?t.map((function(t){return{y:t.y1,x:(t.x0+t.x1)/2,datum:t.datum,key:t.key}})):t.map((function(t){return{x:t.x1,y:(t.y0+t.y1)/2,datum:t.datum,key:t.key}}))},t.getAngleByPoint=Li,t.getArcsFromCircles=W0,t.getArcsFromPath=function(t){var e=[],i=t.split("A"),n=i[0],r=n.indexOf(",");for(e.push({p1:{x:+n.slice(1,r),y:+n.slice(r+1)}}),r=1;r<i.length;r++){var a=i[r].split(",");e[r-1].radius=+a[0];var o=+a[2].slice(2),s=+a[3].split(" ")[0];e[r-1].p2={x:o,y:s},e[r-1].largeArcFlag="1"===a[1][a[1].length-1],r<i.length-1&&e.push({p1:{x:o,y:s}})}return e},t.getBoundsOfNodes=function(t){var e=1/0,i=-1/0,n=1/0,r=-1/0;return t.forEach((function(t){e=Math.min(t.x0,e),i=Math.max(t.x1,i),n=Math.min(t.y0,n),r=Math.max(t.y1,r)})),{x0:e,x1:i,y0:n,y1:r,width:i-e,height:r-n}},t.getCartesianCrosshairRect=ZK,t.getCartesianDimensionInfo=jK,t.getCenter=Ta,t.getCirclesFromArcs=Y0,t.getColorSchemeBySeries=TU,t.getCombinedSizeOfRegions=BX,t.getContainerSize=ca,t.getContextFont=En,t.getDataScheme=xU,t.getDatumOfGraphic=mV,t.getDecimalPlaces=_i,t.getDiffAttributesOfGraphic=bV,t.getDimensionInfoByValue=WK,t.getElementAbsolutePosition=ha,t.getElementRelativePosition=function(t,e){var i=ha(t),n=ha(e);return{x:i.x-n.x,y:i.y-n.y}},t.getFieldAlias=tV,t.getFormatFromValue=function(t,e){var i=Se(t),n=i[or(e)]()+1,r=i[sr(e)](),a=i[lr(e)](),o=i[ur(e)](),s=i[cr(e)](),l=0===i[hr(e)](),u=l&&0===s,c=u&&0===o,h=c&&0===a,d=h&&1===r;return d&&1===n?"YYYY":d?"YYYY-MM":h?"YYYY-MM-DD":c?"HH":u?"HH:mm":l?"HH:mm:ss":"HH:mm:ss SSS"},t.getFunnelTheme=oj,t.getGroupAnimationParams=vY,t.getIntersectPoint=Ui,t.getIntervalOptions=function(t,e){return"year"===t&&e?{floor:mr,offset:_r,count:br,field:xr}:"month"===t&&e?{floor:Mr,offset:wr,count:Tr,field:Dr}:"day"===t&&e?{floor:Lr,offset:Ir,count:Fr,field:Or}:"hour"===t&&e?{floor:jr,offset:Vr,count:Nr,field:Wr}:"minute"===t&&e?{floor:qr,offset:Zr,count:Xr,field:Jr}:"second"===t&&e?{floor:ia,offset:na,count:ta,field:ra}:"year"===t?{floor:fr,offset:vr,count:gr,field:yr}:"month"===t?{floor:kr,offset:Sr,count:Ar,field:Cr}:"day"===t?{floor:Er,offset:Br,count:Pr,field:Rr}:"hour"===t?{floor:zr,offset:Hr,count:Nr,field:Ur}:"minute"===t?{floor:Gr,offset:Yr,count:Xr,field:Kr}:"second"===t?{floor:Qr,offset:$r,count:ta,field:ea}:{floor:aa,offset:oa,count:sa}},t.getMaxRadiusAndCenter=J0,t.getMergedTheme=yj,t.getOBBFromLine=function(t,e,i){return Xi=e.x-t.x,Ki=e.y-t.y,qi=Ki,Zi=-Xi,$i=Ji=Math.sqrt(qi*qi+Zi*Zi),tn=i,Xi=(Qi=i/2)*(qi/=Ji),Ki=Qi*(Zi/=Ji),{point1:{x:t.x+Xi,y:t.y+Ki},point2:{x:t.x-Xi,y:t.y-Ki},point3:{x:e.x+Xi,y:e.y+Ki},point4:{x:e.x-Xi,y:e.y-Ki},width:$i,height:tn,left:Math.min(t.x,e.x)-Math.abs(Xi),top:Math.min(t.y,e.y)-Math.abs(Ki)}},t.getPathFromArcs=G0,t.getPolarDimensionInfo=o4,t.getRectIntersect=ji,t.getRegionStackGroup=eV,t.getScale=function(t){return t.offsetWidth>0?da(t):pa(t)},t.getScaleX=da,t.getScaleY=pa,t.getScrollLeft=function(t){var e,i,n;return t===(null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.document)||void 0===e?void 0:e.body)?(null===(n=null===(i=null===globalThis||void 0===globalThis?void 0:globalThis.document)||void 0===i?void 0:i.documentElement)||void 0===n?void 0:n.scrollLeft)||t.scrollLeft:"html"===t.tagName.toLowerCase()?0:t.scrollLeft},t.getScrollTop=function(t){var e,i,n;return t===(null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.document)||void 0===e?void 0:e.body)?(null===(n=null===(i=null===globalThis||void 0===globalThis?void 0:globalThis.document)||void 0===i?void 0:i.documentElement)||void 0===n?void 0:n.scrollTop)||t.scrollTop:"html"===t.tagName.toLowerCase()?0:t.scrollTop},t.getShapeFunction=Q0,t.getSpecInfo=wG,t.getTheme=fj,t.getTimeFormatter=function(t,e){return function(i){var n=Se(i),r=n[ar(e)](),a=n[or(e)]()+1,o=Math.floor((a-1)/3)+1,s=n[sr(e)](),l=n["get"+(e?"UTC":"")+"Day"](),u=n[lr(e)](),c=(u-1)%12+1,h=n[ur(e)](),d=n[cr(e)](),p=n[hr(e)]();return(t||"").replace(/YYYY/g,le(r+"",4,"0","left")).replace(/yyyy/g,r+"").replace(/yy/g,r%100+"").replace(/Q/g,o+"").replace(/MM/g,le(a,2,"0","left")).replace(/M/g,a+"").replace(/dd/g,le(s,2,"0","left")).replace(/d/g,s+"").replace(/e/g,l+"").replace(/HH/g,le(u,2,"0","left")).replace(/H/g,u+"").replace(/hh/g,le(c+"",2,"0","left")).replace(/h/g,c+"").replace(/mm/g,le(h,2,"0","left")).replace(/m/g,h+"").replace(/ss/g,le(d,2,"0","left")).replace(/s/g,d+"").replace(/SSS/g,le(p,3,"0","left")).replace(/S/g,p+"")}},t.getter=Be,t.graphicCreator=B_,t.halfPi=$e,t.has=pt,t.hasParentElement=function(t,e){for(var i=t.parentNode;null!==i;){if(i===e)return!0;i=i.parentNode}return!1},t.hasThemeMerged=dj,t.hexToRgb=tr,t.hourCount=Nr,t.hourField=Ur,t.hourFloor=zr,t.hourOffset=Hr,t.hoursGetterName=lr,t.hoursSetterName=function(t){return t?"setUTCHours":"setHours"},t.hslToRgb=jn,t.imagecloudTransform=function(t,e,i){var n,r,a,o=U(t.size)?t.size():t.size;if(t.size=o,!o||j(o[0])||j(o[1])||o[0]<=0||o[1]<=0)return Wt.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(o[0]),Math.ceil(o[1])],t.image||Wt.getInstance().error("Imagecloud: image source must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];switch(null!==(r=null===(n=t.layoutConfig)||void 0===n?void 0:n.layoutMode)&&void 0!==r?r:"spiral"){case"grid":a=a2;break;case"stack":a=o2;break;default:a=Q1}var s=new a(t);return s.layout(e),s.unfinished()?{progressive:s}:s.output()},t.interpolateDate=_e,t.interpolateNumber=ye,t.interpolateNumberRound=me,t.interpolateRgb=ir,t.interpolateString=function(t,e){var i,n,r,a=be.lastIndex=xe.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(i=be.exec(t))&&(n=xe.exec(e));)(r=n.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(i=i[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:ye(i,n)})),a=xe.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)s[(i=l[n]).i]=i.x(t);return s.join("")})},t.intersectionArea=Sa,t.isArray=Z,t.isArrayLike=J,t.isBase64=at,t.isBoolean=N,t.isCollectionMark=yV,t.isColorKey=CU,t.isDate=Q,t.isEmpty=ct,t.isEqual=St,t.isFunction=U,t.isGreater=ne,t.isHTMLElement=ya,t.isIntersect=Ni,t.isLess=re,t.isNil=j,t.isNull=V,t.isNumber=$,t.isNumberClose=ie,t.isNumeric=et,t.isObject=G,t.isObjectLike=Y,t.isPercent=OU,t.isPercentOffset=zU,t.isPlainObject=X,t.isPointInLine=Sn,t.isPointInPolygon=function(t,e){if(!t)return!1;if(!e)return!1;var i,n="Feature"===(i=e).type?i.geometry:i,r=n.type,a=e.bbox,o=n.coordinates;if(a&&!0===an(t,{x1:a[0],x2:a[1],y1:a[1],y2:a[3]},!0))return!1;"Polygon"===r&&(o=[o]);for(var s=!1,l=0;l<o.length;++l)for(var u=0;u<o[l].length;++u)if(kn(o[l][u].map((function(t){return{x:t[0],y:t[1]}})),t.x,t.y))return s=!0;return s},t.isPolarAxisSeries=pY,t.isProgressiveDataColorScheme=MU,t.isRectIntersect=rn,t.isRegExp=rt,t.isRotateAABBIntersect=cn,t.isShallowEqual=function(t,e){if(At(t,e))return!0;if("object"!=k(t)||null===t||"object"!=k(e)||null===e)return!1;if(Z(t)!==Z(e))return!1;if(Ct(t)!==Ct(e))return!1;var i=!0;return Object.keys(t).forEach((function(n){return!!At(t[n],e[n])||(i=!1)})),i},t.isSpecValueWithScale=IU,t.isString=q,t.isTokenKey=XU,t.isType=H,t.isUndefined=K,t.isValid=W,t.isValidNumber=it,t.isValidOrient=FU,t.isValidUrl=nt,t.isValueInScaleDomain=LU,t.isXAxis=yY,t.isYAxis=mY,t.isZAxis=_Y,t.kde=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.length,n=e.kernel||Ye,r=e.bandwidth;if(!r||r<=0){var a=function(t){var e=t.length;if(0===e)return 0;for(var i=0,n=0;n<e;n++)i+=t[n];i/=e;for(var r=0,a=0;a<e;a++){var o=t[a]-i;r+=o*o}return Math.sqrt(r/e)}(t)||0,o=e.bandwidthMethod||"scott";r="silverman"===o?Ke(i,a,1):Xe(i,a,1)}if(!r||r<=0)return{bandwidth:0,kernel:n,evaluate:function(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(0);return e}return 0},evaluateGrid:function(e){var n=[];if(e<=0)return n;for(var r=1/0,a=-1/0,o=0;o<i;o++){var s=t[o];s<r&&(r=s),s>a&&(a=s)}if(r===1/0||a===-1/0){for(var l=0;l<e;l++)n.push({x:0,y:0});return n}for(var u=0;u<e;u++)n.push({x:r,y:0});return n}};var s=1/(i*r);function l(e){for(var a=0,o=0;o<i;o++)a+=n((e-t[o])/r);return a*s}return{bandwidth:r,kernel:n,evaluate:function(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(l(t[i]));return e}return l(t)},evaluateGrid:function(e){var n=[];if(e<=0)return n;for(var r=1/0,a=-1/0,o=0;o<i;o++){var s=t[o];s<r&&(r=s),s>a&&(a=s)}if(r===1/0||a===-1/0)return n;if(r===a){for(var u=0;u<e;u++)n.push({x:r,y:l(r)});return n}for(var c=(a-r)/(e-1),h=0;h<e;h++){var d=h===e-1?a:r+c*h;n.push({x:d,y:l(d)})}return n}}},t.keys=Mt,t.last=Et,t.lengthFromPointToLine=pi,t.lightTheme=qU,t.lineIntersectPolygon=xn,t.loadImage=N1,t.loadImages=U1,t.lookup=TG,t.lowerCamelCaseToMiddle=va,t.lowerFirst=Ce,t.max=ai,t.maxInArray=Bt,t.measureText=Cj,t.median=Zt,t.memoize=oe,t.merge=mt,t.mergeAABB=function(t){var e=[];return function t(i,n){var r=[];n.forEach((function(t){var e;(e=hn(i,t)).length>1?r.push(t):i=e[0]})),e.push(i),r.length&&t(r[0],r.slice(1))}(t[0],t.slice(1)),e},t.mergeFields=Qj,t.millisecondsCount=sa,t.millisecondsFloor=aa,t.millisecondsGetterName=hr,t.millisecondsOffset=oa,t.millisecondsSetterName=function(t){return t?"setUTCMilliseconds":"setMilliseconds"},t.min=oi,t.minInArray=Pt,t.minuteCount=Xr,t.minuteField=Kr,t.minuteFloor=Gr,t.minuteOffset=Yr,t.minutesGetterName=ur,t.minutesSetterName=function(t){return t?"setUTCMinutes":"setMinutes"},t.mixin=Tt,t.monthCount=Ar,t.monthField=Cr,t.monthFloor=kr,t.monthGetterName=or,t.monthOffset=Sr,t.monthSetterName=function(t){return t?"setUTCMonth":"setMonth"},t.nelderMead=Ya,t.norm2=Va,t.normalTransform=Nn,t.normalizeAngle=Ii,t.normalizeLayoutPaddingSpec=jU,t.normalizePadding=rr,t.numberSpecifierReg=La,t.obbSeparation=Ln,t.ordinaryLeastSquares=Ue,t.pad=le,t.parseUint8ToImageData=function(t,e,i){for(var n=new Uint8ClampedArray(t),r=new Uint8ClampedArray(t.length),a=i-1;a>=0;a--)for(var o=0;o<e;o++){var s=a*e*4+4*o,l=(i-a)*e*4+4*o;r[l]=n[s],r[l+1]=n[s+1],r[l+2]=n[s+2],r[l+3]=n[s+3]}return new ImageData(r,e,i)},t.particleEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=e*r+i,c=2*vP(u,0)*Math.PI,h=.5*vP(u,1)+.5,d=2*vP(u,2)*Math.PI,p=n/2,f=r/2,v=Math.sqrt(Math.pow((e-p)/p,2)+Math.pow((i-f)/f,2)),g=Math.min(v,1),y=(a-.4)/.6,m=Math.sin(y*h*8*Math.PI+c+d*y),_=Math.cos(g*Math.PI+y*Math.PI),b=s+l*((m+1)/2*Math.max(0,1-1.2*y)*(.3+.7*_));return Math.min(1,Math.max(0,b))},t.pi=Qe,t.pi2=ei,t.pick=function(t,e){if(!t||!X(t))return t;var i={};return e.forEach((function(e){_t.call(t,e)&&(i[e]=t[e])})),i},t.pickWithout=bt,t.pieDisappear=tQ,t.pieEnter=QJ,t.pieExit=$J,t.piePresetAnimation=eQ,t.pointAt=di,t.pointBetweenLine=mn,t.pointInAABB=function(t,e){return an(t,e,!1)},t.pointInLine=fn,t.pointInOBB=function(t,e){return dn.x=(e.point1.x+e.point2.x)/2,dn.y=(e.point1.y+e.point2.y)/2,pn.x=(e.point3.x+e.point4.x)/2,pn.y=(e.point3.y+e.point4.y)/2,fn(t,dn,pn,e.height)},t.pointInRect=an,t.polarToCartesian=Pi,t.polygonContainPoint=kn,t.polygonIntersectPolygon=Cn,t.pow=ui,t.precisionAdd=bi,t.precisionSub=xi,t.pulseWave=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=Math.min(h,1),p=2*a*Math.PI*3,f=Math.max(0,1-d),v=s+l*((Math.sin(p-4*d*Math.PI)+1)/2)*(.7*f+.3);return Math.min(1,Math.max(0,v))},t.quantileSorted=Nt,t.queryColorFromColorScheme=SU,t.queryToken=YU,t.rSquared=Ve,t.radianToDegree=Mi,t.randomLCG=De,t.randomOpacity=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=2*vP(e*r+i)*Math.PI,c=s+l*(Math.sin(2*a*Math.PI+u)+1)/2;return Math.min(1,Math.max(0,c))},t.range=Ot,t.rectInsideAnotherRect=nn,t.registerAllEnv=function(){fD()},t.registerAllMarks=att,t.registerAnimate=lG,t.registerArc3d=zB,t.registerArcAnimation=aG,t.registerArcMark=aQ,t.registerAreaChart=Aq,t.registerAreaMark=fq,t.registerAreaSeries=xq,t.registerBarAnimation=Pq,t.registerBarChart=Gq,t.registerBarSeries=Uq,t.registerBoxplotChart=n8,t.registerBoxplotSeries=CJ,t.registerBrowserEnv=GW,t.registerBrush=Z7,t.registerCanvasTooltipHandler=D9,t.registerCartesianBandAxis=QX,t.registerCartesianCrossHair=Q8,t.registerCartesianLinearAxis=KX,t.registerCartesianLogAxis=iK,t.registerCartesianSymlogAxis=rK,t.registerCartesianTimeAxis=tK,t.registerChartPlugin=E9,t.registerChartResizeZoomPlugin=function(){E9(vtt)},t.registerCirclePackingChart=K4,t.registerCirclePackingSeries=t3,t.registerCircularProgressChart=C4,t.registerCircularProgressSeries=y$,t.registerCommonChart=f4,t.registerComponentMark=wX,t.registerContinuousLegend=L8,t.registerCorrelationChart=v8,t.registerCustomAnimate=function(){DL.registerBuiltInAnimate("increaseCount",GL),DL.registerBuiltInAnimate("fromTo",SF),DL.registerBuiltInAnimate("scaleIn",$I),DL.registerBuiltInAnimate("scaleOut",tF),DL.registerBuiltInAnimate("growHeightIn",MI),DL.registerBuiltInAnimate("growHeightOut",wI),DL.registerBuiltInAnimate("growWidthIn",VI),DL.registerBuiltInAnimate("growWidthOut",WI),DL.registerBuiltInAnimate("growCenterIn",SI),DL.registerBuiltInAnimate("growCenterOut",AI),DL.registerBuiltInAnimate("clipIn",vI),DL.registerBuiltInAnimate("clipOut",gI),DL.registerBuiltInAnimate("fadeIn",yI),DL.registerBuiltInAnimate("fadeOut",mI),DL.registerBuiltInAnimate("growPointsIn",EI),DL.registerBuiltInAnimate("growPointsOut",BI),DL.registerBuiltInAnimate("growPointsXIn",RI),DL.registerBuiltInAnimate("growPointsXOut",LI),DL.registerBuiltInAnimate("growPointsYIn",FI),DL.registerBuiltInAnimate("growPointsYOut",OI),DL.registerBuiltInAnimate("growAngleIn",xI),DL.registerBuiltInAnimate("growAngleOut",kI),DL.registerBuiltInAnimate("growRadiusIn",NI),DL.registerBuiltInAnimate("growRadiusOut",UI),DL.registerBuiltInAnimate("moveIn",yF),DL.registerBuiltInAnimate("moveOut",mF),DL.registerBuiltInAnimate("rotateIn",bF),DL.registerBuiltInAnimate("rotateOut",xF),DL.registerBuiltInAnimate("update",vF),DL.registerBuiltInAnimate("state",eF),DL.registerBuiltInAnimate("labelItemAppear",GI),DL.registerBuiltInAnimate("labelItemDisappear",YI),DL.registerBuiltInAnimate("poptipAppear",XI),DL.registerBuiltInAnimate("poptipDisappear",KI),DL.registerBuiltInAnimate("inputText",sI),DL.registerBuiltInAnimate("inputRichText",qI),DL.registerBuiltInAnimate("outputRichText",ZI),DL.registerBuiltInAnimate("slideRichText",JI),DL.registerBuiltInAnimate("slideOutRichText",QI),DL.registerBuiltInAnimate("slideIn",iF),DL.registerBuiltInAnimate("growIn",nF),DL.registerBuiltInAnimate("spinIn",rF),DL.registerBuiltInAnimate("moveScaleIn",sF),DL.registerBuiltInAnimate("moveRotateIn",lF),DL.registerBuiltInAnimate("strokeIn",aF),DL.registerBuiltInAnimate("slideOut",uF),DL.registerBuiltInAnimate("growOut",cF),DL.registerBuiltInAnimate("spinOut",hF),DL.registerBuiltInAnimate("moveScaleOut",dF),DL.registerBuiltInAnimate("moveRotateOut",pF),DL.registerBuiltInAnimate("strokeOut",oF),DL.registerBuiltInAnimate("pulse",fF),DL.registerBuiltInAnimate("MotionPath",kF),DL.registerBuiltInAnimate("streamLight",AF),DL.registerBuiltInAnimate("dissolve",EF),DL.registerBuiltInAnimate("grayscale",BF),DL.registerBuiltInAnimate("distortion",PF),DL.registerBuiltInAnimate("particle",RF),DL.registerBuiltInAnimate("glitch",LF),DL.registerBuiltInAnimate("gaussianBlur",IF),DL.registerBuiltInAnimate("pixelation",FF)},t.registerCustomMark=Q7,t.registerDataSetInstanceParser=BV,t.registerDataSetInstanceTransform=EV,t.registerDataZoom=g6,t.registerDimensionEvents=FK,t.registerDimensionHover=IK,t.registerDimensionTooltipProcessor=rq,t.registerDirectionalLight=kS,t.registerDiscreteLegend=k8,t.registerDomTooltipHandler=S9,t.registerDotSeries=e$,t.registerDragPlugin=function(){ij.registerStageEventPlugin("drag",DC)},t.registerElementActive=z9,t.registerElementActiveByLegend=j9,t.registerElementHighlight=gG,t.registerElementHighlightByGroup=G9,t.registerElementHighlightByKey=K9,t.registerElementHighlightByLegend=Q9,t.registerElementHighlightByName=itt,t.registerElementSelect=_G,t.registerFormatPlugin=I9,t.registerFunnelChart=F4,t.registerFunnelSeries=T2,t.registerGaugeChart=T4,t.registerGaugePointerSeries=G3,t.registerGaugeSeries=q3,t.registerGeoCoordinate=kZ,t.registerGeoMarkPoint=G7,t.registerGesturePlugin=uG,t.registerGlyphMark=uJ,t.registerGridLayout=e9,t.registerGroupMark=jW,t.registerGroupTooltipProcessor=lq,t.registerHarmonyEnv=function(){qD(rh)},t.registerHeatmapChart=d8,t.registerHeatmapSeries=a5,t.registerHistogramChart=k4,t.registerHtmlAttributePlugin=RA,t.registerImageMark=rtt,t.registerIndicator=A6,t.registerLabel=R7,t.registerLarkEnv=function(){Jw(rh)},t.registerLine=ZB,t.registerLineChart=hq,t.registerLineMark=NY,t.registerLineSeries=xK,t.registerLinearProgressChart=H4,t.registerLinearProgressSeries=T$,t.registerLinkSeries=s$,t.registerLiquidChart=function(){oq(),L5(),ij.registerChart(stt.type,stt)},t.registerLiquidSeries=L5,t.registerLynxEnv=function(){vT(rh)},t.registerMapChart=J5,t.registerMapSeries=MZ,t.registerMarkArea=y7,t.registerMarkFilterTransform=T3,t.registerMarkLine=l7,t.registerMarkMapTransform=D3,t.registerMarkPoint=U7,t.registerMarkTooltipProcessor=oq,t.registerMediaQuery=function(){E9(ftt)},t.registerMosaicChart=function(){rq(),oq(),lq(),FK(),IK(),K5(),ij.registerChart(htt.type,htt)},t.registerMosaicSeries=K5,t.registerNodeEnv=YW,t.registerOrthoCamera=AS,t.registerPathMark=dZ,t.registerPieChart=r4,t.registerPieSeries=dQ,t.registerPlayer=w7,t.registerPolarBandAxis=EQ,t.registerPolarCrossHair=t6,t.registerPolarLinearAxis=TQ,t.registerPolarMarkArea=_7,t.registerPolarMarkLine=c7,t.registerPolarMarkPoint=V7,t.registerPolygonAnimation=sG,t.registerPolygonMark=A2,t.registerPoptip=i9,t.registerPyramid3d=iP,t.registerRadarChart=h4,t.registerRadarSeries=KQ,t.registerRangeAreaChart=u8,t.registerRangeAreaSeries=WJ,t.registerRangeColumnChart=j4,t.registerRangeColumnSeries=NJ,t.registerReactAttributePlugin=IA,t.registerRect=rP,t.registerRect3d=oP,t.registerRectAnimation=rG,t.registerRectMark=Lq,t.registerRippleMark=v5,t.registerRoseChart=l4,t.registerRoseSeries=RQ,t.registerRuleMark=OZ,t.registerSankeyChart=o8,t.registerSankeySeries=k3,t.registerScaleInOutAnimation=tG,t.registerScatterChart=oZ,t.registerScatterSeries=iZ,t.registerScrollBar=_6,t.registerSequenceChart=y4,t.registerSequentialAnimate=function(){Tt(NW,btt)},t.registerShadowRoot=cP,t.registerStateTransition=function(){var t=TL.getInstance();t.registerTransition("update","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),t.registerTransition("update","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),t.registerTransition("update","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),t.registerTransition("state","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),t.registerTransition("state","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),t.registerTransition("state","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}}))},t.registerSunBurstSeries=X2,t.registerSunburstChart=G4,t.registerSymbolMark=jY,t.registerTTEnv=function(){PD(rh)},t.registerTaroEnv=function(){KT(rh)},t.registerTextMark=wJ,t.registerTheme=pj,t.registerTitle=p7,t.registerTooltip=X8,t.registerTotalLabel=O7,t.registerTreemapChart=J4,t.registerTreemapSeries=I3,t.registerVRenderAnimate=HL,t.registerVennChart=function(){oq(),G5(),ij.registerChart(utt.type,utt)},t.registerVennSeries=G5,t.registerViewTransform3dPlugin=function(){dS.registerPlugin("ViewTransform3dPlugin",FA)},t.registerWXEnv=function(){dD(rh)},t.registerWaterfallChart=t8,t.registerWaterfallSeries=nJ,t.registerWordCloudChart=P4,t.registerWordCloudSeries=l2,t.registerWordCloudShapeChart=R4,t.regressionLinear=We,t.regressionLogistic=function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},a=arguments.length>3?arguments[3]:void 0,o=null!==(e=null==a?void 0:a.maxIteration)&&void 0!==e?e:25,s=null!==(i=null==a?void 0:a.tol)&&void 0!==i?i:1e-6,l=[],u=[];je(t,n,r,(function(t,e){l.push(t),u.push(e?1:0)}));var c=l.length;if(0===c)return{coef:[0,0],predict:function(t){return 0},evaluateGrid:function(t){return[]},confidenceInterval:function(){return[]}};for(var h=0,d=0,p=0;p<o;p++){for(var f=new Array(c),v=!0,g=0;g<c;g++){var y=h+d*l[g],m=1/(1+Math.exp(-y));f[g]=m}for(var _=0,b=0,x=0,k=0,S=0,A=0;A<c;A++){var C=f[A]*(1-f[A]),M=u[A]-f[A];_+=M,b+=M*l[A],x+=C,k+=C*l[A],S+=C*l[A]*l[A]}var w=x*S-k*k;if(Math.abs(w)<1e-12)break;var T=(S*_-k*b)/w,D=(-k*_+x*b)/w;if(h+=T,d+=D,(Math.abs(T)>s||Math.abs(D)>s)&&(v=!1),v)break}var E=function(t){var e=h+d*t;return 1/(1+Math.exp(-e))};return{coef:[h,d],predict:E,evaluateGrid:function(e){var i=[];if(e<=0)return i;var a=1/0,o=-1/0;if(je(t,n,r,(function(t){t<a&&(a=t),t>o&&(o=t)})),a===1/0||o===-1/0)return i;if(a===o){for(var s=E(a),l=0;l<e;l++)i.push({x:a,y:s});return i}for(var u=(o-a)/(e-1),c=0;c<e;c++){var h=c===e-1?o:a+u*c;i.push({x:h,y:E(h)})}return i},confidenceInterval:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05,a=[];if(e<=0)return a;var o=He(t,n,r,E);if(0===o.n)return a;var s=Math.abs(ze(1-i/2));if(o.min===o.max){for(var l=E(o.min),u=Ne(o.min,o),c=0;c<e;c++)a.push({x:o.min,mean:l,lower:l-s*u.seMean,upper:l+s*u.seMean,predLower:l-s*u.sePred,predUpper:l+s*u.sePred});return a}for(var h=(o.max-o.min)/(e-1),d=0;d<e;d++){var p=d===e-1?o.max:o.min+h*d,f=E(p),v=Ne(p,o);a.push({x:p,mean:f,lower:f-s*v.seMean,upper:f+s*v.seMean,predLower:f-s*v.sePred,predUpper:f+s*v.sePred})}return a}}},t.regressionLowess=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n.span||.3,a=0===n.degree?0:1,o=null==n.iterations?2:n.iterations,s=[],l=[];je(t,e,i,(function(t,e){s.push(t),l.push(e)}));var u=s.length;function c(t,e){if(0===u)return 0;for(var i=[],n=0;n<u;n++)i.push({idx:n,dist:Math.abs(s[n]-t)});i.sort((function(t,e){return t.dist-e.dist}));for(var o=Math.max(2,Math.min(u,Math.floor(r*u))),c=i[o-1].dist||0,h=new Array(o),d=0,p=0;p<o;p++){var f=i[p].idx,v=Ge(0===c?0:i[p].dist/c);e&&null!=e[f]&&(v*=e[f]),h[p]=v,d+=v}if(0===d)return l[i[0].idx];if(0===a){for(var g=0,y=0;y<o;y++)g+=h[y]*l[i[y].idx];return g/d}for(var m=0,_=0,b=0,x=0,k=0,S=0;S<o;S++){var A=i[S].idx,C=s[A],M=l[A],w=h[S];m+=w,_+=w*C,b+=w*M,x+=w*C*C,k+=w*C*M}var T=_/m,D=b/m,E=x-_*T,B=Math.abs(E)<1e-12?0:(k-_*D)/E;return D-B*T+B*t}function h(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(c(t[i]));return e}return c(t)}return{predict:h,evaluate:h,evaluateGrid:function(t){var e=[];if(t<=0)return e;if(0===u)return e;for(var i=1/0,n=-1/0,r=0;r<u;r++)s[r]<i&&(i=s[r]),s[r]>n&&(n=s[r]);if(i===n){for(var a=c(i),h=0;h<t;h++)e.push({x:i,y:a});return e}for(var d,p=(n-i)/(t-1),f=0;f<o;f++){for(var v=[],g=0;g<u;g++)v.push(c(s[g],d));for(var y=[],m=0;m<u;m++)y.push(Math.abs(l[m]-v[m]));var _=y.slice().sort((function(t,e){return t-e}))[Math.floor(u/2)]||0;d=new Array(u);for(var b=0;b<u;b++){var x=0===_?0:y[b]/(6*_),k=Math.abs(x)>=1?0:(1-x*x)*(1-x*x);d[b]=k}}for(var S=0;S<t;S++){var A=S===t-1?n:i+p*S;e.push({x:A,y:c(A,d)})}return e},confidenceInterval:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05,a=[];if(n<=0)return a;if(0===u)return a;for(var o=1/0,l=-1/0,h=0;h<u;h++)s[h]<o&&(o=s[h]),s[h]>l&&(l=s[h]);if(o===1/0||l===-1/0)return a;var d=He(t,e,i,(function(t){return c(t)}));if(0===d.n)return a;var p=Math.abs(ze(1-r/2));if(d.min===d.max){for(var f=c(d.min),v=Ne(d.min,d),g=0;g<n;g++)a.push({x:d.min,mean:f,lower:f-p*v.seMean,upper:f+p*v.seMean,predLower:f-p*v.sePred,predUpper:f+p*v.sePred});return a}for(var y=(l-o)/(n-1),m=0;m<n;m++){var _=m===n-1?l:o+y*m,b=c(_),x=Ne(_,d);a.push({x:_,mean:b,lower:b-p*x.seMean,upper:b+p*x.seMean,predLower:b-p*x.sePred,predUpper:b+p*x.sePred})}return a}}},t.regressionPolynomial=function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},r=null!==(e=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).degree)&&void 0!==e?e:0;r<0&&(r=0);var a=r+1,o=new Array(2*r+1).fill(0);je(t,i,n,(function(t,e){for(var i=1,n=0;n<o.length;n++)o[n]+=i,i*=t}));for(var s=new Array(a),l=0;l<a;l++){s[l]=new Array(a).fill(0);for(var u=0;u<a;u++)s[l][u]=o[l+u]}var c=new Array(a).fill(0);je(t,i,n,(function(t,e){for(var i=1,n=0;n<a;n++)c[n]+=e*i,i*=t}));var h=function(t,e){for(var i=e.length,n=new Array(i),r=0;r<i;r++)n[r]=t[r].slice(),n[r].push(e[r]);for(var a=0;a<i;a++){for(var o=a,s=Math.abs(n[a][a]),l=a+1;l<i;l++){var u=Math.abs(n[l][a]);u>s&&(s=u,o=l)}if(o!==a){var c=n[a];n[a]=n[o],n[o]=c}if(Math.abs(n[a][a])<1e-12)return new Array(i).fill(0);for(var h=a+1;h<=i;h++)n[a][h]=n[a][h]/n[a][a];n[a][a]=1;for(var d=0;d<i;d++)if(d!==a){var p=n[d][a];if(0!==p){for(var f=a+1;f<=i;f++)n[d][f]-=p*n[a][f];n[d][a]=0}}}for(var v=new Array(i),g=0;g<i;g++)v[g]=n[g][i];return v}(s,c),d=function(t){for(var e=1,i=0,n=0;n<h.length;n++)i+=h[n]*e,e*=t;return i};return{degree:r,coef:h,predict:d,rSquared:Ve(t,i,n,function(){var e=0,r=0;return je(t,i,n,(function(t,i){e+=i,r++})),0===r?0:e/r}(),d),evaluateGrid:function(e){var r=[];if(e<=0)return r;var a=1/0,o=-1/0;if(je(t,i,n,(function(t){j(t)||(t<a&&(a=t),t>o&&(o=t))})),a===1/0||o===-1/0)return r;if(a===o){for(var s=d(a),l=0;l<e;l++)r.push({x:a,y:s});return r}for(var u=(o-a)/(e-1),c=0;c<e;c++){var h=c===e-1?o:a+u*c;r.push({x:h,y:d(h)})}return r},confidenceInterval:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05,a=[];if(e<=0)return a;var o=He(t,i,n,d);if(0===o.n)return a;var s=Math.abs(ze(1-r/2));if(o.min===o.max){for(var l=d(o.min),u=Ne(o.min,o),c=0;c<e;c++)a.push({x:o.min,mean:l,lower:l-s*u.seMean,upper:l+s*u.seMean,predLower:l-s*u.sePred,predUpper:l+s*u.sePred});return a}for(var h=(o.max-o.min)/(e-1),p=0;p<e;p++){var f=p===e-1?o.max:o.min+h*p,v=d(f),g=Ne(f,o);a.push({x:f,mean:v,lower:v-s*g.seMean,upper:v+s*g.seMean,predLower:v-s*g.sePred,predUpper:v+s*g.sePred})}return a}}},t.removeBorder=m1,t.removeTheme=vj,t.rgbToHex=er,t.rgbToHsl=Vn,t.rippleEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow(e-u,2)+Math.pow(i-c,2))/Math.sqrt(Math.pow(n/2,2)+Math.pow(r/2,2)),d=s+l*(Math.sin(2*a*Math.PI*3-2*h*Math.PI)+1)/2;return Math.min(1,Math.max(0,d))},t.rotatePoint=sn,t.rotationScan=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.atan2(e-u,i-c),d=(h<0?h+2*Math.PI:h)/(2*Math.PI),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.rowBottomToTop=function(t,e,i,n,r,a,o){var s=(n-1-e)/n,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.rowCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=Math.abs(e-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.rowEdgeToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=1-Math.abs(e-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.rowTopToBottom=function(t,e,i,n,r,a,o){var s=e/n,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.sankeyTransform=v0,t.scale=Wa,t.scaleAndMiddleShape=_1,t.scott=Xe,t.secondCount=ta,t.secondField=ea,t.secondFloor=Qr,t.secondOffset=$r,t.secondsGetterName=cr,t.secondsSetterName=function(t){return t?"setUTCSeconds":"setSeconds"},t.seedRandom=we,t.segmentation=y1,t.setDefaultCrosshairForCartesianChart=eW,t.shapes=q0,t.shouldMarkDoMorph=sY,t.shuffleArray=It,t.silverman=Ke,t.simpleField=Le,t.sin=si,t.snakeWave=function(t,e,i,n,r,a,o){var s=(e+i)%(n+r)/(n+r),l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-4*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.sortDataInAxisHelper=fY,t.sortStackValueGroup=iV,t.span=function(t){return t.length<=1?0:Et(t)-t[0]},t.specTransform=Sj,t.spiralEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow(e-u,2)+Math.pow(i-c,2)),d=Math.atan2(e-u,i-c),p=(h/Math.sqrt(Math.pow(n/2,2)+Math.pow(r/2,2))+d/(2*Math.PI))/2,f=s+l*(Math.sin(2*a*Math.PI-4*p*Math.PI)+1)/2;return Math.min(1,Math.max(0,f))},t.spirals=i1,t.sqrt=li,t.stack=sV,t.stackGroup=lV,t.stackMosaic=aV,t.stackMosaicTotal=rV,t.stackOffsetSilhouette=oV,t.stackTotal=nV,t.stringWidth=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("string"!=typeof t||0===t.length)return 0;if(0===(t=Mn(t)).length)return 0;var i,n=e?1:2,r=0,a=s(t=t.replace(Dn(),"  "));try{for(a.s();!(i=a.n()).done;){var o=i.value,l=o.codePointAt(0);if(!(l<=31||l>=127&&l<=159)&&!(l>=768&&l<=879))switch(Tn(o)){case"F":case"W":r+=2;break;case"A":r+=n;break;default:r+=1}}}catch(t){a.e(t)}finally{a.f()}return r},t.styleStringToObject=fa,t.substitute=function(t,e){return t&&e?t.replace(/\\?\{([^{}]+)\}/g,(function(t,i){return"\\"===t.charAt(0)?t.slice(1):void 0===e[i]?"":e[i]})):t},t.sunburstTransform=function(t,e){var i=new m0(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){var n=[];return j$(i,n,{maxDepth:null==t?void 0:t.maxDepth}),n}return i},t.svgParser=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).customDOMParser;if(e||(null===window||void 0===window?void 0:window.DOMParser)&&(e=function(t){return(new DOMParser).parseFromString(t,"text/xml")}),!e)throw new Error("No Available DOMParser!");for(var i=e(t),n=9===i.nodeType?i.firstChild:i;n&&("svg"!==n.nodeName.toLowerCase()||1!==n.nodeType);)n=n.nextSibling;return n?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],n=rc(t,null),r=parseFloat(t.getAttribute("width")||e.width),a=parseFloat(t.getAttribute("height")||e.height);!it(r)&&(r=null),!it(a)&&(a=null);var o,s=t.getAttribute("viewBox");if(s){var l=s.match(tc)||[];if(l.length>=4&&(o={x:parseFloat(l[0]||0),y:parseFloat(l[1]||0),width:parseFloat(l[2]),height:parseFloat(l[3])},r||a)){var u={x:0,y:0,width:r,height:a},c=u.width/o.width,h=u.height/o.height,d=Math.min(c,h),p=-(o.x+o.width/2)*d+(u.x+u.width/2),f=-(o.y+o.height/2)*d+(u.y+u.height/2),v=(new Hn).translate(p,f).scale(d,d);n.transform=v}}return oc(t,n,i),{root:n,width:r,height:a,elements:i,viewBoxRect:o}}(n):null},t.tau=ti,t.themeExist=gj,t.themes=cj,t.throttle=ge,t.tickStep=function(t,e,i){var n=Math.abs(e-t)/Math.max(0,i),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),a=n/r;return a>=Jt?r*=10:a>=Qt?r*=5:a>=$t&&(r*=2),e<t?-r:r},t.toCamelCase=ga,t.toDate=Se,t.toNumber=Ht,t.toPercent=Ie,t.toValidNumber=Ae,t.token=KU,t.transformBounds=function(t,e,i,n,r,a,o){if(!(ii(n)<=Je||ii(r)<=Je)){if(1!==n&&t.scaleX(n),1!==r&&t.scaleY(r),isFinite(a)&&Math.abs(a)>Je){var s=0,l=0;void 0!==o&&(s=o[0],l=o[1]),t.rotate(a,s,l)}t.translate(e,i)}},t.transformBoundsWithMatrix=In,t.transformColorSchemeToStandardStruct=wU,t.transformToGraphic=vV,t.treeTransform=function(t,e){var i=new D0(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){var n=(null!=t?t:{}).maxDepth,r=[];j$(i,r,{maxDepth:n});var a=[];return _0(i,a,{maxDepth:n}),{nodes:r,links:a}}return i},t.treemapTransform=function(t,e){var i=new R0(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){var n=[];return j$(i,n,{maxDepth:null==t?void 0:t.maxDepth}),n}return i},t.truncate=ue,t.unionAABB=hn,t.uniqArray=Lt,t.upperFirst=Me,t.userAnimationConfig=rY,t.utcDayCount=Fr,t.utcDayField=Or;t.utcDayFloor=Lr,t.utcDayOffset=Ir,t.utcHourField=Wr,t.utcHourFloor=jr,t.utcHourOffset=Vr,t.utcMinuteField=Jr,t.utcMinuteFloor=qr,t.utcMinuteOffset=Zr,t.utcMonthCount=Tr,t.utcMonthField=Dr,t.utcMonthFloor=Mr,t.utcMonthOffset=wr,t.utcSecondField=ra,t.utcSecondFloor=ia,t.utcSecondOffset=na,t.utcYearCount=br,t.utcYearField=xr,t.utcYearFloor=mr,t.utcYearOffset=_r,t.uuid=ce,t.valueInScaleRange=RU,t.variance=qt,t.vennMarkTransform=K0,t.vennTransform=X0,t.version="2.0.10",t.vglobal=tS,t.visitPoints=je,t.warn=NA,t.weightedSum=Ga,t.wordcloudShapeTransform=q1,t.wordcloudTransform=C1,t.yearCount=gr,t.yearField=yr,t.yearFloor=fr,t.yearOffset=vr,t.zero=Fe,t.zeros=Ua,t.zerosM=ja,Object.defineProperty(t,"__esModule",{value:!0})}));
