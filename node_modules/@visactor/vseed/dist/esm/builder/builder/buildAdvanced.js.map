{"version":3,"file":"builder/builder/buildAdvanced.js","sources":["../../../../src/builder/builder/buildAdvanced.ts"],"sourcesContent":["import type { AdvancedPipelineContext, AdvancedVSeed } from 'src/types'\nimport { execPipeline } from '../../pipeline'\nimport { Builder } from './builder'\nimport { intl } from 'src/i18n'\n\nexport const buildAdvanced = (builder: Builder): AdvancedVSeed | null => {\n  const start = typeof performance !== 'undefined' ? performance.now() : Date.now()\n  const { chartType } = builder.vseed\n  if (!chartType) {\n    throw new Error('chartType is nil in buildAdvanced')\n  }\n\n  const pipeline = Builder.getAdvancedPipeline(chartType)\n  if (!pipeline) {\n    throw new Error(\n      `please invoke registerAll or register ${chartType} before build, no advanced pipeline for chartType ${chartType}`,\n    )\n  }\n\n  const context: AdvancedPipelineContext = {\n    vseed: builder.vseed,\n    customTheme: Builder.getThemeMap(),\n  }\n  if (builder.locale) {\n    intl.setLocale(builder.locale)\n  }\n\n  try {\n    const advancedVSeed = execPipeline<AdvancedVSeed, AdvancedPipelineContext>(pipeline, context)\n    builder.advancedVSeed = advancedVSeed\n    return advancedVSeed\n  } catch (e) {\n    console.error(e)\n    throw new Error(`buildAdvanced error: ${(e as Error).message}.\\ndetails info in console`)\n  } finally {\n    const end = typeof performance !== 'undefined' ? performance.now() : Date.now()\n    builder.performance['buildAdvanced'] = `${(end - start).toFixed(4)}ms`\n  }\n}\n"],"names":["buildAdvanced","builder","start","performance","Date","chartType","Error","pipeline","Builder","context","intl","advancedVSeed","execPipeline","e","console","end"],"mappings":";;;AAKO,MAAMA,gBAAgB,CAACC;IAC5B,MAAMC,QAAQ,AAAuB,eAAvB,OAAOC,cAA8BA,YAAY,GAAG,KAAKC,KAAK,GAAG;IAC/E,MAAM,EAAEC,SAAS,EAAE,GAAGJ,QAAQ,KAAK;IACnC,IAAI,CAACI,WACH,MAAM,IAAIC,MAAM;IAGlB,MAAMC,WAAWC,QAAQ,mBAAmB,CAACH;IAC7C,IAAI,CAACE,UACH,MAAM,IAAID,MACR,CAAC,sCAAsC,EAAED,UAAU,kDAAkD,EAAEA,WAAW;IAItH,MAAMI,UAAmC;QACvC,OAAOR,QAAQ,KAAK;QACpB,aAAaO,QAAQ,WAAW;IAClC;IACA,IAAIP,QAAQ,MAAM,EAChBS,KAAK,SAAS,CAACT,QAAQ,MAAM;IAG/B,IAAI;QACF,MAAMU,gBAAgBC,aAAqDL,UAAUE;QACrFR,QAAQ,aAAa,GAAGU;QACxB,OAAOA;IACT,EAAE,OAAOE,GAAG;QACVC,QAAQ,KAAK,CAACD;QACd,MAAM,IAAIP,MAAM,CAAC,qBAAqB,EAAGO,EAAY,OAAO,CAAC,0BAA0B,CAAC;IAC1F,SAAU;QACR,MAAME,MAAM,AAAuB,eAAvB,OAAOZ,cAA8BA,YAAY,GAAG,KAAKC,KAAK,GAAG;QAC7EH,QAAQ,WAAW,CAAC,gBAAgB,GAAG,GAAIc,AAAAA,CAAAA,MAAMb,KAAI,EAAG,OAAO,CAAC,GAAG,EAAE,CAAC;IACxE;AACF"}