{"version":3,"file":"types/dataSelector/selector.js","sources":["../../../../src/types/dataSelector/selector.ts"],"sourcesContent":["import { z } from 'zod'\nimport type { Datum } from '../properties'\n\nexport type ValueSelector = string | number\n\nexport type PartialDatumSelector = Datum\n\n/**\n * @description 指标选择器, 用于选择数据项中指标字段的值\n */\nexport type MeasureSelector = {\n  /**\n   * @description 指标字段, measures 某一项的 id\n   */\n  field: string\n  /**\n   * @description 操作符\n   * - =: 选择数据项中指标字段的值等于 value 的数据项\n   * - ==: 选择数据项中指标字段的值等于 value 的数据项\n   * - !=: 选择数据项中指标字段的值不等于 value 的数据项\n   * - >: 选择数据项中指标字段的值大于 value 的数据项\n   * - <: 选择数据项中指标字段的值小于 value 的数据项\n   * - >=: 选择数据项中指标字段的值大于等于 value 的数据项\n   * - <=: 选择数据项中指标字段的值小于等于 value 的数据项\n   * - between: 选择数据项中指标字段的值在 value 之间的 data item\n   */\n  operator?: '=' | '==' | '!=' | '>' | '<' | '>=' | '<=' | 'between'\n  /**\n   * @description 操作符\n   * - =: 选择数据项中指标字段的值等于 value 的数据项, 会将值转换为字符串后进行比较, 因此 1 == \"1\" 为 true\n   * - ==: 选择数据项中指标字段的值精准等于 value 的数据项, 不会做任何特殊处理, 因此 1 == \"1\" 为 false\n   * - !=: 选择数据项中指标字段的值不等于 value 的数据项\n   * - >: 选择数据项中指标字段的值大于 value 的数据项\n   * - <: 选择数据项中指标字段的值小于 value 的数据项\n   * - >=: 选择数据项中指标字段的值大于等于 value 的数据项\n   * - <=: 选择数据项中指标字段的值小于等于 value 的数据项\n   * - between: 选择数据项中指标字段的值在 value 之间的 data item\n   * same as operator\n   */\n  op?: '=' | '==' | '!=' | '>' | '<' | '>=' | '<=' | 'between'\n  /**\n   * @description 选择数据项中指标字段的值\n   * - 仅 op 为 between 时, value 为长度为2的数组, 数组中的元素为指标字段的最小值和最大值\n   * - 其他情况, value 为指标字段的单个值\n   */\n  value: string | number | Array<string | number>\n  // /**\n  //  * @description 是否使用原始数据进行数据匹配, 开启后会有更多的数据被匹配到\n  //  * 若下述数据, measures 仅设置了 value, field 为 isHigh 或 isLow, op 为 =, value 为 1,\n  //  * 关闭useOrigin时, 数据项并不会考虑measures之外的字段, 因此field为isHigh或isLow的字段会被忽略\n  //  * 开启useOrigin时, 会直接使用整个数据项进行匹配\n  //  * [\n  //  *  {value: 100, isHigh: 1, isLow: 0},\n  //  *  {value: 200, isHigh: 0, isLow: 1},\n  //  *  {value: 300, isHigh: 1, isLow: 0},\n  //  * ]\n  //  * @default false\n  //  */\n  // useOrigin?: boolean\n}\n\n/**\n * @description 维度选择器, 用于选择数据项中维度字段的值\n */\nexport type DimensionSelector = {\n  /**\n   * @description 维度字段, dimensions 某一项的 id\n   */\n  field: string\n  /**\n   * @description 操作符\n   * - in: 选择数据项中维度字段的值在 value 中的数据项\n   * - not in: 选择数据项中维度字段的值不在 value 中的数据项\n   */\n  operator?: 'in' | 'not in'\n  /**\n   * @description 操作符\n   * - in: 选择数据项中维度字段的值在 value 中的数据项\n   * - not in: 选择数据项中维度字段的值不在 value 中的数据项\n   * same as operator\n   */\n  op?: 'in' | 'not in'\n  /**\n   * @description 选择数据项中维度字段的值, 支持数组\n   */\n  value: string | number | Array<string | number>\n  // /**\n  //  * @description 是否使用原始数据进行数据匹配, 开启后会有更多的数据被匹配到\n  //  * 若下述数据, dimensions 仅设置了 name, field 为 name, op 为 =, value 为 \"high\",\n  //  * 关闭useOrigin时, 数据项并不会考虑dimensions之外的字段, 因此field为name的字段会被忽略\n  //  * 开启useOrigin时, 会直接使用整个数据项进行匹配\n  //  * [\n  //  *  {name: \"low\", isHigh: \"false\", isLow: \"true\"},\n  //  *  {name: \"low\", isHigh: \"false\", isLow: \"true\"},\n  //  *  {name: \"high\", isHigh: \"true\", isLow: \"false\"},\n  //  * ]\n  //  * @default false\n  //  */\n  // useOrigin?: boolean\n}\n\nexport type Selector = ValueSelector | PartialDatumSelector | MeasureSelector | DimensionSelector\n\nexport type Selectors = Array<Selector>\n\nexport const zSelector = z.union([\n  z.string(),\n  z.number(),\n  z.object({\n    field: z.string(),\n    operator: z.enum(['=', '==', '!=', '>', '<', '>=', '<=', 'between']).nullish(),\n    op: z.enum(['=', '==', '!=', '>', '<', '>=', '<=', 'between']).nullish(),\n    value: z.union([z.string(), z.number(), z.array(z.union([z.string(), z.number()]))]),\n  }),\n  z.object({\n    field: z.string(),\n    operator: z.enum(['in', 'not in']).nullish(),\n    op: z.enum(['in', 'not in']).nullish(),\n    value: z.union([z.string(), z.number(), z.array(z.union([z.string(), z.number()]))]),\n  }),\n])\n\nexport const zSelectors = z.array(zSelector)\n"],"names":["zSelector","z","zSelectors"],"mappings":";AAyGO,MAAMA,YAAYC,EAAE,KAAK,CAAC;IAC/BA,EAAE,MAAM;IACRA,EAAE,MAAM;IACRA,EAAE,MAAM,CAAC;QACP,OAAOA,EAAE,MAAM;QACf,UAAUA,CAAC,CAADA,OAAM,CAAC;YAAC;YAAK;YAAM;YAAM;YAAK;YAAK;YAAM;YAAM;SAAU,EAAE,OAAO;QAC5E,IAAIA,CAAC,CAADA,OAAM,CAAC;YAAC;YAAK;YAAM;YAAM;YAAK;YAAK;YAAM;YAAM;SAAU,EAAE,OAAO;QACtE,OAAOA,EAAE,KAAK,CAAC;YAACA,EAAE,MAAM;YAAIA,EAAE,MAAM;YAAIA,EAAE,KAAK,CAACA,EAAE,KAAK,CAAC;gBAACA,EAAE,MAAM;gBAAIA,EAAE,MAAM;aAAG;SAAG;IACrF;IACAA,EAAE,MAAM,CAAC;QACP,OAAOA,EAAE,MAAM;QACf,UAAUA,CAAC,CAADA,OAAM,CAAC;YAAC;YAAM;SAAS,EAAE,OAAO;QAC1C,IAAIA,CAAC,CAADA,OAAM,CAAC;YAAC;YAAM;SAAS,EAAE,OAAO;QACpC,OAAOA,EAAE,KAAK,CAAC;YAACA,EAAE,MAAM;YAAIA,EAAE,MAAM;YAAIA,EAAE,KAAK,CAACA,EAAE,KAAK,CAAC;gBAACA,EAAE,MAAM;gBAAIA,EAAE,MAAM;aAAG;SAAG;IACrF;CACD;AAEM,MAAMC,aAAaD,EAAE,KAAK,CAACD"}