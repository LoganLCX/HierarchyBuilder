{"version":3,"file":"pipeline/advanced/table/pipes/reshape/reshapePivotTable.js","sources":["../../../../../../../src/pipeline/advanced/table/pipes/reshape/reshapePivotTable.ts"],"sourcesContent":["import { FoldMeasureId, FoldMeasureName, foldMeasures, FoldMeasureValue } from 'src/dataReshape'\nimport {} from 'src/pipeline/spec/chart/pipes'\nimport { findAllMeasures } from 'src/pipeline/utils'\nimport type { AdvancedPipe, DatasetReshapeInfo, PivotTable } from 'src/types'\n\nexport const reshapePivotTable: AdvancedPipe = (advancedVSeed, context) => {\n  const result = { ...advancedVSeed }\n  const { vseed } = context\n  const { dataset, chartType } = vseed as PivotTable\n  const { dimensions, measures } = advancedVSeed\n  const { dataset: newDatasets, foldInfo } = foldMeasures(dataset, findAllMeasures(measures), {\n    measureId: FoldMeasureId,\n    measureName: FoldMeasureName,\n    measureValue: FoldMeasureValue,\n    allowEmptyFold: false,\n  })\n\n  const datasetReshapeInfo = [\n    {\n      id: String(chartType),\n      index: 0,\n      foldInfo,\n    },\n  ] as unknown as DatasetReshapeInfo\n\n  return {\n    ...result,\n    dataset: newDatasets,\n    datasetReshapeInfo: datasetReshapeInfo,\n    dimensions,\n    measures,\n  }\n}\n"],"names":["reshapePivotTable","advancedVSeed","context","result","vseed","dataset","chartType","dimensions","measures","newDatasets","foldInfo","foldMeasures","findAllMeasures","FoldMeasureId","FoldMeasureName","FoldMeasureValue","datasetReshapeInfo","String"],"mappings":";;;AAKO,MAAMA,oBAAkC,CAACC,eAAeC;IAC7D,MAAMC,SAAS;QAAE,GAAGF,aAAa;IAAC;IAClC,MAAM,EAAEG,KAAK,EAAE,GAAGF;IAClB,MAAM,EAAEG,OAAO,EAAEC,SAAS,EAAE,GAAGF;IAC/B,MAAM,EAAEG,UAAU,EAAEC,QAAQ,EAAE,GAAGP;IACjC,MAAM,EAAE,SAASQ,WAAW,EAAEC,QAAQ,EAAE,GAAGC,aAAaN,SAASO,gBAAgBJ,WAAW;QAC1F,WAAWK;QACX,aAAaC;QACb,cAAcC;QACd,gBAAgB;IAClB;IAEA,MAAMC,qBAAqB;QACzB;YACE,IAAIC,OAAOX;YACX,OAAO;YACPI;QACF;KACD;IAED,OAAO;QACL,GAAGP,MAAM;QACT,SAASM;QACT,oBAAoBO;QACpBT;QACAC;IACF;AACF"}