import { calcOrder } from "./common.js";
const sortLegend_sortLegend = (advancedVSeed, context)=>{
    const result = {
        ...advancedVSeed
    };
    const { vseed } = context;
    const { sortLegend } = vseed;
    const { datasetReshapeInfo, dataset } = advancedVSeed;
    const colorId = datasetReshapeInfo?.[0]?.unfoldInfo?.encodingColorId;
    const colorIdMap = datasetReshapeInfo?.[0]?.unfoldInfo?.colorIdMap ?? {};
    const colorItems = datasetReshapeInfo?.[0]?.unfoldInfo?.colorItems;
    if (!sortLegend || !colorId || !colorIdMap || !colorItems) return advancedVSeed;
    if (!result.analysis) result.analysis = {};
    if (!result.analysis.orderMapping) result.analysis.orderMapping = {};
    if (sortLegend.customOrder) {
        const colorIds = Object.keys(colorIdMap);
        const orderRes = sortLegend.customOrder.map((itemNameOrId)=>colorIds.find((id)=>colorIdMap[id]?.alias === itemNameOrId || colorIdMap[id]?.id === itemNameOrId || id === itemNameOrId));
        result.analysis.orderMapping[colorId] = orderRes;
        return result;
    }
    const orderRes = calcOrder(sortLegend, colorId, dataset?.flat(2) || []);
    result.analysis.orderMapping[colorId] = orderRes;
    return result;
};
export { sortLegend_sortLegend as sortLegend };

//# sourceMappingURL=sortLegend.js.map