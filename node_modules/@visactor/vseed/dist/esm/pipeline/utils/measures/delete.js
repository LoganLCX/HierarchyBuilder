import { isMeasure, isMeasureGroup } from "./typeGuard.js";
const deleteMeasureTreeByCallback = (measureTree, callback)=>{
    if (!measureTree) return;
    const stack = [
        ...measureTree
    ].reverse();
    const parents = new Map();
    measureTree.forEach((node)=>{
        parents.set(node, measureTree);
    });
    const nodesToProcess = [];
    const visited = new Set();
    while(stack.length > 0){
        const node = stack[stack.length - 1];
        if (isMeasureGroup(node) && node.children && !visited.has(node)) {
            visited.add(node);
            const children = node.children.slice().reverse();
            for (const child of children){
                parents.set(child, node.children);
                stack.push(child);
            }
        } else {
            stack.pop();
            nodesToProcess.push(node);
        }
    }
    const deleted = [];
    for (const node of nodesToProcess){
        const parentList = parents.get(node);
        if (parentList) {
            const index = parentList.indexOf(node);
            if (isMeasure(node)) {
                if (callback?.(node, index, parentList)) {
                    parentList.splice(index, 1);
                    deleted.push(node);
                }
            }
        }
    }
    return deleted;
};
export { deleteMeasureTreeByCallback };

//# sourceMappingURL=delete.js.map