{"version":3,"file":"pipeline/spec/table/pipes/rows/pivotRows.js","sources":["../../../../../../../src/pipeline/spec/table/pipes/rows/pivotRows.ts"],"sourcesContent":["import { MeasureId } from 'src/dataReshape'\nimport { findAllMeasures } from 'src/pipeline/utils/measures/find'\nimport type { Dimensions, PivotTableSpecPipe } from 'src/types'\n\nexport const pivotRows: PivotTableSpecPipe = (spec, context) => {\n  const { advancedVSeed } = context\n  const dimensions = advancedVSeed.dimensions as Dimensions\n  const { encoding, measures } = advancedVSeed\n  const rows = dimensions.filter((item) => encoding.row?.includes(item.id))\n  const allMeasures = findAllMeasures(measures)\n\n  return {\n    ...spec,\n    rows: rows.map((item) => {\n      const res = {\n        dimensionKey: item.id,\n        title: item.alias || item.id,\n        width: 'auto',\n      }\n\n      if (item.id === MeasureId) {\n        ;(res as any).headerFormat = (measureId: string) => {\n          const measure = allMeasures.find((m) => m.id === measureId)\n\n          return measure?.alias ?? measureId\n        }\n      }\n\n      return res\n    }),\n  }\n}\n"],"names":["pivotRows","spec","context","advancedVSeed","dimensions","encoding","measures","rows","item","allMeasures","findAllMeasures","res","MeasureId","measureId","measure","m"],"mappings":";;AAIO,MAAMA,YAAgC,CAACC,MAAMC;IAClD,MAAM,EAAEC,aAAa,EAAE,GAAGD;IAC1B,MAAME,aAAaD,cAAc,UAAU;IAC3C,MAAM,EAAEE,QAAQ,EAAEC,QAAQ,EAAE,GAAGH;IAC/B,MAAMI,OAAOH,WAAW,MAAM,CAAC,CAACI,OAASH,SAAS,GAAG,EAAE,SAASG,KAAK,EAAE;IACvE,MAAMC,cAAcC,gBAAgBJ;IAEpC,OAAO;QACL,GAAGL,IAAI;QACP,MAAMM,KAAK,GAAG,CAAC,CAACC;YACd,MAAMG,MAAM;gBACV,cAAcH,KAAK,EAAE;gBACrB,OAAOA,KAAK,KAAK,IAAIA,KAAK,EAAE;gBAC5B,OAAO;YACT;YAEA,IAAIA,KAAK,EAAE,KAAKI,WACZD,IAAY,YAAY,GAAG,CAACE;gBAC5B,MAAMC,UAAUL,YAAY,IAAI,CAAC,CAACM,IAAMA,EAAE,EAAE,KAAKF;gBAEjD,OAAOC,SAAS,SAASD;YAC3B;YAGF,OAAOF;QACT;IACF;AACF"}