{"version":3,"file":"pipeline/spec/chart/pipes/init/rose.js","sources":["../../../../../../../src/pipeline/spec/chart/pipes/init/rose.ts"],"sourcesContent":["import type { IRoseChartSpec } from '@visactor/vchart'\nimport type { VChartSpecPipe } from 'src/types'\n\nexport const initRose: VChartSpecPipe = (spec, context) => {\n  const result = { ...spec } as IRoseChartSpec\n  const { advancedVSeed } = context\n  const { dataset, datasetReshapeInfo } = advancedVSeed\n  const { foldInfo, unfoldInfo } = datasetReshapeInfo[0]\n\n  result.type = 'rose'\n\n  result.angleField = unfoldInfo.encodingAngle\n  result.seriesField = unfoldInfo.encodingColorId\n\n  result.valueField = foldInfo.measureValue\n  result.padding = 0\n  result.outerRadius = 0.9\n  result.innerRadius = 0\n\n  const hasNegativeValue = dataset.flat().find((d) => d[foldInfo.measureValue] < 0)\n  if (hasNegativeValue) {\n    result.innerRadius = 0.05\n  }\n\n  result.region = [\n    {\n      clip: true,\n    },\n  ]\n  result.animation = true\n\n  return result\n}\n"],"names":["initRose","spec","context","result","advancedVSeed","dataset","datasetReshapeInfo","foldInfo","unfoldInfo","hasNegativeValue","d"],"mappings":"AAGO,MAAMA,WAA2B,CAACC,MAAMC;IAC7C,MAAMC,SAAS;QAAE,GAAGF,IAAI;IAAC;IACzB,MAAM,EAAEG,aAAa,EAAE,GAAGF;IAC1B,MAAM,EAAEG,OAAO,EAAEC,kBAAkB,EAAE,GAAGF;IACxC,MAAM,EAAEG,QAAQ,EAAEC,UAAU,EAAE,GAAGF,kBAAkB,CAAC,EAAE;IAEtDH,OAAO,IAAI,GAAG;IAEdA,OAAO,UAAU,GAAGK,WAAW,aAAa;IAC5CL,OAAO,WAAW,GAAGK,WAAW,eAAe;IAE/CL,OAAO,UAAU,GAAGI,SAAS,YAAY;IACzCJ,OAAO,OAAO,GAAG;IACjBA,OAAO,WAAW,GAAG;IACrBA,OAAO,WAAW,GAAG;IAErB,MAAMM,mBAAmBJ,QAAQ,IAAI,GAAG,IAAI,CAAC,CAACK,IAAMA,CAAC,CAACH,SAAS,YAAY,CAAC,GAAG;IAC/E,IAAIE,kBACFN,OAAO,WAAW,GAAG;IAGvBA,OAAO,MAAM,GAAG;QACd;YACE,MAAM;QACR;KACD;IACDA,OAAO,SAAS,GAAG;IAEnB,OAAOA;AACT"}