import { selector } from "../../../../../dataSelector/index.js";
import { isSubset } from "./utils.js";
import { findAllMeasures } from "../../../../utils/index.js";
import { MeasureId } from "../../../../../dataReshape/constant.js";
import { pickWithout } from "@visactor/vutils";
import { generateAnnotationPointPipe } from "./annotationPointCommon.js";
const annotationPointOfDualAxis = generateAnnotationPointPipe({
    findSelectedDatas: (dataset, s, spec, context)=>dataset.reduce((res, d)=>{
            const { advancedVSeed } = context;
            const allMeasureIds = findAllMeasures(advancedVSeed.reshapeMeasures ?? advancedVSeed.measures).map((m)=>m.id);
            const pickedDatum = pickWithout(d, allMeasureIds.filter((id)=>id !== d[MeasureId]));
            if (selector(pickedDatum, s)) res.push(pickedDatum);
            return res;
        }, []),
    generateMarkPoint: (datum, spec, context)=>{
        const { advancedVSeed } = context;
        const allMeasureIds = findAllMeasures(advancedVSeed.reshapeMeasures ?? advancedVSeed.measures).map((m)=>m.id);
        return spec.series?.map((s, index)=>({
                relativeSeriesIndex: index,
                coordinate: (data)=>data.find((item)=>isSubset(datum, item, allMeasureIds.filter((id)=>id !== item[MeasureId])))
            }));
    }
});
export { annotationPointOfDualAxis };

//# sourceMappingURL=annotationPointOfDualAxis.js.map