{"version":3,"file":"pipeline/spec/chart/pipes/tooltip/tooltipDualAxis.js","sources":["../../../../../../../src/pipeline/spec/chart/pipes/tooltip/tooltipDualAxis.ts"],"sourcesContent":["import { isNullish } from 'remeda'\nimport { createDimensionContent, createMarkContent } from './tooltip'\nimport type { FoldInfo, VChartSpecPipe, Tooltip, UnfoldInfo } from 'src/types'\nimport { findAllMeasures } from 'src/pipeline/utils'\nimport { getTooltipStyle } from './tooltipStyle'\n\nexport const tooltipPrimary: VChartSpecPipe = (spec, context) => {\n  const result = { ...spec }\n  const { advancedVSeed, vseed } = context\n  const { measures, datasetReshapeInfo, chartType, dimensions, encoding } = advancedVSeed\n  const baseConfig = advancedVSeed.config[chartType] as { tooltip: Tooltip }\n  const { tooltip = { enable: true } } = baseConfig\n  const { enable } = tooltip\n\n  const foldInfoList = datasetReshapeInfo[0].foldInfoList as FoldInfo[]\n  const unfoldInfo = datasetReshapeInfo[0].unfoldInfo\n\n  result.tooltip = {\n    visible: enable,\n    mark: {\n      title: {\n        visible: false,\n      },\n      content: createMarkContent(\n        encoding.tooltip || [],\n        dimensions,\n        findAllMeasures(vseed.measures),\n        foldInfoList[0],\n        unfoldInfo,\n      ),\n    },\n    dimension: {\n      title: {\n        visible: true,\n      },\n      content: createDimensionContent(dimensions, measures, foldInfoList[0], unfoldInfo),\n    },\n  }\n  return result\n}\n\nexport const tooltipSecondary: VChartSpecPipe = (spec, context) => {\n  const result = { ...spec }\n  const { advancedVSeed, vseed } = context\n  const { measures, datasetReshapeInfo, chartType, dimensions, encoding } = advancedVSeed\n  const baseConfig = advancedVSeed.config[chartType] as { tooltip: Tooltip }\n  const { tooltip = { enable: true } } = baseConfig\n  const { enable } = tooltip\n\n  if (isNullish(datasetReshapeInfo[0].foldInfoList?.[1])) {\n    return result\n  }\n\n  const foldInfoList = datasetReshapeInfo[0].foldInfoList as FoldInfo[]\n  const unfoldInfo = datasetReshapeInfo[0].unfoldInfo as UnfoldInfo\n  result.tooltip = {\n    visible: enable,\n    mark: {\n      title: {\n        visible: false,\n      },\n      content: createMarkContent(\n        encoding.tooltip || [],\n        dimensions,\n        findAllMeasures(vseed.measures),\n        foldInfoList[1],\n        unfoldInfo,\n      ),\n    },\n    dimension: {\n      title: {\n        visible: true,\n      },\n      content: createDimensionContent(dimensions, measures, foldInfoList[1], unfoldInfo),\n    },\n  }\n  return result\n}\n\nexport const tooltipDualAxis: VChartSpecPipe = (spec, context) => {\n  const result = { ...spec }\n  const { advancedVSeed } = context\n  const { chartType } = advancedVSeed\n  const baseConfig = advancedVSeed.config[chartType] as { tooltip: Tooltip }\n  const { tooltip = { enable: true } } = baseConfig\n\n  result.tooltip = {\n    style: getTooltipStyle(tooltip),\n  }\n  return result\n}\n"],"names":["tooltipPrimary","spec","context","result","advancedVSeed","vseed","measures","datasetReshapeInfo","chartType","dimensions","encoding","baseConfig","tooltip","enable","foldInfoList","unfoldInfo","createMarkContent","findAllMeasures","createDimensionContent","tooltipSecondary","isNullish","tooltipDualAxis","getTooltipStyle"],"mappings":";;;;AAMO,MAAMA,iBAAiC,CAACC,MAAMC;IACnD,MAAMC,SAAS;QAAE,GAAGF,IAAI;IAAC;IACzB,MAAM,EAAEG,aAAa,EAAEC,KAAK,EAAE,GAAGH;IACjC,MAAM,EAAEI,QAAQ,EAAEC,kBAAkB,EAAEC,SAAS,EAAEC,UAAU,EAAEC,QAAQ,EAAE,GAAGN;IAC1E,MAAMO,aAAaP,cAAc,MAAM,CAACI,UAAU;IAClD,MAAM,EAAEI,UAAU;QAAE,QAAQ;IAAK,CAAC,EAAE,GAAGD;IACvC,MAAM,EAAEE,MAAM,EAAE,GAAGD;IAEnB,MAAME,eAAeP,kBAAkB,CAAC,EAAE,CAAC,YAAY;IACvD,MAAMQ,aAAaR,kBAAkB,CAAC,EAAE,CAAC,UAAU;IAEnDJ,OAAO,OAAO,GAAG;QACf,SAASU;QACT,MAAM;YACJ,OAAO;gBACL,SAAS;YACX;YACA,SAASG,kBACPN,SAAS,OAAO,IAAI,EAAE,EACtBD,YACAQ,gBAAgBZ,MAAM,QAAQ,GAC9BS,YAAY,CAAC,EAAE,EACfC;QAEJ;QACA,WAAW;YACT,OAAO;gBACL,SAAS;YACX;YACA,SAASG,uBAAuBT,YAAYH,UAAUQ,YAAY,CAAC,EAAE,EAAEC;QACzE;IACF;IACA,OAAOZ;AACT;AAEO,MAAMgB,mBAAmC,CAAClB,MAAMC;IACrD,MAAMC,SAAS;QAAE,GAAGF,IAAI;IAAC;IACzB,MAAM,EAAEG,aAAa,EAAEC,KAAK,EAAE,GAAGH;IACjC,MAAM,EAAEI,QAAQ,EAAEC,kBAAkB,EAAEC,SAAS,EAAEC,UAAU,EAAEC,QAAQ,EAAE,GAAGN;IAC1E,MAAMO,aAAaP,cAAc,MAAM,CAACI,UAAU;IAClD,MAAM,EAAEI,UAAU;QAAE,QAAQ;IAAK,CAAC,EAAE,GAAGD;IACvC,MAAM,EAAEE,MAAM,EAAE,GAAGD;IAEnB,IAAIQ,UAAUb,kBAAkB,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,EAAE,GACnD,OAAOJ;IAGT,MAAMW,eAAeP,kBAAkB,CAAC,EAAE,CAAC,YAAY;IACvD,MAAMQ,aAAaR,kBAAkB,CAAC,EAAE,CAAC,UAAU;IACnDJ,OAAO,OAAO,GAAG;QACf,SAASU;QACT,MAAM;YACJ,OAAO;gBACL,SAAS;YACX;YACA,SAASG,kBACPN,SAAS,OAAO,IAAI,EAAE,EACtBD,YACAQ,gBAAgBZ,MAAM,QAAQ,GAC9BS,YAAY,CAAC,EAAE,EACfC;QAEJ;QACA,WAAW;YACT,OAAO;gBACL,SAAS;YACX;YACA,SAASG,uBAAuBT,YAAYH,UAAUQ,YAAY,CAAC,EAAE,EAAEC;QACzE;IACF;IACA,OAAOZ;AACT;AAEO,MAAMkB,kBAAkC,CAACpB,MAAMC;IACpD,MAAMC,SAAS;QAAE,GAAGF,IAAI;IAAC;IACzB,MAAM,EAAEG,aAAa,EAAE,GAAGF;IAC1B,MAAM,EAAEM,SAAS,EAAE,GAAGJ;IACtB,MAAMO,aAAaP,cAAc,MAAM,CAACI,UAAU;IAClD,MAAM,EAAEI,UAAU;QAAE,QAAQ;IAAK,CAAC,EAAE,GAAGD;IAEvCR,OAAO,OAAO,GAAG;QACf,OAAOmB,gBAAgBV;IACzB;IACA,OAAOT;AACT"}