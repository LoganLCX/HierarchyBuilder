{"version":3,"file":"pipeline/spec/chart/pipes/series/series.js","sources":["../../../../../../../src/pipeline/spec/chart/pipes/series/series.ts"],"sourcesContent":["import type { SpecPipelineContext, VChartSpecPipe, VChartSpecPipeline } from 'src/types'\nimport { execPipeline } from '../../../../utils'\nimport type { ICommonChartSpec, ILineSeriesSpec, ISpec } from '@visactor/vchart'\n\nexport const series = (...args: VChartSpecPipeline[]): VChartSpecPipe => {\n  const result = {\n    type: 'common',\n    padding: 0,\n    region: [\n      {\n        clip: true,\n      },\n    ],\n  } as ICommonChartSpec\n\n  return (_: Partial<ISpec>, context: SpecPipelineContext) => {\n    result.series = args.map((pipeline) => {\n      return execPipeline<Partial<ISpec>, SpecPipelineContext>(pipeline, context, {})\n    }) as ILineSeriesSpec[]\n\n    return result as Partial<ISpec>\n  }\n}\n\n/**\n * @description 双轴图的透视场景, 不能使用此pipe, 请使用series\n * 因为VTable.PivotVChart会自行解析数据, 而非VChart解析.\n */\nexport const seriesDualAxis = (...args: VChartSpecPipeline[]): VChartSpecPipe => {\n  const result = {\n    type: 'common',\n    padding: 0,\n    labelLayout: 'region',\n    region: [\n      {\n        clip: true,\n      },\n    ],\n  } as ICommonChartSpec\n\n  const createDualContext = <T extends SpecPipelineContext>(context: T, index: number): T => {\n    const { advancedVSeed } = context\n    const dataset = advancedVSeed.dataset[index]\n    return {\n      ...context,\n      advancedVSeed: {\n        ...advancedVSeed,\n        dataset: dataset,\n      },\n    }\n  }\n\n  return (_: Partial<ISpec>, context: SpecPipelineContext) => {\n    result.series = args.map((pipeline, index) => {\n      const seriesContext = createDualContext(context, index)\n      return execPipeline<ISpec, SpecPipelineContext>(pipeline, seriesContext, {})\n    }) as ILineSeriesSpec[]\n\n    return result\n  }\n}\n"],"names":["series","args","result","_","context","pipeline","execPipeline","seriesDualAxis","createDualContext","index","advancedVSeed","dataset","seriesContext"],"mappings":";AAIO,MAAMA,SAAS,CAAC,GAAGC;IACxB,MAAMC,SAAS;QACb,MAAM;QACN,SAAS;QACT,QAAQ;YACN;gBACE,MAAM;YACR;SACD;IACH;IAEA,OAAO,CAACC,GAAmBC;QACzBF,OAAO,MAAM,GAAGD,KAAK,GAAG,CAAC,CAACI,WACjBC,aAAkDD,UAAUD,SAAS,CAAC;QAG/E,OAAOF;IACT;AACF;AAMO,MAAMK,iBAAiB,CAAC,GAAGN;IAChC,MAAMC,SAAS;QACb,MAAM;QACN,SAAS;QACT,aAAa;QACb,QAAQ;YACN;gBACE,MAAM;YACR;SACD;IACH;IAEA,MAAMM,oBAAoB,CAAgCJ,SAAYK;QACpE,MAAM,EAAEC,aAAa,EAAE,GAAGN;QAC1B,MAAMO,UAAUD,cAAc,OAAO,CAACD,MAAM;QAC5C,OAAO;YACL,GAAGL,OAAO;YACV,eAAe;gBACb,GAAGM,aAAa;gBAChB,SAASC;YACX;QACF;IACF;IAEA,OAAO,CAACR,GAAmBC;QACzBF,OAAO,MAAM,GAAGD,KAAK,GAAG,CAAC,CAACI,UAAUI;YAClC,MAAMG,gBAAgBJ,kBAAkBJ,SAASK;YACjD,OAAOH,aAAyCD,UAAUO,eAAe,CAAC;QAC5E;QAEA,OAAOV;IACT;AACF"}