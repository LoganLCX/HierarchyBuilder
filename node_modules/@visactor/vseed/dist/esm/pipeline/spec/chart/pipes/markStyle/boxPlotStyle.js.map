{"version":3,"file":"pipeline/spec/chart/pipes/markStyle/boxPlotStyle.js","sources":["../../../../../../../src/pipeline/spec/chart/pipes/markStyle/boxPlotStyle.ts"],"sourcesContent":["import type { IBoxPlotChartSpec } from '@visactor/vchart'\nimport { selector } from '../../../../../dataSelector'\nimport type { BoxPlotStyle, Datum, VChartSpecPipe } from 'src/types'\nimport { isEmpty, isNullish } from 'remeda'\n\nexport const boxPlotStyle: VChartSpecPipe = (spec, context) => {\n  const { advancedVSeed, vseed } = context\n  const { markStyle, config } = advancedVSeed\n  const { boxPlotStyle } = markStyle\n  const theme = config?.[vseed.chartType as 'boxPlot']?.boxPlotStyle\n\n  const result = {\n    ...spec,\n    boxPlot: {\n      style: {\n        shaftShape: 'filled-line',\n        visible: true,\n        shaftWidth: '50%',\n        stroke: theme?.boxBorderColor,\n      },\n    },\n  } as IBoxPlotChartSpec\n\n  if (isNullish(boxPlotStyle) || isEmpty(boxPlotStyle)) {\n    return result\n  }\n\n  const boxPlotStyles = (Array.isArray(boxPlotStyle) ? boxPlotStyle : [boxPlotStyle]) as BoxPlotStyle[]\n\n  const customMap = boxPlotStyles.reduce<object>((result, style, index) => {\n    const { boxColor, boxColorOpacity, boxBorderColor, boxBorderWidth = 1, boxVisible = true, boxBorderOpacity } = style\n\n    return {\n      ...result,\n      [`custom${index + 1}`]: {\n        // 优先级: 后者覆盖前者\n        level: index + 1,\n        filter: (datum: Datum) => {\n          if (selector(datum, style.selector)) {\n            return true\n          }\n          return false\n        },\n        style: {\n          visible: boxVisible,\n          fill: boxColor,\n          fillOpacity: boxColorOpacity,\n          lineWidth: boxBorderWidth,\n          stroke: boxBorderColor,\n          strokeOpacity: boxBorderOpacity,\n        },\n      },\n    }\n  }, {})\n\n  result.boxPlot!.state = {\n    ...result.boxPlot!.state,\n    ...customMap,\n  }\n\n  return result\n}\n"],"names":["boxPlotStyle","spec","context","advancedVSeed","vseed","markStyle","config","theme","result","isNullish","isEmpty","boxPlotStyles","Array","customMap","style","index","boxColor","boxColorOpacity","boxBorderColor","boxBorderWidth","boxVisible","boxBorderOpacity","datum","selector"],"mappings":";;AAKO,MAAMA,4BAA+B,CAACC,MAAMC;IACjD,MAAM,EAAEC,aAAa,EAAEC,KAAK,EAAE,GAAGF;IACjC,MAAM,EAAEG,SAAS,EAAEC,MAAM,EAAE,GAAGH;IAC9B,MAAM,EAAEH,YAAY,EAAE,GAAGK;IACzB,MAAME,QAAQD,QAAQ,CAACF,MAAM,SAAS,CAAc,EAAE;IAEtD,MAAMI,SAAS;QACb,GAAGP,IAAI;QACP,SAAS;YACP,OAAO;gBACL,YAAY;gBACZ,SAAS;gBACT,YAAY;gBACZ,QAAQM,OAAO;YACjB;QACF;IACF;IAEA,IAAIE,UAAUT,iBAAiBU,QAAQV,eACrC,OAAOQ;IAGT,MAAMG,gBAAiBC,MAAM,OAAO,CAACZ,gBAAgBA,eAAe;QAACA;KAAa;IAElF,MAAMa,YAAYF,cAAc,MAAM,CAAS,CAACH,QAAQM,OAAOC;QAC7D,MAAM,EAAEC,QAAQ,EAAEC,eAAe,EAAEC,cAAc,EAAEC,iBAAiB,CAAC,EAAEC,aAAa,IAAI,EAAEC,gBAAgB,EAAE,GAAGP;QAE/G,OAAO;YACL,GAAGN,MAAM;YACT,CAAC,CAAC,MAAM,EAAEO,QAAQ,GAAG,CAAC,EAAE;gBAEtB,OAAOA,QAAQ;gBACf,QAAQ,CAACO;oBACP,IAAIC,SAASD,OAAOR,MAAM,QAAQ,GAChC,OAAO;oBAET,OAAO;gBACT;gBACA,OAAO;oBACL,SAASM;oBACT,MAAMJ;oBACN,aAAaC;oBACb,WAAWE;oBACX,QAAQD;oBACR,eAAeG;gBACjB;YACF;QACF;IACF,GAAG,CAAC;IAEJb,OAAO,OAAO,CAAE,KAAK,GAAG;QACtB,GAAGA,OAAO,OAAO,CAAE,KAAK;QACxB,GAAGK,SAAS;IACd;IAEA,OAAOL;AACT"}